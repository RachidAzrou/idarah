{"file_contents":{"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"replit.md":{"content":"# Overview\n\nThis is a membership management web application called \"Ledenbeheer\" designed specifically for mosques in Belgium. It's a full-stack TypeScript application that provides comprehensive member management, financial tracking, membership fee processing, and public display screens. The system supports multi-tenancy with role-based access control and features a modern, professional UI inspired by HubSpot's design patterns.\n\n# User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## Card Consistency Requirements\n- The preview modal (LiveCard component) must always display exactly the same content and styling as the PWA live card (MembershipCard component)\n- Both components represent the same digital membership card - preview is what users see before accessing the actual PWA card\n- Any styling or content changes must be applied to both components simultaneously to maintain consistency\n\n# System Architecture\n\n## Frontend Architecture\n- **Framework**: React 18 with Vite for development and bundling\n- **Routing**: Wouter for lightweight client-side routing\n- **UI Framework**: Tailwind CSS with shadcn/ui component library for consistent design\n- **Typography**: Poppins font family with clear hierarchy\n- **State Management**: TanStack Query for server state management and caching\n- **Form Handling**: React Hook Form with Zod validation\n- **Design System**: HubSpot-inspired layout with professional CRM styling, featuring a fixed sidebar navigation and top bar with search functionality\n\n## Backend Architecture\n- **Runtime**: Node.js with Express.js server\n- **Database ORM**: Drizzle ORM with PostgreSQL dialect\n- **Authentication**: JWT-based authentication with bcrypt password hashing\n- **Authorization**: Role-based access control (SUPERADMIN, BEHEERDER, MEDEWERKER)\n- **API Design**: RESTful endpoints with Express middleware for authentication and tenant isolation\n- **File Storage**: Local file storage system with abstracted service layer for easy migration to cloud storage\n\n## Database Schema\n- **Multi-tenancy**: Tenant-isolated data model with tenant ID foreign keys\n- **Core Entities**: Members, membership fees, financial transactions, users, public screens, announcements\n- **Member Management**: Comprehensive member profiles with financial settings, payment preferences, and contact information\n- **Financial Tracking**: Transaction categorization, SEPA payment integration, fee status tracking\n- **Public Displays**: Configurable public screens for payment status matrices and announcements\n\n## Authentication & Authorization\n- **Session Management**: JWT tokens with 24-hour expiration\n- **Password Security**: bcryptjs for password hashing\n- **Role Hierarchy**: Three-tier role system with appropriate permissions\n- **Middleware Chain**: Authentication and tenant context middleware for request protection\n\n## Multi-tenancy Strategy\n- **Data Isolation**: Row-level security through tenant ID filtering\n- **Slug-based Routing**: Unique tenant identification via URL slugs\n- **Shared Infrastructure**: Single application instance serving multiple mosque organizations\n\n# External Dependencies\n\n## Database & ORM\n- **Neon Database**: Serverless PostgreSQL database with WebSocket support\n- **Drizzle ORM**: Type-safe database operations with migration support\n- **Database Pooling**: Enhanced connection pooling with 20 max connections, 30s idle timeout, 2s connection timeout\n- **In-Memory Caching**: Simple TTL-based cache for frequently accessed data (dashboard stats, members, fees)\n\n## UI & Design System\n- **Radix UI**: Headless UI primitives for accessibility and keyboard navigation\n- **Lucide React**: Icon library for consistent iconography\n- **TailwindCSS**: Utility-first CSS framework with custom design tokens\n- **shadcn/ui**: Pre-built component library with consistent styling\n- **TanStack Query**: Enhanced client-side caching with 10s stale time, optimistic updates for all mutations\n\n## Development & Build Tools\n- **Vite**: Fast development server and build tool with React plugin\n- **TypeScript**: Strict type checking across client and server\n- **ESBuild**: Server bundle compilation for production\n- **Date-fns**: Date manipulation library with Belgian locale support\n\n## Payment & Financial Integration\n- **SEPA Processing**: Direct debit mandate management and payment processing\n- **Multi-currency Support**: Euro-based financial calculations with Belgian formatting\n- **Payment Method Support**: SEPA, bank transfer, Bancontact, and cash payment options\n\n## Monitoring & Development\n- **Replit Integration**: Development environment plugins and banner integration\n- **Error Handling**: Comprehensive error boundaries and API error responses\n- **Query Optimization**: Efficient data fetching with TanStack Query caching","size_bytes":4808},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    screens: {\n      'xs': '475px',\n      'sm': '640px',\n      'md': '768px',\n      'lg': '1024px',\n      'xl': '1280px',\n      '2xl': '1536px',\n    },\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        success: {\n          DEFAULT: \"var(--success)\",\n          foreground: \"var(--success-foreground)\",\n        },\n        warning: {\n          DEFAULT: \"var(--warning)\",\n          foreground: \"var(--warning-foreground)\",\n        },\n        info: {\n          DEFAULT: \"var(--info)\",\n          foreground: \"var(--info-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":3252},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ \n  connectionString: process.env.DATABASE_URL,\n  max: 20, // Maximum 20 connections in pool\n  idleTimeoutMillis: 30000, // Close idle connections after 30 seconds\n  connectionTimeoutMillis: 2000, // Connection timeout 2 seconds\n});\nexport const db = drizzle({ client: pool, schema });","size_bytes":667},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport path from \"path\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Serve uploaded files\napp.use('/uploads', express.static(path.join(process.cwd(), 'uploads')));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","size_bytes":2190},"server/routes.ts":{"content":"import type { Express, Request } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { authMiddleware } from \"./middleware/auth\";\nimport { tenantMiddleware } from \"./middleware/tenant\";\nimport { quickAuthMiddleware, storeVerifyToken } from \"./middleware/quickAuth\";\nimport { authService } from \"./services/auth\";\nimport { memberService } from \"./services/member\";\nimport { feeService } from \"./services/fee\";\nimport { financialService } from \"./services/financial\";\nimport { cardService } from \"./services/card\";\nimport { ruleService } from \"./services/ruleService\";\nimport { boardService } from \"./services/board\";\nimport { makeCardETag } from \"./lib/card/etag\";\nimport { randomBytes } from \"crypto\";\nimport { computeCardStatus } from \"./lib/card/status\";\nimport { insertUserSchema, insertMemberSchema, insertMembershipFeeSchema, cardMeta, insertBoardMemberSchema, emailSegments, emailSuppresses } from \"@shared/schema\";\n\n// Define AuthenticatedRequest type\ninterface AuthenticatedRequest extends Request {\n  user: {\n    id: string;\n    tenantId: string;\n    name: string;\n    email: string;\n    role: 'SUPERADMIN' | 'BEHEERDER' | 'MEDEWERKER';\n    active: boolean;\n    createdAt: Date;\n  };\n  tenantId: string;\n}\nimport { eq } from \"drizzle-orm\";\nimport { db } from \"./db\";\nimport { generateFeesHandler } from \"./api/jobs/fees/generate\";\nimport { createMemberHandler } from \"./api/members/create\";\nimport publicScreensRouter from \"./routes/public-screens\";\nimport { z } from \"zod\";\nimport * as XLSX from 'xlsx';\n\nconst loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string().min(1),\n});\n\nconst createMemberSchema = z.object({\n  firstName: z.string(),\n  lastName: z.string(),\n  gender: z.enum(['M', 'V']),\n  birthDate: z.union([z.date(), z.string().transform((str) => new Date(str))]),\n  category: z.enum(['STUDENT', 'STANDAARD', 'SENIOR']),\n  email: z.string().optional(),\n  phone: z.string().optional(),\n  street: z.string(),\n  number: z.string(),\n  bus: z.string().optional(),\n  postalCode: z.string(),\n  city: z.string(),\n  country: z.string(),\n  financialSettings: z.object({\n    paymentMethod: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']),\n    iban: z.string().optional(),\n    paymentTerm: z.enum(['MONTHLY', 'YEARLY']),\n  }),\n  organization: z.object({\n    interestedInActiveRole: z.boolean(),\n    roleDescription: z.string().optional(),\n  }),\n  permissions: z.object({\n    privacyAgreement: z.boolean(),\n    photoVideoConsent: z.boolean(),\n    newsletterSubscription: z.boolean(),\n    whatsappList: z.boolean(),\n  }),\n});\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth routes\n  app.post(\"/api/auth/login\", async (req, res) => {\n    try {\n      const { email, password } = loginSchema.parse(req.body);\n      const result = await authService.login(email, password);\n      \n      if (!result.success) {\n        return res.status(401).json({ message: result.message });\n      }\n\n      res.json({\n        user: result.user,\n        token: result.token,\n      });\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid request\" });\n    }\n  });\n\n  app.post(\"/api/auth/logout\", authMiddleware, async (req, res) => {\n    res.json({ message: \"Logged out successfully\" });\n  });\n\n  app.get(\"/api/auth/me\", authMiddleware, async (req, res) => {\n    res.json({ user: req.user });\n  });\n\n  // Password reset route\n  app.post(\"/api/auth/reset-password\", async (req, res) => {\n    try {\n      const { email } = z.object({\n        email: z.string().email()\n      }).parse(req.body);\n\n      const result = await authService.resetPassword(email);\n      \n      if (!result.success) {\n        return res.status(404).json({ message: result.message });\n      }\n\n      res.json({ message: \"Een nieuw wachtwoord is verzonden naar uw e-mailadres.\" });\n    } catch (error) {\n      console.error(\"Password reset error:\", error);\n      res.status(400).json({ message: \"Ongeldig e-mailadres\" });\n    }\n  });\n\n  // Quick authentication for QR verification\n  app.post(\"/api/auth/quick-verify\", async (req, res) => {\n    try {\n      const { email, password } = loginSchema.parse(req.body);\n      const result = await authService.login(email, password);\n      \n      if (!result.success) {\n        return res.status(401).json({ error: \"Ongeldige inloggegevens\" });\n      }\n\n      // Check if user has staff/manager role\n      const user = result.user;\n      if (user.role !== 'BEHEERDER' && user.role !== 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang - alleen medewerkers en beheerders\" });\n      }\n\n      // Generate and store verification token\n      const verifyToken = `verify_${Date.now()}_${user.id}`;\n      storeVerifyToken(verifyToken, user.id, user.role);\n      \n      res.json({\n        user: {\n          id: user.id,\n          name: user.name,\n          role: user.role,\n        },\n        token: verifyToken,\n      });\n    } catch (error) {\n      res.status(400).json({ error: \"Ongeldige aanvraag\" });\n    }\n  });\n\n  // Profile routes\n  app.put(\"/api/profile\", authMiddleware, async (req, res) => {\n    try {\n      const { name, email } = req.body;\n      \n      if (!name || !email) {\n        return res.status(400).json({ message: \"Naam en email zijn verplicht\" });\n      }\n\n      // Check if email is already taken by another user\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser && req.user && existingUser.id !== req.user.id) {\n        return res.status(409).json({ message: \"Dit email adres is al in gebruik\" });\n      }\n\n      if (!req.user) return res.status(401).json({ message: \"Unauthorized\" });\n      const updatedUser = await storage.updateUser(req.user.id, { name, email });\n      res.json(updatedUser);\n    } catch (error) {\n      console.error(\"Error updating profile:\", error);\n      res.status(500).json({ message: \"Er is een fout opgetreden bij het bijwerken van uw profiel\" });\n    }\n  });\n\n  app.put(\"/api/profile/password\", authMiddleware, async (req, res) => {\n    try {\n      const { currentPassword, newPassword } = req.body;\n      \n      if (!currentPassword || !newPassword) {\n        return res.status(400).json({ message: \"Huidig en nieuw wachtwoord zijn verplicht\" });\n      }\n\n      if (newPassword.length < 6) {\n        return res.status(400).json({ message: \"Nieuw wachtwoord moet minimaal 6 karakters zijn\" });\n      }\n\n      // Verify current password using auth service\n      if (!req.user) return res.status(401).json({ message: \"Unauthorized\" });\n      const loginResult = await authService.login(req.user.email, currentPassword);\n      if (!loginResult.success) {\n        return res.status(400).json({ message: \"Huidig wachtwoord is incorrect\" });\n      }\n\n      // Update password hash using auth service\n      const hashedPassword = await authService.hashPassword(newPassword);\n      await storage.updateUser(req.user!.id, { passwordHash: hashedPassword });\n      res.json({ message: \"Wachtwoord succesvol gewijzigd\" });\n    } catch (error) {\n      console.error(\"Error changing password:\", error);\n      res.status(500).json({ message: \"Er is een fout opgetreden bij het wijzigen van het wachtwoord\" });\n    }\n  });\n\n  // Dashboard stats\n  app.get(\"/api/dashboard/stats\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const stats = await storage.getDashboardStats(req.tenantId!);\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch dashboard stats\" });\n    }\n  });\n\n  // Members routes\n  app.get(\"/api/members\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const members = await storage.getMembersByTenant(req.tenantId!);\n      \n      // Fetch financial settings and permissions for each member\n      const membersWithDetails = await Promise.all(\n        members.map(async (member) => {\n          const [financialSettings, permissions] = await Promise.all([\n            storage.getMemberFinancialSettings(member.id),\n            storage.getMemberPermissions(member.id)\n          ]);\n          \n          return {\n            ...member,\n            financialSettings,\n            permissions\n          };\n        })\n      );\n      \n      res.json(membersWithDetails);\n    } catch (error) {\n      console.error(\"Members API error:\", error);\n      res.status(500).json({ message: \"Failed to fetch members\" });\n    }\n  });\n\n  app.get(\"/api/members/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const member = await storage.getMember(req.params.id);\n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n      \n      // Fetch financial settings and permissions for this member\n      const [financialSettings, permissions] = await Promise.all([\n        storage.getMemberFinancialSettings(member.id),\n        storage.getMemberPermissions(member.id)\n      ]);\n      \n      res.json({\n        ...member,\n        financialSettings,\n        permissions\n      });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch member\" });\n    }\n  });\n\n  // Check for duplicates endpoint\n  app.post(\"/api/members/check-duplicates\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const memberData = req.body;\n      \n      // FORCE DEBUG: Kijk eerst wat er in de database staat\n      const allMembers = await storage.getMembersByTenant(req.tenantId!);\n      const memberNumbers = allMembers.map(m => m.memberNumber);\n      \n      console.log(\"🔍 TENANT:\", req.tenantId);\n      console.log(\"🔍 EXISTING NUMBERS:\", memberNumbers);\n      console.log(\"🔍 CHECKING FOR:\", memberData.memberNumber);\n      console.log(\"🔍 NORMALIZED CHECK:\", memberData.memberNumber ? memberData.memberNumber.padStart(4, '0') : 'NO NUMBER');\n      \n      const duplicateCheck = await memberService.checkForDuplicates(req.tenantId!, memberData);\n      \n      console.log(\"🔍 RESULT:\", duplicateCheck);\n      res.json(duplicateCheck);\n    } catch (error) {\n      console.error(\"Error checking duplicates:\", error);\n      res.status(500).json({ message: \"Failed to check for duplicates\" });\n    }\n  });\n\n  app.post(\"/api/members\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      // Transform the data to match expected format\n      const transformedData = {\n        ...req.body,\n        // Convert string date to Date object if needed\n        birthDate: typeof req.body.birthDate === 'string' ? new Date(req.body.birthDate) : req.body.birthDate,\n      };\n      \n      const memberData = createMemberSchema.parse(transformedData);\n      const result = await memberService.createMember(req.tenantId!, memberData);\n      \n      if (!result.success) {\n        return res.status(400).json({ message: result.message });\n      }\n\n      res.status(201).json(result.member);\n    } catch (error) {\n      console.error(\"Error creating member:\", error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ \n          message: \"Invalid member data\", \n          errors: error.issues \n        });\n      }\n      res.status(400).json({ message: \"Invalid member data\" });\n    }\n  });\n\n  app.put(\"/api/members/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      console.log(\"PUT member request body:\", JSON.stringify(req.body, null, 2));\n      \n      // Transform the data to match expected format (same as PATCH endpoint)\n      const transformedData = {\n        ...req.body,\n        // Convert string date to Date object if needed\n        birthDate: req.body.birthDate && typeof req.body.birthDate === 'string' ? new Date(req.body.birthDate) : req.body.birthDate,\n      };\n      \n      // Remove undefined/null birthDate to avoid validation issues\n      if (!transformedData.birthDate || isNaN(transformedData.birthDate.getTime())) {\n        delete transformedData.birthDate;\n      }\n      \n      // Handle voting rights field mapping\n      if (req.body.organization?.votingEligible !== undefined) {\n        transformedData.votingRights = req.body.organization.votingEligible;\n        console.log(\"PUT mapped voting rights:\", transformedData.votingRights);\n      }\n      \n      console.log(\"PUT transformed data:\", JSON.stringify(transformedData, null, 2));\n      \n      const memberData = insertMemberSchema.partial().parse(transformedData);\n      console.log(\"PUT parsed member data:\", JSON.stringify(memberData, null, 2));\n      \n      const member = await storage.getMember(req.params.id);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      const updatedMember = await storage.updateMember(req.params.id, memberData);\n      console.log(\"PUT updated member successfully:\", updatedMember.id);\n      \n      // Handle card status when member active status changes (PUT route)\n      if (memberData.active === false) {\n        // If member is being deactivated, automatically mark their card as expired\n        try {\n          await db\n            .update(cardMeta)\n            .set({ \n              status: 'VERLOPEN'\n            })\n            .where(eq(cardMeta.memberId, req.params.id));\n          console.log(\"PUT: Automatically set card status to VERLOPEN for deactivated member:\", req.params.id);\n        } catch (cardError) {\n          console.error(\"PUT: Error updating card status for deactivated member:\", cardError);\n          // Don't fail the main request if card update fails\n        }\n      } else if (memberData.active === true && member.active === false) {\n        // If member is being reactivated, recalculate their card status\n        try {\n          await cardService.recalculateCardStatus(req.params.id, req.tenantId);\n          console.log(\"PUT: Recalculated card status for reactivated member:\", req.params.id);\n        } catch (cardError) {\n          console.error(\"PUT: Error recalculating card status for reactivated member:\", cardError);\n          // Don't fail the main request if card update fails\n        }\n      }\n      \n      res.json(updatedMember);\n    } catch (error) {\n      console.error(\"Error updating member - detailed:\", error);\n      if (error instanceof z.ZodError) {\n        console.error(\"Zod validation errors:\", error.issues);\n        return res.status(400).json({ \n          message: \"Invalid member data\", \n          errors: error.issues \n        });\n      }\n      res.status(500).json({ message: \"Server error updating member\" });\n    }\n  });\n\n  app.patch(\"/api/members/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      console.log(\"PATCH member request body:\", JSON.stringify(req.body, null, 2));\n      \n      // Transform the data to match expected format (same as PUT endpoint)\n      const transformedData = {\n        ...req.body,\n        // Convert string date to Date object if needed\n        birthDate: req.body.birthDate && typeof req.body.birthDate === 'string' ? new Date(req.body.birthDate) : req.body.birthDate,\n      };\n      \n      // Remove undefined/null birthDate to avoid validation issues\n      if (!transformedData.birthDate) {\n        delete transformedData.birthDate;\n      }\n      \n      // Handle voting rights field mapping\n      if (req.body.organization?.votingEligible !== undefined) {\n        transformedData.votingRights = req.body.organization.votingEligible;\n        console.log(\"PATCH mapped voting rights:\", transformedData.votingRights);\n      }\n      \n      const memberData = insertMemberSchema.partial().parse(transformedData);\n      console.log(\"PATCH parsed member data:\", JSON.stringify(memberData, null, 2));\n      \n      const member = await storage.getMember(req.params.id);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      const updatedMember = await storage.updateMember(req.params.id, memberData);\n      console.log(\"Updated member successfully:\", updatedMember.id);\n      \n      // Handle card status when member active status changes (PATCH route)\n      if (memberData.active === false) {\n        // If member is being deactivated, automatically mark their card as expired\n        try {\n          await db\n            .update(cardMeta)\n            .set({ \n              status: 'VERLOPEN'\n            })\n            .where(eq(cardMeta.memberId, req.params.id));\n          console.log(\"PATCH: Automatically set card status to VERLOPEN for deactivated member:\", req.params.id);\n        } catch (cardError) {\n          console.error(\"PATCH: Error updating card status for deactivated member:\", cardError);\n          // Don't fail the main request if card update fails\n        }\n      } else if (memberData.active === true && member.active === false) {\n        // If member is being reactivated, recalculate their card status\n        try {\n          await cardService.recalculateCardStatus(req.params.id, req.tenantId);\n          console.log(\"PATCH: Recalculated card status for reactivated member:\", req.params.id);\n        } catch (cardError) {\n          console.error(\"PATCH: Error recalculating card status for reactivated member:\", cardError);\n          // Don't fail the main request if card update fails\n        }\n      }\n      \n      res.json(updatedMember);\n    } catch (error) {\n      console.error(\"Error updating member - detailed:\", error);\n      if (error instanceof z.ZodError) {\n        console.error(\"Zod validation errors:\", error.issues);\n        return res.status(400).json({ \n          message: \"Invalid member data\", \n          errors: error.issues \n        });\n      }\n      res.status(500).json({ message: \"Server error updating member\" });\n    }\n  });\n\n  app.delete(\"/api/members/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const member = await storage.getMember(req.params.id);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      await storage.deleteMember(req.params.id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting member:\", error);\n      res.status(500).json({ message: \"Failed to delete member\" });\n    }\n  });\n\n  // Export members to Excel\n  app.post(\"/api/members/export\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { memberIds, fields } = req.body;\n      \n      if (!memberIds || !Array.isArray(memberIds) || memberIds.length === 0) {\n        return res.status(400).json({ message: \"Member IDs are required\" });\n      }\n      \n      if (!fields || !Array.isArray(fields) || fields.length === 0) {\n        return res.status(400).json({ message: \"Export fields are required\" });\n      }\n\n      // Fetch members and their details\n      const members = await Promise.all(\n        memberIds.map(async (memberId) => {\n          const member = await storage.getMember(memberId);\n          if (!member || member.tenantId !== req.tenantId) {\n            return null;\n          }\n          \n          // Fetch financial settings and permissions\n          const [financialSettings, permissions] = await Promise.all([\n            storage.getMemberFinancialSettings(member.id),\n            storage.getMemberPermissions(member.id)\n          ]);\n          \n          return {\n            ...member,\n            financialSettings,\n            permissions\n          };\n        })\n      );\n\n      // Filter out null members and format data for export\n      const validMembers = members.filter((member): member is NonNullable<typeof member> => member !== null);\n      \n      // Map member data to export format\n      const exportData = validMembers.map(member => {\n        const row: any = {};\n        \n        fields.forEach(field => {\n          switch (field) {\n            case 'memberNumber':\n              row['Lidnummer'] = member.memberNumber;\n              break;\n            case 'firstName':\n              row['Voornaam'] = member.firstName;\n              break;\n            case 'lastName':\n              row['Achternaam'] = member.lastName;\n              break;\n            case 'birthDate':\n              row['Geboortedatum'] = member.birthDate ? new Date(member.birthDate).toLocaleDateString('nl-BE') : '';\n              break;\n            case 'gender':\n              row['Geslacht'] = member.gender === 'M' ? 'Man' : member.gender === 'V' ? 'Vrouw' : '';\n              break;\n            case 'nationality':\n              row['Nationaliteit'] = member.country || '';\n              break;\n            case 'email':\n              row['E-mail'] = member.email || '';\n              break;\n            case 'phone':\n              row['Telefoon'] = member.phone || '';\n              break;\n            case 'address':\n              row['Adres'] = member.street && member.number ? `${member.street} ${member.number}${member.bus ? `/${member.bus}` : ''}` : '';\n              break;\n            case 'postalCode':\n              row['Postcode'] = member.postalCode || '';\n              break;\n            case 'city':\n              row['Stad'] = member.city || '';\n              break;\n            case 'country':\n              row['Land'] = member.country || '';\n              break;\n            case 'status':\n              row['Status'] = member.active ? 'Actief' : 'Inactief';\n              break;\n            case 'category':\n              row['Categorie'] = member.category;\n              break;\n            case 'joinDate':\n              row['Inschrijfdatum'] = member.createdAt ? new Date(member.createdAt).toLocaleDateString('nl-BE') : '';\n              break;\n            case 'votingRights':\n              row['Stemrecht'] = member.votingRights ? 'Ja' : 'Nee';\n              break;\n            case 'membershipFee':\n              row['Lidmaatschapsbijdrage'] = ''; // This would need to be calculated from fees\n              break;\n            case 'paymentMethod':\n              row['Betaalmethode'] = member.financialSettings?.paymentMethod || '';\n              break;\n            case 'iban':\n              row['IBAN'] = member.financialSettings?.iban || '';\n              break;\n            case 'paymentStatus':\n              row['Betaalstatus'] = ''; // This would need to be calculated from fees\n              break;\n            case 'emergencyContact':\n              row['Noodcontact'] = ''; // Not in current schema\n              break;\n            case 'emergencyPhone':\n              row['Noodcontact telefoon'] = ''; // Not in current schema\n              break;\n            case 'notes':\n              row['Notities'] = ''; // Not in current schema\n              break;\n          }\n        });\n        \n        return row;\n      });\n\n      // Create Excel workbook\n      const wb = XLSX.utils.book_new();\n      const ws = XLSX.utils.json_to_sheet(exportData);\n      \n      // Auto-width columns\n      const colWidths = Object.keys(exportData[0] || {}).map(key => ({\n        wch: Math.max(key.length, 15)\n      }));\n      ws['!cols'] = colWidths;\n      \n      XLSX.utils.book_append_sheet(wb, ws, 'Leden');\n      \n      // Generate Excel buffer\n      const excelBuffer = XLSX.write(wb, { type: 'buffer', bookType: 'xlsx' });\n      \n      // Set response headers for file download\n      const timestamp = new Date().toISOString().split('T')[0];\n      res.setHeader('Content-Type', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet');\n      res.setHeader('Content-Disposition', `attachment; filename=\"leden_export_${timestamp}.xlsx\"`);\n      \n      res.send(excelBuffer);\n    } catch (error) {\n      console.error(\"Error exporting members:\", error);\n      res.status(500).json({ message: \"Failed to export members\" });\n    }\n  });\n\n  // Membership fees routes\n  app.get(\"/api/fees\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const fees = await storage.getMembershipFeesByTenant(req.tenantId!);\n      res.json(fees);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch membership fees\" });\n    }\n  });\n\n  app.get(\"/api/fees/member/:memberId\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const fees = await storage.getMembershipFeesByMember(req.params.memberId);\n      res.json(fees);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch member fees\" });\n    }\n  });\n\n  app.post(\"/api/fees\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const feeData = insertMembershipFeeSchema.parse(req.body);\n      const fee = await storage.createMembershipFee({\n        ...feeData,\n        tenantId: req.tenantId!,\n      });\n      res.status(201).json(fee);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid fee data\" });\n    }\n  });\n\n  app.put(\"/api/fees/:id/mark-paid\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const result = await feeService.markFeePaid(req.params.id, req.tenantId!);\n      \n      if (!result.success) {\n        return res.status(400).json({ message: result.message });\n      }\n\n      res.json(result.fee);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to mark fee as paid\" });\n    }\n  });\n\n  app.delete(\"/api/fees/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      await storage.deleteMembershipFee(req.params.id, req.tenantId!);\n      res.json({ message: \"Lidgeld verwijderd\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete membership fee\" });\n    }\n  });\n\n  // Financial routes\n  app.get(\"/api/transactions\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const transactions = await storage.getTransactionsByTenant(req.tenantId!);\n      res.json(transactions);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch transactions\" });\n    }\n  });\n\n  app.post(\"/api/transactions\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const transactionData = { \n        ...req.body, \n        tenantId: req.tenantId,\n        date: new Date(req.body.date)\n      };\n      const transaction = await storage.createTransaction(transactionData);\n      res.status(201).json(transaction);\n    } catch (error) {\n      console.error(\"Error creating transaction:\", error);\n      res.status(400).json({ message: \"Invalid transaction data\" });\n    }\n  });\n\n  app.put(\"/api/transactions/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const transactionData = { \n        ...req.body, \n        date: req.body.date ? new Date(req.body.date) : undefined\n      };\n      const transaction = await storage.updateTransaction(req.params.id, transactionData);\n      res.json(transaction);\n    } catch (error) {\n      console.error(\"Error updating transaction:\", error);\n      res.status(400).json({ message: \"Invalid transaction data\" });\n    }\n  });\n\n  app.delete(\"/api/transactions/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      await storage.deleteTransaction(req.params.id);\n      res.status(204).send();\n    } catch (error) {\n      console.error(\"Error deleting transaction:\", error);\n      res.status(500).json({ message: \"Failed to delete transaction\" });\n    }\n  });\n\n  app.get(\"/api/financial/reports\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const reports = await financialService.generateReports(req.tenantId!);\n      res.json(reports);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to generate financial reports\" });\n    }\n  });\n\n  // Tenant management routes\n  app.get(\"/api/tenant/current\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const tenant = await storage.getTenant(req.tenantId!);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n      \n      // Return tenant data with consistent field names\n      const mappedTenant = {\n        id: tenant.id,\n        name: tenant.name,\n        slug: tenant.slug,\n        street: tenant.street,\n        number: tenant.number,\n        postalCode: tenant.postalCode,\n        city: tenant.city,\n        country: tenant.country,\n        email: tenant.email,\n        phone: tenant.phone,\n        website: tenant.website,\n        companyNumber: tenant.companyNumber,\n        companyType: tenant.companyType,\n        logoUrl: tenant.logoUrl,\n        primaryColor: tenant.primaryColor,\n        // Include fee settings\n        studentFee: tenant.studentFee,\n        adultFee: tenant.adultFee,\n        seniorFee: tenant.seniorFee,\n        defaultPaymentTerm: tenant.defaultPaymentTerm,\n        defaultPaymentMethod: tenant.defaultPaymentMethod,\n        createdAt: tenant.createdAt,\n      };\n      \n      res.json(mappedTenant);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch tenant\" });\n    }\n  });\n\n  app.put(\"/api/tenant/current\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const tenantData = req.body;\n      \n      // Map frontend field names to database field names\n      const mappedData = {\n        name: tenantData.name,\n        slug: tenantData.slug,\n        street: tenantData.street,\n        number: tenantData.number,\n        postalCode: tenantData.postalCode,\n        city: tenantData.city,\n        country: tenantData.country,\n        email: tenantData.email,\n        phone: tenantData.phone,\n        website: tenantData.website,\n        companyNumber: tenantData.companyNumber,\n        companyType: tenantData.companyType,\n        logoUrl: tenantData.logoUrl,\n        primaryColor: tenantData.primaryColor,\n      };\n      \n      const updatedTenant = await storage.updateTenant(req.tenantId!, mappedData);\n      \n      // Return consistent response format\n      const mappedResponse = {\n        id: updatedTenant.id,\n        name: updatedTenant.name,\n        slug: updatedTenant.slug,\n        street: updatedTenant.street,\n        number: updatedTenant.number,\n        postalCode: updatedTenant.postalCode,\n        city: updatedTenant.city,\n        country: updatedTenant.country,\n        email: updatedTenant.email,\n        phone: updatedTenant.phone,\n        website: updatedTenant.website,\n        companyNumber: updatedTenant.companyNumber,\n        companyType: updatedTenant.companyType,\n        logoUrl: updatedTenant.logoUrl,\n        primaryColor: updatedTenant.primaryColor,\n        createdAt: updatedTenant.createdAt,\n      };\n      \n      res.json(mappedResponse);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to update tenant\" });\n    }\n  });\n\n  // Settings routes\n  app.put(\"/api/settings/fees\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { studentFee, adultFee, seniorFee, defaultPaymentTerm, defaultPaymentMethod } = req.body;\n      \n      // Update tenant with fee settings\n      const updatedTenant = await storage.updateTenant(req.tenantId!, {\n        studentFee: studentFee ? parseFloat(studentFee).toString() : undefined,\n        adultFee: adultFee ? parseFloat(adultFee).toString() : undefined,\n        seniorFee: seniorFee ? parseFloat(seniorFee).toString() : undefined,\n        defaultPaymentTerm,\n        defaultPaymentMethod,\n      });\n      \n      res.json({ success: true, message: \"Fee settings updated\", data: updatedTenant });\n    } catch (error) {\n      console.error(\"Error updating fee settings:\", error);\n      res.status(500).json({ message: \"Failed to update fee settings\" });\n    }\n  });\n\n  // Users routes\n  app.get(\"/api/users\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const users = await storage.getUsersByTenant(req.tenantId!);\n      res.json(users);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  app.post(\"/api/users\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const userData = insertUserSchema.parse(req.body);\n      const user = await storage.createUser({\n        ...userData,\n        tenantId: req.tenantId!,\n      });\n      res.status(201).json(user);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid user data\" });\n    }\n  });\n\n  app.put(\"/api/users/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const userData = insertUserSchema.partial().parse(req.body);\n      const user = await storage.updateUser(req.params.id, userData);\n      res.json(user);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid user data\" });\n    }\n  });\n\n  app.delete(\"/api/users/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      await storage.deleteUser(req.params.id);\n      res.json({ message: \"User deleted successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete user\" });\n    }\n  });\n\n  app.post(\"/api/users/:id/reset-password\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      // Generate a new temporary password\n      const newPassword = Math.random().toString(36).slice(-8);\n      const hashedPassword = await authService.hashPassword(newPassword);\n      await storage.updateUser(req.params.id, { passwordHash: hashedPassword });\n      \n      // In a real app, you would send this via email\n      res.json({ \n        message: \"Password reset successfully\",\n        temporaryPassword: newPassword \n      });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to reset password\" });\n    }\n  });\n\n  // Rules routes\n  app.get(\"/api/rules\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const rules = await storage.getRulesByTenant(req.tenantId!);\n      res.json(rules);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch rules\" });\n    }\n  });\n\n  app.post(\"/api/rules\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const ruleData = req.body;\n      const rule = await storage.createRule({\n        ...ruleData,\n        tenantId: req.tenantId!,\n      });\n      res.status(201).json(rule);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid rule data\" });\n    }\n  });\n\n  app.put(\"/api/rules/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const ruleData = req.body;\n      const rule = await storage.updateRule(req.params.id, ruleData);\n      res.json(rule);\n    } catch (error) {\n      res.status(400).json({ message: \"Invalid rule data\" });\n    }\n  });\n\n  app.delete(\"/api/rules/:id\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      await storage.deleteRule(req.params.id);\n      res.json({ message: \"Rule deleted successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete rule\" });\n    }\n  });\n\n  // Public screens routes\n  app.get(\"/api/public-screens\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const screens = await storage.getPublicScreensByTenant(req.tenantId!);\n      res.json(screens);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch public screens\" });\n    }\n  });\n\n  // Notifications routes\n  app.get(\"/api/notifications\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const notifications = await storage.getNotificationsByTenant(req.tenantId!);\n      res.json(notifications);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch notifications\" });\n    }\n  });\n\n  // SEPA export routes\n  app.get(\"/api/sepa-exports\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const exports = await storage.getSepaExportsByTenant(req.tenantId!);\n      res.json(exports);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch SEPA exports\" });\n    }\n  });\n\n  // Rolling fees API routes\n  app.post(\"/api/jobs/fees/generate\", generateFeesHandler);\n  \n  // Enhanced member creation with rolling fees\n  app.post(\"/api/members/create\", authMiddleware, tenantMiddleware, createMemberHandler);\n\n  // Public screens routes - some routes need auth, others are public\n  app.use(\"/api/public-screens\", publicScreensRouter);\n\n  // Card routes are handled by client-side React routing\n\n\n  // Card invalidation endpoint (authenticated)\n  app.post(\"/api/card/invalidate\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { memberId, tenantBrandingBump } = req.body;\n      \n      if (memberId) {\n        const cardData = await cardService.getCardData(memberId);\n        if (cardData && cardData.member.tenantId === req.tenantId) {\n          await cardService.invalidateCard(cardData.cardMeta.id);\n        }\n      }\n      \n      if (tenantBrandingBump) {\n        // TODO: Implement tenant branding version bump\n        // This would increment tenant.brandingVersion and invalidate all cards\n      }\n      \n      res.json({ success: true, message: \"Card invalidated\" });\n    } catch (error) {\n      console.error('Error invalidating card:', error);\n      res.status(500).json({ message: \"Failed to invalidate card\" });\n    }\n  });\n\n  // Get current tenant for card preview\n  app.get(\"/api/tenant/current\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const tenant = await storage.getTenant(req.tenantId!);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Tenant not found\" });\n      }\n      res.json(tenant);\n    } catch (error) {\n      console.error('Error fetching tenant:', error);\n      res.status(500).json({ message: \"Failed to fetch tenant\" });\n    }\n  });\n\n  // Card management endpoints for admin\n  app.get(\"/api/cards\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const cards = await storage.getAllCardsWithMembers(req.tenantId!);\n      res.json(cards);\n    } catch (error) {\n      console.error('Error fetching cards:', error);\n      res.status(500).json({ message: \"Failed to fetch cards\" });\n    }\n  });\n\n  app.get(\"/api/cards/stats\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const stats = await storage.getCardStats(req.tenantId!);\n      res.json(stats);\n    } catch (error) {\n      console.error('Error fetching card stats:', error);\n      res.status(500).json({ message: \"Failed to fetch card stats\" });\n    }\n  });\n\n  app.post(\"/api/cards/:memberId/create\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { memberId } = req.params;\n      const member = await storage.getMember(memberId);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      // Check if card already exists\n      const existingCard = await storage.getCardMetaByMember(memberId);\n      if (existingCard) {\n        return res.status(409).json({ message: \"Card already exists for this member\" });\n      }\n\n      const cardData = await cardService.getOrCreateCardMeta(memberId);\n      if (cardData) {\n        res.json({ success: true, message: \"Card created\", card: cardData });\n      } else {\n        res.status(500).json({ message: \"Failed to create card\" });\n      }\n    } catch (error) {\n      console.error('Error creating card:', error);\n      res.status(500).json({ message: \"Failed to create card\" });\n    }\n  });\n\n  app.post(\"/api/cards/:memberId/regenerate\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { memberId } = req.params;\n      const member = await storage.getMember(memberId);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      const cardData = await cardService.getOrCreateCardMeta(memberId);\n      if (cardData) {\n        await cardService.invalidateCard(memberId);\n        res.json({ success: true, message: \"Card regenerated\" });\n      } else {\n        res.status(500).json({ message: \"Failed to regenerate card\" });\n      }\n    } catch (error) {\n      console.error('Error regenerating card:', error);\n      res.status(500).json({ message: \"Failed to regenerate card\" });\n    }\n  });\n\n  app.post(\"/api/cards/:memberId/deactivate\", authMiddleware, tenantMiddleware, async (req, res) => {\n    try {\n      const { memberId } = req.params;\n      const member = await storage.getMember(memberId);\n      \n      if (!member || member.tenantId !== req.tenantId) {\n        return res.status(404).json({ message: \"Member not found\" });\n      }\n\n      const cardMeta = await storage.getCardMetaByMember(memberId);\n      if (cardMeta) {\n        await storage.updateCardMeta(cardMeta.id, { status: 'VERLOPEN' });\n        res.json({ success: true, message: \"Card deactivated\" });\n      } else {\n        res.status(404).json({ message: \"Card not found\" });\n      }\n    } catch (error) {\n      console.error('Error deactivating card:', error);\n      res.status(500).json({ message: \"Failed to deactivate card\" });\n    }\n  });\n\n  // Rate limiting for card verification (in-memory)\n  const verificationRateLimit = new Map<string, { count: number; resetTime: number }>();\n  const RATE_LIMIT_WINDOW_MS = 60 * 1000; // 1 minute\n  const RATE_LIMIT_MAX_REQUESTS = 30;\n\n  function checkRateLimit(ip: string): boolean {\n    const now = Date.now();\n    const userLimit = verificationRateLimit.get(ip);\n    \n    if (!userLimit || now > userLimit.resetTime) {\n      verificationRateLimit.set(ip, { count: 1, resetTime: now + RATE_LIMIT_WINDOW_MS });\n      return true;\n    }\n    \n    if (userLimit.count >= RATE_LIMIT_MAX_REQUESTS) {\n      return false;\n    }\n    \n    userLimit.count++;\n    return true;\n  }\n\n  // Card verification status logic\n  function deriveCardStatus(cardMeta: any, member: any, fees?: any[]): 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN' {\n    if (!member.active) {\n      return 'VERLOPEN';\n    }\n    \n    // Check if card is valid until date has passed\n    if (cardMeta.validUntil && new Date(cardMeta.validUntil) < new Date()) {\n      return 'VERLOPEN';\n    }\n    \n    // Check card meta status - this determines connectivity/sync status\n    if (cardMeta.status === 'VERLOPEN') {\n      return 'VERLOPEN';\n    }\n    \n    if (cardMeta.status === 'MOMENTOPNAME') {\n      return 'NIET_ACTUEEL';\n    }\n    \n    // ACTUEEL/NIET_ACTUEEL is about internet connectivity and database sync only\n    // Not about payment status - return the card's stored status\n    return cardMeta.status || 'ACTUEEL';\n  }\n\n  // Public card data API (JSON)\n  app.get(\"/api/card/:memberId\", async (req, res) => {\n    try {\n      const { memberId } = req.params;\n      \n      const cardData = await cardService.getCardData(memberId);\n      if (!cardData) {\n        return res.status(404).json({ message: \"Card not found\" });\n      }\n\n      // Check if member has paid for current year\n      const currentYear = new Date().getFullYear();\n      const memberFees = await storage.getMembershipFeesByMember(memberId);\n      const currentYearFees = memberFees.filter(fee => {\n        const feeYear = new Date(fee.periodStart).getFullYear();\n        return feeYear === currentYear;\n      });\n      const currentYearPaid = currentYearFees.some(fee => fee.status === 'PAID');\n\n      // Create badges array\n      const badges = [];\n      if (currentYearPaid) {\n        badges.push(`Betaald ${currentYear}`);\n      }\n      if (cardData.member.votingRights) {\n        badges.push(\"Stemgerechtigd\");\n      }\n\n      const response = {\n        memberId: cardData.member.id,\n        firstName: cardData.member.firstName,\n        lastName: cardData.member.lastName,\n        memberNumber: cardData.member.memberNumber,\n        category: cardData.member.category,\n        status: cardData.cardMeta.status,\n        validUntil: cardData.cardMeta.validUntil,\n        votingRights: cardData.member.votingRights || false,\n        badges,\n        qrToken: cardData.cardMeta.qrToken,\n        tenant: {\n          name: cardData.tenant.name,\n          logoUrl: cardData.tenant.logoUrl,\n          primaryColor: cardData.tenant.primaryColor || '#bb2e2e'\n        },\n        etag: cardData.cardMeta.etag\n      };\n\n      // Set ETag header for caching\n      res.set('ETag', cardData.cardMeta.etag);\n      res.json(response);\n    } catch (error) {\n      console.error('Error fetching card data:', error);\n      res.status(500).json({ message: \"Failed to fetch card data\" });\n    }\n  });\n\n  // Protected card verification API (requires staff authentication)\n  app.get(\"/api/card/verify/:qrToken\", quickAuthMiddleware, async (req, res) => {\n    try {\n      const { qrToken } = req.params;\n      const clientIp = req.ip || req.connection.remoteAddress || 'unknown';\n      \n      // Rate limiting\n      if (!checkRateLimit(clientIp)) {\n        return res.status(429).json({ \n          error: \"Te veel verzoeken. Probeer later opnieuw.\" \n        });\n      }\n\n      // Validate qrToken format\n      if (!qrToken || typeof qrToken !== 'string' || qrToken.length < 10) {\n        return res.status(404).json({ \n          error: \"Onbekende of ingetrokken code\" \n        });\n      }\n\n      // Lookup card by qrToken\n      const cardMeta = await storage.getCardMetaByQrToken(qrToken);\n      if (!cardMeta) {\n        return res.status(404).json({ \n          error: \"Onbekende of ingetrokken code\" \n        });\n      }\n\n      // Get member and tenant info\n      const member = await storage.getMember(cardMeta.memberId);\n      const tenant = await storage.getTenant(cardMeta.tenantId);\n      \n      if (!member || !tenant) {\n        return res.status(404).json({ \n          error: \"Onbekende of ingetrokken code\" \n        });\n      }\n\n      // Get member fees for status calculation and payment info\n      const memberFees = await storage.getMembershipFeesByMember(member.id);\n      \n      // Derive current status\n      const status = deriveCardStatus(cardMeta, member, memberFees);\n      \n      // Format valid until date (Belgian format)\n      const validUntil = cardMeta.validUntil ? \n        new Date(cardMeta.validUntil).toLocaleDateString('nl-BE', {\n          day: '2-digit',\n          month: '2-digit', \n          year: 'numeric',\n          timeZone: 'Europe/Brussels'\n        }) : null;\n\n      // Check voting rights (default false if not set)\n      const eligibleToVote = member.votingRights || false;\n\n      // Get member category label\n      const categoryLabels = {\n        'STUDENT': 'Student',\n        'STANDAARD': 'Standaard', \n        'SENIOR': 'Senior'\n      };\n      const category = categoryLabels[member.category] || member.category;\n\n      // Calculate age from birth date\n      let age = null;\n      if (member.birthDate) {\n        const birthDate = new Date(member.birthDate);\n        const today = new Date();\n        age = today.getFullYear() - birthDate.getFullYear();\n        const monthDiff = today.getMonth() - birthDate.getMonth();\n        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n          age--;\n        }\n      }\n\n      // Process fees for payment information (recent fees only, last 2 years)\n      const cutoffDate = new Date();\n      cutoffDate.setFullYear(cutoffDate.getFullYear() - 2);\n      \n      const recentFees = memberFees\n        .filter(fee => new Date(fee.periodStart) >= cutoffDate)\n        .sort((a, b) => new Date(b.periodStart).getTime() - new Date(a.periodStart).getTime())\n        .slice(0, 6) // Limit to last 6 fees\n        .map(fee => ({\n          id: fee.id,\n          period: `${new Date(fee.periodStart).getFullYear()}`,\n          amount: fee.amount,\n          status: fee.status,\n          periodEnd: new Date(fee.periodEnd).toLocaleDateString('nl-BE', {\n            day: '2-digit',\n            month: '2-digit', \n            year: 'numeric',\n            timeZone: 'Europe/Brussels'\n          }),\n          paidAt: fee.paidAt ? new Date(fee.paidAt).toLocaleDateString('nl-BE', {\n            day: '2-digit',\n            month: '2-digit', \n            year: 'numeric',\n            timeZone: 'Europe/Brussels'\n          }) : null\n        }));\n\n      // Get board member status\n      let boardInfo = null;\n      try {\n        const boardMember = await boardService.getBoardMemberByMemberId(null, member.id);\n        if (boardMember && boardMember.boardMember?.status === 'ACTIEF') {\n          boardInfo = {\n            isActiveBoardMember: true,\n            role: boardMember.boardMember.role,\n            customRole: boardMember.boardMember.customRole\n          };\n        }\n      } catch (error) {\n        console.error('Error fetching board member status:', error);\n        // Continue without board info\n      }\n\n      // Calculate payment status summary\n      const outstandingFees = recentFees.filter(fee => fee.status === 'PENDING' || fee.status === 'OVERDUE' || fee.status === 'OPEN');\n      const paidFees = recentFees.filter(fee => fee.status === 'PAID');\n      \n      let paymentStatusSummary = 'Alles is betaald';\n      let paymentDetails = [];\n      \n      if (outstandingFees.length > 0) {\n        const overdueFees = outstandingFees.filter(fee => fee.status === 'OVERDUE');\n        const pendingFees = outstandingFees.filter(fee => fee.status === 'PENDING' || fee.status === 'OPEN');\n        \n        // Create detailed lists with periods\n        if (overdueFees.length > 0) {\n          const overdueList = overdueFees.map(fee => {\n            const periodStart = new Date(fee.periodEnd).toLocaleDateString('nl-BE', { month: 'short', year: 'numeric' });\n            return `${periodStart} (€${fee.amount})`;\n          }).join(', ');\n          paymentDetails.push(`Vervallen: ${overdueList}`);\n        }\n        \n        if (pendingFees.length > 0) {\n          const pendingList = pendingFees.map(fee => {\n            const periodStart = new Date(fee.periodEnd).toLocaleDateString('nl-BE', { month: 'short', year: 'numeric' });\n            return `${periodStart} (€${fee.amount})`;\n          }).join(', ');\n          paymentDetails.push(`Openstaand: ${pendingList}`);\n        }\n        \n        // Create summary\n        const overdueCount = overdueFees.length;\n        const pendingCount = pendingFees.length;\n        \n        if (overdueCount > 0 && pendingCount > 0) {\n          paymentStatusSummary = `${overdueCount} vervallen en ${pendingCount} openstaande betalingen`;\n        } else if (overdueCount > 0) {\n          paymentStatusSummary = `${overdueCount} vervallen ${overdueCount === 1 ? 'betaling' : 'betalingen'}`;\n        } else {\n          paymentStatusSummary = `${pendingCount} openstaande ${pendingCount === 1 ? 'betaling' : 'betalingen'}`;\n        }\n      }\n\n      const response = {\n        status,\n        validUntil,\n        eligibleToVote,\n        member: {\n          name: `${member.firstName} ${member.lastName}`,\n          memberNumber: member.memberNumber,\n          category,\n          age\n        },\n        tenant: {\n          name: tenant.name,\n          logoUrl: tenant.logoUrl\n        },\n        fees: recentFees,\n        paymentStatus: {\n          summary: paymentStatusSummary,\n          details: paymentDetails,\n          totalOutstanding: outstandingFees.length,\n          totalPaid: paidFees.length,\n          hasOutstanding: outstandingFees.length > 0\n        },\n        boardInfo,\n        refreshedAt: new Date().toISOString(),\n        etag: cardMeta.etag\n      };\n\n      // Set headers\n      res.set({\n        'Cache-Control': 'no-store',\n        'Content-Type': 'application/json; charset=utf-8'\n      });\n      \n      if (cardMeta.etag) {\n        res.set('ETag', cardMeta.etag);\n      }\n\n      res.json(response);\n      \n    } catch (error) {\n      console.error('Error in card verification:', error);\n      res.status(500).json({ \n        error: \"Er ging iets mis. Probeer opnieuw.\" \n      });\n    }\n  });\n\n  // Public card API endpoint (no authentication required) - for standalone public viewing\n  app.get(\"/api/public/card/:memberId\", async (req, res) => {\n    try {\n      const { memberId } = req.params;\n\n      // Get member data\n      const member = await storage.getMember(memberId);\n      if (!member || !member.active) {\n        return res.status(404).json({ message: \"Card not found\" });\n      }\n\n      // Get tenant data\n      const tenant = await storage.getTenant(member.tenantId);\n      if (!tenant) {\n        return res.status(404).json({ message: \"Organization not found\" });\n      }\n\n      // Get or create card metadata\n      let cardMeta = await storage.getCardMetaByMember(memberId);\n      if (!cardMeta) {\n        cardMeta = await storage.createCardMeta({\n          memberId,\n          tenantId: member.tenantId,\n          qrToken: randomBytes(32).toString('hex'),\n          validUntil: new Date(new Date().getFullYear(), 11, 31), // End of current year\n          etag: makeCardETag(\n            {\n              id: member.id,\n              firstName: member.firstName,\n              lastName: member.lastName,\n              memberNumber: member.memberNumber,\n              category: member.category,\n              votingRights: member.votingRights || false,\n            },\n            {\n              name: tenant.name,\n              logoUrl: tenant.logoUrl,\n              primaryColor: tenant.primaryColor || '#bb2e2e',\n            },\n            'ACTUEEL',\n            new Date(new Date().getFullYear(), 11, 31),\n            []\n          )\n        });\n      }\n\n      // Get member fees for status calculation\n      const memberFees = await storage.getMembershipFeesByMember(memberId);\n      \n      // Derive current status\n      const status = await computeCardStatus(memberId);\n\n      // Build response\n      const response = {\n        memberId: member.id,\n        firstName: member.firstName,\n        lastName: member.lastName,\n        memberNumber: member.memberNumber,\n        category: member.category,\n        votingRights: member.votingRights || false,\n        status,\n        validUntil: cardMeta.validUntil,\n        qrToken: cardMeta.qrToken,\n        tenant: {\n          id: tenant.id,\n          name: tenant.name,\n          logoUrl: tenant.logoUrl\n        }\n      };\n\n      // Set cache headers for 10 seconds\n      res.set('Cache-Control', 'public, max-age=10');\n      res.json(response);\n    } catch (error) {\n      console.error('Error fetching public card data:', error);\n      res.status(500).json({ message: \"Failed to fetch card data\" });\n    }\n  });\n\n  // Card lifecycle management endpoints\n  app.post('/api/members/:id/card/refresh-validuntil', authMiddleware, async (req, res) => {\n    try {\n      const memberId = req.params.id;\n      \n      // Verify member belongs to user's tenant\n      const member = await storage.getMember(memberId);\n      if (!member || !req.user || member.tenantId !== req.user.tenantId) {\n        return res.status(404).json({ error: \"Lid niet gevonden\" });\n      }\n      \n      // Import the service functions\n      const { updateMemberValidUntil } = await import('./lib/card/simple-validuntil');\n      const { computeCardStatus } = await import('./lib/card/status');\n      \n      // Update validUntil based on paid periods\n      const newValidUntil = await updateMemberValidUntil(memberId);\n      \n      // Get updated card status\n      const newStatus = await computeCardStatus(memberId);\n      \n      res.json({\n        memberId,\n        validUntil: newValidUntil?.toISOString() || null,\n        status: newStatus,\n        updatedAt: new Date().toISOString(),\n      });\n      \n    } catch (error) {\n      console.error('Error refreshing card validUntil:', error);\n      res.status(500).json({ error: \"Fout bij het vernieuwen van geldigheid\" });\n    }\n  });\n\n  app.get('/api/members/:id/card/status-details', authMiddleware, async (req, res) => {\n    try {\n      const memberId = req.params.id;\n      \n      // Verify member belongs to user's tenant  \n      const member = await storage.getMember(memberId);\n      if (!member || !req.user || member.tenantId !== req.user.tenantId) {\n        return res.status(404).json({ error: \"Lid niet gevonden\" });\n      }\n      \n      // Import and get detailed status\n      const { getCardStatusDetails } = await import('./lib/card/status');\n      const details = await getCardStatusDetails(memberId);\n      \n      res.json(details);\n      \n    } catch (error) {\n      console.error('Error getting card status details:', error);\n      res.status(500).json({ error: \"Fout bij het ophalen van kaart status\" });\n    }\n  });\n\n  app.post('/api/admin/rollover', authMiddleware, async (req, res) => {\n    try {\n      // Check for SUPERADMIN role\n      if (req.user!.role !== 'SUPERADMIN') {\n        return res.status(403).json({ error: \"Onvoldoende rechten voor deze actie\" });\n      }\n      \n      // Import rollover service\n      const { rolloverDaily } = await import('./lib/fees/rollover');\n      \n      const tenantId = req.body.tenantId || req.user!.tenantId;\n      const summary = await rolloverDaily(tenantId);\n      \n      res.json({\n        success: true,\n        summary,\n      });\n      \n    } catch (error) {\n      console.error('Error running rollover:', error);\n      res.status(500).json({ error: \"Fout bij het uitvoeren van rollover\" });\n    }\n  });\n\n  // Reconciliatie endpoints\n  \n  // Import bankafschrift\n  app.post('/api/finance/import', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { StatementImportService } = await import('../lib/reconcile/import');\n      const importService = new StatementImportService();\n      \n      // Voor demo - in productie zou dit file upload zijn\n      const { file, options } = req.body;\n      \n      const validation = importService.validateFile(file);\n      if (!validation.valid) {\n        return res.status(400).json({ \n          error: \"Bestand validatie mislukt\", \n          details: validation.errors \n        });\n      }\n      \n      const result = await importService.importStatement(\n        file, \n        options, \n        req.user!.tenantId, \n        req.user!.id\n      );\n      \n      res.json({\n        success: true,\n        statement: result.statement,\n        transactionCount: result.transactions.length,\n      });\n      \n    } catch (error) {\n      console.error('Import error:', error);\n      res.status(500).json({ \n        error: \"Fout bij importeren\", \n        message: error instanceof Error ? error.message : \"Onbekende fout\" \n      });\n    }\n  });\n\n  // Preview import zonder opslaan\n  app.post('/api/finance/import/preview', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { StatementImportService } = await import('../lib/reconcile/import');\n      const importService = new StatementImportService();\n      \n      const { file, options } = req.body;\n      const preview = await importService.previewTransactions(file, options);\n      \n      res.json(preview);\n      \n    } catch (error) {\n      console.error('Preview error:', error);\n      res.status(500).json({ \n        error: \"Fout bij preview\", \n        message: error instanceof Error ? error.message : \"Onbekende fout\" \n      });\n    }\n  });\n\n  // Bank statements lijst\n  app.get('/api/finance/statements', authMiddleware, async (req, res) => {\n    try {\n      // TODO: Implementeer database query voor bank statements\n      res.json([]);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen statements\" });\n    }\n  });\n\n  // Bank transacties met filters\n  app.get('/api/finance/bank-transactions', authMiddleware, async (req, res) => {\n    try {\n      // TODO: Implementeer database query met filters\n      const { status, from, to, side, category, vendor, q } = req.query;\n      res.json([]);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen transacties\" });\n    }\n  });\n\n  // Bevestig match\n  app.post('/api/finance/bank-transactions/:id/confirm', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const transactionId = req.params.id;\n      const { matchedFeeId, matchedMemberId, categoryId, vendorId } = req.body;\n      \n      // TODO: Implementeer database update\n      console.log(`Confirming match for transaction ${transactionId}`);\n      \n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij bevestigen match\" });\n    }\n  });\n\n  // Split transactie\n  app.post('/api/finance/bank-transactions/:id/split', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const transactionId = req.params.id;\n      const { splits } = req.body;\n      \n      // TODO: Implementeer split logica\n      console.log(`Splitting transaction ${transactionId}`);\n      \n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij splitsen transactie\" });\n    }\n  });\n\n  // Afkeuren transactie\n  app.post('/api/finance/bank-transactions/:id/reject', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const transactionId = req.params.id;\n      const { note } = req.body;\n      \n      // TODO: Implementeer reject logica\n      console.log(`Rejecting transaction ${transactionId}`);\n      \n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij afkeuren transactie\" });\n    }\n  });\n\n  // Boek transacties naar journaal\n  app.post('/api/finance/book', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { statementId, transactionIds } = req.body;\n      \n      // TODO: Implementeer booking logica\n      console.log(`Booking transactions`, { statementId, transactionIds });\n      \n      res.json({ success: true, bookedCount: transactionIds?.length || 0 });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij boeken transacties\" });\n    }\n  });\n\n  // Expense categories CRUD\n  app.get('/api/finance/categories', authMiddleware, async (req, res) => {\n    try {\n      // TODO: Implementeer database query\n      res.json([]);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen categorieën\" });\n    }\n  });\n\n  app.post('/api/finance/categories', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { name, code, color } = req.body;\n      // TODO: Implementeer database insert\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij aanmaken categorie\" });\n    }\n  });\n\n  // Vendors CRUD\n  app.get('/api/finance/vendors', authMiddleware, async (req, res) => {\n    try {\n      // TODO: Implementeer database query\n      res.json([]);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen leveranciers\" });\n    }\n  });\n\n  app.post('/api/finance/vendors', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { name, iban, defaultCategoryId } = req.body;\n      // TODO: Implementeer database insert\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij aanmaken leverancier\" });\n    }\n  });\n\n  // Match rules CRUD\n  app.get('/api/finance/rules', authMiddleware, async (req, res) => {\n    try {\n      // TODO: Implementeer database query\n      res.json([]);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen regels\" });\n    }\n  });\n\n  app.post('/api/finance/rules', authMiddleware, async (req, res) => {\n    try {\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Onvoldoende rechten\" });\n      }\n\n      const { name, priority, criteria, action } = req.body;\n      // TODO: Implementeer database insert\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij aanmaken regel\" });\n    }\n  });\n\n  // Rapportage endpoints\n  \n  // Cashflow rapportage\n  app.get('/api/reports/cashflow', authMiddleware, async (req, res) => {\n    try {\n      const { from, to, types, categories, methods, statuses } = req.query;\n      \n      // Mock data voor nu - TODO: Implementeer echte queries\n      const mockData = [\n        { date: '2024-01-01', income: 12500, expense: 8300, net: 4200 },\n        { date: '2024-01-02', income: 15600, expense: 9100, net: 6500 },\n        { date: '2024-01-03', income: 13400, expense: 7800, net: 5600 },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen cashflow data\" });\n    }\n  });\n\n  // Categorie breakdown\n  app.get('/api/reports/categories', authMiddleware, async (req, res) => {\n    try {\n      const { kind = 'expense', from, to } = req.query;\n      \n      // Mock data - TODO: Implementeer echte aggregatie\n      const mockData = [\n        { category: 'Lidgelden', amount: 25000, count: 120 },\n        { category: 'Nutsvoorzieningen', amount: 4500, count: 12 },\n        { category: 'Onderhoud', amount: 3200, count: 8 },\n        { category: 'Verzekeringen', amount: 2800, count: 4 },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen categorie data\" });\n    }\n  });\n\n  // Gestapelde categorie data per maand\n  app.get('/api/reports/stacked-by-category', authMiddleware, async (req, res) => {\n    try {\n      // Mock data - TODO: Implementeer echte aggregatie\n      const mockData = [\n        { month: '2024-01', 'Lidgelden': 8500, 'Nutsvoorzieningen': 1200, 'Onderhoud': 800 },\n        { month: '2024-02', 'Lidgelden': 9200, 'Nutsvoorzieningen': 1100, 'Onderhoud': 600 },\n        { month: '2024-03', 'Lidgelden': 7800, 'Nutsvoorzieningen': 1300, 'Onderhoud': 1200 },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen gestapelde data\" });\n    }\n  });\n\n  // Fee status trend\n  app.get('/api/reports/fee-status-trend', authMiddleware, async (req, res) => {\n    try {\n      // Mock data - TODO: Implementeer echte aggregatie\n      const mockData = [\n        { month: '2024-01', betaald: 85, openstaand: 25, vervallen: 5 },\n        { month: '2024-02', betaald: 92, openstaand: 18, vervallen: 8 },\n        { month: '2024-03', betaald: 88, openstaand: 22, vervallen: 6 },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen fee status trend\" });\n    }\n  });\n\n  // Top leden per bedrag\n  app.get('/api/reports/top-members', authMiddleware, async (req, res) => {\n    try {\n      // Mock data - TODO: Implementeer echte aggregatie\n      const mockData = [\n        { memberId: '1', name: 'Jan Janssen', total: 2500, count: 12, spark: [200, 220, 180, 250, 300] },\n        { memberId: '2', name: 'Marie Peeters', total: 2200, count: 11, spark: [180, 200, 210, 190, 220] },\n        { memberId: '3', name: 'Ahmed Hassan', total: 1950, count: 10, spark: [195, 180, 200, 175, 210] },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen top leden data\" });\n    }\n  });\n\n  // Betaalmethode breakdown\n  app.get('/api/reports/methods', authMiddleware, async (req, res) => {\n    try {\n      // Mock data - TODO: Implementeer echte aggregatie\n      const mockData = [\n        { method: 'SEPA', amount: 18500, count: 85 },\n        { method: 'OVERSCHRIJVING', amount: 6200, count: 25 },\n        { method: 'BANCONTACT', amount: 1800, count: 12 },\n        { method: 'CASH', amount: 950, count: 8 },\n        { method: 'OVERIG', amount: 450, count: 3 },\n      ];\n      \n      res.json(mockData);\n    } catch (error) {\n      res.status(500).json({ error: \"Fout bij ophalen betaalmethode data\" });\n    }\n  });\n\n  // Rule validation endpoints\n  app.get('/api/members/:id/voting-rights', authMiddleware, async (req, res) => {\n    try {\n      const memberId = req.params.id;\n      const tenantId = req.user!.tenantId;\n\n      // Verify member belongs to user's tenant\n      const member = await storage.getMember(memberId);\n      if (!member || member.tenantId !== tenantId) {\n        return res.status(404).json({ error: \"Lid niet gevonden\" });\n      }\n\n      const status = await ruleService.getVotingRightsStatus(memberId, tenantId);\n      res.json(status);\n    } catch (error) {\n      console.error('Error getting voting rights:', error);\n      res.status(500).json({ error: \"Fout bij ophalen stemrecht status\" });\n    }\n  });\n\n  app.post('/api/members/:id/voting-rights/override', authMiddleware, async (req, res) => {\n    try {\n      const memberId = req.params.id;\n      const tenantId = req.user!.tenantId;\n      const { overrideValue, reason } = req.body;\n\n      // Verify member belongs to user's tenant\n      const member = await storage.getMember(memberId);\n      if (!member || member.tenantId !== tenantId) {\n        return res.status(404).json({ error: \"Lid niet gevonden\" });\n      }\n\n      // Validate input\n      if (typeof overrideValue !== 'boolean' || !reason || typeof reason !== 'string') {\n        return res.status(400).json({ error: \"Ongeldige parameters\" });\n      }\n\n      const override = await ruleService.createRuleOverride(\n        memberId,\n        tenantId,\n        'STEMRECHT',\n        overrideValue,\n        reason,\n        req.user!.id\n      );\n\n      // Get updated status\n      const updatedStatus = await ruleService.getVotingRightsStatus(memberId, tenantId);\n\n      res.json({\n        override,\n        status: updatedStatus\n      });\n    } catch (error) {\n      console.error('Error creating voting rights override:', error);\n      res.status(500).json({ error: \"Fout bij aanmaken stemrecht override\" });\n    }\n  });\n\n  // Public board member status endpoint (no auth required)\n  app.get('/api/public/board-status/:memberId', async (req, res) => {\n    try {\n      const memberId = req.params.memberId;\n      \n      if (!memberId) {\n        return res.status(400).json({ error: \"Member ID vereist\" });\n      }\n\n      // Get board member status for the given member\n      const boardMember = await boardService.getBoardMemberByMemberId(null, memberId);\n      \n      if (!boardMember) {\n        return res.json({ isActiveBoardMember: false });\n      }\n\n      res.json({\n        isActiveBoardMember: boardMember.boardMember?.status === 'ACTIEF',\n        role: boardMember.boardMember?.role\n      });\n    } catch (error) {\n      console.error('Error fetching public board member status:', error);\n      res.status(500).json({ error: \"Fout bij ophalen bestuursstatus\" });\n    }\n  });\n\n  // Board member endpoints\n  app.get('/api/board/members', authMiddleware, async (req, res) => {\n    try {\n      const tenantId = req.user!.tenantId;\n      \n      // Special case: lookup by memberId for crown highlighting\n      if (req.query.memberId) {\n        const boardMember = await boardService.getBoardMemberByMemberId(tenantId, req.query.memberId as string);\n        return res.json(boardMember ? [boardMember] : []);\n      }\n\n      const filters = {\n        status: req.query.status as 'ACTIEF' | 'INACTIEF' | undefined,\n        role: req.query.role as string | undefined,\n        q: req.query.q as string | undefined,\n      };\n\n      const boardMembers = await boardService.listBoardMembers(tenantId, filters);\n      res.json(boardMembers);\n    } catch (error) {\n      console.error('Error fetching board members:', error);\n      res.status(500).json({ error: \"Fout bij ophalen bestuursleden\" });\n    }\n  });\n\n  app.get('/api/board/members/:id', authMiddleware, async (req, res) => {\n    try {\n      const tenantId = req.user!.tenantId;\n      const boardMember = await boardService.getBoardMember(tenantId, req.params.id);\n      \n      if (!boardMember) {\n        return res.status(404).json({ error: \"Bestuurslid niet gevonden\" });\n      }\n\n      res.json(boardMember);\n    } catch (error) {\n      console.error('Error fetching board member:', error);\n      res.status(500).json({ error: \"Fout bij ophalen bestuurslid\" });\n    }\n  });\n\n  app.post('/api/board/members', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can create\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const tenantId = req.user!.tenantId;\n      \n      // Validate data without tenantId first, then add it\n      const boardMemberDataSchema = insertBoardMemberSchema.omit({ tenantId: true });\n      const validatedData = boardMemberDataSchema.parse(req.body);\n      \n      // Add tenantId after validation\n      const dataWithTenant = {\n        ...validatedData,\n        tenantId: tenantId\n      };\n\n      const boardMember = await boardService.createBoardMember(tenantId, dataWithTenant);\n      res.json(boardMember);\n    } catch (error) {\n      console.error('Error creating board member:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: \"Ongeldige gegevens\", details: error.errors });\n      }\n      res.status(500).json({ error: \"Fout bij aanmaken bestuurslid\" });\n    }\n  });\n\n  app.put('/api/board/members/:id', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can update\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const tenantId = req.user!.tenantId;\n      const validatedData = insertBoardMemberSchema.partial().parse(req.body);\n\n      const boardMember = await boardService.updateBoardMember(tenantId, req.params.id, validatedData);\n      \n      if (!boardMember) {\n        return res.status(404).json({ error: \"Bestuurslid niet gevonden\" });\n      }\n\n      res.json(boardMember);\n    } catch (error) {\n      console.error('Error updating board member:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: \"Ongeldige gegevens\", details: error.errors });\n      }\n      res.status(500).json({ error: \"Fout bij bijwerken bestuurslid\" });\n    }\n  });\n\n  app.post('/api/board/members/:id/end-term', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can end terms\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const tenantId = req.user!.tenantId;\n      const { endDate, note } = req.body;\n\n      const result = await boardService.endActiveTerm(\n        tenantId, \n        req.params.id, \n        new Date(endDate), \n        note\n      );\n\n      res.json({ success: result });\n    } catch (error) {\n      console.error('Error ending board term:', error);\n      res.status(500).json({ error: \"Fout bij beëindigen mandaat\" });\n    }\n  });\n\n  app.post('/api/board/reorder', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can reorder\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const tenantId = req.user!.tenantId;\n      const orderData = req.body; // { id: string; orderIndex: number }[]\n\n      const result = await boardService.reorderBoard(tenantId, orderData);\n      res.json({ success: result });\n    } catch (error) {\n      console.error('Error reordering board:', error);\n      res.status(500).json({ error: \"Fout bij herordenen bestuur\" });\n    }\n  });\n\n  app.get('/api/board/members/by-member/:memberId', authMiddleware, async (req, res) => {\n    try {\n      const tenantId = req.user!.tenantId;\n      const memberId = req.params.memberId;\n\n      const boardMember = await boardService.getBoardMemberByMemberId(tenantId, memberId);\n      res.json(boardMember);\n    } catch (error) {\n      console.error('Error fetching board member by member ID:', error);\n      res.status(500).json({ error: \"Fout bij ophalen bestuurslid\" });\n    }\n  });\n\n  // Email Messaging Routes\n  const { EmailService } = await import('./services/email.js');\n  const emailService = new EmailService();\n\n  // Templates\n  app.get('/api/messages/templates', authMiddleware, async (req, res) => {\n    try {\n      const templates = await emailService.listTemplates(req.user!.tenantId);\n      // Add no-cache headers to prevent duplicates\n      res.set({\n        'Cache-Control': 'no-store, no-cache, must-revalidate',\n        'Pragma': 'no-cache',\n        'Expires': '0'\n      });\n      res.json(templates);\n    } catch (error) {\n      console.error('Error fetching templates:', error);\n      res.status(500).json({ error: \"Fout bij ophalen templates\" });\n    }\n  });\n\n  app.post('/api/messages/templates', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can create\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const template = await emailService.createTemplate(req.user!.tenantId, req.body);\n      res.json(template);\n    } catch (error) {\n      console.error('Error creating template:', error);\n      res.status(500).json({ error: \"Fout bij aanmaken template\" });\n    }\n  });\n\n  app.put('/api/messages/templates/:id', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can update\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const template = await emailService.updateTemplate(req.user!.tenantId, req.params.id, req.body);\n      res.json(template);\n    } catch (error) {\n      console.error('Error updating template:', error);\n      res.status(500).json({ error: \"Fout bij bijwerken template\" });\n    }\n  });\n\n  app.delete('/api/messages/templates/:id', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can delete\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      await emailService.deleteTemplate(req.user!.tenantId, req.params.id);\n      res.status(204).send();\n    } catch (error) {\n      console.error('Error deleting template:', error);\n      res.status(500).json({ error: \"Fout bij verwijderen template\" });\n    }\n  });\n\n  app.post('/api/messages/templates/:id/test', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can send test\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const { toEmail, sampleContext } = req.body;\n      await emailService.sendTestEmail(req.user!.tenantId, req.params.id, toEmail, sampleContext);\n      res.json({ success: true });\n    } catch (error) {\n      console.error('Error sending test email:', error);\n      res.status(500).json({ error: \"Fout bij verzenden testmail\" });\n    }\n  });\n\n  // Segments\n  app.get('/api/messages/segments', authMiddleware, async (req, res) => {\n    try {\n      const segments = await emailService.listSegments(req.user!.tenantId);\n      res.json(segments);\n    } catch (error) {\n      console.error('Error fetching segments:', error);\n      res.status(500).json({ error: \"Fout bij ophalen segmenten\" });\n    }\n  });\n\n  app.post('/api/messages/segments', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can create\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const segment = await emailService.createSegment(req.user!.tenantId, req.body);\n      res.json(segment);\n    } catch (error) {\n      console.error('Error creating segment:', error);\n      res.status(500).json({ error: \"Fout bij aanmaken segment\" });\n    }\n  });\n\n  app.delete('/api/messages/segments/:id', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can delete\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      await emailService.deleteSegment(req.user!.tenantId, req.params.id);\n      res.status(204).send();\n    } catch (error) {\n      console.error('Error deleting segment:', error);\n      res.status(500).json({ error: \"Fout bij verwijderen segment\" });\n    }\n  });\n\n  app.post('/api/messages/segments/:id/preview', authMiddleware, async (req, res) => {\n    try {\n      const segment = await db.select()\n        .from(emailSegments)\n        .where(and(\n          eq(emailSegments.tenantId, req.user!.tenantId),\n          eq(emailSegments.id, req.params.id)\n        ))\n        .limit(1);\n\n      if (!segment[0]) {\n        return res.status(404).json({ error: \"Segment niet gevonden\" });\n      }\n\n      const preview = await emailService.previewSegment(req.user!.tenantId, segment[0].rules);\n      res.json(preview);\n    } catch (error) {\n      console.error('Error previewing segment:', error);\n      res.status(500).json({ error: \"Fout bij preview segment\" });\n    }\n  });\n\n  // Campaigns\n  app.get('/api/messages/campaigns', authMiddleware, async (req, res) => {\n    try {\n      const campaigns = await emailService.listCampaigns(req.user!.tenantId);\n      res.json(campaigns);\n    } catch (error) {\n      console.error('Error fetching campaigns:', error);\n      res.status(500).json({ error: \"Fout bij ophalen campagnes\" });\n    }\n  });\n\n\n  app.post('/api/messages/campaigns', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can create\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const campaign = await emailService.createCampaign(req.user!.tenantId, {\n        ...req.body,\n        createdById: req.user!.id,\n      });\n      res.json(campaign);\n    } catch (error) {\n      console.error('Error creating campaign:', error);\n      res.status(500).json({ error: \"Fout bij aanmaken campagne\" });\n    }\n  });\n\n  app.post('/api/messages/campaigns/:id/queue', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can queue\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const result = await emailService.queueCampaign(req.user!.tenantId, req.params.id);\n      res.json(result);\n    } catch (error) {\n      console.error('Error queuing campaign:', error);\n      res.status(500).json({ error: \"Fout bij in queue zetten campagne\" });\n    }\n  });\n\n  // Worker endpoint\n  app.post('/api/messages/worker/tick', async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 50;\n      const result = await emailService.processQueuedMessages(limit);\n      res.json(result);\n    } catch (error) {\n      console.error('Error processing queued messages:', error);\n      res.status(500).json({ error: \"Fout bij verwerken berichten\" });\n    }\n  });\n\n  // Tracking endpoints\n  app.get('/api/messages/track/open/:messageId/:token.png', async (req, res) => {\n    try {\n      await emailService.trackOpen(req.params.messageId, req.params.token);\n      \n      // Return 1x1 transparent PNG\n      const img = Buffer.from('iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=', 'base64');\n      res.writeHead(200, {\n        'Content-Type': 'image/png',\n        'Content-Length': img.length,\n        'Cache-Control': 'no-cache',\n      });\n      res.end(img);\n    } catch (error) {\n      console.error('Error tracking open:', error);\n      res.status(404).end();\n    }\n  });\n\n  app.get('/api/messages/track/click/:messageId/:token', async (req, res) => {\n    try {\n      const originalUrl = decodeURIComponent(req.query.u as string);\n      const redirectUrl = await emailService.trackClick(req.params.messageId, req.params.token, originalUrl);\n      \n      if (redirectUrl) {\n        res.redirect(302, redirectUrl);\n      } else {\n        res.status(404).send('Link not found');\n      }\n    } catch (error) {\n      console.error('Error tracking click:', error);\n      res.status(404).send('Link not found');\n    }\n  });\n\n  // Single transactional send\n  app.post('/api/messages/send', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can send\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const { templateCode, memberId, email, context } = req.body;\n      \n      const message = await emailService.sendTransactional(req.user!.tenantId, templateCode, {\n        memberId,\n        email,\n        context,\n      });\n      \n      res.json(message);\n    } catch (error) {\n      console.error('Error sending transactional email:', error);\n      res.status(500).json({ error: \"Fout bij verzenden e-mail\" });\n    }\n  });\n\n  // Composer send - sends to multiple recipients of different types\n  app.post('/api/messages/composer/send', authMiddleware, async (req, res) => {\n    try {\n      // Check permissions - only BEHEERDER and SUPERADMIN can send\n      if (req.user!.role === 'MEDEWERKER') {\n        return res.status(403).json({ error: \"Geen toegang\" });\n      }\n\n      const { recipients, subject, content } = req.body;\n      \n      if (!recipients || !Array.isArray(recipients) || recipients.length === 0) {\n        return res.status(400).json({ error: \"Geadresseerden zijn vereist\" });\n      }\n      \n      if (!subject || !content) {\n        return res.status(400).json({ error: \"Onderwerp en inhoud zijn vereist\" });\n      }\n\n      let totalRecipients = 0;\n      const results = [];\n\n      // Process each recipient based on type\n      for (const recipient of recipients) {\n        if (recipient.type === 'member') {\n          // Send to individual member\n          try {\n            const context = await emailService.buildMemberContext(req.user!.tenantId, recipient.value);\n            \n            // Create a temporary template for this message\n            const tempTemplate = {\n              subject,\n              body_html: emailService.convertToHTML(content),\n              body_text: content,\n            };\n            \n            const rendered = await emailService.renderTemplate(tempTemplate, context);\n            \n            // Send directly via transporter\n            await emailService.transporter.sendMail({\n              from: process.env.SMTP_FROM,\n              to: context.member.email,\n              subject: rendered.subject,\n              html: rendered.html,\n              text: rendered.text,\n            });\n            \n            totalRecipients++;\n            results.push({ type: 'member', recipient: context.member.email, status: 'sent' });\n          } catch (error) {\n            console.error('Error sending to member:', error);\n            results.push({ type: 'member', recipient: recipient.value, status: 'failed', error: error.message });\n          }\n        } else if (recipient.type === 'segment') {\n          // Send to all members in segment\n          try {\n            const segment = await emailService.getSegment(req.user!.tenantId, recipient.value);\n            if (segment) {\n              const preview = await emailService.previewSegment(req.user!.tenantId, segment.rules);\n              \n              for (const member of preview.sample) {\n                try {\n                  const context = await emailService.buildMemberContext(req.user!.tenantId, member.id);\n                  \n                  const tempTemplate = {\n                    subject,\n                    body_html: emailService.convertToHTML(content),\n                    body_text: content,\n                  };\n                  \n                  const rendered = await emailService.renderTemplate(tempTemplate, context);\n                  \n                  await emailService.transporter.sendMail({\n                    from: process.env.SMTP_FROM,\n                    to: context.member.email,\n                    subject: rendered.subject,\n                    html: rendered.html,\n                    text: rendered.text,\n                  });\n                  \n                  totalRecipients++;\n                  results.push({ type: 'segment', recipient: context.member.email, status: 'sent' });\n                } catch (error) {\n                  console.error('Error sending to segment member:', error);\n                  results.push({ type: 'segment', recipient: member.email, status: 'failed', error: error.message });\n                }\n              }\n            }\n          } catch (error) {\n            console.error('Error processing segment:', error);\n            results.push({ type: 'segment', recipient: recipient.value, status: 'failed', error: error.message });\n          }\n        } else if (recipient.type === 'email') {\n          // Send to direct email\n          try {\n            const context = {\n              member: { firstName: 'Geachte', lastName: 'heer/mevrouw', email: recipient.value },\n              tenant: { name: 'Organisatie' },\n              card: { url: '#' },\n              fees: [],\n            };\n            \n            const tempTemplate = {\n              subject,\n              body_html: emailService.convertToHTML(content),\n              body_text: content,\n            };\n            \n            const rendered = await emailService.renderTemplate(tempTemplate, context);\n            \n            await emailService.transporter.sendMail({\n              from: process.env.SMTP_FROM,\n              to: recipient.value,\n              subject: rendered.subject,\n              html: rendered.html,\n              text: rendered.text,\n            });\n            \n            totalRecipients++;\n            results.push({ type: 'email', recipient: recipient.value, status: 'sent' });\n          } catch (error) {\n            console.error('Error sending to email:', error);\n            results.push({ type: 'email', recipient: recipient.value, status: 'failed', error: error.message });\n          }\n        }\n      }\n      \n      res.json({ \n        message: `E-mail verzonden naar ${totalRecipients} geadresseerd(en)`,\n        totalRecipients,\n        results \n      });\n    } catch (error) {\n      console.error('Error sending composer email:', error);\n      res.status(500).json({ error: \"Fout bij verzenden e-mail\" });\n    }\n  });\n\n  // Unsubscribe route\n  app.get('/email/unsubscribe', async (req, res) => {\n    try {\n      const token = req.query.token as string;\n      \n      // In a real implementation, you would decode the token to get tenant and email\n      // For now, we'll create a simple unsubscribe page\n      res.send(`\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <title>Uitschrijven</title>\n          <meta charset=\"utf-8\">\n          <style>\n            body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }\n            .container { text-align: center; }\n            .success { color: #10b981; }\n          </style>\n        </head>\n        <body>\n          <div class=\"container\">\n            <h1>Uitschrijven</h1>\n            <p class=\"success\">Je bent succesvol uitgeschreven van marketing e-mails.</p>\n            <p>Je ontvangt nog steeds belangrijke transactionele berichten zoals betalingsherinneringen.</p>\n          </div>\n        </body>\n        </html>\n      `);\n    } catch (error) {\n      res.status(500).send('Er is een fout opgetreden');\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":92258},"server/storage.ts":{"content":"import { \n  tenants, \n  users, \n  members, \n  memberFinancialSettings,\n  memberPermissions,\n  mandates,\n  membershipFees,\n  transactions,\n  rules,\n  ruleOutcomes,\n  publicScreens,\n  announcements,\n  cardMeta,\n  notifications,\n  sepaExports,\n  emailTemplates,\n  emailSegments,\n  emailCampaigns,\n  emailMessages,\n  emailSuppresses,\n  type Tenant,\n  type User,\n  type Member,\n  type MemberFinancialSettings,\n  type MemberPermissions,\n  type MembershipFee,\n  type Transaction,\n  type Rule,\n  type RuleOutcome,\n  type PublicScreen,\n  type Announcement,\n  type CardMeta,\n  type Notification,\n  type SepaExport,\n  type EmailTemplate,\n  type EmailSegment,\n  type EmailCampaign,\n  type EmailMessage,\n  type EmailSuppress,\n  type InsertTenant,\n  type InsertUser,\n  type InsertMember,\n  type InsertMemberFinancialSettings,\n  type InsertMemberPermissions,\n  type InsertMembershipFee,\n  type InsertTransaction,\n  type InsertRule,\n  type InsertRuleOutcome,\n  type InsertPublicScreen,\n  type InsertAnnouncement,\n  type InsertCardMeta,\n  type InsertNotification,\n  type InsertSepaExport,\n  type InsertEmailTemplate,\n  type InsertEmailSegment,\n  type InsertEmailCampaign,\n  type InsertEmailMessage,\n  type InsertEmailSuppress,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, sql, gte, lte } from \"drizzle-orm\";\nimport { cache } from \"./cache\";\n\nexport interface IStorage {\n  // Tenants\n  getTenant(id: string): Promise<Tenant | undefined>;\n  getTenantBySlug(slug: string): Promise<Tenant | undefined>;\n  createTenant(tenant: InsertTenant): Promise<Tenant>;\n  updateTenant(id: string, tenant: Partial<InsertTenant>): Promise<Tenant>;\n\n  // Users\n  getUser(id: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUsersByTenant(tenantId: string): Promise<User[]>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, user: Partial<InsertUser>): Promise<User>;\n  updateUserPassword(userId: string, passwordHash: string): Promise<void>;\n  deleteUser(id: string): Promise<void>;\n\n  // Members\n  getMember(id: string): Promise<Member | undefined>;\n  getMembersByTenant(tenantId: string): Promise<Member[]>;\n  getMemberByNumber(tenantId: string, memberNumber: string): Promise<Member | undefined>;\n  getMemberByNameAndAddress(tenantId: string, firstName: string, lastName: string, street: string, number: string): Promise<Member | undefined>;\n  getNextAvailableMemberNumber(tenantId: string, startFrom?: string): Promise<string>;\n  createMember(member: InsertMember): Promise<Member>;\n  updateMember(id: string, member: Partial<InsertMember>): Promise<Member>;\n  deleteMember(id: string): Promise<void>;\n  \n  // Member Financial Settings\n  getMemberFinancialSettings(memberId: string): Promise<MemberFinancialSettings | undefined>;\n  createMemberFinancialSettings(settings: InsertMemberFinancialSettings): Promise<MemberFinancialSettings>;\n  updateMemberFinancialSettings(memberId: string, settings: Partial<InsertMemberFinancialSettings>): Promise<MemberFinancialSettings>;\n  \n  // Member Permissions\n  getMemberPermissions(memberId: string): Promise<MemberPermissions | undefined>;\n  createMemberPermissions(permissions: InsertMemberPermissions): Promise<MemberPermissions>;\n  updateMemberPermissions(memberId: string, permissions: Partial<InsertMemberPermissions>): Promise<MemberPermissions>;\n\n  // Membership Fees\n  getMembershipFee(id: string): Promise<MembershipFee | undefined>;\n  getMembershipFeesByTenant(tenantId: string): Promise<MembershipFee[]>;\n  getMembershipFeesByMember(memberId: string): Promise<MembershipFee[]>;\n  createMembershipFee(fee: InsertMembershipFee): Promise<MembershipFee>;\n  updateMembershipFee(id: string, fee: Partial<InsertMembershipFee>): Promise<MembershipFee>;\n  deleteMembershipFee(id: string, tenantId: string): Promise<void>;\n\n  // Transactions\n  getTransactionsByTenant(tenantId: string): Promise<Transaction[]>;\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n  updateTransaction(id: string, transaction: Partial<InsertTransaction>): Promise<Transaction>;\n  deleteTransaction(id: string): Promise<void>;\n  \n  // Dashboard\n  getDashboardStats(tenantId: string): Promise<any>;\n\n  // Rules\n  getRulesByTenant(tenantId: string): Promise<Rule[]>;\n  createRule(rule: InsertRule): Promise<Rule>;\n  updateRule(id: string, rule: Partial<InsertRule>): Promise<Rule>;\n  deleteRule(id: string): Promise<void>;\n\n  // Rule Outcomes\n  getRuleOutcomesByMember(memberId: string): Promise<RuleOutcome[]>;\n  createRuleOutcome(outcome: InsertRuleOutcome): Promise<RuleOutcome>;\n\n  // Public Screens\n  getPublicScreensByTenant(tenantId: string): Promise<PublicScreen[]>;\n  getPublicScreenByToken(token: string): Promise<PublicScreen | undefined>;\n  createPublicScreen(screen: InsertPublicScreen): Promise<PublicScreen>;\n\n  // Announcements\n  getAnnouncementsByTenant(tenantId: string): Promise<Announcement[]>;\n  createAnnouncement(announcement: InsertAnnouncement): Promise<Announcement>;\n\n  // Card Meta\n  getCardMetaByMember(memberId: string): Promise<CardMeta | undefined>;\n  getCardMetaByQrToken(qrToken: string): Promise<CardMeta | undefined>;\n  createCardMeta(cardMeta: InsertCardMeta): Promise<CardMeta>;\n  updateCardMeta(id: string, cardMeta: Partial<InsertCardMeta>): Promise<CardMeta>;\n  getMemberWithCardAndTenant(memberId: string): Promise<{ member: Member; cardMeta: CardMeta; tenant: Tenant } | undefined>;\n  getAllCardsWithMembers(tenantId: string): Promise<{ member: Member; cardMeta: CardMeta | null }[]>;\n  getCardStats(tenantId: string): Promise<{ totalActive: number; validPercentage: number; lastUpdated: Date | null }>;\n\n  // Notifications\n  getNotificationsByTenant(tenantId: string): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n\n  // SEPA Exports\n  getSepaExportsByTenant(tenantId: string): Promise<SepaExport[]>;\n  createSepaExport(sepaExport: InsertSepaExport): Promise<SepaExport>;\n\n  // Dashboard stats\n  getDashboardStats(tenantId: string): Promise<{\n    totalMembers: number;\n    activeMembers: number;\n    totalRevenue: number;\n    outstanding: number;\n    monthlyIncome: number;\n  }>;\n\n  // Email Templates\n  getEmailTemplatesByTenant(tenantId: string): Promise<EmailTemplate[]>;\n  getEmailTemplate(tenantId: string, id: string): Promise<EmailTemplate | undefined>;\n  createEmailTemplate(template: InsertEmailTemplate): Promise<EmailTemplate>;\n  updateEmailTemplate(tenantId: string, id: string, template: Partial<InsertEmailTemplate>): Promise<EmailTemplate>;\n  deleteEmailTemplate(tenantId: string, id: string): Promise<void>;\n\n  // Email Segments\n  getEmailSegmentsByTenant(tenantId: string): Promise<EmailSegment[]>;\n  getEmailSegment(tenantId: string, id: string): Promise<EmailSegment | undefined>;\n  createEmailSegment(segment: InsertEmailSegment): Promise<EmailSegment>;\n  updateEmailSegment(tenantId: string, id: string, segment: Partial<InsertEmailSegment>): Promise<EmailSegment>;\n  deleteEmailSegment(tenantId: string, id: string): Promise<void>;\n\n  // Email Campaigns\n  getEmailCampaignsByTenant(tenantId: string): Promise<EmailCampaign[]>;\n  getEmailCampaign(tenantId: string, id: string): Promise<EmailCampaign | undefined>;\n  createEmailCampaign(campaign: InsertEmailCampaign): Promise<EmailCampaign>;\n  updateEmailCampaign(tenantId: string, id: string, campaign: Partial<InsertEmailCampaign>): Promise<EmailCampaign>;\n  deleteEmailCampaign(tenantId: string, id: string): Promise<void>;\n\n  // Email Messages\n  getEmailMessagesByTenant(tenantId: string): Promise<EmailMessage[]>;\n  getEmailMessagesByCampaign(tenantId: string, campaignId: string): Promise<EmailMessage[]>;\n  createEmailMessage(message: InsertEmailMessage): Promise<EmailMessage>;\n  updateEmailMessage(id: string, message: Partial<InsertEmailMessage>): Promise<EmailMessage>;\n\n  // Email Suppresses\n  getEmailSuppressesByTenant(tenantId: string): Promise<EmailSuppress[]>;\n  createEmailSuppress(suppress: InsertEmailSuppress): Promise<EmailSuppress>;\n  deleteEmailSuppress(tenantId: string, id: string): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Tenants\n  async getTenant(id: string): Promise<Tenant | undefined> {\n    const cacheKey = `tenant:${id}`;\n    const cached = cache.get<Tenant>(cacheKey);\n    if (cached) return cached;\n    \n    const [tenant] = await db.select().from(tenants).where(eq(tenants.id, id));\n    if (tenant) {\n      cache.set(cacheKey, tenant, 60000); // Cache for 1 minute\n    }\n    return tenant || undefined;\n  }\n\n  async getTenantBySlug(slug: string): Promise<Tenant | undefined> {\n    const [tenant] = await db.select().from(tenants).where(eq(tenants.slug, slug));\n    return tenant || undefined;\n  }\n\n  async createTenant(tenant: InsertTenant): Promise<Tenant> {\n    const [newTenant] = await db.insert(tenants).values(tenant).returning();\n    return newTenant;\n  }\n\n  async updateTenant(id: string, tenant: Partial<InsertTenant>): Promise<Tenant> {\n    const [updatedTenant] = await db.update(tenants).set(tenant).where(eq(tenants.id, id)).returning();\n    return updatedTenant;\n  }\n\n  // Users\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || undefined;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user || undefined;\n  }\n\n  async updateUserPassword(userId: string, passwordHash: string): Promise<void> {\n    await db.update(users)\n      .set({ passwordHash })\n      .where(eq(users.id, userId));\n  }\n\n  async getUsersByTenant(tenantId: string): Promise<User[]> {\n    return await db.select().from(users).where(eq(users.tenantId, tenantId));\n  }\n\n  async createUser(user: InsertUser): Promise<User> {\n    const [newUser] = await db.insert(users).values(user).returning();\n    return newUser;\n  }\n\n  async updateUser(id: string, user: Partial<InsertUser>): Promise<User> {\n    const [updatedUser] = await db.update(users).set(user).where(eq(users.id, id)).returning();\n    return updatedUser;\n  }\n\n  async deleteUser(id: string): Promise<void> {\n    await db.delete(users).where(eq(users.id, id));\n  }\n\n  // Members\n  async getMember(id: string): Promise<Member | undefined> {\n    const [member] = await db.select().from(members).where(eq(members.id, id));\n    return member || undefined;\n  }\n\n  async getMembersByTenant(tenantId: string): Promise<Member[]> {\n    const cacheKey = `members:tenant:${tenantId}`;\n    const cached = cache.get<Member[]>(cacheKey);\n    if (cached) return cached;\n    \n    const membersData = await db.select().from(members)\n      .where(eq(members.tenantId, tenantId))\n      .orderBy(desc(members.createdAt))\n      .limit(1000); // Limit to prevent large data loads\n    \n    cache.set(cacheKey, membersData, 15000); // Cache for 15 seconds\n    return membersData;\n  }\n\n  async getMemberByNumber(tenantId: string, memberNumber: string): Promise<Member | undefined> {\n    // Normaliseer lidnummer naar 4-cijferige format (0007)\n    const normalizedNumber = memberNumber.padStart(4, '0');\n    \n    // Probeer eerst de genormaliseerde versie\n    let [member] = await db.select().from(members).where(\n      and(eq(members.tenantId, tenantId), eq(members.memberNumber, normalizedNumber))\n    );\n    \n    // Als niet gevonden, probeer ook de originele versie (voor achterwaartse compatibiliteit)\n    if (!member && memberNumber !== normalizedNumber) {\n      [member] = await db.select().from(members).where(\n        and(eq(members.tenantId, tenantId), eq(members.memberNumber, memberNumber))\n      );\n    }\n    \n    // Probeer ook alle varianten (met en zonder leading zeros)\n    if (!member) {\n      const memberAsNumber = parseInt(memberNumber);\n      if (!isNaN(memberAsNumber)) {\n        // Probeer \"7\", \"07\", \"007\", \"0007\"\n        const variants = [\n          memberAsNumber.toString(),\n          memberAsNumber.toString().padStart(2, '0'),\n          memberAsNumber.toString().padStart(3, '0'),\n          memberAsNumber.toString().padStart(4, '0')\n        ];\n        \n        for (const variant of variants) {\n          if (variant !== normalizedNumber && variant !== memberNumber) {\n            [member] = await db.select().from(members).where(\n              and(eq(members.tenantId, tenantId), eq(members.memberNumber, variant))\n            );\n            if (member) break;\n          }\n        }\n      }\n    }\n    \n    return member || undefined;\n  }\n\n  async createMember(member: InsertMember): Promise<Member> {\n    const [newMember] = await db.insert(members).values(member).returning();\n    // Invalidate cache\n    cache.deletePattern(`members:tenant:${member.tenantId}`);\n    cache.deletePattern(`dashboard:stats:${member.tenantId}`);\n    return newMember;\n  }\n\n  async updateMember(id: string, member: Partial<InsertMember>): Promise<Member> {\n    const [updatedMember] = await db.update(members).set(member).where(eq(members.id, id)).returning();\n    // Invalidate cache\n    cache.deletePattern(`members:tenant:${updatedMember.tenantId}`);\n    cache.deletePattern(`dashboard:stats:${updatedMember.tenantId}`);\n    return updatedMember;\n  }\n\n  async deleteMember(id: string): Promise<void> {\n    // Get member first to know tenant for cache invalidation\n    const [member] = await db.select().from(members).where(eq(members.id, id));\n    await db.delete(members).where(eq(members.id, id));\n    if (member) {\n      cache.deletePattern(`members:tenant:${member.tenantId}`);\n      cache.deletePattern(`dashboard:stats:${member.tenantId}`);\n    }\n  }\n\n  // Member Financial Settings\n  async getMemberFinancialSettings(memberId: string): Promise<MemberFinancialSettings | undefined> {\n    const [settings] = await db.select().from(memberFinancialSettings).where(eq(memberFinancialSettings.memberId, memberId));\n    return settings || undefined;\n  }\n\n  async createMemberFinancialSettings(settings: InsertMemberFinancialSettings): Promise<MemberFinancialSettings> {\n    const [newSettings] = await db.insert(memberFinancialSettings).values(settings).returning();\n    return newSettings;\n  }\n\n  async updateMemberFinancialSettings(memberId: string, settings: Partial<InsertMemberFinancialSettings>): Promise<MemberFinancialSettings> {\n    const [updatedSettings] = await db.update(memberFinancialSettings).set(settings).where(eq(memberFinancialSettings.memberId, memberId)).returning();\n    return updatedSettings;\n  }\n\n  // Member Permissions\n  async getMemberPermissions(memberId: string): Promise<MemberPermissions | undefined> {\n    const [permissions] = await db.select().from(memberPermissions).where(eq(memberPermissions.memberId, memberId));\n    return permissions || undefined;\n  }\n\n  // Duplicate detection methods\n\n  async getMemberByNameAndAddress(tenantId: string, firstName: string, lastName: string, street: string, number: string): Promise<Member | undefined> {\n    const [member] = await db.select().from(members).where(\n      and(\n        eq(members.tenantId, tenantId),\n        eq(members.firstName, firstName),\n        eq(members.lastName, lastName),\n        eq(members.street, street),\n        eq(members.number, number)\n      )\n    );\n    return member || undefined;\n  }\n\n  async getNextAvailableMemberNumber(tenantId: string, startFrom?: string): Promise<string> {\n    const existingNumbers = await db.select({ memberNumber: members.memberNumber })\n      .from(members)\n      .where(eq(members.tenantId, tenantId));\n    \n    const numberSet = new Set(existingNumbers.map(m => m.memberNumber));\n    \n    // Start from the suggested number or 1\n    let baseNumber = startFrom ? parseInt(startFrom) : 1;\n    \n    // Find next available number\n    while (numberSet.has(baseNumber.toString().padStart(4, '0'))) {\n      baseNumber++;\n    }\n    \n    return baseNumber.toString().padStart(4, '0');\n  }\n\n  async createMemberPermissions(permissions: InsertMemberPermissions): Promise<MemberPermissions> {\n    const [newPermissions] = await db.insert(memberPermissions).values(permissions).returning();\n    return newPermissions;\n  }\n\n  async updateMemberPermissions(memberId: string, permissions: Partial<InsertMemberPermissions>): Promise<MemberPermissions> {\n    const [updatedPermissions] = await db.update(memberPermissions).set(permissions).where(eq(memberPermissions.memberId, memberId)).returning();\n    return updatedPermissions;\n  }\n\n  // Membership Fees\n  async getMembershipFee(id: string): Promise<MembershipFee | undefined> {\n    const [fee] = await db.select().from(membershipFees).where(eq(membershipFees.id, id));\n    return fee || undefined;\n  }\n\n  async getMembershipFeesByTenant(tenantId: string): Promise<any[]> {\n    return await db.select({\n      ...membershipFees,\n      memberFirstName: members.firstName,\n      memberLastName: members.lastName,\n    }).from(membershipFees)\n      .innerJoin(members, eq(membershipFees.memberId, members.id))\n      .where(eq(membershipFees.tenantId, tenantId))\n      .orderBy(desc(membershipFees.createdAt))\n      .limit(2000); // Limit to prevent large data loads\n  }\n\n  async getMembershipFeesByMember(memberId: string): Promise<MembershipFee[]> {\n    return await db.select().from(membershipFees)\n      .where(eq(membershipFees.memberId, memberId))\n      .orderBy(desc(membershipFees.periodStart));\n  }\n\n  async createMembershipFee(fee: InsertMembershipFee): Promise<MembershipFee> {\n    const [newFee] = await db.insert(membershipFees).values(fee).returning();\n    // Invalidate cache\n    cache.deletePattern(`dashboard:stats:${fee.tenantId}`);\n    return newFee;\n  }\n\n  async updateMembershipFee(id: string, fee: Partial<InsertMembershipFee>): Promise<MembershipFee> {\n    const [updatedFee] = await db.update(membershipFees).set(fee).where(eq(membershipFees.id, id)).returning();\n    // Invalidate cache\n    if (updatedFee.tenantId) {\n      cache.deletePattern(`dashboard:stats:${updatedFee.tenantId}`);\n    }\n    return updatedFee;\n  }\n\n  async deleteMembershipFee(id: string, tenantId: string): Promise<void> {\n    await db.delete(membershipFees).where(and(eq(membershipFees.id, id), eq(membershipFees.tenantId, tenantId)));\n    // Invalidate cache\n    cache.deletePattern(`dashboard:stats:${tenantId}`);\n  }\n\n  // Transactions\n  async getTransactionsByTenant(tenantId: string): Promise<Transaction[]> {\n    const result = await db.execute(sql`\n      SELECT \n        t.id,\n        t.tenant_id as \"tenantId\",\n        t.member_id as \"memberId\", \n        t.type,\n        t.category,\n        t.amount,\n        t.date,\n        t.method,\n        t.description,\n        t.related_fee_id as \"relatedFeeId\",\n        CASE \n          WHEN m.first_name IS NOT NULL AND m.last_name IS NOT NULL \n          THEN CONCAT(m.first_name, ' ', m.last_name)\n          WHEN m.first_name IS NOT NULL \n          THEN m.first_name\n          WHEN m.last_name IS NOT NULL \n          THEN m.last_name\n          ELSE NULL \n        END as \"memberName\"\n      FROM ${transactions} t\n      LEFT JOIN ${members} m ON t.member_id = m.id  \n      WHERE t.tenant_id = ${tenantId}\n      ORDER BY t.date DESC\n      LIMIT 1000\n    `);\n    \n    return result.rows as Transaction[];\n  }\n\n  async createTransaction(transaction: InsertTransaction): Promise<Transaction> {\n    const [newTransaction] = await db.insert(transactions).values(transaction).returning();\n    return newTransaction;\n  }\n\n  async updateTransaction(id: string, transaction: Partial<InsertTransaction>): Promise<Transaction> {\n    const [updatedTransaction] = await db.update(transactions).set(transaction).where(eq(transactions.id, id)).returning();\n    return updatedTransaction;\n  }\n\n  async deleteTransaction(id: string): Promise<void> {\n    await db.delete(transactions).where(eq(transactions.id, id));\n  }\n\n  // Rules\n  async getRulesByTenant(tenantId: string): Promise<Rule[]> {\n    return await db.select().from(rules)\n      .where(eq(rules.tenantId, tenantId))\n      .orderBy(desc(rules.createdAt));\n  }\n\n  async createRule(rule: InsertRule): Promise<Rule> {\n    const [newRule] = await db.insert(rules).values(rule).returning();\n    return newRule;\n  }\n\n  async updateRule(id: string, rule: Partial<InsertRule>): Promise<Rule> {\n    const [updatedRule] = await db.update(rules).set(rule).where(eq(rules.id, id)).returning();\n    return updatedRule;\n  }\n\n  async deleteRule(id: string): Promise<void> {\n    await db.delete(rules).where(eq(rules.id, id));\n  }\n\n\n  // Rule Outcomes\n  async getRuleOutcomesByMember(memberId: string): Promise<RuleOutcome[]> {\n    return await db.select().from(ruleOutcomes)\n      .where(eq(ruleOutcomes.memberId, memberId))\n      .orderBy(desc(ruleOutcomes.evaluatedAt));\n  }\n\n  async createRuleOutcome(outcome: InsertRuleOutcome): Promise<RuleOutcome> {\n    const [newOutcome] = await db.insert(ruleOutcomes).values(outcome).returning();\n    return newOutcome;\n  }\n\n  // Public Screens\n  async getPublicScreensByTenant(tenantId: string): Promise<PublicScreen[]> {\n    return await db.select().from(publicScreens)\n      .where(eq(publicScreens.tenantId, tenantId))\n      .orderBy(desc(publicScreens.createdAt));\n  }\n\n  async getPublicScreenByToken(token: string): Promise<PublicScreen | undefined> {\n    const [screen] = await db.select().from(publicScreens).where(eq(publicScreens.publicToken, token));\n    return screen || undefined;\n  }\n\n  async createPublicScreen(screen: InsertPublicScreen): Promise<PublicScreen> {\n    const [newScreen] = await db.insert(publicScreens).values(screen).returning();\n    return newScreen;\n  }\n\n  async updatePublicScreen(id: string, screen: Partial<InsertPublicScreen>): Promise<PublicScreen> {\n    const [updatedScreen] = await db.update(publicScreens).set(screen).where(eq(publicScreens.id, id)).returning();\n    return updatedScreen;\n  }\n\n  async deletePublicScreen(id: string): Promise<void> {\n    await db.delete(publicScreens).where(eq(publicScreens.id, id));\n  }\n\n  // Announcements\n  async getAnnouncementsByTenant(tenantId: string): Promise<Announcement[]> {\n    return await db.select().from(announcements)\n      .where(eq(announcements.tenantId, tenantId))\n      .orderBy(desc(announcements.createdAt));\n  }\n\n  async createAnnouncement(announcement: InsertAnnouncement): Promise<Announcement> {\n    const [newAnnouncement] = await db.insert(announcements).values(announcement).returning();\n    return newAnnouncement;\n  }\n\n  // Card Meta\n  async getCardMetaByMember(memberId: string): Promise<CardMeta | undefined> {\n    const [card] = await db.select().from(cardMeta).where(eq(cardMeta.memberId, memberId));\n    return card || undefined;\n  }\n\n  async getCardMetaByQrToken(qrToken: string): Promise<CardMeta | undefined> {\n    const [card] = await db.select().from(cardMeta).where(eq(cardMeta.qrToken, qrToken));\n    return card || undefined;\n  }\n\n  async createCardMeta(cardMetaData: InsertCardMeta): Promise<CardMeta> {\n    const [newCard] = await db.insert(cardMeta).values(cardMetaData).returning();\n    return newCard;\n  }\n\n  async updateCardMeta(id: string, cardMetaData: Partial<InsertCardMeta>): Promise<CardMeta> {\n    const [updatedCard] = await db.update(cardMeta).set(cardMetaData).where(eq(cardMeta.id, id)).returning();\n    return updatedCard;\n  }\n\n  async getMemberWithCardAndTenant(memberId: string): Promise<{ member: Member; cardMeta: CardMeta; tenant: Tenant } | undefined> {\n    const result = await db\n      .select({\n        member: members,\n        cardMeta: cardMeta,\n        tenant: tenants,\n      })\n      .from(members)\n      .innerJoin(cardMeta, eq(members.id, cardMeta.memberId))\n      .innerJoin(tenants, eq(members.tenantId, tenants.id))\n      .where(eq(members.id, memberId));\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      member: row.member,\n      cardMeta: row.cardMeta,\n      tenant: row.tenant,\n    };\n  }\n\n  async getAllCardsWithMembers(tenantId: string): Promise<{ member: Member; cardMeta: CardMeta | null }[]> {\n    const result = await db\n      .select({\n        member: members,\n        cardMeta: cardMeta,\n      })\n      .from(members)\n      .leftJoin(cardMeta, eq(members.id, cardMeta.memberId))\n      .where(eq(members.tenantId, tenantId))\n      .orderBy(desc(members.createdAt));\n\n    return result.map(row => ({\n      member: row.member,\n      cardMeta: row.cardMeta || null,\n    }));\n  }\n\n  async getCardStats(tenantId: string): Promise<{ totalActive: number; validPercentage: number; lastUpdated: Date | null }> {\n    const cacheKey = `card:stats:${tenantId}`;\n    const cached = cache.get<{ totalActive: number; validPercentage: number; lastUpdated: Date | null }>(cacheKey);\n    if (cached) return cached;\n\n    const result = await db.execute(sql`\n      WITH card_stats AS (\n        SELECT \n          COUNT(CASE WHEN cm.status = 'ACTUEEL' THEN 1 END) as active_cards,\n          COUNT(cm.id) as total_cards,\n          COUNT(m.id) as total_members,\n          MAX(cm.last_rendered_at) as last_updated\n        FROM ${members} m\n        LEFT JOIN ${cardMeta} cm ON m.id = cm.member_id\n        WHERE m.tenant_id = ${tenantId}\n      )\n      SELECT \n        active_cards::int,\n        total_cards::int,\n        total_members::int,\n        last_updated\n      FROM card_stats\n    `);\n\n    const stats = result.rows[0] as any;\n    const cardStats = {\n      totalActive: parseInt(stats.active_cards) || 0,\n      validPercentage: stats.total_members > 0 ? Math.round((parseInt(stats.total_cards) / parseInt(stats.total_members)) * 100) : 0,\n      lastUpdated: stats.last_updated ? new Date(stats.last_updated) : null,\n    };\n\n    cache.set(cacheKey, cardStats, 10000); // Cache for 10 seconds\n    return cardStats;\n  }\n\n  // Notifications\n  async getNotificationsByTenant(tenantId: string): Promise<Notification[]> {\n    return await db.select().from(notifications)\n      .where(eq(notifications.tenantId, tenantId))\n      .orderBy(desc(notifications.createdAt));\n  }\n\n  async createNotification(notification: InsertNotification): Promise<Notification> {\n    const [newNotification] = await db.insert(notifications).values(notification).returning();\n    return newNotification;\n  }\n\n  // SEPA Exports\n  async getSepaExportsByTenant(tenantId: string): Promise<SepaExport[]> {\n    return await db.select().from(sepaExports)\n      .where(eq(sepaExports.tenantId, tenantId))\n      .orderBy(desc(sepaExports.createdAt));\n  }\n\n  async createSepaExport(sepaExport: InsertSepaExport): Promise<SepaExport> {\n    const [newExport] = await db.insert(sepaExports).values(sepaExport).returning();\n    return newExport;\n  }\n\n  // Dashboard stats - Optimized single query with caching\n  async getDashboardStats(tenantId: string): Promise<{\n    totalMembers: number;\n    activeMembers: number;\n    totalRevenue: number;\n    outstanding: number;\n    monthlyIncome: number;\n  }> {\n    const cacheKey = `dashboard:stats:${tenantId}`;\n    const cached = cache.get<{\n      totalMembers: number;\n      activeMembers: number;\n      totalRevenue: number;\n      outstanding: number;\n      monthlyIncome: number;\n    }>(cacheKey);\n    if (cached) return cached;\n\n    // Single optimized query using CTEs for better performance\n    const result = await db.execute(sql`\n      WITH member_stats AS (\n        SELECT \n          COUNT(*) as total_members,\n          COUNT(CASE WHEN active = true THEN 1 END) as active_members\n        FROM ${members} \n        WHERE tenant_id = ${tenantId}\n      ),\n      fee_stats AS (\n        SELECT \n          COALESCE(SUM(CASE WHEN status = 'PAID' THEN amount ELSE 0 END), 0) as total_revenue,\n          COALESCE(SUM(CASE WHEN status = 'OPEN' THEN amount ELSE 0 END), 0) as outstanding,\n          COALESCE(SUM(CASE \n            WHEN status = 'PAID' \n            AND paid_at >= DATE_TRUNC('month', CURRENT_DATE) \n            AND paid_at < DATE_TRUNC('month', CURRENT_DATE) + INTERVAL '1 month'\n            THEN amount ELSE 0 END), 0) as monthly_income\n        FROM ${membershipFees} \n        WHERE tenant_id = ${tenantId}\n      )\n      SELECT \n        m.total_members::int,\n        m.active_members::int,\n        f.total_revenue::numeric,\n        f.outstanding::numeric,\n        f.monthly_income::numeric\n      FROM member_stats m, fee_stats f\n    `);\n\n    const stats = result.rows[0] as any;\n    const dashboardStats = {\n      totalMembers: parseInt(stats.total_members) || 0,\n      activeMembers: parseInt(stats.active_members) || 0,\n      totalRevenue: parseFloat(stats.total_revenue) || 0,\n      outstanding: parseFloat(stats.outstanding) || 0,\n      monthlyIncome: parseFloat(stats.monthly_income) || 0,\n    };\n\n    cache.set(cacheKey, dashboardStats, 10000); // Cache for 10 seconds\n    return dashboardStats;\n  }\n\n  // Email Templates\n  async getEmailTemplatesByTenant(tenantId: string): Promise<EmailTemplate[]> {\n    return await db.select().from(emailTemplates)\n      .where(eq(emailTemplates.tenantId, tenantId))\n      .orderBy(desc(emailTemplates.createdAt));\n  }\n\n  async getEmailTemplate(tenantId: string, id: string): Promise<EmailTemplate | undefined> {\n    const [template] = await db.select().from(emailTemplates)\n      .where(and(eq(emailTemplates.tenantId, tenantId), eq(emailTemplates.id, id)));\n    return template || undefined;\n  }\n\n  async createEmailTemplate(template: InsertEmailTemplate): Promise<EmailTemplate> {\n    const [newTemplate] = await db.insert(emailTemplates).values(template).returning();\n    return newTemplate;\n  }\n\n  async updateEmailTemplate(tenantId: string, id: string, template: Partial<InsertEmailTemplate>): Promise<EmailTemplate> {\n    const [updatedTemplate] = await db.update(emailTemplates)\n      .set({ ...template, updatedAt: new Date() })\n      .where(and(eq(emailTemplates.tenantId, tenantId), eq(emailTemplates.id, id)))\n      .returning();\n    return updatedTemplate;\n  }\n\n  async deleteEmailTemplate(tenantId: string, id: string): Promise<void> {\n    await db.delete(emailTemplates)\n      .where(and(eq(emailTemplates.tenantId, tenantId), eq(emailTemplates.id, id)));\n  }\n\n  // Email Segments\n  async getEmailSegmentsByTenant(tenantId: string): Promise<EmailSegment[]> {\n    return await db.select().from(emailSegments)\n      .where(eq(emailSegments.tenantId, tenantId))\n      .orderBy(desc(emailSegments.createdAt));\n  }\n\n  async getEmailSegment(tenantId: string, id: string): Promise<EmailSegment | undefined> {\n    const [segment] = await db.select().from(emailSegments)\n      .where(and(eq(emailSegments.tenantId, tenantId), eq(emailSegments.id, id)));\n    return segment || undefined;\n  }\n\n  async createEmailSegment(segment: InsertEmailSegment): Promise<EmailSegment> {\n    const [newSegment] = await db.insert(emailSegments).values(segment).returning();\n    return newSegment;\n  }\n\n  async updateEmailSegment(tenantId: string, id: string, segment: Partial<InsertEmailSegment>): Promise<EmailSegment> {\n    const [updatedSegment] = await db.update(emailSegments)\n      .set(segment)\n      .where(and(eq(emailSegments.tenantId, tenantId), eq(emailSegments.id, id)))\n      .returning();\n    return updatedSegment;\n  }\n\n  async deleteEmailSegment(tenantId: string, id: string): Promise<void> {\n    await db.delete(emailSegments)\n      .where(and(eq(emailSegments.tenantId, tenantId), eq(emailSegments.id, id)));\n  }\n\n  // Email Campaigns\n  async getEmailCampaignsByTenant(tenantId: string): Promise<EmailCampaign[]> {\n    return await db.select().from(emailCampaigns)\n      .where(eq(emailCampaigns.tenantId, tenantId))\n      .orderBy(desc(emailCampaigns.createdAt));\n  }\n\n  async getEmailCampaign(tenantId: string, id: string): Promise<EmailCampaign | undefined> {\n    const [campaign] = await db.select().from(emailCampaigns)\n      .where(and(eq(emailCampaigns.tenantId, tenantId), eq(emailCampaigns.id, id)));\n    return campaign || undefined;\n  }\n\n  async createEmailCampaign(campaign: InsertEmailCampaign): Promise<EmailCampaign> {\n    const [newCampaign] = await db.insert(emailCampaigns).values(campaign).returning();\n    return newCampaign;\n  }\n\n  async updateEmailCampaign(tenantId: string, id: string, campaign: Partial<InsertEmailCampaign>): Promise<EmailCampaign> {\n    const [updatedCampaign] = await db.update(emailCampaigns)\n      .set({ ...campaign, updatedAt: new Date() })\n      .where(and(eq(emailCampaigns.tenantId, tenantId), eq(emailCampaigns.id, id)))\n      .returning();\n    return updatedCampaign;\n  }\n\n  async deleteEmailCampaign(tenantId: string, id: string): Promise<void> {\n    await db.delete(emailCampaigns)\n      .where(and(eq(emailCampaigns.tenantId, tenantId), eq(emailCampaigns.id, id)));\n  }\n\n  // Email Messages\n  async getEmailMessagesByTenant(tenantId: string): Promise<EmailMessage[]> {\n    return await db.select().from(emailMessages)\n      .where(eq(emailMessages.tenantId, tenantId))\n      .orderBy(desc(emailMessages.createdAt));\n  }\n\n  async getEmailMessagesByCampaign(tenantId: string, campaignId: string): Promise<EmailMessage[]> {\n    return await db.select().from(emailMessages)\n      .where(and(eq(emailMessages.tenantId, tenantId), eq(emailMessages.campaignId, campaignId)))\n      .orderBy(desc(emailMessages.createdAt));\n  }\n\n  async createEmailMessage(message: InsertEmailMessage): Promise<EmailMessage> {\n    const [newMessage] = await db.insert(emailMessages).values(message).returning();\n    return newMessage;\n  }\n\n  async updateEmailMessage(id: string, message: Partial<InsertEmailMessage>): Promise<EmailMessage> {\n    const [updatedMessage] = await db.update(emailMessages)\n      .set(message)\n      .where(eq(emailMessages.id, id))\n      .returning();\n    return updatedMessage;\n  }\n\n  // Email Suppresses\n  async getEmailSuppressesByTenant(tenantId: string): Promise<EmailSuppress[]> {\n    return await db.select().from(emailSuppresses)\n      .where(eq(emailSuppresses.tenantId, tenantId))\n      .orderBy(desc(emailSuppresses.createdAt));\n  }\n\n  async createEmailSuppress(suppress: InsertEmailSuppress): Promise<EmailSuppress> {\n    const [newSuppress] = await db.insert(emailSuppresses).values(suppress).returning();\n    return newSuppress;\n  }\n\n  async deleteEmailSuppress(tenantId: string, id: string): Promise<void> {\n    await db.delete(emailSuppresses)\n      .where(and(eq(emailSuppresses.tenantId, tenantId), eq(emailSuppresses.id, id)));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":34311},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"shared/schema.ts":{"content":"import { sql, relations } from \"drizzle-orm\";\nimport { \n  pgTable, \n  text, \n  varchar, \n  timestamp, \n  boolean, \n  decimal, \n  integer, \n  json,\n  pgEnum\n} from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Enums\nexport const roleEnum = pgEnum('role', ['SUPERADMIN', 'BEHEERDER', 'MEDEWERKER']);\nexport const genderEnum = pgEnum('gender', ['M', 'V']);\nexport const memberCategoryEnum = pgEnum('member_category', ['STUDENT', 'STANDAARD', 'SENIOR']);\nexport const paymentTermEnum = pgEnum('payment_term', ['MONTHLY', 'YEARLY']);\nexport const paymentMethodEnum = pgEnum('payment_method', ['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']);\nexport const feeStatusEnum = pgEnum('fee_status', ['OPEN', 'PAID', 'OVERDUE']);\nexport const screenTypeEnum = pgEnum('screen_type', ['LEDENLIJST', 'MEDEDELINGEN', 'MULTIMEDIA']);\nexport const cardStatusEnum = pgEnum('card_status', ['ACTUEEL', 'NIET_ACTUEEL', 'VERLOPEN']);\nexport const ruleScopeEnum = pgEnum('rule_scope', ['STEMRECHT', 'VERKIESBAAR']);\nexport const companyTypeEnum = pgEnum('company_type', ['VZW', 'BVBA', 'NV', 'VOF', 'EENMANSZAAK', 'CVBA', 'SE', 'ANDERE']);\nexport const reconcileStatusEnum = pgEnum('reconcile_status', ['ONTVANGEN', 'VOORGESTELD', 'GEDEELTELIJK_GEMATCHT', 'GEMATCHT', 'AFGEKEURD', 'GEBOEKT']);\nexport const statementTypeEnum = pgEnum('statement_type', ['BANK', 'CSV', 'MT940', 'CODA']);\nexport const txnSideEnum = pgEnum('txn_side', ['CREDIT', 'DEBET']);\nexport const boardRoleEnum = pgEnum('board_role', ['VOORZITTER', 'VICE_VOORZITTER', 'SECRETARIS', 'PENNINGMEESTER', 'BESTUURSLID', 'ANDERS']);\nexport const boardStatusEnum = pgEnum('board_status', ['ACTIEF', 'INACTIEF']);\nexport const emailKindEnum = pgEnum('email_kind', ['TRANSACTIONEEL', 'MARKETING']);\nexport const emailStatusEnum = pgEnum('email_status', ['DRAFT', 'QUEUED', 'SENDING', 'SENT', 'PARTIAL', 'FAILED', 'CANCELLED']);\nexport const recipientStatusEnum = pgEnum('recipient_status', ['QUEUED', 'SENT', 'FAILED', 'OPENED', 'CLICKED', 'UNSUBSCRIBED']);\nexport const suppressReasonEnum = pgEnum('suppress_reason', ['UNSUB_REQUEST', 'BOUNCE', 'SPAM_COMPLAINT', 'MANUAL']);\n\n// Tables\nexport const tenants = pgTable(\"tenants\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  slug: text(\"slug\").notNull().unique(),\n  street: text(\"street\"),\n  number: text(\"number\"),\n  postalCode: text(\"postal_code\"),\n  city: text(\"city\"),\n  country: text(\"country\").default('België'),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  website: text(\"website\"),\n  companyNumber: text(\"company_number\"),\n  companyType: companyTypeEnum(\"company_type\"),\n  logoUrl: text(\"logo_url\"),\n  primaryColor: text(\"primary_color\"),\n  // Membership fee settings\n  studentFee: decimal(\"student_fee\", { precision: 10, scale: 2 }).default('15.00'),\n  adultFee: decimal(\"adult_fee\", { precision: 10, scale: 2 }).default('25.00'),\n  seniorFee: decimal(\"senior_fee\", { precision: 10, scale: 2 }).default('20.00'),\n  defaultPaymentTerm: paymentTermEnum(\"default_payment_term\").default('YEARLY'),\n  defaultPaymentMethod: paymentMethodEnum(\"default_payment_method\").default('SEPA'),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull().unique(),\n  passwordHash: text(\"password_hash\").notNull(),\n  role: roleEnum(\"role\").notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const members = pgTable(\"members\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberNumber: text(\"member_number\").notNull().unique(),\n  firstName: text(\"first_name\").notNull(),\n  lastName: text(\"last_name\").notNull(),\n  gender: genderEnum(\"gender\").notNull(),\n  birthDate: timestamp(\"birth_date\"),\n  category: memberCategoryEnum(\"category\").notNull(),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  street: text(\"street\"),\n  number: text(\"number\"),\n  bus: text(\"bus\"),\n  postalCode: text(\"postal_code\"),\n  city: text(\"city\"),\n  country: text(\"country\"),\n  active: boolean(\"active\").default(true).notNull(),\n  votingRights: boolean(\"voting_rights\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const memberFinancialSettings = pgTable(\"member_financial_settings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  memberId: varchar(\"member_id\").notNull().unique(),\n  paymentMethod: paymentMethodEnum(\"payment_method\").notNull(),\n  paymentTerm: paymentTermEnum(\"payment_term\").notNull(),\n  monthlyAmount: decimal(\"monthly_amount\", { precision: 10, scale: 2 }).default('0.00'),\n  yearlyAmount: decimal(\"yearly_amount\", { precision: 10, scale: 2 }).default('0.00'),\n  billingAnchorAt: timestamp(\"billing_anchor_at\").defaultNow(),\n  iban: text(\"iban\"),\n});\n\nexport const memberPermissions = pgTable(\"member_permissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  memberId: varchar(\"member_id\").notNull().unique(),\n  privacyAgreement: boolean(\"privacy_agreement\").default(false).notNull(),\n  photoVideoConsent: boolean(\"photo_video_consent\").default(false).notNull(),\n  newsletterSubscription: boolean(\"newsletter_subscription\").default(false).notNull(),\n  whatsappList: boolean(\"whatsapp_list\").default(false).notNull(),\n  interestedInActiveRole: boolean(\"interested_in_active_role\").default(false).notNull(),\n  roleDescription: text(\"role_description\"),\n  votingEligible: boolean(\"voting_eligible\").default(false).notNull(),\n});\n\nexport const mandates = pgTable(\"mandates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\").notNull(),\n  mandateRef: text(\"mandate_ref\").notNull().unique(),\n  signedAt: timestamp(\"signed_at\").notNull(),\n  status: text(\"status\").notNull(), // ACTIVE, REVOKED, PENDING\n});\n\nexport const membershipFees = pgTable(\"membership_fees\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\").notNull(),\n  memberNumber: text(\"member_number\").notNull(),\n  memberName: text(\"member_name\").notNull(),\n  periodStart: timestamp(\"period_start\").notNull(),\n  periodEnd: timestamp(\"period_end\").notNull(),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  status: feeStatusEnum(\"status\").default('OPEN').notNull(),\n  method: paymentMethodEnum(\"method\"),\n  sepaEligible: boolean(\"sepa_eligible\").default(false).notNull(),\n  paidAt: timestamp(\"paid_at\"),\n  sepaBatchId: varchar(\"sepa_batch_id\"),\n  note: text(\"note\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  // Unique constraint on tenant, member, and period\n  uniquePeriod: sql`UNIQUE (${table.tenantId}, ${table.memberId}, ${table.periodStart}, ${table.periodEnd})`,\n}));\n\nexport const transactions = pgTable(\"transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\"),\n  type: text(\"type\").notNull(), // INCOME / EXPENSE\n  category: text(\"category\").notNull(),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  date: timestamp(\"date\").notNull(),\n  method: paymentMethodEnum(\"method\"),\n  description: text(\"description\"),\n  relatedFeeId: varchar(\"related_fee_id\"),\n});\n\nexport const rules = pgTable(\"rules\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  scope: ruleScopeEnum(\"scope\").notNull(),\n  parameters: json(\"parameters\").notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const ruleOutcomes = pgTable(\"rule_outcomes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  ruleId: varchar(\"rule_id\").notNull(),\n  memberId: varchar(\"member_id\").notNull(),\n  eligible: boolean(\"eligible\").notNull(),\n  evaluatedAt: timestamp(\"evaluated_at\").defaultNow().notNull(),\n});\n\nexport const ruleOverrides = pgTable(\"rule_overrides\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\").notNull(),\n  ruleScope: ruleScopeEnum(\"rule_scope\").notNull(),\n  overrideValue: boolean(\"override_value\").notNull(),\n  reason: text(\"reason\").notNull(),\n  overriddenBy: varchar(\"overridden_by\").notNull(), // User ID who made the override\n  overriddenAt: timestamp(\"overridden_at\").defaultNow().notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const publicScreens = pgTable(\"public_screens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  type: screenTypeEnum(\"type\").notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n  config: json(\"config\").notNull(),\n  publicToken: text(\"public_token\").notNull().unique(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const announcements = pgTable(\"announcements\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  title: text(\"title\").notNull(),\n  richText: text(\"rich_text\"),\n  mediaUrl: text(\"media_url\"),\n  mediaType: text(\"media_type\"),\n  validFrom: timestamp(\"valid_from\"),\n  validTo: timestamp(\"valid_to\"),\n  active: boolean(\"active\").default(true).notNull(),\n  screenId: varchar(\"screen_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const cardMeta = pgTable(\"card_meta\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\").notNull().unique(),\n  version: integer(\"version\").default(1).notNull(),\n  etag: text(\"etag\").notNull(),\n  secureToken: text(\"secure_token\").notNull().unique(),\n  qrToken: text(\"qr_token\").notNull().unique(),\n  status: cardStatusEnum(\"status\").default('ACTUEEL').notNull(),\n  validUntil: timestamp(\"valid_until\"),\n  lastRenderedAt: timestamp(\"last_rendered_at\").defaultNow().notNull(),\n});\n\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  type: text(\"type\").notNull(), // finance/system/member\n  title: text(\"title\").notNull(),\n  body: text(\"body\"),\n  isRead: boolean(\"is_read\").default(false).notNull(),\n  userId: varchar(\"user_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const boardMembers = pgTable(\"board_members\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  memberId: varchar(\"member_id\"), // link naar Member indien intern\n  externalName: text(\"external_name\"), // naam indien extern\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  role: boardRoleEnum(\"role\").notNull(),\n  customRole: text(\"custom_role\"), // custom role text when role is 'ANDERS'\n  status: boardStatusEnum(\"status\").default('ACTIEF').notNull(),\n  termStart: timestamp(\"term_start\").notNull(),\n  termEnd: timestamp(\"term_end\"),\n  responsibilities: text(\"responsibilities\"),\n  orderIndex: integer(\"order_index\").default(100).notNull(),\n  avatarUrl: text(\"avatar_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const boardTerms = pgTable(\"board_terms\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  boardMemberId: varchar(\"board_member_id\").notNull(),\n  role: boardRoleEnum(\"role\").notNull(),\n  start: timestamp(\"start\").notNull(),\n  end: timestamp(\"end\"),\n  note: text(\"note\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const sepaExports = pgTable(\"sepa_exports\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  batchRef: text(\"batch_ref\").notNull().unique(),\n  xml: text(\"xml\").notNull(),\n  totalAmount: decimal(\"total_amount\", { precision: 12, scale: 2 }).notNull(),\n  numTx: integer(\"num_tx\").notNull(),\n  status: text(\"status\").notNull(), // GENERATED / SUBMITTED\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const bankStatements = pgTable(\"bank_statements\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  type: statementTypeEnum(\"type\").notNull(),\n  sourceName: text(\"source_name\").notNull(),\n  importedAt: timestamp(\"imported_at\").defaultNow().notNull(),\n  importedById: varchar(\"imported_by_id\"),\n  numTx: integer(\"num_tx\").notNull(),\n  rawFileUrl: text(\"raw_file_url\"),\n});\n\nexport const bankTransactions = pgTable(\"bank_transactions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  statementId: varchar(\"statement_id\").notNull(),\n  bookingDate: timestamp(\"booking_date\").notNull(),\n  valueDate: timestamp(\"value_date\"),\n  side: txnSideEnum(\"side\").notNull(),\n  amount: decimal(\"amount\", { precision: 12, scale: 2 }).notNull(),\n  currency: text(\"currency\").default(\"EUR\").notNull(),\n  counterparty: text(\"counterparty\"),\n  iban: text(\"iban\"),\n  description: text(\"description\"),\n  ref: text(\"ref\"), // end-to-end / mededeling\n  status: reconcileStatusEnum(\"status\").default('ONTVANGEN').notNull(),\n  categoryId: varchar(\"category_id\"),\n  vendorId: varchar(\"vendor_id\"),\n  matchedFeeId: varchar(\"matched_fee_id\"),\n  matchedMemberId: varchar(\"matched_member_id\"),\n  matchScore: integer(\"match_score\"),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const expenseCategories = pgTable(\"expense_categories\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  code: text(\"code\"),\n  color: text(\"color\"),\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const vendors = pgTable(\"vendors\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  iban: text(\"iban\"),\n  defaultCategoryId: varchar(\"default_category_id\"),\n  active: boolean(\"active\").default(true).notNull(),\n});\n\nexport const matchRules = pgTable(\"match_rules\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  priority: integer(\"priority\").default(100).notNull(),\n  active: boolean(\"active\").default(true).notNull(),\n  criteria: json(\"criteria\").notNull(), // bv. {contains:[\"lidgeld\"], iban:\"BE..\", amountToleranceCents:100}\n  action: json(\"action\").notNull(), // bv. {categoryId:\"..\", vendorId:\"..\", linkTo:\"FEE|MEMBER\"}\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const emailTemplates = pgTable(\"email_templates\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  code: text(\"code\").notNull(),\n  kind: emailKindEnum(\"kind\").notNull(),\n  subject: text(\"subject\").notNull(),\n  bodyHtml: text(\"body_html\"),\n  bodyText: text(\"body_text\"),\n  content: text(\"content\"), // New simplified content field\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueCode: sql`UNIQUE (${table.tenantId}, ${table.code})`,\n}));\n\nexport const emailSegments = pgTable(\"email_segments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  rules: json(\"rules\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const emailCampaigns = pgTable(\"email_campaigns\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  name: text(\"name\").notNull(),\n  templateId: varchar(\"template_id\").notNull(),\n  segmentId: varchar(\"segment_id\"),\n  kind: emailKindEnum(\"kind\").notNull(),\n  status: emailStatusEnum(\"status\").default('DRAFT').notNull(),\n  scheduledAt: timestamp(\"scheduled_at\"),\n  startedAt: timestamp(\"started_at\"),\n  finishedAt: timestamp(\"finished_at\"),\n  createdById: varchar(\"created_by_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n  updatedAt: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\nexport const emailMessages = pgTable(\"email_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  campaignId: varchar(\"campaign_id\"),\n  templateId: varchar(\"template_id\").notNull(),\n  memberId: varchar(\"member_id\"),\n  email: text(\"email\").notNull(),\n  subject: text(\"subject\").notNull(),\n  bodyHtml: text(\"body_html\").notNull(),\n  bodyText: text(\"body_text\"),\n  status: recipientStatusEnum(\"status\").default('QUEUED').notNull(),\n  lastError: text(\"last_error\"),\n  tokens: json(\"tokens\").notNull(),\n  retryCount: integer(\"retry_count\").default(0).notNull(),\n  sentAt: timestamp(\"sent_at\"),\n  openedAt: timestamp(\"opened_at\"),\n  clickedAt: timestamp(\"clicked_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const emailSuppresses = pgTable(\"email_suppresses\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tenantId: varchar(\"tenant_id\").notNull(),\n  email: text(\"email\").notNull(),\n  memberId: varchar(\"member_id\"),\n  reason: suppressReasonEnum(\"reason\").default('UNSUB_REQUEST').notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n}, (table) => ({\n  uniqueEmail: sql`UNIQUE (${table.tenantId}, ${table.email})`,\n}));\n\n// Relations\nexport const tenantsRelations = relations(tenants, ({ many }) => ({\n  users: many(users),\n  members: many(members),\n  rules: many(rules),\n  screens: many(publicScreens),\n  announcements: many(announcements),\n  fees: many(membershipFees),\n  mandates: many(mandates),\n  transactions: many(transactions),\n  notifications: many(notifications),\n  sepaBatches: many(sepaExports),\n  bankStatements: many(bankStatements),\n  bankTransactions: many(bankTransactions),\n  expenseCategories: many(expenseCategories),\n  vendors: many(vendors),\n  matchRules: many(matchRules),\n  boardMembers: many(boardMembers),\n  boardTerms: many(boardTerms),\n  emailTemplates: many(emailTemplates),\n  emailSegments: many(emailSegments),\n  emailCampaigns: many(emailCampaigns),\n  emailMessages: many(emailMessages),\n  emailSuppresses: many(emailSuppresses),\n}));\n\nexport const usersRelations = relations(users, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [users.tenantId],\n    references: [tenants.id],\n  }),\n}));\n\nexport const membersRelations = relations(members, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [members.tenantId],\n    references: [tenants.id],\n  }),\n  financialSettings: one(memberFinancialSettings, {\n    fields: [members.id],\n    references: [memberFinancialSettings.memberId],\n  }),\n  permissions: one(memberPermissions, {\n    fields: [members.id],\n    references: [memberPermissions.memberId],\n  }),\n  card: one(cardMeta),\n  fees: many(membershipFees),\n  mandates: many(mandates),\n  transactions: many(transactions),\n  ruleOutcomes: many(ruleOutcomes),\n  boardMember: one(boardMembers, {\n    fields: [members.id],\n    references: [boardMembers.memberId],\n  }),\n}));\n\nexport const memberFinancialSettingsRelations = relations(memberFinancialSettings, ({ one }) => ({\n  member: one(members, {\n    fields: [memberFinancialSettings.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const memberPermissionsRelations = relations(memberPermissions, ({ one }) => ({\n  member: one(members, {\n    fields: [memberPermissions.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const mandatesRelations = relations(mandates, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [mandates.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [mandates.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const membershipFeesRelations = relations(membershipFees, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [membershipFees.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [membershipFees.memberId],\n    references: [members.id],\n  }),\n  sepaBatch: one(sepaExports, {\n    fields: [membershipFees.sepaBatchId],\n    references: [sepaExports.id],\n  }),\n}));\n\nexport const transactionsRelations = relations(transactions, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [transactions.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [transactions.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const rulesRelations = relations(rules, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [rules.tenantId],\n    references: [tenants.id],\n  }),\n  outcomes: many(ruleOutcomes),\n}));\n\nexport const ruleOutcomesRelations = relations(ruleOutcomes, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [ruleOutcomes.tenantId],\n    references: [tenants.id],\n  }),\n  rule: one(rules, {\n    fields: [ruleOutcomes.ruleId],\n    references: [rules.id],\n  }),\n  member: one(members, {\n    fields: [ruleOutcomes.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const publicScreensRelations = relations(publicScreens, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [publicScreens.tenantId],\n    references: [tenants.id],\n  }),\n  announcements: many(announcements),\n}));\n\nexport const announcementsRelations = relations(announcements, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [announcements.tenantId],\n    references: [tenants.id],\n  }),\n  screen: one(publicScreens, {\n    fields: [announcements.screenId],\n    references: [publicScreens.id],\n  }),\n}));\n\nexport const cardMetaRelations = relations(cardMeta, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [cardMeta.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [cardMeta.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [notifications.tenantId],\n    references: [tenants.id],\n  }),\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const boardMembersRelations = relations(boardMembers, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [boardMembers.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [boardMembers.memberId],\n    references: [members.id],\n  }),\n  terms: many(boardTerms),\n}));\n\nexport const boardTermsRelations = relations(boardTerms, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [boardTerms.tenantId],\n    references: [tenants.id],\n  }),\n  boardMember: one(boardMembers, {\n    fields: [boardTerms.boardMemberId],\n    references: [boardMembers.id],\n  }),\n}));\n\nexport const sepaExportsRelations = relations(sepaExports, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [sepaExports.tenantId],\n    references: [tenants.id],\n  }),\n  fees: many(membershipFees),\n}));\n\nexport const bankStatementsRelations = relations(bankStatements, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [bankStatements.tenantId],\n    references: [tenants.id],\n  }),\n  importedBy: one(users, {\n    fields: [bankStatements.importedById],\n    references: [users.id],\n  }),\n  transactions: many(bankTransactions),\n}));\n\nexport const bankTransactionsRelations = relations(bankTransactions, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [bankTransactions.tenantId],\n    references: [tenants.id],\n  }),\n  statement: one(bankStatements, {\n    fields: [bankTransactions.statementId],\n    references: [bankStatements.id],\n  }),\n  category: one(expenseCategories, {\n    fields: [bankTransactions.categoryId],\n    references: [expenseCategories.id],\n  }),\n  vendor: one(vendors, {\n    fields: [bankTransactions.vendorId],\n    references: [vendors.id],\n  }),\n  matchedFee: one(membershipFees, {\n    fields: [bankTransactions.matchedFeeId],\n    references: [membershipFees.id],\n  }),\n  matchedMember: one(members, {\n    fields: [bankTransactions.matchedMemberId],\n    references: [members.id],\n  }),\n}));\n\nexport const expenseCategoriesRelations = relations(expenseCategories, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [expenseCategories.tenantId],\n    references: [tenants.id],\n  }),\n  transactions: many(bankTransactions),\n  vendors: many(vendors),\n}));\n\nexport const vendorsRelations = relations(vendors, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [vendors.tenantId],\n    references: [tenants.id],\n  }),\n  defaultCategory: one(expenseCategories, {\n    fields: [vendors.defaultCategoryId],\n    references: [expenseCategories.id],\n  }),\n  transactions: many(bankTransactions),\n}));\n\nexport const matchRulesRelations = relations(matchRules, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [matchRules.tenantId],\n    references: [tenants.id],\n  }),\n}));\n\nexport const emailTemplatesRelations = relations(emailTemplates, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [emailTemplates.tenantId],\n    references: [tenants.id],\n  }),\n  campaigns: many(emailCampaigns),\n  messages: many(emailMessages),\n}));\n\nexport const emailSegmentsRelations = relations(emailSegments, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [emailSegments.tenantId],\n    references: [tenants.id],\n  }),\n  campaigns: many(emailCampaigns),\n}));\n\nexport const emailCampaignsRelations = relations(emailCampaigns, ({ one, many }) => ({\n  tenant: one(tenants, {\n    fields: [emailCampaigns.tenantId],\n    references: [tenants.id],\n  }),\n  template: one(emailTemplates, {\n    fields: [emailCampaigns.templateId],\n    references: [emailTemplates.id],\n  }),\n  segment: one(emailSegments, {\n    fields: [emailCampaigns.segmentId],\n    references: [emailSegments.id],\n  }),\n  createdBy: one(users, {\n    fields: [emailCampaigns.createdById],\n    references: [users.id],\n  }),\n  messages: many(emailMessages),\n}));\n\nexport const emailMessagesRelations = relations(emailMessages, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [emailMessages.tenantId],\n    references: [tenants.id],\n  }),\n  campaign: one(emailCampaigns, {\n    fields: [emailMessages.campaignId],\n    references: [emailCampaigns.id],\n  }),\n  template: one(emailTemplates, {\n    fields: [emailMessages.templateId],\n    references: [emailTemplates.id],\n  }),\n  member: one(members, {\n    fields: [emailMessages.memberId],\n    references: [members.id],\n  }),\n}));\n\nexport const emailSuppressesRelations = relations(emailSuppresses, ({ one }) => ({\n  tenant: one(tenants, {\n    fields: [emailSuppresses.tenantId],\n    references: [tenants.id],\n  }),\n  member: one(members, {\n    fields: [emailSuppresses.memberId],\n    references: [members.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertTenantSchema = createInsertSchema(tenants).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMemberSchema = createInsertSchema(members).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMemberFinancialSettingsSchema = createInsertSchema(memberFinancialSettings).omit({\n  id: true,\n});\n\nexport const insertMemberPermissionsSchema = createInsertSchema(memberPermissions).omit({\n  id: true,\n});\n\nexport const insertMandateSchema = createInsertSchema(mandates).omit({\n  id: true,\n});\n\nexport const insertMembershipFeeSchema = createInsertSchema(membershipFees).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({\n  id: true,\n});\n\nexport const insertRuleSchema = createInsertSchema(rules).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertRuleOutcomeSchema = createInsertSchema(ruleOutcomes).omit({\n  id: true,\n  evaluatedAt: true,\n});\n\nexport const insertRuleOverrideSchema = createInsertSchema(ruleOverrides).omit({\n  id: true,\n  overriddenAt: true,\n});\n\nexport const insertPublicScreenSchema = createInsertSchema(publicScreens).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertAnnouncementSchema = createInsertSchema(announcements).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCardMetaSchema = createInsertSchema(cardMeta).omit({\n  id: true,\n  lastRenderedAt: true,\n});\n\n// Live Card schemas for public endpoints\nexport const cardVerifyResponseSchema = z.object({\n  ok: z.boolean(),\n  member: z.object({\n    naam: z.string(),\n    nummer: z.string(),\n  }),\n  status: z.object({\n    actief: z.boolean(),\n    betaaldDitJaar: z.boolean(),\n    geldigTot: z.string().nullable(),\n  }),\n  tenant: z.object({\n    naam: z.string(),\n    slug: z.string(),\n  }),\n  ts: z.number(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertSepaExportSchema = createInsertSchema(sepaExports).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertBankStatementSchema = createInsertSchema(bankStatements).omit({\n  id: true,\n  importedAt: true,\n});\n\nexport const insertBankTransactionSchema = createInsertSchema(bankTransactions).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertExpenseCategorySchema = createInsertSchema(expenseCategories).omit({\n  id: true,\n});\n\nexport const insertVendorSchema = createInsertSchema(vendors).omit({\n  id: true,\n});\n\nexport const insertMatchRuleSchema = createInsertSchema(matchRules).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertBoardMemberSchema = createInsertSchema(boardMembers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n}).extend({\n  role: z.string().optional().default('BESTUURSLID'),\n  // Allow string dates to be converted to Date objects\n  termStart: z.union([\n    z.date(),\n    z.string().transform((val) => new Date(val))\n  ]).refine((date) => date instanceof Date && !isNaN(date.getTime()), {\n    message: \"Ongeldige startdatum\"\n  }),\n  termEnd: z.union([\n    z.date(),\n    z.string().transform((val) => new Date(val))\n  ]).refine((date) => date instanceof Date && !isNaN(date.getTime()), {\n    message: \"Ongeldige einddatum\"\n  }),\n});\n\nexport const insertBoardTermSchema = createInsertSchema(boardTerms).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEmailTemplateSchema = createInsertSchema(emailTemplates).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertEmailSegmentSchema = createInsertSchema(emailSegments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEmailCampaignSchema = createInsertSchema(emailCampaigns).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertEmailMessageSchema = createInsertSchema(emailMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertEmailSuppressSchema = createInsertSchema(emailSuppresses).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Types\nexport type Tenant = typeof tenants.$inferSelect;\nexport type InsertTenant = z.infer<typeof insertTenantSchema>;\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\nexport type Member = typeof members.$inferSelect;\nexport type InsertMember = z.infer<typeof insertMemberSchema>;\n\nexport type MemberFinancialSettings = typeof memberFinancialSettings.$inferSelect;\nexport type InsertMemberFinancialSettings = z.infer<typeof insertMemberFinancialSettingsSchema>;\n\nexport type MemberPermissions = typeof memberPermissions.$inferSelect;\nexport type InsertMemberPermissions = z.infer<typeof insertMemberPermissionsSchema>;\n\nexport type Mandate = typeof mandates.$inferSelect;\nexport type InsertMandate = z.infer<typeof insertMandateSchema>;\n\nexport type MembershipFee = typeof membershipFees.$inferSelect;\nexport type InsertMembershipFee = z.infer<typeof insertMembershipFeeSchema>;\n\nexport type Transaction = typeof transactions.$inferSelect;\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\n\nexport type Rule = typeof rules.$inferSelect;\nexport type InsertRule = z.infer<typeof insertRuleSchema>;\n\nexport type RuleOutcome = typeof ruleOutcomes.$inferSelect;\nexport type InsertRuleOutcome = z.infer<typeof insertRuleOutcomeSchema>;\n\nexport type RuleOverride = typeof ruleOverrides.$inferSelect;\nexport type InsertRuleOverride = z.infer<typeof insertRuleOverrideSchema>;\n\nexport type PublicScreen = typeof publicScreens.$inferSelect;\nexport type InsertPublicScreen = z.infer<typeof insertPublicScreenSchema>;\n\nexport type Announcement = typeof announcements.$inferSelect;\nexport type InsertAnnouncement = z.infer<typeof insertAnnouncementSchema>;\n\nexport type CardMeta = typeof cardMeta.$inferSelect;\nexport type InsertCardMeta = z.infer<typeof insertCardMetaSchema>;\n\nexport type Notification = typeof notifications.$inferSelect;\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\n\nexport type SepaExport = typeof sepaExports.$inferSelect;\nexport type InsertSepaExport = z.infer<typeof insertSepaExportSchema>;\n\nexport type BankStatement = typeof bankStatements.$inferSelect;\nexport type InsertBankStatement = z.infer<typeof insertBankStatementSchema>;\n\nexport type BankTransaction = typeof bankTransactions.$inferSelect;\nexport type InsertBankTransaction = z.infer<typeof insertBankTransactionSchema>;\n\nexport type ExpenseCategory = typeof expenseCategories.$inferSelect;\nexport type InsertExpenseCategory = z.infer<typeof insertExpenseCategorySchema>;\n\nexport type Vendor = typeof vendors.$inferSelect;\nexport type InsertVendor = z.infer<typeof insertVendorSchema>;\n\nexport type MatchRule = typeof matchRules.$inferSelect;\nexport type InsertMatchRule = z.infer<typeof insertMatchRuleSchema>;\n\nexport type BoardMember = typeof boardMembers.$inferSelect;\nexport type InsertBoardMember = z.infer<typeof insertBoardMemberSchema>;\n\nexport type BoardTerm = typeof boardTerms.$inferSelect;\nexport type InsertBoardTerm = z.infer<typeof insertBoardTermSchema>;\n\nexport type CardVerifyResponse = z.infer<typeof cardVerifyResponseSchema>;\n\n// Rapportage types\nexport type MoneyPoint = {\n  date: string;\n  income: number;\n  expense: number;\n  net: number;\n};\n\nexport type CategorySlice = {\n  category: string;\n  amount: number;\n  count: number;\n};\n\nexport type StackedMonth = {\n  month: string;\n  [category: string]: number | string;\n};\n\nexport type FeeStatusMonth = {\n  month: string;\n  betaald: number;\n  openstaand: number;\n  vervallen: number;\n};\n\nexport type TopMember = {\n  memberId: string;\n  name: string;\n  total: number;\n  count: number;\n  spark: number[];\n};\n\nexport type MethodSlice = {\n  method: \"SEPA\" | \"OVERSCHRIJVING\" | \"BANCONTACT\" | \"CASH\" | \"OVERIG\";\n  amount: number;\n  count: number;\n};\n\nexport type EmailTemplate = typeof emailTemplates.$inferSelect;\nexport type InsertEmailTemplate = z.infer<typeof insertEmailTemplateSchema>;\n\nexport type EmailSegment = typeof emailSegments.$inferSelect;\nexport type InsertEmailSegment = z.infer<typeof insertEmailSegmentSchema>;\n\nexport type EmailCampaign = typeof emailCampaigns.$inferSelect;\nexport type InsertEmailCampaign = z.infer<typeof insertEmailCampaignSchema>;\n\nexport type EmailMessage = typeof emailMessages.$inferSelect;\nexport type InsertEmailMessage = z.infer<typeof insertEmailMessageSchema>;\n\nexport type EmailSuppress = typeof emailSuppresses.$inferSelect;\nexport type InsertEmailSuppress = z.infer<typeof insertEmailSuppressSchema>;\n","size_bytes":36233},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport AppShell from \"@/components/layout/app-shell\";\nimport NotFound from \"@/pages/not-found\";\nimport Dashboard from \"@/pages/dashboard\";\nimport Login from \"@/pages/login\";\nimport Leden from \"@/pages/leden\";\nimport Lidgelden from \"@/pages/lidgelden\";\nimport FinancePage from \"@/pages/FinancePage\";\nimport PubliekeSchermen from \"@/pages/publieke-schermen\";\nimport PublicScreensPage from \"@/pages/PublicScreensPage\";\nimport PublicScreenViewPage from \"@/pages/PublicScreenViewPage\";\nimport { PublicViewPage } from \"@/pages/PublicViewPage\";\nimport Instellingen from \"@/pages/instellingen\";\nimport Profiel from \"@/pages/profiel\";\nimport { CardPage } from \"@/pages/card\";\nimport CardVerifyPage from \"@/pages/card-verify\";\nimport PublicCard from \"@/pages/public-card\";\nimport Lidkaarten from \"@/pages/lidkaarten\";\nimport Bestuur from \"@/pages/bestuur\";\nimport Berichten from \"@/pages/berichten\";\nimport { InstallPrompt } from \"@/components/pwa/install-prompt\";\nimport { OfflineIndicator } from \"@/components/pwa/offline-indicator\";\n\nfunction LoadingSpinner() {\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-background\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto\"></div>\n        <p className=\"mt-4 text-muted-foreground\">Laden...</p>\n      </div>\n    </div>\n  );\n}\n\nfunction ProtectedRoute({ component: Component, ...props }: { component: React.ComponentType }) {\n  const { user, loading } = useAuth();\n\n  if (loading) {\n    return <LoadingSpinner />;\n  }\n\n  if (!user) {\n    return <Login />;\n  }\n\n  return (\n    <AppShell>\n      <Component {...props} />\n    </AppShell>\n  );\n}\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/\" component={() => <ProtectedRoute component={Dashboard} />} />\n      <Route path=\"/dashboard\" component={() => <ProtectedRoute component={Dashboard} />} />\n      <Route path=\"/leden\" component={() => <ProtectedRoute component={Leden} />} />\n      <Route path=\"/lidkaarten\" component={() => <ProtectedRoute component={Lidkaarten} />} />\n      <Route path=\"/lidgelden\" component={() => <ProtectedRoute component={Lidgelden} />} />\n      <Route path=\"/financien\" component={() => <ProtectedRoute component={FinancePage} />} />\n      <Route path=\"/publieke-schermen\" component={() => <ProtectedRoute component={PublicScreensPage} />} />\n      <Route path=\"/public/screen/:publicToken\" component={PublicScreenViewPage} />\n      <Route path=\"/screen/:publicToken\" component={PublicScreenViewPage} />\n      <Route path=\"/card/:memberId\" component={CardPage} />\n      <Route path=\"/card/verify/:qrToken\" component={CardVerifyPage} />\n      <Route path=\"/public/card/:memberId\" component={PublicCard} />\n      <Route path=\"/bestuur\" component={() => <ProtectedRoute component={Bestuur} />} />\n      <Route path=\"/berichten\" component={() => <ProtectedRoute component={Berichten} />} />\n      <Route path=\"/instellingen\" component={() => <ProtectedRoute component={Instellingen} />} />\n      <Route path=\"/profiel\" component={() => <ProtectedRoute component={Profiel} />} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n        <InstallPrompt />\n        <OfflineIndicator />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":3809},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');\n@import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --animation-duration: 800ms;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  :root {\n    --animation-duration: 0ms;\n  }\n  \n  * {\n    animation-duration: 0.01ms !important;\n    animation-iteration-count: 1 !important;\n    transition-duration: 0.01ms !important;\n  }\n}\n\n/* Concentric rings animation */\n@keyframes drawArc {\n  0% {\n    stroke-dasharray: 0 1000;\n  }\n  100% {\n    stroke-dasharray: 1000 0;\n  }\n}\n\n.animate-drawArc {\n  animation: drawArc 1s ease-out forwards;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .animate-drawArc {\n    animation: none !important;\n    stroke-dasharray: 1000 0 !important;\n  }\n}\n\n\n\n/* Gold shimmer animation for real gold effect */\n@keyframes goldShimmer {\n  0% {\n    background-position: -200% -200%;\n  }\n  50% {\n    background-position: 200% 200%;\n  }\n  100% {\n    background-position: -200% -200%;\n  }\n}\n\n/* Debossed QR code effect - transparent button with gold QR */\n.debossed-qr-container {\n  width: 100px;\n  height: 100px;\n  padding: 10px;\n  border-radius: 12px;\n  background: rgba(0, 0, 0, 0.1);\n  box-shadow: \n    inset 0 2px 4px rgba(0, 0, 0, 0.3),\n    inset 0 0 1px rgba(0, 0, 0, 0.5),\n    0 1px 0 rgba(255, 255, 255, 0.1);\n  position: relative;\n}\n\n.debossed-qr-frame {\n  width: 100%;\n  height: 100%;\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.05);\n  box-shadow: \n    inset 0 1px 2px rgba(0, 0, 0, 0.4),\n    0 0 0 1px rgba(255, 255, 255, 0.05);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n  overflow: hidden;\n}\n\n.debossed-qr-frame::before {\n  content: '';\n  position: absolute;\n  inset: 0;\n  background: \n    linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.6) 50%, transparent 70%),\n    linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, transparent 30%, rgba(255, 255, 255, 0.15) 100%),\n    repeating-linear-gradient(\n      45deg,\n      transparent 0px,\n      rgba(255, 255, 255, 0.1) 1px,\n      transparent 3px\n    );\n  pointer-events: none;\n  border-radius: 6px;\n}\n\n.debossed-qr {\n  opacity: 1;\n  filter: \n    contrast(1.2) \n    brightness(1.4) \n    saturate(0.8)\n    drop-shadow(0 0 1px rgba(255, 255, 255, 0.6))\n    drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3))\n    drop-shadow(0 0 4px rgba(184, 188, 200, 0.5))\n    drop-shadow(0 -1px 0 rgba(255, 255, 255, 0.2));\n}\n\n/* Debossed icon effect for voting rights */\n.debossed-icon {\n  filter: \n    drop-shadow(0 1px 1px rgba(0, 0, 0, 0.4))\n    drop-shadow(0 0 2px rgba(0, 0, 0, 0.2));\n  opacity: 0.7;\n}\n\n/* 360° flip animation for card refresh */\n@keyframes flip-horizontal {\n  0% {\n    transform: perspective(1000px) rotateY(0deg);\n  }\n  50% {\n    transform: perspective(1000px) rotateY(180deg);\n  }\n  100% {\n    transform: perspective(1000px) rotateY(360deg);\n  }\n}\n\n.animate-flip-horizontal {\n  animation: flip-horizontal 400ms cubic-bezier(0.25, 0.46, 0.45, 0.94);\n  transform-style: preserve-3d;\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .animate-flip-horizontal {\n    animation: none !important;\n  }\n}\n\n:root {\n  /* HubSpot-style design system */\n  --background: linear-gradient(135deg, hsl(210, 20%, 98%) 0%, hsl(210, 16%, 96%) 50%, hsl(210, 12%, 94%) 100%);\n  --foreground: hsl(221, 39%, 11%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(221, 39%, 11%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(221, 39%, 11%);\n  \n  /* Primary: Blue #2563EB */\n  --primary: hsl(217, 91%, 60%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  \n  /* Secondary: Light Blue #3B82F6 */\n  --secondary: hsl(221, 83%, 53%);\n  --secondary-foreground: hsl(0, 0%, 100%);\n  \n  /* Neutrals */\n  --muted: hsl(220, 13%, 95%);\n  --muted-foreground: hsl(215, 16%, 47%);\n  --accent: hsl(217, 91%, 95%);\n  --accent-foreground: hsl(217, 91%, 20%);\n  \n  /* Tab active state - medium blue */\n  --tab-active: hsl(217, 91%, 85%);\n  --tab-active-foreground: hsl(217, 91%, 15%);\n  \n  /* Status colors */\n  --destructive: hsl(0, 72%, 51%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --success: hsl(142, 71%, 45%);\n  --success-foreground: hsl(0, 0%, 100%);\n  --warning: hsl(38, 92%, 50%);\n  --warning-foreground: hsl(0, 0%, 100%);\n  --info: hsl(221, 83%, 53%);\n  --info-foreground: hsl(0, 0%, 100%);\n  \n  /* Borders and inputs */\n  --border: hsl(214, 32%, 91%);\n  --input: hsl(214, 32%, 91%);\n  --ring: hsl(217, 91%, 60%);\n  \n  /* Charts using blue palette */\n  --chart-1: hsl(217, 91%, 60%);\n  --chart-2: hsl(221, 83%, 53%);\n  --chart-3: hsl(212, 100%, 50%);\n  --chart-4: hsl(207, 90%, 54%);\n  --chart-5: hsl(38, 92%, 50%);\n  \n  /* Sidebar - dark slate theme */\n  --sidebar: hsl(215, 28%, 17%);\n  --sidebar-foreground: hsl(213, 31%, 91%);\n  --sidebar-primary: hsl(217, 91%, 60%);\n  --sidebar-primary-foreground: hsl(0, 0%, 100%);\n  --sidebar-accent: hsl(215, 25%, 25%);\n  --sidebar-accent-foreground: hsl(213, 31%, 91%);\n  --sidebar-border: hsl(215, 25%, 25%);\n  --sidebar-ring: hsl(217, 91%, 60%);\n  \n  /* Typography */\n  --font-sans: \"Poppins\", ui-sans-serif, system-ui;\n  --font-serif: Georgia, serif;\n  --font-mono: \"SF Mono\", Monaco, \"Cascadia Code\", \"Roboto Mono\", Consolas, \"Courier New\", monospace;\n  \n  /* Border radius - Modern SaaS style */\n  --radius: 12px;\n  /* Modern sophisticated shadows - subtler */\n  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.02), 0 1px 3px 0 rgb(0 0 0 / 0.04);\n  --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.04), 0 4px 8px 0 rgb(0 0 0 / 0.02);\n  --shadow-md: 0 4px 12px -2px rgb(0 0 0 / 0.04), 0 4px 8px -2px rgb(0 0 0 / 0.03);\n  --shadow-lg: 0 8px 25px -5px rgb(0 0 0 / 0.06), 0 8px 16px -8px rgb(0 0 0 / 0.03);\n  --shadow-xl: 0 20px 40px -8px rgb(0 0 0 / 0.08), 0 8px 16px -8px rgb(0 0 0 / 0.04);\n  --shadow-2xl: 0 32px 64px -12px rgb(0 0 0 / 0.1), 0 16px 32px -16px rgb(0 0 0 / 0.06);\n  \n  /* Glassmorphism shadows - subtler */\n  --glass-shadow: 0 8px 32px 0 rgb(31 38 135 / 0.08);\n  --glass-shadow-hover: 0 16px 48px 0 rgb(31 38 135 / 0.12);\n  \n  /* Spacing scale */\n  --spacing-1: 0.25rem;\n  --spacing-2: 0.5rem;\n  --spacing-3: 0.75rem;\n  --spacing-4: 1rem;\n  --spacing-5: 1.25rem;\n  --spacing-6: 1.5rem;\n  --spacing-8: 2rem;\n  --spacing-10: 2.5rem;\n}\n\n.dark {\n  /* Dark mode - HubSpot style */\n  --background: linear-gradient(135deg, hsl(222, 84%, 5%) 0%, hsl(222, 70%, 4%) 50%, hsl(222, 60%, 3%) 100%);\n  --foreground: hsl(213, 31%, 91%);\n  --card: hsl(222, 84%, 5%);\n  --card-foreground: hsl(213, 31%, 91%);\n  --popover: hsl(215, 28%, 17%);\n  --popover-foreground: hsl(213, 31%, 91%);\n  \n  /* Primary: Lighter blue for dark mode */\n  --primary: hsl(221, 83%, 53%);\n  --primary-foreground: hsl(0, 0%, 100%);\n  \n  /* Secondary: Even lighter blue for dark mode */\n  --secondary: hsl(212, 100%, 50%);\n  --secondary-foreground: hsl(0, 0%, 100%);\n  \n  /* Neutrals for dark mode */\n  --muted: hsl(215, 25%, 15%);\n  --muted-foreground: hsl(217, 10%, 64%);\n  --accent: hsl(215, 25%, 15%);\n  --accent-foreground: hsl(217, 10%, 64%);\n  \n  /* Status colors for dark mode */\n  --destructive: hsl(0, 62%, 63%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  --success: hsl(142, 71%, 45%);\n  --success-foreground: hsl(0, 0%, 100%);\n  --warning: hsl(38, 92%, 50%);\n  --warning-foreground: hsl(0, 0%, 100%);\n  --info: hsl(221, 83%, 53%);\n  --info-foreground: hsl(0, 0%, 100%);\n  \n  /* Borders and inputs for dark mode */\n  --border: hsl(215, 25%, 25%);\n  --input: hsl(215, 25%, 25%);\n  --ring: hsl(221, 83%, 53%);\n  \n  /* Charts for dark mode */\n  --chart-1: hsl(221, 83%, 53%);\n  --chart-2: hsl(212, 100%, 50%);\n  --chart-3: hsl(217, 91%, 60%);\n  --chart-4: hsl(207, 90%, 54%);\n  --chart-5: hsl(38, 92%, 50%);\n  \n  /* Sidebar remains the same in dark mode */\n  --sidebar: hsl(215, 28%, 17%);\n  --sidebar-foreground: hsl(213, 31%, 91%);\n  --sidebar-primary: hsl(221, 83%, 53%);\n  --sidebar-primary-foreground: hsl(0, 0%, 100%);\n  --sidebar-accent: hsl(215, 25%, 25%);\n  --sidebar-accent-foreground: hsl(213, 31%, 91%);\n  --sidebar-border: hsl(215, 25%, 25%);\n  --sidebar-ring: hsl(221, 83%, 53%);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    font-feature-settings: \"cv11\", \"cv02\", \"cv03\", \"cv04\";\n  }\n  \n  /* HubSpot-style focus management */\n  :focus-visible {\n    @apply outline-none ring-2 ring-primary ring-offset-2 ring-offset-background;\n  }\n  \n  /* Modern button hover effects */\n  .btn-hover {\n    @apply transition-all duration-300 ease-out hover:shadow-lg;\n  }\n  \n  /* Card hover effects with glassmorphism */\n  .card-hover {\n    @apply transition-all duration-300 ease-out;\n  }\n  \n  /* Glassmorphism card effect */\n  .glass-card {\n    @apply backdrop-blur-xl bg-white/80 dark:bg-gray-900/80 border border-white/20 dark:border-gray-700/50;\n    box-shadow: var(--glass-shadow);\n  }\n  \n  .glass-card:hover {\n    box-shadow: var(--glass-shadow-hover);\n  }\n  \n  /* Premium button styles */\n  .btn-premium {\n    @apply relative overflow-hidden bg-gradient-to-r from-blue-600 via-blue-500 to-blue-600 text-white font-medium rounded-xl px-6 py-3 shadow-lg transition-all duration-300;\n    background-size: 200% 100%;\n  }\n  \n  .btn-premium:hover {\n    @apply shadow-xl;\n    background-position: 100% 0;\n  }\n  \n  .btn-premium::before {\n    content: '';\n    @apply absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent transform -skew-x-12 -translate-x-full transition-transform duration-700;\n  }\n  \n  .btn-premium:hover::before {\n    @apply translate-x-full;\n  }\n  \n  /* Smooth scrolling */\n  html {\n    scroll-behavior: smooth;\n  }\n}\n\n@layer components {\n  /* Modern focus ring with animations */\n  .focus-ring {\n    @apply focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 transition-all duration-200;\n  }\n  \n  /* Enhanced focus ring for inputs */\n  .input-focus-ring {\n    @apply focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 focus:border-blue-500 transition-all duration-200;\n  }\n  \n  /* Micro animations */\n  .animate-scale-in {\n    @apply animate-in zoom-in-95 duration-200;\n  }\n  \n  .animate-slide-up {\n    @apply animate-in slide-in-from-bottom-2 duration-300;\n  }\n  \n  .animate-fade-in {\n    @apply animate-in fade-in duration-500;\n  }\n  \n  /* Modern loading pulse */\n  .pulse-modern {\n    @apply animate-pulse bg-gradient-to-r from-gray-200 via-gray-100 to-gray-200 dark:from-gray-700 dark:via-gray-600 dark:to-gray-700;\n    background-size: 200% 100%;\n    animation: modern-pulse 2s ease-in-out infinite;\n  }\n  \n  @keyframes modern-pulse {\n    0% { background-position: -200% 0; }\n    100% { background-position: 200% 0; }\n  }\n  \n  /* Modern button and input styles */\n  .btn-modern {\n    @apply px-4 py-2.5 bg-primary text-primary-foreground font-medium rounded-lg shadow-sm hover:shadow-md transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-0.5 focus-ring;\n  }\n  \n  .btn-secondary-modern {\n    @apply px-4 py-2.5 bg-background text-foreground font-medium rounded-lg border border-border shadow-sm hover:shadow-md transition-all duration-300 ease-out hover:scale-102 hover:-translate-y-0.5 focus-ring hover:border-primary/30;\n  }\n  \n  .input-modern {\n    @apply px-4 py-3 bg-background border border-border rounded-lg text-foreground placeholder:text-muted-foreground input-focus-ring transition-all duration-200 hover:border-primary/30;\n  }\n  \n  /* Modern table styles */\n  .table-modern {\n    @apply w-full border-collapse;\n  }\n  \n  .table-modern th {\n    @apply px-4 py-3 text-left text-sm font-semibold text-muted-foreground bg-muted/50 border-b border-border;\n  }\n  \n  .table-modern td {\n    @apply px-4 py-3 text-sm text-foreground border-b border-border/50 transition-colors duration-200;\n  }\n  \n  .table-modern tbody tr:hover {\n    @apply bg-muted/30;\n  }\n  \n  /* Topbar styles */\n  .topbar {\n    @apply h-20 bg-background border-b border-border px-8 flex items-center justify-between;\n  }\n  \n  /* Sidebar styles */\n  .sidebar {\n    @apply bg-sidebar text-sidebar-foreground w-64 min-h-screen border-r border-sidebar-border;\n  }\n  \n  /* Content area styles */\n  .content-area {\n    @apply w-full h-[calc(100vh-3rem)] overflow-auto;\n  }\n\n  /* Premium card styles */\n  .card-font {\n    font-family: 'Space Grotesk', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;\n  }\n\n  .embossed-text {\n    color: #F8FAFC;\n    text-shadow: 0 1px 2px rgba(0,0,0,0.4), 0 0 8px rgba(255,255,255,0.1);\n    font-weight: 500;\n  }\n\n  .card-gradient {\n    background-image: url('../attached_assets/fading-blue-background_1756897101831.jpg'), linear-gradient(135deg, rgba(8, 35, 66, 0.9) 0%, rgba(6, 47, 89, 0.95) 100%);\n    background-size: cover;\n    background-position: center;\n    background-blend-mode: overlay;\n    position: relative;\n  }\n\n  .card-gradient::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(135deg, rgba(0,0,0,0.1) 0%, transparent 50%, rgba(0,0,0,0.2) 100%);\n    pointer-events: none;\n  }\n\n  .status-led-glow-green {\n    box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.18);\n  }\n\n  .status-led-glow-orange {\n    box-shadow: 0 0 0 4px rgba(245, 158, 11, 0.18);\n  }\n\n  .status-led-glow-red {\n    box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.18);\n  }\n\n  @keyframes card-shine {\n    0% {\n      transform: translateX(-100%) rotate(35deg);\n    }\n    100% {\n      transform: translateX(400%) rotate(35deg);\n    }\n  }\n\n  .card-shine {\n    animation: card-shine 800ms ease-out;\n  }\n\n  @media (prefers-reduced-motion: reduce) {\n    .card-shine {\n      animation: none;\n    }\n    \n    .animate-flip-horizontal {\n      animation: none;\n    }\n  }\n}\n","size_bytes":13812},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport { initPWA } from \"./lib/pwa\";\n\n// Register service worker for PWA\nif ('serviceWorker' in navigator && import.meta.env.PROD) {\n  window.addEventListener('load', () => {\n    navigator.serviceWorker.register('/sw.js')\n      .then((registration) => {\n        console.log('[PWA] Service worker registered successfully:', registration);\n        \n        // Listen for updates\n        registration.addEventListener('updatefound', () => {\n          const newWorker = registration.installing;\n          if (newWorker) {\n            newWorker.addEventListener('statechange', () => {\n              if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n                // New content is available, show update notification\n                if (confirm('Nieuwe versie beschikbaar. Nu updaten?')) {\n                  newWorker.postMessage({ type: 'SKIP_WAITING' });\n                  window.location.reload();\n                }\n              }\n            });\n          }\n        });\n      })\n      .catch((registrationError) => {\n        console.warn('[PWA] Service worker registration failed:', registrationError);\n      });\n  });\n} else if (!('serviceWorker' in navigator)) {\n  console.warn('[PWA] Service worker not supported in this browser');\n} else {\n  console.log('[PWA] Service worker disabled in development mode');\n}\n\n// Initialize PWA features\ninitPWA();\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":1539},"server/middleware/auth.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport { storage } from \"../storage\";\nimport { authService } from \"../services/auth\";\n\ndeclare global {\n  namespace Express {\n    interface Request {\n      user?: {\n        id: string;\n        tenantId: string;\n        name: string;\n        email: string;\n        role: 'SUPERADMIN' | 'BEHEERDER' | 'MEDEWERKER';\n        active: boolean;\n        createdAt: Date;\n      };\n      tenantId?: string;\n    }\n  }\n}\n\nexport async function authMiddleware(req: Request, res: Response, next: NextFunction) {\n  try {\n    const authHeader = req.headers.authorization;\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res.status(401).json({ message: \"Inloggen vereist. Log eerst in.\" });\n    }\n\n    const token = authHeader.substring(7);\n    const decoded = authService.verifyToken(token);\n    \n    if (!decoded) {\n      return res.status(401).json({ message: \"Uw sessie is verlopen. Log opnieuw in.\" });\n    }\n\n    const user = await storage.getUser(decoded.userId);\n    if (!user || !user.active) {\n      return res.status(401).json({ message: \"Account niet gevonden. Neem contact op met de beheerder.\" });\n    }\n\n    req.user = user;\n    req.tenantId = user.tenantId;\n    next();\n  } catch (error) {\n    console.error('Auth middleware error:', error);\n    res.status(401).json({ message: \"Inloggen mislukt. Probeer opnieuw.\" });\n  }\n}\n","size_bytes":1408},"server/middleware/tenant.ts":{"content":"import { Request, Response, NextFunction } from \"express\";\nimport { storage } from \"../storage\";\n\nexport async function tenantMiddleware(req: Request, res: Response, next: NextFunction) {\n  try {\n    if (!req.tenantId) {\n      return res.status(401).json({ message: \"Geen tenant context\" });\n    }\n\n    const tenant = await storage.getTenant(req.tenantId);\n    if (!tenant) {\n      return res.status(404).json({ message: \"Tenant niet gevonden\" });\n    }\n\n    next();\n  } catch (error) {\n    console.error('Tenant middleware error:', error);\n    res.status(500).json({ message: \"Tenant verificatie mislukt\" });\n  }\n}\n","size_bytes":616},"server/services/auth.ts":{"content":"import bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport { storage } from \"../storage\";\nimport { type User } from \"@shared/schema\";\nimport { sendEmail, generatePasswordResetEmail } from \"./email\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key\";\n\ninterface LoginResult {\n  success: boolean;\n  message?: string;\n  user?: User;\n  token?: string;\n}\n\ninterface ResetPasswordResult {\n  success: boolean;\n  message?: string;\n}\n\nclass AuthService {\n  async login(email: string, password: string): Promise<LoginResult> {\n    try {\n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return { success: false, message: \"E-mailadres niet gevonden. Controleer uw inloggegevens.\" };\n      }\n\n      if (!user.active) {\n        return { success: false, message: \"Dit account is uitgeschakeld. Neem contact op met de beheerder.\" };\n      }\n\n      const isValidPassword = await bcrypt.compare(password, user.passwordHash);\n      if (!isValidPassword) {\n        return { success: false, message: \"Wachtwoord is niet correct. Probeer opnieuw.\" };\n      }\n\n      const token = this.generateToken(user.id);\n      \n      const { passwordHash, ...userWithoutPassword } = user;\n      return {\n        success: true,\n        user: userWithoutPassword as User,\n        token,\n      };\n    } catch (error) {\n      console.error(\"Login error:\", error);\n      return { success: false, message: \"Inloggen mislukt. Probeer het later opnieuw.\" };\n    }\n  }\n\n  generateToken(userId: string): string {\n    return jwt.sign({ userId }, JWT_SECRET, { expiresIn: \"24h\" });\n  }\n\n  verifyToken(token: string): { userId: string } | null {\n    try {\n      const decoded = jwt.verify(token, JWT_SECRET) as { userId: string };\n      return decoded;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  async hashPassword(password: string): Promise<string> {\n    return bcrypt.hash(password, 12);\n  }\n\n  generateRandomPassword(): string {\n    const length = 12;\n    const charset = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\";\n    let password = \"\";\n    for (let i = 0; i < length; i++) {\n      password += charset.charAt(Math.floor(Math.random() * charset.length));\n    }\n    return password;\n  }\n\n  async resetPassword(email: string): Promise<ResetPasswordResult> {\n    try {\n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return { success: false, message: \"E-mailadres niet gevonden in het systeem.\" };\n      }\n\n      if (!user.active) {\n        return { success: false, message: \"Dit account is uitgeschakeld. Neem contact op met de beheerder.\" };\n      }\n\n      // Generate new password\n      const newPassword = this.generateRandomPassword();\n      const hashedPassword = await this.hashPassword(newPassword);\n\n      // Update user password\n      await storage.updateUserPassword(user.id, hashedPassword);\n\n      // Send email with new password\n      const emailContent = generatePasswordResetEmail(newPassword, user.email);\n      const emailSent = await sendEmail({\n        to: user.email,\n        from: \"noreply@idarah.be\", // You can configure this\n        subject: emailContent.subject,\n        text: emailContent.text,\n        html: emailContent.html,\n      });\n\n      if (!emailSent) {\n        console.error(\"Failed to send password reset email to:\", user.email);\n        // Still return success since password was updated\n      }\n\n      return { success: true, message: \"Een nieuw wachtwoord is verzonden naar uw e-mailadres.\" };\n    } catch (error) {\n      console.error(\"Password reset error:\", error);\n      return { success: false, message: \"Er is een fout opgetreden bij het resetten van uw wachtwoord.\" };\n    }\n  }\n}\n\nexport const authService = new AuthService();\n","size_bytes":3765},"server/services/fee.ts":{"content":"import { storage } from \"../storage\";\nimport { type MembershipFee } from \"@shared/schema\";\n\ninterface MarkFeePaidResult {\n  success: boolean;\n  message?: string;\n  fee?: MembershipFee;\n}\n\nclass FeeService {\n  async markFeePaid(feeId: string, tenantId: string): Promise<MarkFeePaidResult> {\n    try {\n      const fee = await storage.getMembershipFee(feeId);\n      if (!fee || fee.tenantId !== tenantId) {\n        return {\n          success: false,\n          message: \"Lidgeld niet gevonden\",\n        };\n      }\n\n      if (fee.status === 'PAID') {\n        return {\n          success: false,\n          message: \"Lidgeld is al betaald\",\n        };\n      }\n\n      const updatedFee = await storage.updateMembershipFee(feeId, {\n        status: 'PAID',\n        paidAt: new Date(),\n        method: 'OVERSCHRIJVING', // Default payment method\n      });\n\n      // Create transaction record\n      await storage.createTransaction({\n        tenantId,\n        memberId: fee.memberId,\n        type: 'INCOME',\n        category: 'Lidgeld',\n        amount: fee.amount,\n        date: new Date(),\n        method: 'OVERSCHRIJVING',\n        description: `Lidgeld betaling voor periode ${fee.periodStart.toLocaleDateString('nl-BE')} - ${fee.periodEnd.toLocaleDateString('nl-BE')}`,\n        relatedFeeId: feeId,\n      });\n\n      return {\n        success: true,\n        fee: updatedFee,\n      };\n    } catch (error) {\n      console.error(\"Error marking fee as paid:\", error);\n      return {\n        success: false,\n        message: \"Fout bij het markeren van lidgeld als betaald\",\n      };\n    }\n  }\n}\n\nexport const feeService = new FeeService();\n","size_bytes":1621},"server/services/financial.ts":{"content":"import { storage } from \"../storage\";\n\ninterface FinancialReports {\n  monthlyRevenue: { month: string; amount: number }[];\n  paymentStatus: { status: string; count: number; amount: number }[];\n  categoryBreakdown: { category: string; amount: number }[];\n}\n\nclass FinancialService {\n  async generateReports(tenantId: string): Promise<FinancialReports> {\n    try {\n      const transactions = await storage.getTransactionsByTenant(tenantId);\n      const fees = await storage.getMembershipFeesByTenant(tenantId);\n\n      // Monthly revenue for the last 12 months\n      const monthlyRevenue = this.calculateMonthlyRevenue(transactions);\n\n      // Payment status breakdown\n      const paymentStatus = this.calculatePaymentStatus(fees);\n\n      // Category breakdown\n      const categoryBreakdown = this.calculateCategoryBreakdown(transactions);\n\n      return {\n        monthlyRevenue,\n        paymentStatus,\n        categoryBreakdown,\n      };\n    } catch (error) {\n      console.error(\"Error generating financial reports:\", error);\n      throw error;\n    }\n  }\n\n  private calculateMonthlyRevenue(transactions: any[]): { month: string; amount: number }[] {\n    const monthlyData: { [key: string]: number } = {};\n    \n    transactions\n      .filter(t => t.type === 'INCOME')\n      .forEach(transaction => {\n        const month = new Date(transaction.date).toISOString().slice(0, 7); // YYYY-MM\n        monthlyData[month] = (monthlyData[month] || 0) + parseFloat(transaction.amount);\n      });\n\n    return Object.entries(monthlyData)\n      .map(([month, amount]) => ({ month, amount }))\n      .sort((a, b) => a.month.localeCompare(b.month))\n      .slice(-12); // Last 12 months\n  }\n\n  private calculatePaymentStatus(fees: any[]): { status: string; count: number; amount: number }[] {\n    const statusData: { [key: string]: { count: number; amount: number } } = {};\n\n    fees.forEach(fee => {\n      const status = fee.status;\n      if (!statusData[status]) {\n        statusData[status] = { count: 0, amount: 0 };\n      }\n      statusData[status].count++;\n      statusData[status].amount += parseFloat(fee.amount);\n    });\n\n    return Object.entries(statusData).map(([status, data]) => ({\n      status,\n      count: data.count,\n      amount: data.amount,\n    }));\n  }\n\n  private calculateCategoryBreakdown(transactions: any[]): { category: string; amount: number }[] {\n    const categoryData: { [key: string]: number } = {};\n\n    transactions.forEach(transaction => {\n      const category = transaction.category;\n      categoryData[category] = (categoryData[category] || 0) + parseFloat(transaction.amount);\n    });\n\n    return Object.entries(categoryData).map(([category, amount]) => ({\n      category,\n      amount,\n    }));\n  }\n}\n\nexport const financialService = new FinancialService();\n","size_bytes":2778},"server/services/member.ts":{"content":"import { storage } from \"../storage\";\nimport { type InsertMember, type Member } from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\ninterface CreateMemberData extends Omit<InsertMember, 'tenantId' | 'memberNumber'> {\n  financialSettings: {\n    paymentMethod: 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n    iban?: string;\n    paymentTerm: 'MONTHLY' | 'YEARLY';\n  };\n  organization: {\n    interestedInActiveRole: boolean;\n    roleDescription?: string;\n  };\n  permissions: {\n    privacyAgreement: boolean;\n    photoVideoConsent: boolean;\n    newsletterSubscription: boolean;\n    whatsappList: boolean;\n  };\n}\n\ninterface CreateMemberResult {\n  success: boolean;\n  message?: string;\n  member?: Member;\n}\n\ninterface DuplicateCheckResult {\n  hasDuplicates: boolean;\n  duplicateNumber?: Member;\n  duplicateNameAddress?: Member;\n  suggestedNumber?: string;\n}\n\nclass MemberService {\n  async checkForDuplicates(tenantId: string, memberData: CreateMemberData & { memberNumber?: string }): Promise<DuplicateCheckResult> {\n    const result: DuplicateCheckResult = { hasDuplicates: false };\n\n    console.log(\"🔍 SERVICE - Checking duplicates for tenant:\", tenantId, \"memberNumber:\", memberData.memberNumber);\n\n    // Check for duplicate member number if provided\n    if (memberData.memberNumber) {\n      const existingByNumber = await storage.getMemberByNumber(tenantId, memberData.memberNumber);\n      console.log(\"🔍 SERVICE - Found existing member:\", existingByNumber ? `ID: ${existingByNumber.id}, Number: ${existingByNumber.memberNumber}` : \"NONE\");\n      \n      if (existingByNumber) {\n        result.hasDuplicates = true;\n        result.duplicateNumber = existingByNumber;\n        result.suggestedNumber = await storage.getNextAvailableMemberNumber(tenantId, memberData.memberNumber);\n        console.log(\"🔍 SERVICE - DUPLICATE DETECTED! Suggested number:\", result.suggestedNumber);\n      }\n    }\n\n    // Check for duplicate name and address combination\n    if (memberData.street && memberData.number) {\n      const existingByNameAddress = await storage.getMemberByNameAndAddress(\n        tenantId,\n        memberData.firstName,\n        memberData.lastName,\n        memberData.street,\n        memberData.number\n      );\n      if (existingByNameAddress) {\n        result.hasDuplicates = true;\n        result.duplicateNameAddress = existingByNameAddress;\n      }\n    }\n\n    return result;\n  }\n\n  async createMember(tenantId: string, memberData: CreateMemberData): Promise<CreateMemberResult> {\n    try {\n      // Generate unique member number\n      const memberNumber = await this.generateMemberNumber(tenantId);\n      \n      // Create member (exclude extra frontend fields)\n      const { financialSettings, organization, permissions, ...memberFields } = memberData;\n      const member = await storage.createMember({\n        ...memberFields,\n        tenantId,\n        memberNumber,\n        active: true, // Nieuwe leden zijn standaard actief\n      });\n\n      // Create financial settings if provided\n      if (memberData.financialSettings) {\n        await storage.createMemberFinancialSettings({\n          memberId: member.id,\n          ...memberData.financialSettings,\n        });\n      }\n\n      // Create permissions if provided\n      if (memberData.permissions) {\n        await storage.createMemberPermissions({\n          memberId: member.id,\n          ...memberData.permissions,\n        });\n      }\n\n      // Generate initial membership fee\n      await this.generateInitialFee(member);\n\n      return {\n        success: true,\n        member,\n      };\n    } catch (error) {\n      console.error(\"Error creating member:\", error);\n      return {\n        success: false,\n        message: \"Fout bij het aanmaken van het lid\",\n      };\n    }\n  }\n\n  private async generateMemberNumber(tenantId: string): Promise<string> {\n    const members = await storage.getMembersByTenant(tenantId);\n    \n    // Find the highest existing member number for this tenant\n    let maxNumber = 0;\n    for (const member of members) {\n      const match = member.memberNumber.match(/^(\\d+)$/);\n      if (match) {\n        const num = parseInt(match[1], 10);\n        if (num > maxNumber) {\n          maxNumber = num;\n        }\n      }\n    }\n    \n    // Generate next sequential number\n    const nextNumber = maxNumber + 1;\n    return nextNumber.toString().padStart(4, '0');\n  }\n\n  private async generateInitialFee(member: Member): Promise<void> {\n    try {\n      // Get member's financial settings to determine payment frequency\n      const financialSettings = await storage.getMemberFinancialSettings(member.id);\n      \n      if (!financialSettings) {\n        console.error(`No financial settings found for member ${member.id}`);\n        return;\n      }\n\n      const now = new Date();\n      const periodStart = new Date(now.getFullYear(), now.getMonth(), 1);\n      \n      // Calculate period end based on payment term\n      let periodEnd: Date;\n      if (financialSettings.paymentTerm === 'YEARLY') {\n        // For yearly payments, the period lasts one full year\n        periodEnd = new Date(periodStart);\n        periodEnd.setFullYear(periodEnd.getFullYear() + 1);\n        periodEnd.setDate(periodEnd.getDate() - 1); // Last day of the period\n      } else {\n        // For monthly payments, the period lasts one month\n        periodEnd = new Date(now.getFullYear(), now.getMonth() + 1, 0); // Last day of next month\n      }\n      \n      // Get tenant-specific fee settings\n      const tenant = await storage.getTenantById(member.tenantId);\n      if (!tenant) {\n        console.error(`No tenant found for member ${member.id}`);\n        return;\n      }\n\n      // Get fee amount based on category and payment frequency using tenant settings\n      let yearlyAmount = parseFloat(tenant.adultFee || '25.00'); // Default for STANDAARD\n      if (member.category === 'STUDENT') yearlyAmount = parseFloat(tenant.studentFee || '15.00');\n      if (member.category === 'SENIOR') yearlyAmount = parseFloat(tenant.seniorFee || '20.00');\n      \n      // Calculate amount based on payment term\n      let amount: number;\n      if (financialSettings.paymentTerm === 'YEARLY') {\n        amount = yearlyAmount;\n      } else {\n        // For monthly payments, divide yearly amount by 12\n        amount = yearlyAmount / 12;\n      }\n\n      await storage.createMembershipFee({\n        tenantId: member.tenantId,\n        memberId: member.id,\n        memberNumber: member.memberNumber,\n        memberName: `${member.firstName} ${member.lastName}`,\n        periodStart,\n        periodEnd,\n        amount: amount.toString(),\n        status: 'OPEN',\n      });\n    } catch (error) {\n      console.error('Error generating initial fee for member:', error);\n      throw error;\n    }\n  }\n}\n\nexport const memberService = new MemberService();\n","size_bytes":6793},"client/src/components/command-palette.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport {\n  CommandDialog,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport { \n  LayoutDashboard, \n  Users, \n  CreditCard, \n  BarChart3, \n  Monitor, \n  Settings, \n  Search,\n  User,\n  Euro\n} from \"lucide-react\";\n\ninterface CommandItem {\n  id: string;\n  title: string;\n  description?: string;\n  href: string;\n  icon: React.ComponentType<any>;\n  group: string;\n}\n\nconst commands: CommandItem[] = [\n  {\n    id: \"dashboard\",\n    title: \"Dashboard\",\n    description: \"Overzicht van uw organisatie\",\n    href: \"/dashboard\",\n    icon: LayoutDashboard,\n    group: \"Navigatie\"\n  },\n  {\n    id: \"leden\",\n    title: \"Leden\",\n    description: \"Beheer leden en hun gegevens\",\n    href: \"/leden\",\n    icon: Users,\n    group: \"Navigatie\"\n  },\n  {\n    id: \"lidgelden\",\n    title: \"Lidgelden\",\n    description: \"Beheer lidgelden en betalingen\",\n    href: \"/lidgelden\",\n    icon: CreditCard,\n    group: \"Navigatie\"\n  },\n  {\n    id: \"financien\",\n    title: \"Financiën\",\n    description: \"Overzicht van inkomsten en uitgaven\",\n    href: \"/financien\",\n    icon: BarChart3,\n    group: \"Navigatie\"\n  },\n  {\n    id: \"publieke-schermen\",\n    title: \"Publieke Schermen\",\n    description: \"Beheer publieke displays\",\n    href: \"/publieke-schermen\",\n    icon: Monitor,\n    group: \"Navigatie\"\n  },\n  {\n    id: \"instellingen\",\n    title: \"Instellingen\",\n    description: \"Organisatie en systeem instellingen\",\n    href: \"/instellingen\",\n    icon: Settings,\n    group: \"Navigatie\"\n  },\n  // Quick actions\n  {\n    id: \"nieuwe-lid\",\n    title: \"Nieuw Lid Toevoegen\",\n    description: \"Voeg een nieuw lid toe aan de organisatie\",\n    href: \"/leden?action=new\",\n    icon: User,\n    group: \"Acties\"\n  },\n  {\n    id: \"lidgeld-genereren\",\n    title: \"Lidgeld Genereren\",\n    description: \"Genereer lidgelden voor een periode\",\n    href: \"/lidgelden?action=generate\",\n    icon: Euro,\n    group: \"Acties\"\n  }\n];\n\nexport function CommandPalette() {\n  const [open, setOpen] = useState(false);\n  const [, setLocation] = useLocation();\n\n  useEffect(() => {\n    const down = (e: KeyboardEvent) => {\n      if (e.key === \"k\" && (e.metaKey || e.ctrlKey)) {\n        e.preventDefault();\n        setOpen((open) => !open);\n      }\n    };\n\n    document.addEventListener(\"keydown\", down);\n    return () => document.removeEventListener(\"keydown\", down);\n  }, []);\n\n  const handleSelect = (href: string) => {\n    setOpen(false);\n    setLocation(href);\n  };\n\n  return (\n    <CommandDialog open={open} onOpenChange={setOpen}>\n      <CommandInput placeholder=\"Zoek alles...\" />\n      <CommandList>\n        <CommandEmpty>Geen resultaten gevonden.</CommandEmpty>\n        \n        {[\"Navigatie\", \"Acties\"].map((group) => {\n          const groupCommands = commands.filter(cmd => cmd.group === group);\n          if (groupCommands.length === 0) return null;\n          \n          return (\n            <CommandGroup key={group} heading={group}>\n              {groupCommands.map((command) => {\n                const Icon = command.icon;\n                return (\n                  <CommandItem\n                    key={command.id}\n                    value={`${command.title} ${command.description}`}\n                    onSelect={() => handleSelect(command.href)}\n                    className=\"flex items-center gap-3 cursor-pointer\"\n                  >\n                    <Icon className=\"h-4 w-4 text-muted-foreground\" />\n                    <div className=\"flex flex-col\">\n                      <span className=\"font-medium\">{command.title}</span>\n                      {command.description && (\n                        <span className=\"text-xs text-muted-foreground\">\n                          {command.description}\n                        </span>\n                      )}\n                    </div>\n                  </CommandItem>\n                );\n              })}\n            </CommandGroup>\n          );\n        })}\n      </CommandList>\n    </CommandDialog>\n  );\n}","size_bytes":4061},"client/src/hooks/use-auth.ts":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { type User } from \"@shared/schema\";\n\ninterface AuthState {\n  user: User | null;\n  loading: boolean;\n  login: (email: string, password: string) => Promise<{ success: boolean; message?: string }>;\n  logout: () => void;\n}\n\nexport function useAuth(): AuthState {\n  const [token, setToken] = useState<string | null>(() => {\n    // Check localStorage when initializing\n    if (typeof window !== 'undefined') {\n      return localStorage.getItem(\"authToken\");\n    }\n    return null;\n  });\n  const [hasAuthError, setHasAuthError] = useState(false);\n  const queryClient = useQueryClient();\n\n  const { data: user, isLoading, error } = useQuery({\n    queryKey: [\"/api/auth/me\"],\n    enabled: !!token && !hasAuthError,\n    retry: false,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n    gcTime: 10 * 60 * 1000, // 10 minutes (was cacheTime)\n  });\n\n  // Handle authentication errors by clearing invalid tokens\n  useEffect(() => {\n    if (error && token && !hasAuthError) {\n      console.log(\"Authentication error detected, clearing token\");\n      setHasAuthError(true);\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem(\"authToken\");\n      }\n      setToken(null);\n      queryClient.clear();\n    }\n  }, [error, token, hasAuthError, queryClient]);\n\n  // Reset auth error when token changes (for retry)\n  useEffect(() => {\n    if (token && hasAuthError) {\n      setHasAuthError(false);\n    }\n  }, [token, hasAuthError]);\n\n  const loginMutation = useMutation({\n    mutationFn: async ({ email, password }: { email: string; password: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/auth/login\", { email, password });\n      return response.json();\n    },\n    onSuccess: (data) => {\n      if (typeof window !== 'undefined') {\n        localStorage.setItem(\"authToken\", data.token);\n      }\n      setToken(data.token);\n      setHasAuthError(false);\n      queryClient.setQueryData([\"/api/auth/me\"], data.user);\n    },\n  });\n\n  const logoutMutation = useMutation({\n    mutationFn: () => apiRequest(\"POST\", \"/api/auth/logout\"),\n    onSuccess: () => {\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem(\"authToken\");\n      }\n      setToken(null);\n      setHasAuthError(false);\n      queryClient.clear();\n    },\n  });\n\n\n  const login = async (email: string, password: string) => {\n    try {\n      const result = await loginMutation.mutateAsync({ email, password });\n      \n      // Wacht tot user query geïnvalideerd en opnieuw gefetcht is\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/auth/me\"] });\n      \n      return { success: true };\n    } catch (error: any) {\n      return { success: false, message: error.message || \"Inloggen mislukt. Controleer uw gegevens.\" };\n    }\n  };\n\n  const logout = () => {\n    // Immediate cleanup regardless of API response\n    if (typeof window !== 'undefined') {\n      localStorage.removeItem(\"authToken\");\n    }\n    setToken(null);\n    setHasAuthError(false);\n    queryClient.clear();\n    \n    // Also try the API logout but don't wait for it\n    logoutMutation.mutate();\n    \n    // Force redirect to login\n    if (typeof window !== 'undefined') {\n      window.location.href = \"/login\";\n    }\n  };\n\n  return {\n    user: (user as any)?.user || null,\n    loading: isLoading,\n    login,\n    logout,\n  };\n}\n","size_bytes":3548},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/lib/auth.ts":{"content":"import { type User } from \"@shared/schema\";\n\nexport interface AuthUser extends Omit<User, 'passwordHash'> {}\n\nexport function getAuthToken(): string | null {\n  return localStorage.getItem(\"authToken\");\n}\n\nexport function setAuthToken(token: string): void {\n  localStorage.setItem(\"authToken\", token);\n}\n\nexport function removeAuthToken(): void {\n  localStorage.removeItem(\"authToken\");\n}\n\nexport function getUserInitials(name: string | undefined): string {\n  if (!name || typeof name !== 'string') {\n    return 'US'; // Default voor User\n  }\n  \n  return name\n    .split(\" \")\n    .map(part => part.charAt(0))\n    .join(\"\")\n    .toUpperCase()\n    .slice(0, 2);\n}\n","size_bytes":661},"client/src/lib/format.ts":{"content":"import { format, parseISO, isValid } from 'date-fns';\nimport { nl } from 'date-fns/locale';\n\n/**\n * Format a date to Belgian format (dd-mm-jjjj)\n */\nexport function formatDateBE(date: string | Date | null | undefined): string {\n  if (!date) return '-';\n  try {\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\n    if (!dateObj || !isValid(dateObj)) return '-';\n    return format(dateObj, 'dd-MM-yyyy', { locale: nl });\n  } catch {\n    return '-';\n  }\n}\n\n/**\n * Format a date to Belgian short format (dd-mm)\n */\nexport function formatDateShortBE(date: string | Date | null | undefined): string {\n  if (!date) return '-';\n  try {\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\n    if (!dateObj || !isValid(dateObj)) return '-';\n    return format(dateObj, 'dd-MM', { locale: nl });\n  } catch {\n    return '-';\n  }\n}\n\n/**\n * Format a date to month year format (januari 2025)\n */\nexport function formatMonthYearBE(date: string | Date | null | undefined): string {\n  if (!date) return '-';\n  try {\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\n    if (!dateObj || !isValid(dateObj)) return '-';\n    return format(dateObj, 'MMMM yyyy', { locale: nl });\n  } catch {\n    return '-';\n  }\n}\n\n/**\n * Format currency to Belgian format (€ 1.234,56)\n */\nexport function formatCurrencyBE(amount: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    style: 'currency',\n    currency: 'EUR',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\n/**\n * Format currency without symbol (1.234,56)\n */\nexport function formatAmountBE(amount: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\n/**\n * Parse Belgian date format (dd-mm-jjjj) to ISO string\n */\nexport function parseDateBE(dateString: string): string {\n  const [day, month, year] = dateString.split('-');\n  return new Date(`${year}-${month}-${day}`).toISOString().split('T')[0];\n}\n\n/**\n * Get relative time in Dutch\n */\nexport function getRelativeTimeBE(date: string | Date | null | undefined): string {\n  if (!date) return '-';\n  try {\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\n    if (!dateObj || !isValid(dateObj)) return '-';\n    const now = new Date();\n    const diffInDays = Math.floor((now.getTime() - dateObj.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (diffInDays === 0) return 'Vandaag';\n    if (diffInDays === 1) return 'Gisteren';\n    if (diffInDays < 7) return `${diffInDays} dagen geleden`;\n    if (diffInDays < 30) return `${Math.floor(diffInDays / 7)} weken geleden`;\n    if (diffInDays < 365) return `${Math.floor(diffInDays / 30)} maanden geleden`;\n    return `${Math.floor(diffInDays / 365)} jaar geleden`;\n  } catch {\n    return '-';\n  }\n}\n\n// Legacy exports for backward compatibility\nexport const formatDate = formatDateBE;\nexport const formatCurrency = formatCurrencyBE;\nexport const formatDateTime = (date: string | Date | null | undefined): string => {\n  if (!date) return '-';\n  try {\n    const dateObj = typeof date === 'string' ? parseISO(date) : date;\n    if (!dateObj || !isValid(dateObj)) return '-';\n    return format(dateObj, 'dd-MM-yyyy HH:mm', { locale: nl });\n  } catch {\n    return '-';\n  }\n};\n\n// Additional helper functions\nexport function getMemberCategoryLabel(category: string): string {\n  const labels: Record<string, string> = {\n    'STANDAARD': 'Standaard',\n    'KIND': 'Kind',\n    'STUDENT': 'Student',\n    'SENIOR': 'Senior',\n    'GEZIN': 'Gezin'\n  };\n  return labels[category] || category;\n}\n\n/**\n * Format percentage (0.15 -> 15%)\n */\nexport function formatPercentage(value: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    style: 'percent',\n    minimumFractionDigits: 0,\n    maximumFractionDigits: 1,\n  }).format(value);\n}\n\n/**\n * Format period range (start date - end date)\n */\nexport function formatPeriodBE(startDate: string | Date | null | undefined, endDate: string | Date | null | undefined): string {\n  const start = formatDateBE(startDate);\n  const end = formatDateBE(endDate);\n  return `${start} - ${end}`;\n}","size_bytes":4158},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    \n    // Try to parse JSON response and extract message\n    try {\n      const errorData = JSON.parse(text);\n      throw new Error(errorData.message || text);\n    } catch {\n      // If not valid JSON, use the original text\n      throw new Error(text);\n    }\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const headers: Record<string, string> = data ? { \"Content-Type\": \"application/json\" } : {};\n  \n  // Add authorization header if token exists\n  const token = typeof window !== 'undefined' ? localStorage.getItem(\"authToken\") : null;\n  if (token) {\n    headers.Authorization = `Bearer ${token}`;\n  }\n\n  const res = await fetch(url, {\n    method,\n    headers,\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const headers: Record<string, string> = {};\n    \n    // Add authorization header if token exists\n    const token = typeof window !== 'undefined' ? localStorage.getItem(\"authToken\") : null;\n    if (token) {\n      headers.Authorization = `Bearer ${token}`;\n    }\n\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      headers,\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: 1000 * 10, // 10 seconds - shorter for faster updates\n      gcTime: 1000 * 60 * 10, // 10 minutes in cache\n      retry: 2, // Two retries for better reliability\n      retryDelay: attemptIndex => Math.min(1000 * 2 ** attemptIndex, 3000), // Faster retry\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":2348},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/dashboard.tsx":{"content":"import ModernKpiCards from \"@/components/dashboard/modern-kpi-cards\";\nimport RevenueChart from \"@/components/dashboard/revenue-chart\";\nimport PaymentStatusChart from \"@/components/dashboard/payment-status-chart\";\nimport RevenueByCategoryChart from \"@/components/dashboard/revenue-by-category\";\nimport MembersByCategoryChart from \"@/components/dashboard/members-by-category\";\nimport AgeGenderChart from \"@/components/dashboard/age-gender-chart\";\nimport RecentActivities from \"@/components/dashboard/recent-activities\";\nimport DueDates from \"@/components/dashboard/due-dates\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function Dashboard() {\n  return (\n        <main className=\"flex-1 py-4\">\n          <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n            {/* Page Header */}\n            <div className=\"border-b border-gray-200 pb-5 mb-6\">\n              <div>\n                <h1 className=\"text-3xl font-bold text-gray-900 tracking-tight\" data-testid=\"page-title\">Dashboard</h1>\n                <p className=\"mt-2 text-sm text-gray-600 font-medium\">Overzicht van jouw moskee ledenbeheer</p>\n              </div>\n            </div>\n\n            {/* KPI Cards - 6 kaarten in een grid */}\n            <ModernKpiCards />\n\n            {/* Charts Row 1 */}\n            <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6\">\n              <RevenueChart />\n              <PaymentStatusChart />\n            </div>\n\n            {/* Revenue by Category - Full width */}\n            <div className=\"mb-6\">\n              <RevenueByCategoryChart />\n            </div>\n\n            {/* Charts Row 2 */}\n            <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-6 mb-6\">\n              <div className=\"xl:col-span-2\">\n                <MembersByCategoryChart />\n              </div>\n              <AgeGenderChart />\n            </div>\n\n            {/* Bottom Row */}\n            <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-6\">\n              <DueDates />\n              <RecentActivities />\n            </div>\n          </div>\n        </main>\n  );\n}","size_bytes":2149},"client/src/pages/financien.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { BarChart3, TrendingUp, Download, Search, Plus, Euro, ArrowUpRight, ArrowDownRight, CreditCard } from \"lucide-react\";\nimport { formatCurrency, formatDate, formatDateTime } from \"@/lib/format\";\nimport { useState } from \"react\";\nimport { FiltersToolbar } from \"@/components/finance/FiltersDrawer\";\nimport { FilterData } from \"@/lib/zod/transaction\";\n\nexport default function Financien() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [filters, setFilters] = useState<FilterData>({\n    category: undefined,\n    method: \"ALL\",\n    memberId: undefined,\n    dateFrom: undefined,\n    dateTo: undefined,\n    amountMin: undefined,\n    amountMax: undefined\n  });\n\n  const { data: transactions, isLoading: transactionsLoading } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n\n  const { data: fees } = useQuery({\n    queryKey: [\"/api/fees\"],\n  });\n\n  const { data: reports } = useQuery({\n    queryKey: [\"/api/financial/reports\"],\n  });\n\n  const calculateFinancialStats = () => {\n    const income = Array.isArray(transactions) ? transactions.filter((t: any) => t.type === 'INCOME').reduce((sum: number, t: any) => sum + Math.abs(parseFloat(t.amount)), 0) : 0;\n    const expenses = Array.isArray(transactions) ? transactions.filter((t: any) => t.type === 'EXPENSE').reduce((sum: number, t: any) => sum + Math.abs(parseFloat(t.amount)), 0) : 0;\n    const balance = income - expenses;\n    const openFees = Array.isArray(fees) ? fees.filter((f: any) => f.status === 'OPEN').reduce((sum: number, f: any) => sum + parseFloat(f.amount), 0) : 0;\n\n    return { income, expenses, balance, openFees };\n  };\n\n  const stats = calculateFinancialStats();\n\n  const filteredTransactions = transactions?.filter((transaction: any) => {\n    // Search term filter\n    const matchesSearch = !searchTerm || \n      transaction.description?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      transaction.category.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    // Category filter\n    const matchesCategory = !filters.category || transaction.category === filters.category;\n    \n    // Method filter\n    const matchesMethod = filters.method === \"ALL\" || transaction.method === filters.method;\n    \n    // Member filter\n    const matchesMember = !filters.memberId || transaction.memberId === filters.memberId;\n    \n    // Date range filter\n    const transactionDate = new Date(transaction.date);\n    const matchesDateFrom = !filters.dateFrom || transactionDate >= new Date(filters.dateFrom);\n    const matchesDateTo = !filters.dateTo || transactionDate <= new Date(filters.dateTo);\n    \n    // Amount range filter\n    const amount = Math.abs(parseFloat(transaction.amount));\n    const matchesAmountMin = filters.amountMin === undefined || amount >= filters.amountMin;\n    const matchesAmountMax = filters.amountMax === undefined || amount <= filters.amountMax;\n    \n    return matchesSearch && matchesCategory && matchesMethod && matchesMember &&\n           matchesDateFrom && matchesDateTo && matchesAmountMin && matchesAmountMax;\n  }) || [];\n\n  const handleClearFilters = () => {\n    setFilters({\n      category: undefined,\n      method: \"ALL\",\n      memberId: undefined,\n      dateFrom: undefined,\n      dateTo: undefined,\n      amountMin: undefined,\n      amountMax: undefined\n    });\n  };\n\n  if (transactionsLoading) {\n    return (\n          <main className=\"flex-1 py-8\">\n            <div className=\"px-4 sm:px-6 lg:px-8\">\n              <div className=\"animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-1/4\"></div>\n                <div className=\"h-32 bg-gray-200 rounded\"></div>\n                <div className=\"h-64 bg-gray-200 rounded\"></div>\n              </div>\n            </div>\n          </main>\n    );\n  }\n\n  return (\n        <main className=\"flex-1 py-8\">\n          <div className=\"px-4 sm:px-6 lg:px-8\">\n            {/* Page Header */}\n            <div className=\"mb-6\">\n              <div>\n                <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Financiën</h1>\n                <p className=\"mt-2 text-sm text-gray-600 font-medium\">Financieel overzicht en transactiebeheer</p>\n              </div>\n            </div>\n\n            {/* Financial Stats Cards */}\n            <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n              <Card>\n                <CardContent className=\"px-6 py-6\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-green-100 rounded-xl flex items-center justify-center\">\n                        <ArrowUpRight className=\"h-5 w-5 text-green-600\" />\n                      </div>\n                    </div>\n                    <div className=\"ml-4 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Totale Inkomsten</dt>\n                        <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"total-income\">\n                          {formatCurrency(stats.income)}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"flex items-center text-sm text-green-600\">\n                      <TrendingUp className=\"h-4 w-4 mr-1\" />\n                      +8% deze maand\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"px-6 py-6\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-red-100 rounded-xl flex items-center justify-center\">\n                        <ArrowDownRight className=\"h-5 w-5 text-red-600\" />\n                      </div>\n                    </div>\n                    <div className=\"ml-4 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Totale Uitgaven</dt>\n                        <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"total-expenses\">\n                          {formatCurrency(stats.expenses)}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"text-sm text-gray-500\">\n                      Operationele kosten\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"px-6 py-6\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-blue-100 rounded-xl flex items-center justify-center\">\n                        <Euro className=\"h-5 w-5 text-blue-600\" />\n                      </div>\n                    </div>\n                    <div className=\"ml-4 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Netto Saldo</dt>\n                        <dd className={`text-2xl font-bold ${stats.balance >= 0 ? 'text-green-600' : 'text-red-600'}`} data-testid=\"net-balance\">\n                          {formatCurrency(stats.balance)}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"text-sm text-gray-500\">\n                      Inkomsten - Uitgaven\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"px-6 py-6\">\n                  <div className=\"flex items-center\">\n                    <div className=\"flex-shrink-0\">\n                      <div className=\"w-8 h-8 bg-orange-100 rounded-xl flex items-center justify-center\">\n                        <BarChart3 className=\"h-5 w-5 text-orange-600\" />\n                      </div>\n                    </div>\n                    <div className=\"ml-4 w-0 flex-1\">\n                      <dl>\n                        <dt className=\"text-sm font-medium text-gray-500 truncate\">Openstaande Lidgelden</dt>\n                        <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"outstanding-fees\">\n                          {formatCurrency(stats.openFees)}\n                        </dd>\n                      </dl>\n                    </div>\n                  </div>\n                  <div className=\"mt-4\">\n                    <div className=\"text-sm text-orange-600\">\n                      Te innen bedrag\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Tabs defaultValue=\"transactions\" className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-3\">\n                <TabsTrigger value=\"transactions\" data-testid=\"tab-transactions\">Transacties</TabsTrigger>\n                <TabsTrigger value=\"reports\" data-testid=\"tab-reports\">Rapportages</TabsTrigger>\n                <TabsTrigger value=\"sepa\" data-testid=\"tab-sepa\">SEPA Export</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"transactions\" className=\"space-y-6\">\n                {/* Search */}\n                <Card>\n                  <CardContent className=\"px-6 py-4\">\n                    <div className=\"flex flex-col sm:flex-row gap-4\">\n                      <div className=\"relative flex-1\">\n                        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                        <Input\n                          placeholder=\"Zoek op beschrijving of categorie...\"\n                          value={searchTerm}\n                          onChange={(e) => setSearchTerm(e.target.value)}\n                          className=\"pl-10\"\n                          data-testid=\"search-transactions\"\n                        />\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button variant=\"outline\" size=\"sm\" data-testid=\"export-transactions\">\n                          <Download className=\"h-4 w-4 mr-2\" />\n                          Export\n                        </Button>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Transactions Table */}\n                <Card>\n                  <CardHeader className=\"px-6 py-6 border-b border-gray-200\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <CardTitle>Transactie Overzicht</CardTitle>\n                        <p className=\"text-sm text-gray-500\">{filteredTransactions.length} transacties gevonden</p>\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-4\">\n                      <FiltersToolbar\n                        filters={filters}\n                        onFiltersChange={setFilters}\n                        onClearFilters={handleClearFilters}\n                      />\n                    </div>\n                  </CardHeader>\n                  \n                  <CardContent className=\"p-0\">\n                    {filteredTransactions.length === 0 ? (\n                      <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\" data-testid=\"no-transactions\">\n                        <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n                          <CreditCard className=\"w-8 h-8 text-gray-400\" />\n                        </div>\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n                          {searchTerm ? 'Geen transacties gevonden' : 'Nog geen transacties toegevoegd'}\n                        </h3>\n                        <p className=\"text-gray-500 dark:text-gray-400 max-w-sm\">\n                          {searchTerm ? 'Probeer je zoekcriteria aan te passen' : 'Transacties worden hier weergegeven wanneer ze worden toegevoegd.'}\n                        </p>\n                      </div>\n                    ) : (\n                      <div className=\"overflow-hidden\">\n                        <table className=\"min-w-full divide-y divide-gray-200\">\n                          <thead className=\"bg-gray-50\">\n                            <tr>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Datum</th>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Type</th>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Categorie</th>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Beschrijving</th>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Bedrag</th>\n                              <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Methode</th>\n                            </tr>\n                          </thead>\n                          <tbody className=\"bg-white divide-y divide-gray-200\">\n                            {filteredTransactions.map((transaction: any) => (\n                              <tr key={transaction.id} className=\"hover:bg-gray-50\" data-testid={`transaction-row-${transaction.id}`}>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\" data-testid={`transaction-date-${transaction.id}`}>\n                                  {formatDate(transaction.date)}\n                                </td>\n                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                  <Badge \n                                    variant={transaction.type === 'INCOME' ? 'default' : 'destructive'}\n                                    className={transaction.type === 'INCOME' ? 'bg-green-100 text-green-800 hover:bg-green-100' : 'bg-red-100 text-red-800 hover:bg-red-100'}\n                                    data-testid={`transaction-type-${transaction.id}`}\n                                  >\n                                    <div className=\"flex items-center\">\n                                      {transaction.type === 'INCOME' ? (\n                                        <ArrowUpRight className=\"h-3 w-3 mr-1\" />\n                                      ) : (\n                                        <ArrowDownRight className=\"h-3 w-3 mr-1\" />\n                                      )}\n                                      {transaction.type === 'INCOME' ? 'Inkomst' : 'Uitgave'}\n                                    </div>\n                                  </Badge>\n                                </td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\" data-testid={`transaction-category-${transaction.id}`}>\n                                  {transaction.category}\n                                </td>\n                                <td className=\"px-6 py-4 text-sm text-gray-900\" data-testid={`transaction-description-${transaction.id}`}>\n                                  {transaction.description || 'Geen beschrijving'}\n                                </td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\" data-testid={`transaction-amount-${transaction.id}`}>\n                                  <span className={transaction.type === 'INCOME' ? 'text-green-600' : 'text-red-600'}>\n                                    {transaction.type === 'INCOME' ? '+' : '-'}{formatCurrency(transaction.amount)}\n                                  </span>\n                                </td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\" data-testid={`transaction-method-${transaction.id}`}>\n                                  {transaction.method || 'Niet opgegeven'}\n                                </td>\n                              </tr>\n                            ))}\n                          </tbody>\n                        </table>\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"reports\" className=\"space-y-6\">\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                  {/* Revenue Chart */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>Maandelijkse Inkomsten</CardTitle>\n                      <p className=\"text-sm text-gray-500\">Ontwikkeling over de laatste 12 maanden</p>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"h-64 bg-gray-50 rounded-xl flex items-center justify-center text-gray-500 text-sm\" data-testid=\"revenue-chart\">\n                        Grafiek: Maandelijkse inkomsten ontwikkeling\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  {/* Category Breakdown */}\n                  <Card>\n                    <CardHeader>\n                      <CardTitle>Uitgaven per Categorie</CardTitle>\n                      <p className=\"text-sm text-gray-500\">Verdeling van uitgaven</p>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"h-64 bg-gray-50 rounded-xl flex items-center justify-center text-gray-500 text-sm\" data-testid=\"category-chart\">\n                        Grafiek: Uitgaven verdeling per categorie\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Financial Summary */}\n                <Card>\n                  <CardHeader>\n                    <CardTitle>Financiële Samenvatting</CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                      <div className=\"text-center\">\n                        <div className=\"text-3xl font-bold text-green-600\">{formatCurrency(stats.income)}</div>\n                        <div className=\"text-sm text-gray-500\">Totale Inkomsten</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className=\"text-3xl font-bold text-red-600\">{formatCurrency(stats.expenses)}</div>\n                        <div className=\"text-sm text-gray-500\">Totale Uitgaven</div>\n                      </div>\n                      <div className=\"text-center\">\n                        <div className={`text-3xl font-bold ${stats.balance >= 0 ? 'text-green-600' : 'text-red-600'}`}>\n                          {formatCurrency(stats.balance)}\n                        </div>\n                        <div className=\"text-sm text-gray-500\">Netto Resultaat</div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"sepa\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader>\n                    <CardTitle>SEPA Export Beheer</CardTitle>\n                    <p className=\"text-sm text-gray-500\">Genereer SEPA betalingsbestanden voor automatische incasso</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-6\">\n                      <div className=\"bg-blue-50 rounded-xl p-6\">\n                        <h4 className=\"font-semibold text-blue-900 mb-2\">SEPA Batch Genereren</h4>\n                        <p className=\"text-sm text-blue-700 mb-4\">\n                          Selecteer openstaande lidgelden met SEPA betaalmethode om een betalingsbatch te genereren.\n                        </p>\n                        <Button data-testid=\"generate-sepa\">\n                          Nieuwe SEPA Batch Genereren\n                        </Button>\n                      </div>\n\n                      <div>\n                        <h4 className=\"font-semibold text-gray-900 mb-4\">Recente SEPA Exports</h4>\n                        <div className=\"space-y-3\">\n                          <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-xl\">\n                            <div>\n                              <div className=\"font-medium\">SEPA-2025-001</div>\n                              <div className=\"text-sm text-gray-500\">15 transacties • €375.00</div>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              <Badge className=\"bg-green-100 text-green-800\">Gegenereerd</Badge>\n                              <Button variant=\"outline\" size=\"sm\">\n                                <Download className=\"h-4 w-4 mr-2\" />\n                                Download\n                              </Button>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </div>\n        </main>\n  );\n}\n","size_bytes":22376},"client/src/pages/instellingen.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { \n  Settings, \n  Building2, \n  CreditCard, \n  Shield, \n  Scale, \n  Users, \n  Plus, \n  MoreVertical,\n  Upload,\n  Save,\n  Eye,\n  Trash2,\n  Edit,\n  KeyRound,\n  Copy,\n  Smartphone\n} from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { formatCurrency, formatDate } from \"@/lib/format\";\nimport { RiAdminLine } from \"react-icons/ri\";\nimport { PWAManager } from \"@/components/pwa/pwa-manager\";\n\n// Schemas for form validation\nconst organizationSchema = z.object({\n  name: z.string().min(1, \"Organisatienaam is verplicht\"),\n  slug: z.string().min(1, \"URL slug is verplicht\"),\n  street: z.string().optional(),\n  number: z.string().optional(),\n  postalCode: z.string().optional(),\n  city: z.string().optional(),\n  country: z.string().optional(),\n  email: z.string()\n    .optional()\n    .or(z.literal(\"\"))\n    .refine((email) => {\n      if (!email || email === \"\") return true;\n      // Strikte email validatie\n      const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n      return emailRegex.test(email);\n    }, \"Ongeldig e-mailadres format\"),\n  phone: z.string()\n    .optional()\n    .refine((phone) => {\n      if (!phone || phone === \"\") return true;\n      // Belgisch/Nederlands telefoonnummer validatie\n      const phoneRegex = /^(\\+32|0032|0)[1-9]\\d{7,8}$|^(\\+31|0031|0)[1-9]\\d{7,8}$/;\n      // Ook accept internationale formaten\n      const internationalRegex = /^\\+[1-9]\\d{1,14}$/;\n      const cleanPhone = phone.replace(/[\\s\\-\\(\\)]/g, '');\n      return phoneRegex.test(cleanPhone) || internationalRegex.test(cleanPhone);\n    }, \"Ongeldig telefoonnummer format (Belgisch/Nederlands of internationaal format verwacht)\"),\n  website: z.string()\n    .optional()\n    .or(z.literal(\"\"))\n    .refine((website) => {\n      if (!website || website === \"\") return true;\n      // Website URL validatie\n      try {\n        new URL(website);\n        return true;\n      } catch {\n        return false;\n      }\n    }, \"Ongeldige website URL\"),\n  companyNumber: z.string().optional(),\n  companyType: z.enum(['VZW', 'BVBA', 'NV', 'VOF', 'EENMANSZAAK', 'CVBA', 'SE', 'ANDERE']).optional(),\n  logoUrl: z.string().optional(),\n  primaryColor: z.string().optional(),\n});\n\nconst membershipFeeSchema = z.object({\n  studentFee: z.string().min(1, \"Studentenbijdrage is verplicht\"),\n  adultFee: z.string().min(1, \"Standaardbijdrage is verplicht\"),\n  seniorFee: z.string().min(1, \"Seniorenbijdrage is verplicht\"),\n  defaultPaymentTerm: z.enum(['MONTHLY', 'YEARLY']),\n  defaultPaymentMethod: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']),\n});\n\nconst userSchema = z.object({\n  name: z.string().min(1, \"Naam is verplicht\"),\n  email: z.string().refine((email) => {\n    // Strikte email validatie\n    const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n    return emailRegex.test(email);\n  }, \"Ongeldig e-mailadres format\"),\n  role: z.enum(['BEHEERDER', 'MEDEWERKER']),\n  password: z.string()\n    .optional()\n    .refine((password) => {\n      if (!password || password === \"\") return true; // Optional field\n      return password.length >= 8; // Stronger password requirement\n    }, \"Wachtwoord moet minstens 8 karakters zijn\")\n    .refine((password) => {\n      if (!password || password === \"\") return true;\n      // At least one uppercase, one lowercase, and one number\n      const strongPasswordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).+$/;\n      return strongPasswordRegex.test(password);\n    }, \"Wachtwoord moet minstens één hoofdletter, één kleine letter en één cijfer bevatten\"),\n});\n\nconst ruleSchema = z.object({\n  name: z.string().min(1, \"Regelnaam is verplicht\"),\n  description: z.string().optional(),\n  scope: z.enum(['STEMRECHT', 'VERKIESBAAR']),\n  minAge: z.string().optional(),\n  minYears: z.string().optional(),\n  minPayments: z.string().optional(),\n  consecutive: z.boolean().default(false),\n  categories: z.array(z.string()).default([]),\n});\n\ntype OrganizationFormData = z.infer<typeof organizationSchema>;\ntype MembershipFeeFormData = z.infer<typeof membershipFeeSchema>;\ntype UserFormData = z.infer<typeof userSchema>;\ntype RuleFormData = z.infer<typeof ruleSchema>;\n\nexport default function Instellingen() {\n  const [activeTab, setActiveTab] = useState(\"organization\");\n  const [showNewUserDialog, setShowNewUserDialog] = useState(false);\n  const [showEditUserDialog, setShowEditUserDialog] = useState(false);\n  const [editingUser, setEditingUser] = useState<any>(null);\n  const [showNewRuleDialog, setShowNewRuleDialog] = useState(false);\n  const [showEditRuleDialog, setShowEditRuleDialog] = useState(false);\n  const [editingRule, setEditingRule] = useState<any>(null);\n  const [organizationSaved, setOrganizationSaved] = useState(false);\n  const [feesSaved, setFeesSaved] = useState(false);\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Queries\n  const { data: tenant, isLoading: tenantLoading, isFetching: tenantFetching } = useQuery({\n    queryKey: [\"/api/tenant/current\"],\n    staleTime: 30000, // 30 seconds for tenant data\n  });\n\n  const { data: users } = useQuery({\n    queryKey: [\"/api/users\"],\n  });\n\n  const { data: rules } = useQuery({\n    queryKey: [\"/api/rules\"],\n  });\n\n  // Forms\n  const organizationForm = useForm<OrganizationFormData>({\n    resolver: zodResolver(organizationSchema),\n    defaultValues: {\n      name: \"\",\n      slug: \"\",\n      street: \"\",\n      number: \"\",\n      postalCode: \"\",\n      city: \"\",\n      country: \"België\",\n      email: \"\",\n      phone: \"\",\n      website: \"\",\n      companyNumber: \"\",\n      companyType: undefined,\n      logoUrl: \"\",\n      primaryColor: \"#6366f1\",\n    },\n  });\n\n\n  const feeForm = useForm<MembershipFeeFormData>({\n    resolver: zodResolver(membershipFeeSchema),\n    defaultValues: {\n      studentFee: \"15.00\",\n      adultFee: \"25.00\",\n      seniorFee: \"20.00\",\n      defaultPaymentTerm: \"YEARLY\",\n      defaultPaymentMethod: \"SEPA\",\n    },\n  });\n\n  // Watch for form changes to enable/disable save buttons\n  const organizationFormValues = organizationForm.watch();\n  const feeFormValues = feeForm.watch();\n\n  // Reset organization saved state when form changes\n  useEffect(() => {\n    if (organizationSaved) {\n      setOrganizationSaved(false);\n    }\n  }, [organizationFormValues]);\n\n  // Reset fees saved state when form changes\n  useEffect(() => {\n    if (feesSaved) {\n      setFeesSaved(false);\n    }\n  }, [feeFormValues]);\n\n  // Initialize form with tenant data when available\n  useEffect(() => {\n    if (tenant && typeof tenant === 'object' && 'name' in tenant) {\n      const tenantData = tenant as any;\n      organizationForm.reset({\n        name: tenantData.name || \"\",\n        slug: tenantData.slug || \"\",\n        street: tenantData.street || \"\",\n        number: tenantData.number || \"\",\n        postalCode: tenantData.postalCode || \"\",\n        city: tenantData.city || \"\",\n        country: tenantData.country || \"België\",\n        email: tenantData.email || \"\",\n        phone: tenantData.phone || \"\",\n        website: tenantData.website || \"\",\n        companyNumber: tenantData.companyNumber || \"\",\n        companyType: tenantData.companyType || undefined,\n        logoUrl: tenantData.logoUrl || \"\",\n        primaryColor: tenantData.primaryColor || \"#6366f1\",\n      });\n      \n      // Initialize fee form with tenant data\n      const feeFormData = {\n        studentFee: tenantData.studentFee || \"15.00\",\n        adultFee: tenantData.adultFee || \"25.00\",\n        seniorFee: tenantData.seniorFee || \"20.00\",\n        defaultPaymentTerm: tenantData.defaultPaymentTerm || \"YEARLY\",\n        defaultPaymentMethod: tenantData.defaultPaymentMethod || \"SEPA\",\n      };\n      \n      feeForm.reset(feeFormData);\n      \n      setOrganizationSaved(false);\n      setFeesSaved(false);\n    }\n  }, [tenant]);\n\n  const userForm = useForm<UserFormData>({\n    resolver: zodResolver(userSchema),\n    defaultValues: {\n      role: \"MEDEWERKER\",\n    },\n  });\n\n  const editUserForm = useForm<UserFormData>({\n    resolver: zodResolver(userSchema.extend({\n      password: z.string().optional(), // Password optional for editing\n    })),\n  });\n\n  const ruleForm = useForm<RuleFormData>({\n    resolver: zodResolver(ruleSchema),\n    defaultValues: {\n      scope: \"STEMRECHT\",\n      consecutive: false,\n      categories: [],\n    },\n  });\n\n  const editRuleForm = useForm<RuleFormData>({\n    resolver: zodResolver(ruleSchema),\n    defaultValues: {\n      scope: \"STEMRECHT\",\n      consecutive: false,\n      categories: [],\n    },\n  });\n\n  // Mutations\n  const updateOrganizationMutation = useMutation({\n    mutationFn: async (data: OrganizationFormData) => {\n      const response = await apiRequest(\"PUT\", \"/api/tenant/current\", data);\n      return response.json();\n    },\n    onSuccess: async (result, variables) => {\n      // Optimistic update - update cache immediately\n      queryClient.setQueryData([\"/api/tenant/current\"], (oldData: any) => {\n        if (!oldData) return oldData;\n        return { ...oldData, ...variables };\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/tenant/current\"] });\n      setOrganizationSaved(true);\n      toast({\n        title: \"Organisatie bijgewerkt\",\n        description: \"De organisatie-instellingen zijn succesvol bijgewerkt.\",\n      });\n    },\n  });\n\n  const updateFeeSettingsMutation = useMutation({\n    mutationFn: async (data: MembershipFeeFormData) => {\n      const response = await apiRequest(\"PUT\", \"/api/settings/fees\", data);\n      return response.json();\n    },\n    onSuccess: async (result, variables) => {\n      // Optimistic update - update cache immediately met nieuwe data\n      queryClient.setQueryData([\"/api/tenant/current\"], (oldData: any) => {\n        if (!oldData) return oldData;\n        return {\n          ...oldData,\n          studentFee: variables.studentFee,\n          adultFee: variables.adultFee,\n          seniorFee: variables.seniorFee,\n          defaultPaymentTerm: variables.defaultPaymentTerm,\n          defaultPaymentMethod: variables.defaultPaymentMethod,\n        };\n      });\n      \n      // Nog steeds invalideren voor zekerheid\n      await queryClient.invalidateQueries({ queryKey: [\"/api/tenant/current\"] });\n      \n      setFeesSaved(true);\n      toast({\n        title: \"Lidgeld instellingen bijgewerkt\",\n        description: \"De standaard lidgeld instellingen zijn opgeslagen.\",\n      });\n    },\n  });\n\n  const createUserMutation = useMutation({\n    mutationFn: async (data: UserFormData) => {\n      const response = await apiRequest(\"POST\", \"/api/users\", data);\n      return response.json();\n    },\n    onSuccess: async (newUser) => {\n      // Optimistic update - add new user to list immediately\n      queryClient.setQueryData([\"/api/users\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return [newUser];\n        return [newUser, ...oldData];\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      setShowNewUserDialog(false);\n      userForm.reset();\n      toast({\n        title: \"Gebruiker toegevoegd\",\n        description: \"De nieuwe gebruiker is succesvol aangemaakt.\",\n      });\n    },\n  });\n\n  const editUserMutation = useMutation({\n    mutationFn: async (data: UserFormData) => {\n      const response = await apiRequest(\"PUT\", `/api/users/${editingUser.id}`, data);\n      return response.json();\n    },\n    onSuccess: async (updatedUser) => {\n      // Optimistic update - update user in list immediately\n      queryClient.setQueryData([\"/api/users\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.map((user: any) => \n          user.id === editingUser.id ? { ...user, ...updatedUser } : user\n        );\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      setShowEditUserDialog(false);\n      setEditingUser(null);\n      editUserForm.reset();\n      toast({\n        title: \"Gebruiker bijgewerkt\",\n        description: \"De gebruikersgegevens zijn succesvol bijgewerkt.\",\n      });\n    },\n  });\n\n  const deleteUserMutation = useMutation({\n    mutationFn: async (userId: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/users/${userId}`, {});\n      return response.json();\n    },\n    onSuccess: async (result, userId) => {\n      // Optimistic update - remove user from list immediately\n      queryClient.setQueryData([\"/api/users\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.filter((user: any) => user.id !== userId);\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n      toast({\n        title: \"Gebruiker verwijderd\",\n        description: \"De gebruiker is succesvol verwijderd.\",\n      });\n    },\n  });\n\n  const createRuleMutation = useMutation({\n    mutationFn: async (data: RuleFormData) => {\n      const ruleData = {\n        ...data,\n        parameters: {\n          minYears: data.minYears ? parseInt(data.minYears) : undefined,\n          minPayments: data.minPayments ? parseInt(data.minPayments) : undefined,\n          consecutive: data.consecutive,\n          categories: data.categories,\n        },\n      };\n      const response = await apiRequest(\"POST\", \"/api/rules\", ruleData);\n      return response.json();\n    },\n    onSuccess: async (newRule) => {\n      // Optimistic update - add new rule to list immediately\n      queryClient.setQueryData([\"/api/rules\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return [newRule];\n        return [newRule, ...oldData];\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/rules\"] });\n      setShowNewRuleDialog(false);\n      ruleForm.reset();\n      toast({\n        title: \"Regel toegevoegd\",\n        description: \"De nieuwe organisatieregel is aangemaakt.\",\n      });\n    },\n  });\n\n  const updateRuleMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      const response = await apiRequest(\"PUT\", `/api/rules/${id}`, data);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/rules\"] });\n      toast({ title: \"Regel bijgewerkt\", description: \"De regel is succesvol bijgewerkt.\" });\n      setShowEditRuleDialog(false);\n    },\n    onError: () => {\n      toast({ title: \"Fout\", description: \"Er is een fout opgetreden.\", variant: \"destructive\" });\n    }\n  });\n\n  const deleteRuleMutation = useMutation({\n    mutationFn: async (id: string) => {\n      await apiRequest(\"DELETE\", `/api/rules/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/rules\"] });\n      toast({ title: \"Regel verwijderd\", description: \"De regel is succesvol verwijderd.\" });\n    },\n    onError: () => {\n      toast({ title: \"Fout\", description: \"Er is een fout opgetreden.\", variant: \"destructive\" });\n    }\n  });\n\n\n  const onOrganizationSubmit = (data: OrganizationFormData) => {\n    updateOrganizationMutation.mutate(data);\n  };\n\n  const onFeeSubmit = (data: MembershipFeeFormData) => {\n    updateFeeSettingsMutation.mutate(data);\n  };\n\n  const onUserSubmit = (data: UserFormData) => {\n    createUserMutation.mutate(data);\n  };\n\n  const onEditUserSubmit = (data: UserFormData) => {\n    editUserMutation.mutate(data);\n  };\n\n  const onRuleSubmit = (data: RuleFormData) => {\n    const ruleData = {\n      ...data,\n      parameters: {\n        minAge: data.minAge ? parseInt(data.minAge) : undefined,\n        minYears: data.minYears ? parseInt(data.minYears) : undefined,\n        minPayments: data.minPayments ? parseInt(data.minPayments) : undefined,\n        consecutive: data.consecutive,\n        categories: data.categories,\n      },\n    };\n    createRuleMutation.mutate(ruleData);\n  };\n\n  const onEditRuleSubmit = (data: RuleFormData) => {\n    const ruleData = {\n      ...data,\n      parameters: {\n        minAge: data.minAge ? parseInt(data.minAge) : undefined,\n        minYears: data.minYears ? parseInt(data.minYears) : undefined,\n        minPayments: data.minPayments ? parseInt(data.minPayments) : undefined,\n        consecutive: data.consecutive,\n        categories: data.categories,\n      },\n    };\n    updateRuleMutation.mutate({ id: editingRule.id, data: ruleData });\n  };\n\n  // User management handlers\n  const handleEditUser = (user: any) => {\n    setEditingUser(user);\n    editUserForm.reset({\n      name: user.name,\n      email: user.email,\n      role: user.role,\n    });\n    setShowEditUserDialog(true);\n  };\n\n  const handleResetPassword = async (user: any) => {\n    try {\n      const response = await apiRequest(\"POST\", `/api/users/${user.id}/reset-password`, {});\n      const result = await response.json();\n      toast({\n        title: \"Wachtwoord gereset\",\n        description: `Nieuw tijdelijk wachtwoord: ${result.temporaryPassword}`,\n      });\n    } catch (error) {\n      toast({\n        title: \"Fout\",\n        description: \"Er is een fout opgetreden bij het resetten van het wachtwoord.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleDeleteUser = (user: any) => {\n    if (confirm(`Weet je zeker dat je ${user.name} wilt verwijderen?`)) {\n      deleteUserMutation.mutate(user.id);\n    }\n  };\n\n  const handleEditRule = (rule: any) => {\n    setEditingRule(rule);\n    editRuleForm.reset({\n      name: rule.name,\n      description: rule.description || \"\",\n      scope: rule.scope,\n      minAge: rule.parameters?.minAge?.toString() || \"\",\n      minYears: rule.parameters?.minYears?.toString() || \"\",\n      minPayments: rule.parameters?.minPayments?.toString() || \"\",\n      consecutive: rule.parameters?.consecutive || false,\n      categories: rule.parameters?.categories || [],\n    });\n    setShowEditRuleDialog(true);\n  };\n\n\n  const handleDeleteRule = (rule: any) => {\n    if (confirm(`Weet je zeker dat je de regel \"${rule.name}\" wilt verwijderen?`)) {\n      deleteRuleMutation.mutate(rule.id);\n    }\n  };\n\n  const getRuleScopeLabel = (scope: string) => {\n    const labels: Record<string, string> = {\n      'STEMRECHT': 'Stemrecht',\n      'VERKIESBAAR': 'Verkiesbaarheid',\n    };\n    return labels[scope] || scope;\n  };\n\n  const getRuleDescription = (rule: any) => {\n    const params = rule.parameters || {};\n    let description = `Voor ${getRuleScopeLabel(rule.scope).toLowerCase()}`;\n    \n    if (params.minAge) {\n      description += `, minimaal ${params.minAge} jaar oud`;\n    }\n    if (params.minYears) {\n      description += `, minimaal ${params.minYears} jaar lid`;\n    }\n    if (params.minPayments) {\n      description += `, ${params.minPayments} betalingen`;\n      if (params.consecutive) {\n        description += \" (opeenvolgend)\";\n      }\n    }\n    if (params.categories && params.categories.length > 0) {\n      description += `, voor categorieën: ${params.categories.join(\", \")}`;\n    }\n    \n    return description;\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n            {/* Page Header */}\n            <div className=\"border-b border-gray-200 pb-5 mb-6\">\n              <div>\n                <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Instellingen</h1>\n                <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer organisatie-instellingen en configuratie</p>\n              </div>\n            </div>\n\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"organization\" className=\"flex items-center gap-2\" data-testid=\"tab-organization\">\n                  <Building2 className=\"h-4 w-4\" />\n                  Organisatie\n                </TabsTrigger>\n                <TabsTrigger value=\"fees\" className=\"flex items-center gap-2\" data-testid=\"tab-fees\">\n                  <CreditCard className=\"h-4 w-4\" />\n                  Lidgelden\n                </TabsTrigger>\n                <TabsTrigger value=\"security\" className=\"flex items-center gap-2\" data-testid=\"tab-security\">\n                  <Users className=\"h-4 w-4\" />\n                  Gebruikers\n                </TabsTrigger>\n                <TabsTrigger value=\"rules\" className=\"flex items-center gap-2\" data-testid=\"tab-rules\">\n                  <Scale className=\"h-4 w-4\" />\n                  Organisatieregels\n                </TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"organization\" className=\"space-y-6\">\n                <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n                  <CardHeader>\n                    <CardTitle>Organisatie Informatie</CardTitle>\n                    <p className=\"mt-2 text-sm text-gray-500\">Basis informatie over uw moskee organisatie</p>\n                  </CardHeader>\n                  <CardContent>\n                    <Form {...organizationForm}>\n                      <form onSubmit={organizationForm.handleSubmit(onOrganizationSubmit)} className=\"space-y-6\">\n                        <div className=\"space-y-6\">\n                          {/* Basis Informatie */}\n                          <div>\n                            <h3 className=\"text-lg font-medium mb-4\">Basis Informatie</h3>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"name\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Organisatienaam</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"Moskee Al-Nour Brussel\" {...field} data-testid=\"input-org-name\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"slug\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>URL Identificatie</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"al-nour-brussel\" {...field} data-testid=\"input-org-slug\" />\n                                    </FormControl>\n                                    <FormDescription>\n                                      Gebruikt voor unieke identificatie in URL's\n                                    </FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n                          </div>\n\n                          {/* Adres Informatie */}\n                          <div>\n                            <h3 className=\"text-lg font-medium mb-4\">Adres</h3>\n                            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                              <div className=\"md:col-span-2\">\n                                <FormField\n                                  control={organizationForm.control}\n                                  name=\"street\"\n                                  render={({ field }) => (\n                                    <FormItem>\n                                      <FormLabel>Straat</FormLabel>\n                                      <FormControl>\n                                        <Input placeholder=\"Moskeestraat\" {...field} data-testid=\"input-org-street\" />\n                                      </FormControl>\n                                      <FormMessage />\n                                    </FormItem>\n                                  )}\n                                />\n                              </div>\n                              \n                              <FormField\n                                control={organizationForm.control}\n                                name=\"number\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Nummer</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"123\" {...field} data-testid=\"input-org-number\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"postalCode\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Postcode</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"1000\" {...field} data-testid=\"input-org-postal\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n                            \n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"city\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Stad</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"Brussel\" {...field} data-testid=\"input-org-city\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"country\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Land</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"België\" {...field} data-testid=\"input-org-country\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n                          </div>\n\n                          {/* Contact Informatie */}\n                          <div>\n                            <h3 className=\"text-lg font-medium mb-4\">Contact</h3>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"email\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>E-mailadres</FormLabel>\n                                    <FormControl>\n                                      <Input type=\"email\" placeholder=\"info@moskee.be\" {...field} data-testid=\"input-org-email\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"phone\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Telefoonnummer</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"+32 2 123 45 67\" {...field} data-testid=\"input-org-phone\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"website\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Website</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"https://www.moskee.be\" {...field} data-testid=\"input-org-website\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n                          </div>\n\n                          {/* Juridische Informatie */}\n                          <div>\n                            <h3 className=\"text-lg font-medium mb-4\">Juridische Informatie</h3>\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"companyNumber\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Ondernemingsnummer</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"0123.456.789\" {...field} data-testid=\"input-org-company-number\" />\n                                    </FormControl>\n                                    <FormDescription>\n                                      Belgisch ondernemingsnummer (BE format)\n                                    </FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={organizationForm.control}\n                                name=\"companyType\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Vennootschapsvorm</FormLabel>\n                                    <Select onValueChange={field.onChange} value={field.value}>\n                                      <FormControl>\n                                        <SelectTrigger data-testid=\"select-company-type\">\n                                          <SelectValue placeholder=\"Selecteer vennootschapsvorm\" />\n                                        </SelectTrigger>\n                                      </FormControl>\n                                      <SelectContent>\n                                        <SelectItem value=\"VZW\">Vereniging zonder winstoogmerk (VZW)</SelectItem>\n                                        <SelectItem value=\"BVBA\">Besloten vennootschap (BV)</SelectItem>\n                                        <SelectItem value=\"NV\">Naamloze vennootschap (NV)</SelectItem>\n                                        <SelectItem value=\"VOF\">Vennootschap onder firma (VOF)</SelectItem>\n                                        <SelectItem value=\"EENMANSZAAK\">Eenmanszaak</SelectItem>\n                                        <SelectItem value=\"CVBA\">Coöperatieve vennootschap (CV)</SelectItem>\n                                        <SelectItem value=\"SE\">Europese vennootschap (SE)</SelectItem>\n                                        <SelectItem value=\"ANDERE\">Andere</SelectItem>\n                                      </SelectContent>\n                                    </Select>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n                          </div>\n                        </div>\n\n                        <div className=\"flex justify-end\">\n                          <Button\n                            type=\"submit\"\n                            disabled={updateOrganizationMutation.isPending || organizationSaved}\n                            data-testid=\"button-save-organization\"\n                          >\n                            <Save className=\"h-4 w-4 mr-2\" />\n                            {updateOrganizationMutation.isPending ? \"Opslaan...\" : \"Opslaan\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n\n              <TabsContent value=\"fees\" className=\"space-y-6\">\n                <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n                  <CardHeader>\n                    <CardTitle>Standaard Lidgeld Tarieven</CardTitle>\n                    <p className=\"mt-2 text-sm text-gray-500\">Configureer de standaard bijdragen per lidcategorie</p>\n                  </CardHeader>\n                  <CardContent>\n                    <Form {...feeForm}>\n                      <form onSubmit={feeForm.handleSubmit(onFeeSubmit)} className=\"space-y-6\">\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                          <FormField\n                            control={feeForm.control}\n                            name=\"studentFee\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Student Bijdrage</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <span className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\">€</span>\n                                    <Input {...field} type=\"number\" step=\"0.01\" className=\"pl-8\" placeholder=\"15.00\" data-testid=\"input-student-fee\" />\n                                  </div>\n                                </FormControl>\n                                <FormDescription>Per jaar</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={feeForm.control}\n                            name=\"adultFee\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Standaard Bijdrage</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <span className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\">€</span>\n                                    <Input {...field} type=\"number\" step=\"0.01\" className=\"pl-8\" placeholder=\"25.00\" data-testid=\"input-adult-fee\" />\n                                  </div>\n                                </FormControl>\n                                <FormDescription>Per jaar</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={feeForm.control}\n                            name=\"seniorFee\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Senior Bijdrage</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <span className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500\">€</span>\n                                    <Input {...field} type=\"number\" step=\"0.01\" className=\"pl-8\" placeholder=\"20.00\" data-testid=\"input-senior-fee\" />\n                                  </div>\n                                </FormControl>\n                                <FormDescription>Per jaar</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                          <FormField\n                            control={feeForm.control}\n                            name=\"defaultPaymentTerm\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Standaard Betalingstermijn</FormLabel>\n                                <Select onValueChange={field.onChange} value={field.value}>\n                                  <FormControl>\n                                    <SelectTrigger data-testid=\"select-payment-term\">\n                                      <SelectValue placeholder=\"Selecteer betalingstermijn\" />\n                                    </SelectTrigger>\n                                  </FormControl>\n                                  <SelectContent>\n                                    <SelectItem value=\"MONTHLY\">Maandelijks</SelectItem>\n                                    <SelectItem value=\"YEARLY\">Jaarlijks</SelectItem>\n                                  </SelectContent>\n                                </Select>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={feeForm.control}\n                            name=\"defaultPaymentMethod\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Standaard Betaalmethode</FormLabel>\n                                <Select onValueChange={field.onChange} value={field.value}>\n                                  <FormControl>\n                                    <SelectTrigger data-testid=\"select-payment-method\">\n                                      <SelectValue placeholder=\"Selecteer betaalmethode\" />\n                                    </SelectTrigger>\n                                  </FormControl>\n                                  <SelectContent>\n                                    <SelectItem value=\"SEPA\">SEPA Incasso</SelectItem>\n                                    <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                                    <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                                    <SelectItem value=\"CASH\">Contant</SelectItem>\n                                  </SelectContent>\n                                </Select>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <div className=\"flex justify-end\">\n                          <Button\n                            type=\"submit\"\n                            disabled={updateFeeSettingsMutation.isPending || feesSaved}\n                            data-testid=\"button-save-fees\"\n                          >\n                            <Save className=\"h-4 w-4 mr-2\" />\n                            {updateFeeSettingsMutation.isPending ? \"Opslaan...\" : \"Opslaan\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"security\" className=\"space-y-6\">\n                <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n                  <CardHeader className=\"flex flex-row items-center justify-between\">\n                    <div>\n                      <CardTitle>Gebruikersbeheer</CardTitle>\n                      <p className=\"mt-2 text-sm text-gray-500\">Beheer toegang en gebruikersrollen</p>\n                    </div>\n                    <Dialog open={showNewUserDialog} onOpenChange={setShowNewUserDialog}>\n                      <DialogTrigger asChild>\n                        <Button data-testid=\"button-new-user\">\n                          <Plus className=\"h-4 w-4 mr-2\" />\n                          Nieuwe Gebruiker\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent>\n                        <DialogHeader>\n                          <DialogTitle>Nieuwe Gebruiker Toevoegen</DialogTitle>\n                        </DialogHeader>\n                        <Form {...userForm}>\n                          <form onSubmit={userForm.handleSubmit(onUserSubmit)} className=\"space-y-4\">\n                            <FormField\n                              control={userForm.control}\n                              name=\"name\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>Naam</FormLabel>\n                                  <FormControl>\n                                    <Input placeholder=\"Ahmed Benali\" {...field} data-testid=\"input-user-name\" />\n                                  </FormControl>\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n\n                            <FormField\n                              control={userForm.control}\n                              name=\"email\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>E-mailadres</FormLabel>\n                                  <FormControl>\n                                    <Input type=\"email\" placeholder=\"gebruiker@moskee.be\" {...field} data-testid=\"input-user-email\" />\n                                  </FormControl>\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n\n                            <FormField\n                              control={userForm.control}\n                              name=\"role\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>Rol</FormLabel>\n                                  <Select onValueChange={field.onChange} value={field.value}>\n                                    <FormControl>\n                                      <SelectTrigger data-testid=\"select-user-role\">\n                                        <SelectValue placeholder=\"Selecteer rol\" />\n                                      </SelectTrigger>\n                                    </FormControl>\n                                    <SelectContent>\n                                      <SelectItem value=\"BEHEERDER\">Beheerder</SelectItem>\n                                      <SelectItem value=\"MEDEWERKER\">Medewerker</SelectItem>\n                                    </SelectContent>\n                                  </Select>\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n\n                            <FormField\n                              control={userForm.control}\n                              name=\"password\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>Tijdelijk Wachtwoord</FormLabel>\n                                  <FormControl>\n                                    <Input type=\"password\" placeholder=\"Minimaal 6 karakters\" {...field} data-testid=\"input-user-password\" />\n                                  </FormControl>\n                                  <FormDescription>\n                                    Gebruiker wordt gevraagd om dit te wijzigen bij eerste login\n                                  </FormDescription>\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n\n                            <div className=\"flex justify-end gap-2 pt-4\">\n                              <Button type=\"button\" variant=\"outline\" onClick={() => setShowNewUserDialog(false)}>\n                                Annuleren\n                              </Button>\n                              <Button type=\"submit\" disabled={createUserMutation.isPending} data-testid=\"button-create-user\">\n                                {createUserMutation.isPending ? \"Aanmaken...\" : \"Gebruiker Aanmaken\"}\n                              </Button>\n                            </div>\n                          </form>\n                        </Form>\n                      </DialogContent>\n                    </Dialog>\n                  </CardHeader>\n                  \n                  <CardContent>\n                    {!users || !Array.isArray(users) || users.length === 0 ? (\n                      <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\" data-testid=\"no-users\">\n                        <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n                          <Users className=\"w-8 h-8 text-gray-400\" />\n                        </div>\n                        <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n                          Nog geen gebruikers toegevoegd\n                        </h3>\n                        <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n                          Voeg je eerste gebruiker toe om toegang te verlenen tot het systeem.\n                        </p>\n                      </div>\n                    ) : (\n                      <div className=\"space-y-4\">\n                        {Array.isArray(users) && users.map((currentUser: any) => {\n                          const isCurrentUser = currentUser.email === user?.email;\n                          return (\n                          <div key={currentUser.id} className={`flex items-center justify-between p-4 glass-card border-0 rounded-xl ${isCurrentUser ? 'opacity-50' : ''}`} data-testid={`user-item-${currentUser.id}`}>\n                            <div className=\"flex items-center space-x-4\">\n                              <div className=\"w-10 h-10 bg-primary rounded-full flex items-center justify-center\">\n                                {currentUser.role === 'BEHEERDER' ? (\n                                  <RiAdminLine className=\"h-5 w-5 text-primary-foreground\" />\n                                ) : (\n                                  <Users className=\"h-5 w-5 text-primary-foreground\" />\n                                )}\n                              </div>\n                              <div>\n                                <div className=\"font-medium text-gray-900\" data-testid={`user-name-${currentUser.id}`}>\n                                  {currentUser.name}\n                                  {isCurrentUser && <span className=\"text-xs text-gray-500 ml-2\">(jij)</span>}\n                                </div>\n                                <div className=\"text-sm text-gray-500\" data-testid={`user-email-${currentUser.id}`}>\n                                  {currentUser.email}\n                                </div>\n                              </div>\n                            </div>\n                            <div className=\"flex items-center space-x-2\">\n                              <Badge variant={currentUser.role === 'BEHEERDER' ? 'default' : 'secondary'} data-testid={`user-role-${currentUser.id}`}>\n                                {currentUser.role === 'BEHEERDER' ? 'Beheerder' : 'Medewerker'}\n                              </Badge>\n                              <Badge variant={currentUser.active ? 'default' : 'destructive'} className={currentUser.active ? 'bg-green-100 text-green-800 hover:bg-green-100' : ''}>\n                                {currentUser.active ? 'Actief' : 'Inactief'}\n                              </Badge>\n                              {!isCurrentUser && (\n                                <DropdownMenu>\n                                  <DropdownMenuTrigger asChild>\n                                    <Button variant=\"ghost\" size=\"sm\" data-testid={`user-actions-${currentUser.id}`}>\n                                      <MoreVertical className=\"h-4 w-4\" />\n                                    </Button>\n                                  </DropdownMenuTrigger>\n                                  <DropdownMenuContent align=\"end\">\n                                    <DropdownMenuItem onClick={() => handleEditUser(currentUser)} data-testid={`action-edit-user-${currentUser.id}`}>\n                                      <Edit className=\"h-4 w-4 mr-2\" />\n                                      Bewerken\n                                    </DropdownMenuItem>\n                                    <DropdownMenuItem onClick={() => handleResetPassword(currentUser)} data-testid={`action-reset-password-${currentUser.id}`}>\n                                      <KeyRound className=\"h-4 w-4 mr-2\" />\n                                      Wachtwoord resetten\n                                    </DropdownMenuItem>\n                                    <DropdownMenuItem className=\"text-red-600\" onClick={() => handleDeleteUser(currentUser)} data-testid={`action-delete-user-${currentUser.id}`}>\n                                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                                      Verwijderen\n                                    </DropdownMenuItem>\n                                  </DropdownMenuContent>\n                                </DropdownMenu>\n                              )}\n                            </div>\n                          </div>\n                          );\n                        })}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Edit User Dialog */}\n                <Dialog open={showEditUserDialog} onOpenChange={setShowEditUserDialog}>\n                  <DialogContent>\n                    <DialogHeader>\n                      <DialogTitle>Gebruiker Bewerken</DialogTitle>\n                    </DialogHeader>\n                    <Form {...editUserForm}>\n                      <form onSubmit={editUserForm.handleSubmit(onEditUserSubmit)} className=\"space-y-4\">\n                        <FormField\n                          control={editUserForm.control}\n                          name=\"name\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Naam</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"Voornaam Achternaam\" {...field} data-testid=\"input-edit-user-name\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={editUserForm.control}\n                          name=\"email\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>E-mailadres</FormLabel>\n                              <FormControl>\n                                <Input type=\"email\" placeholder=\"gebruiker@moskee.be\" {...field} data-testid=\"input-edit-user-email\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={editUserForm.control}\n                          name=\"role\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Rol</FormLabel>\n                              <Select onValueChange={field.onChange} value={field.value}>\n                                <FormControl>\n                                  <SelectTrigger data-testid=\"select-edit-user-role\">\n                                    <SelectValue placeholder=\"Selecteer rol\" />\n                                  </SelectTrigger>\n                                </FormControl>\n                                <SelectContent>\n                                  <SelectItem value=\"BEHEERDER\">Beheerder</SelectItem>\n                                  <SelectItem value=\"MEDEWERKER\">Medewerker</SelectItem>\n                                </SelectContent>\n                              </Select>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <div className=\"flex justify-end gap-2 pt-4\">\n                          <Button type=\"button\" variant=\"outline\" onClick={() => setShowEditUserDialog(false)}>\n                            Annuleren\n                          </Button>\n                          <Button type=\"submit\" disabled={editUserMutation.isPending} data-testid=\"button-update-user\">\n                            {editUserMutation.isPending ? \"Bijwerken...\" : \"Gebruiker Bijwerken\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </DialogContent>\n                </Dialog>\n              </TabsContent>\n\n              <TabsContent value=\"rules\" className=\"space-y-6\">\n                <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n                  <CardHeader className=\"flex flex-row items-center justify-between\">\n                    <div>\n                      <CardTitle>Organisatieregels</CardTitle>\n                      <p className=\"mt-2 text-sm text-gray-500\">Configureer regels voor stemrecht, verkiesbaarheid en functies</p>\n                    </div>\n                    <Dialog open={showNewRuleDialog} onOpenChange={setShowNewRuleDialog}>\n                      <DialogTrigger asChild>\n                        <Button data-testid=\"button-new-rule\">\n                          <Plus className=\"h-4 w-4 mr-2\" />\n                          Nieuwe Regel\n                        </Button>\n                      </DialogTrigger>\n                      <DialogContent className=\"max-w-2xl\">\n                        <DialogHeader>\n                          <DialogTitle>Nieuwe Organisatieregel</DialogTitle>\n                        </DialogHeader>\n                        <Form {...ruleForm}>\n                          <form onSubmit={ruleForm.handleSubmit(onRuleSubmit)} className=\"space-y-4\">\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                              <FormField\n                                control={ruleForm.control}\n                                name=\"name\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Regelnaam</FormLabel>\n                                    <FormControl>\n                                      <Input placeholder=\"Stemrecht voor standaard leden\" {...field} data-testid=\"input-rule-name\" />\n                                    </FormControl>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={ruleForm.control}\n                                name=\"scope\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Toepassing</FormLabel>\n                                    <Select onValueChange={field.onChange} value={field.value}>\n                                      <FormControl>\n                                        <SelectTrigger data-testid=\"select-rule-scope\">\n                                          <SelectValue placeholder=\"Selecteer toepassing\" />\n                                        </SelectTrigger>\n                                      </FormControl>\n                                      <SelectContent>\n                                        <SelectItem value=\"STEMRECHT\">Stemrecht</SelectItem>\n                                        <SelectItem value=\"VERKIESBAAR\">Verkiesbaarheid</SelectItem>\n                                      </SelectContent>\n                                    </Select>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n\n                            <FormField\n                              control={ruleForm.control}\n                              name=\"description\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>Beschrijving (optioneel)</FormLabel>\n                                  <FormControl>\n                                    <Textarea placeholder=\"Uitleg van de regel...\" {...field} data-testid=\"input-rule-description\" />\n                                  </FormControl>\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                              <FormField\n                                control={ruleForm.control}\n                                name=\"minAge\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Minimumleeftijd</FormLabel>\n                                    <FormControl>\n                                      <Input type=\"number\" placeholder=\"18\" {...field} data-testid=\"input-rule-min-age\" />\n                                    </FormControl>\n                                    <FormDescription>Optioneel</FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={ruleForm.control}\n                                name=\"minYears\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Minimaal aantal jaren lid</FormLabel>\n                                    <FormControl>\n                                      <Input type=\"number\" placeholder=\"5\" {...field} data-testid=\"input-rule-min-years\" />\n                                    </FormControl>\n                                    <FormDescription>Optioneel</FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n\n                              <FormField\n                                control={ruleForm.control}\n                                name=\"minPayments\"\n                                render={({ field }) => (\n                                  <FormItem>\n                                    <FormLabel>Minimaal aantal betalingen</FormLabel>\n                                    <FormControl>\n                                      <Input type=\"number\" placeholder=\"5\" {...field} data-testid=\"input-rule-min-payments\" />\n                                    </FormControl>\n                                    <FormDescription>Optioneel</FormDescription>\n                                    <FormMessage />\n                                  </FormItem>\n                                )}\n                              />\n                            </div>\n\n                            <FormField\n                              control={ruleForm.control}\n                              name=\"consecutive\"\n                              render={({ field }) => (\n                                <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-4\">\n                                  <div className=\"space-y-0.5\">\n                                    <FormLabel className=\"text-base\">Opeenvolgende betalingen</FormLabel>\n                                    <FormDescription>\n                                      Betalingen moeten opeenvolgend zijn (geen gemiste jaren)\n                                    </FormDescription>\n                                  </div>\n                                  <FormControl>\n                                    <Switch\n                                      checked={field.value}\n                                      onCheckedChange={field.onChange}\n                                      data-testid=\"switch-rule-consecutive\"\n                                    />\n                                  </FormControl>\n                                </FormItem>\n                              )}\n                            />\n\n                            <div className=\"flex justify-end gap-2 pt-4\">\n                              <Button type=\"button\" variant=\"outline\" onClick={() => setShowNewRuleDialog(false)}>\n                                Annuleren\n                              </Button>\n                              <Button type=\"submit\" disabled={createRuleMutation.isPending} data-testid=\"button-create-rule\">\n                                {createRuleMutation.isPending ? \"Aanmaken...\" : \"Regel Aanmaken\"}\n                              </Button>\n                            </div>\n                          </form>\n                        </Form>\n                      </DialogContent>\n                    </Dialog>\n                  </CardHeader>\n                  \n                  <CardContent>\n                    {!rules || !Array.isArray(rules) || rules.length === 0 ? (\n                      <div className=\"text-center py-6 text-gray-500\" data-testid=\"no-rules\">\n                        Nog geen organisatieregels geconfigureerd\n                      </div>\n                    ) : (\n                      <div className=\"space-y-4\">\n                        {Array.isArray(rules) && rules.map((rule: any) => (\n                          <div key={rule.id} className=\"p-4 glass-card border-0 rounded-xl\" data-testid={`rule-item-${rule.id}`}>\n                            <div className=\"flex items-start justify-between\">\n                              <div className=\"flex-1\">\n                                <div className=\"flex items-center space-x-2 mb-2\">\n                                  <h4 className=\"font-semibold text-gray-900\" data-testid={`rule-name-${rule.id}`}>\n                                    {rule.name}\n                                  </h4>\n                                  <Badge variant={rule.active ? 'default' : 'destructive'} className={rule.active ? 'bg-green-100 text-green-800 hover:bg-green-100' : ''}>\n                                    {rule.active ? 'Actief' : 'Inactief'}\n                                  </Badge>\n                                </div>\n                                <p className=\"text-sm text-gray-600 mb-2\" data-testid={`rule-description-${rule.id}`}>\n                                  {getRuleDescription(rule)}\n                                </p>\n                                {rule.description && (\n                                  <p className=\"text-xs text-gray-500\">{rule.description}</p>\n                                )}\n                                <div className=\"mt-2 text-xs text-gray-500\">\n                                  Aangemaakt: {formatDate(rule.createdAt)}\n                                </div>\n                              </div>\n                              <div className=\"flex items-center space-x-2 ml-4\">\n                                <DropdownMenu>\n                                  <DropdownMenuTrigger asChild>\n                                    <Button variant=\"ghost\" size=\"sm\" data-testid={`rule-actions-${rule.id}`}>\n                                      <MoreVertical className=\"h-4 w-4\" />\n                                    </Button>\n                                  </DropdownMenuTrigger>\n                                  <DropdownMenuContent align=\"end\">\n                                    <DropdownMenuItem onClick={() => handleEditRule(rule)} data-testid={`action-edit-rule-${rule.id}`}>\n                                      <Edit className=\"h-4 w-4 mr-2\" />\n                                      Bewerken\n                                    </DropdownMenuItem>\n                                    <DropdownMenuItem className=\"text-red-600\" onClick={() => handleDeleteRule(rule)} data-testid={`action-delete-rule-${rule.id}`}>\n                                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                                      Verwijderen\n                                    </DropdownMenuItem>\n                                  </DropdownMenuContent>\n                                </DropdownMenu>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n\n                {/* Edit Rule Dialog */}\n                <Dialog open={showEditRuleDialog} onOpenChange={setShowEditRuleDialog}>\n                  <DialogContent className=\"max-w-2xl\">\n                    <DialogHeader>\n                      <DialogTitle>Organisatieregel Bewerken</DialogTitle>\n                    </DialogHeader>\n                    <Form {...editRuleForm}>\n                      <form onSubmit={editRuleForm.handleSubmit(onEditRuleSubmit)} className=\"space-y-4\">\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                          <FormField\n                            control={editRuleForm.control}\n                            name=\"name\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Regelnaam</FormLabel>\n                                <FormControl>\n                                  <Input placeholder=\"Stemrecht voor standaard leden\" {...field} data-testid=\"input-edit-rule-name\" />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={editRuleForm.control}\n                            name=\"scope\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Toepassing</FormLabel>\n                                <Select onValueChange={field.onChange} value={field.value}>\n                                  <FormControl>\n                                    <SelectTrigger data-testid=\"select-edit-rule-scope\">\n                                      <SelectValue placeholder=\"Selecteer toepassing\" />\n                                    </SelectTrigger>\n                                  </FormControl>\n                                  <SelectContent>\n                                    <SelectItem value=\"STEMRECHT\">Stemrecht</SelectItem>\n                                    <SelectItem value=\"VERKIESBAAR\">Verkiesbaarheid</SelectItem>\n                                  </SelectContent>\n                                </Select>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <FormField\n                          control={editRuleForm.control}\n                          name=\"description\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Beschrijving (optioneel)</FormLabel>\n                              <FormControl>\n                                <Textarea placeholder=\"Uitleg van de regel...\" {...field} data-testid=\"input-edit-rule-description\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                          <FormField\n                            control={editRuleForm.control}\n                            name=\"minAge\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Minimumleeftijd</FormLabel>\n                                <FormControl>\n                                  <Input type=\"number\" placeholder=\"18\" {...field} data-testid=\"input-edit-rule-min-age\" />\n                                </FormControl>\n                                <FormDescription>Optioneel</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={editRuleForm.control}\n                            name=\"minYears\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Minimaal aantal jaren lid</FormLabel>\n                                <FormControl>\n                                  <Input type=\"number\" placeholder=\"5\" {...field} data-testid=\"input-edit-rule-min-years\" />\n                                </FormControl>\n                                <FormDescription>Optioneel</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={editRuleForm.control}\n                            name=\"minPayments\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Minimaal aantal betalingen</FormLabel>\n                                <FormControl>\n                                  <Input type=\"number\" placeholder=\"5\" {...field} data-testid=\"input-edit-rule-min-payments\" />\n                                </FormControl>\n                                <FormDescription>Optioneel</FormDescription>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <FormField\n                          control={editRuleForm.control}\n                          name=\"consecutive\"\n                          render={({ field }) => (\n                            <FormItem className=\"flex flex-row items-center justify-between rounded-lg border p-4\">\n                              <div className=\"space-y-0.5\">\n                                <FormLabel className=\"text-base\">Opeenvolgende betalingen</FormLabel>\n                                <FormDescription>\n                                  Betalingen moeten opeenvolgend zijn (geen gemiste jaren)\n                                </FormDescription>\n                              </div>\n                              <FormControl>\n                                <Switch\n                                  checked={field.value}\n                                  onCheckedChange={field.onChange}\n                                  data-testid=\"switch-edit-rule-consecutive\"\n                                />\n                              </FormControl>\n                            </FormItem>\n                          )}\n                        />\n\n                        <div className=\"flex justify-end gap-2 pt-4\">\n                          <Button type=\"button\" variant=\"outline\" onClick={() => setShowEditRuleDialog(false)}>\n                            Annuleren\n                          </Button>\n                          <Button type=\"submit\" disabled={updateRuleMutation.isPending} data-testid=\"button-update-rule\">\n                            {updateRuleMutation.isPending ? \"Bijwerken...\" : \"Regel Bijwerken\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </DialogContent>\n                </Dialog>\n              </TabsContent>\n\n            </Tabs>\n      </div>\n    </main>\n  );\n}\n","size_bytes":75751},"client/src/pages/leden.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { MemberForm } from \"@/components/forms/member-form\";\nimport { Toolbar } from \"@/components/members/toolbar\";\nimport { MembersTable } from \"@/components/members/members-table\";\nimport { FiltersDrawer } from \"@/components/members/filters-drawer\";\nimport { MemberImportDialog } from \"@/components/members/member-import-dialog\";\nimport { MemberDetailDialog } from \"@/components/members/member-detail-dialog\";\nimport { ExportDialog } from \"@/components/members/export-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { FiUserPlus } from \"react-icons/fi\";\nimport { Edit2 } from \"lucide-react\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\ninterface FilterValues {\n  categories: string[];\n  statuses: string[];\n  genders: string[];\n  joinDateFrom: string;\n  joinDateTo: string;\n  paymentStatuses: string[];\n  onlyActivePayments: boolean;\n}\n\nconst initialFilters: FilterValues = {\n  categories: [],\n  statuses: [],\n  genders: [],\n  joinDateFrom: \"\",\n  joinDateTo: \"\",\n  paymentStatuses: [],\n  onlyActivePayments: false,\n};\n\nexport default function Leden() {\n  const isMobile = useIsMobile();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState(\"all\");\n  const [categoryFilter, setCategoryFilter] = useState(\"all\");\n  const [votingRightsFilter, setVotingRightsFilter] = useState(\"\");\n  const [joinDateFrom, setJoinDateFrom] = useState<Date | undefined>();\n  const [joinDateTo, setJoinDateTo] = useState<Date | undefined>();\n  const [paymentStatusFilter, setPaymentStatusFilter] = useState(\"all\");\n  const [showNewMemberDialog, setShowNewMemberDialog] = useState(false);\n  const [showImportDialog, setShowImportDialog] = useState(false);\n  const [showExportDialog, setShowExportDialog] = useState(false);\n  const [showFiltersDrawer, setShowFiltersDrawer] = useState(false);\n  const [showMemberDetail, setShowMemberDetail] = useState(false);\n  const [showEditMember, setShowEditMember] = useState(false);\n  const [selectedMember, setSelectedMember] = useState<any>(null);\n  const [advancedFilters, setAdvancedFilters] = useState<FilterValues>(initialFilters);\n  const [page, setPage] = useState(1);\n  const [perPage, setPerPage] = useState(20);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: members, isLoading, isFetching } = useQuery({\n    queryKey: [\"/api/members\"],\n    staleTime: 5000, // 5 seconds for member data\n  });\n\n  const updateMemberMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      const response = await apiRequest(\"PUT\", `/api/members/${id}`, data);\n      return response.json();\n    },\n    onSuccess: async (updatedMember, variables) => {\n      // Optimistic update - update member in lijst\n      queryClient.setQueryData([\"/api/members\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.map((member: any) => \n          member.id === variables.id ? { ...member, ...variables.data } : member\n        );\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/members\"] });\n      toast({\n        title: \"Lid bijgewerkt\",\n        description: \"De wijzigingen zijn opgeslagen.\",\n      });\n    },\n  });\n\n  const deleteMemberMutation = useMutation({\n    mutationFn: async (memberId: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/members/${memberId}`);\n      return response;\n    },\n    onSuccess: async (result, deletedMemberId) => {\n      // Optimistic update - verwijder member uit lijst\n      queryClient.setQueryData([\"/api/members\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.filter((member: any) => member.id !== deletedMemberId);\n      });\n      \n      // Update dashboard stats optimistically\n      queryClient.setQueryData([\"/api/dashboard/stats\"], (oldStats: any) => {\n        if (!oldStats) return oldStats;\n        return {\n          ...oldStats,\n          totalMembers: (parseInt(oldStats.totalMembers) - 1).toString(),\n          activeMembers: (parseInt(oldStats.activeMembers) - 1).toString(),\n        };\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/members\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Lid verwijderd\",\n        description: \"Het lid is permanent verwijderd uit het systeem.\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Fout bij verwijderen\",\n        description: \"Er is een fout opgetreden bij het verwijderen van het lid.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const importMembersMutation = useMutation({\n    mutationFn: async (membersData: any[]) => {\n      const importedMembers = [];\n      \n      for (const memberData of membersData) {\n        try {\n          const response = await apiRequest(\"POST\", \"/api/members\", memberData);\n          const member = await response.json();\n          importedMembers.push(member);\n        } catch (error) {\n          console.error('Error importing member:', memberData.memberNumber, error);\n          throw error;\n        }\n      }\n      \n      return importedMembers;\n    },\n    onSuccess: async (importedMembers, variables) => {\n      // Optimistic update - voeg geïmporteerde members toe\n      queryClient.setQueryData([\"/api/members\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return importedMembers;\n        return [...importedMembers, ...oldData];\n      });\n      \n      // Update dashboard stats optimistically\n      queryClient.setQueryData([\"/api/dashboard/stats\"], (oldStats: any) => {\n        if (!oldStats) return oldStats;\n        const activeCount = importedMembers.filter((m: any) => m.active).length;\n        return {\n          ...oldStats,\n          totalMembers: (parseInt(oldStats.totalMembers) + importedMembers.length).toString(),\n          activeMembers: (parseInt(oldStats.activeMembers) + activeCount).toString(),\n        };\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/members\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Import voltooid\",\n        description: `${importedMembers.length} leden succesvol geïmporteerd.`,\n      });\n      setShowImportDialog(false);\n    },\n    onError: (error) => {\n      console.error('Import error:', error);\n      toast({\n        title: \"Import fout\",\n        description: \"Er is een fout opgetreden bij het importeren van de leden.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Advanced filtering logic\n  const filteredMembers = useMemo(() => {\n    if (!members || !Array.isArray(members)) return [];\n    \n    return members.filter((member: any) => {\n      // Search filter\n      const searchMatch = searchTerm === \"\" || \n        `${member.firstName} ${member.lastName}`.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        member.memberNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        member.email?.toLowerCase().includes(searchTerm.toLowerCase());\n      \n      // Status filter\n      const statusMatch = statusFilter === \"all\" || \n        (statusFilter === \"ACTIEF\" && member.active) ||\n        (statusFilter === \"INACTIEF\" && !member.active);\n      \n      // Category filter  \n      const categoryMatch = categoryFilter === \"all\" || member.category === categoryFilter;\n      \n      // Voting rights filter (based on age and category)\n      const votingRightsMatch = votingRightsFilter === \"\" || \n        (votingRightsFilter === \"yes\" && (member.category === \"STANDAARD\" || member.category === \"SENIOR\")) ||\n        (votingRightsFilter === \"no\" && (member.category === \"STUDENT\" || member.category === \"JEUGD\"));\n      \n      // Date range filter\n      let dateMatch = true;\n      if (joinDateFrom || joinDateTo) {\n        const memberDate = new Date(member.createdAt);\n        if (joinDateFrom) {\n          dateMatch = dateMatch && memberDate >= joinDateFrom;\n        }\n        if (joinDateTo) {\n          dateMatch = dateMatch && memberDate <= joinDateTo;\n        }\n      }\n      \n      // Payment status filter (mock for now)\n      const paymentMatch = paymentStatusFilter === \"all\";\n      \n      // Advanced filters (keep existing logic as backup)\n      const categoryAdvancedMatch = advancedFilters.categories.length === 0 || \n        advancedFilters.categories.includes(member.category);\n      \n      const statusAdvancedMatch = advancedFilters.statuses.length === 0 || \n        advancedFilters.statuses.includes(member.active ? 'ACTIEF' : 'INACTIEF');\n      \n      const genderAdvancedMatch = advancedFilters.genders.length === 0 || \n        advancedFilters.genders.includes(member.gender);\n      \n      // Advanced date range filter\n      let dateAdvancedMatch = true;\n      if (advancedFilters.joinDateFrom || advancedFilters.joinDateTo) {\n        const memberDate = new Date(member.createdAt);\n        if (advancedFilters.joinDateFrom) {\n          dateAdvancedMatch = dateAdvancedMatch && memberDate >= new Date(advancedFilters.joinDateFrom);\n        }\n        if (advancedFilters.joinDateTo) {\n          dateAdvancedMatch = dateAdvancedMatch && memberDate <= new Date(advancedFilters.joinDateTo);\n        }\n      }\n      \n      return searchMatch && statusMatch && categoryMatch && votingRightsMatch && \n             dateMatch && paymentMatch && categoryAdvancedMatch && \n             statusAdvancedMatch && genderAdvancedMatch && dateAdvancedMatch;\n    });\n  }, [members, searchTerm, statusFilter, categoryFilter, votingRightsFilter, joinDateFrom, joinDateTo, paymentStatusFilter, advancedFilters]);\n  \n  // Pagination\n  const totalMembers = filteredMembers.length;\n  const paginatedMembers = useMemo(() => {\n    const startIndex = (page - 1) * perPage;\n    const endIndex = startIndex + perPage;\n    return filteredMembers.slice(startIndex, endIndex);\n  }, [filteredMembers, page, perPage]);\n\n  const toggleMemberStatus = (memberId: string, currentStatus: boolean) => {\n    updateMemberMutation.mutate({\n      id: memberId,\n      data: { active: !currentStatus }\n    });\n  };\n\n  const handleRowAction = (action: string, memberId: string) => {\n    switch (action) {\n      case 'view':\n        toast({ title: \"Lid bekijken\", description: `Bekijk details van lid ${memberId}` });\n        break;\n      case 'edit':\n        toast({ title: \"Lid bewerken\", description: `Bewerk lid ${memberId}` });\n        break;\n      case 'toggleStatus':\n        const member = Array.isArray(members) ? members.find((m: any) => m.id === memberId) : null;\n        if (member) {\n          toggleMemberStatus(memberId, member.active);\n        }\n        break;\n      case 'delete':\n        deleteMemberMutation.mutate(memberId);\n        break;\n    }\n  };\n\n  const handleBulkAction = (action: string, memberIds: string[]) => {\n    switch (action) {\n      case 'export':\n        toast({ title: \"Export\", description: `${memberIds.length} leden geëxporteerd` });\n        break;\n      case 'deactivate':\n        toast({ title: \"Bulk deactivatie\", description: `${memberIds.length} leden gedeactiveerd` });\n        break;\n    }\n  };\n\n  const handleMemberView = (memberId: string) => {\n    const member = filteredMembers.find((m: any) => m.id === memberId);\n    if (member) {\n      setSelectedMember(member);\n      setShowMemberDetail(true);\n    }\n  };\n\n  const handleMemberEdit = (memberId: string) => {\n    const member = filteredMembers.find((m: any) => m.id === memberId);\n    if (member) {\n      setSelectedMember(member);\n      setShowEditMember(true);\n    }\n  };\n\n  const handleMemberToggleStatus = (memberId: string, currentStatus: boolean) => {\n    const newStatus = currentStatus ? 'INACTIVE' : 'ACTIVE';\n    updateMemberMutation.mutate({ id: memberId, data: { status: newStatus } });\n  };\n\n  const handleMemberDelete = (memberId: string) => {\n    deleteMemberMutation.mutate(memberId);\n  };\n\n  const handleExport = () => {\n    setShowExportDialog(true);\n  };\n\n  const handleImport = () => {\n    setShowImportDialog(true);\n  };\n\n  const handleImportMembers = (membersData: any[]) => {\n    importMembersMutation.mutate(membersData);\n  };\n\n  const handleAdvancedFilters = (filters: FilterValues) => {\n    setAdvancedFilters(filters);\n    setShowFiltersDrawer(false);\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900 tracking-tight\" data-testid=\"page-title\">Ledenbeheer</h1>\n            <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer alle leden van uw organisatie</p>\n          </div>\n        </div>\n\n      <Toolbar \n        searchTerm={searchTerm}\n        onSearchChange={setSearchTerm}\n        statusFilter={statusFilter}\n        onStatusFilterChange={setStatusFilter}\n        categoryFilter={categoryFilter}\n        onCategoryFilterChange={setCategoryFilter}\n        votingRightsFilter={votingRightsFilter}\n        onVotingRightsFilterChange={setVotingRightsFilter}\n        joinDateFrom={joinDateFrom}\n        onJoinDateFromChange={setJoinDateFrom}\n        joinDateTo={joinDateTo}\n        onJoinDateToChange={setJoinDateTo}\n        paymentStatusFilter={paymentStatusFilter}\n        onPaymentStatusFilterChange={setPaymentStatusFilter}\n        onFiltersClick={() => setShowFiltersDrawer(true)}\n        onExportClick={handleExport}\n        onImportClick={handleImport}\n        onNewMemberClick={() => setShowNewMemberDialog(true)}\n        totalMembers={totalMembers}\n        isLoading={isLoading}\n      />\n\n      <MembersTable\n        members={paginatedMembers}\n        total={totalMembers}\n        page={page}\n        perPage={perPage}\n        onPageChange={setPage}\n        onPerPageChange={setPerPage}\n        onRowAction={handleRowAction}\n        onBulkAction={handleBulkAction}\n        onView={handleMemberView}\n        onEdit={handleMemberEdit}\n        onToggleStatus={handleMemberToggleStatus}\n        onDelete={handleMemberDelete}\n        loading={isLoading}\n      />\n\n      {/* Dialogs */}\n      <Dialog open={showNewMemberDialog} onOpenChange={setShowNewMemberDialog}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FiUserPlus className=\"h-5 w-5\" />\n              Nieuw Lid Toevoegen\n            </DialogTitle>\n            <DialogDescription>\n              Voeg een nieuw lid toe aan de ledenlijst.\n            </DialogDescription>\n          </DialogHeader>\n          <MemberForm \n            onSubmit={(data) => {\n              // Add mutation logic here\n              setShowNewMemberDialog(false);\n            }}\n            onCancel={() => setShowNewMemberDialog(false)}\n          />\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showEditMember} onOpenChange={setShowEditMember}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Edit2 className=\"h-5 w-5\" />\n              Lid Bewerken\n            </DialogTitle>\n            <DialogDescription>\n              Bewerk de gegevens van {selectedMember?.firstName} {selectedMember?.lastName}.\n            </DialogDescription>\n          </DialogHeader>\n          {selectedMember && (\n            <MemberForm \n              initialData={selectedMember}\n              onSubmit={(data) => {\n                updateMemberMutation.mutate({ id: selectedMember.id, data });\n                setShowEditMember(false);\n              }}\n              onCancel={() => setShowEditMember(false)}\n            />\n          )}\n        </DialogContent>\n      </Dialog>\n\n      <MemberImportDialog\n        open={showImportDialog}\n        onOpenChange={setShowImportDialog}\n        onImport={handleImportMembers}\n      />\n\n      <MemberDetailDialog\n        open={showMemberDetail}\n        onOpenChange={setShowMemberDetail}\n        member={selectedMember}\n      />\n\n      <ExportDialog\n        open={showExportDialog}\n        onOpenChange={setShowExportDialog}\n        members={filteredMembers}\n      />\n\n      <FiltersDrawer\n        open={showFiltersDrawer}\n        onOpenChange={setShowFiltersDrawer}\n        filters={advancedFilters}\n        onFiltersChange={handleAdvancedFilters}\n      />\n      </div>\n    </main>\n  );\n}","size_bytes":16819},"client/src/pages/lidgelden.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { KpiCards } from \"@/components/fees/kpi-cards\";\nimport { NewFeeDialog } from \"@/components/fees/new-fee-dialog\";\nimport { Toolbar } from \"@/components/fees/toolbar\";\nimport { FeesTable } from \"@/components/fees/fees-table\";\nimport { FeeDetailDialog } from \"@/components/fees/FeeDetailDialog\";\nimport { ImportDialog } from \"@/components/fees/import-dialog\";\nimport { SepaDialog } from \"@/components/fees/sepa-dialog\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from \"@/components/ui/alert-dialog\";\n\nexport default function Lidgelden() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // Data state - now using real API\n  const [selectedIds, setSelectedIds] = useState<string[]>([]);\n  const [selectedFee, setSelectedFee] = useState<any | null>(null);\n\n  // Filters and search\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState(\"all\");\n  const [yearFilter, setYearFilter] = useState(\"all\");\n  const [methodFilter, setMethodFilter] = useState(\"all\");\n  const [categoryFilter, setCategoryFilter] = useState(\"all\");\n  const [amountMin, setAmountMin] = useState<number | undefined>();\n  const [amountMax, setAmountMax] = useState<number | undefined>();\n  const [periodFrom, setPeriodFrom] = useState<Date | undefined>();\n  const [periodTo, setPeriodTo] = useState<Date | undefined>();\n\n  // Debug logging for period state changes\n  const handlePeriodFromChange = (date: Date | undefined) => {\n    console.log('Setting periodFrom to:', date);\n    setPeriodFrom(date);\n  };\n\n  const handlePeriodToChange = (date: Date | undefined) => {\n    console.log('Setting periodTo to:', date);\n    setPeriodTo(date);\n  };\n  const [onlyWithMandate, setOnlyWithMandate] = useState(false);\n  const [onlyOverdue, setOnlyOverdue] = useState(false);\n\n  // Table state\n  const [page, setPage] = useState(1);\n  const [perPage, setPerPage] = useState(20);\n  const [sortBy, setSortBy] = useState(\"periodStart\");\n  const [sortOrder, setSortOrder] = useState<\"asc\" | \"desc\">(\"desc\");\n\n  // Dialog state\n  const [showDetailDialog, setShowDetailDialog] = useState(false);\n  const [showImportDialog, setShowImportDialog] = useState(false);\n  const [showSepaDialog, setShowSepaDialog] = useState(false);\n  const [showChangeMethodDialog, setShowChangeMethodDialog] = useState(false);\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n  const [showNewFeeDialog, setShowNewFeeDialog] = useState(false);\n\n  // Fetch membership fees from API\n  const { data: allFees = [], isLoading } = useQuery({\n    queryKey: [\"/api/fees\"],\n  });\n\n  // Apply filters and sorting\n  const filteredFees = useMemo(() => {\n    if (!allFees?.length) return [];\n    \n    \n    return allFees.filter((fee: any) => {\n      // Search filter\n      const searchMatch = searchTerm === \"\" || \n        fee.memberName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        fee.memberNumber?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        fee.type?.toLowerCase().includes(searchTerm.toLowerCase());\n      \n      // Status filter\n      const statusMatch = statusFilter === \"all\" || fee.status === statusFilter;\n      \n      // Year filter\n      const yearMatch = yearFilter === \"all\" || \n        new Date(fee.periodStart).getFullYear().toString() === yearFilter;\n      \n      // Method filter\n      const methodMatch = methodFilter === \"all\" || fee.method === methodFilter;\n      \n      // Category filter\n      const categoryMatch = categoryFilter === \"all\" || fee.type === categoryFilter;\n      \n      // Amount filter - handle both string and number amounts\n      const amountValue = typeof fee.amount === 'number' ? fee.amount : parseFloat(fee.amount || \"0\");\n      const amountMinMatch = amountMin === undefined || amountValue >= amountMin;\n      const amountMaxMatch = amountMax === undefined || amountValue <= amountMax;\n      \n      // Period filter (periode start/end)\n      let periodMatch = true;\n      if (periodFrom || periodTo) {\n        const feeStart = new Date(fee.periodStart);\n        const feeEnd = new Date(fee.periodEnd);\n        \n        if (periodFrom) {\n          // Check if fee period overlaps with filter period start\n          periodMatch = periodMatch && feeEnd >= periodFrom;\n        }\n        if (periodTo) {\n          // Check if fee period overlaps with filter period end  \n          periodMatch = periodMatch && feeStart <= periodTo;\n        }\n      }\n      \n      // Only with mandate filter\n      const mandateMatch = !onlyWithMandate || (fee.method === \"SEPA\" && fee.hasMandate);\n      \n      // Only overdue filter\n      const overdueMatch = !onlyOverdue || (fee.status === \"OPEN\" && new Date(fee.periodEnd) < new Date());\n      \n      return searchMatch && statusMatch && yearMatch && methodMatch && categoryMatch && \n             amountMinMatch && amountMaxMatch && periodMatch && mandateMatch && overdueMatch;\n    }).sort((a: any, b: any) => {\n      const aValue = a[sortBy as keyof typeof a];\n      const bValue = b[sortBy as keyof typeof b];\n      if (sortOrder === \"asc\") {\n        return aValue > bValue ? 1 : -1;\n      } else {\n        return aValue < bValue ? 1 : -1;\n      }\n    });\n  }, [allFees, searchTerm, statusFilter, yearFilter, methodFilter, categoryFilter, \n      amountMin, amountMax, periodFrom, periodTo, onlyWithMandate, onlyOverdue, sortBy, sortOrder]);\n\n  // Paginate results\n  const paginatedResult = useMemo(() => {\n    const start = (page - 1) * perPage;\n    const end = start + perPage;\n    const items = filteredFees.slice(start, end);\n    return {\n      items,\n      totalCount: filteredFees.length,\n      totalPages: Math.ceil(filteredFees.length / perPage),\n      currentPage: page,\n      hasNext: page < Math.ceil(filteredFees.length / perPage),\n      hasPrev: page > 1\n    };\n  }, [filteredFees, page, perPage]);\n\n  // Selected fees for bulk actions\n  const selectedFees = allFees.filter(fee => selectedIds.includes(fee.id));\n  const sepaSelectedFees = selectedFees.filter(fee => fee.method === \"SEPA\" && fee.status === \"OPEN\" && fee.hasMandate);\n\n  const handleSort = (field: string) => {\n    if (sortBy === field) {\n      setSortOrder(sortOrder === \"asc\" ? \"desc\" : \"asc\");\n    } else {\n      setSortBy(field);\n      setSortOrder(\"asc\");\n    }\n  };\n\n  const handleRowAction = (action: string, fee: Fee) => {\n    switch (action) {\n      case \"markPaid\":\n        handleMarkPaid([fee]);\n        break;\n      case \"viewDetail\":\n        setSelectedFee(fee);\n        setShowDetailDialog(true);\n        break;\n      case \"changeMethod\":\n        setSelectedFee(fee);\n        setShowChangeMethodDialog(true);\n        break;\n      case \"delete\":\n        handleDeleteFee(fee);\n        break;\n    }\n  };\n\n  const markPaidMutation = useMutation({\n    mutationFn: async (feeId: string) => {\n      const response = await apiRequest(\"PUT\", `/api/fees/${feeId}/mark-paid`, {});\n      return response.json();\n    },\n    onSuccess: async (result, feeId) => {\n      // Optimistic update - markeer fee als betaald\n      queryClient.setQueryData([\"/api/fees\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.map((fee: any) => \n          fee.id === feeId ? { ...fee, status: 'PAID', paidDate: new Date().toISOString() } : fee\n        );\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/fees\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Lidgeld gemarkeerd als betaald\",\n        description: \"De betaalstatus is bijgewerkt.\",\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\",\n        title: \"Fout\",\n        description: \"Kon lidgeld niet markeren als betaald.\",\n      });\n    },\n  });\n\n  const deleteFeeMutation = useMutation({\n    mutationFn: async (feeId: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/fees/${feeId}`, {});\n      return response.json();\n    },\n    onSuccess: async (result, feeId) => {\n      // Optimistic update - verwijder fee uit lijst\n      queryClient.setQueryData([\"/api/fees\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.filter((fee: any) => fee.id !== feeId);\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/fees\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Lidgeld verwijderd\",\n        description: \"Het lidgeld is verwijderd.\",\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\", \n        title: \"Fout\",\n        description: \"Kon lidgeld niet verwijderen.\",\n      });\n    },\n  });\n\n  const changeMethodMutation = useMutation({\n    mutationFn: async ({ feeId, method }: { feeId: string; method: string }) => {\n      const response = await apiRequest(\"PUT\", `/api/fees/${feeId}`, { method });\n      return response.json();\n    },\n    onSuccess: async (result, { feeId }) => {\n      // Optimistic update - verander method\n      queryClient.setQueryData([\"/api/fees\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return oldData;\n        return oldData.map((fee: any) => \n          fee.id === feeId ? { ...fee, method: result.method } : fee\n        );\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/fees\"] });\n      setShowChangeMethodDialog(false);\n      toast({\n        title: \"Betaalmethode gewijzigd\",\n        description: \"De betaalmethode is bijgewerkt.\",\n      });\n    },\n    onError: () => {\n      toast({\n        variant: \"destructive\", \n        title: \"Fout\",\n        description: \"Kon betaalmethode niet wijzigen.\",\n      });\n    },\n  });\n\n  const handleMarkPaid = (fees: any[]) => {\n    fees.forEach(fee => markPaidMutation.mutate(fee.id));\n    setSelectedIds(prev => prev.filter(id => !fees.find(f => f.id === id)));\n  };\n\n  const handleDeleteFee = (fee: Fee) => {\n    setSelectedFee(fee);\n    setShowDeleteDialog(true);\n  };\n\n  const confirmDeleteFee = () => {\n    if (selectedFee) {\n      deleteFeeMutation.mutate(selectedFee.id);\n      setShowDeleteDialog(false);\n    }\n  };\n\n  const handleBulkMarkPaid = () => {\n    handleMarkPaid(selectedFees);\n  };\n\n  const handleGenerateSepa = () => {\n    setShowSepaDialog(true);\n  };\n\n  const handleSepaGenerate = (batchRef: string, executionDate: string) => {\n    console.log(\"SEPA batch generated:\", { batchRef, executionDate, fees: sepaSelectedFees });\n    setSelectedIds([]);\n  };\n\n  const handleImport = (matches: any[]) => {\n    console.log(\"Importing payments:\", matches);\n    // In a real app, this would update the fees and call an API\n  };\n\n  const handleExport = () => {\n    // Generate CSV export\n    const csvContent = [\n      [\"Lidnummer\", \"Naam\", \"Periode\", \"Bedrag\", \"Status\", \"Methode\", \"Betaald op\"].join(\",\"),\n      ...filteredFees.map(fee => [\n        fee.memberNumber,\n        `\"${fee.memberFirstName} ${fee.memberLastName}\"`,\n        `\"${fee.periodStart} - ${fee.periodEnd}\"`,\n        fee.amount.toString(),\n        fee.status,\n        fee.method,\n        fee.paidAt || \"\"\n      ].join(\",\"))\n    ].join(\"\\n\");\n\n    const blob = new Blob([csvContent], { type: \"text/csv\" });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = `lidgelden-${new Date().toISOString().split(\"T\")[0]}.csv`;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  };\n\n  const resetAllFilters = () => {\n    setSearchTerm(\"\");\n    setStatusFilter(\"all\");\n    setYearFilter(\"all\");\n    setMethodFilter(\"all\");\n    setCategoryFilter(\"all\");\n    setAmountMin(undefined);\n    setAmountMax(undefined);\n    handlePeriodFromChange(undefined);\n    handlePeriodToChange(undefined);\n    setOnlyWithMandate(false);\n    setOnlyOverdue(false);\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Lidgelden</h1>\n            <p className=\"mt-1 text-sm text-gray-700\">Beheer lidgelden, automatiseer incasso's en volg betalingen op</p>\n          </div>\n        </div>\n\n        {/* KPI Cards */}\n        <KpiCards fees={allFees} />\n\n        {/* Toolbar */}\n        <div className=\"mb-6\">\n          <Toolbar\n            searchTerm={searchTerm}\n            onSearchChange={setSearchTerm}\n            statusFilter={statusFilter}\n            onStatusFilterChange={setStatusFilter}\n            yearFilter={yearFilter}\n            onYearFilterChange={setYearFilter}\n            methodFilter={methodFilter}\n            onMethodFilterChange={setMethodFilter}\n            selectedCount={selectedIds.length}\n            sepaSelectedCount={sepaSelectedFees.length}\n            onExport={handleExport}\n            onImport={() => setShowImportDialog(true)}\n            onGenerateSepa={handleGenerateSepa}\n            onBulkMarkPaid={handleBulkMarkPaid}\n            categoryFilter={categoryFilter}\n            onCategoryFilterChange={setCategoryFilter}\n            amountMin={amountMin}\n            onAmountMinChange={setAmountMin}\n            amountMax={amountMax}\n            onAmountMaxChange={setAmountMax}\n            periodFrom={periodFrom}\n            onPeriodFromChange={handlePeriodFromChange}\n            periodTo={periodTo}\n            onPeriodToChange={handlePeriodToChange}\n            onlyWithMandate={onlyWithMandate}\n            onOnlyWithMandateChange={setOnlyWithMandate}\n            onlyOverdue={onlyOverdue}\n            onOnlyOverdueChange={setOnlyOverdue}\n            onResetFilters={resetAllFilters}\n            newButton={\n              <Button \n                className=\"flex items-center gap-2\"\n                onClick={() => setShowNewFeeDialog(true)}\n              >\n                <Plus className=\"h-4 w-4\" />\n                Nieuw lidgeld\n              </Button>\n            }\n          />\n        </div>\n\n        {/* Table */}\n        <FeesTable\n          fees={paginatedResult.items}\n          total={filteredFees.length}\n          page={page}\n          perPage={perPage}\n          onPageChange={setPage}\n          onPerPageChange={(newPerPage) => {\n            setPerPage(newPerPage);\n            setPage(1);\n          }}\n          selectedIds={selectedIds}\n          onSelectionChange={setSelectedIds}\n          onRowAction={handleRowAction}\n          sortBy={sortBy}\n          sortOrder={sortOrder}\n          onSort={handleSort}\n          loading={isLoading}\n        />\n\n        {/* Dialogs */}\n        {selectedFee && (\n          <FeeDetailDialog\n            fee={{\n              id: selectedFee.id,\n              amountCents: Math.round((selectedFee.amount || 0) * 100),\n              currency: \"EUR\",\n              term: \"MONTHLY\",\n              method: selectedFee.method || null,\n              status: selectedFee.status === \"OPEN\" ? \"OPENSTAAND\" : \n                     selectedFee.status === \"PAID\" ? \"BETAALD\" : \"VERVALLEN\",\n              periodStart: selectedFee.periodStart,\n              periodEnd: selectedFee.periodEnd,\n              paidAt: selectedFee.paidAt || null,\n              sepaBatchRef: selectedFee.sepaBatchRef || null,\n              tenantName: \"DARAH\",\n              member: {\n                id: selectedFee.memberId,\n                firstName: selectedFee.memberFirstName || \"\",\n                lastName: selectedFee.memberLastName || \"\",\n                category: \"STANDAARD\",\n                email: selectedFee.memberEmail || null,\n                phone: selectedFee.memberPhone || null,\n                memberNumber: selectedFee.memberNumber\n              }\n            }}\n            open={showDetailDialog}\n            onOpenChange={(open) => {\n              setShowDetailDialog(open);\n              if (!open) setSelectedFee(null);\n            }}\n            canManage={true}\n            onMarkPaid={async (feeId) => {\n              await handleMarkPaid([selectedFee]);\n            }}\n            onActionSuccess={(msg) => {\n              toast({ title: \"Succes\", description: msg });\n            }}\n            onActionError={(msg) => {\n              toast({ title: \"Fout\", description: msg, variant: \"destructive\" });\n            }}\n          />\n        )}\n\n        <ImportDialog\n          open={showImportDialog}\n          onClose={() => setShowImportDialog(false)}\n          fees={allFees.filter(fee => fee.status === \"OPEN\")}\n          onImport={handleImport}\n        />\n\n        <SepaDialog\n          open={showSepaDialog}\n          onClose={() => setShowSepaDialog(false)}\n          fees={selectedFees}\n          onGenerate={handleSepaGenerate}\n        />\n\n        <NewFeeDialog\n          open={showNewFeeDialog}\n          onOpenChange={setShowNewFeeDialog}\n          onSuccess={() => {\n            // Data wordt automatisch bijgewerkt via optimistic updates\n          }}\n        />\n\n        <Dialog open={showChangeMethodDialog} onOpenChange={setShowChangeMethodDialog}>\n          <DialogContent>\n            <DialogHeader>\n              <DialogTitle>Betaalmethode wijzigen</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <p>Wijzig de betaalmethode voor {selectedFee?.memberName}</p>\n              <Select \n                value={selectedFee?.method}\n                onValueChange={(value) => {\n                  if (selectedFee) {\n                    changeMethodMutation.mutate({ feeId: selectedFee.id, method: value });\n                  }\n                }}\n              >\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Selecteer betaalmethode\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"SEPA\">SEPA</SelectItem>\n                  <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                  <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                  <SelectItem value=\"CASH\">Contant</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </DialogContent>\n        </Dialog>\n\n        <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Lidgeld verwijderen</AlertDialogTitle>\n              <AlertDialogDescription>\n                Weet je zeker dat je het lidgeld voor <strong>{selectedFee?.memberName}</strong> ({selectedFee?.period}) wilt verwijderen? \n                Deze actie kan niet ongedaan worden gemaakt.\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel>Annuleren</AlertDialogCancel>\n              <AlertDialogAction \n                onClick={confirmDeleteFee}\n                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                data-testid=\"button-confirm-delete\"\n              >\n                Verwijderen\n              </AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n      </div>\n    </main>\n  );\n}","size_bytes":20019},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Building2, Mail, Lock, Eye, EyeOff, X } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport backgroundImage from \"@assets/Luxury Navy Background_1757015851301.jpg\";\nimport idarahLogo from \"@assets/idarah (2)_1757094634426.png\";\n\nexport default function Login() {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [showResetDialog, setShowResetDialog] = useState(false);\n  const [resetEmail, setResetEmail] = useState(\"\");\n  const [isResetting, setIsResetting] = useState(false);\n  const [resetError, setResetError] = useState(\"\");\n  const { login } = useAuth();\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    setError(\"\");\n\n    const result = await login(email, password);\n    \n    if (result.success) {\n      toast({\n        title: \"Succesvol ingelogd\",\n        description: \"Welkom terug!\",\n      });\n      setLocation(\"/dashboard\");\n    } else {\n      setError(result.message || \"Inloggen mislukt. Controleer uw gegevens.\");\n    }\n    \n    setIsLoading(false);\n  };\n\n  const handlePasswordReset = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsResetting(true);\n    setResetError(\"\");\n\n    try {\n      const response = await apiRequest(\"POST\", \"/api/auth/reset-password\", {\n        email: resetEmail\n      });\n\n      if (response.ok) {\n        toast({\n          title: \"Wachtwoord reset aangevraagd\",\n          description: \"Er is een nieuw wachtwoord naar uw e-mailadres gestuurd.\",\n        });\n        setShowResetDialog(false);\n        setResetEmail(\"\");\n      } else {\n        const errorData = await response.json();\n        setResetError(errorData.message || \"Er is een fout opgetreden bij het resetten van uw wachtwoord.\");\n      }\n    } catch (error) {\n      setResetError(\"Er is een fout opgetreden. Probeer het later opnieuw.\");\n    }\n\n    setIsResetting(false);\n  };\n\n  return (\n    <div \n      className=\"min-h-screen flex flex-col lg:flex-row\"\n      style={{\n        backgroundImage: `url(\"${backgroundImage}\")`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n        backgroundRepeat: 'no-repeat'\n      }}\n    >\n      {/* Background overlay */}\n      <div className=\"absolute inset-0 bg-black/30\"></div>\n      \n\n      {/* Login form section - Bottom on mobile, Right on desktop */}\n      <div className=\"flex-1 flex flex-col justify-center px-6 sm:px-8 lg:pl-8 lg:pr-16 relative z-10\">\n        <div className=\"max-w-md mx-auto w-full\">\n          {/* Logo above title */}\n          <div className=\"flex justify-center mb-6\">\n            <img \n              src={idarahLogo} \n              alt=\"IDARAH Logo\" \n              className=\"h-20 sm:h-24 lg:h-28 w-auto object-contain scale-[4]\"\n            />\n          </div>\n          \n          {/* Title above login container */}\n          <h1 className=\"text-lg sm:text-xl lg:text-2xl font-bold text-white mb-6 leading-tight text-center\">\n            Inloggen bij uw account\n          </h1>\n          \n          <div className=\"bg-white rounded-3xl shadow-2xl p-6 sm:p-8\">\n            <form onSubmit={handleSubmit} className=\"space-y-6\" data-testid=\"login-form\">\n              {error && (\n                <Alert variant=\"destructive\" data-testid=\"login-error\">\n                  <AlertDescription>{error}</AlertDescription>\n                </Alert>\n              )}\n\n              <div>\n                <Label htmlFor=\"email\" className=\"text-gray-700 font-medium\">E-mailadres</Label>\n                <div className=\"mt-2\">\n                  <Input\n                    id=\"email\"\n                    name=\"email\"\n                    type=\"email\"\n                    autoComplete=\"email\"\n                    required\n                    className=\"h-12 px-4 bg-gray-50 border-gray-200 rounded-xl focus:bg-white focus:border-blue-500 focus:ring-blue-500\"\n                    placeholder=\"naam@moskee.be\"\n                    value={email}\n                    onChange={(e) => setEmail(e.target.value)}\n                    data-testid=\"input-email\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <Label htmlFor=\"password\" className=\"text-gray-700 font-medium\">Wachtwoord</Label>\n                <div className=\"mt-2 relative\">\n                  <Input\n                    id=\"password\"\n                    name=\"password\"\n                    type={showPassword ? \"text\" : \"password\"}\n                    autoComplete=\"current-password\"\n                    required\n                    className=\"h-12 px-4 pr-12 bg-gray-50 border-gray-200 rounded-xl focus:bg-white focus:border-blue-500 focus:ring-blue-500\"\n                    placeholder=\"Uw wachtwoord\"\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    data-testid=\"input-password\"\n                  />\n                  <button\n                    type=\"button\"\n                    className=\"absolute inset-y-0 right-0 pr-4 flex items-center\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    data-testid=\"toggle-password\"\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-5 w-5 text-gray-400 hover:text-gray-600\" />\n                    ) : (\n                      <Eye className=\"h-5 w-5 text-gray-400 hover:text-gray-600\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end text-sm\">\n                <button \n                  type=\"button\"\n                  onClick={() => setShowResetDialog(true)}\n                  className=\"text-blue-600 hover:text-blue-700 font-medium\"\n                  data-testid=\"forgot-password-link\"\n                >\n                  Wachtwoord vergeten?\n                </button>\n              </div>\n\n              <Button\n                type=\"submit\"\n                className=\"w-full h-12 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg transition-all duration-200\"\n                disabled={isLoading}\n                data-testid=\"button-login\"\n              >\n                {isLoading ? \"Bezig met inloggen...\" : \"Inloggen\"}\n              </Button>\n            </form>\n          </div>\n        </div>\n      </div>\n\n      {/* Password Reset Dialog */}\n      <Dialog open={showResetDialog} onOpenChange={setShowResetDialog}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"text-xl font-bold text-gray-900\">\n              Wachtwoord resetten\n            </DialogTitle>\n            <DialogDescription className=\"text-gray-600\">\n              Voer uw e-mailadres in en we sturen u een nieuw wachtwoord toe.\n            </DialogDescription>\n          </DialogHeader>\n          \n          <form onSubmit={handlePasswordReset} className=\"space-y-4\">\n            {resetError && (\n              <Alert variant=\"destructive\" data-testid=\"reset-error\">\n                <AlertDescription>{resetError}</AlertDescription>\n              </Alert>\n            )}\n            \n            <div>\n              <Label htmlFor=\"reset-email\" className=\"text-gray-700 font-medium\">\n                E-mailadres\n              </Label>\n              <div className=\"mt-2\">\n                <Input\n                  id=\"reset-email\"\n                  name=\"reset-email\"\n                  type=\"email\"\n                  autoComplete=\"email\"\n                  required\n                  className=\"h-11 px-3 bg-gray-50 border-gray-200 rounded-lg focus:bg-white focus:border-blue-500 focus:ring-blue-500\"\n                  placeholder=\"naam@moskee.be\"\n                  value={resetEmail}\n                  onChange={(e) => setResetEmail(e.target.value)}\n                  data-testid=\"input-reset-email\"\n                />\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                className=\"flex-1\"\n                onClick={() => {\n                  setShowResetDialog(false);\n                  setResetEmail(\"\");\n                  setResetError(\"\");\n                }}\n                data-testid=\"button-cancel-reset\"\n              >\n                Annuleren\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"flex-1 bg-blue-600 hover:bg-blue-700\"\n                disabled={isResetting}\n                data-testid=\"button-submit-reset\"\n              >\n                {isResetting ? \"Bezig...\" : \"Nieuw wachtwoord aanvragen\"}\n              </Button>\n            </div>\n          </form>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":9627},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/pages/publieke-schermen.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useQueryClient, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Monitor, Plus, Power } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ScreenWizard } from \"@/components/public-screens/wizard/ScreenWizard\";\nimport { ScreenCard } from \"@/components/public-screens/ScreenCard\";\n// Removed EditScreenModal import - using ScreenWizard for editing\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function PubliekeSchermen() {\n  const [showNewScreenDialog, setShowNewScreenDialog] = useState(false);\n  const [editingScreen, setEditingScreen] = useState<any>(null);\n  const [wizardMode, setWizardMode] = useState<'create' | 'edit'>('create');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: screens, isLoading } = useQuery({\n    queryKey: [\"/api/public-screens\"],\n  });\n\n  const { data: announcements } = useQuery({\n    queryKey: [\"/api/announcements\"],\n  });\n\n  const handleCreateScreen = async (screenData: {\n    name: string;\n    type: any;\n    config: any;\n  }) => {\n    try {\n      const token = localStorage.getItem(\"authToken\");\n      if (!token) {\n        throw new Error('Not authenticated');\n      }\n\n      const response = await fetch('/api/public-screens', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`,\n        },\n        body: JSON.stringify({\n          name: screenData.name,\n          type: screenData.type,\n          active: true,\n          config: screenData.config\n        }),\n      });\n\n      if (response.ok) {\n        const screen = await response.json();\n        toast({\n          title: \"Scherm aangemaakt\",\n          description: `${screen.name} is succesvol aangemaakt.`,\n        });\n        \n        // Invalidate and refetch the screens data\n        await queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n        await queryClient.refetchQueries({ queryKey: [\"/api/public-screens\"] });\n        setShowNewScreenDialog(false);\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Failed to create screen');\n      }\n    } catch (error: any) {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het aanmaken van het scherm.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const toggleScreenMutation = useMutation({\n    mutationFn: async ({ id, active }: { id: string; active: boolean }) => {\n      const response = await apiRequest(\"PUT\", `/api/public-screens/${id}`, { active });\n      return response.json();\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/public-screens\"] });\n      toast({\n        title: \"Status gewijzigd\",\n        description: \"De schermstatus is bijgewerkt.\",\n      });\n    },\n  });\n\n  const deleteScreenMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/public-screens/${id}`);\n      return response.json();\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/public-screens\"] });\n      toast({\n        title: \"Scherm verwijderd\",\n        description: \"Het scherm is succesvol verwijderd.\",\n      });\n    },\n  });\n\n\n  if (isLoading) {\n    return (\n          <main className=\"flex-1 py-8\">\n            <div className=\"px-4 sm:px-6 lg:px-8\">\n              <div className=\"animate-pulse space-y-4\">\n                <div className=\"h-8 bg-gray-200 rounded w-1/4\"></div>\n                <div className=\"h-32 bg-gray-200 rounded\"></div>\n                <div className=\"h-64 bg-gray-200 rounded\"></div>\n              </div>\n            </div>\n          </main>\n    );\n  }\n\n  return (\n        <main className=\"flex-1 py-8\">\n          <div className=\"px-4 sm:px-6 lg:px-8\">\n            {/* Page Header */}\n            <div className=\"border-b border-gray-200 pb-5 mb-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Publieke Schermen</h1>\n                  <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer informatiedisplays en digitale mededelingenborden</p>\n                </div>\n                <Button \n                  onClick={() => {\n                    setEditingScreen(null);\n                    setWizardMode('create');\n                    setShowNewScreenDialog(true);\n                  }}\n                  className=\"gap-2\"\n                  data-testid=\"button-new-screen\"\n                >\n                  <Plus className=\"w-4 h-4\" />\n                  Nieuw Scherm\n                </Button>\n              </div>\n            </div>\n\n            <Tabs defaultValue=\"screens\" className=\"space-y-6\">\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"screens\" data-testid=\"tab-screens\">Schermen</TabsTrigger>\n                <TabsTrigger value=\"announcements\" data-testid=\"tab-announcements\">Mededelingen</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"screens\" className=\"space-y-6\">\n                {/* Stats Cards */}\n                <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n                  <Card>\n                    <CardContent className=\"px-6 py-6\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0\">\n                          <div className=\"w-8 h-8 bg-blue-100 rounded-xl flex items-center justify-center\">\n                            <Monitor className=\"h-5 w-5 text-blue-600\" />\n                          </div>\n                        </div>\n                        <div className=\"ml-4 w-0 flex-1\">\n                          <dl>\n                            <dt className=\"text-sm font-medium text-gray-500 truncate\">Totaal Schermen</dt>\n                            <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"total-screens\">{Array.isArray(screens) ? screens.length : 0}</dd>\n                          </dl>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"px-6 py-6\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0\">\n                          <div className=\"w-8 h-8 bg-green-100 rounded-xl flex items-center justify-center\">\n                            <Power className=\"h-5 w-5 text-green-600\" />\n                          </div>\n                        </div>\n                        <div className=\"ml-4 w-0 flex-1\">\n                          <dl>\n                            <dt className=\"text-sm font-medium text-gray-500 truncate\">Actieve Schermen</dt>\n                            <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"active-screens\">\n                              {Array.isArray(screens) ? screens.filter((s: any) => s.active).length : 0}\n                            </dd>\n                          </dl>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"px-6 py-6\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0\">\n                          <div className=\"w-8 h-8 bg-purple-100 rounded-xl flex items-center justify-center\">\n                            <Monitor className=\"h-5 w-5 text-purple-600\" />\n                          </div>\n                        </div>\n                        <div className=\"ml-4 w-0 flex-1\">\n                          <dl>\n                            <dt className=\"text-sm font-medium text-gray-500 truncate\">Betaalstatus Schermen</dt>\n                            <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"payment-screens\">\n                              {Array.isArray(screens) ? screens.filter((s: any) => s.type === 'BETAALSTATUS').length : 0}\n                            </dd>\n                          </dl>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n\n                  <Card>\n                    <CardContent className=\"px-6 py-6\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0\">\n                          <div className=\"w-8 h-8 bg-orange-100 rounded-xl flex items-center justify-center\">\n                            <Monitor className=\"h-5 w-5 text-orange-600\" />\n                          </div>\n                        </div>\n                        <div className=\"ml-4 w-0 flex-1\">\n                          <dl>\n                            <dt className=\"text-sm font-medium text-gray-500 truncate\">Mededelingen Schermen</dt>\n                            <dd className=\"text-2xl font-bold text-gray-900\" data-testid=\"announcement-screens\">\n                              {Array.isArray(screens) ? screens.filter((s: any) => s.type === 'MEDEDELINGEN').length : 0}\n                            </dd>\n                          </dl>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </div>\n\n                {/* Screens List */}\n                <div className=\"space-y-6\">\n                  {!Array.isArray(screens) || screens.length === 0 ? (\n                    <Card>\n                      <CardContent className=\"p-6 text-center text-gray-500\" data-testid=\"no-screens\">\n                        Nog geen publieke schermen geconfigureerd\n                      </CardContent>\n                    </Card>\n                  ) : (\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                      {(screens as any[]).map((screen: any) => (\n                        <ScreenCard\n                          key={screen.id}\n                          screen={screen}\n                          onToggleStatus={() => toggleScreenMutation.mutate({ id: screen.id, active: !screen.active })}\n                          onDelete={() => deleteScreenMutation.mutate(screen.id)}\n                        />\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"announcements\" className=\"space-y-6\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between\">\n                    <div>\n                      <CardTitle>Mededelingen Beheer</CardTitle>\n                      <p className=\"text-sm text-gray-500\">Beheer content voor mededelingenborden</p>\n                    </div>\n                    <Button data-testid=\"button-new-announcement\">\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Nieuwe Mededeling\n                    </Button>\n                  </CardHeader>\n                  \n                  <CardContent>\n                    {!Array.isArray(announcements) || announcements.length === 0 ? (\n                      <div className=\"p-6 text-center text-gray-500\" data-testid=\"no-announcements\">\n                        Nog geen mededelingen toegevoegd\n                      </div>\n                    ) : (\n                      <div className=\"space-y-4\">\n                        {(announcements as any[]).map((announcement: any) => (\n                          <div key={announcement.id} className=\"p-4 border border-gray-200 rounded-xl\" data-testid={`announcement-item-${announcement.id}`}>\n                            <div className=\"flex items-start justify-between\">\n                              <div className=\"flex-1\">\n                                <h4 className=\"font-semibold text-gray-900\" data-testid={`announcement-title-${announcement.id}`}>\n                                  {announcement.title}\n                                </h4>\n                                {announcement.richText && (\n                                  <p className=\"text-sm text-gray-600 mt-1\" data-testid={`announcement-content-${announcement.id}`}>\n                                    {announcement.richText.substring(0, 150)}...\n                                  </p>\n                                )}\n                                <div className=\"flex items-center space-x-2 mt-2\">\n                                  <Badge \n                                    variant={announcement.active ? 'default' : 'destructive'}\n                                    className={announcement.active ? 'bg-green-100 text-green-800 hover:bg-green-100' : ''}\n                                  >\n                                    {announcement.active ? 'Actief' : 'Inactief'}\n                                  </Badge>\n                                  {announcement.validFrom && announcement.validTo && (\n                                    <span className=\"text-xs text-gray-500\">\n                                      Geldig: {new Date(announcement.validFrom).toLocaleString('nl-NL')} - {new Date(announcement.validTo).toLocaleString('nl-NL')}\n                                    </span>\n                                  )}\n                                </div>\n                              </div>\n                              <div className=\"flex items-center space-x-2 ml-4\">\n                                <Button variant=\"outline\" size=\"sm\">\n                                  Bewerken\n                                </Button>\n                                <Button variant=\"outline\" size=\"sm\">\n                                  Verwijderen\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n            </Tabs>\n          </div>\n\n          {/* Screen Wizard - handles both create and edit */}\n          <ScreenWizard\n            open={showNewScreenDialog}\n            onOpenChange={(open) => {\n              setShowNewScreenDialog(open);\n              if (!open) {\n                setEditingScreen(null);\n                setWizardMode('create');\n              }\n            }}\n            onComplete={(screenData) => {\n              if (wizardMode === 'edit' && editingScreen) {\n                // Handle edit mode\n                const updateScreen = async () => {\n                  try {\n                    await apiRequest('PUT', `/api/public-screens/${editingScreen.id}`, {\n                      name: screenData.name,\n                      config: screenData.config\n                    });\n                    \n                    queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n                    toast({\n                      title: \"Scherm bijgewerkt\",\n                      description: `${screenData.name} is succesvol bijgewerkt.`,\n                    });\n                  } catch (error: any) {\n                    toast({\n                      title: \"Fout\",\n                      description: error.message || \"Er is een fout opgetreden bij het bijwerken van het scherm.\",\n                      variant: \"destructive\",\n                    });\n                  }\n                };\n                updateScreen();\n              } else {\n                // Handle create mode\n                handleCreateScreen(screenData);\n              }\n            }}\n            editingScreen={editingScreen}\n            mode={wizardMode}\n          />\n\n        </main>\n  );\n}\n","size_bytes":16454},"client/src/components/dashboard/kpi-cards.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { StatsCard } from \"@/components/ui/stats-card\";\nimport { Users, UserCheck, Euro, Clock } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport default function KpiCards() {\n  const { data: stats, isLoading } = useQuery({\n    queryKey: [\"/api/dashboard/stats\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n        {[...Array(4)].map((_, i) => (\n          <Skeleton key={i} className=\"h-32 rounded-2xl\" />\n        ))}\n      </div>\n    );\n  }\n\n  if (!stats) {\n    return (\n      <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n        <div className=\"text-center py-8 text-gray-500\" data-testid=\"stats-error\">\n          Fout bij het laden van statistieken\n        </div>\n      </div>\n    );\n  }\n\n  const mockStats = stats || {\n    totalMembers: 0,\n    activeMembers: 0,\n    totalRevenue: 0,\n    outstanding: 0\n  };\n\n  const activePercentage = mockStats.totalMembers > 0 ? ((mockStats.activeMembers / mockStats.totalMembers) * 100).toFixed(1) : \"0\";\n\n  return (\n    <div className=\"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-8\">\n      <StatsCard\n        title=\"Totaal Leden\"\n        value={mockStats.totalMembers.toLocaleString(\"nl-BE\")}\n        trend={{ value: \"+12% deze maand\", positive: true }}\n        icon={<Users className=\"h-5 w-5 text-secondary\" />}\n        iconBgColor=\"bg-secondary/10\"\n      />\n\n      <StatsCard\n        title=\"Actieve Leden\"\n        value={mockStats.activeMembers.toLocaleString(\"nl-BE\")}\n        trend={{ value: `${activePercentage}% van totaal`, positive: true }}\n        icon={<UserCheck className=\"h-5 w-5 text-primary\" />}\n        iconBgColor=\"bg-primary/10\"\n      />\n\n      <StatsCard\n        title=\"Totaal Ontvangen\"\n        value={`€${mockStats.totalRevenue.toLocaleString(\"nl-BE\")}`}\n        trend={{ value: \"+8% deze maand\", positive: true }}\n        icon={<Euro className=\"h-5 w-5 text-success\" />}\n        iconBgColor=\"bg-success/10\"\n      />\n\n      <StatsCard\n        title=\"Openstaand\"\n        value={`€${mockStats.outstanding.toLocaleString(\"nl-BE\")}`}\n        trend={{ value: \"-3% deze maand\", positive: true }}\n        icon={<Clock className=\"h-5 w-5 text-warning\" />}\n        iconBgColor=\"bg-warning/10\"\n      />\n    </div>\n  );\n}\n","size_bytes":2382},"client/src/components/dashboard/recent-members.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardHeader, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { getUserInitials } from \"@/lib/auth\";\nimport { MoreVertical, Users } from \"lucide-react\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { Link } from \"wouter\";\n\nexport default function RecentMembers() {\n  const { data: members, isLoading } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">Recente Leden</h3>\n              <p className=\"text-sm text-gray-500\">Nieuw toegevoegde leden deze week</p>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {[...Array(3)].map((_, i) => (\n              <div key={i} className=\"animate-pulse\">\n                <div className=\"flex items-center space-x-4\">\n                  <div className=\"w-10 h-10 bg-gray-200 rounded-full\"></div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\n                    <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  const recentMembers = (members as any[])?.slice(0, 5) || [];\n\n  return (\n    <Card data-testid=\"recent-members-card\">\n      <CardHeader className=\"px-6 py-6 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">Recente Leden</h3>\n            <p className=\"text-sm text-gray-500\">Nieuw toegevoegde leden deze week</p>\n          </div>\n          <Link href=\"/leden\">\n            <Button variant=\"ghost\" size=\"sm\" className=\"text-sm font-medium text-primary hover:text-primary/80\" data-testid=\"view-all-members\">\n              Alle leden bekijken\n            </Button>\n          </Link>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"p-0\">\n        {recentMembers.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\" data-testid=\"no-recent-members\">\n            <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n              <Users className=\"w-8 h-8 text-gray-400\" />\n            </div>\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n              Geen recente leden gevonden\n            </h3>\n            <p className=\"text-gray-500 dark:text-gray-400 max-w-sm\">\n              Voeg je eerste lid toe om recente activiteit te zien.\n            </p>\n          </div>\n        ) : (\n          <div className=\"overflow-hidden\">\n            <table className=\"min-w-full divide-y divide-gray-200\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Lid</th>\n                  <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Lidnummer</th>\n                  <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Categorie</th>\n                  <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Status</th>\n                  <th scope=\"col\" className=\"sticky top-0 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Toegevoegd</th>\n                  <th scope=\"col\" className=\"sticky top-0 relative px-6 py-3\"><span className=\"sr-only\">Acties</span></th>\n                </tr>\n              </thead>\n              <tbody className=\"bg-white divide-y divide-gray-200\">\n                {recentMembers.map((member) => (\n                  <tr key={member.id} className=\"hover:bg-gray-50\" data-testid={`member-row-${member.id}`}>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 h-10 w-10\">\n                          <div className=\"h-10 w-10 rounded-full bg-primary flex items-center justify-center\">\n                            <span className=\"text-sm font-medium text-primary-foreground\">\n                              {getUserInitials(`${member.firstName} ${member.lastName}`)}\n                            </span>\n                          </div>\n                        </div>\n                        <div className=\"ml-4\">\n                          <div className=\"text-sm font-medium text-gray-900\" data-testid={`member-name-${member.id}`}>\n                            {member.firstName} {member.lastName}\n                          </div>\n                          {member.email && (\n                            <div className=\"text-sm text-gray-500\" data-testid={`member-email-${member.id}`}>\n                              {member.email}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\" data-testid={`member-number-${member.id}`}>\n                      {member.memberNumber}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <Badge \n                        variant={member.category === 'STUDENT' ? 'secondary' : member.category === 'SENIOR' ? 'outline' : 'default'}\n                        data-testid={`member-category-${member.id}`}\n                      >\n                        {member.category}\n                      </Badge>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap\">\n                      <Badge \n                        variant={member.active ? 'default' : 'destructive'}\n                        className={member.active ? 'bg-green-100 text-green-800 hover:bg-green-100' : ''}\n                        data-testid={`member-status-${member.id}`}\n                      >\n                        <div className={`w-1.5 h-1.5 rounded-full mr-1.5 ${member.active ? 'bg-green-500' : 'bg-red-500'}`}></div>\n                        {member.active ? 'Actief' : 'Inactief'}\n                      </Badge>\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\" data-testid={`member-created-${member.id}`}>\n                      {formatDistanceToNow(new Date(member.createdAt), { addSuffix: true, locale: nl })}\n                    </td>\n                    <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                      <Button variant=\"ghost\" size=\"sm\" className=\"text-gray-400 hover:text-gray-500\" data-testid={`member-actions-${member.id}`}>\n                        <MoreVertical className=\"h-5 w-5\" />\n                      </Button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":7616},"client/src/components/forms/fee-form.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useMutation, useQueryClient, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { X } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nconst feeSchema = z.object({\n  memberId: z.string().min(1, \"Lid is verplicht\"),\n  periodStart: z.string().min(1, \"Startdatum is verplicht\"),\n  periodEnd: z.string().min(1, \"Einddatum is verplicht\"),\n  amount: z.string().min(1, \"Bedrag is verplicht\").refine((val) => !isNaN(parseFloat(val)), \"Ongeldig bedrag\"),\n  method: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']).optional(),\n});\n\ntype FeeFormData = z.infer<typeof feeSchema>;\n\ninterface FeeFormProps {\n  onSuccess?: () => void;\n  onCancel?: () => void;\n  selectedMemberId?: string;\n}\n\nexport function FeeForm({ onSuccess, onCancel, selectedMemberId }: FeeFormProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const { data: members } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n\n  const form = useForm<FeeFormData>({\n    resolver: zodResolver(feeSchema),\n    defaultValues: {\n      memberId: selectedMemberId || \"\",\n      periodStart: format(new Date(), 'yyyy-MM-dd'),\n      periodEnd: format(new Date(new Date().getFullYear(), new Date().getMonth() + 1, 0), 'yyyy-MM-dd'),\n      amount: \"25.00\",\n    },\n  });\n\n  const createFeeMutation = useMutation({\n    mutationFn: async (data: FeeFormData) => {\n      const feeData = {\n        ...data,\n        periodStart: new Date(data.periodStart),\n        periodEnd: new Date(data.periodEnd),\n        amount: data.amount,\n      };\n      const response = await apiRequest(\"POST\", \"/api/fees\", feeData);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/fees\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Lidgeld aangemaakt\",\n        description: \"Het lidgeld is succesvol toegevoegd.\",\n      });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij aanmaken\",\n        description: error.message || \"Er is een fout opgetreden bij het aanmaken van het lidgeld.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: FeeFormData) => {\n    createFeeMutation.mutate(data);\n  };\n\n  return (\n    <Card className=\"w-full max-w-2xl mx-auto\">\n      <CardHeader className=\"flex flex-row items-center justify-between\">\n        <CardTitle>Nieuw Lidgeld Toevoegen</CardTitle>\n        {onCancel && (\n          <Button variant=\"ghost\" size=\"sm\" onClick={onCancel} data-testid=\"button-cancel\">\n            <X className=\"h-4 w-4\" />\n          </Button>\n        )}\n      </CardHeader>\n      <CardContent>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <FormField\n              control={form.control}\n              name=\"memberId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Lid</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-member\">\n                        <SelectValue placeholder=\"Selecteer een lid\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {members?.map((member: any) => (\n                        <SelectItem key={member.id} value={member.id}>\n                          {member.firstName} {member.lastName} ({member.memberNumber})\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"periodStart\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Startdatum</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-period-start\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"periodEnd\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Einddatum</FormLabel>\n                    <FormControl>\n                      <Input type=\"date\" {...field} data-testid=\"input-period-end\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"amount\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Bedrag (€)</FormLabel>\n                  <FormControl>\n                    <Input type=\"number\" step=\"0.01\" placeholder=\"25.00\" {...field} data-testid=\"input-amount\" />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"method\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Betaalmethode (optioneel)</FormLabel>\n                  <Select onValueChange={field.onChange} value={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-payment-method\">\n                        <SelectValue placeholder=\"Selecteer betaalmethode\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"SEPA\">SEPA Incasso</SelectItem>\n                      <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                      <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                      <SelectItem value=\"CASH\">Contant</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-2 pt-6 border-t\">\n              {onCancel && (\n                <Button type=\"button\" variant=\"outline\" onClick={onCancel} data-testid=\"button-cancel-form\">\n                  Annuleren\n                </Button>\n              )}\n              <Button\n                type=\"submit\"\n                disabled={createFeeMutation.isPending}\n                data-testid=\"button-submit\"\n              >\n                {createFeeMutation.isPending ? \"Lidgeld wordt aangemaakt...\" : \"Lidgeld Aanmaken\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":7636},"client/src/components/forms/member-form.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { CalendarIcon } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\nimport { MdOutlinePermIdentity } from \"react-icons/md\";\nimport { GoHome } from \"react-icons/go\";\nimport { CiBank } from \"react-icons/ci\";\nimport { BsBuildings } from \"react-icons/bs\";\nimport { RiCheckboxMultipleLine } from \"react-icons/ri\";\nimport { IdCard } from \"lucide-react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Member, MemberFinancialSettings, MemberPermissions } from \"@shared/schema\";\nimport { useRuleValidation } from \"@/hooks/useRuleValidation\";\nimport { RuleWarning } from \"@/components/ui/rule-warning\";\nimport { RuleOverrideDialog } from \"@/components/forms/rule-override-dialog\";\n\n// Extended member type that includes related data\ninterface MemberWithDetails extends Member {\n  financialSettings?: MemberFinancialSettings;\n  permissions?: {\n    privacyAgreement: boolean;\n    photoVideoConsent: boolean;\n    newsletterSubscription: boolean;\n    whatsappList: boolean;\n    interestedInActiveRole: boolean;\n    roleDescription?: string;\n  };\n}\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from \"@/components/ui/dialog\";\nimport { AlertTriangle } from \"lucide-react\";\n\n\nconst memberSchema = z.object({\n  firstName: z.string().min(1, \"Voornaam is verplicht\"),\n  lastName: z.string().min(1, \"Achternaam is verplicht\"),\n  gender: z.enum(['M', 'V'], { required_error: \"Geslacht is verplicht\" }),\n  dateOfBirth: z.date({ required_error: \"Geboortedatum is verplicht\" })\n    .refine((date) => date <= new Date(), \"Geboortedatum kan niet in de toekomst liggen\")\n    .refine((date) => {\n      const age = new Date().getFullYear() - date.getFullYear();\n      return age <= 150;\n    }, \"Geboortedatum is niet realistisch\"),\n  category: z.enum(['STUDENT', 'STANDAARD', 'SENIOR'], { required_error: \"Categorie is verplicht\" }),\n  email: z.string()\n    .optional()\n    .or(z.literal(\"\"))\n    .refine((email) => {\n      if (!email || email === \"\") return true;\n      // Strikte email validatie\n      const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n      return emailRegex.test(email);\n    }, \"Ongeldig e-mailadres format\"),\n  phone: z.string()\n    .optional()\n    .refine((phone) => {\n      if (!phone || phone === \"\") return true;\n      // Belgisch/Nederlands telefoonnummer validatie\n      const phoneRegex = /^(\\+32|0032|0)[1-9]\\d{7,8}$|^(\\+31|0031|0)[1-9]\\d{7,8}$/;\n      // Ook accept internationale formaten\n      const internationalRegex = /^\\+[1-9]\\d{1,14}$/;\n      const cleanPhone = phone.replace(/[\\s\\-\\(\\)]/g, '');\n      return phoneRegex.test(cleanPhone) || internationalRegex.test(cleanPhone);\n    }, \"Ongeldig telefoonnummer format (Belgisch/Nederlands of internationaal format verwacht)\"),\n  street: z.string().min(1, \"Straat is verplicht\"),\n  number: z.string().min(1, \"Nummer is verplicht\"),\n  bus: z.string().optional(),\n  postalCode: z.string().min(1, \"Postcode is verplicht\"),\n  city: z.string().min(1, \"Stad is verplicht\"),\n  country: z.string().min(1, \"Land is verplicht\").default(\"België\"),\n  financialSettings: z.object({\n    paymentMethod: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']),\n    iban: z.string().optional(),\n    paymentTerm: z.enum(['MONTHLY', 'YEARLY']),\n  }),\n  organization: z.object({\n    interestedInActiveRole: z.boolean().default(false),\n    roleDescription: z.string().optional(),\n    votingEligible: z.boolean().default(false),\n  }),\n  permissions: z.object({\n    privacyAgreement: z.boolean().refine(val => val === true, \"Akkoord met privacyverklaring is verplicht\"),\n    photoVideoConsent: z.boolean().default(false),\n    newsletterSubscription: z.boolean().default(false),\n    whatsappList: z.boolean().default(false),\n  }),\n}).refine((data) => {\n  // IBAN is alleen verplicht voor SEPA en Overschrijving\n  if ((data.financialSettings.paymentMethod === 'SEPA' || data.financialSettings.paymentMethod === 'OVERSCHRIJVING') && !data.financialSettings.iban) {\n    return false;\n  }\n  return true;\n}, {\n  message: \"IBAN is verplicht voor SEPA en Overschrijving\",\n  path: [\"financialSettings\", \"iban\"],\n});\n\ntype MemberFormData = z.infer<typeof memberSchema>;\n\ninterface MemberFormProps {\n  member?: MemberWithDetails;\n  onSuccess?: () => void;\n  onCancel?: () => void;\n}\n\nexport function MemberForm({ member, onSuccess, onCancel }: MemberFormProps) {\n  const [activeTab, setActiveTab] = useState(\"personal\");\n  const [isScanning, setIsScanning] = useState(false);\n  const [showDuplicateWarning, setShowDuplicateWarning] = useState(false);\n  const [duplicateInfo, setDuplicateInfo] = useState<any>(null);\n  const [pendingData, setPendingData] = useState<MemberFormData | null>(null);\n  const [showVotingOverrideDialog, setShowVotingOverrideDialog] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { validateVotingRights } = useRuleValidation();\n\n  // Build default values based on whether we're editing or creating\n  const getDefaultValues = (): Partial<MemberFormData> => {\n    if (member) {\n      // Parse member data for editing - use all actual member data\n      const street = member.street || '';\n      const number = member.number || '';\n      const bus = member.bus || '';\n      \n      return {\n        firstName: member.firstName || '',\n        lastName: member.lastName || '',\n        gender: (member.gender as 'M' | 'V') || 'M',\n        dateOfBirth: member.birthDate ? new Date(member.birthDate) : undefined,\n        category: member.category || 'STANDAARD',\n        email: member.email || '',\n        phone: member.phone || '',\n        street: street,\n        number: number,\n        bus: bus,\n        postalCode: member.postalCode || '',\n        city: member.city || '',\n        country: member.country || 'België',\n        financialSettings: {\n          paymentMethod: member.financialSettings?.paymentMethod || 'SEPA' as const,\n          iban: member.financialSettings?.iban || '',\n          paymentTerm: member.financialSettings?.paymentTerm || 'YEARLY' as const,\n        },\n        organization: {\n          interestedInActiveRole: member.permissions?.interestedInActiveRole || false,\n          roleDescription: member.permissions?.roleDescription || '',\n          votingEligible: false,\n        },\n        permissions: {\n          privacyAgreement: member.permissions?.privacyAgreement || false,\n          photoVideoConsent: member.permissions?.photoVideoConsent || false,\n          newsletterSubscription: member.permissions?.newsletterSubscription || false,\n          whatsappList: member.permissions?.whatsappList || false,\n        },\n      };\n    }\n    \n    // Default values for new member\n    return {\n      firstName: '',\n      lastName: '',\n      gender: 'M',\n      category: 'STANDAARD',\n      email: '',\n      phone: '',\n      street: '',\n      number: '',\n      bus: '',\n      postalCode: '',\n      city: '',\n      country: 'België',\n      financialSettings: {\n        paymentMethod: 'SEPA',\n        iban: '',\n        paymentTerm: 'YEARLY',\n      },\n      organization: {\n        interestedInActiveRole: false,\n        roleDescription: '',\n        votingEligible: false,\n      },\n      permissions: {\n        privacyAgreement: false,\n        photoVideoConsent: false,\n        newsletterSubscription: false,\n        whatsappList: false,\n      },\n    };\n  };\n\n  const form = useForm<MemberFormData>({\n    resolver: zodResolver(memberSchema),\n    defaultValues: getDefaultValues(),\n  });\n\n  // Functie om te controleren of een tab fouten heeft\n  const hasTabErrors = (tabName: string) => {\n    const errors = form.formState.errors;\n    \n    switch (tabName) {\n      case \"personal\":\n        return !!(errors.firstName || errors.lastName || errors.gender || errors.dateOfBirth || errors.category || errors.email || errors.phone);\n      case \"address\":\n        return !!(errors.street || errors.number || errors.postalCode || errors.city || errors.country);\n      case \"financial\":\n        return !!(errors.financialSettings?.paymentMethod || errors.financialSettings?.iban || errors.financialSettings?.paymentTerm);\n      case \"organization\":\n        return !!(errors.organization?.interestedInActiveRole || errors.organization?.roleDescription);\n      case \"permissions\":\n        return !!(errors.permissions?.privacyAgreement || errors.permissions?.photoVideoConsent || errors.permissions?.newsletterSubscription || errors.permissions?.whatsappList);\n      default:\n        return false;\n    }\n  };\n\n  const checkDuplicatesMutation = useMutation({\n    mutationFn: async (data: MemberFormData) => {\n      // Generate a temporary member number for duplicate checking\n      const tempMemberNumber = Math.floor(Math.random() * 9999).toString().padStart(4, '0');\n      \n      const memberData = {\n        memberNumber: tempMemberNumber,\n        firstName: data.firstName,\n        lastName: data.lastName,\n        birthDate: data.dateOfBirth ? data.dateOfBirth.toISOString() : undefined,\n        email: data.email || null,\n        phone: data.phone || null,\n        street: data.street,\n        number: data.number,\n        postalCode: data.postalCode,\n        city: data.city,\n      };\n      \n      const response = await apiRequest('POST', '/api/members/check-duplicates', memberData);\n      return response.json();\n    },\n  });\n\n  const createMemberMutation = useMutation({\n    mutationFn: async (data: MemberFormData) => {\n      // Transform data for backend compatibility\n      const transformedData = {\n        ...data,\n        // Convert Date object to ISO string for backend\n        birthDate: data.dateOfBirth ? data.dateOfBirth.toISOString() : undefined,\n        // Remove the frontend-only dateOfBirth field\n        dateOfBirth: undefined,\n      };\n      \n      const method = member ? \"PATCH\" : \"POST\";\n      const url = member ? `/api/members/${member.id}` : \"/api/members\";\n      const response = await apiRequest(method, url, transformedData);\n      return response.json();\n    },\n    onSuccess: async (updatedMember, variables) => {\n      if (member) {\n        // Update existing member in the list\n        queryClient.setQueryData([\"/api/members\"], (oldData: any) => {\n          if (!Array.isArray(oldData)) return oldData;\n          return oldData.map((m: any) => \n            m.id === member.id ? { ...m, ...updatedMember } : m\n          );\n        });\n      } else {\n        // Add new member to the list\n        queryClient.setQueryData([\"/api/members\"], (oldData: any) => {\n          if (!Array.isArray(oldData)) return [updatedMember];\n          return [updatedMember, ...oldData];\n        });\n        \n        // Update dashboard stats for new member only\n        queryClient.setQueryData([\"/api/dashboard/stats\"], (oldStats: any) => {\n          if (!oldStats) return oldStats;\n          return {\n            ...oldStats,\n            totalMembers: (parseInt(oldStats.totalMembers) + 1).toString(),\n            activeMembers: (parseInt(oldStats.activeMembers) + (updatedMember.active ? 1 : 0)).toString(),\n          };\n        });\n      }\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/members\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: member ? \"Lid bijgewerkt\" : \"Lid aangemaakt\",\n        description: member ? \"Het lid is succesvol bijgewerkt.\" : \"Het nieuwe lid is succesvol toegevoegd.\",\n      });\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: member ? \"Fout bij bijwerken\" : \"Fout bij aanmaken\",\n        description: error.message || (member ? \"Er is een fout opgetreden bij het bijwerken van het lid.\" : \"Er is een fout opgetreden bij het aanmaken van het lid.\"),\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: MemberFormData) => {\n    // Force validation and wait for it to complete\n    const isValid = await form.trigger();\n    \n    if (!isValid) {\n      const errors = form.formState.errors;\n      console.log('Form validation errors:', errors);\n      \n      // Bepaal welke tab de eerste fout bevat\n      let targetTab = \"personal\";\n      if (hasTabErrors('personal')) {\n        targetTab = \"personal\";\n      } else if (hasTabErrors('address')) {\n        targetTab = \"address\";\n      } else if (hasTabErrors('financial')) {\n        targetTab = \"financial\";\n      } else if (hasTabErrors('organization')) {\n        targetTab = \"organization\";\n      } else if (hasTabErrors('permissions')) {\n        targetTab = \"permissions\";\n      }\n      \n      setActiveTab(targetTab);\n      \n      toast({\n        title: \"Formulier onvolledig\",\n        description: \"Vul alle verplichte velden in om verder te gaan.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    // For new members, check for duplicates first\n    if (!member) {\n      setPendingData(data);\n      try {\n        const duplicateCheck = await checkDuplicatesMutation.mutateAsync(data);\n        \n        if (duplicateCheck.hasDuplicates) {\n          // Show duplicate warning\n          setDuplicateInfo(duplicateCheck);\n          setShowDuplicateWarning(true);\n          return;\n        }\n      } catch (error) {\n        console.error('Duplicate check failed:', error);\n      }\n    }\n    \n    createMemberMutation.mutate(data);\n  };\n\n  const handleConfirmDuplicate = () => {\n    if (pendingData) {\n      setShowDuplicateWarning(false);\n      createMemberMutation.mutate(pendingData);\n      setPendingData(null);\n      setDuplicateInfo(null);\n    }\n  };\n\n  const handleCancelDuplicate = () => {\n    setShowDuplicateWarning(false);\n    setPendingData(null);\n    setDuplicateInfo(null);\n  };\n\n  // Mock EID scan functionaliteit - in productie zou dit een echte EID reader library gebruiken\n  const handleEIDScan = async () => {\n    setIsScanning(true);\n    \n    try {\n      // Simulatie van EID scan - in productie zou dit een echte EID API aanroepen\n      await new Promise(resolve => setTimeout(resolve, 2000));\n      \n      // Mock EID gegevens (in productie komen deze van de EID reader)\n      const eidData = {\n        firstName: \"Ahmed\",\n        lastName: \"Ben Mansour\",\n        gender: \"M\" as const,\n        dateOfBirth: new Date(\"1985-03-15\"),\n        street: \"Nieuwstraat\",\n        number: \"25\",\n        bus: \"\",\n        postalCode: \"2000\",\n        city: \"Antwerpen\",\n        country: \"België\"\n      };\n      \n      // Vul form velden automatisch in\n      form.setValue(\"firstName\", eidData.firstName);\n      form.setValue(\"lastName\", eidData.lastName);\n      form.setValue(\"gender\", eidData.gender);\n      form.setValue(\"dateOfBirth\", eidData.dateOfBirth);\n      form.setValue(\"street\", eidData.street);\n      form.setValue(\"number\", eidData.number);\n      form.setValue(\"bus\", eidData.bus);\n      form.setValue(\"postalCode\", eidData.postalCode);\n      form.setValue(\"city\", eidData.city);\n      form.setValue(\"country\", eidData.country);\n      \n      toast({\n        title: \"EID succesvol gescand\",\n        description: \"Persoonlijke en adresgegevens zijn automatisch ingevuld.\",\n      });\n    } catch (error) {\n      toast({\n        title: \"EID scan mislukt\",\n        description: \"Er is een probleem opgetreden bij het scannen van de EID. Probeer opnieuw.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsScanning(false);\n    }\n  };\n\n  const nextTab = (e?: React.MouseEvent) => {\n    if (e) {\n      e.preventDefault(); // Prevent form submission\n    }\n    const tabs = [\"personal\", \"address\", \"financial\", \"organization\", \"permissions\"];\n    const currentIndex = tabs.indexOf(activeTab);\n    if (currentIndex < tabs.length - 1) {\n      setActiveTab(tabs[currentIndex + 1]);\n    }\n  };\n\n  const prevTab = (e?: React.MouseEvent) => {\n    if (e) {\n      e.preventDefault(); // Prevent form submission\n    }\n    const tabs = [\"personal\", \"address\", \"financial\", \"organization\", \"permissions\"];\n    const currentIndex = tabs.indexOf(activeTab);\n    if (currentIndex > 0) {\n      setActiveTab(tabs[currentIndex - 1]);\n    }\n  };\n\n  return (\n    <div className=\"w-full\">\n      <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"pt-4\">\n              <div className=\"mb-6 flex justify-end border-b pb-4\">\n                <Button\n                  type=\"button\"\n                  onClick={handleEIDScan}\n                  disabled={isScanning}\n                  variant=\"outline\"\n                  size=\"sm\"\n                  className=\"flex items-center gap-2 bg-[#b6d1fc] text-[#0053a6]\"\n                  data-testid=\"button-eid-scan\"\n                >\n                  <IdCard className=\"h-4 w-4\" />\n                  {isScanning ? \"Scannen...\" : \"Scan EID\"}\n                </Button>\n              </div>\n\n              <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-5\">\n                <TabsTrigger value=\"personal\" data-testid=\"tab-personal\" className=\"flex items-center gap-2\">\n                  <MdOutlinePermIdentity className=\"h-4 w-4\" />\n                  Persoonlijk\n                  {hasTabErrors(\"personal\") && <span className=\"text-red-500 ml-1\">!</span>}\n                </TabsTrigger>\n                <TabsTrigger value=\"address\" data-testid=\"tab-address\" className=\"flex items-center gap-2\">\n                  <GoHome className=\"h-4 w-4\" />\n                  Adres\n                  {hasTabErrors(\"address\") && <span className=\"text-red-500 ml-1\">!</span>}\n                </TabsTrigger>\n                <TabsTrigger value=\"financial\" data-testid=\"tab-financial\" className=\"flex items-center gap-2\">\n                  <CiBank className=\"h-4 w-4\" />\n                  Financieel\n                  {hasTabErrors(\"financial\") && <span className=\"text-red-500 ml-1\">!</span>}\n                </TabsTrigger>\n                <TabsTrigger value=\"organization\" data-testid=\"tab-organization\" className=\"flex items-center gap-2\">\n                  <BsBuildings className=\"h-4 w-4\" />\n                  Organisatie\n                  {hasTabErrors(\"organization\") && <span className=\"text-red-500 ml-1\">!</span>}\n                </TabsTrigger>\n                <TabsTrigger value=\"permissions\" data-testid=\"tab-permissions\" className=\"flex items-center gap-2\">\n                  <RiCheckboxMultipleLine className=\"h-4 w-4\" />\n                  Toestemmingen\n                  {hasTabErrors(\"permissions\") && <span className=\"text-red-500 ml-1\">!</span>}\n                </TabsTrigger>\n              </TabsList>\n\n              <div className=\"min-h-[420px] py-6\">\n                <TabsContent value=\"personal\" className=\"space-y-4 mt-0\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"firstName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Voornaam *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"bijv. Mohamed\" {...field} data-testid=\"input-firstname\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"lastName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Achternaam *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"bijv. El-Amrani\" {...field} data-testid=\"input-lastname\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"gender\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Geslacht *</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-gender\">\n                              <SelectValue placeholder=\"Selecteer geslacht\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"M\">Man</SelectItem>\n                            <SelectItem value=\"V\">Vrouw</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"dateOfBirth\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Geboortedatum *</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Input\n                              value={field.value ? format(field.value, \"dd/MM/yyyy\", { locale: nl }) : \"\"}\n                              onChange={(e) => {\n                                const inputValue = e.target.value;\n                                \n                                // Handle numeric input (e.g., 04061993 -> 04/06/1993)\n                                if (/^\\d+$/.test(inputValue)) {\n                                  if (inputValue.length === 8) {\n                                    const day = inputValue.substring(0, 2);\n                                    const month = inputValue.substring(2, 4);\n                                    const year = inputValue.substring(4, 8);\n                                    const date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\n                                    if (!isNaN(date.getTime()) && parseInt(month) >= 1 && parseInt(month) <= 12 && parseInt(day) >= 1 && parseInt(day) <= 31) {\n                                      field.onChange(date);\n                                      return;\n                                    }\n                                  }\n                                }\n                                \n                                // Handle formatted input (DD/MM/YYYY)\n                                if (inputValue.length === 10 && inputValue.includes('/')) {\n                                  const [day, month, year] = inputValue.split('/');\n                                  if (day && month && year) {\n                                    const date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\n                                    if (!isNaN(date.getTime())) {\n                                      field.onChange(date);\n                                    }\n                                  }\n                                }\n                              }}\n                              placeholder=\"DD/MM/YYYY\"\n                              className=\"pr-10 border-gray-200\"\n                              data-testid=\"input-birthdate\"\n                              maxLength={10}\n                            />\n                            <Popover>\n                              <PopoverTrigger asChild>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  type=\"button\"\n                                  className=\"absolute right-2 top-2 h-6 w-6 p-1 hover:bg-transparent hover:scale-100 focus:bg-transparent active:bg-transparent transition-none transform-none\"\n                                >\n                                  <CalendarIcon className=\"h-4 w-4\" />\n                                </Button>\n                              </PopoverTrigger>\n                              <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                                <div className=\"p-3 border-b\">\n                                  <div className=\"flex items-center justify-between space-x-2\">\n                                    <Select\n                                      value={field.value ? field.value.getMonth().toString() : \"\"}\n                                      onValueChange={(month) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(currentDate.getFullYear(), parseInt(month), currentDate.getDate());\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[120px] h-8\">\n                                        <SelectValue placeholder=\"Maand\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 12 }, (_, i) => (\n                                          <SelectItem key={i} value={i.toString()}>\n                                            {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                          </SelectItem>\n                                        ))}\n                                      </SelectContent>\n                                    </Select>\n                                    <Select\n                                      value={field.value ? field.value.getFullYear().toString() : \"\"}\n                                      onValueChange={(year) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(parseInt(year), currentDate.getMonth(), currentDate.getDate());\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[80px] h-8\">\n                                        <SelectValue placeholder=\"Jaar\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 100 }, (_, i) => {\n                                          const year = new Date().getFullYear() - i;\n                                          return (\n                                            <SelectItem key={year} value={year.toString()}>\n                                              {year}\n                                            </SelectItem>\n                                          );\n                                        })}\n                                      </SelectContent>\n                                    </Select>\n                                  </div>\n                                </div>\n                                <Calendar\n                                  mode=\"single\"\n                                  selected={field.value}\n                                  onSelect={(date) => {\n                                    field.onChange(date);\n                                  }}\n                                  locale={nl}\n                                  month={field.value || new Date()}\n                                  onMonthChange={(month) => field.onChange(month)}\n                                  showOutsideDays={false}\n                                  className=\"p-3\"\n                                  defaultMonth={new Date()}\n                                  disabled={(date) => {\n                                    // Geboortedatum kan niet in de toekomst liggen\n                                    return date > new Date();\n                                  }}\n                                />\n                              </PopoverContent>\n                            </Popover>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"category\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Categorie *</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-category\">\n                              <SelectValue placeholder=\"Selecteer categorie\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"STUDENT\">Student</SelectItem>\n                            <SelectItem value=\"STANDAARD\">Standaard</SelectItem>\n                            <SelectItem value=\"SENIOR\">Senior</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>E-mailadres (optioneel)</FormLabel>\n                        <FormControl>\n                          <Input type=\"email\" placeholder=\"mohamed@telenet.be\" {...field} data-testid=\"input-email\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"phone\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Telefoon (optioneel)</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"+32 2 123 45 67\" {...field} data-testid=\"input-phone\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"address\" className=\"space-y-4 mt-0\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"street\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Straat *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"Wetstraat\" {...field} data-testid=\"input-street\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"number\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Nummer *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"16\" {...field} data-testid=\"input-number\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"bus\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Bus (optioneel)</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"A\" {...field} data-testid=\"input-bus\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"postalCode\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Postcode *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"1000\" {...field} data-testid=\"input-postalcode\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"city\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Stad *</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"Brussel\" {...field} data-testid=\"input-city\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"country\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Land *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-country\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"financial\" className=\"space-y-4 mt-0\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"financialSettings.paymentMethod\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Betaalmethode</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-payment-method\">\n                              <SelectValue placeholder=\"Selecteer betaalmethode\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"SEPA\">SEPA Incasso</SelectItem>\n                            <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                            <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                            <SelectItem value=\"CASH\">Contant</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"financialSettings.iban\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>IBAN {(form.watch(\"financialSettings.paymentMethod\") === \"SEPA\" || form.watch(\"financialSettings.paymentMethod\") === \"OVERSCHRIJVING\") && \"*\"}</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"BE68 5390 0754 7034\" {...field} data-testid=\"input-iban\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"financialSettings.paymentTerm\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Betalingstermijn</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-payment-term\">\n                              <SelectValue placeholder=\"Selecteer betalingstermijn\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"MONTHLY\">Maandelijks</SelectItem>\n                            <SelectItem value=\"YEARLY\">Jaarlijks</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"organization\" className=\"space-y-4 mt-0\">\n                <div className=\"space-y-6\">\n                  <FormField\n                    control={form.control}\n                    name=\"organization.votingEligible\"\n                    render={({ field }) => {\n                      // Validate voting rights based on current form data\n                      const currentFormData = form.getValues();\n                      const memberData = {\n                        birthDate: currentFormData.dateOfBirth,\n                        category: currentFormData.category,\n                        active: true // Assume new members are active\n                      };\n                      \n                      const validation = validateVotingRights(memberData);\n                      const shouldShowWarning = field.value && !validation.isValid;\n\n                      return (\n                        <FormItem>\n                          <FormLabel>Stemgerechtigd?</FormLabel>\n                          <FormControl>\n                            <RadioGroup\n                              onValueChange={(value) => field.onChange(value === \"true\")}\n                              value={field.value ? \"true\" : \"false\"}\n                              className=\"flex gap-6\"\n                              data-testid=\"radio-voting-eligible\"\n                            >\n                              <div className=\"flex items-center space-x-2\">\n                                <RadioGroupItem value=\"true\" id=\"voting-yes\" />\n                                <Label htmlFor=\"voting-yes\">Ja</Label>\n                              </div>\n                              <div className=\"flex items-center space-x-2\">\n                                <RadioGroupItem value=\"false\" id=\"voting-no\" />\n                                <Label htmlFor=\"voting-no\">Nee</Label>\n                              </div>\n                            </RadioGroup>\n                          </FormControl>\n                          \n                          {/* Show rule warnings if voting rights are enabled but member doesn't qualify */}\n                          {shouldShowWarning && (\n                            <div className=\"mt-4\">\n                              <RuleWarning\n                                type=\"warning\"\n                                title=\"Regel overtredingen gedetecteerd\"\n                                warnings={validation.warnings}\n                                reasons={validation.reasons}\n                                showOverride={true}\n                                onOverride={() => setShowVotingOverrideDialog(true)}\n                                overrideLabel=\"Handmatig toekennen\"\n                              />\n                            </div>\n                          )}\n                          \n                          <FormMessage />\n                        </FormItem>\n                      );\n                    }}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"organization.interestedInActiveRole\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Interesse in actieve rol?</FormLabel>\n                        <FormControl>\n                          <RadioGroup\n                            onValueChange={(value) => field.onChange(value === \"true\")}\n                            value={field.value ? \"true\" : \"false\"}\n                            className=\"flex gap-6\"\n                            data-testid=\"radio-active-role\"\n                          >\n                            <div className=\"flex items-center space-x-2\">\n                              <RadioGroupItem value=\"true\" id=\"role-yes\" />\n                              <Label htmlFor=\"role-yes\">Ja</Label>\n                            </div>\n                            <div className=\"flex items-center space-x-2\">\n                              <RadioGroupItem value=\"false\" id=\"role-no\" />\n                              <Label htmlFor=\"role-no\">Nee</Label>\n                            </div>\n                          </RadioGroup>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"organization.roleDescription\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className={!form.watch(\"organization.interestedInActiveRole\") ? \"text-gray-400\" : \"\"}>\n                          In welke rol zie jij jezelf de moskee helpen?\n                        </FormLabel>\n                        <FormControl>\n                          <Input \n                            placeholder=\"Beschrijf je gewenste rol...\" \n                            {...field} \n                            disabled={!form.watch(\"organization.interestedInActiveRole\")}\n                            className={!form.watch(\"organization.interestedInActiveRole\") ? \"bg-gray-100 text-gray-400\" : \"\"}\n                            data-testid=\"input-role-description\" \n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  \n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"permissions\" className=\"space-y-4 mt-0\">\n                <div className=\"space-y-6\">\n                  <div>\n                    <h3 className=\"text-lg font-medium mb-4\">Toestemmingen</h3>\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"permissions.privacyAgreement\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-privacy\"\n                              />\n                            </FormControl>\n                            <div className=\"space-y-1 leading-none\">\n                              <FormLabel className=\"text-sm font-normal\">\n                                Ik ga akkoord met de privacyverklaring *\n                              </FormLabel>\n                            </div>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"permissions.photoVideoConsent\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-photo-video\"\n                              />\n                            </FormControl>\n                            <div className=\"space-y-1 leading-none\">\n                              <FormLabel className=\"text-sm font-normal\">\n                                Toestemming voor foto/video gebruik bij evenementen\n                              </FormLabel>\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"permissions.newsletterSubscription\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-newsletter\"\n                              />\n                            </FormControl>\n                            <div className=\"space-y-1 leading-none\">\n                              <FormLabel className=\"text-sm font-normal\">\n                                Aanmelden voor nieuwsbrief\n                              </FormLabel>\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"permissions.whatsappList\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                data-testid=\"checkbox-whatsapp\"\n                              />\n                            </FormControl>\n                            <div className=\"space-y-1 leading-none\">\n                              <FormLabel className=\"text-sm font-normal\">\n                                WhatsApp verzendlijst toevoegen\n                              </FormLabel>\n                            </div>\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"border-t pt-6\">\n                    <h3 className=\"text-lg font-medium mb-4\">Lidmaatschap overzicht</h3>\n                    <div className=\"bg-gray-50 p-4 rounded-lg space-y-2\">\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Lidnummer:</span>\n                        <span className=\"font-mono text-sm\">Wordt automatisch toegewezen</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Lidgeld:</span>\n                        <span className=\"font-medium\">\n                          {form.watch(\"financialSettings.paymentTerm\") === \"MONTHLY\" ? \"€15,00 per maand\" : \"€150,00 per jaar\"}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-sm text-gray-600\">Frequentie:</span>\n                        <span className=\"text-sm\">\n                          {form.watch(\"financialSettings.paymentTerm\") === \"MONTHLY\" ? \"Maandelijks\" : \"Jaarlijks\"}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n              </div>\n            </Tabs>\n            </div>\n\n            <div className=\"flex justify-between pt-6 border-t\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={prevTab}\n                disabled={activeTab === \"personal\"}\n                data-testid=\"button-previous\"\n              >\n                Vorige\n              </Button>\n\n              <div className=\"flex gap-2\">\n                {activeTab !== \"permissions\" ? (\n                  <Button\n                    type=\"button\"\n                    onClick={nextTab}\n                    data-testid=\"button-next\"\n                  >\n                    Volgende\n                  </Button>\n                ) : (\n                  <Button\n                    type=\"submit\"\n                    disabled={createMemberMutation.isPending}\n                    data-testid=\"button-submit\"\n                  >\n                    {createMemberMutation.isPending ? (member ? \"Lid wordt opgeslagen...\" : \"Lid wordt aangemaakt...\") : (member ? \"Opslaan\" : \"Lid Aanmaken\")}\n                  </Button>\n                )}\n              </div>\n            </div>\n          </form>\n        </Form>\n\n        {/* Duplicate Warning Dialog */}\n        <Dialog open={showDuplicateWarning} onOpenChange={setShowDuplicateWarning}>\n          <DialogContent className=\"sm:max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2 text-amber-800\">\n                <AlertTriangle className=\"h-5 w-5\" />\n                Mogelijk dubbel lid gedetecteerd\n              </DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"space-y-4\">\n              {duplicateInfo?.duplicates?.map((duplicate: any, index: number) => (\n                <div key={index} className=\"p-4 bg-amber-50 border border-amber-200 rounded-lg\">\n                  <p className=\"text-sm text-amber-800\">\n                    <strong>Een lid met soortgelijke gegevens bestaat al:</strong>\n                  </p>\n                  <div className=\"mt-2 text-sm text-gray-700\">\n                    <p>• Naam: {duplicate.existingMember.firstName} {duplicate.existingMember.lastName}</p>\n                    <p>• Lidnummer: {duplicate.existingMember.memberNumber}</p>\n                    {duplicate.existingMember.email && (\n                      <p>• E-mail: {duplicate.existingMember.email}</p>\n                    )}\n                  </div>\n                </div>\n              ))}\n              \n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                <p className=\"text-sm text-blue-800\">\n                  <strong>Wat gebeurt er:</strong>\n                  <br />• Het nieuwe lid krijgt automatisch een uniek lidnummer\n                  <br />• Alle andere gegevens blijven zoals ingevuld\n                </p>\n              </div>\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={handleCancelDuplicate}>\n                Annuleren\n              </Button>\n              <Button \n                onClick={handleConfirmDuplicate}\n                className=\"bg-amber-600 hover:bg-amber-700\"\n              >\n                Toch aanmaken\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n\n        {/* Voting Rights Override Dialog */}\n        <RuleOverrideDialog\n          open={showVotingOverrideDialog}\n          onOpenChange={setShowVotingOverrideDialog}\n          memberId={member?.id || \"new-member\"}\n          memberName={`${form.getValues().firstName || ''} ${form.getValues().lastName || ''}`.trim() || 'Nieuw lid'}\n          currentStatus={form.getValues().organization?.votingEligible || false}\n          warnings={validateVotingRights({\n            birthDate: form.getValues().dateOfBirth,\n            category: form.getValues().category,\n            active: true\n          }).warnings}\n          ruleScope=\"STEMRECHT\"\n          onSuccess={() => {\n            // For new members, we can't create an override until after they're created\n            // So we just show a success message and allow the form to continue\n            toast({\n              title: \"Override opgepland\",\n              description: \"Het stemrecht wordt handmatig toegekend na het aanmaken van het lid.\",\n            });\n          }}\n        />\n    </div>\n  );\n}\n","size_bytes":53938},"client/src/components/layout/app-shell.tsx":{"content":"import Sidebar from \"./sidebar\";\nimport { CommandPalette } from \"../command-palette\";\n\ninterface AppShellProps {\n  children: React.ReactNode;\n}\n\nexport default function AppShell({ children }: AppShellProps) {\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <Sidebar />\n      <main className=\"lg:pl-64\">\n        <div className=\"px-4 py-3 sm:px-6 lg:px-8\">\n          {children}\n        </div>\n      </main>\n      <CommandPalette />\n    </div>\n  );\n}","size_bytes":465},"client/src/components/layout/sidebar.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { cn } from \"@/lib/utils\";\nimport { \n  LayoutDashboard, \n  Users, \n  CreditCard, \n  BarChart3, \n  Monitor, \n  Settings,\n  Building2,\n  IdCard,\n  Mail,\n  Menu,\n  X,\n  LogOut,\n  User\n} from \"lucide-react\";\nimport { RiMoneyEuroCircleLine } from \"react-icons/ri\";\nimport { FaPeopleLine } from \"react-icons/fa6\";\nimport { Button } from \"@/components/ui/button\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger, DropdownMenuSeparator } from \"@/components/ui/dropdown-menu\";\nimport darahLogo from \"@assets/idarah (2)_1757094401589.png\";\nimport { getUserInitials } from \"@/lib/auth\";\nimport { useAuth } from \"@/hooks/use-auth\";\n\nconst navigation = [\n  { name: \"Dashboard\", href: \"/dashboard\", icon: LayoutDashboard },\n  { name: \"Leden\", href: \"/leden\", icon: Users },\n  { name: \"Lidkaarten\", href: \"/lidkaarten\", icon: IdCard },\n  { name: \"Lidgelden\", href: \"/lidgelden\", icon: CreditCard },\n  { name: \"Financiën\", href: \"/financien\", icon: RiMoneyEuroCircleLine },\n  { name: \"Mijn Bestuur\", href: \"/bestuur\", icon: FaPeopleLine },\n  { name: \"Berichten\", href: \"/berichten\", icon: Mail },\n  { name: \"Publieke Schermen\", href: \"/publieke-schermen\", icon: Monitor },\n  { name: \"Instellingen\", href: \"/instellingen\", icon: Settings },\n];\n\nexport default function Sidebar() {\n  const [location] = useLocation();\n  const { user, logout } = useAuth();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  const sidebarContent = (\n    <div className=\"flex grow flex-col gap-y-2 overflow-y-auto bg-sidebar border-r border-sidebar-border\">\n      {/* Logo */}\n      <div className=\"flex h-28 shrink-0 items-center justify-center px-4 pt-4\" data-testid=\"logo\">\n        <Link href=\"/dashboard\" className=\"flex items-center justify-center w-full\">\n          <img \n            src={darahLogo} \n            alt=\"DARAH Logo\" \n            className=\"w-52 h-12 sm:w-56 sm:h-13 lg:w-60 lg:h-14 object-contain scale-[3]\"\n          />\n        </Link>\n      </div>\n\n      {/* User Section */}\n      {user && (\n        <div className=\"border-b border-sidebar-border px-6 pb-4\">\n          <Link href=\"/profiel\" className=\"flex items-center gap-x-3 px-2 py-2 rounded-xl hover:bg-sidebar-accent transition-all duration-300 ease-out\">\n            <div className=\"h-8 w-8 bg-sidebar-primary text-sidebar-primary-foreground rounded-full flex items-center justify-center text-sm font-medium\" data-testid=\"user-avatar\">\n              {getUserInitials(user.name)}\n            </div>\n            <div className=\"min-w-0 flex-1 text-left\">\n              <p className=\"text-sm font-medium text-sidebar-foreground\" data-testid=\"user-name\">{user.name}</p>\n              <p className=\"text-xs text-blue-600 font-medium\" data-testid=\"user-role\">{user.role}</p>\n            </div>\n          </Link>\n        </div>\n      )}\n\n      {/* Navigation */}\n      <nav className=\"flex flex-1 flex-col px-6\">\n        <ul role=\"list\" className=\"flex flex-1 flex-col gap-y-2\">\n          <li>\n            <ul role=\"list\" className=\"space-y-1\">\n              {navigation.map((item) => {\n                const isActive = location === item.href || (item.href !== \"/dashboard\" && location.startsWith(item.href));\n                const Icon = item.icon;\n                \n                return (\n                  <li key={item.name}>\n                    <Link\n                      href={item.href}\n                      className={cn(\n                        \"group relative flex gap-x-3 rounded-xl px-4 py-3 text-sm font-medium transition-all duration-300 ease-out focus-ring\",\n                        isActive\n                          ? \"bg-sidebar-primary text-sidebar-primary-foreground shadow-lg shadow-blue-500/20 scale-105 border border-blue-400/30\"\n                          : \"text-sidebar-foreground hover:text-sidebar-foreground hover:bg-sidebar-accent hover:shadow-md hover:scale-102 hover:-translate-y-0.5\"\n                      )}\n                      data-testid={`nav-${item.name.toLowerCase().replace(/\\s+/g, '-')}`}\n                      onClick={() => setMobileMenuOpen(false)}\n                    >\n                      {isActive && (\n                        <div className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-primary rounded-r-full\" />\n                      )}\n                      <Icon className={cn(\"h-5 w-5 shrink-0\", isActive ? \"text-sidebar-primary-foreground\" : \"\")} />\n                      {item.name}\n                    </Link>\n                  </li>\n                );\n              })}\n            </ul>\n          </li>\n        </ul>\n      </nav>\n\n      {/* Logout Button */}\n      {user && (\n        <div className=\"mt-auto border-t border-sidebar-border p-6\">\n          <Button \n            variant=\"ghost\" \n            className=\"w-full justify-start gap-x-3 px-4 py-3 text-sm font-medium text-white hover:text-white hover:bg-red-50\"\n            onClick={logout}\n            data-testid=\"logout-button\"\n          >\n            <LogOut className=\"h-5 w-5\" />\n            Uitloggen\n          </Button>\n        </div>\n      )}\n\n    </div>\n  );\n\n  return (\n    <>\n      {/* Desktop Sidebar */}\n      <aside className=\"hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-64 lg:flex-col\">\n        {sidebarContent}\n      </aside>\n\n      {/* Mobile Header */}\n      <div className=\"sticky top-0 z-40 flex items-center gap-x-6 bg-sidebar px-4 py-4 shadow-sm sm:px-6 lg:hidden\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"-m-2.5 p-2.5\"\n          onClick={() => setMobileMenuOpen(true)}\n          data-testid=\"mobile-menu-toggle\"\n        >\n          <Menu className=\"h-6 w-6\" />\n          <span className=\"sr-only\">Menu openen</span>\n        </Button>\n        <div className=\"flex-1 text-sm font-semibold leading-6 text-sidebar-foreground\">\n          <Link href=\"/dashboard\">\n            <img \n              src={darahLogo} \n              alt=\"DARAH Logo\" \n              className=\"h-8 object-contain\"\n            />\n          </Link>\n        </div>\n        {user && (\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 rounded-full\">\n                <div className=\"h-8 w-8 bg-sidebar-primary text-sidebar-primary-foreground rounded-full flex items-center justify-center text-sm font-medium\">\n                  {getUserInitials(user.name)}\n                </div>\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"w-56\">\n              <DropdownMenuItem>\n                <User className=\"mr-2 h-4 w-4\" />\n                <span>Profiel</span>\n              </DropdownMenuItem>\n              <DropdownMenuSeparator />\n              <DropdownMenuItem onClick={logout}>\n                <LogOut className=\"mr-2 h-4 w-4\" />\n                <span>Uitloggen</span>\n              </DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        )}\n      </div>\n\n      {/* Mobile Sidebar */}\n      {mobileMenuOpen && (\n        <div className=\"relative z-50 lg:hidden\">\n          <div className=\"fixed inset-0 bg-black/25\" onClick={() => setMobileMenuOpen(false)} />\n          <div className=\"fixed inset-0 flex\">\n            <div className=\"relative mr-16 flex w-full max-w-xs flex-1\">\n              <div className=\"absolute left-full top-0 flex w-16 justify-center pt-5\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"-m-2.5 p-2.5\"\n                  onClick={() => setMobileMenuOpen(false)}\n                >\n                  <X className=\"h-6 w-6 text-white\" />\n                  <span className=\"sr-only\">Menu sluiten</span>\n                </Button>\n              </div>\n              {sidebarContent}\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}","size_bytes":7966},"client/src/components/layout/topbar.tsx":{"content":"import { Search, Menu, Command, HelpCircle } from \"lucide-react\";\nimport { LuBellRing } from \"react-icons/lu\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { getUserInitials } from \"@/lib/auth\";\nimport { cn } from \"@/lib/utils\";\n\nexport default function Topbar() {\n  const { user } = useAuth();\n\n  return (\n    <header className=\"glass-card border-0 rounded-none bg-white/80 backdrop-blur-md shadow-sm border-b border-gray-200/50 sticky top-0 z-50 lg:pl-64\">\n      <div className=\"flex h-16 items-center justify-between px-4 sm:px-6\">\n        {/* Left side - Mobile menu and Logo */}\n        <div className=\"flex items-center gap-4\">\n          {/* Mobile menu button */}\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            className=\"h-10 w-10 text-gray-600 hover:text-gray-900 hover:bg-gray-100 lg:hidden transition-colors\" \n            data-testid=\"mobile-menu-button\"\n          >\n            <Menu className=\"h-5 w-5\" />\n            <span className=\"sr-only\">Open sidebar</span>\n          </Button>\n          \n          {/* Brand/Logo area for mobile */}\n          <div className=\"lg:hidden\">\n            <h1 className=\"text-lg font-semibold text-gray-900\">Ledenbeheer</h1>\n          </div>\n        </div>\n\n        {/* Center - Search */}\n        <div className=\"flex flex-1 justify-center max-w-lg mx-4\">\n          <div className=\"relative w-full\">\n            <div className=\"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3\">\n              <Search className=\"h-4 w-4 text-gray-400\" />\n            </div>\n            <Input\n              id=\"search-field\"\n              className={cn(\n                \"w-full pl-10 pr-16 h-10 bg-white/60 border border-gray-200\",\n                \"focus:border-blue-300 focus:ring-2 focus:ring-blue-500/20\",\n                \"placeholder:text-gray-500 text-sm rounded-lg\",\n                \"hover:border-gray-300 transition-all duration-200\"\n              )}\n              placeholder=\"Zoek leden, transacties... (⌘K)\"\n              type=\"search\"\n              name=\"search\"\n              data-testid=\"search-input\"\n            />\n            <div className=\"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3\">\n              <kbd className=\"hidden h-6 select-none items-center gap-1 rounded-md border border-gray-200 bg-gray-50 px-2 font-mono text-[11px] font-medium text-gray-500 opacity-100 sm:flex\">\n                <Command className=\"h-3 w-3\" />K\n              </kbd>\n            </div>\n          </div>\n        </div>\n\n        {/* Right side - Actions */}\n        <div className=\"flex items-center gap-2\">\n          {/* Help */}\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            className=\"h-10 w-10 text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors\" \n            data-testid=\"help-button\"\n          >\n            <HelpCircle className=\"h-4 w-4\" />\n            <span className=\"sr-only\">Help</span>\n          </Button>\n\n          {/* Notifications */}\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            className=\"relative h-10 w-10 text-gray-600 hover:text-gray-900 hover:bg-gray-100 transition-colors\" \n            data-testid=\"notifications-button\"\n          >\n            <LuBellRing className=\"h-4 w-4\" />\n            <Badge \n              variant=\"destructive\" \n              className=\"absolute -top-1 -right-1 h-5 w-5 text-xs flex items-center justify-center p-0 border-2 border-white shadow-sm\" \n              data-testid=\"notification-count\"\n            >\n              3\n            </Badge>\n            <span className=\"sr-only\">View notifications</span>\n          </Button>\n\n          {/* Profile dropdown */}\n          {user && (\n            <div className=\"relative ml-2\">\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                className=\"h-10 px-3 text-gray-700 hover:bg-gray-100 transition-colors flex items-center gap-2\" \n                data-testid=\"profile-button\"\n              >\n                <div className=\"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-sm\">\n                  <span className=\"text-sm font-medium text-white\">\n                    {getUserInitials(user.name)}\n                  </span>\n                </div>\n                <div className=\"hidden sm:flex flex-col items-start text-left\">\n                  <span className=\"text-sm font-medium text-gray-900 leading-none\">\n                    {user.name}\n                  </span>\n                  <span className=\"text-xs text-gray-500 leading-none mt-0.5\">\n                    {user.role}\n                  </span>\n                </div>\n                <span className=\"sr-only\">Open user menu</span>\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}\n","size_bytes":5052},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border !bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4416},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 btn-hover\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline hover:no-underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 px-3\",\n        lg: \"h-12 px-6\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1951},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-2xl border bg-card text-card-foreground shadow-sm hover:shadow-md transition-shadow duration-200\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1906},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md !bg-white text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4884},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border !bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3844},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 !bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4277},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/stats-card.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\ninterface StatsCardProps {\n  title: string;\n  value: string | number;\n  trend?: {\n    value: string;\n    positive: boolean;\n  };\n  icon: React.ReactNode;\n  iconBgColor?: string;\n  className?: string;\n}\n\nexport function StatsCard({\n  title,\n  value,\n  trend,\n  icon,\n  iconBgColor = \"bg-blue-100\",\n  className,\n}: StatsCardProps) {\n  return (\n    <Card className={cn(\"glass-card card-hover animate-fade-in group overflow-hidden\", className)} data-testid={`stats-card-${title.toLowerCase().replace(/\\s+/g, '-')}`}>\n      <CardContent className=\"px-4 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1\">\n            <dt className=\"text-xs font-medium text-muted-foreground mb-1 truncate\" data-testid=\"stats-title\">{title}</dt>\n            <dd className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300 tabular-nums\" data-testid=\"stats-value\">{value}</dd>\n            {trend && (\n              <div className=\"flex items-center space-x-1\">\n                <div className={cn(\n                  \"text-xs font-medium\",\n                  trend.positive ? \"text-green-600\" : \"text-red-600\"\n                )} data-testid=\"stats-trend\">\n                  {trend.value}\n                </div>\n              </div>\n            )}\n          </div>\n          <div className=\"flex-shrink-0\">\n            <div className={cn(\"w-10 h-10 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\", iconBgColor)}>\n              {icon}\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":1769},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-[#65758b] bg-[#e6effd] hover:bg-[#f9fafb] transition-colors font-poppins [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2821},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-accent p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-[hsl(217,91%,85%)] data-[state=active]:text-[hsl(217,91%,15%)] data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1900},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border !bg-white text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4841},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"server/seed.ts":{"content":"import { db } from \"./db\";\nimport { tenants, users } from \"@shared/schema\";\nimport { authService } from \"./services/auth\";\nimport { eq } from \"drizzle-orm\";\n\nasync function seedDatabase() {\n  console.log(\"🌱 Starting database seeding...\");\n\n  try {\n    // 1. Create demo tenant (mosque)\n    const [existingTenant] = await db.select().from(tenants).where(eq(tenants.slug, \"al-nour-brussel\"));\n    \n    let tenantId: string;\n    if (existingTenant) {\n      tenantId = existingTenant.id;\n      console.log(\"✅ Demo tenant already exists\");\n    } else {\n      const [newTenant] = await db.insert(tenants).values({\n        name: \"Moskee Al-Nour Brussel\",\n        slug: \"al-nour-brussel\",\n        primaryColor: \"#2563EB\"\n      }).returning();\n      tenantId = newTenant.id;\n      console.log(\"✅ Created demo tenant\");\n    }\n\n    // 2. Create demo users for each role\n    const demoUsers = [\n      {\n        email: \"superadmin@moskee.be\",\n        password: \"demo123\",\n        name: \"Super Administrator\",\n        role: \"SUPERADMIN\" as const,\n        description: \"Volledige toegang tot alle organisaties en systeem instellingen\"\n      },\n      {\n        email: \"beheerder@moskee.be\", \n        password: \"demo123\",\n        name: \"Ahmed El-Hassani\",\n        role: \"BEHEERDER\" as const,\n        description: \"Beheerder van Demo Moskee Brussel met volledige toegang tot organisatie\"\n      },\n      {\n        email: \"medewerker@moskee.be\",\n        password: \"demo123\", \n        name: \"Fatima Bouchouchi\",\n        role: \"MEDEWERKER\" as const,\n        description: \"Medewerker met beperkte toegang tot leden en basis functies\"\n      }\n    ];\n\n    for (const userData of demoUsers) {\n      // Check if user already exists\n      const [existingUser] = await db.select().from(users).where(eq(users.email, userData.email));\n      \n      if (existingUser) {\n        console.log(`✅ User ${userData.email} already exists`);\n        continue;\n      }\n\n      // Create new user\n      const hashedPassword = await authService.hashPassword(userData.password);\n      \n      await db.insert(users).values({\n        tenantId,\n        name: userData.name,\n        email: userData.email,\n        passwordHash: hashedPassword,\n        role: userData.role,\n        active: true\n      });\n\n      console.log(`✅ Created ${userData.role}: ${userData.email}`);\n    }\n\n    console.log(\"\\n🎉 Database seeding completed successfully!\");\n    console.log(\"\\n📋 Demo Accounts:\");\n    console.log(\"┌─────────────────┬─────────────────────┬─────────────┬──────────────────────────────────────────────┐\");\n    console.log(\"│ Rol             │ Email               │ Wachtwoord  │ Beschrijving                                 │\");\n    console.log(\"├─────────────────┼─────────────────────┼─────────────┼──────────────────────────────────────────────┤\");\n    console.log(\"│ SUPERADMIN      │ superadmin@moskee.be │ demo123     │ Volledige toegang tot alle organisaties      │\");\n    console.log(\"│ BEHEERDER       │ beheerder@moskee.be │ demo123     │ Beheerder van Al-Nour Brussel                │\");\n    console.log(\"│ MEDEWERKER      │ medewerker@moskee.be │ demo123     │ Medewerker met beperkte toegang              │\");\n    console.log(\"└─────────────────┴─────────────────────┴─────────────┴──────────────────────────────────────────────┘\");\n\n  } catch (error) {\n    console.error(\"❌ Error seeding database:\", error);\n    process.exit(1);\n  }\n}\n\n// Run the seeding if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  seedDatabase().then(() => {\n    process.exit(0);\n  });\n}\n\nexport { seedDatabase };","size_bytes":4264},"client/src/components/charts/concentric-rings.tsx":{"content":"import React from 'react';\nimport { CustomTooltip } from '@/components/ui/CustomTooltip';\n\ninterface Category {\n  key: string;\n  label: string;\n  count: number;\n  percent: number;\n  color: string;\n}\n\ninterface ConcentricRingsProps {\n  categories: Category[];\n  size?: number;\n}\n\nfunction polarToCartesian(centerX: number, centerY: number, radius: number, angleInDegrees: number) {\n  const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;\n  return {\n    x: centerX + (radius * Math.cos(angleInRadians)),\n    y: centerY + (radius * Math.sin(angleInRadians))\n  };\n}\n\nfunction describeArc(x: number, y: number, radius: number, startAngle: number, endAngle: number) {\n  const start = polarToCartesian(x, y, radius, endAngle);\n  const end = polarToCartesian(x, y, radius, startAngle);\n  \n  // For arcs close to 360 degrees, ensure we use the large arc flag\n  const angleSpan = endAngle - startAngle;\n  const largeArcFlag = angleSpan >= 180 ? \"1\" : \"0\";\n  \n  return [\n    \"M\", start.x, start.y, \n    \"A\", radius, radius, 0, largeArcFlag, 0, end.x, end.y\n  ].join(\" \");\n}\n\nexport function ConcentricRings({ categories, size = 280 }: ConcentricRingsProps) {\n  const center = size / 2;\n  const radii = [90, 70, 50]; // outer, middle, inner - adjusted for visibility\n  const strokeWidth = 20;\n  \n\n  return (\n    <div className=\"flex items-center justify-center\">\n      <svg \n        width={size} \n        height={size} \n        viewBox={`0 0 ${size} ${size}`}\n        role=\"img\"\n        aria-label=\"Leden per categorie\"\n        className=\"drop-shadow-sm\"\n      >\n        {/* Background circles for all categories */}\n        {categories.map((category, index) => {\n          const radius = radii[index];\n          return (\n            <circle\n              key={`track-${category.key}`}\n              cx={center}\n              cy={center}\n              r={radius}\n              fill=\"none\"\n              stroke=\"#E5E7EB\"\n              strokeWidth={strokeWidth}\n            />\n          );\n        })}\n        \n        {/* Progress arcs for categories with data */}\n        {categories.map((category, index) => {\n          const radius = radii[index];\n          \n          // Skip categories with no data\n          if (category.count === 0) {\n            return null;\n          }\n          \n          // For 100%, render a complete circle instead of an arc\n          if (category.percent >= 100) {\n            return (\n              <CustomTooltip\n                key={`circle-${category.key}`}\n                title={category.label}\n                count={category.count}\n                percentage={category.percent}\n                color={category.color}\n              >\n                <circle\n                  cx={center}\n                  cy={center}\n                  r={radius}\n                  fill=\"none\"\n                  stroke={category.color}\n                  strokeWidth={strokeWidth}\n                  className=\"hover:stroke-opacity-80 transition-all duration-200 cursor-pointer\"\n                />\n              </CustomTooltip>\n            );\n          }\n          \n          // For partial percentages, calculate arc normally\n          const startAngle = -90; // Start at top\n          const endAngle = startAngle + (category.percent / 100) * 360;\n          \n          // Ensure minimum visible arc for small percentages\n          const actualEndAngle = endAngle - startAngle < 10 ? startAngle + 10 : endAngle;\n          \n          const pathData = describeArc(center, center, radius, startAngle, actualEndAngle);\n          \n          return (\n            <CustomTooltip\n              key={`arc-${category.key}`}\n              title={category.label}\n              count={category.count}\n              percentage={category.percent}\n              color={category.color}\n            >\n              <path\n                d={pathData}\n                fill=\"none\"\n                stroke={category.color}\n                strokeWidth={strokeWidth}\n                strokeLinecap=\"round\"\n                className=\"hover:stroke-opacity-80 transition-all duration-200 cursor-pointer\"\n                style={{ \n                  strokeDasharray: 'none',\n                  strokeOpacity: 1\n                }}\n              />\n            </CustomTooltip>\n          );\n        })}\n      </svg>\n    </div>\n  );\n}","size_bytes":4317},"client/src/components/charts/stacked-bars.tsx":{"content":"import React, { useState } from 'react';\nimport { cn } from '@/lib/utils';\n\nexport type Bucket = {\n  label: string;\n  male: number;\n  female: number;\n  percent: number;\n};\n\ninterface StackedBarsProps {\n  buckets: Bucket[];\n  colors?: {\n    male: string;\n    female: string;\n    track: string;\n  };\n  className?: string;\n}\n\nexport function StackedBars({ \n  buckets, \n  colors = {\n    male: '#3B82F6',\n    female: '#A855F7',\n    track: '#F4F6FA'\n  },\n  className \n}: StackedBarsProps) {\n  const [hoveredIndex, setHoveredIndex] = useState<number | null>(null);\n  const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });\n\n  const handleMouseMove = (event: React.MouseEvent, index: number) => {\n    setHoveredIndex(index);\n    setMousePosition({ x: event.clientX, y: event.clientY });\n  };\n\n  const handleMouseLeave = () => {\n    setHoveredIndex(null);\n  };\n\n  return (\n    <div className={cn(\"space-y-3\", className)}>\n      {buckets.map((bucket, index) => {\n        const rowTotal = bucket.male + bucket.female;\n        const maleWidth = rowTotal > 0 ? (bucket.male / rowTotal) * 100 : 0;\n        const femaleWidth = rowTotal > 0 ? (bucket.female / rowTotal) * 100 : 0;\n        \n        return (\n          <div key={index} className=\"flex items-center gap-3\">\n            {/* Label */}\n            <div className=\"w-14 flex-shrink-0\">\n              <span className=\"text-sm font-['Poppins']\" style={{ color: '#475569' }}>\n                {bucket.label}\n              </span>\n            </div>\n            \n            {/* Stacked Bar */}\n            <div className=\"flex-1 relative group\">\n              <div \n                className=\"h-4 rounded-full relative overflow-hidden cursor-pointer hover:h-5 transition-all duration-200\"\n                style={{ backgroundColor: colors.track }}\n                onMouseMove={(e) => handleMouseMove(e, index)}\n                onMouseLeave={handleMouseLeave}\n                data-testid={`stacked-bar-${bucket.label.toLowerCase()}`}\n              >\n                {/* Male segment */}\n                {bucket.male > 0 && (\n                  <div\n                    className=\"absolute top-0 left-0 h-full rounded-full transition-all duration-200 ease-out\"\n                    style={{\n                      width: `${maleWidth}%`,\n                      backgroundColor: colors.male,\n                    }}\n                  />\n                )}\n                \n                {/* Female segment */}\n                {bucket.female > 0 && (\n                  <div\n                    className=\"absolute top-0 h-full rounded-full transition-all duration-200 ease-out\"\n                    style={{\n                      left: `${maleWidth}%`,\n                      width: `${femaleWidth}%`,\n                      backgroundColor: colors.female,\n                    }}\n                  />\n                )}\n              </div>\n            </div>\n            \n            {/* Percentage */}\n            <div className=\"w-14 text-right\">\n              <span className=\"text-sm font-['Poppins']\" style={{ color: '#475569' }}>\n                {bucket.percent.toFixed(1)}%\n              </span>\n            </div>\n          </div>\n        );\n      })}\n      \n      {/* Tooltip */}\n      {hoveredIndex !== null && (\n        <div\n          className=\"fixed z-50 pointer-events-none\"\n          style={{\n            left: mousePosition.x + 10,\n            top: mousePosition.y - 10,\n            transform: 'translateY(-100%)'\n          }}\n        >\n          <div\n            className=\"rounded-xl p-3 shadow-lg border text-sm\"\n            style={{\n              backgroundColor: 'white',\n              border: '1px solid #E2E8F0',\n              borderRadius: '12px',\n              fontSize: '14px',\n              fontFamily: 'Poppins',\n              boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)'\n            }}\n          >\n            <div className=\"font-semibold text-gray-800 mb-2\">\n              {buckets[hoveredIndex].label}\n            </div>\n            <div className=\"space-y-1\">\n              <div className=\"flex items-center gap-2\">\n                <div \n                  className=\"w-3 h-3 rounded-full\"\n                  style={{ backgroundColor: colors.male }}\n                />\n                <span className=\"text-gray-700\">\n                  {buckets[hoveredIndex].male} mannen\n                </span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <div \n                  className=\"w-3 h-3 rounded-full\"\n                  style={{ backgroundColor: colors.female }}\n                />\n                <span className=\"text-gray-700\">\n                  {buckets[hoveredIndex].female} vrouwen\n                </span>\n              </div>\n              <div className=\"border-t border-gray-200 pt-1 mt-2\">\n                <span className=\"font-medium text-gray-800\">\n                  Totaal: {buckets[hoveredIndex].male + buckets[hoveredIndex].female}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":5083},"client/src/components/dashboard/age-gender-chart.tsx":{"content":"import React, { useMemo } from 'react';\nimport { StackedBars } from '@/components/charts/stacked-bars';\nimport { useQuery } from '@tanstack/react-query';\nimport { calcPercents } from '@/lib/utils/age-gender';\n\nexport default function AgeGenderCard() {\n  const { data: members } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n  \n  const { total, buckets } = useMemo(() => {\n    if (!Array.isArray(members)) {\n      return {\n        total: 0,\n        buckets: [\n          { label: '<18', male: 0, female: 0 },\n          { label: '18-25', male: 0, female: 0 },\n          { label: '26-35', male: 0, female: 0 },\n          { label: '36-45', male: 0, female: 0 },\n          { label: '46-55', male: 0, female: 0 },\n          { label: '56-65', male: 0, female: 0 },\n          { label: '65+', male: 0, female: 0 },\n        ]\n      };\n    }\n    \n    const totalMembers = members.length;\n    \n    // Bereken leeftijd uit geboortedatum en groepeer per categorie en geslacht\n    const ageBuckets = {\n      '<18': { male: 0, female: 0 },\n      '18-25': { male: 0, female: 0 },\n      '26-35': { male: 0, female: 0 },\n      '36-45': { male: 0, female: 0 },\n      '46-55': { male: 0, female: 0 },\n      '56-65': { male: 0, female: 0 },\n      '65+': { male: 0, female: 0 },\n    };\n    \n    members.forEach((member: any) => {\n      if (!member.birthDate) return;\n      \n      const age = new Date().getFullYear() - new Date(member.birthDate).getFullYear();\n      const gender = member.gender === 'M' ? 'male' : 'female';\n      \n      let bucket = '65+';\n      if (age < 18) bucket = '<18';\n      else if (age >= 18 && age <= 25) bucket = '18-25';\n      else if (age >= 26 && age <= 35) bucket = '26-35';\n      else if (age >= 36 && age <= 45) bucket = '36-45';\n      else if (age >= 46 && age <= 55) bucket = '46-55';\n      else if (age >= 56 && age <= 65) bucket = '56-65';\n      \n      ageBuckets[bucket as keyof typeof ageBuckets][gender as 'male' | 'female']++;\n    });\n    \n    const buckets = Object.entries(ageBuckets).map(([range, counts]) => ({\n      label: range,\n      male: counts.male,\n      female: counts.female\n    }));\n    \n    return { total: totalMembers, buckets };\n  }, [members]);\n  \n  const enrichedBuckets = calcPercents(buckets, total);\n\n  return (\n    <div \n      className=\"glass-card rounded-2xl card-hover animate-fade-in group focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-40\"\n      style={{ \n        padding: '20px 24px'\n      }}\n      tabIndex={0}\n    >\n      {/* Header with Total */}\n      <div className=\"mb-4 pb-3 border-b border-gray-200\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <h3 className=\"text-lg font-semibold font-['Poppins'] text-foreground group-hover:text-primary transition-colors duration-300\">\n              Leeftijd en Geslacht\n            </h3>\n            <p className=\"text-sm font-['Poppins'] text-muted-foreground\">\n              Statistieken\n            </p>\n          </div>\n          <div className=\"text-right\">\n            <div className=\"text-sm font-['Poppins']\" style={{ color: '#64748B' }}>\n              Totaal\n            </div>\n            <div \n              className=\"text-3xl font-bold font-['Poppins']\" \n              style={{ color: '#0F172A' }}\n            >\n              {new Intl.NumberFormat('nl-BE').format(total)}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Legend */}\n      <div className=\"flex items-center space-x-6 mb-4\">\n        <div className=\"flex items-center space-x-2\">\n          <div \n            className=\"w-3 h-3 rounded-full\" \n            style={{ backgroundColor: '#3B82F6' }}\n          ></div>\n          <span className=\"text-sm font-['Poppins']\" style={{ color: '#475569' }}>\n            Man\n          </span>\n        </div>\n        <div className=\"flex items-center space-x-2\">\n          <div \n            className=\"w-3 h-3 rounded-full\" \n            style={{ backgroundColor: '#A855F7' }}\n          ></div>\n          <span className=\"text-sm font-['Poppins']\" style={{ color: '#475569' }}>\n            Vrouw\n          </span>\n        </div>\n      </div>\n\n      {/* Stacked Bars */}\n      <StackedBars buckets={enrichedBuckets} />\n    </div>\n  );\n}","size_bytes":4238},"client/src/components/dashboard/due-dates.tsx":{"content":"import { ChevronRight } from 'lucide-react';\nimport { BiCalendarExclamation } from 'react-icons/bi';\nimport { Button } from '@/components/ui/button';\nimport { useQuery } from '@tanstack/react-query';\nimport { useMemo } from 'react';\nimport { differenceInDays, parseISO } from 'date-fns';\n\nexport default function DueDates() {\n  const { data: fees } = useQuery({\n    queryKey: [\"/api/fees\"],\n  });\n  \n  const dueDates = useMemo(() => {\n    if (!Array.isArray(fees)) {\n      return [\n        {\n          id: 1,\n          name: 'Geen openstaande facturen',\n          category: 'Systeem',\n          daysLeft: 0,\n          status: 'info'\n        }\n      ];\n    }\n    \n    const openFees = fees\n      .filter((fee: any) => fee.status === 'OPEN' || fee.status === 'OVERDUE')\n      .map((fee: any) => {\n        const periodEnd = parseISO(fee.periodEnd);\n        const today = new Date();\n        const daysLeft = differenceInDays(periodEnd, today);\n        \n        // Map database categories to display categories\n        let category = 'Standaard';\n        const memberCategory = fee.memberName?.split(' - ')[1]; // Assuming format \"Name - Category\"\n        if (memberCategory === 'STUDENT') category = 'Student';\n        else if (memberCategory === 'SENIOR') category = 'Senior';\n        else if (memberCategory === 'STANDAARD') category = 'Standaard';\n        \n        let status = 'upcoming';\n        if (daysLeft <= 0) status = 'today';\n        else if (daysLeft <= 3) status = 'urgent';\n        \n        return {\n          id: fee.id,\n          name: fee.memberName?.split(' - ')[0] || 'Onbekend lid',\n          category,\n          daysLeft: Math.abs(daysLeft),\n          status,\n          amount: parseFloat(fee.amount)\n        };\n      })\n      .sort((a, b) => a.daysLeft - b.daysLeft)\n      .slice(0, 5); // Toon top 5\n    \n    return openFees.length > 0 ? openFees : [\n      {\n        id: 1,\n        name: 'Alle facturen zijn bijgewerkt',\n        category: 'Systeem',\n        daysLeft: 0,\n        status: 'success'\n      }\n    ];\n  }, [fees]);\n  \n  return (\n    <div className=\"glass-card rounded-2xl p-6 card-hover animate-fade-in group\">\n      <div className=\"mb-6 pb-4 border-b border-gray-200\">\n        <h3 className=\"text-lg font-semibold text-foreground group-hover:text-primary transition-colors duration-300\">Aankomende Vervaldagen</h3>\n        <p className=\"text-sm text-muted-foreground\">Lidgelden die binnenkort vervallen</p>\n      </div>\n      \n      <div className=\"space-y-4\">\n        {dueDates.map((item) => (\n          <div key={item.id} className=\"flex items-center space-x-3\">\n            <div className=\"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 bg-red-50\">\n              <BiCalendarExclamation className=\"h-4 w-4 text-red-600\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <p className=\"text-sm font-medium text-gray-900\">\n                {item.name}\n              </p>\n              <p className=\"text-sm text-gray-500\">\n                {item.category}\n              </p>\n            </div>\n            <div className=\"text-right flex-shrink-0\">\n              {item.status === 'today' ? (\n                <span className=\"px-2 py-1 text-xs font-medium bg-red-100 text-red-700 rounded-full\">\n                  Vandaag\n                </span>\n              ) : item.status === 'urgent' ? (\n                <span className=\"px-2 py-1 text-xs font-medium bg-orange-100 text-orange-700 rounded-full\">\n                  {item.daysLeft} {item.daysLeft === 1 ? 'dag' : 'dagen'}\n                </span>\n              ) : item.status === 'success' ? (\n                <span className=\"px-2 py-1 text-xs font-medium bg-green-100 text-green-700 rounded-full\">\n                  ✓\n                </span>\n              ) : (\n                <span className=\"text-sm font-medium text-gray-900\">\n                  {item.daysLeft} {item.daysLeft === 1 ? 'dag' : 'dagen'}\n                </span>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}","size_bytes":4061},"client/src/components/dashboard/members-by-category.tsx":{"content":"import React, { useMemo } from 'react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip } from 'recharts';\nimport { useQuery } from '@tanstack/react-query';\n\nexport default function MembersByCategoryCard() {\n  const { data: members } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n  \n  const { total, categories } = useMemo(() => {\n    if (!Array.isArray(members)) {\n      return {\n        total: 0,\n        categories: [\n          { key: 'standaard', label: 'Standaard', count: 0, percent: 0, color: '#3B82F6' },\n          { key: 'senior', label: 'Senior', count: 0, percent: 0, color: '#1E3A8A' },\n          { key: 'student', label: 'Student', count: 0, percent: 0, color: '#06B6D4' },\n        ]\n      };\n    }\n    \n    const totalMembers = members.length;\n    const categoryCounts = members.reduce((acc: any, member: any) => {\n      // Map database categories to display categories\n      let category = 'Standaard';\n      if (member.category === 'STUDENT') category = 'Student';\n      else if (member.category === 'SENIOR') category = 'Senior';\n      else if (member.category === 'STANDAARD') category = 'Standaard';\n      \n      acc[category] = (acc[category] || 0) + 1;\n      return acc;\n    }, {});\n    \n    const categories = [\n      {\n        key: 'standaard',\n        label: 'Standaard',\n        count: categoryCounts['Standaard'] || 0,\n        percent: totalMembers > 0 ? Math.round(((categoryCounts['Standaard'] || 0) / totalMembers) * 100) : 0,\n        color: '#3B82F6'\n      },\n      {\n        key: 'senior',\n        label: 'Senior',\n        count: categoryCounts['Senior'] || 0,\n        percent: totalMembers > 0 ? Math.round(((categoryCounts['Senior'] || 0) / totalMembers) * 100) : 0,\n        color: '#1E3A8A'\n      },\n      {\n        key: 'student',\n        label: 'Student',\n        count: categoryCounts['Student'] || 0,\n        percent: totalMembers > 0 ? Math.round(((categoryCounts['Student'] || 0) / totalMembers) * 100) : 0,\n        color: '#06B6D4'\n      }\n    ];\n    \n    return { total: totalMembers, categories };\n  }, [members]);\n\n  return (\n    <div \n      className=\"glass-card rounded-2xl card-hover animate-fade-in group tabindex-0 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-40\"\n      style={{ \n        padding: '24px 28px'\n      }}\n      tabIndex={0}\n    >\n      {/* Header */}\n      <div className=\"mb-6 pb-4 border-b border-gray-200\">\n        <h3 className=\"text-lg font-semibold font-['Poppins'] text-foreground group-hover:text-primary transition-colors duration-300\">\n          Leden per Categorie\n        </h3>\n        <p className=\"text-sm font-['Poppins'] text-muted-foreground\">\n          Statistieken\n        </p>\n      </div>\n\n      {/* Content Layout - Horizontal for wider space */}\n      <div className=\"flex flex-col lg:flex-row items-center lg:items-start gap-8\">\n        {/* Left side - Chart */}\n        <div className=\"flex-shrink-0\" style={{ width: '240px', height: '240px' }}>\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\n            <PieChart>\n              <defs>\n                <linearGradient id=\"gradient-standaard\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                  <stop offset=\"0%\" stopColor=\"#3B82F6\" />\n                  <stop offset=\"100%\" stopColor=\"#60A5FA\" />\n                </linearGradient>\n                <linearGradient id=\"gradient-senior\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                  <stop offset=\"0%\" stopColor=\"#1E3A8A\" />\n                  <stop offset=\"100%\" stopColor=\"#3B82F6\" />\n                </linearGradient>\n                <linearGradient id=\"gradient-student\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n                  <stop offset=\"0%\" stopColor=\"#06B6D4\" />\n                  <stop offset=\"100%\" stopColor=\"#67E8F9\" />\n                </linearGradient>\n              </defs>\n              <Pie\n                data={(() => {\n                  // Als er geen data is, toon een lege cirkel met gelijke stukken\n                  const hasData = categories.some(cat => cat.count > 0);\n                  if (!hasData) {\n                    return categories.map(cat => ({ ...cat, count: 1 }));\n                  }\n                  return categories.filter(cat => cat.count > 0);\n                })()}\n                dataKey=\"count\"\n                nameKey=\"label\"\n                cx=\"50%\"\n                cy=\"50%\"\n                outerRadius={90}\n                innerRadius={0}\n                strokeWidth={2}\n                stroke=\"#ffffff\"\n              >\n                {(() => {\n                  const hasData = categories.some(cat => cat.count > 0);\n                  const dataToRender = hasData \n                    ? categories.filter(cat => cat.count > 0)\n                    : categories;\n                  \n                  return dataToRender.map((category, index) => {\n                    const getGradientId = (key: string) => {\n                      if (!hasData) return '#E5E7EB'; // Grijs voor lege state\n                      switch (key) {\n                        case 'standaard': return 'url(#gradient-standaard)';\n                        case 'senior': return 'url(#gradient-senior)';\n                        case 'student': return 'url(#gradient-student)';\n                        default: return 'url(#gradient-standaard)';\n                      }\n                    };\n                    return (\n                      <Cell key={`cell-${index}`} fill={getGradientId(category.key)} />\n                    );\n                  });\n                })()}\n              </Pie>\n              <Tooltip \n                formatter={(value: number, name: string) => [\n                  `${value} ${value === 1 ? 'lid' : 'leden'}`,\n                  name\n                ]}\n                labelStyle={{ color: '#0F172A', fontWeight: '600' }}\n                contentStyle={{ \n                  backgroundColor: 'white',\n                  border: '1px solid #E2E8F0',\n                  borderRadius: '12px',\n                  fontSize: '14px',\n                  fontFamily: 'Poppins',\n                  boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)'\n                }}\n              />\n            </PieChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Right side - Total + Legend */}\n        <div className=\"flex-1 space-y-6\">\n          {/* Large Total - Centered */}\n          <div className=\"text-center\">\n            <div \n              className=\"text-4xl font-bold font-['Poppins']\" \n              style={{ color: '#0F172A' }}\n            >\n              {new Intl.NumberFormat('nl-BE').format(total)}\n            </div>\n            <div \n              className=\"text-sm font-['Poppins']\" \n              style={{ color: '#64748B' }}\n            >\n              Totaal leden\n            </div>\n          </div>\n\n          {/* Divider */}\n          <div style={{ borderTop: '1px solid #E2E8F0' }}></div>\n\n          {/* Legend */}\n          <div className=\"space-y-3\">\n            {categories.map((category, index) => (\n              <div key={category.key} className=\"flex items-center justify-between\">\n                <div className=\"flex items-center space-x-3\">\n                  <div \n                    className=\"w-3 h-3 rounded-full flex-shrink-0\"\n                    style={{ backgroundColor: category.color }}\n                  ></div>\n                  <span \n                    className=\"text-base font-['Poppins']\" \n                    style={{ color: '#475569' }}\n                  >\n                    {category.label}\n                  </span>\n                </div>\n                <div className=\"text-right\">\n                  <div \n                    className=\"text-lg font-semibold font-['Poppins']\" \n                    style={{ color: '#0F172A' }}\n                  >\n                    {new Intl.NumberFormat('nl-BE').format(category.count)}\n                  </div>\n                  <div \n                    className=\"text-xs font-['Poppins']\" \n                    style={{ color: '#94A3B8' }}\n                  >\n                    {category.percent}%\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":8233},"client/src/components/dashboard/modern-kpi-cards.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Users, UserCheck, Euro, Clock, Vote } from \"lucide-react\";\nimport { HiInboxArrowDown } from \"react-icons/hi2\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\ninterface KpiCardProps {\n  title: string;\n  value: string;\n  delta: {\n    value: string;\n    positive: boolean;\n  };\n  icon: React.ReactNode;\n  iconBgColor: string;\n  deltaColor?: string;\n}\n\nfunction KpiCard({ title, value, delta, icon, iconBgColor, deltaColor }: KpiCardProps) {\n  return (\n    <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group relative overflow-hidden\">\n      {/* Subtle gradient overlay */}\n      <div className=\"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\n      \n      <div className=\"flex items-center justify-between relative z-10\">\n        <div className=\"flex-1\">\n          <p className=\"text-xs font-medium text-muted-foreground mb-1\">{title}</p>\n          <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300 tabular-nums\">{value}</p>\n          <div className=\"flex items-center space-x-1\">\n            <span className={`text-xs font-medium ${deltaColor || (delta.positive ? 'text-green-600' : 'text-red-500')} group-hover:text-opacity-80 transition-all duration-300`}>\n              {delta.value}\n            </span>\n          </div>\n        </div>\n        <div className={`w-10 h-10 ${iconBgColor} rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-all duration-300 relative`}>\n          <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent rounded-xl\"></div>\n          <div className=\"relative\">{icon}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function ModernKpiCards() {\n  const { data: stats, isLoading, isFetching } = useQuery({\n    queryKey: [\"/api/dashboard/stats\"],\n    staleTime: 5000, // 5 seconds for dashboard stats\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  // Altijd KPI data tonen, ook zonder stats\n  const kpiData = [\n    {\n      title: \"Totaal Leden\",\n      value: isLoading ? \"...\" : ((stats as any)?.totalMembers?.toString() || \"0\"),\n      delta: { value: \"Totaal aantal leden\", positive: true },\n      icon: <Users className=\"h-4 w-4 text-blue-600\" />,\n      iconBgColor: \"bg-blue-50\",\n      deltaColor: \"text-blue-600\"\n    },\n    {\n      title: \"Actieve Leden\", \n      value: isLoading ? \"...\" : ((stats as any)?.activeMembers?.toString() || \"0\"),\n      delta: { value: \"Actieve leden\", positive: true },\n      icon: <UserCheck className=\"h-4 w-4 text-green-600\" />,\n      iconBgColor: \"bg-green-50\",\n      deltaColor: \"text-green-600\"\n    },\n    {\n      title: \"Stemgerechtigden\",\n      value: isLoading ? \"...\" : ((stats as any)?.activeMembers?.toString() || \"0\"),\n      delta: { value: \"Van actieve leden\", positive: true },\n      icon: <Vote className=\"h-4 w-4 text-amber-500\" />,\n      iconBgColor: \"bg-amber-50\",\n      deltaColor: \"text-amber-500\"\n    },\n    {\n      title: \"Openstaande Betalingen\",\n      value: isLoading ? \"...\" : `€${(((stats as any)?.outstanding || 0)).toFixed(2)}`,\n      delta: { value: \"Te betalen bedragen\", positive: false },\n      icon: <Clock className=\"h-4 w-4 text-orange-500\" />,\n      iconBgColor: \"bg-orange-50\"\n    },\n    {\n      title: \"Inkomsten Deze Maand\",\n      value: isLoading ? \"...\" : `€${(((stats as any)?.monthlyIncome || 0)).toFixed(2)}`,\n      delta: { value: \"Deze maand\", positive: true },\n      icon: <HiInboxArrowDown className=\"h-4 w-4 text-blue-600\" />,\n      iconBgColor: \"bg-blue-50\",\n      deltaColor: \"text-blue-600\"\n    }\n  ];\n\n  return (\n    <div className=\"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 mb-6\">\n      {kpiData.map((kpi, index) => (\n        <KpiCard\n          key={index}\n          title={kpi.title}\n          value={kpi.value}\n          delta={kpi.delta}\n          icon={kpi.icon}\n          iconBgColor={kpi.iconBgColor}\n          deltaColor={kpi.deltaColor}\n        />\n      ))}\n    </div>\n  );\n}","size_bytes":4202},"client/src/components/dashboard/payment-status-chart.tsx":{"content":"import React, { useMemo } from 'react';\nimport { PieChart, Pie, Cell, ResponsiveContainer } from 'recharts';\nimport { useQuery } from '@tanstack/react-query';\n\ninterface PaymentStatusData {\n  name: string;\n  value: number;\n  color: string;\n}\n\nconst PaymentStatusChart = React.memo(function PaymentStatusChart() {\n  const { data: fees } = useQuery({\n    queryKey: [\"/api/fees\"],\n  });\n  \n  const data: PaymentStatusData[] = useMemo(() => {\n    // Optimized counting with a single pass\n    const counts = Array.isArray(fees) && fees.length > 0 \n      ? fees.reduce((acc: any, f: any) => {\n          if (f.status === 'PAID') acc.paid++;\n          else if (f.status === 'OPEN') acc.open++;\n          else if (f.status === 'OVERDUE') acc.overdue++;\n          return acc;\n        }, { paid: 0, open: 0, overdue: 0 })\n      : { paid: 0, open: 0, overdue: 0 };\n    \n    // Als alle waarden 0 zijn, toon een minimale waarde zodat de grafiek zichtbaar is\n    const hasData = counts.paid > 0 || counts.open > 0 || counts.overdue > 0;\n    \n    return [\n      { name: 'Betaald', value: hasData ? counts.paid : 1, color: hasData ? '#16A34A' : '#E5E7EB' },\n      { name: 'Openstaand', value: hasData ? counts.open : 1, color: hasData ? '#F59E0B' : '#E5E7EB' },\n      { name: 'Vervallen', value: hasData ? counts.overdue : 1, color: hasData ? '#EF4444' : '#E5E7EB' },\n    ];\n  }, [fees]);\n  \n  // Bereken het echte totaal (zonder de minimale waarden voor lege grafiek)\n  const total = useMemo(() => {\n    if (!Array.isArray(fees) || fees.length === 0) return 0;\n    return fees.length;\n  }, [fees]);\n  \n  return (\n    <div className=\"glass-card rounded-2xl p-6 card-hover animate-fade-in group\">\n      <div className=\"mb-6 pb-4 border-b border-gray-200\">\n        <h3 className=\"text-lg font-semibold text-foreground group-hover:text-primary transition-colors duration-300\">Betalingsstatus</h3>\n        <p className=\"text-sm text-muted-foreground\">Verdeling van betalingen</p>\n      </div>\n      \n      <div className=\"relative h-64 mb-6\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <PieChart>\n            <Pie\n              data={data}\n              cx=\"50%\"\n              cy=\"75%\"\n              startAngle={180}\n              endAngle={0}\n              innerRadius={80}\n              outerRadius={120}\n              paddingAngle={2}\n              dataKey=\"value\"\n            >\n              {data.map((entry, index) => (\n                <Cell key={`cell-${index}`} fill={entry.color} />\n              ))}\n            </Pie>\n          </PieChart>\n        </ResponsiveContainer>\n        <div className=\"absolute inset-0 flex flex-col items-center justify-center\" style={{ top: '30%' }}>\n          <div className=\"text-2xl font-bold text-gray-900\">{total.toLocaleString('nl-BE')}</div>\n          <div className=\"text-sm text-gray-500\">Totaal Facturen</div>\n        </div>\n      </div>\n\n      <div className=\"space-y-3\">\n        {data.map((item, index) => {\n          // Bereken de echte waarde voor de legenda\n          let realValue = 0;\n          if (Array.isArray(fees) && fees.length > 0) {\n            const counts = fees.reduce((acc: any, f: any) => {\n              if (f.status === 'PAID') acc.paid++;\n              else if (f.status === 'OPEN') acc.open++;\n              else if (f.status === 'OVERDUE') acc.overdue++;\n              return acc;\n            }, { paid: 0, open: 0, overdue: 0 });\n            \n            if (item.name === 'Betaald') realValue = counts.paid;\n            else if (item.name === 'Openstaand') realValue = counts.open;\n            else if (item.name === 'Vervallen') realValue = counts.overdue;\n          }\n          \n          return (\n            <div key={index} className=\"flex items-center justify-between\">\n              <div className=\"flex items-center space-x-2\">\n                <div \n                  className=\"w-3 h-3 rounded-full\" \n                  style={{ backgroundColor: item.color }}\n                ></div>\n                <span className=\"text-sm font-medium text-gray-700\">{item.name}</span>\n              </div>\n              <span className=\"text-sm font-semibold text-gray-900\">\n                {realValue.toLocaleString('nl-BE')}\n              </span>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nexport default PaymentStatusChart;","size_bytes":4335},"client/src/components/dashboard/recent-activities.tsx":{"content":"import React, { useMemo } from 'react';\nimport { UserPlus, CreditCard } from 'lucide-react';\nimport { LuUserCog } from 'react-icons/lu';\nimport { RiSettings4Line } from 'react-icons/ri';\nimport { GiPayMoney } from 'react-icons/gi';\nimport { useQuery } from '@tanstack/react-query';\nimport { formatDistanceToNow } from 'date-fns';\nimport { nl } from 'date-fns/locale';\n\nconst RecentActivities = React.memo(function RecentActivities() {\n  const { data: transactions } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n  \n  const activities = useMemo(() => {\n    if (!Array.isArray(transactions) || transactions.length === 0) {\n      return [\n        {\n          id: 1,\n          user: 'Systeem',\n          action: 'Geen recente activiteiten',\n          time: 'Nu',\n          icon: RiSettings4Line,\n          iconBg: 'bg-gray-50',\n          iconColor: 'text-gray-600'\n        }\n      ];\n    }\n    \n    // Optimized: take only first 5 and avoid unnecessary operations\n    return transactions.slice(0, 5).map((t: any, index: number) => ({\n      id: index + 1,\n      user: t.memberName || 'Onbekend lid',\n      action: t.type === 'INCOME' ? 'Betaling ontvangen' : 'Uitgave geregistreerd',\n      time: formatDistanceToNow(new Date(t.date), { addSuffix: true, locale: nl }),\n      icon: t.type === 'INCOME' ? GiPayMoney : UserPlus,\n      iconBg: t.type === 'INCOME' ? 'bg-green-50' : 'bg-red-50',\n      iconColor: t.type === 'INCOME' ? 'text-green-600' : 'text-red-600'\n    }));\n  }, [transactions]);\n  \n  return (\n    <div className=\"glass-card rounded-2xl p-6 card-hover animate-fade-in group\">\n      <div className=\"mb-6 pb-4 border-b border-gray-200\">\n        <h3 className=\"text-lg font-semibold text-foreground group-hover:text-primary transition-colors duration-300\">Recente Activiteiten</h3>\n        <p className=\"text-sm text-muted-foreground\">Laatste wijzigingen en acties</p>\n      </div>\n      \n      <div className=\"space-y-4\">\n        {activities.map((activity) => {\n          const IconComponent = activity.icon;\n          return (\n            <div key={activity.id} className=\"flex items-start space-x-3\">\n              <div className={`w-8 h-8 ${activity.iconBg} rounded-full flex items-center justify-center flex-shrink-0`}>\n                <IconComponent className={`h-4 w-4 ${activity.iconColor}`} />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <p className=\"text-sm font-medium text-gray-900\">\n                  {activity.user}\n                </p>\n                <p className=\"text-sm text-gray-500\">\n                  {activity.action}\n                </p>\n              </div>\n              <div className=\"text-xs text-gray-400 flex-shrink-0\">\n                {activity.time}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n});\n\nexport default RecentActivities;","size_bytes":2871},"client/src/components/dashboard/revenue-by-category.tsx":{"content":"import React, { useState, useMemo } from 'react';\nimport { SegmentedControl } from '@/components/ui/segmented-control';\nimport { useQuery } from '@tanstack/react-query';\nimport { formatCurrencyShortEUR } from '@/lib/utils/currency';\n\ninterface IncomeData {\n  category: string;\n  amount: number;\n  members: number;\n}\n\nexport default function IncomeByCategoryCard() {\n  const [period, setPeriod] = useState<'monthly' | 'yearly'>('yearly');\n  \n  const { data: transactions } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n  \n  const { data: members } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n  \n  const data = useMemo(() => {\n    if (!Array.isArray(transactions) || !Array.isArray(members)) {\n      return [\n        { category: 'Senior', amount: 0, members: 0 },\n        { category: 'Standaard', amount: 0, members: 0 },\n        { category: 'Student', amount: 0, members: 0 },\n      ];\n    }\n    \n    // Groepeer leden per categorie\n    const membersByCategory = members.reduce((acc: any, member: any) => {\n      // Map database categories to display categories\n      let category = 'Standaard';\n      if (member.category === 'STUDENT') category = 'Student';\n      else if (member.category === 'SENIOR') category = 'Senior';\n      else if (member.category === 'STANDAARD') category = 'Standaard';\n      \n      if (!acc[category]) {\n        acc[category] = { count: 0, totalIncome: 0 };\n      }\n      acc[category].count++;\n      return acc;\n    }, {});\n    \n    // Bereken inkomsten per categorie - voor nu simuleren we data gebaseerd op aantal leden\n    const incomeByCategory: any = {};\n    \n    // Simuleer lidgelden gebaseerd op aantal leden per categorie\n    Object.keys(membersByCategory).forEach(category => {\n      const memberCount = membersByCategory[category].count;\n      let monthlyFee = 25; // Default fee\n      \n      if (category === 'Student') monthlyFee = 15;\n      else if (category === 'Senior') monthlyFee = 20;\n      else if (category === 'Standaard') monthlyFee = 25;\n      \n      const yearlyIncome = memberCount * monthlyFee * (period === 'yearly' ? 12 : 1);\n      incomeByCategory[category] = yearlyIncome;\n    });\n    \n    // Zorg er altijd voor dat alle categorieën getoond worden\n    const allCategories = ['Student', 'Standaard', 'Senior'];\n    \n    const result = allCategories.map(category => ({\n      category,\n      amount: incomeByCategory[category] || 0,\n      members: membersByCategory[category]?.count || 0\n    }));\n    \n    return result;\n  }, [transactions, members, period]);\n  \n  const maxAmount = Math.max(...data.map(item => item.amount), 1);\n\n  const periodOptions = [\n    { value: 'monthly', label: 'Maandelijks' },\n    { value: 'yearly', label: 'Jaarlijks' },\n  ];\n\n  return (\n    <div className=\"glass-card rounded-2xl p-6 card-hover animate-fade-in group col-span-full\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6 pb-4 border-b border-gray-200\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-foreground group-hover:text-primary transition-colors duration-300 font-['Poppins']\">Inkomsten per Categorie</h3>\n          <p className=\"text-sm text-muted-foreground font-['Poppins']\">Lidgelden opgesplitst per lidcategorie</p>\n        </div>\n        <SegmentedControl\n          options={periodOptions}\n          value={period}\n          onChange={(value) => setPeriod(value as 'monthly' | 'yearly')}\n        />\n      </div>\n\n      {/* Horizontal Bars */}\n      <div className=\"space-y-6\">\n        {data.map((item, index) => {\n          const widthPercentage = maxAmount > 0 ? (item.amount / maxAmount) * 100 : 0;\n          \n          // Gradient colors for each category\n          const getBarGradient = (category: string) => {\n            switch (category) {\n              case 'Senior':\n                return 'linear-gradient(135deg, #1E3A8A 0%, #3B82F6 100%)'; // Dark blue to medium blue\n              case 'Standaard':\n                return 'linear-gradient(135deg, #3B82F6 0%, #60A5FA 100%)'; // Medium blue to light blue\n              case 'Student':\n                return 'linear-gradient(135deg, #06B6D4 0%, #67E8F9 100%)'; // Cyan to light cyan\n              default:\n                return 'linear-gradient(135deg, #3B82F6 0%, #60A5FA 100%)'; // Default gradient\n            }\n          };\n          \n          return (\n            <div key={index} className=\"flex items-center\">\n              {/* Category Label */}\n              <div className=\"w-20 flex-shrink-0\">\n                <span className=\"text-sm font-medium text-gray-900 font-['Poppins']\">\n                  {item.category}\n                </span>\n              </div>\n              \n              {/* Bar Container */}\n              <div className=\"flex-1 mx-4\">\n                <div \n                  className=\"h-5 bg-gray-100 rounded-full relative overflow-hidden\"\n                  role=\"progressbar\"\n                  aria-label={`${item.category}: ${formatCurrencyShortEUR(item.amount)}`}\n                  aria-valuenow={item.amount}\n                  aria-valuemax={maxAmount}\n                >\n                  <div\n                    className=\"h-full rounded-full transition-[width] duration-200 ease-out\"\n                    style={{\n                      width: `${widthPercentage}%`,\n                      background: getBarGradient(item.category),\n                    }}\n                  />\n                </div>\n              </div>\n              \n              {/* Right Values */}\n              <div className=\"w-24 text-right flex-shrink-0\">\n                <div className=\"text-sm font-bold text-blue-600 font-['Poppins']\">\n                  {formatCurrencyShortEUR(item.amount)}\n                </div>\n                <div className=\"text-xs text-gray-500 font-['Poppins']\">\n                  {item.members} leden\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}","size_bytes":5957},"client/src/components/dashboard/revenue-chart.tsx":{"content":"import { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, Area, AreaChart } from 'recharts';\nimport { useQuery } from '@tanstack/react-query';\nimport { useState, useMemo } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\n\nexport default function RevenueChart() {\n  const [quarterOffset, setQuarterOffset] = useState(0); // 0 = huidig kwartaal, -1 = vorig kwartaal, +1 = volgend kwartaal\n  \n  const { data: transactions } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n  \n  const data = useMemo(() => {\n    if (!Array.isArray(transactions)) {\n      // Toon 3 maanden voor huidig trimester\n      const result = [];\n      for (let i = 2; i >= 0; i--) {\n        const date = new Date();\n        date.setMonth(date.getMonth() - i + (quarterOffset * 3));\n        const monthName = date.toLocaleDateString('nl-BE', { month: 'short' });\n        result.push({ month: monthName, revenue: 0 });\n      }\n      return result;\n    }\n    \n    // Bereken inkomsten voor 3 maanden van geselecteerd trimester\n    const monthlyRevenue = [];\n    for (let i = 2; i >= 0; i--) {\n      const date = new Date();\n      date.setMonth(date.getMonth() - i + (quarterOffset * 3));\n      const year = date.getFullYear();\n      const month = date.getMonth();\n      const monthName = date.toLocaleDateString('nl-BE', { month: 'short' });\n      \n      const monthRevenue = transactions\n        .filter((t: any) => {\n          const transactionDate = new Date(t.date);\n          return transactionDate.getFullYear() === year && \n                 transactionDate.getMonth() === month &&\n                 t.type === 'INCOME';\n        })\n        .reduce((sum: number, t: any) => sum + Math.abs(parseFloat(t.amount)), 0);\n      \n      monthlyRevenue.push({ month: monthName, revenue: monthRevenue });\n    }\n    \n    return monthlyRevenue;\n  }, [transactions, quarterOffset]);\n  \n  // Bereken dynamische Y-as schaal\n  const maxRevenue = Math.max(...data.map(d => d.revenue), 100);\n  const yAxisMax = Math.ceil(maxRevenue * 1.1);\n  \n  // Helper functies voor kwartaal navigatie\n  const goToPreviousQuarter = () => setQuarterOffset(quarterOffset - 1);\n  const goToNextQuarter = () => setQuarterOffset(quarterOffset + 1);\n  const goToCurrentQuarter = () => setQuarterOffset(0);\n  \n  // Bepaal kwartaal label\n  const currentQuarterDate = new Date();\n  currentQuarterDate.setMonth(currentQuarterDate.getMonth() + (quarterOffset * 3));\n  const year = currentQuarterDate.getFullYear();\n  const month = currentQuarterDate.getMonth();\n  const quarter = Math.floor(month / 3) + 1;\n  \n  // Bepaal periode label\n  const periodLabel = `${quarter}e trimester ${year}`;\n  \n  return (\n    <div className=\"glass-card rounded-2xl p-6 card-hover animate-fade-in group\">\n      <div className=\"mb-6 pb-4 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-foreground group-hover:text-primary transition-colors duration-300\">Evolutie Inkomsten</h3>\n            <p className=\"text-sm text-muted-foreground\">Lidgelden per maand</p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button \n              variant=\"outline\" \n              size=\"sm\" \n              onClick={goToPreviousQuarter}\n              className=\"h-8 w-8 p-0\"\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </Button>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              onClick={goToCurrentQuarter}\n              className=\"text-xs px-3\"\n              disabled={quarterOffset === 0}\n            >\n              Vandaag\n            </Button>\n            <Button \n              variant=\"outline\" \n              size=\"sm\" \n              onClick={goToNextQuarter}\n              className=\"h-8 w-8 p-0\"\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n      <div className=\"relative\">\n        <h4 className=\"text-lg font-semibold mb-4 text-center text-[#2463eb]\">{periodLabel}</h4>\n        <div className=\"h-64\">\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\n          <AreaChart data={data}>\n            <defs>\n              <linearGradient id=\"colorRevenue\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                <stop offset=\"5%\" stopColor=\"#2563EB\" stopOpacity={0.3}/>\n                <stop offset=\"95%\" stopColor=\"#2563EB\" stopOpacity={0}/>\n              </linearGradient>\n            </defs>\n            <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#F3F4F6\" />\n            <XAxis \n              dataKey=\"month\" \n              axisLine={false}\n              tickLine={false}\n              tick={{ fontSize: 12, fill: '#64748B' }}\n            />\n            <YAxis \n              axisLine={false}\n              tickLine={false}\n              tick={{ fontSize: 12, fill: '#64748B' }}\n              domain={[0, yAxisMax]}\n              tickFormatter={(value) => {\n                if (value >= 1000) {\n                  return `€${(value / 1000).toFixed(1)}k`;\n                }\n                return `€${value}`;\n              }}\n            />\n            <Tooltip \n              contentStyle={{\n                backgroundColor: 'white',\n                border: '1px solid #E5E7EB',\n                borderRadius: '8px',\n                boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)'\n              }}\n              formatter={(value: number) => [`€${value.toLocaleString('nl-BE')}`, 'Inkomsten']}\n            />\n            <Area\n              type=\"monotone\"\n              dataKey=\"revenue\"\n              stroke=\"#2563EB\"\n              strokeWidth={3}\n              fill=\"url(#colorRevenue)\"\n              dot={{ fill: 'white', stroke: '#2563EB', strokeWidth: 2, r: 4 }}\n              activeDot={{ r: 6, fill: '#2563EB' }}\n            />\n          </AreaChart>\n        </ResponsiveContainer>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":6045},"client/src/components/layout/navbar.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { \n  LayoutDashboard, \n  Users, \n  CreditCard, \n  BarChart3, \n  Monitor, \n  Settings,\n  Building2,\n  Search,\n  Bell,\n  Command,\n  HelpCircle,\n  Menu,\n  ChevronDown,\n  IdCard,\n  User,\n  Crown,\n  Mail\n} from \"lucide-react\";\nimport { RiMoneyEuroCircleLine, RiUserStarLine } from \"react-icons/ri\";\nimport { PiHandCoinsFill } from \"react-icons/pi\";\nimport darahLogo from \"@assets/DARAH_1756909309495.png\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { getUserInitials } from \"@/lib/auth\";\nimport { useAuth } from \"@/hooks/use-auth\";\n\nconst navigation = [\n  { name: \"Dashboard\", href: \"/dashboard\", icon: LayoutDashboard },\n  { name: \"Leden\", href: \"/leden\", icon: Users },\n  { name: \"Lidkaarten\", href: \"/lidkaarten\", icon: IdCard },\n  { name: \"Lidgelden\", href: \"/lidgelden\", icon: PiHandCoinsFill },\n  { name: \"Financiën\", href: \"/financien\", icon: RiMoneyEuroCircleLine },\n  { name: \"Mijn Bestuur\", href: \"/bestuur\", icon: RiUserStarLine },\n  { name: \"Berichten\", href: \"/berichten\", icon: Mail },\n  { name: \"Publieke Schermen\", href: \"/publieke-schermen\", icon: Monitor },\n  { name: \"Instellingen\", href: \"/instellingen\", icon: Settings },\n];\n\nexport default function Navbar() {\n  const [location] = useLocation();\n  const { user, logout } = useAuth();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  return (\n    <header className=\"sticky top-0 z-40 w-full border-b border-sidebar-border bg-sidebar backdrop-blur supports-[backdrop-filter]:bg-sidebar/95\">\n      <div className=\"w-full flex h-12 items-center pl-0 pr-4 sm:pr-6 lg:pr-8 relative\">\n        {/* Logo - absolute positioning */}\n        <div className=\"absolute left-4 flex items-center\">\n          <Link href=\"/dashboard\" className=\"flex items-center\">\n            <img \n              src={darahLogo} \n              alt=\"DARAH Logo\" \n              className=\"w-56 h-14 xs:w-60 xs:h-15 sm:w-64 sm:h-16 md:w-72 md:h-18 lg:w-80 lg:h-20 object-contain object-left\"\n            />\n          </Link>\n        </div>\n\n        {/* Navigation - perfect gecentreerd over volledige breedte */}\n        <div className=\"w-full flex justify-center overflow-x-auto\">\n          <nav className=\"hidden lg:flex items-center space-x-2 xl:space-x-3\">\n            {navigation.map((item) => {\n              const isActive = location === item.href || (item.href !== \"/dashboard\" && location.startsWith(item.href));\n              const Icon = item.icon;\n              \n              return (\n                <Link\n                  key={item.name}\n                  href={item.href}\n                  className={cn(\n                    \"flex items-center gap-x-1.5 px-2.5 py-2 text-xs xl:text-sm font-medium rounded-xl transition-all duration-300 ease-out whitespace-nowrap\",\n                    isActive\n                      ? \"bg-sidebar-primary text-sidebar-primary-foreground shadow-lg shadow-blue-500/20 scale-105\"\n                      : \"text-sidebar-foreground hover:text-sidebar-foreground hover:bg-sidebar-accent hover:shadow-md hover:scale-102 hover:-translate-y-0.5\"\n                  )}\n                  data-testid={`nav-${item.name.toLowerCase().replace(/\\s+/g, '-')}`}\n                >\n                  <Icon className=\"h-3 w-3 xl:h-3.5 xl:w-3.5\" />\n                  {item.name}\n                </Link>\n              );\n            })}\n          </nav>\n\n          {/* Mobile Menu - alleen op mobiel */}\n          <DropdownMenu open={mobileMenuOpen} onOpenChange={setMobileMenuOpen}>\n            <DropdownMenuTrigger asChild>\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                className=\"lg:hidden h-9 w-9 text-sidebar-foreground hover:bg-sidebar-accent focus-ring relative z-50 touch-manipulation\" \n                data-testid=\"mobile-menu-button\"\n                aria-label=\"Open navigation menu\"\n                style={{ touchAction: 'manipulation' }}\n              >\n                <Menu className=\"h-5 w-5\" />\n                <span className=\"sr-only\">Open navigation menu</span>\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent \n              align=\"end\" \n              className=\"w-56 z-[60] bg-popover border border-border shadow-lg\" \n              sideOffset={8}\n            >\n              {navigation.map((item) => {\n                const isActive = location === item.href || (item.href !== \"/dashboard\" && location.startsWith(item.href));\n                const Icon = item.icon;\n                return (\n                  <DropdownMenuItem key={item.name} asChild>\n                    <Link \n                      href={item.href} \n                      onClick={() => setMobileMenuOpen(false)}\n                      className={cn(\n                        \"flex items-center gap-x-2 cursor-pointer\",\n                        isActive && \"bg-accent text-accent-foreground\"\n                      )}\n                      data-testid={`mobile-nav-${item.name.toLowerCase().replace(/\\s+/g, '-')}`}\n                    >\n                      <Icon className=\"h-4 w-4\" />\n                      {item.name}\n                    </Link>\n                  </DropdownMenuItem>\n                );\n              })}\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n\n        {/* Profiel - absolute positioning rechts */}\n        <div className=\"absolute right-4 sm:right-6 lg:right-8 flex items-center\">\n          {user && (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" size=\"sm\" className=\"flex items-center gap-x-3 h-11 px-4 text-sidebar-foreground hover:bg-sidebar-accent focus-ring rounded-xl transition-all duration-300 ease-out hover:shadow-md hover:scale-102\" data-testid=\"profile-button\">\n                  <div className=\"w-9 h-9 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg ring-2 ring-blue-400/20\">\n                    <span className=\"text-sm font-semibold text-white\">\n                      {getUserInitials(user.name)}\n                    </span>\n                  </div>\n                  <div className=\"hidden sm:flex flex-col items-start\">\n                    <span className=\"text-sm font-medium text-sidebar-foreground\">{user.name}</span>\n                    <span className=\"text-xs text-sidebar-foreground/70\">{user.role}</span>\n                  </div>\n                  <span className=\"sr-only\">Open user menu</span>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-56\">\n                <DropdownMenuItem asChild>\n                  <Link href=\"/profiel\" className=\"flex items-center gap-x-2\" data-testid=\"profile-link\">\n                    <User className=\"h-4 w-4\" />\n                    Mijn Profiel\n                  </Link>\n                </DropdownMenuItem>\n                <DropdownMenuItem onClick={logout} data-testid=\"logout-button\">\n                  Uitloggen\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}","size_bytes":7493},"client/src/components/ui/segmented-control.tsx":{"content":"import React from 'react';\nimport { cn } from '@/lib/utils';\n\ninterface SegmentedControlProps {\n  options: { value: string; label: string }[];\n  value: string;\n  onChange: (value: string) => void;\n  className?: string;\n}\n\nexport function SegmentedControl({ options, value, onChange, className }: SegmentedControlProps) {\n  return (\n    <div className={cn(\"flex bg-gray-100 rounded-lg p-1\", className)}>\n      {options.map((option) => (\n        <button\n          key={option.value}\n          onClick={() => onChange(option.value)}\n          className={cn(\n            \"px-4 py-1 text-sm font-medium rounded-md transition-all duration-200\",\n            value === option.value\n              ? \"bg-blue-600 text-white shadow-sm\"\n              : \"text-gray-700 hover:text-gray-900 hover:bg-gray-200\"\n          )}\n          aria-pressed={value === option.value}\n        >\n          {option.label}\n        </button>\n      ))}\n    </div>\n  );\n}","size_bytes":936},"client/src/lib/mock/age-gender.ts":{"content":"export const ageGender = {\n  total: 1293,\n  buckets: [\n    { label: '<18',   male: 45,  female: 38 },   // 6.4%\n    { label: '18-30', male: 120, female: 95 },   // 16.6%\n    { label: '30-50', male: 180, female: 165 },  // 26.7%\n    { label: '50-65', male: 145, female: 125 },  // 20.9%\n    { label: '65+',   male: 85,  female: 95 },   // 13.9%\n  ],\n};","size_bytes":351},"client/src/lib/mock/income.ts":{"content":"export const yearly = [\n  { category: 'Senior', amount: 50000, members: 420 },\n  { category: 'Standaard', amount: 43000, members: 600 },\n  { category: 'Student', amount: 14000, members: 227 },\n];\n\nexport const monthly = [\n  { category: 'Senior', amount: 4200, members: 420 },\n  { category: 'Standaard', amount: 3600, members: 600 },\n  { category: 'Student', amount: 1200, members: 227 },\n];","size_bytes":390},"client/src/lib/mock/members-by-category.ts":{"content":"export const membersByCategory = {\n  total: 1247,\n  categories: [\n    { key: 'senior',    label: 'Senior',    count: 420, percent: 33.7, color: '#1E3A8A' },\n    { key: 'standaard', label: 'Standaard', count: 600, percent: 48.1, color: '#3B82F6' },\n    { key: 'student',   label: 'Student',   count: 227, percent: 18.2, color: '#06B6D4' },\n  ],\n};","size_bytes":346},"client/src/lib/utils/age-gender.ts":{"content":"import { type Bucket } from '@/components/charts/stacked-bars';\n\nexport function calcPercents(buckets: Array<{ label: string; male: number; female: number }>, total: number): Bucket[] {\n  return buckets.map(bucket => {\n    const rowTotal = bucket.male + bucket.female;\n    const percent = total > 0 ? (rowTotal / total) * 100 : 0;\n    \n    return {\n      ...bucket,\n      percent\n    };\n  });\n}","size_bytes":394},"client/src/lib/utils/currency.ts":{"content":"export function formatCurrencyShortEUR(amount: number, locale = 'nl-BE'): string {\n  if (amount >= 1000000) {\n    return `€${(amount / 1000000).toFixed(1).replace('.0', '')}M`;\n  }\n  if (amount >= 1000) {\n    return `€${(amount / 1000).toFixed(amount >= 10000 ? 0 : 1).replace('.0', '')}k`;\n  }\n  return new Intl.NumberFormat(locale, {\n    style: 'currency',\n    currency: 'EUR',\n    maximumFractionDigits: 0,\n  }).format(amount);\n}","size_bytes":436},"client/src/components/fees/charts.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Fee } from \"@shared/fees-schema\";\nimport { formatCurrencyBE } from \"@/lib/format\";\nimport { PieChart, Pie, Cell, ResponsiveContainer, LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend } from \"recharts\";\nimport { format, parseISO, startOfMonth } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\n\ninterface ChartsProps {\n  fees: Fee[];\n}\n\nexport function Charts({ fees }: ChartsProps) {\n  // Donut chart data\n  const statusData = [\n    {\n      name: \"Betaald\",\n      value: fees.filter(fee => fee.status === \"PAID\").length,\n      amount: fees.filter(fee => fee.status === \"PAID\").reduce((sum, fee) => sum + fee.amount, 0),\n      color: \"#10B981\", // green\n    },\n    {\n      name: \"Openstaand\", \n      value: fees.filter(fee => fee.status === \"OPEN\").length,\n      amount: fees.filter(fee => fee.status === \"OPEN\").reduce((sum, fee) => sum + fee.amount, 0),\n      color: \"#3B82F6\", // blue\n    },\n    {\n      name: \"Vervallen\",\n      value: fees.filter(fee => fee.status === \"OVERDUE\").length,\n      amount: fees.filter(fee => fee.status === \"OVERDUE\").reduce((sum, fee) => sum + fee.amount, 0),\n      color: \"#EF4444\", // red\n    },\n  ];\n\n  // Line chart data - payments received per month\n  const paidFees = fees.filter(fee => fee.status === \"PAID\" && fee.paidAt);\n  const monthlyData = paidFees.reduce((acc, fee) => {\n    const month = format(startOfMonth(parseISO(fee.paidAt!)), \"yyyy-MM\");\n    if (!acc[month]) {\n      acc[month] = 0;\n    }\n    acc[month] += fee.amount;\n    return acc;\n  }, {} as Record<string, number>);\n\n  const lineData = Object.entries(monthlyData)\n    .sort(([a], [b]) => a.localeCompare(b))\n    .map(([month, amount]) => ({\n      month: format(parseISO(month + \"-01\"), \"MMM yyyy\", { locale: nl }),\n      amount: amount,\n    }));\n\n  const CustomTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"bg-white p-3 border rounded-lg shadow-lg\">\n          <p className=\"font-medium\">{label}</p>\n          <p className=\"text-blue-600\">\n            Ontvangen: {formatCurrencyBE(payload[0].value)}\n          </p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  const PieTooltip = ({ active, payload }: any) => {\n    if (active && payload && payload.length) {\n      const data = payload[0].payload;\n      return (\n        <div className=\"bg-white p-3 border rounded-lg shadow-lg\">\n          <p className=\"font-medium\">{data.name}</p>\n          <p>Aantal: {data.value}</p>\n          <p>Bedrag: {formatCurrencyBE(data.amount)}</p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n      {/* Donut Chart */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Status Verdeling</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <PieChart>\n                <Pie\n                  data={statusData}\n                  cx=\"50%\"\n                  cy=\"50%\"\n                  innerRadius={60}\n                  outerRadius={120}\n                  paddingAngle={5}\n                  dataKey=\"value\"\n                >\n                  {statusData.map((entry, index) => (\n                    <Cell key={`cell-${index}`} fill={entry.color} />\n                  ))}\n                </Pie>\n                <Tooltip content={<PieTooltip />} />\n                <Legend />\n              </PieChart>\n            </ResponsiveContainer>\n          </div>\n          <div className=\"mt-4 space-y-2\">\n            {statusData.map((item) => (\n              <div key={item.name} className=\"flex items-center justify-between text-sm\">\n                <div className=\"flex items-center gap-2\">\n                  <div \n                    className=\"w-3 h-3 rounded-full\" \n                    style={{ backgroundColor: item.color }}\n                  />\n                  <span>{item.name}</span>\n                </div>\n                <span className=\"font-medium\">{item.value} ({formatCurrencyBE(item.amount)})</span>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Line Chart */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Ontvangen per Maand</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <LineChart data={lineData}>\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#f0f0f0\" />\n                <XAxis \n                  dataKey=\"month\" \n                  stroke=\"#6b7280\"\n                  fontSize={12}\n                />\n                <YAxis \n                  stroke=\"#6b7280\"\n                  fontSize={12}\n                  tickFormatter={(value) => `€${value}`}\n                />\n                <Tooltip content={<CustomTooltip />} />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"amount\" \n                  stroke=\"#2563EB\" \n                  strokeWidth={3}\n                  dot={{ fill: \"#2563EB\", strokeWidth: 2, r: 4 }}\n                  activeDot={{ r: 6, stroke: \"#2563EB\", strokeWidth: 2 }}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":5475},"client/src/components/fees/fee-detail-slideout.tsx":{"content":"import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Fee } from \"@shared/fees-schema\";\nimport { formatCurrencyBE, formatDateBE, formatPeriodBE } from \"@/lib/format\";\nimport { StatusChip } from \"./status-chip\";\nimport { MethodChip } from \"./method-chip\";\nimport { User, Calendar, CreditCard, FileText, Check, X } from \"lucide-react\";\n\ninterface FeeDetailSlideoutProps {\n  fee: Fee | null;\n  open: boolean;\n  onClose: () => void;\n  onMarkPaid: (fee: Fee) => void;\n}\n\nexport function FeeDetailSlideout({ fee, open, onClose, onMarkPaid }: FeeDetailSlideoutProps) {\n  if (!fee) return null;\n\n  const canMarkPaid = fee.status === \"OPEN\" || fee.status === \"OVERDUE\";\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-2xl overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Lidgeld Detail</DialogTitle>\n          <DialogDescription>\n            Bekijk alle details van dit lidgeld\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Header Info */}\n          <div className=\"bg-muted/50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"font-mono text-sm text-muted-foreground\">#{fee.memberNumber}</span>\n              <StatusChip status={fee.status} />\n            </div>\n            <h3 className=\"font-semibold text-lg\">\n              {fee.memberLastName}, {fee.memberFirstName}\n            </h3>\n            <p className=\"text-muted-foreground\">\n              {formatPeriodBE(fee.periodStart, fee.periodEnd)}\n            </p>\n          </div>\n\n          {/* Financial Details */}\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium flex items-center gap-2\">\n              <CreditCard className=\"h-4 w-4\" />\n              Financiële details\n            </h4>\n            <div className=\"grid grid-cols-3 gap-6 text-sm\">\n              <div>\n                <span className=\"text-muted-foreground\">Bedrag</span>\n                <p className=\"font-semibold text-lg\">{formatCurrencyBE(fee.amount)}</p>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Methode</span>\n                <div className=\"mt-1\">\n                  <MethodChip method={fee.method} />\n                </div>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Vervaldatum</span>\n                <p className=\"font-medium\">{formatDateBE(fee.dueDate)}</p>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Categorie</span>\n                <p className=\"font-medium\">{fee.category}</p>\n              </div>\n            </div>\n          </div>\n\n          <Separator />\n\n          {/* Member Details */}\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium flex items-center gap-2\">\n              <User className=\"h-4 w-4\" />\n              Lid informatie\n            </h4>\n            <div className=\"grid grid-cols-2 gap-6 text-sm\">\n              <div>\n                <span className=\"text-muted-foreground\">Naam</span>\n                <p className=\"font-medium\">{fee.memberFirstName} {fee.memberLastName}</p>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Lidnummer</span>\n                <p className=\"font-mono\">{fee.memberNumber}</p>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">E-mail</span>\n                <p>{fee.memberEmail}</p>\n              </div>\n              <div>\n                <span className=\"text-muted-foreground\">Telefoon</span>\n                <p>{fee.memberPhone}</p>\n              </div>\n            </div>\n          </div>\n\n          <Separator />\n\n          {/* Payment Details */}\n          {fee.status === \"PAID\" && fee.paidAt && (\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium flex items-center gap-2\">\n                <Check className=\"h-4 w-4\" />\n                Betaling details\n              </h4>\n              <div className=\"space-y-3 text-sm\">\n                <div>\n                  <span className=\"text-muted-foreground\">Betaald op</span>\n                  <p className=\"font-medium\">{formatDateBE(fee.paidAt)}</p>\n                </div>\n                {fee.transactionId && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Transactie ID</span>\n                    <p className=\"font-mono text-xs\">{fee.transactionId}</p>\n                  </div>\n                )}\n                {fee.reference && (\n                  <div>\n                    <span className=\"text-muted-foreground\">Referentie</span>\n                    <p className=\"font-mono text-xs\">{fee.reference}</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Notes */}\n          {fee.notes && (\n            <>\n              <Separator />\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium flex items-center gap-2\">\n                  <FileText className=\"h-4 w-4\" />\n                  Opmerkingen\n                </h4>\n                <div className=\"bg-muted/50 rounded-lg p-3\">\n                  <p className=\"text-sm\">{fee.notes}</p>\n                </div>\n              </div>\n            </>\n          )}\n\n          {/* Actions */}\n          <div className=\"pt-6\">\n            <div className=\"flex gap-3\">\n              {canMarkPaid && (\n                <Button \n                  onClick={() => onMarkPaid(fee)}\n                  className=\"flex-1\"\n                >\n                  <Check className=\"h-4 w-4 mr-2\" />\n                  Markeer betaald\n                </Button>\n              )}\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":6128},"client/src/components/fees/fees-table.tsx":{"content":"import { useState } from \"react\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronLeft, ChevronRight, ChevronsLeft, ChevronsRight, ArrowUpDown, CreditCard, Check, Clock, AlertTriangle } from \"lucide-react\";\nimport { Fee } from \"@shared/fees-schema\";\nimport { formatCurrencyBE, formatPeriodBE, formatDateBE } from \"@/lib/format\";\nimport { RowActions } from \"./row-actions\";\n\ninterface FeesTableProps {\n  fees: any[];\n  total: number;\n  page: number;\n  perPage: number;\n  onPageChange: (page: number) => void;\n  onPerPageChange: (perPage: number) => void;\n  selectedIds: string[];\n  onSelectionChange: (ids: string[]) => void;\n  onRowAction: (action: string, fee: any) => void;\n  sortBy?: string;\n  sortOrder?: \"asc\" | \"desc\";\n  onSort?: (field: string) => void;\n  loading?: boolean;\n}\n\nexport function FeesTable({\n  fees,\n  total,\n  page,\n  perPage,\n  onPageChange,\n  onPerPageChange,\n  selectedIds,\n  onSelectionChange,\n  onRowAction,\n  sortBy,\n  sortOrder,\n  onSort,\n  loading = false,\n}: FeesTableProps) {\n  const totalPages = Math.ceil(total / perPage);\n  const startIndex = (page - 1) * perPage + 1;\n  const endIndex = Math.min(page * perPage, total);\n\n  const isAllSelected = fees?.length > 0 && fees.every(fee => selectedIds.includes(fee.id));\n  const isPartiallySelected = fees?.some(fee => selectedIds.includes(fee.id)) && !isAllSelected;\n\n  const handleSelectAll = () => {\n    if (isAllSelected) {\n      onSelectionChange(selectedIds.filter(id => !fees?.find(fee => fee.id === id)));\n    } else {\n      onSelectionChange([...selectedIds, ...(fees?.map(fee => fee.id).filter(id => !selectedIds.includes(id)) || [])]);\n    }\n  };\n\n  const handleSelectRow = (feeId: string) => {\n    if (selectedIds.includes(feeId)) {\n      onSelectionChange(selectedIds.filter(id => id !== feeId));\n    } else {\n      onSelectionChange([...selectedIds, feeId]);\n    }\n  };\n\n  const SortableHeader = ({ field, children }: { field: string; children: React.ReactNode }) => (\n    <TableHead \n      className=\"cursor-pointer hover:bg-gray-50 select-none\"\n      onClick={() => onSort?.(field)}\n    >\n      <div className=\"flex items-center gap-2\">\n        {children}\n        {sortBy === field && (\n          <ArrowUpDown className={`h-4 w-4 ${sortOrder === \"desc\" ? \"rotate-180\" : \"\"}`} />\n        )}\n      </div>\n    </TableHead>\n  );\n\n  if (loading) {\n    return (\n      <div className=\"glass-card border-0\">\n        <div className=\"p-8 text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-2 text-gray-500\">Laden...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Table */}\n      <div className=\"glass-card card-hover animate-fade-in group border-0 overflow-hidden\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead className=\"w-12\">\n                <Checkbox\n                  checked={isAllSelected}\n                  ref={(el) => {\n                    if (el) (el as any).indeterminate = isPartiallySelected;\n                  }}\n                  onCheckedChange={handleSelectAll}\n                  aria-label=\"Selecteer alle rijen\"\n                />\n              </TableHead>\n              <SortableHeader field=\"memberNumber\">Lidnummer</SortableHeader>\n              <SortableHeader field=\"memberName\">Naam</SortableHeader>\n              <SortableHeader field=\"periodStart\">Periode</SortableHeader>\n              <SortableHeader field=\"amount\">Bedrag</SortableHeader>\n              <SortableHeader field=\"method\">Methode</SortableHeader>\n              <SortableHeader field=\"status\">Status</SortableHeader>\n              <SortableHeader field=\"paidAt\">Betaald op</SortableHeader>\n              <TableHead className=\"text-right\">Acties</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {!fees?.length ? (\n              <TableRow>\n                <TableCell colSpan={9} className=\"text-center py-12\">\n                  <div className=\"flex flex-col items-center justify-center px-4 text-center\">\n                    <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n                      <CreditCard className=\"w-8 h-8 text-gray-400\" />\n                    </div>\n                    <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n                      Geen lidgelden gevonden\n                    </h3>\n                    <p className=\"text-gray-500 dark:text-gray-400 max-w-sm\">\n                      Pas je filters aan om resultaten te zien\n                    </p>\n                  </div>\n                </TableCell>\n              </TableRow>\n            ) : (\n              fees?.map((fee) => (\n                <TableRow \n                  key={fee.id}\n                  className={selectedIds.includes(fee.id) ? \"bg-blue-50\" : \"\"}\n                >\n                  <TableCell>\n                    <Checkbox\n                      checked={selectedIds.includes(fee.id)}\n                      onCheckedChange={() => handleSelectRow(fee.id)}\n                      aria-label={`Selecteer rij ${fee.memberNumber}`}\n                    />\n                  </TableCell>\n                  <TableCell className=\"font-mono text-sm\">\n                    {fee.memberNumber}\n                  </TableCell>\n                  <TableCell>\n                    <div>\n                      <p className=\"font-medium\">{fee.memberLastName}, {fee.memberFirstName}</p>\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"text-sm\">\n                    {formatPeriodBE(fee.periodStart, fee.periodEnd)}\n                  </TableCell>\n                  <TableCell className=\"font-medium\">\n                    {formatCurrencyBE(fee.amount)}\n                  </TableCell>\n                  <TableCell className=\"text-sm\">\n                    {fee.method === 'SEPA' ? 'SEPA' : \n                     fee.method === 'BANK_TRANSFER' ? 'Overschrijving' :\n                     fee.method === 'BANCONTACT' ? 'Bancontact' : 'Contant'}\n                  </TableCell>\n                  <TableCell className=\"text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      {fee.status === 'PAID' && (\n                        <>\n                          <Check className=\"h-4 w-4 text-green-600\" />\n                          <span className=\"text-green-600 font-medium\">Betaald</span>\n                        </>\n                      )}\n                      {fee.status === 'OPEN' && (\n                        <>\n                          <Clock className=\"h-4 w-4 text-orange-500\" />\n                          <span className=\"text-orange-500 font-medium\">Openstaand</span>\n                        </>\n                      )}\n                      {fee.status === 'OVERDUE' && (\n                        <>\n                          <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                          <span className=\"text-red-600 font-medium\">Vervallen</span>\n                        </>\n                      )}\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"text-sm text-gray-600\">\n                    {fee.paidAt ? formatDateBE(fee.paidAt) : \"-\"}\n                  </TableCell>\n                  <TableCell>\n                    <RowActions \n                      fee={fee}\n                      onAction={(action) => onRowAction(action, fee)}\n                    />\n                  </TableCell>\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Pagination */}\n      {total > 0 && (\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2 text-sm text-gray-700\">\n            <span>Rijen per pagina:</span>\n            <select\n              value={perPage}\n              onChange={(e) => onPerPageChange(Number(e.target.value))}\n              className=\"border rounded px-2 py-1\"\n            >\n              <option value={10}>10</option>\n              <option value={20}>20</option>\n              <option value={50}>50</option>\n              <option value={100}>100</option>\n            </select>\n            <span className=\"ml-4\">\n              {startIndex}-{endIndex} van {total}\n            </span>\n          </div>\n\n          <div className=\"flex items-center gap-1\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onPageChange(1)}\n              disabled={page === 1}\n              aria-label=\"Eerste pagina\"\n            >\n              <ChevronsLeft className=\"h-4 w-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onPageChange(page - 1)}\n              disabled={page === 1}\n              aria-label=\"Vorige pagina\"\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </Button>\n            <span className=\"px-3 py-1 text-sm\">\n              Pagina {page} van {totalPages}\n            </span>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onPageChange(page + 1)}\n              disabled={page === totalPages}\n              aria-label=\"Volgende pagina\"\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </Button>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => onPageChange(totalPages)}\n              disabled={page === totalPages}\n              aria-label=\"Laatste pagina\"\n            >\n              <ChevronsRight className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":10051},"client/src/components/fees/filters-drawer.tsx":{"content":"import { useState } from \"react\";\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetTrigger } from \"@/components/ui/sheet\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { CalendarIcon, Filter, X } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\n\ninterface FilterValues {\n  periodFrom?: Date;\n  periodTo?: Date;\n  categories: string[];\n  amountMin?: number;\n  amountMax?: number;\n  paidFrom?: Date;\n  paidTo?: Date;\n  onlyWithMandate: boolean;\n  onlyOverdue: boolean;\n}\n\ninterface FiltersDrawerProps {\n  filters: FilterValues;\n  onFiltersChange: (filters: FilterValues) => void;\n  onReset: () => void;\n}\n\nexport function FiltersDrawer({ filters, onFiltersChange, onReset }: FiltersDrawerProps) {\n  const [open, setOpen] = useState(false);\n\n  const updateFilter = (key: keyof FilterValues, value: any) => {\n    onFiltersChange({ ...filters, [key]: value });\n  };\n\n  const toggleCategory = (category: string) => {\n    const newCategories = filters.categories.includes(category)\n      ? filters.categories.filter(c => c !== category)\n      : [...filters.categories, category];\n    updateFilter(\"categories\", newCategories);\n  };\n\n  const categories = [\"STUDENT\", \"VOLWASSEN\", \"SENIOR\"];\n\n  return (\n    <Sheet open={open} onOpenChange={setOpen}>\n      <SheetTrigger asChild>\n        <Button variant=\"outline\" className=\"flex items-center gap-2\">\n          <Filter className=\"h-4 w-4\" />\n          Geavanceerde filters\n        </Button>\n      </SheetTrigger>\n      <SheetContent className=\"w-96 overflow-y-auto\">\n        <SheetHeader>\n          <SheetTitle>Geavanceerde filters</SheetTitle>\n          <SheetDescription>\n            Verfijn je zoekresultaten met uitgebreide filteropties\n          </SheetDescription>\n        </SheetHeader>\n\n        <div className=\"space-y-6 mt-6\">\n          {/* Period Range */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium\">Periode</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <Label className=\"text-xs text-gray-500\">Van</Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        \"w-full justify-start text-left font-normal\",\n                        !filters.periodFrom && \"text-muted-foreground\"\n                      )}\n                    >\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                      {filters.periodFrom ? format(filters.periodFrom, \"dd-MM-yyyy\", { locale: nl }) : \"Selecteer datum\"}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={filters.periodFrom}\n                      onSelect={(date) => updateFilter(\"periodFrom\", date)}\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n              <div>\n                <Label className=\"text-xs text-gray-500\">Tot</Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        \"w-full justify-start text-left font-normal\",\n                        !filters.periodTo && \"text-muted-foreground\"\n                      )}\n                    >\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                      {filters.periodTo ? format(filters.periodTo, \"dd-MM-yyyy\", { locale: nl }) : \"Selecteer datum\"}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={filters.periodTo}\n                      onSelect={(date) => updateFilter(\"periodTo\", date)}\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n            </div>\n          </div>\n\n          {/* Categories */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium\">Categorieën</Label>\n            <div className=\"space-y-2\">\n              {categories.map(category => (\n                <div key={category} className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id={category}\n                    checked={filters.categories.includes(category)}\n                    onCheckedChange={() => toggleCategory(category)}\n                  />\n                  <Label htmlFor={category} className=\"text-sm\">\n                    {category === \"STUDENT\" ? \"Student\" :\n                     category === \"STANDAARD\" ? \"Standaard\" : \"Senior\"}\n                  </Label>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Amount Range */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium\">Bedrag (€)</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <Label className=\"text-xs text-gray-500\">Minimum</Label>\n                <Input\n                  type=\"number\"\n                  placeholder=\"0\"\n                  value={filters.amountMin || \"\"}\n                  onChange={(e) => updateFilter(\"amountMin\", e.target.value ? parseFloat(e.target.value) : undefined)}\n                />\n              </div>\n              <div>\n                <Label className=\"text-xs text-gray-500\">Maximum</Label>\n                <Input\n                  type=\"number\"\n                  placeholder=\"1000\"\n                  value={filters.amountMax || \"\"}\n                  onChange={(e) => updateFilter(\"amountMax\", e.target.value ? parseFloat(e.target.value) : undefined)}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Paid Date Range */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium\">Betaald op</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <Label className=\"text-xs text-gray-500\">Van</Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        \"w-full justify-start text-left font-normal\",\n                        !filters.paidFrom && \"text-muted-foreground\"\n                      )}\n                    >\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                      {filters.paidFrom ? format(filters.paidFrom, \"dd-MM-yyyy\", { locale: nl }) : \"Selecteer datum\"}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={filters.paidFrom}\n                      onSelect={(date) => updateFilter(\"paidFrom\", date)}\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n              <div>\n                <Label className=\"text-xs text-gray-500\">Tot</Label>\n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"outline\"\n                      className={cn(\n                        \"w-full justify-start text-left font-normal\",\n                        !filters.paidTo && \"text-muted-foreground\"\n                      )}\n                    >\n                      <CalendarIcon className=\"mr-2 h-4 w-4\" />\n                      {filters.paidTo ? format(filters.paidTo, \"dd-MM-yyyy\", { locale: nl }) : \"Selecteer datum\"}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={filters.paidTo}\n                      onSelect={(date) => updateFilter(\"paidTo\", date)}\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n            </div>\n          </div>\n\n          {/* Checkboxes */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"onlyWithMandate\"\n                checked={filters.onlyWithMandate}\n                onCheckedChange={(checked) => updateFilter(\"onlyWithMandate\", checked)}\n              />\n              <Label htmlFor=\"onlyWithMandate\" className=\"text-sm\">\n                Alleen met SEPA-mandaat\n              </Label>\n            </div>\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"onlyOverdue\"\n                checked={filters.onlyOverdue}\n                onCheckedChange={(checked) => updateFilter(\"onlyOverdue\", checked)}\n              />\n              <Label htmlFor=\"onlyOverdue\" className=\"text-sm\">\n                Alleen vervallen\n              </Label>\n            </div>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex gap-3 pt-4 border-t\">\n            <Button onClick={() => setOpen(false)} className=\"flex-1\">\n              Toepassen\n            </Button>\n            <Button onClick={onReset} variant=\"outline\" className=\"flex items-center gap-2\">\n              <X className=\"h-4 w-4\" />\n              Reset\n            </Button>\n          </div>\n        </div>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":10286},"client/src/components/fees/import-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { FileText, Check, X, AlertTriangle } from \"lucide-react\";\nimport { CiImport, CiExport } from \"react-icons/ci\";\nimport { formatCurrencyBE, formatDateBE } from \"@/lib/format\";\nimport { parseCsv, parseMt940, guessMatches } from \"@/lib/mock/fees\";\nimport { Fee } from \"@shared/fees-schema\";\n\ninterface ImportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  fees: Fee[];\n  onImport: (matches: any[]) => void;\n}\n\nexport function ImportDialog({ open, onClose, fees, onImport }: ImportDialogProps) {\n  const [step, setStep] = useState<\"upload\" | \"preview\" | \"confirm\">(\"upload\");\n  const [fileType, setFileType] = useState<\"CSV\" | \"MT940\" | \"CODA\">(\"CSV\");\n  const [file, setFile] = useState<File | null>(null);\n  const [transactions, setTransactions] = useState<any[]>([]);\n  const [matches, setMatches] = useState<any[]>([]);\n  const [loading, setLoading] = useState(false);\n\n  const handleFileUpload = async (uploadedFile: File) => {\n    setFile(uploadedFile);\n    setLoading(true);\n\n    try {\n      const content = await uploadedFile.text();\n      let parsedTransactions: any[] = [];\n\n      if (fileType === \"CSV\") {\n        parsedTransactions = parseCsv(content);\n      } else if (fileType === \"MT940\") {\n        parsedTransactions = parseMt940(content);\n      } else {\n        // CODA - would need specific implementation\n        parsedTransactions = parseCsv(content); // Fallback to CSV for demo\n      }\n\n      setTransactions(parsedTransactions);\n      \n      // Auto-match transactions with fees\n      const guessedMatches = guessMatches(parsedTransactions, fees);\n      setMatches(guessedMatches);\n      \n      setStep(\"preview\");\n    } catch (error) {\n      console.error(\"Error parsing file:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleConfirmImport = () => {\n    const confirmedMatches = matches.filter(m => m.match && m.confidence !== \"unknown\");\n    onImport(confirmedMatches);\n    handleClose();\n  };\n\n  const handleClose = () => {\n    setStep(\"upload\");\n    setFile(null);\n    setTransactions([]);\n    setMatches([]);\n    onClose();\n  };\n\n  const updateMatch = (index: number, feeId: string | null) => {\n    const newMatches = [...matches];\n    if (feeId) {\n      const fee = fees.find(f => f.id === feeId);\n      newMatches[index] = {\n        ...newMatches[index],\n        match: fee,\n        confidence: \"manual\"\n      };\n    } else {\n      newMatches[index] = {\n        ...newMatches[index],\n        match: null,\n        confidence: \"unknown\"\n      };\n    }\n    setMatches(newMatches);\n  };\n\n  const getConfidenceBadge = (confidence: string) => {\n    const variants = {\n      certain: \"bg-green-100 text-green-800\",\n      possible: \"bg-yellow-100 text-yellow-800\",\n      manual: \"bg-blue-100 text-blue-800\",\n      unknown: \"bg-gray-100 text-gray-800\",\n    };\n\n    const labels = {\n      certain: \"Zeker\",\n      possible: \"Mogelijk\",\n      manual: \"Handmatig\",\n      unknown: \"Onbekend\",\n    };\n\n    return (\n      <Badge className={variants[confidence as keyof typeof variants]}>\n        {labels[confidence as keyof typeof labels]}\n      </Badge>\n    );\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Betalingen importeren</DialogTitle>\n          <DialogDescription>\n            Import betalingen uit bankbestanden en koppel ze automatisch aan openstaande lidgelden\n          </DialogDescription>\n        </DialogHeader>\n\n        <Tabs value={step} className=\"mt-6\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"upload\" disabled={step !== \"upload\"}>\n              1. Upload bestand\n            </TabsTrigger>\n            <TabsTrigger value=\"preview\" disabled={step !== \"preview\"}>\n              2. Controleer matches\n            </TabsTrigger>\n            <TabsTrigger value=\"confirm\" disabled={step !== \"confirm\"}>\n              3. Bevestig import\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"upload\" className=\"space-y-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <Label>Bestandstype</Label>\n                <Select value={fileType} onValueChange={(value: any) => setFileType(value)}>\n                  <SelectTrigger className=\"w-48\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"CSV\">CSV</SelectItem>\n                    <SelectItem value=\"MT940\">MT940 (SWIFT)</SelectItem>\n                    <SelectItem value=\"CODA\">CODA (België)</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\n                <CiImport className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                <div className=\"space-y-2\">\n                  <p className=\"text-lg font-medium\">Sleep een bestand hierheen</p>\n                  <p className=\"text-gray-600\">of klik om een bestand te selecteren</p>\n                  <Input\n                    type=\"file\"\n                    accept=\".csv,.txt,.mt940,.cod\"\n                    onChange={(e) => {\n                      const uploadedFile = e.target.files?.[0];\n                      if (uploadedFile) {\n                        handleFileUpload(uploadedFile);\n                      }\n                    }}\n                    className=\"hidden\"\n                    id=\"file-upload\"\n                  />\n                  <Label\n                    htmlFor=\"file-upload\"\n                    className=\"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md cursor-pointer hover:bg-blue-700\"\n                  >\n                    Bestand selecteren\n                  </Label>\n                </div>\n              </div>\n\n              {loading && (\n                <div className=\"text-center py-4\">\n                  <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto\"></div>\n                  <p className=\"mt-2 text-gray-600\">Bestand wordt verwerkt...</p>\n                </div>\n              )}\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"preview\" className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"text-lg font-semibold\">Gevonden transacties</h3>\n                <p className=\"text-gray-600\">\n                  {matches.filter(m => m.match).length} van {matches.length} transacties gekoppeld\n                </p>\n              </div>\n              <Button onClick={() => setStep(\"confirm\")}>\n                Volgende stap\n              </Button>\n            </div>\n\n            <div className=\"border rounded-lg overflow-hidden\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Datum</TableHead>\n                    <TableHead>Bedrag</TableHead>\n                    <TableHead>Beschrijving</TableHead>\n                    <TableHead>Gekoppeld aan</TableHead>\n                    <TableHead>Betrouwbaarheid</TableHead>\n                    <TableHead>Actie</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {matches.map((match, index) => (\n                    <TableRow key={index}>\n                      <TableCell>\n                        {formatDateBE(match.transaction.date)}\n                      </TableCell>\n                      <TableCell className=\"font-medium\">\n                        {formatCurrencyBE(match.transaction.amount)}\n                      </TableCell>\n                      <TableCell className=\"max-w-xs truncate\">\n                        {match.transaction.description}\n                      </TableCell>\n                      <TableCell>\n                        {match.match ? (\n                          <div>\n                            <p className=\"font-medium\">\n                              {match.match.memberFirstName} {match.match.memberLastName}\n                            </p>\n                            <p className=\"text-sm text-gray-600\">\n                              #{match.match.memberNumber} - {formatDateBE(match.match.periodStart)}\n                            </p>\n                          </div>\n                        ) : (\n                          <span className=\"text-gray-500\">Geen koppeling</span>\n                        )}\n                      </TableCell>\n                      <TableCell>\n                        {getConfidenceBadge(match.confidence)}\n                      </TableCell>\n                      <TableCell>\n                        <Select\n                          value={match.match?.id || \"none\"}\n                          onValueChange={(value) => updateMatch(index, value === \"none\" ? null : value)}\n                        >\n                          <SelectTrigger className=\"w-48\">\n                            <SelectValue placeholder=\"Selecteer lidgeld\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"none\">Geen koppeling</SelectItem>\n                            {fees\n                              .filter(fee => fee.status === \"OPEN\" && Math.abs(fee.amount - match.transaction.amount) < 1)\n                              .map(fee => (\n                                <SelectItem key={fee.id} value={fee.id}>\n                                  {fee.memberFirstName} {fee.memberLastName} - {formatCurrencyBE(fee.amount)}\n                                </SelectItem>\n                              ))\n                            }\n                          </SelectContent>\n                        </Select>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"confirm\" className=\"space-y-6\">\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2\">\n                <Check className=\"h-5 w-5 text-green-600\" />\n                <h3 className=\"font-semibold text-green-800\">Klaar voor import</h3>\n              </div>\n              <p className=\"mt-2 text-green-700\">\n                {matches.filter(m => m.match && m.confidence !== \"unknown\").length} betalingen worden geïmporteerd\n              </p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <h4 className=\"font-medium\">Betalingen die worden geïmporteerd:</h4>\n              <div className=\"space-y-2\">\n                {matches\n                  .filter(m => m.match && m.confidence !== \"unknown\")\n                  .map((match, index) => (\n                    <div key={index} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n                      <div>\n                        <p className=\"font-medium\">\n                          {match.match.memberFirstName} {match.match.memberLastName}\n                        </p>\n                        <p className=\"text-sm text-gray-600\">\n                          #{match.match.memberNumber} - {formatCurrencyBE(match.transaction.amount)}\n                        </p>\n                      </div>\n                      <Check className=\"h-5 w-5 text-green-600\" />\n                    </div>\n                  ))\n                }\n              </div>\n            </div>\n\n            <div className=\"flex gap-3 pt-4 border-t\">\n              <Button onClick={handleConfirmImport} className=\"flex-1\">\n                <CiImport className=\"h-4 w-4 mr-2\" />\n                Bevestig import\n              </Button>\n              <Button onClick={() => setStep(\"preview\")} variant=\"outline\">\n                Terug\n              </Button>\n            </div>\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":12717},"client/src/components/fees/kpi-cards.tsx":{"content":"import { Fee } from \"@shared/fees-schema\";\nimport { formatCurrencyBE, formatPercentage } from \"@/lib/format\";\nimport { Check, AlertTriangle, FileText } from \"lucide-react\";\nimport { TbClockHour3 } from \"react-icons/tb\";\n\ninterface KpiCardProps {\n  title: string;\n  value: string;\n  delta: {\n    value: string;\n    positive: boolean;\n  };\n  icon: React.ReactNode;\n  iconBgColor: string;\n}\n\nfunction KpiCard({ title, value, delta, icon, iconBgColor }: KpiCardProps) {\n  // Bepaal kleuren op basis van kaarttype \n  const getColorClasses = () => {\n    if (title === \"Betaald\") {\n      return {\n        iconClass: \"text-green-600\",\n        textClass: \"text-green-600\"\n      };\n    } else if (title === \"Vervallen\") {\n      return {\n        iconClass: \"text-red-500\",\n        textClass: \"text-red-500\"\n      };\n    } else if (title === \"Openstaand\") {\n      return {\n        iconClass: \"text-orange-600\",\n        textClass: \"text-orange-600\"\n      };\n    } else {\n      // Voor andere kaarten gebruik de bestaande logica\n      return {\n        iconClass: delta.positive ? \"text-blue-600\" : \"text-red-500\",\n        textClass: delta.positive ? \"text-blue-600\" : \"text-red-500\"\n      };\n    }\n  };\n\n  const colors = getColorClasses();\n\n  return (\n    <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group relative overflow-hidden\">\n      {/* Dynamic gradient overlay based on card type */}\n      <div className={`absolute inset-0 pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-500 ${\n        title === 'Betaald' ? 'bg-gradient-to-br from-green-500/5 to-transparent' :\n        title === 'Vervallen' ? 'bg-gradient-to-br from-red-500/5 to-transparent' :\n        title === 'Openstaand' ? 'bg-gradient-to-br from-orange-500/5 to-transparent' :\n        'bg-gradient-to-br from-blue-500/5 to-transparent'\n      }`}></div>\n      \n      <div className=\"flex items-center justify-between relative z-10\">\n        <div className=\"flex-1\">\n          <p className=\"text-xs font-medium text-muted-foreground mb-1\">{title}</p>\n          <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300 tabular-nums\">{value}</p>\n          <div className=\"flex items-center space-x-1\">\n            <span className={`text-xs font-medium ${colors.textClass} group-hover:text-opacity-80 transition-all duration-300`}>\n              {delta.value}\n            </span>\n          </div>\n        </div>\n        <div className={`w-10 h-10 ${iconBgColor} rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-all duration-300 relative`}>\n          <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent rounded-xl\"></div>\n          <div className=\"relative\">{icon}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\ninterface KpiCardsProps {\n  fees: Fee[];\n}\n\nexport function KpiCards({ fees }: KpiCardsProps) {\n  // Calculate KPIs\n  const openFees = fees.filter(fee => fee.status === \"OPEN\");\n  const paidFees = fees.filter(fee => fee.status === \"PAID\");\n  const overdueFees = fees.filter(fee => fee.status === \"OVERDUE\");\n  \n  const openAmount = openFees.reduce((sum, fee) => sum + Number(fee.amount || 0), 0);\n  const paidAmount = paidFees.reduce((sum, fee) => sum + Number(fee.amount || 0), 0);\n  const overdueAmount = overdueFees.reduce((sum, fee) => sum + Number(fee.amount || 0), 0);\n  const totalAmount = fees.reduce((sum, fee) => sum + Number(fee.amount || 0), 0);\n  \n  const paidPercentage = totalAmount > 0 ? (paidAmount / totalAmount) : 0;\n  const totalCount = fees.length;\n\n  // Calculate month-over-month changes (mock data for demo)\n  const kpiData = [\n    {\n      title: \"Openstaand\",\n      value: formatCurrencyBE(openAmount),\n      delta: { value: `${openFees.length} facturen`, positive: openFees.length < 60 },\n      icon: <TbClockHour3 className=\"h-4 w-4 text-orange-600\" />,\n      iconBgColor: \"bg-orange-50\"\n    },\n    {\n      title: \"Betaald\",\n      value: formatPercentage(paidPercentage),\n      delta: { value: `${formatCurrencyBE(paidAmount)} ontvangen`, positive: paidPercentage > 65 },\n      icon: <Check className=\"h-4 w-4 text-green-600\" />,\n      iconBgColor: \"bg-green-50\"\n    },\n    {\n      title: \"Vervallen\", \n      value: formatCurrencyBE(overdueAmount),\n      delta: { value: `${overdueFees.length} facturen`, positive: overdueFees.length < 60 },\n      icon: <AlertTriangle className=\"h-4 w-4 text-red-600\" />,\n      iconBgColor: \"bg-red-50\"\n    },\n    {\n      title: \"Totaal Facturen\",\n      value: totalCount.toString(),\n      delta: { value: formatCurrencyBE(totalAmount), positive: true },\n      icon: <FileText className=\"h-4 w-4 text-blue-600\" />,\n      iconBgColor: \"bg-blue-50\"\n    }\n  ];\n\n  return (\n    <div className=\"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n      {kpiData.map((kpi, index) => (\n        <KpiCard\n          key={index}\n          title={kpi.title}\n          value={kpi.value}\n          delta={kpi.delta}\n          icon={kpi.icon}\n          iconBgColor={kpi.iconBgColor}\n        />\n      ))}\n    </div>\n  );\n}","size_bytes":5136},"client/src/components/fees/method-chip.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { PaymentMethod } from \"@shared/fees-schema\";\nimport { CreditCard, Building, Smartphone, Banknote } from \"lucide-react\";\n\ninterface MethodChipProps {\n  method: PaymentMethod;\n  className?: string;\n  showIcon?: boolean;\n}\n\nexport function MethodChip({ method, className, showIcon = true }: MethodChipProps) {\n  const variants = {\n    SEPA: \"bg-purple-100 text-purple-800 border-purple-200\",\n    OVERSCHRIJVING: \"bg-blue-100 text-blue-800 border-blue-200\",\n    BANCONTACT: \"bg-orange-100 text-orange-800 border-orange-200\",\n    CASH: \"bg-gray-100 text-gray-800 border-gray-200\",\n  };\n\n  const labels = {\n    SEPA: \"SEPA\",\n    OVERSCHRIJVING: \"Overschrijving\",\n    BANCONTACT: \"Bancontact\",\n    CASH: \"Contant\",\n  };\n\n  const icons = {\n    SEPA: CreditCard,\n    OVERSCHRIJVING: Building,\n    BANCONTACT: Smartphone,\n    CASH: Banknote,\n  };\n\n  const Icon = icons[method];\n\n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center gap-1.5 px-2.5 py-0.5 rounded-full text-xs font-medium border\",\n        variants[method],\n        className\n      )}\n    >\n      {showIcon && Icon && <Icon className=\"h-3 w-3\" />}\n      {labels[method]}\n    </span>\n  );\n}","size_bytes":1208},"client/src/components/fees/new/amount-input.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { cn } from \"@/lib/utils\";\nimport { euroInputMask, parseEuroInput, formatCurrencyBE } from \"../../../../../lib/period\";\n\ninterface AmountInputProps {\n  value: number;\n  onChange: (amount: number) => void;\n  error?: string;\n}\n\nexport function AmountInput({ value, onChange, error }: AmountInputProps) {\n  const [displayValue, setDisplayValue] = useState(\"\");\n  const [isFocused, setIsFocused] = useState(false);\n\n  // Update display value when value prop changes\n  useEffect(() => {\n    if (!isFocused) {\n      if (value > 0) {\n        setDisplayValue(value.toString().replace('.', ','));\n      } else {\n        setDisplayValue(\"\");\n      }\n    }\n  }, [value, isFocused]);\n\n  const handleInputChange = (inputValue: string) => {\n    const masked = euroInputMask(inputValue);\n    setDisplayValue(masked);\n    \n    const numericValue = parseEuroInput(masked);\n    onChange(numericValue);\n  };\n\n  const handleFocus = () => {\n    setIsFocused(true);\n    // Show raw numeric value when focused\n    if (value > 0) {\n      setDisplayValue(value.toString().replace('.', ','));\n    }\n  };\n\n  const handleBlur = () => {\n    setIsFocused(false);\n    // Format as currency when not focused\n    if (value > 0) {\n      setDisplayValue(value.toString().replace('.', ','));\n    }\n  };\n\n  return (\n    <div className=\"space-y-2\">\n      <Label className=\"text-sm font-medium\">\n        Bedrag\n        <span className=\"text-red-500 ml-1\">*</span>\n      </Label>\n      <div className=\"relative\">\n        <span className=\"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm\">\n          €\n        </span>\n        <Input\n          value={displayValue}\n          onChange={(e) => handleInputChange(e.target.value)}\n          onFocus={handleFocus}\n          onBlur={handleBlur}\n          placeholder=\"0,00\"\n          className={cn(\n            \"w-full h-10 border-gray-200 pl-8 text-right\",\n            error && \"border-red-500\"\n          )}\n          data-testid=\"amount-input\"\n        />\n      </div>\n      {!isFocused && value > 0 && (\n        <p className=\"text-sm text-gray-600\">\n          Weergave: {formatCurrencyBE(value)}\n        </p>\n      )}\n      {error && (\n        <p className=\"text-sm text-red-600\">{error}</p>\n      )}\n      <p className=\"text-xs text-gray-500\">\n        Gebruik komma voor decimalen (bijv. 25,50)\n      </p>\n    </div>\n  );\n}","size_bytes":2490},"client/src/components/fees/new/confirm-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { CalendarIcon } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { cn } from \"@/lib/utils\";\nimport { formatDateBE } from \"../../../../../lib/period\";\n\ninterface ConfirmDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onConfirm: (markAsPaid?: boolean, paidDate?: Date) => void;\n  loading?: boolean;\n}\n\nexport function ConfirmDialog({ open, onOpenChange, onConfirm, loading = false }: ConfirmDialogProps) {\n  const [markAsPaid, setMarkAsPaid] = useState(false);\n  const [paidDate, setPaidDate] = useState<Date>(new Date());\n  const [paidDateInput, setPaidDateInput] = useState(\"\");\n  const [datePopoverOpen, setDatePopoverOpen] = useState(false);\n\n  const formatDateInput = (value: string) => {\n    const numbers = value.replace(/\\D/g, '');\n    if (numbers.length <= 2) {\n      return numbers;\n    } else if (numbers.length <= 4) {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2)}`;\n    } else {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;\n    }\n  };\n\n  const parseDate = (dateString: string): Date | undefined => {\n    const cleanString = dateString.replace(/\\D/g, '');\n    if (cleanString.length === 8) {\n      const day = parseInt(cleanString.slice(0, 2));\n      const month = parseInt(cleanString.slice(2, 4)) - 1;\n      const year = parseInt(cleanString.slice(4, 8));\n      \n      const date = new Date(year, month, day);\n      if (date.getDate() === day && date.getMonth() === month && date.getFullYear() === year) {\n        return date;\n      }\n    }\n    return undefined;\n  };\n\n  const handlePaidDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setPaidDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      setPaidDate(parsedDate);\n    }\n  };\n\n  const handleConfirm = () => {\n    onConfirm(markAsPaid, markAsPaid ? paidDate : undefined);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Lidgeld bevestigen</DialogTitle>\n          <DialogDescription>\n            Weet je zeker dat je dit lidgeld wilt aanmaken?\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"space-y-4\">\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox\n              id=\"mark-paid\"\n              checked={markAsPaid}\n              onCheckedChange={(checked) => setMarkAsPaid(checked as boolean)}\n            />\n            <Label htmlFor=\"mark-paid\" className=\"text-sm cursor-pointer\">\n              Markeer als betaald\n            </Label>\n          </div>\n\n          {markAsPaid && (\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm font-medium\">Betaaldatum</Label>\n              <div className=\"relative\">\n                <Input\n                  value={paidDateInput || formatDateBE(paidDate)}\n                  onChange={(e) => handlePaidDateInput(e.target.value)}\n                  placeholder=\"dd/mm/jjjj\"\n                  className=\"w-full h-9 border-gray-200 pr-10\"\n                  maxLength={10}\n                />\n                <Popover open={datePopoverOpen} onOpenChange={setDatePopoverOpen}>\n                  <PopoverTrigger asChild>\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                      onClick={() => setDatePopoverOpen(true)}\n                    >\n                      <CalendarIcon className=\"h-4 w-4\" />\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                    <Calendar\n                      mode=\"single\"\n                      selected={paidDate}\n                      onSelect={(date) => {\n                        if (date) {\n                          setPaidDate(date);\n                          setPaidDateInput(\"\");\n                          setDatePopoverOpen(false);\n                        }\n                      }}\n                      locale={nl}\n                      disabled={(date) => date > new Date()}\n                      initialFocus\n                    />\n                  </PopoverContent>\n                </Popover>\n              </div>\n              <p className=\"text-xs text-gray-500\">\n                Kies de datum waarop het lidgeld werd betaald\n              </p>\n            </div>\n          )}\n        </div>\n\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <Button\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            disabled={loading}\n          >\n            Annuleren\n          </Button>\n          <Button\n            onClick={handleConfirm}\n            disabled={loading}\n            data-testid=\"confirm-create-fee\"\n          >\n            {loading ? \"Bezig...\" : \"Lidgeld aanmaken\"}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":5628},"client/src/components/fees/new/member-select.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { X } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\n\ninterface MemberSelectProps {\n  value?: string;\n  onChange: (memberId: string) => void;\n  error?: string;\n  members?: any[];\n}\n\nexport function MemberSelect({ value, onChange, error, members = [] }: MemberSelectProps) {\n  const [inputValue, setInputValue] = useState(\"\");\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  \n  const selectedMember = value ? members.find((m: any) => m.id === value) : null;\n  \n  // Filter members based on input\n  const filteredMembers = useMemo(() => {\n    if (!inputValue.trim()) return members;\n    \n    const searchTerm = inputValue.toLowerCase();\n    return members.filter((member: any) => \n      member.firstName.toLowerCase().includes(searchTerm) ||\n      member.lastName.toLowerCase().includes(searchTerm) ||\n      member.memberNumber.includes(searchTerm) ||\n      `${member.firstName} ${member.lastName}`.toLowerCase().includes(searchTerm) ||\n      `${member.lastName}, ${member.firstName}`.toLowerCase().includes(searchTerm)\n    );\n  }, [inputValue, members]);\n  \n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newValue = e.target.value;\n    setInputValue(newValue);\n    setShowSuggestions(newValue.length > 0);\n    \n    // Clear selection if input is changed\n    if (selectedMember && newValue !== `${selectedMember.lastName}, ${selectedMember.firstName}`) {\n      onChange(\"\");\n    }\n  };\n\n  const handleMemberSelect = (member: any) => {\n    onChange(member.id);\n    setInputValue(`${member.lastName}, ${member.firstName}`);\n    setShowSuggestions(false);\n  };\n\n  const handleClearSelection = () => {\n    onChange(\"\");\n    setInputValue(\"\");\n    setShowSuggestions(false);\n  };\n\n  const displayValue = selectedMember \n    ? `${selectedMember.lastName}, ${selectedMember.firstName}`\n    : inputValue;\n\n  return (\n    <div className=\"space-y-2 relative\">\n      <div className=\"relative\">\n        <Input\n          value={displayValue}\n          onChange={handleInputChange}\n          onFocus={() => setShowSuggestions(inputValue.length > 0 || !selectedMember)}\n          onBlur={() => {\n            // Delay hiding suggestions to allow for clicks\n            setTimeout(() => setShowSuggestions(false), 200);\n          }}\n          placeholder=\"Typ een naam of lidnummer...\"\n          className={cn(\n            \"w-full h-10 border-gray-200 pr-8\",\n            error && \"border-red-500\"\n          )}\n          data-testid=\"member-select\"\n        />\n        {selectedMember && (\n          <button\n            type=\"button\"\n            onClick={handleClearSelection}\n            className=\"absolute right-2 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded\"\n          >\n            <X className=\"h-4 w-4 text-gray-400\" />\n          </button>\n        )}\n      </div>\n\n      {/* Suggestions Dropdown */}\n      {showSuggestions && !selectedMember && filteredMembers.length > 0 && (\n        <div className=\"absolute top-full left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-y-auto\">\n          {filteredMembers.slice(0, 10).map((member) => (\n            <div\n              key={member.id}\n              onClick={() => handleMemberSelect(member)}\n              className=\"flex items-center justify-between p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\n            >\n              <div className=\"flex flex-col\">\n                <span className=\"font-medium\">\n                  {member.lastName}, {member.firstName}\n                </span>\n                <span className=\"text-xs text-gray-500\">\n                  #{member.memberNumber} • {member.category}\n                </span>\n              </div>\n              <Badge \n                variant={member.hasMandate ? \"default\" : \"secondary\"}\n                className={cn(\n                  \"text-xs\",\n                  member.hasMandate \n                    ? \"bg-green-100 text-green-800 border-green-200\" \n                    : \"bg-gray-100 text-gray-600 border-gray-200\"\n                )}\n              >\n                {member.hasMandate ? \"MANDAAT\" : \"GEEN MANDAAT\"}\n              </Badge>\n            </div>\n          ))}\n          {filteredMembers.length > 10 && (\n            <div className=\"p-2 text-xs text-gray-500 text-center border-t\">\n              {filteredMembers.length - 10} meer resultaten... typ verder om te filteren\n            </div>\n          )}\n        </div>\n      )}\n\n      {showSuggestions && !selectedMember && filteredMembers.length === 0 && inputValue.trim() && (\n        <div className=\"absolute top-full left-0 right-0 z-50 bg-white border border-gray-200 rounded-lg shadow-lg p-3\">\n          <div className=\"text-sm text-gray-500 text-center\">\n            Geen leden gevonden voor \"{inputValue}\"\n          </div>\n        </div>\n      )}\n      \n      {selectedMember && (\n        <div className=\"flex items-center gap-2 mt-2\">\n          <Badge \n            variant={selectedMember.hasMandate ? \"default\" : \"secondary\"}\n            className={cn(\n              \"text-xs\",\n              selectedMember.hasMandate \n                ? \"bg-green-100 text-green-800 border-green-200\" \n                : \"bg-gray-100 text-gray-600 border-gray-200\"\n            )}\n          >\n            {selectedMember.hasMandate ? \"SEPA mandaat: JA\" : \"SEPA mandaat: NEE\"}\n          </Badge>\n          <span className=\"text-sm text-gray-600\">\n            Categorie: {selectedMember.category}\n          </span>\n        </div>\n      )}\n      \n      {error && (\n        <p className=\"text-sm text-red-600\">{error}</p>\n      )}\n    </div>\n  );\n}","size_bytes":5778},"client/src/components/fees/new/method-term.tsx":{"content":"import { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { cn } from \"@/lib/utils\";\n\ntype PaymentMethod = 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n\ninterface MethodTermProps {\n  method: PaymentMethod;\n  onMethodChange: (method: PaymentMethod) => void;\n  iban?: string;\n  onIbanChange: (iban: string) => void;\n  errors?: {\n    method?: string;\n    iban?: string;\n  };\n}\n\nconst methodLabels = {\n  SEPA: 'SEPA Domiciliëring',\n  OVERSCHRIJVING: 'Overschrijving',\n  BANCONTACT: 'Bancontact',\n  CASH: 'Contant'\n};\n\nexport function MethodTerm({ \n  method, \n  onMethodChange, \n  iban = '', \n  onIbanChange, \n  errors = {} \n}: MethodTermProps) {\n  const formatIban = (value: string) => {\n    // Remove all non-alphanumeric characters\n    const cleaned = value.replace(/[^A-Z0-9]/gi, '').toUpperCase();\n    \n    // Add spaces every 4 characters\n    const formatted = cleaned.replace(/(.{4})/g, '$1 ').trim();\n    \n    return formatted;\n  };\n\n  const handleIbanChange = (value: string) => {\n    const formatted = formatIban(value);\n    onIbanChange(formatted);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Payment Method */}\n      <div className=\"space-y-2\">\n        <Label className=\"text-sm font-medium\">Betalingsmethode</Label>\n        <Select value={method} onValueChange={(value) => onMethodChange(value as PaymentMethod)}>\n          <SelectTrigger \n            className={cn(\n              \"w-full h-10 border-gray-200\",\n              errors.method && \"border-red-500\"\n            )}\n            data-testid=\"method-select\"\n          >\n            <SelectValue placeholder=\"Selecteer betalingsmethode\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"SEPA\">SEPA Domiciliëring</SelectItem>\n            <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n            <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n            <SelectItem value=\"CASH\">Contant</SelectItem>\n          </SelectContent>\n        </Select>\n        {errors.method && (\n          <p className=\"text-sm text-red-600\">{errors.method}</p>\n        )}\n      </div>\n\n      {/* IBAN (only for SEPA) */}\n      {method === 'SEPA' && (\n        <div className=\"space-y-2\">\n          <Label className=\"text-sm font-medium\">\n            IBAN Rekeningnummer\n            <span className=\"text-red-500 ml-1\">*</span>\n          </Label>\n          <Input\n            value={iban}\n            onChange={(e) => handleIbanChange(e.target.value)}\n            placeholder=\"BE71 0961 2345 6769\"\n            className={cn(\n              \"w-full h-10 border-gray-200 font-mono text-sm\",\n              errors.iban && \"border-red-500\"\n            )}\n            data-testid=\"iban-input\"\n            maxLength={19} // BE + 2 digits + 12 digits + spaces\n          />\n          {errors.iban && (\n            <p className=\"text-sm text-red-600\">{errors.iban}</p>\n          )}\n          <p className=\"text-xs text-gray-500\">\n            Vereist voor SEPA domiciliëring. Formaat: BE71 0961 2345 6769\n          </p>\n        </div>\n      )}\n\n      {/* Method description */}\n      <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n        <p className=\"text-sm text-blue-800\">\n          {method === 'SEPA' && 'Automatische incasso via SEPA domiciliëring. Vereist een geldig mandaat.'}\n          {method === 'OVERSCHRIJVING' && 'Handmatige overschrijving door het lid. Factuur wordt verstuurd.'}\n          {method === 'BANCONTACT' && 'Elektronische betaling via Bancontact terminal.'}\n          {method === 'CASH' && 'Contante betaling bij de moskee.'}\n        </p>\n      </div>\n    </div>\n  );\n}","size_bytes":3777},"client/src/components/fees/new/period-picker.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { CalendarIcon } from \"lucide-react\";\nimport { format, nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { formatDateBE, calculateEndDate } from \"../../../../../lib/period\";\n\ninterface PeriodPickerProps {\n  term: 'MONTHLY' | 'YEARLY';\n  onTermChange: (term: 'MONTHLY' | 'YEARLY') => void;\n  startDate?: Date;\n  onStartDateChange: (date: Date) => void;\n  endDate?: Date;\n  onEndDateChange: (date: Date) => void;\n  errors?: {\n    term?: string;\n    startDate?: string;\n    endDate?: string;\n  };\n}\n\nexport function PeriodPicker({ \n  term, \n  onTermChange, \n  startDate, \n  onStartDateChange, \n  endDate,\n  onEndDateChange,\n  errors = {} \n}: PeriodPickerProps) {\n  const [startDateInput, setStartDateInput] = useState(\"\");\n  const [startPopoverOpen, setStartPopoverOpen] = useState(false);\n\n  // Update end date when start date or term changes\n  useEffect(() => {\n    if (startDate) {\n      const newEndDate = calculateEndDate(startDate, term);\n      onEndDateChange(newEndDate);\n    }\n  }, [startDate, term, onEndDateChange]);\n\n  const formatDateInput = (value: string) => {\n    const numbers = value.replace(/\\D/g, '');\n    if (numbers.length <= 2) {\n      return numbers;\n    } else if (numbers.length <= 4) {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2)}`;\n    } else {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;\n    }\n  };\n\n  const parseDate = (dateString: string): Date | undefined => {\n    const cleanString = dateString.replace(/\\D/g, '');\n    if (cleanString.length === 8) {\n      const day = parseInt(cleanString.slice(0, 2));\n      const month = parseInt(cleanString.slice(2, 4)) - 1;\n      const year = parseInt(cleanString.slice(4, 8));\n      \n      const date = new Date(year, month, day);\n      if (date.getDate() === day && date.getMonth() === month && date.getFullYear() === year) {\n        return date;\n      }\n    }\n    return undefined;\n  };\n\n  const handleStartDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setStartDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      onStartDateChange(parsedDate);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Term Selection */}\n      <div className=\"space-y-3\">\n        <Label className=\"text-sm font-medium\">Termijn</Label>\n        <RadioGroup \n          value={term} \n          onValueChange={(value) => onTermChange(value as 'MONTHLY' | 'YEARLY')}\n          className=\"flex gap-6\"\n        >\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"MONTHLY\" id=\"monthly\" />\n            <Label htmlFor=\"monthly\" className=\"text-sm cursor-pointer\">\n              Maandelijks\n            </Label>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <RadioGroupItem value=\"YEARLY\" id=\"yearly\" />\n            <Label htmlFor=\"yearly\" className=\"text-sm cursor-pointer\">\n              Jaarlijks\n            </Label>\n          </div>\n        </RadioGroup>\n        {errors.term && (\n          <p className=\"text-sm text-red-600\">{errors.term}</p>\n        )}\n      </div>\n\n      {/* Start Date */}\n      <div className=\"space-y-2\">\n        <Label className=\"text-sm font-medium\">Startdatum</Label>\n        <div className=\"relative\">\n          <Input\n            value={startDateInput || (startDate ? formatDateBE(startDate) : \"\")}\n            onChange={(e) => handleStartDateInput(e.target.value)}\n            placeholder=\"dd/mm/jjjj\"\n            className={cn(\n              \"w-full h-10 border-gray-200 pr-10\",\n              errors.startDate && \"border-red-500\"\n            )}\n            data-testid=\"start-date-input\"\n            maxLength={10}\n          />\n          <Popover open={startPopoverOpen} onOpenChange={setStartPopoverOpen}>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                onClick={() => setStartPopoverOpen(true)}\n              >\n                <CalendarIcon className=\"h-4 w-4\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <Calendar\n                mode=\"single\"\n                selected={startDate}\n                onSelect={(date) => {\n                  if (date) {\n                    onStartDateChange(date);\n                    setStartDateInput(\"\");\n                    setStartPopoverOpen(false);\n                  }\n                }}\n                locale={nl}\n                disabled={(date) => date < new Date()}\n                initialFocus\n              />\n            </PopoverContent>\n          </Popover>\n        </div>\n        {errors.startDate && (\n          <p className=\"text-sm text-red-600\">{errors.startDate}</p>\n        )}\n      </div>\n\n      {/* End Date (read-only) */}\n      <div className=\"space-y-2\">\n        <Label className=\"text-sm font-medium\">Einddatum</Label>\n        <Input\n          value={endDate ? formatDateBE(endDate) : \"\"}\n          readOnly\n          className=\"w-full h-10 border-gray-200 bg-gray-50 text-gray-600\"\n          placeholder=\"Wordt automatisch berekend\"\n          data-testid=\"end-date-display\"\n        />\n        <p className=\"text-xs text-gray-500\">\n          {term === 'MONTHLY' ? \n            'Automatisch ingesteld op de laatste dag van de startmaand' : \n            'Automatisch ingesteld op één jaar na de startdatum'\n          }\n        </p>\n        {errors.endDate && (\n          <p className=\"text-sm text-red-600\">{errors.endDate}</p>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":6137},"client/src/components/fees/new/preview-card.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { membersLite } from \"../../../../../lib/mock/members-lite\";\nimport { formatDateBE, formatCurrencyBE } from \"../../../../../lib/period\";\nimport { overlaps } from \"../../../../../lib/mock/fees-store\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { AlertTriangle, CheckCircle, XCircle } from \"lucide-react\";\n\ntype PaymentMethod = 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n\ninterface PreviewCardProps {\n  memberId?: string;\n  term?: 'MONTHLY' | 'YEARLY';\n  method?: PaymentMethod;\n  startDate?: Date;\n  endDate?: Date;\n  amount?: number;\n  iban?: string;\n  note?: string;\n}\n\nexport function PreviewCard({\n  memberId,\n  term,\n  method,\n  startDate,\n  endDate,\n  amount,\n  iban,\n  note\n}: PreviewCardProps) {\n  const member = memberId ? membersLite.find(m => m.id === memberId) : null;\n  \n  // Calculate SEPA eligibility\n  const sepaEligible = method === 'SEPA' && member?.hasMandate && iban && iban.length > 10;\n  \n  // Check for overlaps\n  const hasOverlap = memberId && startDate && endDate ? \n    overlaps(memberId, startDate.toISOString().split('T')[0], endDate.toISOString().split('T')[0]) : \n    false;\n\n  // Calculate year summary for monthly payments\n  const yearSummary = term === 'MONTHLY' && startDate && amount ? (() => {\n    const currentYear = startDate.getFullYear();\n    const startMonth = startDate.getMonth();\n    const remainingMonths = 12 - startMonth;\n    return {\n      remainingMonths,\n      yearTotal: amount * remainingMonths\n    };\n  })() : null;\n\n  return (\n    <Card className=\"border border-gray-200 shadow-sm h-fit\">\n      <CardHeader className=\"pb-4\">\n        <CardTitle className=\"text-lg font-semibold text-gray-900\">\n          Samenvatting\n        </CardTitle>\n        <p className=\"text-sm text-gray-600\">\n          Controle van het nieuwe lidgeld\n        </p>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Member Info */}\n        {member ? (\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium text-gray-900\">Lid</h4>\n            <div className=\"space-y-1\">\n              <p className=\"text-sm\">\n                <span className=\"font-medium\">{member.lastName}, {member.firstName}</span>\n              </p>\n              <p className=\"text-xs text-gray-600\">\n                Lidnummer: #{member.memberNumber} • {member.category}\n              </p>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-sm text-gray-500\">Selecteer een lid</div>\n        )}\n\n        <Separator />\n\n        {/* Period Info */}\n        {startDate && endDate ? (\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium text-gray-900\">Periode</h4>\n            <div className=\"space-y-1\">\n              <p className=\"text-sm\">\n                {formatDateBE(startDate)} — {formatDateBE(endDate)}\n              </p>\n              <p className=\"text-xs text-gray-600\">\n                Termijn: {term === 'MONTHLY' ? 'Maandelijks' : 'Jaarlijks'}\n              </p>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-sm text-gray-500\">Kies een periode</div>\n        )}\n\n        <Separator />\n\n        {/* Payment Info */}\n        {method && amount && amount > 0 ? (\n          <div className=\"space-y-2\">\n            <h4 className=\"font-medium text-gray-900\">Betaling</h4>\n            <div className=\"space-y-1\">\n              <p className=\"text-sm font-medium\">\n                {formatCurrencyBE(amount)}\n              </p>\n              <p className=\"text-xs text-gray-600\">\n                Methode: {method === 'SEPA' ? 'SEPA Domiciliëring' :\n                         method === 'OVERSCHRIJVING' ? 'Overschrijving' :\n                         method === 'BANCONTACT' ? 'Bancontact' : 'Contant'}\n              </p>\n            </div>\n          </div>\n        ) : (\n          <div className=\"text-sm text-gray-500\">Kies een bedrag</div>\n        )}\n\n        {/* SEPA Eligibility */}\n        {method === 'SEPA' && (\n          <>\n            <Separator />\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium text-gray-900\">SEPA Geschiktheid</h4>\n              <div className=\"flex items-center gap-2\">\n                {sepaEligible ? (\n                  <>\n                    <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                    <Badge className=\"bg-green-100 text-green-800 border-green-200\">\n                      JA\n                    </Badge>\n                  </>\n                ) : (\n                  <>\n                    <XCircle className=\"h-4 w-4 text-red-600\" />\n                    <Badge className=\"bg-red-100 text-red-800 border-red-200\">\n                      NEE\n                    </Badge>\n                  </>\n                )}\n              </div>\n              {!sepaEligible && (\n                <div className=\"text-xs text-gray-600\">\n                  {!member?.hasMandate && \"• Geen SEPA mandaat\"}\n                  {member?.hasMandate && (!iban || iban.length <= 10) && \"• IBAN ontbreekt of ongeldig\"}\n                </div>\n              )}\n            </div>\n          </>\n        )}\n\n        {/* Year Summary for Monthly */}\n        {yearSummary && (\n          <>\n            <Separator />\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium text-gray-900\">Jaaroverzicht</h4>\n              <div className=\"text-sm space-y-1\">\n                <p>Resterende maanden dit jaar: {yearSummary.remainingMonths}</p>\n                <p className=\"font-medium\">\n                  Totaal dit jaar: {formatCurrencyBE(yearSummary.yearTotal)}\n                </p>\n              </div>\n            </div>\n          </>\n        )}\n\n        {/* Note */}\n        {note && (\n          <>\n            <Separator />\n            <div className=\"space-y-2\">\n              <h4 className=\"font-medium text-gray-900\">Notitie</h4>\n              <p className=\"text-sm text-gray-600\">{note}</p>\n            </div>\n          </>\n        )}\n\n        {/* Overlap Warning */}\n        {hasOverlap && (\n          <Alert className=\"border-orange-200 bg-orange-50\">\n            <AlertTriangle className=\"h-4 w-4 text-orange-600\" />\n            <AlertDescription className=\"text-orange-800 text-sm\">\n              <strong>Waarschuwing:</strong> Er bestaat al een lidgeld voor dit lid dat (gedeeltelijk) overlapt met de gekozen periode.\n            </AlertDescription>\n          </Alert>\n        )}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":6675},"client/src/components/fees/row-actions.tsx":{"content":"import { MoreHorizontal, Check, Eye, Edit, Trash2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { Fee } from \"@shared/fees-schema\";\n\ninterface RowActionsProps {\n  fee: Fee;\n  onAction: (action: string) => void;\n}\n\nexport function RowActions({ fee, onAction }: RowActionsProps) {\n  const canMarkPaid = fee.status === \"OPEN\" || fee.status === \"OVERDUE\";\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <Button \n          variant=\"ghost\" \n          size=\"sm\" \n          className=\"h-8 w-8 p-0\"\n          aria-label=\"Meer acties\"\n        >\n          <MoreHorizontal className=\"h-4 w-4\" />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-48\">\n        {canMarkPaid && (\n          <DropdownMenuItem \n            onClick={() => onAction(\"markPaid\")}\n            className=\"flex items-center gap-2\"\n          >\n            <Check className=\"h-4 w-4\" />\n            Markeer betaald\n          </DropdownMenuItem>\n        )}\n        <DropdownMenuItem \n          onClick={() => onAction(\"viewDetail\")}\n          className=\"flex items-center gap-2\"\n        >\n          <Eye className=\"h-4 w-4\" />\n          Bekijk detail\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={() => onAction(\"changeMethod\")}\n          className=\"flex items-center gap-2\"\n        >\n          <Edit className=\"h-4 w-4\" />\n          Wijzig methode\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={() => onAction(\"delete\")}\n          className=\"flex items-center gap-2 text-red-600\"\n        >\n          <Trash2 className=\"h-4 w-4\" />\n          Verwijderen\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}","size_bytes":1881},"client/src/components/fees/sepa-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { CreditCard, Download, AlertTriangle, Check } from \"lucide-react\";\nimport { Fee } from \"@shared/fees-schema\";\nimport { formatCurrencyBE, formatDateBE } from \"@/lib/format\";\nimport { generateSepaXml } from \"@/lib/mock/fees\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\n\ninterface SepaDialogProps {\n  open: boolean;\n  onClose: () => void;\n  fees: Fee[];\n  onGenerate: (batchRef: string, executionDate: string) => void;\n}\n\nexport function SepaDialog({ open, onClose, fees, onGenerate }: SepaDialogProps) {\n  const [executionDate, setExecutionDate] = useState(\n    format(new Date(Date.now() + 2 * 24 * 60 * 60 * 1000), \"yyyy-MM-dd\") // 2 days from now\n  );\n  const [generating, setGenerating] = useState(false);\n\n  // Filter fees that can be processed via SEPA\n  const sepaFees = fees.filter(fee => \n    fee.method === \"SEPA\" && \n    fee.status === \"OPEN\" && \n    fee.hasMandate\n  );\n\n  const totalAmount = sepaFees.reduce((sum, fee) => sum + fee.amount, 0);\n  const batchRef = `SEPA-${format(new Date(), \"yyyyMMdd-HHmmss\")}`;\n\n  const handleGenerate = async () => {\n    setGenerating(true);\n    try {\n      // Generate SEPA XML\n      const xmlContent = generateSepaXml(sepaFees, batchRef);\n      \n      // Create download\n      const blob = new Blob([xmlContent], { type: \"application/xml\" });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.href = url;\n      link.download = `${batchRef}.xml`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n\n      // Update fees with batch reference\n      onGenerate(batchRef, executionDate);\n      onClose();\n    } catch (error) {\n      console.error(\"Error generating SEPA file:\", error);\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const warnings = [];\n  if (sepaFees.length === 0) {\n    warnings.push(\"Geen SEPA-transacties gevonden\");\n  }\n  const feesWithoutMandate = fees.filter(fee => \n    fee.method === \"SEPA\" && fee.status === \"OPEN\" && !fee.hasMandate\n  );\n  if (feesWithoutMandate.length > 0) {\n    warnings.push(`${feesWithoutMandate.length} SEPA-lidgelden zonder mandaat`);\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <CreditCard className=\"h-5 w-5\" />\n            SEPA Incasso Genereren\n          </DialogTitle>\n          <DialogDescription>\n            Genereer een SEPA-bestand voor automatische incasso van lidgelden\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6 mt-6\">\n          {/* Summary */}\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"bg-blue-50 rounded-lg p-4 text-center\">\n              <p className=\"text-2xl font-bold text-blue-600\">{sepaFees.length}</p>\n              <p className=\"text-sm text-blue-800\">Transacties</p>\n            </div>\n            <div className=\"bg-green-50 rounded-lg p-4 text-center\">\n              <p className=\"text-2xl font-bold text-green-600\">{formatCurrencyBE(totalAmount)}</p>\n              <p className=\"text-sm text-green-800\">Totaal bedrag</p>\n            </div>\n            <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\n              <p className=\"text-sm font-mono text-gray-600\">{batchRef}</p>\n              <p className=\"text-sm text-gray-800\">Batch referentie</p>\n            </div>\n          </div>\n\n          {/* Warnings */}\n          {warnings.length > 0 && (\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />\n                <h4 className=\"font-medium text-yellow-800\">Waarschuwingen</h4>\n              </div>\n              <ul className=\"list-disc list-inside space-y-1 text-yellow-700\">\n                {warnings.map((warning, index) => (\n                  <li key={index}>{warning}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          {/* Execution Date */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"executionDate\">Uitvoeringsdatum</Label>\n            <Input\n              id=\"executionDate\"\n              type=\"date\"\n              value={executionDate}\n              onChange={(e) => setExecutionDate(e.target.value)}\n              min={format(new Date(), \"yyyy-MM-dd\")}\n              className=\"w-48\"\n            />\n            <p className=\"text-sm text-gray-600\">\n              De datum waarop de incasso's worden uitgevoerd\n            </p>\n          </div>\n\n          <Separator />\n\n          {/* Transaction List */}\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium\">Te verwerken transacties ({sepaFees.length})</h4>\n            \n            {sepaFees.length > 0 ? (\n              <div className=\"border rounded-lg overflow-hidden max-h-96 overflow-y-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>Lid</TableHead>\n                      <TableHead>Periode</TableHead>\n                      <TableHead>Bedrag</TableHead>\n                      <TableHead>Mandaat</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {sepaFees.map((fee) => (\n                      <TableRow key={fee.id}>\n                        <TableCell>\n                          <div>\n                            <p className=\"font-medium\">\n                              {fee.memberFirstName} {fee.memberLastName}\n                            </p>\n                            <p className=\"text-sm text-gray-600\">#{fee.memberNumber}</p>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"text-sm\">\n                            <p>{format(new Date(fee.periodStart), \"MMM yyyy\", { locale: nl })}</p>\n                            <p className=\"text-gray-600\">Vervalt: {formatDateBE(fee.dueDate)}</p>\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"font-medium\">\n                          {formatCurrencyBE(fee.amount)}\n                        </TableCell>\n                        <TableCell>\n                          <Badge className=\"bg-green-100 text-green-800\">\n                            <Check className=\"h-3 w-3 mr-1\" />\n                            Actief\n                          </Badge>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-gray-500\">\n                <CreditCard className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                <p>Geen SEPA-transacties beschikbaar</p>\n                <p className=\"text-sm mt-1\">\n                  Controleer of er openstaande lidgelden zijn met SEPA-mandaten\n                </p>\n              </div>\n            )}\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-4 border-t\">\n            <Button\n              onClick={handleGenerate}\n              disabled={sepaFees.length === 0 || generating}\n              className=\"flex-1\"\n            >\n              {generating ? (\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                  Genereren...\n                </div>\n              ) : (\n                <>\n                  <Download className=\"h-4 w-4 mr-2\" />\n                  Genereer SEPA-bestand\n                </>\n              )}\n            </Button>\n            <Button onClick={onClose} variant=\"outline\">\n              Annuleren\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":8654},"client/src/components/fees/status-chip.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { FeeStatus } from \"@shared/fees-schema\";\n\ninterface StatusChipProps {\n  status: FeeStatus;\n  className?: string;\n}\n\nexport function StatusChip({ status, className }: StatusChipProps) {\n  const variants = {\n    OPEN: \"bg-blue-100 text-blue-800 border-blue-200\",\n    PAID: \"bg-green-100 text-green-800 border-green-200\", \n    OVERDUE: \"bg-red-100 text-red-800 border-red-200\",\n  };\n\n  const labels = {\n    OPEN: \"Openstaand\",\n    PAID: \"Betaald\",\n    OVERDUE: \"Vervallen\",\n  };\n\n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border\",\n        variants[status],\n        className\n      )}\n    >\n      {labels[status]}\n    </span>\n  );\n}","size_bytes":751},"client/src/components/fees/toolbar.tsx":{"content":"import { useState } from \"react\";\nimport { Search, CreditCard, Plus, CalendarIcon } from \"lucide-react\";\nimport { CiExport, CiImport } from \"react-icons/ci\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\nimport { RiResetLeftFill } from \"react-icons/ri\";\n\ninterface ToolbarProps {\n  searchTerm: string;\n  onSearchChange: (value: string) => void;\n  statusFilter: string;\n  onStatusFilterChange: (value: string) => void;\n  yearFilter: string;\n  onYearFilterChange: (value: string) => void;\n  methodFilter: string;\n  onMethodFilterChange: (value: string) => void;\n  categoryFilter: string;\n  onCategoryFilterChange: (value: string) => void;\n  amountMin?: number;\n  onAmountMinChange: (value: number | undefined) => void;\n  amountMax?: number;\n  onAmountMaxChange: (value: number | undefined) => void;\n  periodFrom?: Date;\n  onPeriodFromChange: (date: Date | undefined) => void;\n  periodTo?: Date;\n  onPeriodToChange: (date: Date | undefined) => void;\n  onlyWithMandate: boolean;\n  onOnlyWithMandateChange: (value: boolean) => void;\n  onlyOverdue: boolean;\n  onOnlyOverdueChange: (value: boolean) => void;\n  onResetFilters: () => void;\n  selectedCount: number;\n  sepaSelectedCount: number;\n  onExport: () => void;\n  onImport: () => void;\n  onGenerateSepa: () => void;\n  onBulkMarkPaid: () => void;\n  newButton?: React.ReactNode;\n}\n\nexport function Toolbar({\n  searchTerm,\n  onSearchChange,\n  statusFilter,\n  onStatusFilterChange,\n  yearFilter,\n  onYearFilterChange,\n  methodFilter,\n  onMethodFilterChange,\n  categoryFilter,\n  onCategoryFilterChange,\n  amountMin,\n  onAmountMinChange,\n  amountMax,\n  onAmountMaxChange,\n  periodFrom,\n  onPeriodFromChange,\n  periodTo,\n  onPeriodToChange,\n  onlyWithMandate,\n  onOnlyWithMandateChange,\n  onlyOverdue,\n  onOnlyOverdueChange,\n  onResetFilters,\n  selectedCount,\n  sepaSelectedCount,\n  onExport,\n  onImport,\n  onGenerateSepa,\n  onBulkMarkPaid,\n  newButton,\n}: ToolbarProps) {\n  const [fromDateInput, setFromDateInput] = useState(\"\");\n  const [toDateInput, setToDateInput] = useState(\"\");\n  const [fromPopoverOpen, setFromPopoverOpen] = useState(false);\n  const [toPopoverOpen, setToPopoverOpen] = useState(false);\n\n  const currentYear = new Date().getFullYear();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear - i);\n\n  const formatDateInput = (value: string) => {\n    // Remove all non-numeric characters\n    const numbers = value.replace(/\\D/g, '');\n    \n    // Apply DD/MM/YYYY formatting\n    if (numbers.length <= 2) {\n      return numbers;\n    } else if (numbers.length <= 4) {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2)}`;\n    } else {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;\n    }\n  };\n\n  const parseDate = (dateString: string): Date | undefined => {\n    const cleanString = dateString.replace(/\\D/g, '');\n    if (cleanString.length === 8) {\n      const day = parseInt(cleanString.slice(0, 2));\n      const month = parseInt(cleanString.slice(2, 4)) - 1; // Month is 0-indexed\n      const year = parseInt(cleanString.slice(4, 8));\n      \n      const date = new Date(year, month, day);\n      if (date.getDate() === day && date.getMonth() === month && date.getFullYear() === year) {\n        return date;\n      }\n    }\n    return undefined;\n  };\n\n  const handleFromDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setFromDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      onPeriodFromChange(parsedDate);\n    }\n  };\n\n  const handleToDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setToDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      onPeriodToChange(parsedDate);\n    }\n  };\n\n  return (\n    <Card className=\"glass-card card-hover animate-fade-in group mb-6\">\n      <CardContent className=\"p-6\">\n        <div className=\"space-y-4\">\n          {/* Search and Action Buttons */}\n          <div className=\"flex flex-col lg:flex-row gap-4\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <Input\n                placeholder=\"Zoek op lidnummer, naam of periode...\"\n                value={searchTerm}\n                onChange={(e) => onSearchChange(e.target.value)}\n                className=\"pl-10 h-10 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20\"\n                data-testid=\"search-fees\"\n              />\n            </div>\n            \n            <div className=\"flex gap-2 lg:flex-shrink-0\">\n              <Button \n                variant=\"outline\" \n                onClick={onExport}\n                className=\"h-10 px-4 border-gray-200 hover:border-gray-300\"\n                data-testid=\"export-button\"\n              >\n                <CiExport className=\"h-4 w-4 mr-2\" />\n                Export\n              </Button>\n              <Button \n                variant=\"outline\" \n                onClick={onImport}\n                className=\"h-10 px-4 border-gray-200 hover:border-gray-300\"\n                data-testid=\"import-button\"\n              >\n                <CiImport className=\"h-4 w-4 mr-2\" />\n                Import\n              </Button>\n              {newButton && newButton}\n            </div>\n          </div>\n\n          {/* All Filters */}\n          <div className=\"flex flex-col gap-4\">\n            <div className=\"flex flex-wrap gap-3\">\n              <Select value={statusFilter} onValueChange={onStatusFilterChange}>\n                <SelectTrigger className=\"w-[160px] h-9 border-gray-200\" data-testid=\"status-filter\">\n                  <SelectValue placeholder=\"Alle statussen\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle statussen</SelectItem>\n                  <SelectItem value=\"OPEN\">Openstaand</SelectItem>\n                  <SelectItem value=\"PAID\">Betaald</SelectItem>\n                  <SelectItem value=\"OVERDUE\">Vervallen</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={yearFilter} onValueChange={onYearFilterChange}>\n                <SelectTrigger className=\"w-[120px] h-9 border-gray-200\" data-testid=\"year-filter\">\n                  <SelectValue placeholder=\"Alle jaren\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle jaren</SelectItem>\n                  {years.map(year => (\n                    <SelectItem key={year} value={year.toString()}>\n                      {year}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              <Select value={methodFilter} onValueChange={onMethodFilterChange}>\n                <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"method-filter\">\n                  <SelectValue placeholder=\"Alle methodes\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle methodes</SelectItem>\n                  <SelectItem value=\"SEPA\">SEPA</SelectItem>\n                  <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                  <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                  <SelectItem value=\"CASH\">Contant</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={categoryFilter} onValueChange={onCategoryFilterChange}>\n                <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"category-filter\">\n                  <SelectValue placeholder=\"Alle categorieën\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle categorieën</SelectItem>\n                  <SelectItem value=\"STUDENT\">Student</SelectItem>\n                  <SelectItem value=\"STANDAARD\">Standaard</SelectItem>\n                  <SelectItem value=\"SENIOR\">Senior</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Second row of filters */}\n            <div className=\"flex flex-wrap gap-3 items-center\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-gray-600\">Bedrag:</span>\n                <Input\n                  type=\"number\"\n                  placeholder=\"Min €\"\n                  value={amountMin || \"\"}\n                  onChange={(e) => onAmountMinChange(e.target.value ? parseFloat(e.target.value) : undefined)}\n                  className=\"w-[100px] h-9 border-gray-200\"\n                  data-testid=\"amount-min\"\n                />\n                <span className=\"text-sm text-gray-400\">tot</span>\n                <Input\n                  type=\"number\"\n                  placeholder=\"Max €\"\n                  value={amountMax || \"\"}\n                  onChange={(e) => onAmountMaxChange(e.target.value ? parseFloat(e.target.value) : undefined)}\n                  className=\"w-[100px] h-9 border-gray-200\"\n                  data-testid=\"amount-max\"\n                />\n              </div>\n\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-gray-600\">Periode:</span>\n                \n                <div className=\"relative\">\n                  <Input\n                    value={fromDateInput || (periodFrom ? format(periodFrom, \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n                    onChange={(e) => handleFromDateInput(e.target.value)}\n                    placeholder=\"DD/MM/YYYY\"\n                    className=\"w-[160px] h-9 border-gray-200 pr-10\"\n                    data-testid=\"paid-date-from\"\n                    maxLength={10}\n                  />\n                  <Popover open={fromPopoverOpen} onOpenChange={setFromPopoverOpen}>\n                    <PopoverTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                        onClick={() => setFromPopoverOpen(true)}\n                      >\n                        <CalendarIcon className=\"h-4 w-4\" />\n                      </Button>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                      <div className=\"p-3 border-b\">\n                        <div className=\"flex items-center justify-between space-x-2\">\n                          <Select\n                            value={periodFrom ? periodFrom.getMonth().toString() : \"\"}\n                            onValueChange={(month) => {\n                              const currentDate = periodFrom || new Date();\n                              const newDate = new Date(currentDate.getFullYear(), parseInt(month), currentDate.getDate());\n                              onPeriodFromChange(newDate);\n                              setFromDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[120px] h-8\">\n                              <SelectValue placeholder=\"Maand\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 12 }, (_, i) => (\n                                <SelectItem key={i} value={i.toString()}>\n                                  {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <Select\n                            value={periodFrom ? periodFrom.getFullYear().toString() : \"\"}\n                            onValueChange={(year) => {\n                              const currentDate = periodFrom || new Date();\n                              const newDate = new Date(parseInt(year), currentDate.getMonth(), currentDate.getDate());\n                              onPeriodFromChange(newDate);\n                              setFromDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[80px] h-8\">\n                              <SelectValue placeholder=\"Jaar\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 10 }, (_, i) => {\n                                const year = new Date().getFullYear() - i;\n                                return (\n                                  <SelectItem key={year} value={year.toString()}>\n                                    {year}\n                                  </SelectItem>\n                                );\n                              })}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                      <Calendar\n                        mode=\"single\"\n                        selected={periodFrom}\n                        onSelect={(date) => {\n                          console.log('Calendar from date selected:', date);\n                          onPeriodFromChange(date);\n                          setFromDateInput(\"\");\n                          setFromPopoverOpen(false);\n                        }}\n                        locale={nl}\n                        month={periodFrom || new Date()}\n                        onMonthChange={(month) => onPeriodFromChange(month)}\n                        showOutsideDays={false}\n                        className=\"p-3\"\n                        defaultMonth={new Date()}\n                      />\n                    </PopoverContent>\n                  </Popover>\n                </div>\n                \n                <span className=\"text-sm text-gray-400\">tot</span>\n                \n                <div className=\"relative\">\n                  <Input\n                    value={toDateInput || (periodTo ? format(periodTo, \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n                    onChange={(e) => handleToDateInput(e.target.value)}\n                    placeholder=\"DD/MM/YYYY\"\n                    className=\"w-[160px] h-9 border-gray-200 pr-10\"\n                    data-testid=\"paid-date-to\"\n                    maxLength={10}\n                  />\n                  <Popover open={toPopoverOpen} onOpenChange={setToPopoverOpen}>\n                    <PopoverTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                        onClick={() => setToPopoverOpen(true)}\n                      >\n                        <CalendarIcon className=\"h-4 w-4\" />\n                      </Button>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                      <div className=\"p-3 border-b\">\n                        <div className=\"flex items-center justify-between space-x-2\">\n                          <Select\n                            value={periodTo ? periodTo.getMonth().toString() : \"\"}\n                            onValueChange={(month) => {\n                              const currentDate = periodTo || new Date();\n                              const newDate = new Date(currentDate.getFullYear(), parseInt(month), currentDate.getDate());\n                              onPeriodToChange(newDate);\n                              setToDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[120px] h-8\">\n                              <SelectValue placeholder=\"Maand\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 12 }, (_, i) => (\n                                <SelectItem key={i} value={i.toString()}>\n                                  {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <Select\n                            value={periodTo ? periodTo.getFullYear().toString() : \"\"}\n                            onValueChange={(year) => {\n                              const currentDate = periodTo || new Date();\n                              const newDate = new Date(parseInt(year), currentDate.getMonth(), currentDate.getDate());\n                              onPeriodToChange(newDate);\n                              setToDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[80px] h-8\">\n                              <SelectValue placeholder=\"Jaar\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 10 }, (_, i) => {\n                                const year = new Date().getFullYear() - i;\n                                return (\n                                  <SelectItem key={year} value={year.toString()}>\n                                    {year}\n                                  </SelectItem>\n                                );\n                              })}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                      <Calendar\n                        mode=\"single\"\n                        selected={periodTo}\n                        onSelect={(date) => {\n                          onPeriodToChange(date);\n                          setToDateInput(\"\");\n                          setToPopoverOpen(false);\n                        }}\n                        locale={nl}\n                        month={periodTo || new Date()}\n                        onMonthChange={(month) => onPeriodToChange(month)}\n                        disabled={(date) => periodFrom ? date < periodFrom : false}\n                        showOutsideDays={false}\n                        className=\"p-3\"\n                        defaultMonth={new Date()}\n                      />\n                    </PopoverContent>\n                  </Popover>\n                </div>\n              </div>\n\n\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={onResetFilters}\n                className=\"h-9 px-3 border-gray-200 hover:border-gray-300\"\n                data-testid=\"reset-filters-button\"\n              >\n                <RiResetLeftFill className=\"h-4 w-4 mr-2\" />\n                Reset filters\n              </Button>\n            </div>\n\n            {/* Bulk Actions */}\n            {selectedCount > 0 && (\n              <div className=\"flex items-center gap-3 p-3 bg-blue-50 rounded-lg border border-blue-200\">\n                <span className=\"text-sm text-blue-700 font-medium\">\n                  {selectedCount} geselecteerd\n                </span>\n                <div className=\"flex gap-2\">\n                  <Button \n                    onClick={onBulkMarkPaid}\n                    size=\"sm\"\n                    className=\"h-8\"\n                    data-testid=\"bulk-mark-paid\"\n                  >\n                    Markeer betaald\n                  </Button>\n                  {sepaSelectedCount > 0 && (\n                    <Button \n                      onClick={onGenerateSepa}\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"h-8 flex items-center gap-1.5\"\n                      data-testid=\"generate-sepa\"\n                    >\n                      <CreditCard className=\"h-3 w-3\" />\n                      Genereer SEPA ({sepaSelectedCount})\n                    </Button>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":20837},"client/src/components/members/filters-drawer.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { \n  Sheet, \n  SheetContent, \n  SheetDescription, \n  SheetHeader, \n  SheetTitle, \n  SheetFooter,\n  SheetClose\n} from \"@/components/ui/sheet\";\nimport { \n  Select, \n  SelectContent, \n  SelectItem, \n  SelectTrigger, \n  SelectValue\n} from \"@/components/ui/select\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n\ninterface FilterValues {\n  categories: string[];\n  statuses: string[];\n  genders: string[];\n  joinDateFrom: string;\n  joinDateTo: string;\n  paymentStatuses: string[];\n  onlyActivePayments: boolean;\n}\n\ninterface FiltersDrawerProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  filters: FilterValues;\n  onFiltersChange: (filters: FilterValues) => void;\n}\n\nconst initialFilters: FilterValues = {\n  categories: [],\n  statuses: [],\n  genders: [],\n  joinDateFrom: \"\",\n  joinDateTo: \"\",\n  paymentStatuses: [],\n  onlyActivePayments: false,\n};\n\nexport function FiltersDrawer({ \n  open, \n  onOpenChange, \n  filters, \n  onFiltersChange \n}: FiltersDrawerProps) {\n  const [localFilters, setLocalFilters] = useState<FilterValues>(filters);\n\n  const updateLocalFilter = (key: keyof FilterValues, value: any) => {\n    setLocalFilters(prev => ({ ...prev, [key]: value }));\n  };\n\n  const handleCategoryChange = (category: string, checked: boolean) => {\n    const newCategories = checked \n      ? [...localFilters.categories, category]\n      : localFilters.categories.filter(c => c !== category);\n    updateLocalFilter('categories', newCategories);\n  };\n\n  const handleStatusChange = (status: string, checked: boolean) => {\n    const newStatuses = checked\n      ? [...localFilters.statuses, status]\n      : localFilters.statuses.filter(s => s !== status);\n    updateLocalFilter('statuses', newStatuses);\n  };\n\n  const handleGenderChange = (gender: string, checked: boolean) => {\n    const newGenders = checked\n      ? [...localFilters.genders, gender]\n      : localFilters.genders.filter(g => g !== gender);\n    updateLocalFilter('genders', newGenders);\n  };\n\n  const handlePaymentStatusChange = (status: string, checked: boolean) => {\n    const newPaymentStatuses = checked\n      ? [...localFilters.paymentStatuses, status]\n      : localFilters.paymentStatuses.filter(s => s !== status);\n    updateLocalFilter('paymentStatuses', newPaymentStatuses);\n  };\n\n  const handleApply = () => {\n    onFiltersChange(localFilters);\n    onOpenChange(false);\n  };\n\n  const handleReset = () => {\n    setLocalFilters(initialFilters);\n    onFiltersChange(initialFilters);\n    onOpenChange(false);\n  };\n\n  const hasActiveFilters = Object.values(localFilters).some(value => \n    Array.isArray(value) ? value.length > 0 : value !== \"\" && value !== false\n  );\n\n  return (\n    <Sheet open={open} onOpenChange={onOpenChange}>\n      <SheetContent className=\"sm:max-w-md overflow-y-auto\">\n        <SheetHeader>\n          <SheetTitle>Meer filters</SheetTitle>\n          <SheetDescription>\n            Verfijn je zoekopdracht met geavanceerde filteropties\n          </SheetDescription>\n        </SheetHeader>\n\n        <div className=\"py-6 space-y-6\">\n          {/* Categorie Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-gray-900\">Categorie</Label>\n            <Card>\n              <CardContent className=\"p-4 space-y-3\">\n                {[\n                  { value: 'SENIOR', label: 'Senior' },\n                  { value: 'STANDAARD', label: 'Standaard' },\n                  { value: 'STUDENT', label: 'Student' },\n                  { value: 'JEUGD', label: 'Jeugd' }\n                ].map((category) => (\n                  <div key={category.value} className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id={`category-${category.value}`}\n                      checked={localFilters.categories.includes(category.value)}\n                      onCheckedChange={(checked) => handleCategoryChange(category.value, !!checked)}\n                    />\n                    <Label \n                      htmlFor={`category-${category.value}`}\n                      className=\"text-sm font-normal cursor-pointer\"\n                    >\n                      {category.label}\n                    </Label>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Status Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-gray-900\">Status</Label>\n            <Card>\n              <CardContent className=\"p-4 space-y-3\">\n                {[\n                  { value: 'ACTIEF', label: 'Actief' },\n                  { value: 'INACTIEF', label: 'Inactief' }\n                ].map((status) => (\n                  <div key={status.value} className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id={`status-${status.value}`}\n                      checked={localFilters.statuses.includes(status.value)}\n                      onCheckedChange={(checked) => handleStatusChange(status.value, !!checked)}\n                    />\n                    <Label \n                      htmlFor={`status-${status.value}`}\n                      className=\"text-sm font-normal cursor-pointer\"\n                    >\n                      {status.label}\n                    </Label>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Geslacht Filter */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-gray-900\">Geslacht</Label>\n            <Card>\n              <CardContent className=\"p-4 space-y-3\">\n                {[\n                  { value: 'M', label: 'Man' },\n                  { value: 'V', label: 'Vrouw' }\n                ].map((gender) => (\n                  <div key={gender.value} className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id={`gender-${gender.value}`}\n                      checked={localFilters.genders.includes(gender.value)}\n                      onCheckedChange={(checked) => handleGenderChange(gender.value, !!checked)}\n                    />\n                    <Label \n                      htmlFor={`gender-${gender.value}`}\n                      className=\"text-sm font-normal cursor-pointer\"\n                    >\n                      {gender.label}\n                    </Label>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Inschrijvingsdatum */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-gray-900\">Inschrijvingsdatum</Label>\n            <Card>\n              <CardContent className=\"p-4 space-y-3\">\n                <div>\n                  <Label htmlFor=\"join-date-from\" className=\"text-xs text-gray-500\">Van</Label>\n                  <Input\n                    id=\"join-date-from\"\n                    type=\"date\"\n                    value={localFilters.joinDateFrom}\n                    onChange={(e) => updateLocalFilter('joinDateFrom', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"join-date-to\" className=\"text-xs text-gray-500\">Tot</Label>\n                  <Input\n                    id=\"join-date-to\"\n                    type=\"date\"\n                    value={localFilters.joinDateTo}\n                    onChange={(e) => updateLocalFilter('joinDateTo', e.target.value)}\n                    className=\"mt-1\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Betaalstatus */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium text-gray-900\">Betaalstatus</Label>\n            <Card>\n              <CardContent className=\"p-4 space-y-3\">\n                {[\n                  { value: 'PAID', label: 'Betaald' },\n                  { value: 'OPEN', label: 'Open' },\n                  { value: 'OVERDUE', label: 'Vervallen' }\n                ].map((status) => (\n                  <div key={status.value} className=\"flex items-center space-x-2\">\n                    <Checkbox\n                      id={`payment-${status.value}`}\n                      checked={localFilters.paymentStatuses.includes(status.value)}\n                      onCheckedChange={(checked) => handlePaymentStatusChange(status.value, !!checked)}\n                    />\n                    <Label \n                      htmlFor={`payment-${status.value}`}\n                      className=\"text-sm font-normal cursor-pointer\"\n                    >\n                      {status.label}\n                    </Label>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Alleen actieve mandaten */}\n          <div className=\"space-y-3\">\n            <Card>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id=\"active-payments-only\"\n                    checked={localFilters.onlyActivePayments}\n                    onCheckedChange={(checked) => updateLocalFilter('onlyActivePayments', !!checked)}\n                  />\n                  <Label \n                    htmlFor=\"active-payments-only\"\n                    className=\"text-sm font-normal cursor-pointer\"\n                  >\n                    Alleen actieve mandaten\n                  </Label>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        <SheetFooter className=\"gap-2 pt-6 border-t\">\n          <Button \n            variant=\"outline\" \n            onClick={handleReset}\n            disabled={!hasActiveFilters}\n            data-testid=\"reset-filters\"\n          >\n            Reset\n          </Button>\n          <Button \n            onClick={handleApply}\n            className=\"bg-blue-600 hover:bg-blue-700 text-white flex-1\"\n            data-testid=\"apply-filters\"\n          >\n            Toepassen\n          </Button>\n        </SheetFooter>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":10446},"client/src/components/members/members-table.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { StatusBadge } from \"@/components/ui/status-badge\";\nimport { RowActions } from \"./row-actions\";\nimport { ChevronUp, ChevronDown, Users, UserX, Mail, Calendar, User, MoreVertical } from \"lucide-react\";\nimport { BoardMemberBadge } from \"@/components/ui/board-member-badge\";\nimport { CiExport } from \"react-icons/ci\";\nimport { formatDate, getMemberCategoryLabel } from \"@/lib/format\";\nimport { cn } from \"@/lib/utils\";\nimport { VotingStatus } from \"@/components/members/voting-status\";\nimport { Member as MemberSchema } from \"@shared/schema\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\n\ninterface Member {\n  id: string;\n  memberNumber: string;\n  firstName: string;\n  lastName: string;\n  email?: string;\n  category: string;\n  active: boolean;\n  createdAt: string;\n  gender?: string;\n  birthDate?: string;\n  votingRights: boolean;\n}\n\ninterface SortConfig {\n  key: keyof Member | null;\n  direction: 'asc' | 'desc';\n}\n\ninterface MembersTableProps {\n  members: Member[];\n  total: number;\n  page: number;\n  perPage: number;\n  onPageChange: (page: number) => void;\n  onPerPageChange: (perPage: number) => void;\n  onRowAction: (action: string, memberId: string) => void;\n  onBulkAction: (action: string, memberIds: string[]) => void;\n  onView?: (id: string) => void;\n  onEdit?: (id: string) => void;\n  onToggleStatus?: (id: string, currentStatus: boolean) => void;\n  onDelete?: (id: string) => void;\n  loading?: boolean;\n}\n\nexport function MembersTable({\n  members,\n  total,\n  page,\n  perPage,\n  onPageChange,\n  onPerPageChange,\n  onRowAction,\n  onBulkAction,\n  onView,\n  onEdit,\n  onToggleStatus,\n  onDelete,\n  loading = false\n}: MembersTableProps) {\n  const [selectedIds, setSelectedIds] = useState<string[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: null, direction: 'asc' });\n  const isMobile = useIsMobile();\n\n  const handleSort = (key: keyof Member) => {\n    const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';\n    setSortConfig({ key, direction });\n  };\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(members.map(m => m.id));\n    } else {\n      setSelectedIds([]);\n    }\n  };\n\n  const handleSelectRow = (memberId: string, checked: boolean) => {\n    if (checked) {\n      setSelectedIds([...selectedIds, memberId]);\n    } else {\n      setSelectedIds(selectedIds.filter(id => id !== memberId));\n    }\n  };\n\n  const handleBulkExport = () => {\n    onBulkAction('export', selectedIds);\n    setSelectedIds([]);\n  };\n\n  const handleBulkDeactivate = () => {\n    onBulkAction('deactivate', selectedIds);\n    setSelectedIds([]);\n  };\n\n  const getSortIcon = (key: keyof Member) => {\n    if (sortConfig.key !== key) return null;\n    return sortConfig.direction === 'asc' ? \n      <ChevronUp className=\"h-4 w-4\" /> : \n      <ChevronDown className=\"h-4 w-4\" />;\n  };\n\n  const totalPages = Math.ceil(total / perPage);\n  const startItem = (page - 1) * perPage + 1;\n  const endItem = Math.min(page * perPage, total);\n\n  if (loading) {\n    return <SkeletonTable />;\n  }\n\n  if (isMobile) {\n    return (\n      <div className=\"space-y-4\">\n        {/* Mobile Header */}\n        <Card className=\"glass-card border-0\">\n          <CardHeader className=\"px-4 py-3\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900\">Ledenlijst</h3>\n                <p className=\"text-sm text-gray-500\">\n                  {startItem}-{endItem} van {total} leden\n                </p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-xs text-gray-500\">Per pagina:</span>\n                <Select value={perPage.toString()} onValueChange={(value) => onPerPageChange(Number(value))}>\n                  <SelectTrigger className=\"w-16 h-8 text-xs\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"10\">10</SelectItem>\n                    <SelectItem value=\"20\">20</SelectItem>\n                    <SelectItem value=\"50\">50</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardHeader>\n        </Card>\n\n        {/* Mobile Bulk Actions */}\n        {selectedIds.length > 0 && (\n          <Card className=\"bg-blue-50 border-blue-200\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium text-blue-900\">\n                  {selectedIds.length} geselecteerd\n                </span>\n                <div className=\"flex gap-2\">\n                  <Button \n                    size=\"sm\" \n                    variant=\"outline\"\n                    onClick={handleBulkExport}\n                    className=\"border-blue-200 text-blue-700 hover:bg-blue-100\"\n                  >\n                    <CiExport className=\"h-4 w-4\" />\n                  </Button>\n                  <Button \n                    size=\"sm\" \n                    variant=\"outline\"\n                    onClick={handleBulkDeactivate}\n                    className=\"border-red-200 text-red-700 hover:bg-red-100\"\n                  >\n                    <UserX className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Mobile Member Cards */}\n        <div className=\"space-y-3\">\n          {members.map((member) => (\n            <Card key={member.id} className=\"glass-card border-0 overflow-hidden\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-start justify-between mb-3\">\n                  <div className=\"flex items-center gap-3\">\n                    <Checkbox\n                      checked={selectedIds.includes(member.id)}\n                      onCheckedChange={(checked) => handleSelectRow(member.id, checked as boolean)}\n                      className=\"mt-1\"\n                    />\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-1\">\n                        <h4 className=\"font-semibold text-gray-900 text-sm\">\n                          {member.firstName} {member.lastName}\n                        </h4>\n                        <BoardMemberBadge memberId={member.id} size=\"sm\" />\n                      </div>\n                      <p className=\"text-xs text-gray-500\">#{member.memberNumber}</p>\n                    </div>\n                  </div>\n                  <RowActions\n                    member={member}\n                    onView={onView || (() => {})}\n                    onEdit={onEdit || (() => {})}\n                    onToggleStatus={onToggleStatus || (() => {})}\n                    onDelete={onDelete || (() => {})}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-3 text-xs\">\n                  <div className=\"flex items-center gap-2 text-gray-600\">\n                    <Mail className=\"h-3 w-3\" />\n                    <span className=\"truncate\">{member.email || 'Geen email'}</span>\n                  </div>\n                  <div className=\"flex items-center gap-2 text-gray-600\">\n                    <Calendar className=\"h-3 w-3\" />\n                    <span>{formatDate(member.createdAt)}</span>\n                  </div>\n                </div>\n\n                <div className=\"flex items-center justify-between mt-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <StatusBadge status={member.active ? 'ACTIEF' : 'INACTIEF'} />\n                    <Badge variant=\"outline\" className=\"text-xs\">\n                      {getMemberCategoryLabel(member.category)}\n                    </Badge>\n                  </div>\n                  <VotingStatus member={member as any} />\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {/* Mobile Pagination */}\n        <Card className=\"glass-card border-0\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <Button\n                onClick={() => onPageChange(page - 1)}\n                disabled={page <= 1}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                Vorige\n              </Button>\n              <span className=\"text-sm text-gray-600\">\n                Pagina {page} van {totalPages}\n              </span>\n              <Button\n                onClick={() => onPageChange(page + 1)}\n                disabled={page >= totalPages}\n                variant=\"outline\"\n                size=\"sm\"\n              >\n                Volgende\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n      {selectedIds.length > 0 && (\n        <div className=\"px-6 py-4 bg-blue-50 border-b border-blue-200\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-medium text-blue-900\">\n              {selectedIds.length} geselecteerd\n            </span>\n            <div className=\"flex gap-2\">\n              <Button \n                size=\"sm\" \n                variant=\"outline\"\n                onClick={handleBulkExport}\n                className=\"border-blue-200 text-blue-700 hover:bg-blue-100\"\n                data-testid=\"bulk-export\"\n              >\n                <CiExport className=\"h-4 w-4 mr-2\" />\n                Export selectie\n              </Button>\n              <Button \n                size=\"sm\" \n                variant=\"outline\"\n                onClick={handleBulkDeactivate}\n                className=\"border-red-200 text-red-700 hover:bg-red-100\"\n                data-testid=\"bulk-deactivate\"\n              >\n                <UserX className=\"h-4 w-4 mr-2\" />\n                Markeer inactief\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      <CardHeader className=\"px-6 py-4 border-b border-gray-200\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-lg font-semibold text-gray-900\">Ledenlijst</h3>\n            <p className=\"text-sm text-gray-500\">\n              {startItem}-{endItem} van {total} leden\n            </p>\n          </div>\n          \n          <div className=\"hidden sm:flex items-center gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-sm text-gray-500\">Per pagina:</span>\n              <Select value={perPage.toString()} onValueChange={(value) => onPerPageChange(Number(value))}>\n                <SelectTrigger className=\"w-20 h-8\" data-testid=\"per-page-select\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"10\">10</SelectItem>\n                  <SelectItem value=\"20\">20</SelectItem>\n                  <SelectItem value=\"50\">50</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-0\">\n        {members.length === 0 ? (\n          <EmptyState />\n        ) : (\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead className=\"w-12\">\n                <Checkbox\n                  checked={selectedIds.length === members.length && members.length > 0}\n                  onCheckedChange={handleSelectAll}\n                  aria-label=\"Selecteer alle leden\"\n                />\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-[#f9fafb]\"\n                onClick={() => handleSort('memberNumber')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Lidnummer\n                  {getSortIcon('memberNumber')}\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-[#f9fafb]\"\n                onClick={() => handleSort('lastName')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Naam\n                  {getSortIcon('lastName')}\n                </div>\n              </TableHead>\n              <TableHead className=\"hidden lg:table-cell\">\n                Voornaam\n              </TableHead>\n              <TableHead>\n                Status\n              </TableHead>\n              <TableHead className=\"hidden md:table-cell\">\n                Categorie\n              </TableHead>\n              <TableHead \n                className=\"hidden lg:table-cell cursor-pointer hover:bg-[#f9fafb]\"\n                onClick={() => handleSort('createdAt')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Inschrijvingsdatum\n                  {getSortIcon('createdAt')}\n                </div>\n              </TableHead>\n              <TableHead className=\"text-right\">\n                Acties\n              </TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {members.map((member) => (\n              <TableRow \n                key={member.id} \n                className={cn(\n                  \"hover:bg-gray-50 transition-colors\",\n                  selectedIds.includes(member.id) && \"bg-blue-50\"\n                )}\n                data-testid={`member-row-${member.id}`}\n              >\n                <TableCell>\n                  <Checkbox\n                    checked={selectedIds.includes(member.id)}\n                    onCheckedChange={(checked) => handleSelectRow(member.id, !!checked)}\n                    aria-label={`Selecteer ${member.firstName} ${member.lastName}`}\n                  />\n                </TableCell>\n                <TableCell className=\"font-mono\">\n                  {member.memberNumber}\n                </TableCell>\n                <TableCell>\n                  <div className=\"font-medium flex items-center gap-2\">\n                    {member.lastName}\n                    <BoardMemberBadge memberId={member.id} size=\"sm\" />\n                  </div>\n                  <div className=\"text-sm text-gray-500 lg:hidden\">\n                    {member.firstName}\n                  </div>\n                </TableCell>\n                <TableCell className=\"hidden lg:table-cell\">\n                  {member.firstName}\n                </TableCell>\n                <TableCell>\n                  <StatusBadge status={member.active ? 'ACTIEF' : 'INACTIEF'} />\n                </TableCell>\n                <TableCell className=\"hidden md:table-cell\">\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {getMemberCategoryLabel(member.category)}\n                  </Badge>\n                </TableCell>\n                <TableCell className=\"hidden lg:table-cell text-gray-500\">\n                  {formatDate(member.createdAt)}\n                </TableCell>\n                <TableCell className=\"text-right\">\n                  <RowActions\n                    memberId={member.id}\n                    memberName={`${member.firstName} ${member.lastName}`}\n                    isActive={member.active}\n                    onView={onView || ((id) => onRowAction('view', id))}\n                    onEdit={onEdit || ((id) => onRowAction('edit', id))}\n                    onToggleStatus={onToggleStatus || ((id, currentStatus) => onRowAction('toggleStatus', id))}\n                    onDelete={onDelete || ((id) => onRowAction('delete', id))}\n                  />\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n        )}\n      </CardContent>\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"px-6 py-4 border-t border-gray-200\">\n          <div className=\"flex items-center justify-center\">\n            <div className=\"flex items-center gap-2\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => onPageChange(page - 1)}\n                disabled={page === 1}\n                data-testid=\"prev-page\"\n              >\n                Vorige\n              </Button>\n              \n              {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\n                const pageNum = i + 1;\n                return (\n                  <Button\n                    key={pageNum}\n                    variant={page === pageNum ? \"default\" : \"outline\"}\n                    size=\"sm\"\n                    onClick={() => onPageChange(pageNum)}\n                    className={page === pageNum ? \"bg-blue-600 hover:bg-blue-700\" : \"\"}\n                    data-testid={`page-${pageNum}`}\n                  >\n                    {pageNum}\n                  </Button>\n                );\n              })}\n              \n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => onPageChange(page + 1)}\n                disabled={page === totalPages}\n                data-testid=\"next-page\"\n              >\n                Volgende\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </Card>\n  );\n}\n\nfunction SkeletonTable() {\n  return (\n    <Card className=\"shadow-sm border border-gray-200\">\n      <CardHeader className=\"px-6 py-4 border-b border-gray-200\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-6 bg-gray-200 rounded w-1/4 mb-2\"></div>\n          <div className=\"h-4 bg-gray-200 rounded w-1/6\"></div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-0\">\n        <div className=\"space-y-0\">\n          {[...Array(5)].map((_, i) => (\n            <div key={i} className=\"px-6 py-4 border-b border-gray-200 animate-pulse\">\n              <div className=\"flex items-center space-x-4\">\n                <div className=\"w-4 h-4 bg-gray-200 rounded\"></div>\n                <div className=\"w-16 h-4 bg-gray-200 rounded\"></div>\n                <div className=\"flex items-center space-x-3\">\n                  <div className=\"w-8 h-8 bg-gray-200 rounded-full\"></div>\n                  <div className=\"space-y-1\">\n                    <div className=\"w-24 h-4 bg-gray-200 rounded\"></div>\n                    <div className=\"w-16 h-3 bg-gray-200 rounded\"></div>\n                  </div>\n                </div>\n                <div className=\"w-16 h-4 bg-gray-200 rounded\"></div>\n                <div className=\"w-12 h-6 bg-gray-200 rounded-full\"></div>\n                <div className=\"w-16 h-6 bg-gray-200 rounded-full\"></div>\n                <div className=\"w-20 h-4 bg-gray-200 rounded\"></div>\n                <div className=\"w-8 h-4 bg-gray-200 rounded\"></div>\n              </div>\n            </div>\n          ))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction EmptyState() {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n      <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n        <Users className=\"w-8 h-8 text-gray-400\" />\n      </div>\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n        Geen leden gevonden\n      </h3>\n      <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n        Voeg je eerste lid toe om te beginnen met het beheren van je ledenbestand.\n      </p>\n    </div>\n  );\n}","size_bytes":20122},"client/src/components/members/row-actions.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { \n  DropdownMenu, \n  DropdownMenuContent, \n  DropdownMenuItem, \n  DropdownMenuTrigger,\n  DropdownMenuSeparator \n} from \"@/components/ui/dropdown-menu\";\nimport { \n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { MoreVertical, Eye, Edit2, UserX, UserCheck, Trash2 } from \"lucide-react\";\nimport { useState } from \"react\";\n\ninterface RowActionsProps {\n  memberId: string;\n  memberName: string;\n  isActive: boolean;\n  onView: (id: string) => void;\n  onEdit: (id: string) => void;\n  onToggleStatus: (id: string, currentStatus: boolean) => void;\n  onDelete: (id: string) => void;\n}\n\nexport function RowActions({ \n  memberId, \n  memberName, \n  isActive, \n  onView, \n  onEdit, \n  onToggleStatus,\n  onDelete \n}: RowActionsProps) {\n  const [showDeactivateDialog, setShowDeactivateDialog] = useState(false);\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n\n  const handleToggleStatus = () => {\n    if (isActive) {\n      setShowDeactivateDialog(true);\n    } else {\n      onToggleStatus(memberId, isActive);\n    }\n  };\n\n  const handleConfirmDeactivate = () => {\n    onToggleStatus(memberId, isActive);\n    setShowDeactivateDialog(false);\n  };\n\n  return (\n    <>\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button \n            variant=\"ghost\" \n            size=\"sm\" \n            className=\"h-8 w-8 p-0 text-gray-400 hover:text-gray-600 hover:bg-gray-50\"\n            data-testid={`member-actions-${memberId}`}\n            aria-label=\"Lidacties\"\n          >\n            <MoreVertical className=\"h-4 w-4\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\" className=\"w-48\">\n          <DropdownMenuItem \n            onClick={() => onView(memberId)}\n            className=\"cursor-pointer\"\n            data-testid={`action-view-${memberId}`}\n          >\n            <Eye className=\"h-4 w-4 mr-2\" />\n            Bekijk\n          </DropdownMenuItem>\n          <DropdownMenuItem \n            onClick={() => onEdit(memberId)}\n            className=\"cursor-pointer\"\n            data-testid={`action-edit-${memberId}`}\n          >\n            <Edit2 className=\"h-4 w-4 mr-2\" />\n            Bewerken\n          </DropdownMenuItem>\n          <DropdownMenuSeparator />\n          <DropdownMenuItem \n            onClick={handleToggleStatus}\n            className={`cursor-pointer ${\n              isActive \n                ? '' \n                : 'text-green-600 focus:text-green-600 focus:bg-green-50'\n            }`}\n            data-testid={`action-toggle-status-${memberId}`}\n          >\n            {isActive ? (\n              <>\n                <UserX className=\"h-4 w-4 mr-2\" />\n                Deactiveren\n              </>\n            ) : (\n              <>\n                <UserCheck className=\"h-4 w-4 mr-2\" />\n                Activeren\n              </>\n            )}\n          </DropdownMenuItem>\n          <DropdownMenuSeparator />\n          <DropdownMenuItem \n            onClick={() => setShowDeleteDialog(true)}\n            className=\"cursor-pointer text-red-600 focus:text-red-600 focus:bg-red-50\"\n            data-testid={`action-delete-${memberId}`}\n          >\n            <Trash2 className=\"h-4 w-4 mr-2\" />\n            Verwijderen\n          </DropdownMenuItem>\n        </DropdownMenuContent>\n      </DropdownMenu>\n\n      <AlertDialog open={showDeactivateDialog} onOpenChange={setShowDeactivateDialog}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Lid deactiveren</AlertDialogTitle>\n            <AlertDialogDescription>\n              Weet je zeker dat je <strong>{memberName}</strong> wilt deactiveren? \n              <br /><br />\n              <strong>Dit gebeurt automatisch:</strong>\n              <br />• Lid wordt gemarkeerd als inactief\n              <br />• Lidkaart krijgt status \"VERLOPEN\"\n              <br />• Geen toegang meer tot diensten\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Annuleren</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={handleConfirmDeactivate}\n              className=\"bg-red-600 hover:bg-red-700 text-white\"\n            >\n              Deactiveren\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      <AlertDialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Lid permanent verwijderen</AlertDialogTitle>\n            <AlertDialogDescription>\n              Weet je zeker dat je <strong>{memberName}</strong> permanent wilt verwijderen? \n              Deze actie kan niet ongedaan worden gemaakt. Alle gegevens, betalingshistoriek en transacties van dit lid worden definitief gewist.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Annuleren</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={() => {\n                onDelete(memberId);\n                setShowDeleteDialog(false);\n              }}\n              className=\"bg-red-600 hover:bg-red-700 text-white\"\n            >\n              Permanent Verwijderen\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n}","size_bytes":5619},"client/src/components/members/toolbar.tsx":{"content":"import { useState, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Search, Plus, SlidersHorizontal, Command, CalendarIcon } from \"lucide-react\";\nimport { CiExport, CiImport } from \"react-icons/ci\";\nimport { RiResetLeftFill } from \"react-icons/ri\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\n\ninterface ToolbarProps {\n  searchTerm: string;\n  onSearchChange: (value: string) => void;\n  statusFilter: string;\n  onStatusFilterChange: (value: string) => void;\n  categoryFilter: string;\n  onCategoryFilterChange: (value: string) => void;\n  votingRightsFilter: string;\n  onVotingRightsFilterChange: (value: string) => void;\n  joinDateFrom: Date | undefined;\n  onJoinDateFromChange: (date: Date | undefined) => void;\n  joinDateTo: Date | undefined;\n  onJoinDateToChange: (date: Date | undefined) => void;\n  paymentStatusFilter: string;\n  onPaymentStatusFilterChange: (value: string) => void;\n  onExport: () => void;\n  onImport: () => void;\n  onNewMember: () => void;\n  onMoreFilters: () => void;\n  className?: string;\n}\n\nexport function Toolbar({\n  searchTerm,\n  onSearchChange,\n  statusFilter,\n  onStatusFilterChange,\n  categoryFilter,\n  onCategoryFilterChange,\n  votingRightsFilter,\n  onVotingRightsFilterChange,\n  joinDateFrom,\n  onJoinDateFromChange,\n  joinDateTo,\n  onJoinDateToChange,\n  paymentStatusFilter,\n  onPaymentStatusFilterChange,\n  onExport,\n  onImport,\n  onNewMember,\n  onMoreFilters,\n  className\n}: ToolbarProps) {\n  const [fromDateInput, setFromDateInput] = useState(\"\");\n  const [toDateInput, setToDateInput] = useState(\"\");\n  const [fromPopoverOpen, setFromPopoverOpen] = useState(false);\n  const [toPopoverOpen, setToPopoverOpen] = useState(false);\n\n  const formatDateInput = (value: string) => {\n    // Remove all non-numeric characters\n    const numbers = value.replace(/\\D/g, '');\n    \n    // Apply DD/MM/YYYY formatting\n    if (numbers.length <= 2) {\n      return numbers;\n    } else if (numbers.length <= 4) {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2)}`;\n    } else {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;\n    }\n  };\n\n  const parseDate = (dateString: string): Date | undefined => {\n    const cleanString = dateString.replace(/\\D/g, '');\n    if (cleanString.length === 8) {\n      const day = parseInt(cleanString.slice(0, 2));\n      const month = parseInt(cleanString.slice(2, 4)) - 1; // Month is 0-indexed\n      const year = parseInt(cleanString.slice(4, 8));\n      \n      const date = new Date(year, month, day);\n      if (date.getDate() === day && date.getMonth() === month && date.getFullYear() === year) {\n        return date;\n      }\n    }\n    return undefined;\n  };\n\n  const handleFromDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setFromDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      onJoinDateFromChange(parsedDate);\n    }\n  };\n\n  const handleToDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setToDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      onJoinDateToChange(parsedDate);\n    }\n  };\n  return (\n    <Card className={cn(\"glass-card card-hover animate-fade-in group mb-6\", className)}>\n      <CardContent className=\"p-6\">\n        <div className=\"space-y-4\">\n          {/* Search and Action Buttons */}\n          <div className=\"flex flex-col lg:flex-row gap-4\">\n            <div className=\"relative flex-1\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n              <Input\n                placeholder=\"Zoek op naam, e-mail of lidnummer...\"\n                value={searchTerm}\n                onChange={(e) => onSearchChange(e.target.value)}\n                className=\"pl-10 pr-16 h-10 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20\"\n                data-testid=\"search-members\"\n              />\n              <div className=\"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-1 text-xs text-gray-400\">\n                <Command className=\"h-3 w-3\" />\n                <span>K</span>\n              </div>\n            </div>\n            \n            <div className=\"flex gap-2 lg:flex-shrink-0\">\n              <Button \n                variant=\"outline\" \n                onClick={onExport}\n                className=\"h-10 px-4 border-gray-200 hover:border-gray-300\"\n                data-testid=\"export-button\"\n              >\n                <CiExport className=\"h-4 w-4 mr-2\" />\n                Export\n              </Button>\n              <Button \n                variant=\"outline\" \n                onClick={onImport}\n                className=\"h-10 px-4 border-gray-200 hover:border-gray-300\"\n                data-testid=\"import-button\"\n              >\n                <CiImport className=\"h-4 w-4 mr-2\" />\n                Import\n              </Button>\n              <Button \n                onClick={onNewMember}\n                className=\"h-10 px-4 bg-blue-600 hover:bg-blue-700 text-white\"\n                data-testid=\"new-member-button\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Nieuw lid\n              </Button>\n            </div>\n          </div>\n\n          {/* All Filters */}\n          <div className=\"flex flex-col gap-4\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3\">\n              <Select value={statusFilter} onValueChange={onStatusFilterChange}>\n                <SelectTrigger className=\"h-9 border-gray-200\" data-testid=\"status-filter\">\n                  <SelectValue placeholder=\"Alle statussen\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle statussen</SelectItem>\n                  <SelectItem value=\"ACTIEF\">Actief</SelectItem>\n                  <SelectItem value=\"INACTIEF\">Inactief</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={categoryFilter} onValueChange={onCategoryFilterChange}>\n                <SelectTrigger className=\"h-9 border-gray-200\" data-testid=\"category-filter\">\n                  <SelectValue placeholder=\"Alle categorieën\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle categorieën</SelectItem>\n                  <SelectItem value=\"SENIOR\">Senior</SelectItem>\n                  <SelectItem value=\"STANDAARD\">Standaard</SelectItem>\n                  <SelectItem value=\"STUDENT\">Student</SelectItem>\n                  <SelectItem value=\"JEUGD\">Jeugd</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={votingRightsFilter} onValueChange={onVotingRightsFilterChange}>\n                <SelectTrigger className=\"h-9 border-gray-200\" data-testid=\"voting-rights-filter\">\n                  <SelectValue placeholder=\"Stemgerechtigdheid\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"yes\">Stemgerechtigd</SelectItem>\n                  <SelectItem value=\"no\">Niet stemgerechtigd</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={paymentStatusFilter} onValueChange={onPaymentStatusFilterChange}>\n                <SelectTrigger className=\"h-9 border-gray-200\" data-testid=\"payment-status-filter\">\n                  <SelectValue placeholder=\"Alle betaalstatussen\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">Alle betaalstatussen</SelectItem>\n                  <SelectItem value=\"PAID\">Betaald</SelectItem>\n                  <SelectItem value=\"OPEN\">Open</SelectItem>\n                  <SelectItem value=\"OVERDUE\">Vervallen</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"hidden lg:flex flex-wrap gap-3 items-center\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-sm text-gray-600\">Inschrijving:</span>\n                \n                <div className=\"relative\">\n                  <Input\n                    value={fromDateInput || (joinDateFrom ? format(joinDateFrom, \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n                    onChange={(e) => handleFromDateInput(e.target.value)}\n                    placeholder=\"DD/MM/YYYY\"\n                    className=\"w-[180px] h-9 border-gray-200 pr-10\"\n                    data-testid=\"join-date-from\"\n                    maxLength={10}\n                  />\n                  <Popover open={fromPopoverOpen} onOpenChange={setFromPopoverOpen}>\n                    <PopoverTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-2 top-2 h-6 w-6 p-1 hover:bg-transparent hover:scale-100 focus:bg-transparent active:bg-transparent transition-none transform-none\"\n                        onClick={() => setFromPopoverOpen(true)}\n                      >\n                        <CalendarIcon className=\"h-4 w-4\" />\n                      </Button>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                      <div className=\"p-3 border-b\">\n                        <div className=\"flex items-center justify-between space-x-2\">\n                          <Select\n                            value={joinDateFrom ? joinDateFrom.getMonth().toString() : \"\"}\n                            onValueChange={(month) => {\n                              const currentDate = joinDateFrom || new Date();\n                              const newDate = new Date(currentDate.getFullYear(), parseInt(month), currentDate.getDate());\n                              onJoinDateFromChange(newDate);\n                              setFromDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[120px] h-8\">\n                              <SelectValue placeholder=\"Maand\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 12 }, (_, i) => (\n                                <SelectItem key={i} value={i.toString()}>\n                                  {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <Select\n                            value={joinDateFrom ? joinDateFrom.getFullYear().toString() : \"\"}\n                            onValueChange={(year) => {\n                              const currentDate = joinDateFrom || new Date();\n                              const newDate = new Date(parseInt(year), currentDate.getMonth(), currentDate.getDate());\n                              onJoinDateFromChange(newDate);\n                              setFromDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[80px] h-8\">\n                              <SelectValue placeholder=\"Jaar\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 75 }, (_, i) => {\n                                const year = new Date().getFullYear() - i;\n                                return (\n                                  <SelectItem key={year} value={year.toString()}>\n                                    {year}\n                                  </SelectItem>\n                                );\n                              })}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                      <Calendar\n                        mode=\"single\"\n                        selected={joinDateFrom}\n                        onSelect={(date) => {\n                          onJoinDateFromChange(date);\n                          setFromDateInput(\"\");\n                          setFromPopoverOpen(false);\n                        }}\n                        locale={nl}\n                        month={joinDateFrom || new Date()}\n                        onMonthChange={(month) => onJoinDateFromChange(month)}\n                        showOutsideDays={false}\n                        className=\"p-3\"\n                        defaultMonth={new Date()}\n                      />\n                    </PopoverContent>\n                  </Popover>\n                </div>\n                \n                <span className=\"text-sm text-gray-400\">tot</span>\n                \n                <div className=\"relative\">\n                  <Input\n                    value={toDateInput || (joinDateTo ? format(joinDateTo, \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n                    onChange={(e) => handleToDateInput(e.target.value)}\n                    placeholder=\"DD/MM/YYYY\"\n                    className=\"w-[180px] h-9 border-gray-200 pr-10\"\n                    data-testid=\"join-date-to\"\n                    maxLength={10}\n                  />\n                  <Popover open={toPopoverOpen} onOpenChange={setToPopoverOpen}>\n                    <PopoverTrigger asChild>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        className=\"absolute right-2 top-2 h-6 w-6 p-1 hover:bg-transparent hover:scale-100 focus:bg-transparent active:bg-transparent transition-none transform-none\"\n                        onClick={() => setToPopoverOpen(true)}\n                      >\n                        <CalendarIcon className=\"h-4 w-4\" />\n                      </Button>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                      <div className=\"p-3 border-b\">\n                        <div className=\"flex items-center justify-between space-x-2\">\n                          <Select\n                            value={joinDateTo ? joinDateTo.getMonth().toString() : \"\"}\n                            onValueChange={(month) => {\n                              const currentDate = joinDateTo || new Date();\n                              const newDate = new Date(currentDate.getFullYear(), parseInt(month), currentDate.getDate());\n                              onJoinDateToChange(newDate);\n                              setToDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[120px] h-8\">\n                              <SelectValue placeholder=\"Maand\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 12 }, (_, i) => (\n                                <SelectItem key={i} value={i.toString()}>\n                                  {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                          <Select\n                            value={joinDateTo ? joinDateTo.getFullYear().toString() : \"\"}\n                            onValueChange={(year) => {\n                              const currentDate = joinDateTo || new Date();\n                              const newDate = new Date(parseInt(year), currentDate.getMonth(), currentDate.getDate());\n                              onJoinDateToChange(newDate);\n                              setToDateInput(\"\");\n                            }}\n                          >\n                            <SelectTrigger className=\"w-[80px] h-8\">\n                              <SelectValue placeholder=\"Jaar\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {Array.from({ length: 75 }, (_, i) => {\n                                const year = new Date().getFullYear() - i;\n                                return (\n                                  <SelectItem key={year} value={year.toString()}>\n                                    {year}\n                                  </SelectItem>\n                                );\n                              })}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                      </div>\n                      <Calendar\n                        mode=\"single\"\n                        selected={joinDateTo}\n                        onSelect={(date) => {\n                          onJoinDateToChange(date);\n                          setToDateInput(\"\");\n                          setToPopoverOpen(false);\n                        }}\n                        locale={nl}\n                        month={joinDateTo || new Date()}\n                        onMonthChange={(month) => onJoinDateToChange(month)}\n                        disabled={(date) => joinDateFrom ? date < joinDateFrom : false}\n                        showOutsideDays={false}\n                        className=\"p-3\"\n                        defaultMonth={new Date()}\n                      />\n                    </PopoverContent>\n                  </Popover>\n                </div>\n              </div>\n\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={onMoreFilters}\n                className=\"h-9 px-3 border-gray-200 hover:border-gray-300\"\n                data-testid=\"more-filters-button\"\n              >\n                <RiResetLeftFill className=\"h-4 w-4 mr-2\" />\n                Reset filters\n              </Button>\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":18457},"client/src/components/ui/section-card.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\ninterface SectionCardProps {\n  title: string;\n  description?: string;\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport function SectionCard({ title, description, children, className }: SectionCardProps) {\n  return (\n    <Card className={cn(\"border border-gray-200 shadow-sm\", className)}>\n      <CardHeader className=\"pb-4\">\n        <CardTitle className=\"text-lg font-semibold text-gray-900\">\n          {title}\n        </CardTitle>\n        {description && (\n          <p className=\"text-sm text-gray-600 mt-1\">\n            {description}\n          </p>\n        )}\n      </CardHeader>\n      <CardContent className=\"pt-0\">\n        {children}\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":806},"client/src/components/ui/status-badge.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\n\ninterface StatusBadgeProps {\n  status: 'ACTIEF' | 'INACTIEF';\n  className?: string;\n}\n\nexport function StatusBadge({ status, className }: StatusBadgeProps) {\n  const isActive = status === 'ACTIEF';\n  \n  return (\n    <Badge\n      variant=\"secondary\"\n      className={cn(\n        \"inline-flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-full\",\n        isActive \n          ? \"bg-green-50 text-green-700 border-green-200 hover:bg-green-50\" \n          : \"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-50\",\n        className\n      )}\n    >\n      <div \n        className={cn(\n          \"w-1.5 h-1.5 rounded-full\",\n          isActive ? \"bg-green-500\" : \"bg-gray-400\"\n        )} \n      />\n      {status === 'ACTIEF' ? 'Actief' : 'Inactief'}\n    </Badge>\n  );\n}","size_bytes":859},"client/src/lib/mock/fees.ts":{"content":"import { Fee, FeeStatus, PaymentMethod } from \"@shared/fees-schema\";\nimport { addMonths, startOfMonth, endOfMonth, isAfter, format } from \"date-fns\";\n\n// Mock data generation\nexport function generateMockFees(): Fee[] {\n  const fees: Fee[] = [];\n  const startDate = new Date(2023, 0, 1);\n  const endDate = new Date(2025, 11, 31);\n  \n  const members = [\n    { id: \"1\", number: \"0001\", lastName: \"Al-Hassan\", firstName: \"Ahmed\", email: \"ahmed.hassan@email.be\", phone: \"+32 495 12 34 56\" },\n    { id: \"2\", number: \"0002\", lastName: \"Ben Omar\", firstName: \"Fatima\", email: \"fatima.benomar@email.be\", phone: \"+32 495 23 45 67\" },\n    { id: \"3\", number: \"0003\", lastName: \"El-Mansouri\", firstName: \"Youssef\", email: \"youssef.mansouri@email.be\", phone: \"+32 495 34 56 78\" },\n    { id: \"4\", number: \"0004\", lastName: \"Khalil\", firstName: \"Amina\", email: \"amina.khalil@email.be\", phone: \"+32 495 45 67 89\" },\n    { id: \"5\", number: \"0005\", lastName: \"Benali\", firstName: \"Hassan\", email: \"hassan.benali@email.be\", phone: \"+32 495 56 78 90\" },\n    { id: \"6\", number: \"0006\", lastName: \"Sabri\", firstName: \"Leila\", email: \"leila.sabri@email.be\", phone: \"+32 495 67 89 01\" },\n    { id: \"7\", number: \"0007\", lastName: \"Hajji\", firstName: \"Omar\", email: \"omar.hajji@email.be\", phone: \"+32 495 78 90 12\" },\n    { id: \"8\", number: \"0008\", lastName: \"Zahra\", firstName: \"Nadia\", email: \"nadia.zahra@email.be\", phone: \"+32 495 89 01 23\" },\n    { id: \"9\", number: \"0009\", lastName: \"Karam\", firstName: \"Ali\", email: \"ali.karam@email.be\", phone: \"+32 495 90 12 34\" },\n    { id: \"10\", number: \"0010\", lastName: \"Bakr\", firstName: \"Sara\", email: \"sara.bakr@email.be\", phone: \"+32 495 01 23 45\" },\n  ];\n  \n  const methods: PaymentMethod[] = [\"SEPA\", \"OVERSCHRIJVING\", \"BANCONTACT\", \"CASH\"];\n  const amounts = [15, 30, 45, 60]; // Monthly amounts in euros\n  const categories = [\"STUDENT\", \"STANDAARD\", \"SENIOR\"];\n  \n  let feeId = 1;\n  \n  // Generate fees for each member for each month in the period\n  members.forEach(member => {\n    let currentDate = startDate;\n    const memberCategory = categories[Math.floor(Math.random() * categories.length)];\n    \n    while (currentDate <= endDate) {\n      const periodStart = startOfMonth(currentDate);\n      const periodEnd = endOfMonth(currentDate);\n      const dueDate = new Date(periodEnd.getTime() + 15 * 24 * 60 * 60 * 1000); // 15 days after period end\n      const method = methods[Math.floor(Math.random() * methods.length)];\n      const amount = amounts[Math.floor(Math.random() * amounts.length)];\n      \n      // Determine status based on current date and some randomness\n      let status: FeeStatus = \"OPEN\";\n      let paidAt: string | undefined;\n      let transactionId: string | undefined;\n      let reference: string | undefined;\n      \n      const now = new Date();\n      const isOverdue = isAfter(now, dueDate);\n      \n      if (Math.random() > 0.3) { // 70% chance of being paid\n        status = \"PAID\";\n        const paymentDate = new Date(periodEnd.getTime() + Math.random() * 10 * 24 * 60 * 60 * 1000);\n        paidAt = paymentDate.toISOString();\n        transactionId = `TXN${Math.random().toString(36).substr(2, 9).toUpperCase()}`;\n        reference = `REF${member.number}${format(periodStart, \"yyyyMM\")}`;\n      } else if (isOverdue && Math.random() > 0.5) {\n        status = \"OVERDUE\";\n      }\n      \n      const notes = Math.random() > 0.8 ? [\n        \"Automatische incasso gefaald - handmatig opvolgen\",\n        \"Betaling ontvangen via contant tijdens event\",\n        \"Lidgeld voor gastlezingen inbegrepen\",\n        \"Korting toegepast wegens financiële situatie\"\n      ][Math.floor(Math.random() * 4)] : undefined;\n      \n      const fee: Fee = {\n        id: feeId.toString(),\n        memberId: member.id,\n        memberNumber: member.number,\n        memberLastName: member.lastName,\n        memberFirstName: member.firstName,\n        memberEmail: member.email,\n        memberPhone: member.phone,\n        periodStart: periodStart.toISOString(),\n        periodEnd: periodEnd.toISOString(),\n        dueDate: dueDate.toISOString(),\n        category: memberCategory,\n        amount: amount,\n        method: method,\n        status: status,\n        paidAt: paidAt,\n        transactionId: transactionId,\n        reference: reference,\n        notes: notes,\n        hasMandate: method === \"SEPA\" ? Math.random() > 0.2 : false, // 80% have mandate for SEPA\n        sepaBatchRef: status === \"PAID\" && method === \"SEPA\" && Math.random() > 0.5 ? `SEPA-${format(new Date(paidAt!), \"yyyy-MM\")}-${String(Math.floor(Math.random() * 999) + 1).padStart(3, \"0\")}` : undefined,\n      };\n      \n      fees.push(fee);\n      feeId++;\n      currentDate = addMonths(currentDate, 1);\n    }\n  });\n  \n  return fees;\n}\n\n// Helper functions\nexport function filterFees(fees: Fee[], filters: any): Fee[] {\n  return fees.filter(fee => {\n    // Search filter\n    if (filters.search) {\n      const searchTerm = filters.search.toLowerCase();\n      const searchMatch = \n        fee.memberNumber.toLowerCase().includes(searchTerm) ||\n        `${fee.memberFirstName} ${fee.memberLastName}`.toLowerCase().includes(searchTerm) ||\n        fee.periodStart.includes(searchTerm) ||\n        fee.periodEnd.includes(searchTerm);\n      if (!searchMatch) return false;\n    }\n    \n    // Status filter\n    if (filters.status && filters.status !== \"all\") {\n      if (fee.status !== filters.status) return false;\n    }\n    \n    // Year filter\n    if (filters.year && filters.year !== \"all\") {\n      const feeYear = new Date(fee.periodStart).getFullYear().toString();\n      if (feeYear !== filters.year) return false;\n    }\n    \n    // Method filter\n    if (filters.method && filters.method !== \"all\") {\n      if (fee.method !== filters.method) return false;\n    }\n    \n    // Period filter\n    if (filters.periodFrom) {\n      if (new Date(fee.periodStart) < new Date(filters.periodFrom)) return false;\n    }\n    if (filters.periodTo) {\n      if (new Date(fee.periodEnd) > new Date(filters.periodTo)) return false;\n    }\n    \n    // Amount filters\n    if (filters.amountMin !== undefined && fee.amount < filters.amountMin) return false;\n    if (filters.amountMax !== undefined && fee.amount > filters.amountMax) return false;\n    \n    // Only with mandate\n    if (filters.onlyWithMandate && !fee.hasMandate) return false;\n    \n    // Only overdue\n    if (filters.onlyOverdue && fee.status !== \"OVERDUE\") return false;\n    \n    return true;\n  });\n}\n\nexport function sortFees(fees: Fee[], sortBy: string, sortOrder: \"asc\" | \"desc\"): Fee[] {\n  return [...fees].sort((a, b) => {\n    let aValue: any = a[sortBy as keyof Fee];\n    let bValue: any = b[sortBy as keyof Fee];\n    \n    // Handle special cases\n    if (sortBy === \"memberName\") {\n      aValue = `${a.memberFirstName} ${a.memberLastName}`;\n      bValue = `${b.memberFirstName} ${b.memberLastName}`;\n    }\n    \n    if (typeof aValue === \"string\" && typeof bValue === \"string\") {\n      const result = aValue.localeCompare(bValue);\n      return sortOrder === \"asc\" ? result : -result;\n    }\n    \n    if (typeof aValue === \"number\" && typeof bValue === \"number\") {\n      const result = aValue - bValue;\n      return sortOrder === \"asc\" ? result : -result;\n    }\n    \n    return 0;\n  });\n}\n\nexport function paginateFees(fees: Fee[], page: number, perPage: number) {\n  const start = (page - 1) * perPage;\n  const end = start + perPage;\n  return {\n    data: fees.slice(start, end),\n    total: fees.length,\n    hasMore: end < fees.length,\n  };\n}\n\nexport function markPaid(fee: Fee, paidDate: string): Fee {\n  return {\n    ...fee,\n    status: \"PAID\" as FeeStatus,\n    paidAt: paidDate,\n  };\n}\n\nexport function generateSepaXml(fees: Fee[], batchRef: string): string {\n  const totalAmount = fees.reduce((sum, fee) => sum + fee.amount, 0);\n  const numTx = fees.length;\n  \n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<Document xmlns=\"urn:iso:std:iso:20022:tech:xsd:pain.008.001.02\">\n  <CstmrDrctDbtInitn>\n    <GrpHdr>\n      <MsgId>${batchRef}</MsgId>\n      <CreDtTm>${new Date().toISOString()}</CreDtTm>\n      <NbOfTxs>${numTx}</NbOfTxs>\n      <CtrlSum>${totalAmount.toFixed(2)}</CtrlSum>\n    </GrpHdr>\n    <PmtInf>\n      <PmtInfId>${batchRef}-001</PmtInfId>\n      <PmtMtd>DD</PmtMtd>\n      <NbOfTxs>${numTx}</NbOfTxs>\n      <CtrlSum>${totalAmount.toFixed(2)}</CtrlSum>\n      <!-- Transaction details would go here -->\n    </PmtInf>\n  </CstmrDrctDbtInitn>\n</Document>`;\n}\n\n// CSV parsing (mock)\nexport function parseCsv(csvContent: string): any[] {\n  const lines = csvContent.split(\"\\n\");\n  const headers = lines[0].split(\",\");\n  \n  return lines.slice(1).map(line => {\n    const values = line.split(\",\");\n    const obj: any = {};\n    headers.forEach((header, index) => {\n      obj[header.trim()] = values[index]?.trim();\n    });\n    return obj;\n  });\n}\n\n// MT940 parsing (mock)\nexport function parseMt940(content: string): any[] {\n  // Mock MT940 parser - in reality this would be much more complex\n  const transactions = [];\n  const lines = content.split(\"\\n\");\n  \n  let currentTransaction: any = {};\n  \n  for (const line of lines) {\n    if (line.startsWith(\":61:\")) {\n      // Transaction line\n      const parts = line.split(\":\");\n      currentTransaction = {\n        date: new Date().toISOString(),\n        amount: parseFloat(parts[2]?.replace(/[^0-9.]/g, \"\") || \"0\"),\n        description: parts[3] || \"\",\n      };\n    } else if (line.startsWith(\":86:\")) {\n      // Additional info\n      currentTransaction.description += \" \" + line.substring(4);\n      transactions.push(currentTransaction);\n      currentTransaction = {};\n    }\n  }\n  \n  return transactions;\n}\n\n// Guess matches for imported transactions\nexport function guessMatches(transactions: any[], fees: Fee[]): any[] {\n  return transactions.map(transaction => {\n    let bestMatch = null;\n    let confidence = \"unknown\";\n    \n    // Try to match on member number in description\n    const memberNumberMatch = transaction.description?.match(/000\\d/);\n    if (memberNumberMatch) {\n      const memberNumber = memberNumberMatch[0];\n      const match = fees.find(fee => \n        fee.memberNumber === memberNumber && \n        fee.status === \"OPEN\" &&\n        Math.abs(fee.amount - transaction.amount) < 0.01\n      );\n      if (match) {\n        bestMatch = match;\n        confidence = \"certain\";\n      }\n    }\n    \n    // Try to match on amount and date\n    if (!bestMatch) {\n      const amountMatches = fees.filter(fee => \n        Math.abs(fee.amount - transaction.amount) < 0.01 && \n        fee.status === \"OPEN\"\n      );\n      if (amountMatches.length === 1) {\n        bestMatch = amountMatches[0];\n        confidence = \"possible\";\n      }\n    }\n    \n    return {\n      transaction,\n      match: bestMatch,\n      confidence,\n    };\n  });\n}","size_bytes":10729},"lib/mock/fees-store.ts":{"content":"/**\n * Mock fee store for development\n */\n\nimport { NewFeeFormData } from \"../zod-fee\";\n\n// Mock function to create a fee\nexport function createFee(feeData: NewFeeFormData): Promise<any> {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve({\n        id: `fee_${Date.now()}`,\n        ...feeData,\n        status: 'OPEN',\n        createdAt: new Date().toISOString(),\n      });\n    }, 500);\n  });\n}\n\n// Mock function to mark fee as paid\nexport function markPaid(feeId: string): Promise<any> {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve({\n        id: feeId,\n        status: 'PAID',\n        paidAt: new Date().toISOString(),\n      });\n    }, 300);\n  });\n}\n\n// Mock function to get fees\nexport function getFees(): Promise<any[]> {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve([\n        {\n          id: 'fee_1',\n          memberNumber: 'M001',\n          memberName: 'Jan Janssens',\n          amount: '25.00',\n          term: 'MONTHLY',\n          status: 'OPEN',\n          method: 'SEPA',\n          periodStart: '2024-01-01T00:00:00.000Z',\n          periodEnd: '2024-01-31T23:59:59.999Z',\n          createdAt: '2024-01-01T00:00:00.000Z',\n        }\n      ]);\n    }, 300);\n  });\n}\n\n/**\n * Check if two date periods overlap\n */\nexport function overlaps(\n  start1: Date | string, \n  end1: Date | string, \n  start2: Date | string, \n  end2: Date | string\n): boolean {\n  const s1 = typeof start1 === 'string' ? new Date(start1) : start1;\n  const e1 = typeof end1 === 'string' ? new Date(end1) : end1;\n  const s2 = typeof start2 === 'string' ? new Date(start2) : start2;\n  const e2 = typeof end2 === 'string' ? new Date(end2) : end2;\n  \n  return s1 <= e2 && s2 <= e1;\n}","size_bytes":1732},"lib/mock/members-lite.ts":{"content":"/**\n * Mock members data for development\n */\n\nexport interface MemberLite {\n  id: string;\n  memberNumber: string;\n  firstName: string;\n  lastName: string;\n  category: 'STUDENT' | 'STANDAARD' | 'SENIOR';\n  active: boolean;\n}\n\n// Mock members data\nexport const membersLite: MemberLite[] = [\n  {\n    id: 'member_1',\n    memberNumber: 'M001',\n    firstName: 'Jan',\n    lastName: 'Janssens',\n    category: 'STANDAARD',\n    active: true,\n  },\n  {\n    id: 'member_2', \n    memberNumber: 'M002',\n    firstName: 'Marie',\n    lastName: 'Peeters',\n    category: 'STANDAARD',\n    active: true,\n  },\n  {\n    id: 'member_3',\n    memberNumber: 'M003', \n    firstName: 'Ahmed',\n    lastName: 'Hassan',\n    category: 'STUDENT',\n    active: true,\n  },\n  {\n    id: 'member_4',\n    memberNumber: 'M004',\n    firstName: 'Fatima',\n    lastName: 'Al-Zahra',\n    category: 'SENIOR', \n    active: true,\n  },\n  {\n    id: 'member_5',\n    memberNumber: 'M005',\n    firstName: 'Mohamed',\n    lastName: 'El-Mansouri',\n    category: 'STANDAARD',\n    active: false,\n  }\n];\n\n// Helper function to get active members\nexport function getActiveMembers(): MemberLite[] {\n  return membersLite.filter(member => member.active);\n}\n\n// Helper function to get member by ID\nexport function getMemberById(id: string): MemberLite | undefined {\n  return membersLite.find(member => member.id === id);\n}\n\n// Helper function to get member by number\nexport function getMemberByNumber(memberNumber: string): MemberLite | undefined {\n  return membersLite.find(member => member.memberNumber === memberNumber);\n}","size_bytes":1557},"lib/period.ts":{"content":"/**\n * Period calculation utilities and format functions\n */\n\nimport { format, parseISO } from 'date-fns';\nimport { nl } from 'date-fns/locale';\n\n/**\n * Calculate the end date for a given period\n */\nexport function calculateEndDate(startDate: Date, term: 'MONTHLY' | 'YEARLY'): Date {\n  const endDate = new Date(startDate);\n  \n  if (term === 'MONTHLY') {\n    endDate.setMonth(endDate.getMonth() + 1);\n  } else {\n    endDate.setFullYear(endDate.getFullYear() + 1);\n  }\n  \n  // Subtract 1 day to get the last day of the period\n  endDate.setDate(endDate.getDate() - 1);\n  \n  return endDate;\n}\n\n/**\n * Convert date to ISO string format for database storage\n */\nexport function toISO(date: Date): string {\n  return date.toISOString();\n}\n\n/**\n * Convert ISO string to Date object\n */\nexport function fromISO(isoString: string): Date {\n  return new Date(isoString);\n}\n\n/**\n * Get the current period for a given anchor date and term\n */\nexport function getCurrentPeriod(anchorDate: Date, term: 'MONTHLY' | 'YEARLY', asOfDate?: Date): { start: Date; end: Date } {\n  const asOf = asOfDate || new Date();\n  const start = new Date(anchorDate);\n  \n  // Find the current period by advancing from the anchor\n  while (calculateEndDate(start, term) < asOf) {\n    if (term === 'MONTHLY') {\n      start.setMonth(start.getMonth() + 1);\n    } else {\n      start.setFullYear(start.getFullYear() + 1);\n    }\n  }\n  \n  return {\n    start,\n    end: calculateEndDate(start, term)\n  };\n}\n\n/**\n * Format a date to Belgian format (dd-mm-jjjj)\n */\nexport function formatDateBE(date: string | Date): string {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date;\n  return format(dateObj, 'dd-MM-yyyy', { locale: nl });\n}\n\n/**\n * Format currency to Belgian format (€ 1.234,56)\n */\nexport function formatCurrencyBE(amount: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    style: 'currency',\n    currency: 'EUR',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\n/**\n * Input mask for Euro amounts\n */\nexport function euroInputMask(value: string): string {\n  // Remove all non-digit characters except comma and period\n  const cleaned = value.replace(/[^\\d,.-]/g, '');\n  \n  // Convert to standard number format\n  const standardized = cleaned.replace(',', '.');\n  \n  // Parse as float and format back\n  const num = parseFloat(standardized);\n  if (isNaN(num)) return '';\n  \n  return num.toFixed(2).replace('.', ',');\n}\n\n/**\n * Parse Euro input to number\n */\nexport function parseEuroInput(value: string): number {\n  if (!value) return 0;\n  \n  // Remove currency symbols and spaces\n  const cleaned = value.replace(/[€\\s]/g, '');\n  \n  // Replace comma with period for parsing\n  const standardized = cleaned.replace(',', '.');\n  \n  const num = parseFloat(standardized);\n  return isNaN(num) ? 0 : num;\n}","size_bytes":2828},"lib/zod-fee.ts":{"content":"import { z } from \"zod\";\n\n// Fee validation schema\nexport const NewFeeSchema = z.object({\n  memberId: z.string().optional(),\n  memberNumber: z.string().optional(),\n  term: z.enum(['MONTHLY', 'YEARLY']),\n  method: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']),\n  amount: z.number().min(0, \"Amount must be greater than or equal to 0\"),\n  periodStart: z.string().optional(),\n  periodEnd: z.string().optional(), \n  iban: z.string().optional(),\n  note: z.string().optional(),\n  autoCreate: z.boolean().default(false),\n});\n\nexport type NewFeeFormData = z.infer<typeof NewFeeSchema>;\n\n// Fee update schema\nexport const UpdateFeeSchema = z.object({\n  amount: z.number().min(0).optional(),\n  method: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']).optional(),\n  status: z.enum(['OPEN', 'PAID', 'OVERDUE']).optional(),\n  note: z.string().optional(),\n});\n\nexport type UpdateFeeFormData = z.infer<typeof UpdateFeeSchema>;","size_bytes":929},"shared/fees-schema.ts":{"content":"import { z } from \"zod\";\n\nexport const feeStatusSchema = z.enum(['OPEN', 'PAID', 'OVERDUE']);\nexport const paymentMethodSchema = z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']);\n\nexport const feeSchema = z.object({\n  id: z.string(),\n  memberId: z.string(),\n  memberNumber: z.string(),\n  memberLastName: z.string(),\n  memberFirstName: z.string(),\n  memberEmail: z.string(),\n  memberPhone: z.string(),\n  periodStart: z.string(),\n  periodEnd: z.string(),\n  amount: z.number(),\n  dueDate: z.string(),\n  category: z.string(),\n  method: paymentMethodSchema,\n  status: feeStatusSchema,\n  paidAt: z.string().optional(),\n  transactionId: z.string().optional(),\n  reference: z.string().optional(),\n  notes: z.string().optional(),\n  hasMandate: z.boolean().optional(),\n  sepaBatchRef: z.string().optional(),\n});\n\nexport const importFileSchema = z.object({\n  type: z.enum(['CSV', 'MT940', 'CODA']),\n  file: z.instanceof(File),\n});\n\nexport const filterSchema = z.object({\n  search: z.string(),\n  status: z.string(),\n  year: z.string(),\n  method: z.string(),\n  periodFrom: z.string().optional(),\n  periodTo: z.string().optional(),\n  categories: z.array(z.string()),\n  amountMin: z.number().optional(),\n  amountMax: z.number().optional(),\n  paidFrom: z.string().optional(),\n  paidTo: z.string().optional(),\n  onlyWithMandate: z.boolean(),\n  onlyOverdue: z.boolean(),\n});\n\nexport type FeeStatus = z.infer<typeof feeStatusSchema>;\nexport type PaymentMethod = z.infer<typeof paymentMethodSchema>;\nexport type Fee = z.infer<typeof feeSchema>;\nexport type ImportFile = z.infer<typeof importFileSchema>;\nexport type FilterValues = z.infer<typeof filterSchema>;","size_bytes":1648},"client/src/components/fees/new-fee-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { Plus, User, Calendar, CreditCard, Settings } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Form } from \"@/components/ui/form\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { SectionCard } from \"@/components/ui/section-card\";\nimport { MemberSelect } from \"./new/member-select\";\nimport { PeriodPicker } from \"./new/period-picker\";\nimport { MethodTerm } from \"./new/method-term\";\nimport { AmountInput } from \"./new/amount-input\";\nimport { PreviewCard } from \"./new/preview-card\";\nimport { ConfirmDialog } from \"./new/confirm-dialog\";\nimport { NewFeeSchema, type NewFeeFormData } from \"../../../../lib/zod-fee\";\nimport { calculateEndDate, toISO } from \"../../../../lib/period\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface NewFeeDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onSuccess?: () => void;\n}\n\nexport function NewFeeDialog({ open, onOpenChange, onSuccess }: NewFeeDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [showConfirmDialog, setShowConfirmDialog] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [activeTab, setActiveTab] = useState(\"member\");\n\n  // Fetch members for dropdown\n  const { data: members = [] } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n\n  const form = useForm<NewFeeFormData>({\n    resolver: zodResolver(NewFeeSchema),\n    defaultValues: {\n      term: 'YEARLY',\n      method: 'SEPA',\n      amount: 0,\n      iban: '',\n      note: '',\n      autoCreate: false,\n      periodStart: new Date().toISOString().split('T')[0],\n      periodEnd: new Date(Date.now() + 365*24*60*60*1000).toISOString().split('T')[0],\n    },\n  });\n\n  const { watch, setValue, handleSubmit, formState: { errors }, reset } = form;\n  const watchedValues = watch();\n\n  // Auto-calculate end date when start date or term changes\n  const handleStartDateChange = (date: Date) => {\n    setValue('periodStart', date.toISOString().split('T')[0]);\n    const endDate = calculateEndDate(date, watchedValues.term);\n    setValue('periodEnd', endDate.toISOString().split('T')[0]);\n  };\n\n  const handleTermChange = (term: 'MONTHLY' | 'YEARLY') => {\n    setValue('term', term);\n    if (watchedValues.periodStart) {\n      const startDate = new Date(watchedValues.periodStart);\n      const endDate = calculateEndDate(startDate, term);\n      setValue('periodEnd', endDate.toISOString().split('T')[0]);\n    }\n  };\n\n  // Create fee mutation\n  const createFeeMutation = useMutation({\n    mutationFn: async (data: NewFeeFormData) => {\n      const member = Array.isArray(members) ? members.find((m: any) => m.id === data.memberId) : null;\n      if (!member) {\n        throw new Error(\"Lid niet gevonden\");\n      }\n\n      const feeData = {\n        memberId: data.memberId,\n        memberNumber: member.memberNumber,\n        memberName: `${member.firstName} ${member.lastName}`,\n        periodStart: new Date(data.periodStart!),\n        periodEnd: new Date(data.periodEnd!),\n        amount: data.amount,\n        method: data.method,\n        sepaEligible: data.method === 'SEPA',\n        note: data.note || null,\n        status: 'OPEN'\n      };\n\n      const response = await apiRequest(\"POST\", \"/api/fees\", feeData);\n      return response.json();\n    },\n    onSuccess: async (fee, variables) => {\n      // Optimistic update - voeg fee toe aan lijst\n      queryClient.setQueryData([\"/api/fees\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return [fee];\n        return [fee, ...oldData];\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/fees\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Lidgeld aangemaakt\",\n        description: \"Het lidgeld is succesvol aangemaakt.\",\n      });\n      reset();\n      onOpenChange(false);\n      setShowConfirmDialog(false);\n      onSuccess?.();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij aanmaken\",\n        description: error.message || \"Er is een fout opgetreden bij het aanmaken van het lidgeld.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = async (data: NewFeeFormData) => {\n    try {\n      setIsSubmitting(true);\n      createFeeMutation.mutate(data);\n    } catch (error) {\n      console.error('Error submitting fee:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleConfirm = async (markAsPaid?: boolean, paidDate?: Date) => {\n    try {\n      setIsSubmitting(true);\n      \n      const formData = form.getValues();\n      await onSubmit(formData);\n      \n      // For now, we create the fee as open and let the user mark it as paid separately\n      // Future enhancement: integrate direct payment marking\n      \n      setShowConfirmDialog(false);\n      reset();\n      onOpenChange(false);\n      if (onSuccess) onSuccess();\n      \n    } catch (error) {\n      // Error is already handled in onSubmit\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const validateAndShowConfirm = () => {\n    form.handleSubmit(() => {\n      setShowConfirmDialog(true);\n    })();\n  };\n\n  const handleDialogClose = (open: boolean) => {\n    if (!open) {\n      reset();\n    }\n    onOpenChange(open);\n  };\n\n  return (\n    <>\n      <Dialog open={open} onOpenChange={handleDialogClose}>\n        <DialogContent className=\"max-w-7xl max-h-[95vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Plus className=\"h-5 w-5\" />\n              Nieuw lidgeld\n            </DialogTitle>\n            <DialogDescription>\n              Maak een nieuw lidgeld aan voor een lid en periode\n            </DialogDescription>\n          </DialogHeader>\n\n          <Form {...form}>\n            <form onSubmit={(e) => e.preventDefault()}>\n              {/* Main Layout with Tabs */}\n              <div className=\"grid lg:grid-cols-[1fr,420px] gap-6\">\n                {/* Left Column - Form with Tabs */}\n                <div className=\"space-y-6\">\n                  <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n                    <TabsList className=\"grid w-full grid-cols-4\">\n                      <TabsTrigger value=\"member\" className=\"flex items-center gap-2\">\n                        <User className=\"h-4 w-4\" />\n                        Lid\n                      </TabsTrigger>\n                      <TabsTrigger value=\"period\" className=\"flex items-center gap-2\">\n                        <Calendar className=\"h-4 w-4\" />\n                        Periode\n                      </TabsTrigger>\n                      <TabsTrigger value=\"payment\" className=\"flex items-center gap-2\">\n                        <CreditCard className=\"h-4 w-4\" />\n                        Betaling\n                      </TabsTrigger>\n                      <TabsTrigger value=\"options\" className=\"flex items-center gap-2\">\n                        <Settings className=\"h-4 w-4\" />\n                        Opties\n                      </TabsTrigger>\n                    </TabsList>\n\n                    <div className=\"min-h-[400px] py-6\">\n                      <TabsContent value=\"member\" className=\"space-y-4 mt-0\">\n                        <SectionCard \n                          title=\"Lid\" \n                          description=\"Selecteer het lid voor dit lidgeld\"\n                        >\n                          <MemberSelect\n                            value={watchedValues.memberId}\n                            onChange={(memberId) => setValue('memberId', memberId)}\n                            error={errors.memberId?.message}\n                            members={Array.isArray(members) ? members : []}\n                          />\n                        </SectionCard>\n                      </TabsContent>\n\n                      <TabsContent value=\"period\" className=\"space-y-4 mt-0\">\n                        <SectionCard \n                          title=\"Termijn & Periode\" \n                          description=\"Kies de betalingstermijn en periode\"\n                        >\n                          <PeriodPicker\n                            term={watchedValues.term}\n                            onTermChange={handleTermChange}\n                            startDate={watchedValues.periodStart ? new Date(watchedValues.periodStart) : undefined}\n                            onStartDateChange={handleStartDateChange}\n                            endDate={watchedValues.periodEnd ? new Date(watchedValues.periodEnd) : undefined}\n                            onEndDateChange={(date) => setValue('periodEnd', date.toISOString().split('T')[0])}\n                            errors={{\n                              term: errors.term?.message,\n                              startDate: errors.periodStart?.message,\n                              endDate: errors.periodEnd?.message,\n                            }}\n                          />\n                        </SectionCard>\n                      </TabsContent>\n\n                      <TabsContent value=\"payment\" className=\"space-y-4 mt-0\">\n                        <SectionCard \n                          title=\"Methode & Bedrag\" \n                          description=\"Kies de betalingsmethode en bedrag\"\n                        >\n                          <div className=\"space-y-6\">\n                            <MethodTerm\n                              method={watchedValues.method}\n                              onMethodChange={(method) => setValue('method', method)}\n                              iban={watchedValues.iban}\n                              onIbanChange={(iban) => setValue('iban', iban)}\n                              errors={{\n                                method: errors.method?.message,\n                                iban: errors.iban?.message,\n                              }}\n                            />\n                            \n                            <AmountInput\n                              value={watchedValues.amount}\n                              onChange={(amount) => setValue('amount', amount)}\n                              error={errors.amount?.message}\n                            />\n                          </div>\n                        </SectionCard>\n                      </TabsContent>\n\n                      <TabsContent value=\"options\" className=\"space-y-4 mt-0\">\n                        <SectionCard \n                          title=\"Opties\" \n                          description=\"Aanvullende instellingen\"\n                        >\n                          <div className=\"space-y-4\">\n                            <div className=\"space-y-2\">\n                              <Label className=\"text-sm font-medium\">Notitie (optioneel)</Label>\n                              <Textarea\n                                value={watchedValues.note || ''}\n                                onChange={(e) => setValue('note', e.target.value)}\n                                placeholder=\"Voeg een notitie toe...\"\n                                className=\"min-h-[80px] border-gray-200\"\n                                maxLength={500}\n                              />\n                              <p className=\"text-xs text-gray-500\">\n                                Maximaal 500 karakters\n                              </p>\n                            </div>\n                          </div>\n                        </SectionCard>\n                      </TabsContent>\n                    </div>\n                  </Tabs>\n                </div>\n\n                {/* Right Column - Preview */}\n                <div className=\"space-y-6\">\n                  <PreviewCard\n                    memberId={watchedValues.memberId}\n                    term={watchedValues.term}\n                    method={watchedValues.method}\n                    startDate={watchedValues.periodStart ? new Date(watchedValues.periodStart) : undefined}\n                    endDate={watchedValues.periodEnd ? new Date(watchedValues.periodEnd) : undefined}\n                    amount={watchedValues.amount}\n                    iban={watchedValues.iban}\n                    note={watchedValues.note}\n                  />\n\n                  <div className=\"flex gap-2\">\n                    <Button \n                      variant=\"outline\"\n                      onClick={() => handleDialogClose(false)}\n                      className=\"flex-1\"\n                    >\n                      Annuleren\n                    </Button>\n                    <Button \n                      onClick={validateAndShowConfirm}\n                      className=\"flex-1\"\n                      data-testid=\"create-fee-button\"\n                    >\n                      Lidgeld aanmaken\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        open={showConfirmDialog}\n        onOpenChange={setShowConfirmDialog}\n        onConfirm={handleConfirm}\n        loading={isSubmitting}\n      />\n    </>\n  );\n}","size_bytes":13717},"README_rolling_fees.md":{"content":"# Rolling Period Membership Fees Implementation\n\nThis implementation provides a comprehensive rolling period membership fees system with no proration, anchored on member-specific billing dates in the Europe/Brussels timezone.\n\n## Overview\n\n### Rolling vs Calendar Periods\n\n**Rolling Periods**: Each member has their own billing cycle based on their individual billing anchor date (join date or manually set). Periods run exactly one month/year forward from the anchor.\n\n**Calendar Periods**: All members share the same billing periods (e.g., January 1-31, February 1-28/29).\n\nThis implementation uses **rolling periods** to ensure fair billing regardless of when a member joins.\n\n## Key Features\n\n- **No Proration**: Full fee amount regardless of join date within period\n- **Timezone-Aware**: All calculations in Europe/Brussels timezone with DST handling\n- **Idempotent**: Re-running fee generation doesn't create duplicates\n- **Catch-up Support**: Can backfill missing fees for any date range\n- **Contiguous Periods**: Periods are seamless with no gaps or overlaps\n\n## Architecture\n\n### Core Components\n\n1. **lib/server/time.ts**: Brussels timezone utilities\n2. **lib/server/fees/periods.ts**: Rolling period mathematics\n3. **lib/server/fees/anchor.ts**: Billing anchor management\n4. **lib/server/fees/generator.ts**: Fee generation logic\n5. **lib/server/fees/first-fee.ts**: First fee creation for new members\n\n### Database Schema\n\n```sql\n-- Extended member financial settings\nALTER TABLE member_financial_settings \nADD COLUMN billing_anchor_at TIMESTAMP,\nADD COLUMN monthly_amount DECIMAL(10,2) DEFAULT 0,\nADD COLUMN yearly_amount DECIMAL(10,2) DEFAULT 0;\n\n-- Enhanced membership fees with unique constraint\nALTER TABLE membership_fees \nADD UNIQUE (tenant_id, member_id, period_start, period_end);\n```\n\n## API Endpoints\n\n### Fee Generation Job\n```http\nPOST /api/jobs/fees/generate\nAuthorization: Bearer <token>\nContent-Type: application/json\n\n{\n  \"tenantId\": \"optional-tenant-id\",\n  \"asOf\": \"2025-06-01T10:00:00Z\",\n  \"strategy\": \"current\" | \"catchup\"\n}\n```\n\n### Enhanced Member Creation\n```http\nPOST /api/members/create\nAuthorization: Bearer <token>\nContent-Type: application/json\n\n{\n  \"memberNumber\": \"M001\",\n  \"firstName\": \"John\",\n  \"lastName\": \"Doe\",\n  \"joinDate\": \"2025-01-15T10:00:00Z\",\n  \"preferredTerm\": \"MONTHLY\",\n  \"monthlyAmount\": 25.00,\n  \"yearlyAmount\": 300.00,\n  // ... other member fields\n}\n```\n\n## Usage Examples\n\n### 1. Creating a New Member with Rolling Fees\n\n```typescript\nimport { createFirstFeeForMember } from './lib/server/fees/first-fee';\n\n// Member joins mid-month - gets full month period\nconst memberId = await createMember({\n  joinDate: new Date('2025-01-15T10:00:00Z'),\n  preferredTerm: 'MONTHLY',\n  monthlyAmount: 25.00\n});\n\n// Creates billing anchor at join date and first fee\nawait createFirstFeeForMember(memberId);\n```\n\n### 2. Running Fee Generation Jobs\n\n```typescript\nimport { generateTenantFees } from './lib/server/fees/generator';\n\n// Generate current period fees for all active members\nawait generateTenantFees('tenant-123', new Date(), 'current');\n\n// Catch up any missing fees from the past\nawait generateTenantFees('tenant-123', new Date(), 'catchup');\n```\n\n### 3. Manual Fee Calculations\n\n```typescript\nimport { rollingMonthly, rollingYearly } from './lib/server/fees/periods';\n\nconst anchor = new Date('2025-01-31T10:00:00Z');\nconst asOf = new Date('2025-06-01T12:00:00Z');\n\n// Calculate current monthly period\nconst monthlyPeriod = rollingMonthly(anchor, asOf);\n// Result: May 31 10:00 - June 30 09:59:59.999\n\n// Calculate current yearly period  \nconst yearlyPeriod = rollingYearly(anchor, asOf);\n// Result: Jan 31 2025 10:00 - Jan 30 2026 09:59:59.999\n```\n\n## CRON Job Examples\n\n### Daily Fee Generation\n```bash\n# Generate current period fees daily at 2 AM\n0 2 * * * curl -X POST \"https://your-app.com/api/jobs/fees/generate\" \\\n  -H \"Authorization: Bearer $API_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"strategy\": \"current\"}'\n```\n\n### Weekly Catch-up\n```bash\n# Weekly catch-up for any missed fees (Sundays at 3 AM)\n0 3 * * 0 curl -X POST \"https://your-app.com/api/jobs/fees/generate\" \\\n  -H \"Authorization: Bearer $API_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"strategy\": \"catchup\"}'\n```\n\n## Testing\n\nRun the comprehensive test suite:\n\n```bash\nnpm test tests/fees/\n```\n\n### Test Coverage\n\n- **Period Mathematics**: Month/year arithmetic with clamping\n- **DST Transitions**: Timezone handling across daylight saving changes\n- **Edge Cases**: Leap years, month overflow, future anchors\n- **Idempotency**: Multiple generation runs don't create duplicates\n- **Error Handling**: Graceful failures for individual members\n\n## Migration Guide\n\n### From Calendar to Rolling Periods\n\n1. **Backup**: Always backup your database before migration\n2. **Schema Update**: Run database migrations for new fields\n3. **Set Anchors**: Initialize billing anchors for existing members\n4. **Generate**: Run catch-up fee generation\n5. **Verify**: Check periods and amounts are correct\n\n```typescript\n// Example migration script\nasync function migrateToRollingPeriods() {\n  const members = await getAllActiveMembers();\n  \n  for (const member of members) {\n    // Set billing anchor to join date or first payment\n    const anchor = member.joinDate || member.firstPaymentDate || new Date();\n    await setBillingAnchor(member.id, anchor);\n    \n    // Generate missing fees\n    await backfillRollingFeesForMember(member.id, anchor, new Date());\n  }\n}\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Duplicate Fees**: Check unique constraint on `(tenant_id, member_id, period_start, period_end)`\n2. **Timezone Misalignment**: Verify all dates are in UTC storage with Brussels calculations\n3. **Missing Anchors**: Ensure all members have billing anchors set\n4. **Zero Amounts**: Members with zero fee amounts are skipped automatically\n\n### Debugging Tools\n\n```typescript\n// Check member's billing anchor and current period\nimport { getBillingAnchor } from './lib/server/fees/anchor';\nimport { getRollingPeriod } from './lib/server/fees/periods';\n\nconst anchor = await getBillingAnchor(memberId);\nconst currentPeriod = getRollingPeriod(anchor, new Date(), 'MONTHLY');\nconsole.log({ anchor, currentPeriod });\n```\n\n## Performance Considerations\n\n- **Batch Processing**: Fee generation processes all members in a tenant\n- **Error Isolation**: Individual member failures don't stop batch processing\n- **Idempotent Operations**: Safe to re-run generation jobs\n- **Database Constraints**: Unique constraints prevent duplicate fees\n\n## Security\n\n- **API Authorization**: All endpoints require valid Bearer tokens\n- **Tenant Isolation**: Operations are scoped to specific tenants\n- **Input Validation**: All inputs validated with Zod schemas\n- **Error Handling**: Detailed errors logged, generic responses to clients","size_bytes":6857},"client/src/components/finance/Charts.tsx":{"content":"\"use client\";\n\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { formatCurrencyBE, formatMonthYearBE } from \"@/lib/format\";\nimport { getMonthlyTotals, getCategoryTotals } from \"@/lib/mock/transactions\";\nimport { \n  LineChart, \n  Line, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n  Legend\n} from \"recharts\";\nimport { useMemo } from \"react\";\n\nconst COLORS = [\n  '#3B82F6', // blue\n  '#EF4444', // red\n  '#F59E0B', // amber\n  '#10B981', // emerald\n  '#8B5CF6', // violet\n  '#F97316', // orange\n  '#06B6D4', // cyan\n  '#84CC16', // lime\n];\n\nexport function Charts() {\n  const monthlyData = useMemo(() => {\n    const data = getMonthlyTotals();\n    return data.map(item => ({\n      ...item,\n      monthLabel: formatMonthYearBE(`${item.month}-01`)\n    }));\n  }, []);\n\n  const expenseCategories = useMemo(() => {\n    return getCategoryTotals('EXPENSE').map((item, index) => ({\n      ...item,\n      fill: COLORS[index % COLORS.length]\n    }));\n  }, []);\n\n  const CustomTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg\">\n          <p className=\"font-medium mb-2\">{label}</p>\n          {payload.map((entry: any, index: number) => (\n            <div key={index} className=\"flex items-center gap-2\">\n              <div \n                className=\"w-3 h-3 rounded-full\" \n                style={{ backgroundColor: entry.color }}\n              />\n              <span className=\"text-sm\">\n                {entry.name}: {formatCurrencyBE(entry.value)}\n              </span>\n            </div>\n          ))}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  const PieTooltip = ({ active, payload }: any) => {\n    if (active && payload && payload.length) {\n      const data = payload[0];\n      return (\n        <div className=\"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg\">\n          <p className=\"font-medium\">{data.payload.category}</p>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            {formatCurrencyBE(data.value)}\n          </p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n      {/* Line Chart - Income vs Expenses */}\n      <Card className=\"col-span-1 glass-card card-hover animate-fade-in group\">\n        <CardHeader>\n          <CardTitle className=\"group-hover:text-primary transition-colors duration-300\">Inkomsten vs Uitgaven</CardTitle>\n          <CardDescription>\n            Maandelijkse ontwikkeling van financiële stromen\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <LineChart data={monthlyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"opacity-30\" />\n                <XAxis \n                  dataKey=\"monthLabel\" \n                  fontSize={12}\n                  tickMargin={8}\n                />\n                <YAxis \n                  fontSize={12}\n                  tickMargin={8}\n                  tickFormatter={(value) => `€${(value / 1000).toFixed(0)}k`}\n                />\n                <Tooltip content={<CustomTooltip />} />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"income\" \n                  stroke=\"#10B981\" \n                  strokeWidth={3}\n                  name=\"Inkomsten\"\n                  dot={{ fill: '#10B981', strokeWidth: 2, r: 4 }}\n                  activeDot={{ r: 6, stroke: '#10B981', strokeWidth: 2 }}\n                />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"expense\" \n                  stroke=\"#EF4444\" \n                  strokeWidth={3}\n                  name=\"Uitgaven\"\n                  dot={{ fill: '#EF4444', strokeWidth: 2, r: 4 }}\n                  activeDot={{ r: 6, stroke: '#EF4444', strokeWidth: 2 }}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Pie Chart - Expense Categories */}\n      <Card className=\"col-span-1 glass-card card-hover animate-fade-in group\">\n        <CardHeader>\n          <CardTitle className=\"group-hover:text-primary transition-colors duration-300\">Uitgaven per Categorie</CardTitle>\n          <CardDescription>\n            Verdeling van uitgaven over verschillende categorieën\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <PieChart>\n                <Pie\n                  data={expenseCategories}\n                  cx=\"50%\"\n                  cy=\"50%\"\n                  labelLine={false}\n                  label={({ category, percent }) => \n                    `${category} (${(percent * 100).toFixed(0)}%)`\n                  }\n                  outerRadius={80}\n                  fill=\"#8884d8\"\n                  dataKey=\"amount\"\n                  className=\"text-xs\"\n                >\n                  {expenseCategories.map((entry, index) => (\n                    <Cell key={`cell-${index}`} fill={entry.fill} />\n                  ))}\n                </Pie>\n                <Tooltip content={<PieTooltip />} />\n              </PieChart>\n            </ResponsiveContainer>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":5664},"client/src/components/finance/DetailSlideOver.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle } from \"@/components/ui/sheet\";\nimport { StatusChip } from \"@/components/ui/StatusChip\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { Edit, Trash2, User, Calendar, Tag, CreditCard, FileText } from \"lucide-react\";\n\ninterface DetailSlideOverProps {\n  open: boolean;\n  onClose: () => void;\n  transaction: Transaction | null;\n  onEdit: (transaction: Transaction) => void;\n  onDelete: (transactionId: string) => void;\n}\n\nexport function DetailSlideOver({\n  open,\n  onClose,\n  transaction,\n  onEdit,\n  onDelete\n}: DetailSlideOverProps) {\n  if (!transaction) return null;\n\n  const handleEdit = () => {\n    onEdit(transaction);\n    onClose();\n  };\n\n  const handleDelete = () => {\n    onDelete(transaction.id);\n    onClose();\n  };\n\n  return (\n    <Sheet open={open} onOpenChange={onClose}>\n      <SheetContent className=\"w-[400px] sm:w-[540px]\">\n        <SheetHeader>\n          <SheetTitle className=\"flex items-center gap-3\">\n            <span className={transaction.type === 'INCOME' \n              ? 'text-green-600 dark:text-green-400' \n              : 'text-red-600 dark:text-red-400'\n            }>\n              {formatCurrencyBE(transaction.amount)}\n            </span>\n            <StatusChip type={transaction.type} />\n          </SheetTitle>\n          <SheetDescription>\n            Transactiedetails van {formatDateBE(transaction.date)}\n          </SheetDescription>\n        </SheetHeader>\n        \n        <div className=\"mt-6 space-y-6\">\n          {/* Basic Info */}\n          <div className=\"grid gap-4\">\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <Calendar className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Datum</div>\n                <div className=\"text-gray-600 dark:text-gray-400\">\n                  {formatDateBE(transaction.date)}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <Tag className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Categorie</div>\n                <div className=\"text-gray-600 dark:text-gray-400\">\n                  {transaction.category}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <CreditCard className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Betaalmethode</div>\n                <div className=\"pt-1\">\n                  <MethodChip method={transaction.method} />\n                </div>\n              </div>\n            </div>\n\n            {transaction.memberName && (\n              <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n                <User className=\"h-5 w-5 text-gray-500\" />\n                <div>\n                  <div className=\"text-sm font-medium\">Lid</div>\n                  <div className=\"text-blue-600 dark:text-blue-400\">\n                    {transaction.memberName}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {transaction.description && (\n              <div className=\"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n                <FileText className=\"h-5 w-5 text-gray-500 mt-0.5\" />\n                <div>\n                  <div className=\"text-sm font-medium\">Omschrijving</div>\n                  <div className=\"text-gray-600 dark:text-gray-400 mt-1\">\n                    {transaction.description}\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Amount Display */}\n          <div className=\"p-4 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg text-center\">\n            <div className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">\n              {transaction.type === 'INCOME' ? 'Ontvangen bedrag' : 'Uitgegeven bedrag'}\n            </div>\n            <div className={`text-3xl font-bold ${\n              transaction.type === 'INCOME' \n                ? 'text-green-600 dark:text-green-400' \n                : 'text-red-600 dark:text-red-400'\n            }`}>\n              {formatCurrencyBE(transaction.amount)}\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n            <Button \n              onClick={handleEdit} \n              className=\"flex-1 gap-2\"\n              data-testid=\"button-edit-transaction\"\n            >\n              <Edit className=\"h-4 w-4\" />\n              Bewerken\n            </Button>\n            <Button \n              variant=\"outline\" \n              onClick={handleDelete}\n              className=\"flex-1 gap-2 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800 hover:bg-red-50 dark:hover:bg-red-900/10\"\n              data-testid=\"button-delete-transaction\"\n            >\n              <Trash2 className=\"h-4 w-4\" />\n              Verwijderen\n            </Button>\n          </div>\n        </div>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":5534},"client/src/components/finance/ExportDialog.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { exportToCSV } from \"@/lib/csv\";\nimport { FileText, FileSpreadsheet, FileImage } from \"lucide-react\";\nimport { CiExport } from \"react-icons/ci\";\n\ninterface ExportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  transactions: Transaction[];\n}\n\ntype ExportFormat = 'csv' | 'excel' | 'pdf';\n\nexport function ExportDialog({ open, onClose, transactions }: ExportDialogProps) {\n  const [format, setFormat] = useState<ExportFormat>('csv');\n  const [loading, setLoading] = useState(false);\n\n  const handleExport = async () => {\n    setLoading(true);\n    \n    try {\n      const exportData = transactions.map(t => ({\n        Datum: formatDateBE(t.date),\n        Type: t.type === 'INCOME' ? 'Inkomsten' : 'Uitgaven',\n        Categorie: t.category,\n        Lid: t.memberName || '',\n        Bedrag: t.amount,\n        'Bedrag (geformatteerd)': formatCurrencyBE(t.amount),\n        Methode: t.method,\n        Omschrijving: t.description || ''\n      }));\n\n      if (format === 'csv') {\n        exportToCSV(exportData, `transacties_${new Date().toISOString().split('T')[0]}.csv`);\n      } else if (format === 'excel') {\n        // Mock Excel export - in real app would use a library like xlsx\n        exportToCSV(exportData, `transacties_${new Date().toISOString().split('T')[0]}.xlsx`);\n        alert('Excel export is een mock implementatie. In productie zou dit een echte Excel file genereren.');\n      } else if (format === 'pdf') {\n        // Mock PDF export - in real app would use a library like jsPDF\n        alert('PDF export is een mock implementatie. In productie zou dit een echte PDF genereren.');\n      }\n      \n      onClose();\n    } catch (error) {\n      alert('Fout bij het exporteren van gegevens');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatOptions = [\n    {\n      value: 'csv',\n      label: 'CSV',\n      description: 'Comma-separated values, compatible met Excel',\n      icon: FileText,\n      recommended: true\n    },\n    {\n      value: 'excel',\n      label: 'Excel',\n      description: 'Microsoft Excel spreadsheet (.xlsx)',\n      icon: FileSpreadsheet,\n      recommended: false\n    },\n    {\n      value: 'pdf',\n      label: 'PDF',\n      description: 'Portable Document Format voor rapporten',\n      icon: FileImage,\n      recommended: false\n    }\n  ];\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle>Transacties exporteren</DialogTitle>\n          <DialogDescription>\n            Exporteer {transactions.length} transacties naar het gewenste formaat\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"py-6\">\n          <div className=\"space-y-4\">\n            <Label className=\"text-base font-medium\">Selecteer export formaat:</Label>\n            \n            <RadioGroup value={format} onValueChange={(value) => setFormat(value as ExportFormat)}>\n              {formatOptions.map((option) => {\n                const Icon = option.icon;\n                return (\n                  <div key={option.value} className=\"flex items-center space-x-3\">\n                    <RadioGroupItem value={option.value} id={option.value} />\n                    <Card className=\"flex-1 cursor-pointer\" onClick={() => setFormat(option.value as ExportFormat)}>\n                      <CardHeader className=\"pb-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            <Icon className=\"h-5 w-5\" />\n                            <CardTitle className=\"text-sm\">{option.label}</CardTitle>\n                            {option.recommended && (\n                              <span className=\"text-xs bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400 px-2 py-0.5 rounded-full\">\n                                Aanbevolen\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                        <CardDescription className=\"text-xs\">\n                          {option.description}\n                        </CardDescription>\n                      </CardHeader>\n                    </Card>\n                  </div>\n                );\n              })}\n            </RadioGroup>\n          </div>\n\n          {/* Export Summary */}\n          <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n            <h4 className=\"text-sm font-medium mb-2\">Export overzicht:</h4>\n            <div className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n              <div className=\"flex justify-between\">\n                <span>Aantal transacties:</span>\n                <span className=\"font-medium\">{transactions.length}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Formaat:</span>\n                <span className=\"font-medium\">{formatOptions.find(f => f.value === format)?.label}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Bestandsnaam:</span>\n                <span className=\"font-medium\">\n                  transacties_{new Date().toISOString().split('T')[0]}.{format === 'excel' ? 'xlsx' : format}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} data-testid=\"button-cancel-export\">\n            Annuleren\n          </Button>\n          <Button \n            onClick={handleExport} \n            disabled={loading}\n            className=\"gap-2\"\n            data-testid=\"button-start-export\"\n          >\n            <CiExport className=\"h-4 w-4\" />\n            {loading ? 'Exporteren...' : 'Exporteren'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":6470},"client/src/components/finance/FiltersDrawer.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { CalendarIcon } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { categories, mockMembers } from \"@/lib/mock/transactions\";\nimport { FilterData } from \"@/lib/zod/transaction\";\n\ninterface FiltersToolbarProps {\n  filters: FilterData;\n  onFiltersChange: (filters: FilterData) => void;\n  onClearFilters: () => void;\n  typeFilter?: string; // Type filter from main toolbar\n}\n\nexport function FiltersToolbar({\n  filters,\n  onFiltersChange,\n  onClearFilters,\n  typeFilter\n}: FiltersToolbarProps) {\n  const [fromDateInput, setFromDateInput] = useState(\"\");\n  const [toDateInput, setToDateInput] = useState(\"\");\n  const [fromPopoverOpen, setFromPopoverOpen] = useState(false);\n  const [toPopoverOpen, setToPopoverOpen] = useState(false);\n\n  const updateFilter = (key: keyof FilterData, value: any) => {\n    onFiltersChange({ ...filters, [key]: value });\n  };\n\n  const formatDateInput = (value: string) => {\n    const numbers = value.replace(/\\D/g, '');\n    if (numbers.length <= 2) {\n      return numbers;\n    } else if (numbers.length <= 4) {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2)}`;\n    } else {\n      return `${numbers.slice(0, 2)}/${numbers.slice(2, 4)}/${numbers.slice(4, 8)}`;\n    }\n  };\n\n  const parseDate = (dateString: string): Date | undefined => {\n    const cleanString = dateString.replace(/\\D/g, '');\n    if (cleanString.length === 8) {\n      const day = parseInt(cleanString.slice(0, 2));\n      const month = parseInt(cleanString.slice(2, 4)) - 1;\n      const year = parseInt(cleanString.slice(4, 8));\n      \n      const date = new Date(year, month, day);\n      if (date.getDate() === day && date.getMonth() === month && date.getFullYear() === year) {\n        return date;\n      }\n    }\n    return undefined;\n  };\n\n  const handleFromDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setFromDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      updateFilter('dateFrom', parsedDate.toISOString().split('T')[0]);\n    }\n  };\n\n  const handleToDateInput = (value: string) => {\n    const formatted = formatDateInput(value);\n    setToDateInput(formatted);\n    \n    const parsedDate = parseDate(formatted);\n    if (parsedDate) {\n      updateFilter('dateTo', parsedDate.toISOString().split('T')[0]);\n    }\n  };\n\n  // Filter categories based on selected type\n  const getAvailableCategories = () => {\n    if (typeFilter === 'INCOME') {\n      return categories.INCOME.sort();\n    } else if (typeFilter === 'EXPENSE') {\n      return categories.EXPENSE.sort();\n    }\n    // Show all categories if no type is selected or ALL is selected\n    return [...categories.INCOME, ...categories.EXPENSE].sort();\n  };\n\n  const availableCategories = getAvailableCategories();\n\n  const hasActiveFilters = filters.category || filters.method !== \"ALL\" || filters.memberId || \n                          filters.dateFrom || filters.dateTo || filters.amountMin || filters.amountMax;\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      {/* First row: Main filter selects */}\n      <div className=\"flex flex-wrap gap-3\">\n        <Select value={filters.category || \"ALL_CATEGORIES\"} onValueChange={(value) => updateFilter('category', value === 'ALL_CATEGORIES' ? undefined : value)}>\n          <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"select-category-filter\">\n            <SelectValue placeholder=\"Alle categorieën\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL_CATEGORIES\">Alle categorieën</SelectItem>\n            {availableCategories.map((category) => (\n              <SelectItem key={category} value={category}>\n                {category}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n        \n        <Select value={filters.method || \"ALL\"} onValueChange={(value) => updateFilter('method', value)}>\n          <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"select-method-filter\">\n            <SelectValue placeholder=\"Alle methodes\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL\">Alle methodes</SelectItem>\n            <SelectItem value=\"SEPA\">SEPA</SelectItem>\n            <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n            <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n            <SelectItem value=\"CASH\">Contant</SelectItem>\n          </SelectContent>\n        </Select>\n        \n        <Select value={filters.memberId || \"ALL_MEMBERS\"} onValueChange={(value) => updateFilter('memberId', value === 'ALL_MEMBERS' ? undefined : value)}>\n          <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"select-member-filter\">\n            <SelectValue placeholder=\"Alle leden\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL_MEMBERS\">Alle leden</SelectItem>\n            {mockMembers.map((member) => (\n              <SelectItem key={member.id} value={member.id}>\n                {member.name}\n              </SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Second row: Amount and Date ranges with labels */}\n      <div className=\"flex flex-wrap gap-3 items-center\">\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-gray-600\">Bedrag:</span>\n          <Input\n            type=\"number\"\n            step=\"0.01\"\n            min=\"0\"\n            placeholder=\"Min €\"\n            value={filters.amountMin || \"\"}\n            onChange={(e) => updateFilter('amountMin', e.target.value ? parseFloat(e.target.value) : undefined)}\n            className=\"w-[100px] h-9 border-gray-200\"\n            data-testid=\"input-amount-min\"\n          />\n          <span className=\"text-sm text-gray-400\">tot</span>\n          <Input\n            type=\"number\"\n            step=\"0.01\"\n            min=\"0\"\n            placeholder=\"Max €\"\n            value={filters.amountMax || \"\"}\n            onChange={(e) => updateFilter('amountMax', e.target.value ? parseFloat(e.target.value) : undefined)}\n            className=\"w-[100px] h-9 border-gray-200\"\n            data-testid=\"input-amount-max\"\n          />\n        </div>\n\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-gray-600\">Periode:</span>\n          \n          <div className=\"relative\">\n            <Input\n              value={fromDateInput || (filters.dateFrom ? format(new Date(filters.dateFrom), \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n              onChange={(e) => handleFromDateInput(e.target.value)}\n              placeholder=\"DD/MM/YYYY\"\n              className=\"w-[160px] h-9 border-gray-200 pr-10\"\n              data-testid=\"input-date-from\"\n              maxLength={10}\n            />\n            <Popover open={fromPopoverOpen} onOpenChange={setFromPopoverOpen}>\n              <PopoverTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                  onClick={() => setFromPopoverOpen(true)}\n                >\n                  <CalendarIcon className=\"h-4 w-4\" />\n                </Button>\n              </PopoverTrigger>\n              <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                <Calendar\n                  mode=\"single\"\n                  selected={filters.dateFrom ? new Date(filters.dateFrom) : undefined}\n                  onSelect={(date) => {\n                    if (date) {\n                      updateFilter('dateFrom', date.toISOString().split('T')[0]);\n                    } else {\n                      updateFilter('dateFrom', undefined);\n                    }\n                    setFromDateInput(\"\");\n                    setFromPopoverOpen(false);\n                  }}\n                  locale={nl}\n                  showOutsideDays={false}\n                  className=\"p-3\"\n                  defaultMonth={new Date()}\n                />\n              </PopoverContent>\n            </Popover>\n          </div>\n          \n          <span className=\"text-sm text-gray-400\">tot</span>\n          \n          <div className=\"relative\">\n            <Input\n              value={toDateInput || (filters.dateTo ? format(new Date(filters.dateTo), \"dd/MM/yyyy\", { locale: nl }) : \"\")}\n              onChange={(e) => handleToDateInput(e.target.value)}\n              placeholder=\"DD/MM/YYYY\"\n              className=\"w-[160px] h-9 border-gray-200 pr-10\"\n              data-testid=\"input-date-to\"\n              maxLength={10}\n            />\n            <Popover open={toPopoverOpen} onOpenChange={setToPopoverOpen}>\n              <PopoverTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 w-7 p-0 hover:bg-gray-100\"\n                  onClick={() => setToPopoverOpen(true)}\n                >\n                  <CalendarIcon className=\"h-4 w-4\" />\n                </Button>\n              </PopoverTrigger>\n              <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                <Calendar\n                  mode=\"single\"\n                  selected={filters.dateTo ? new Date(filters.dateTo) : undefined}\n                  onSelect={(date) => {\n                    if (date) {\n                      updateFilter('dateTo', date.toISOString().split('T')[0]);\n                    } else {\n                      updateFilter('dateTo', undefined);\n                    }\n                    setToDateInput(\"\");\n                    setToPopoverOpen(false);\n                  }}\n                  locale={nl}\n                  disabled={(date) => filters.dateFrom ? date < new Date(filters.dateFrom) : false}\n                  showOutsideDays={false}\n                  className=\"p-3\"\n                  defaultMonth={new Date()}\n                />\n              </PopoverContent>\n            </Popover>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":10572},"client/src/components/finance/ImportDialog.tsx":{"content":"\"use client\";\n\nimport { useState, useRef } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ImportMappingSchema, ImportMappingData } from \"@/lib/zod/transaction\";\nimport { parseCSV, parseMT940, parseCODA, CSVRow } from \"@/lib/csv\";\nimport { generateTransactionId, Transaction } from \"@/lib/mock/transactions\";\nimport { FileText, AlertTriangle, CheckCircle, Upload } from \"lucide-react\";\nimport { CiImport } from \"react-icons/ci\";\n\ninterface ImportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onImport: (transactions: Transaction[]) => void;\n}\n\ntype ImportStep = 'upload' | 'mapping' | 'preview' | 'complete';\n\nexport function ImportDialog({ open, onClose, onImport }: ImportDialogProps) {\n  const [step, setStep] = useState<ImportStep>('upload');\n  const [fileName, setFileName] = useState('');\n  const [fileType, setFileType] = useState<'csv' | 'mt940' | 'coda'>('csv');\n  const [headers, setHeaders] = useState<string[]>([]);\n  const [rows, setRows] = useState<CSVRow[]>([]);\n  const [mappedTransactions, setMappedTransactions] = useState<Transaction[]>([]);\n  const [loading, setLoading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const form = useForm<ImportMappingData>({\n    resolver: zodResolver(ImportMappingSchema),\n    defaultValues: {\n      dateColumn: '',\n      amountColumn: '',\n      descriptionColumn: '',\n      categoryColumn: ''\n    }\n  });\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setLoading(true);\n    setFileName(file.name);\n    \n    try {\n      const content = await file.text();\n      let parseResult;\n\n      // Determine file type and parse accordingly\n      if (file.name.toLowerCase().endsWith('.csv')) {\n        setFileType('csv');\n        parseResult = parseCSV(content);\n      } else if (file.name.toLowerCase().includes('mt940')) {\n        setFileType('mt940');\n        parseResult = parseMT940(content);\n      } else if (file.name.toLowerCase().includes('coda')) {\n        setFileType('coda');\n        parseResult = parseCODA(content);\n      } else {\n        // Default to CSV\n        setFileType('csv');\n        parseResult = parseCSV(content);\n      }\n\n      if (parseResult.success) {\n        setHeaders(parseResult.headers);\n        setRows(parseResult.rows.slice(0, 10)); // Preview first 10 rows\n        setStep('mapping');\n      } else {\n        alert(parseResult.error || 'Fout bij het parseren van het bestand');\n      }\n    } catch (error) {\n      alert('Fout bij het lezen van het bestand');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleMapping = (data: ImportMappingData) => {\n    setLoading(true);\n    \n    try {\n      const transactions: Transaction[] = rows.map(row => {\n        const dateStr = row[data.dateColumn];\n        const amountStr = row[data.amountColumn];\n        const description = data.descriptionColumn ? row[data.descriptionColumn] : '';\n        const category = data.categoryColumn ? row[data.categoryColumn] : 'Onbekend';\n        \n        // Parse amount and determine type\n        const amount = Math.abs(parseFloat(amountStr.replace(',', '.')) || 0);\n        const isNegative = amountStr.includes('-') || amountStr.startsWith('D') || row.type === 'D' || row.type === 'Debet';\n        const type = isNegative ? 'EXPENSE' : 'INCOME';\n        \n        // Parse date (try different formats)\n        let date = dateStr;\n        if (dateStr.includes('/')) {\n          const parts = dateStr.split('/');\n          if (parts.length === 3) {\n            date = `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;\n          }\n        } else if (dateStr.includes('-') && dateStr.length === 8) {\n          // Format: ddmmyyyy or yyyymmdd\n          if (dateStr.startsWith('20')) {\n            date = `${dateStr.substr(0, 4)}-${dateStr.substr(4, 2)}-${dateStr.substr(6, 2)}`;\n          } else {\n            date = `20${dateStr.substr(4, 2)}-${dateStr.substr(2, 2)}-${dateStr.substr(0, 2)}`;\n          }\n        }\n\n        return {\n          id: generateTransactionId(),\n          date,\n          type,\n          category,\n          amount,\n          method: fileType === 'csv' ? 'OVERSCHRIJVING' : 'SEPA',\n          description\n        } as Transaction;\n      });\n\n      setMappedTransactions(transactions);\n      setStep('preview');\n    } catch (error) {\n      alert('Fout bij het verwerken van de gegevens');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleImport = () => {\n    onImport(mappedTransactions);\n    setStep('complete');\n  };\n\n  const handleClose = () => {\n    setStep('upload');\n    setFileName('');\n    setHeaders([]);\n    setRows([]);\n    setMappedTransactions([]);\n    form.reset();\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n    onClose();\n  };\n\n  const renderUploadStep = () => (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100\">\n          Upload bestand\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          Selecteer een CSV, MT940 of CODA bestand om te importeren\n        </p>\n      </div>\n      \n      <div className=\"mt-6\">\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\".csv,.txt,.mt940,.coda\"\n          onChange={handleFileUpload}\n          className=\"hidden\"\n          data-testid=\"input-file-upload\"\n        />\n        <Button\n          onClick={() => fileInputRef.current?.click()}\n          className=\"w-full\"\n          disabled={loading}\n          data-testid=\"button-select-file\"\n        >\n          {loading ? 'Bezig met laden...' : 'Bestand selecteren'}\n        </Button>\n      </div>\n      \n      <div className=\"text-xs text-gray-500 dark:text-gray-400 space-y-1\">\n        <p><strong>Ondersteunde formaten:</strong></p>\n        <ul className=\"list-disc list-inside space-y-1\">\n          <li>CSV: Comma/semicolon separated values</li>\n          <li>MT940: SWIFT bank statement format</li>\n          <li>CODA: Belgian bank statement format</li>\n        </ul>\n      </div>\n    </div>\n  );\n\n  const renderMappingStep = () => (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium\">Kolom mapping</h3>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          Koppel de kolommen uit je bestand aan de juiste velden\n        </p>\n      </div>\n\n      <Form {...form}>\n        <form onSubmit={form.handleSubmit(handleMapping)} className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"dateColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Datum kolom *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-date-column\">\n                        <SelectValue placeholder=\"Selecteer kolom\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"amountColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Bedrag kolom *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-amount-column\">\n                        <SelectValue placeholder=\"Selecteer kolom\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"descriptionColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Omschrijving kolom</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-description-column\">\n                        <SelectValue placeholder=\"Selecteer kolom (optioneel)\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"none\">Geen</SelectItem>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"categoryColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Categorie kolom</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-category-column\">\n                        <SelectValue placeholder=\"Selecteer kolom (optioneel)\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"none\">Geen</SelectItem>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </div>\n\n          {/* Preview of first few rows */}\n          <div className=\"mt-6\">\n            <h4 className=\"text-sm font-medium mb-2\">Voorbeeld data:</h4>\n            <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    {headers.map(header => (\n                      <TableHead key={header} className=\"text-xs\">{header}</TableHead>\n                    ))}\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {rows.slice(0, 3).map((row, index) => (\n                    <TableRow key={index}>\n                      {headers.map(header => (\n                        <TableCell key={header} className=\"text-xs\">\n                          {row[header]}\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n\n          <div className=\"flex justify-between pt-4\">\n            <Button type=\"button\" variant=\"outline\" onClick={() => setStep('upload')}>\n              Terug\n            </Button>\n            <Button type=\"submit\" disabled={loading} data-testid=\"button-continue-mapping\">\n              {loading ? 'Verwerken...' : 'Doorgaan'}\n            </Button>\n          </div>\n        </form>\n      </Form>\n    </div>\n  );\n\n  const renderPreviewStep = () => (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium\">Voorbeeld import</h3>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          Controleer de geïmporteerde transacties voordat je ze toevoegt\n        </p>\n      </div>\n\n      <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\n        <div className=\"flex items-center gap-2\">\n          <FileText className=\"h-5 w-5 text-blue-600\" />\n          <span className=\"text-sm font-medium\">\n            {mappedTransactions.length} transacties gevonden in {fileName}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden max-h-80 overflow-y-auto\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Datum</TableHead>\n              <TableHead>Type</TableHead>\n              <TableHead>Categorie</TableHead>\n              <TableHead>Bedrag</TableHead>\n              <TableHead>Omschrijving</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {mappedTransactions.slice(0, 20).map((transaction, index) => (\n              <TableRow key={index}>\n                <TableCell className=\"text-xs\">{transaction.date}</TableCell>\n                <TableCell>\n                  <Badge variant={transaction.type === 'INCOME' ? 'secondary' : 'destructive'}>\n                    {transaction.type === 'INCOME' ? 'Inkomst' : 'Uitgave'}\n                  </Badge>\n                </TableCell>\n                <TableCell className=\"text-xs\">{transaction.category}</TableCell>\n                <TableCell className=\"text-xs\">€{transaction.amount.toFixed(2)}</TableCell>\n                <TableCell className=\"text-xs max-w-[200px] truncate\">\n                  {transaction.description || '-'}\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n\n      {mappedTransactions.length > 20 && (\n        <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n          ... en nog {mappedTransactions.length - 20} transacties\n        </p>\n      )}\n\n      <div className=\"flex justify-between pt-4\">\n        <Button type=\"button\" variant=\"outline\" onClick={() => setStep('mapping')}>\n          Terug\n        </Button>\n        <Button onClick={handleImport} data-testid=\"button-confirm-import\">\n          <CiImport className=\"h-4 w-4 mr-2\" />\n          Transacties importeren\n        </Button>\n      </div>\n    </div>\n  );\n\n  const renderCompleteStep = () => (\n    <div className=\"text-center space-y-6\">\n      <div>\n        <CheckCircle className=\"mx-auto h-12 w-12 text-green-500\" />\n        <h3 className=\"mt-2 text-lg font-medium text-gray-900 dark:text-gray-100\">\n          Import voltooid!\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          {mappedTransactions.length} transacties zijn succesvol geïmporteerd\n        </p>\n      </div>\n      \n      <Button onClick={handleClose} className=\"w-full\" data-testid=\"button-close-import\">\n        Sluiten\n      </Button>\n    </div>\n  );\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[800px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Transacties importeren</DialogTitle>\n          <DialogDescription>\n            Import transacties vanuit CSV, MT940 of CODA bestanden\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"py-6\">\n          {step === 'upload' && renderUploadStep()}\n          {step === 'mapping' && renderMappingStep()}\n          {step === 'preview' && renderPreviewStep()}\n          {step === 'complete' && renderCompleteStep()}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":16472},"client/src/components/finance/JournalView.tsx":{"content":"\"use client\";\n\nimport { useMemo } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\nimport { MdOutbox } from \"react-icons/md\";\nimport { HiInboxIn, HiInbox } from \"react-icons/hi\";\nimport { CreditCard } from \"lucide-react\";\n\ninterface JournalViewProps {\n  transactions: Transaction[];\n}\n\nexport function JournalView({ transactions }: JournalViewProps) {\n  const { debitTransactions, creditTransactions, totals } = useMemo(() => {\n    const debit = transactions.filter(t => t.type === 'EXPENSE').sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    const credit = transactions.filter(t => t.type === 'INCOME').sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    \n    const debitTotal = debit.reduce((sum, t) => {\n      const amount = Number(t.amount) || 0;\n      return sum + amount;\n    }, 0);\n    const creditTotal = credit.reduce((sum, t) => {\n      const amount = Number(t.amount) || 0;\n      return sum + amount;\n    }, 0);\n    \n    return {\n      debitTransactions: debit,\n      creditTransactions: credit,\n      totals: {\n        debit: isNaN(debitTotal) ? 0 : debitTotal,\n        credit: isNaN(creditTotal) ? 0 : creditTotal,\n        balance: isNaN(creditTotal - debitTotal) ? 0 : creditTotal - debitTotal\n      }\n    };\n  }, [transactions]);\n\n  const TransactionRow = ({ transaction }: { transaction: Transaction }) => (\n    <TableRow>\n      <TableCell className=\"text-sm\">{formatDateBE(transaction.date)}</TableCell>\n      <TableCell className=\"text-sm\">{transaction.category}</TableCell>\n      <TableCell className=\"text-sm\">\n        {transaction.memberName ? (\n          <span className=\"text-gray-900 dark:text-gray-100\">\n            {transaction.memberName}\n          </span>\n        ) : (\n          <span className=\"text-gray-400\">-</span>\n        )}\n      </TableCell>\n      <TableCell className=\"text-sm\">\n        {transaction.method === 'SEPA' ? 'SEPA' : \n         transaction.method === 'OVERSCHRIJVING' ? 'Overschrijving' : \n         transaction.method === 'BANCONTACT' ? 'Bancontact' : 'Contant'}\n      </TableCell>\n      <TableCell className=\"text-sm max-w-[150px] truncate\">\n        {transaction.description || '-'}\n      </TableCell>\n      <TableCell className=\"text-right font-medium\">\n        {formatCurrencyBE(transaction.amount)}\n      </TableCell>\n    </TableRow>\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Debet</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">{formatCurrencyBE(totals.debit)}</p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-red-600\">\n                  {debitTransactions.length} transacties\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-red-50 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <MdOutbox className=\"h-4 w-4 text-red-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Credit</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">{formatCurrencyBE(totals.credit)}</p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-green-600\">\n                  {creditTransactions.length} transacties\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-green-50 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <HiInboxIn className=\"h-4 w-4 text-green-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Saldo</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">{formatCurrencyBE(Math.abs(totals.balance))}</p>\n              <div className=\"flex items-center space-x-1\">\n                <span className={`text-xs font-medium ${\n                  totals.balance >= 0 \n                    ? 'text-green-600' \n                    : 'text-red-600'\n                }`}>\n                  {totals.balance >= 0 ? 'Overschot' : 'Tekort'}\n                </span>\n              </div>\n            </div>\n            <div className={`w-10 h-10 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300 ${\n              totals.balance > 0 \n                ? 'bg-green-50' \n                : totals.balance < 0\n                ? 'bg-red-50'\n                : 'bg-gray-50'\n            }`}>\n              <HiInbox className={`h-4 w-4 ${\n                totals.balance > 0 \n                  ? 'text-green-600' \n                  : totals.balance < 0\n                  ? 'text-red-600'\n                  : 'text-gray-600'\n              }`} />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Journal Tables */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Debet (Uitgaven) */}\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n          <div className=\"p-6 pb-4 border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <MdOutbox className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Debet</h3>\n              </div>\n              <span className=\"text-sm text-gray-500 dark:text-gray-400\">{debitTransactions.length} transacties</span>\n            </div>\n          </div>\n          <div className=\"p-6\">\n            <div className=\"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700\">\n              <Table>\n                <TableHeader>\n                  <TableRow className=\"bg-gray-50 dark:bg-gray-900\">\n                    <TableHead className=\"text-xs font-medium\">Datum</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Categorie</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Lid</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Methode</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Omschrijving</TableHead>\n                    <TableHead className=\"text-xs font-medium text-right\">Bedrag</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody className=\"max-h-80 overflow-y-auto\">\n                  {debitTransactions.length > 0 ? (\n                    debitTransactions.map((transaction) => (\n                      <TransactionRow key={transaction.id} transaction={transaction} />\n                    ))\n                  ) : (\n                    <TableRow>\n                      <TableCell colSpan={6} className=\"text-center py-12\">\n                        <div className=\"flex flex-col items-center justify-center px-4 text-center\">\n                          <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n                            <CreditCard className=\"w-8 h-8 text-gray-400\" />\n                          </div>\n                          <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n                            Geen uitgaven gevonden\n                          </h3>\n                          <p className=\"text-gray-500 dark:text-gray-400 max-w-sm\">\n                            Uitgaven worden hier weergegeven wanneer ze worden toegevoegd.\n                          </p>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n        </div>\n\n        {/* Credit (Inkomsten) */}\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n          <div className=\"p-6 pb-4 border-b border-gray-200 dark:border-gray-700\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <HiInboxIn className=\"h-5 w-5 text-gray-600 dark:text-gray-400\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Credit</h3>\n              </div>\n              <span className=\"text-sm text-gray-500 dark:text-gray-400\">{creditTransactions.length} transacties</span>\n            </div>\n          </div>\n          <div className=\"p-6\">\n            <div className=\"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700\">\n              <Table>\n                <TableHeader>\n                  <TableRow className=\"bg-gray-50 dark:bg-gray-900\">\n                    <TableHead className=\"text-xs font-medium\">Datum</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Categorie</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Lid</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Methode</TableHead>\n                    <TableHead className=\"text-xs font-medium\">Omschrijving</TableHead>\n                    <TableHead className=\"text-xs font-medium text-right\">Bedrag</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody className=\"max-h-80 overflow-y-auto\">\n                  {creditTransactions.length > 0 ? (\n                    creditTransactions.map((transaction) => (\n                      <TransactionRow key={transaction.id} transaction={transaction} />\n                    ))\n                  ) : (\n                    <TableRow>\n                      <TableCell colSpan={6} className=\"text-center py-12\">\n                        <div className=\"flex flex-col items-center justify-center px-4 text-center\">\n                          <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n                            <CreditCard className=\"w-8 h-8 text-gray-400\" />\n                          </div>\n                          <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n                            Geen inkomsten gevonden\n                          </h3>\n                          <p className=\"text-gray-500 dark:text-gray-400 max-w-sm\">\n                            Inkomsten worden hier weergegeven wanneer ze worden toegevoegd.\n                          </p>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Balance Summary */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n        <div className=\"p-6 pb-4 border-b border-gray-200 dark:border-gray-700\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Journaal Saldo</h3>\n          <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">Overzicht van de balans tussen debet en credit</p>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\n            <div className=\"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n                {formatCurrencyBE(totals.debit)}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Totaal Debet</div>\n            </div>\n            \n            <div className=\"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <div className=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">\n                {formatCurrencyBE(totals.credit)}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Totaal Credit</div>\n            </div>\n            \n            <div className=\"p-4 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <div className={`text-2xl font-bold ${\n                totals.balance >= 0 \n                  ? 'text-green-600 dark:text-green-400' \n                  : 'text-red-600 dark:text-red-400'\n              }`}>\n                {formatCurrencyBE(Math.abs(totals.balance))}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Saldo ({totals.balance >= 0 ? 'Overschot' : 'Tekort'})\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":14149},"client/src/components/finance/KpiCards.tsx":{"content":"\"use client\";\n\nimport { formatCurrencyBE } from \"@/lib/format\";\nimport { Euro } from \"lucide-react\";\nimport { HiInboxIn } from \"react-icons/hi\";\nimport { MdOutlineOutbox } from \"react-icons/md\";\nimport { TbClockExclamation, TbAlertTriangle } from \"react-icons/tb\";\nimport { useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface KpiCardProps {\n  title: string;\n  value: string;\n  delta: {\n    value: string;\n    positive: boolean;\n  };\n  icon: React.ReactNode;\n  iconBgColor?: string;\n}\n\nfunction KpiCard({ title, value, delta, icon, iconBgColor = \"bg-blue-50\" }: KpiCardProps) {\n  const getColorClasses = () => {\n    if (delta.positive) {\n      return {\n        textClass: 'text-green-600',\n        bgClass: 'bg-green-50'\n      };\n    } else {\n      return {\n        textClass: 'text-red-500',\n        bgClass: 'bg-red-50'\n      };\n    }\n  };\n\n  const colors = getColorClasses();\n\n  return (\n    <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group relative overflow-hidden\">\n      {/* Dynamic gradient overlay based on card type */}\n      <div className={`absolute inset-0 pointer-events-none opacity-0 group-hover:opacity-100 transition-opacity duration-500 ${\n        title === 'Totale Inkomsten' ? 'bg-gradient-to-br from-green-500/5 to-transparent' :\n        title === 'Vervallen Lidgeld' ? 'bg-gradient-to-br from-red-500/5 to-transparent' :\n        title === 'Openstaand Lidgeld' ? 'bg-gradient-to-br from-orange-500/5 to-transparent' :\n        'bg-gradient-to-br from-blue-500/5 to-transparent'\n      }`}></div>\n      \n      <div className=\"flex items-center justify-between relative z-10\">\n        <div className=\"flex-1\">\n          <p className=\"text-xs font-medium text-muted-foreground mb-1\">{title}</p>\n          <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300 tabular-nums\">{value}</p>\n          <div className=\"flex items-center space-x-1\">\n            <span className={`text-xs font-medium ${colors.textClass} group-hover:text-opacity-80 transition-all duration-300`}>\n              {delta.value}\n            </span>\n          </div>\n        </div>\n        <div className={`w-10 h-10 ${iconBgColor} rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-all duration-300 relative`}>\n          <div className=\"absolute inset-0 bg-gradient-to-br from-white/20 to-transparent rounded-xl\"></div>\n          <div className=\"relative\">{icon}</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function KpiCards() {\n  const { data: transactions } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n  \n  const { data: fees } = useQuery({\n    queryKey: [\"/api/fees\"],\n  });\n\n  const kpiData = useMemo(() => {\n    const totalIncome = Array.isArray(transactions) ? transactions.filter((t: any) => t.type === 'INCOME').reduce((sum: number, t: any) => sum + Math.abs(parseFloat(t.amount)), 0) : 0;\n    const totalExpense = Array.isArray(transactions) ? transactions.filter((t: any) => t.type === 'EXPENSE').reduce((sum: number, t: any) => sum + Math.abs(parseFloat(t.amount)), 0) : 0;\n    const balance = totalIncome - totalExpense;\n    const openFees = Array.isArray(fees) ? fees.filter((f: any) => f.status === 'OPEN').reduce((sum: number, f: any) => sum + parseFloat(f.amount), 0) : 0;\n    const overdueFees = Array.isArray(fees) ? fees.filter((f: any) => f.status === 'OVERDUE').reduce((sum: number, f: any) => sum + parseFloat(f.amount), 0) : 0;\n    \n    return {\n      income: totalIncome,\n      expense: totalExpense,\n      balance,\n      openFees,\n      overdueFees\n    };\n  }, [transactions, fees]);\n\n  const kpis = [\n    {\n      title: \"Totale Inkomsten\",\n      value: formatCurrencyBE(kpiData.income),\n      delta: { value: \"Totaal inkomsten\", positive: true },\n      icon: <HiInboxIn className=\"h-4 w-4 text-green-600\" />,\n      iconBgColor: \"bg-green-50\"\n    },\n    {\n      title: \"Totale Uitgaven\",\n      value: formatCurrencyBE(kpiData.expense),\n      delta: { value: \"Totaal uitgaven\", positive: false },\n      icon: <MdOutlineOutbox className=\"h-4 w-4 text-red-600\" />,\n      iconBgColor: \"bg-red-50\"\n    },\n    {\n      title: \"Netto Saldo\",\n      value: formatCurrencyBE(Math.abs(kpiData.balance)),\n      delta: { \n        value: kpiData.balance >= 0 ? \"Overschot\" : \"Tekort\", \n        positive: kpiData.balance >= 0 \n      },\n      icon: <Euro className=\"h-4 w-4 text-blue-600\" />,\n      iconBgColor: \"bg-blue-50\"\n    },\n    {\n      title: \"Openstaand Lidgeld\",\n      value: formatCurrencyBE(kpiData.openFees),\n      delta: { value: \"Openstaande bedragen\", positive: false },\n      icon: <TbClockExclamation className=\"h-4 w-4 text-orange-600\" />,\n      iconBgColor: \"bg-orange-50\"\n    },\n    {\n      title: \"Vervallen Lidgeld\",\n      value: formatCurrencyBE(kpiData.overdueFees),\n      delta: { value: \"Vervallen betalingen\", positive: false },\n      icon: <TbAlertTriangle className=\"h-4 w-4 text-red-600\" />,\n      iconBgColor: \"bg-red-50\"\n    }\n  ];\n\n  return (\n    <div className=\"grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-5 gap-4 mb-6\">\n      {kpis.map((kpi, index) => (\n        <KpiCard\n          key={index}\n          title={kpi.title}\n          value={kpi.value}\n          delta={kpi.delta}\n          icon={kpi.icon}\n          iconBgColor={kpi.iconBgColor}\n        />\n      ))}\n    </div>\n  );\n}","size_bytes":5409},"client/src/components/finance/NewTransactionDialog.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { TransactionSchema, TransactionFormData } from \"@/lib/zod/transaction\";\nimport { categories } from \"@/lib/mock/transactions\";\nimport { format } from \"date-fns\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface NewTransactionDialogProps {\n  open: boolean;\n  onClose: () => void;\n  editTransaction?: any | null;\n}\n\nexport function NewTransactionDialog({\n  open,\n  onClose,\n  editTransaction\n}: NewTransactionDialogProps) {\n  const [loading, setLoading] = useState(false);\n  const [activeTab, setActiveTab] = useState('basis');\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const isEditing = !!editTransaction;\n\n  // Fetch members for dropdown\n  const { data: members = [] } = useQuery({\n    queryKey: [\"/api/members\"],\n  });\n  \n  const form = useForm<TransactionFormData>({\n    resolver: zodResolver(TransactionSchema),\n    defaultValues: {\n      type: editTransaction?.type || 'INCOME',\n      date: editTransaction?.date || format(new Date(), 'yyyy-MM-dd'),\n      category: editTransaction?.category || '',\n      amount: editTransaction?.amount || 0,\n      method: editTransaction?.method || 'SEPA',\n      memberId: editTransaction?.memberId || '',\n      memberName: editTransaction?.memberName || '',\n      description: editTransaction?.description || ''\n    }\n  });\n\n  const selectedType = form.watch('type');\n  const selectedMemberId = form.watch('memberId');\n  \n  // Create transaction mutation\n  const createTransactionMutation = useMutation({\n    mutationFn: async (data: TransactionFormData) => {\n      const response = await apiRequest(\"POST\", \"/api/transactions\", data);\n      return response.json();\n    },\n    onSuccess: async (newTransaction, variables) => {\n      // Optimistic update - voeg transactie toe aan lijst\n      queryClient.setQueryData([\"/api/transactions\"], (oldData: any) => {\n        if (!Array.isArray(oldData)) return [newTransaction];\n        return [newTransaction, ...oldData];\n      });\n      \n      await queryClient.invalidateQueries({ queryKey: [\"/api/transactions\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/financial/reports\"] });\n      toast({\n        title: \"Transactie toegevoegd\",\n        description: `${variables.type === 'INCOME' ? 'Inkomst' : 'Uitgave'} van €${variables.amount} is toegevoegd.`,\n      });\n      setLoading(false);\n      handleClose();\n    },\n    onError: (error: any) => {\n      console.error('Create transaction error:', error);\n      toast({\n        title: \"Fout bij toevoegen transactie\",\n        description: error?.message || \"Er is een fout opgetreden bij het toevoegen van de transactie.\",\n        variant: \"destructive\",\n      });\n      setLoading(false);\n    },\n  });\n\n  // Edit transaction mutation\n  const editTransactionMutation = useMutation({\n    mutationFn: async (data: TransactionFormData) => {\n      const response = await apiRequest(\"PUT\", `/api/transactions/${editTransaction.id}`, data);\n      return response.json();\n    },\n    onSuccess: async (updatedTransaction, variables) => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/transactions\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/financial/reports\"] });\n      toast({\n        title: \"Transactie bijgewerkt\",\n        description: `Wijzigingen zijn opgeslagen.`,\n      });\n      setLoading(false);\n      handleClose();\n    },\n    onError: (error: any) => {\n      console.error('Edit transaction error:', error);\n      toast({\n        title: \"Fout bij bijwerken transactie\",\n        description: error?.message || \"Er is een fout opgetreden bij het bijwerken van de transactie.\",\n        variant: \"destructive\",\n      });\n      setLoading(false);\n    },\n  });\n\n  // Handle member change to auto-fill member name\n  const handleMemberChange = (memberId: string) => {\n    if (memberId === \"none\" || !memberId) {\n      form.setValue(\"memberName\", \"\");\n      return;\n    }\n    \n    const member = Array.isArray(members) ? members.find((m: any) => m.id === memberId) : null;\n    if (member) {\n      form.setValue(\"memberName\", `${member.firstName} ${member.lastName}`);\n    }\n  };\n\n  const onSubmit = async (data: TransactionFormData) => {\n    try {\n      setLoading(true);\n      \n      // Clean up memberId if \"none\" selected\n      if (data.memberId === \"none\" || !data.memberId) {\n        data.memberId = \"\";\n        data.memberName = \"\";\n      }\n\n      if (isEditing) {\n        editTransactionMutation.mutate(data);\n      } else {\n        createTransactionMutation.mutate(data);\n      }\n    } catch (error) {\n      console.error('Error saving transaction:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isEditing) {\n      form.reset();\n    }\n    setActiveTab('basis');\n    onClose();\n  };\n\n  const nextTab = () => {\n    if (activeTab === 'basis') setActiveTab('details');\n    else if (activeTab === 'details') setActiveTab('overzicht');\n  };\n\n  const prevTab = () => {\n    if (activeTab === 'details') setActiveTab('basis');\n    else if (activeTab === 'overzicht') setActiveTab('details');\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[800px] min-h-[600px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {isEditing ? 'Transactie bewerken' : 'Nieuwe transactie'}\n          </DialogTitle>\n          <DialogDescription>\n            {isEditing \n              ? 'Wijzig de details van deze transactie.'\n              : 'Voeg een nieuwe inkomst of uitgave toe aan je financiële administratie.'\n            }\n          </DialogDescription>\n        </DialogHeader>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)}>\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n              <TabsList className=\"grid w-full grid-cols-3\">\n                <TabsTrigger value=\"basis\">Basis Gegevens</TabsTrigger>\n                <TabsTrigger value=\"details\">Details</TabsTrigger>\n                <TabsTrigger value=\"overzicht\">Overzicht</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"basis\" className=\"space-y-6 mt-6\">\n                {/* Type */}\n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Type *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-transaction-type\">\n                            <SelectValue placeholder=\"Selecteer type\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"INCOME\">Inkomsten</SelectItem>\n                          <SelectItem value=\"EXPENSE\">Uitgaven</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Date and Amount Row */}\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"date\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Datum *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"date\"\n                            {...field}\n                            data-testid=\"input-transaction-date\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"amount\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Bedrag (€) *</FormLabel>\n                        <FormControl>\n                          <Input\n                            type=\"number\"\n                            step=\"0.01\"\n                            min=\"0\"\n                            placeholder=\"0,00\"\n                            {...field}\n                            onChange={(e) => field.onChange(parseFloat(e.target.value) || 0)}\n                            data-testid=\"input-transaction-amount\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                {/* Category */}\n                <FormField\n                  control={form.control}\n                  name=\"category\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Categorie *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-transaction-category\">\n                            <SelectValue placeholder=\"Selecteer categorie\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {categories[selectedType].map((category) => (\n                            <SelectItem key={category} value={category}>\n                              {category}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"details\" className=\"space-y-6 mt-6\">\n                {/* Payment Method */}\n                <FormField\n                  control={form.control}\n                  name=\"method\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Betaalmethode *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-transaction-method\">\n                            <SelectValue placeholder=\"Selecteer methode\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"SEPA\">SEPA</SelectItem>\n                          <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                          <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                          <SelectItem value=\"CASH\">Contant</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Member (Optional) */}\n                <FormField\n                  control={form.control}\n                  name=\"memberId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Lid (optioneel)</FormLabel>\n                      <Select \n                        onValueChange={(value) => {\n                          field.onChange(value);\n                          handleMemberChange(value);\n                        }} \n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-transaction-member\">\n                            <SelectValue placeholder=\"Selecteer lid\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"none\">Geen lid gekoppeld</SelectItem>\n                          {Array.isArray(members) && members.map((member: any) => (\n                            <SelectItem key={member.id} value={member.id}>\n                              {member.firstName} {member.lastName}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormDescription>\n                        Koppel deze transactie aan een specifiek lid (bijv. voor lidgeld)\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Description */}\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Omschrijving (optioneel)</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Voeg een omschrijving toe...\"\n                          className=\"resize-none\"\n                          rows={3}\n                          {...field}\n                          data-testid=\"input-transaction-description\"\n                        />\n                      </FormControl>\n                      <FormDescription>\n                        Maximaal 500 karakters\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"overzicht\" className=\"space-y-6 mt-6\">\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Overzicht van de transactie</h3>\n                  \n                  <div className=\"grid grid-cols-2 gap-4 p-4 bg-muted rounded-lg\">\n                    <div>\n                      <span className=\"font-medium\">Type:</span>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {form.watch('type') === 'INCOME' ? 'Inkomsten' : 'Uitgaven'}\n                      </p>\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">Bedrag:</span>\n                      <p className=\"text-sm text-muted-foreground\">€{form.watch('amount') || 0}</p>\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">Datum:</span>\n                      <p className=\"text-sm text-muted-foreground\">{form.watch('date')}</p>\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">Categorie:</span>\n                      <p className=\"text-sm text-muted-foreground\">{form.watch('category') || 'Niet geselecteerd'}</p>\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">Betaalmethode:</span>\n                      <p className=\"text-sm text-muted-foreground\">{form.watch('method')}</p>\n                    </div>\n                    <div>\n                      <span className=\"font-medium\">Lid:</span>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {form.watch('memberName') || 'Geen lid gekoppeld'}\n                      </p>\n                    </div>\n                  </div>\n                  \n                  {form.watch('description') && (\n                    <div className=\"p-4 bg-muted rounded-lg\">\n                      <span className=\"font-medium\">Omschrijving:</span>\n                      <p className=\"text-sm text-muted-foreground mt-1\">{form.watch('description')}</p>\n                    </div>\n                  )}\n                </div>\n              </TabsContent>\n            </Tabs>\n\n            <DialogFooter className=\"flex justify-between items-center mt-6\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={handleClose}\n                data-testid=\"button-cancel-transaction\"\n              >\n                Annuleren\n              </Button>\n              \n              <div className=\"flex gap-2\">\n                {activeTab !== 'basis' && (\n                  <Button type=\"button\" variant=\"outline\" onClick={prevTab}>\n                    Vorige\n                  </Button>\n                )}\n                {activeTab !== 'overzicht' && (\n                  <Button type=\"button\" onClick={nextTab}>\n                    Volgende\n                  </Button>\n                )}\n                <Button \n                  type=\"submit\" \n                  disabled={loading || activeTab !== 'overzicht'}\n                  variant={activeTab === 'overzicht' ? 'default' : 'outline'}\n                  data-testid=\"button-save-transaction\"\n                >\n                  {loading ? 'Bezig...' : (isEditing ? 'Wijzigingen opslaan' : 'Transactie toevoegen')}\n                </Button>\n              </div>\n            </DialogFooter>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":18346},"client/src/components/finance/RowActions.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { MoreHorizontal, Eye, Edit, Trash2 } from \"lucide-react\";\nimport { Transaction } from \"@/lib/mock/transactions\";\n\ninterface RowActionsProps {\n  transaction: Transaction;\n  onView: (transaction: Transaction) => void;\n  onEdit: (transaction: Transaction) => void;\n  onDelete: (transactionId: string) => void;\n}\n\nexport function RowActions({ transaction, onView, onEdit, onDelete }: RowActionsProps) {\n  const [open, setOpen] = useState(false);\n\n  const handleAction = (action: () => void) => {\n    action();\n    setOpen(false);\n  };\n\n  return (\n    <DropdownMenu open={open} onOpenChange={setOpen}>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"h-8 w-8 p-0\"\n          onClick={(e) => e.stopPropagation()}\n          data-testid={`button-actions-${transaction.id}`}\n        >\n          <span className=\"sr-only\">Acties openen</span>\n          <MoreHorizontal className=\"h-4 w-4\" />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-[160px]\">\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onView(transaction));\n          }}\n          data-testid={`menu-view-${transaction.id}`}\n        >\n          <Eye className=\"mr-2 h-4 w-4\" />\n          Details\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onEdit(transaction));\n          }}\n          data-testid={`menu-edit-${transaction.id}`}\n        >\n          <Edit className=\"mr-2 h-4 w-4\" />\n          Bewerken\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onDelete(transaction.id));\n          }}\n          className=\"text-red-600 dark:text-red-400\"\n          data-testid={`menu-delete-${transaction.id}`}\n        >\n          <Trash2 className=\"mr-2 h-4 w-4\" />\n          Verwijderen\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}","size_bytes":2333},"client/src/components/finance/Toolbar.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Search, Plus, Filter } from \"lucide-react\";\nimport { CiExport, CiImport } from \"react-icons/ci\";\nimport { FiltersToolbar } from \"./FiltersDrawer\";\nimport { FilterData } from \"@/lib/zod/transaction\";\n\ninterface ToolbarProps {\n  onSearch: (search: string) => void;\n  onTypeFilter: (type: string) => void;\n  onPeriodFilter: (period: string) => void;\n  onNewTransaction: () => void;\n  onImport: () => void;\n  onExport: () => void;\n  onAdvancedFilters: () => void;\n  searchValue: string;\n  typeFilter: string;\n  periodFilter: string;\n  advancedFilters?: FilterData;\n  onAdvancedFiltersChange?: (filters: FilterData) => void;\n  onClearAdvancedFilters?: () => void;\n}\n\nexport function Toolbar({\n  onSearch,\n  onTypeFilter,\n  onPeriodFilter,\n  onNewTransaction,\n  onImport,\n  onExport,\n  onAdvancedFilters,\n  searchValue,\n  typeFilter,\n  periodFilter,\n  advancedFilters,\n  onAdvancedFiltersChange,\n  onClearAdvancedFilters\n}: ToolbarProps) {\n  return (\n    <div className=\"glass-card card-hover animate-fade-in group p-4 rounded-lg border-0\">\n      <div className=\"space-y-4\">\n        {/* First Row: Search and Action Buttons */}\n        <div className=\"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between\">\n          {/* Search and Quick Filters */}\n          <div className=\"flex flex-col sm:flex-row gap-3 flex-1 w-full lg:w-auto\">\n            {/* Search Bar */}\n            <div className=\"relative flex-1 min-w-0 sm:max-w-sm\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n              <Input\n                placeholder=\"Zoek op categorie, omschrijving of lidnummer...\"\n                value={searchValue}\n                onChange={(e) => onSearch(e.target.value)}\n                className=\"pl-10 h-10 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20\"\n                data-testid=\"input-search\"\n              />\n            </div>\n            \n            {/* Type Filter */}\n            <Select value={typeFilter} onValueChange={onTypeFilter}>\n              <SelectTrigger className=\"w-full sm:w-40 h-10 border-gray-200\" data-testid=\"select-type-filter\">\n                <SelectValue placeholder=\"Alle types\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"ALL\">Alle types</SelectItem>\n                <SelectItem value=\"INCOME\">Inkomsten</SelectItem>\n                <SelectItem value=\"EXPENSE\">Uitgaven</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {/* Action Buttons */}\n          <div className=\"flex gap-2 w-full lg:w-auto lg:flex-shrink-0\">\n            <Button\n              variant=\"outline\"\n              onClick={onImport}\n              className=\"gap-2 flex-1 lg:flex-none h-10 px-4 border-gray-200 hover:border-gray-300\"\n              data-testid=\"button-import\"\n            >\n              <CiImport className=\"h-4 w-4\" />\n              Import\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={onExport}\n              className=\"gap-2 flex-1 lg:flex-none h-10 px-4 border-gray-200 hover:border-gray-300\"\n              data-testid=\"button-export\"\n            >\n              <CiExport className=\"h-4 w-4\" />\n              Export\n            </Button>\n            <Button\n              onClick={onNewTransaction}\n              className=\"gap-2 flex-1 lg:flex-none h-10 px-4\"\n              data-testid=\"button-new-transaction\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              Nieuwe transactie\n            </Button>\n          </div>\n        </div>\n\n        {/* Advanced Filters Toolbar */}\n        {advancedFilters && onAdvancedFiltersChange && onClearAdvancedFilters && (\n          <div className=\"pt-4 border-t border-gray-200\">\n            <FiltersToolbar\n              filters={advancedFilters}\n              onFiltersChange={onAdvancedFiltersChange}\n              onClearFilters={onClearAdvancedFilters}\n              typeFilter={typeFilter}\n            />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":4366},"client/src/components/finance/TransactionsTable.tsx":{"content":"\"use client\";\n\nimport React, { useState, useMemo, useCallback } from \"react\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Button } from \"@/components/ui/button\";\nimport { StatusChip } from \"@/components/ui/StatusChip\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\nimport { EmptyState } from \"@/components/ui/EmptyState\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { FilterData } from \"@/lib/zod/transaction\";\nimport { ChevronUp, ChevronDown, MoreHorizontal } from \"lucide-react\";\nimport { RowActions } from \"./RowActions\";\n\ninterface TransactionsTableProps {\n  transactions: Transaction[];\n  filters: FilterData;\n  onTransactionSelect: (transaction: Transaction) => void;\n  onTransactionEdit: (transaction: Transaction) => void;\n  onTransactionDelete: (transactionId: string) => void;\n  loading?: boolean;\n}\n\ntype SortField = 'date' | 'amount' | 'category' | 'type';\ntype SortDirection = 'asc' | 'desc';\n\nconst TransactionsTable = React.memo(function TransactionsTable({\n  transactions,\n  filters,\n  onTransactionSelect,\n  onTransactionEdit,\n  onTransactionDelete,\n  loading = false\n}: TransactionsTableProps) {\n  const [sortField, setSortField] = useState<SortField>('date');\n  const [sortDirection, setSortDirection] = useState<SortDirection>('desc');\n  const [currentPage, setCurrentPage] = useState(1);\n  const itemsPerPage = 20;\n\n  // Filter and sort transactions (optimized)\n  const filteredAndSortedTransactions = useMemo(() => {\n    // Early return if no transactions\n    if (!transactions || transactions.length === 0) return [];\n    \n    let filtered = transactions;\n\n    // Apply filters with optimized string operations\n    if (filters.search) {\n      const search = filters.search.toLowerCase();\n      filtered = filtered.filter(t => {\n        const category = t.category?.toLowerCase() || '';\n        const description = t.description?.toLowerCase() || '';\n        const memberName = t.memberName?.toLowerCase() || '';\n        return category.includes(search) || description.includes(search) || memberName.includes(search);\n      });\n    }\n\n    if (filters.type && filters.type !== 'ALL') {\n      filtered = filtered.filter(t => t.type === filters.type);\n    }\n\n    if (filters.category) {\n      filtered = filtered.filter(t => t.category === filters.category);\n    }\n\n    if (filters.method && filters.method !== 'ALL') {\n      filtered = filtered.filter(t => t.method === filters.method);\n    }\n\n    if (filters.memberId) {\n      filtered = filtered.filter(t => t.memberId === filters.memberId);\n    }\n\n    if (filters.dateFrom) {\n      filtered = filtered.filter(t => t.date >= filters.dateFrom!);\n    }\n\n    if (filters.dateTo) {\n      filtered = filtered.filter(t => t.date <= filters.dateTo!);\n    }\n\n    if (filters.amountMin) {\n      filtered = filtered.filter(t => t.amount >= filters.amountMin!);\n    }\n\n    if (filters.amountMax) {\n      filtered = filtered.filter(t => t.amount <= filters.amountMax!);\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      let aValue: any, bValue: any;\n      \n      switch (sortField) {\n        case 'date':\n          aValue = new Date(a.date);\n          bValue = new Date(b.date);\n          break;\n        case 'amount':\n          aValue = a.amount;\n          bValue = b.amount;\n          break;\n        case 'category':\n          aValue = a.category;\n          bValue = b.category;\n          break;\n        case 'type':\n          aValue = a.type;\n          bValue = b.type;\n          break;\n        default:\n          return 0;\n      }\n\n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n\n    return filtered;\n  }, [transactions, filters, sortField, sortDirection]);\n\n  // Pagination\n  const totalPages = Math.ceil(filteredAndSortedTransactions.length / itemsPerPage);\n  const paginatedTransactions = filteredAndSortedTransactions.slice(\n    (currentPage - 1) * itemsPerPage,\n    currentPage * itemsPerPage\n  );\n\n  const handleSort = (field: SortField) => {\n    if (field === sortField) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const SortIcon = ({ field }: { field: SortField }) => {\n    if (sortField !== field) return null;\n    return sortDirection === 'asc' ? \n      <ChevronUp className=\"w-4 h-4\" /> : \n      <ChevronDown className=\"w-4 h-4\" />;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"animate-pulse\">\n        <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded mb-4\"></div>\n        {Array.from({ length: 5 }).map((_, i) => (\n          <div key={i} className=\"h-12 bg-gray-100 dark:bg-gray-800 rounded mb-2\"></div>\n        ))}\n      </div>\n    );\n  }\n\n  if (filteredAndSortedTransactions.length === 0) {\n    return (\n      <EmptyState\n        title=\"Geen transacties gevonden\"\n        description=\"Er zijn geen transacties die voldoen aan de geselecteerde filters.\"\n      />\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Table */}\n      <div className=\"glass-card card-hover animate-fade-in group rounded-lg border-0 overflow-hidden\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50 select-none\"\n                onClick={() => handleSort('date')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Datum\n                  <SortIcon field=\"date\" />\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50 select-none\"\n                onClick={() => handleSort('type')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Type\n                  <SortIcon field=\"type\" />\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50 select-none\"\n                onClick={() => handleSort('category')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Categorie\n                  <SortIcon field=\"category\" />\n                </div>\n              </TableHead>\n              <TableHead>Lid</TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50 select-none text-right\"\n                onClick={() => handleSort('amount')}\n              >\n                <div className=\"flex items-center justify-end gap-2\">\n                  Bedrag\n                  <SortIcon field=\"amount\" />\n                </div>\n              </TableHead>\n              <TableHead>Methode</TableHead>\n              <TableHead>Omschrijving</TableHead>\n              <TableHead className=\"text-right\">Acties</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {paginatedTransactions.map((transaction) => (\n              <TableRow \n                key={transaction.id}\n                className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-900\"\n                onClick={() => onTransactionSelect(transaction)}\n                data-testid={`row-transaction-${transaction.id}`}\n              >\n                <TableCell className=\"font-medium\">\n                  {formatDateBE(transaction.date)}\n                </TableCell>\n                <TableCell>\n                  {transaction.type === 'INCOME' ? 'Inkomsten' : 'Uitgaven'}\n                </TableCell>\n                <TableCell>{transaction.category}</TableCell>\n                <TableCell className={transaction.memberName ? \"text-gray-900 dark:text-gray-100\" : \"text-gray-400\"}>\n                  {transaction.memberName || '-'}\n                </TableCell>\n                <TableCell className={`text-right font-medium ${transaction.type === 'INCOME' \n                  ? 'text-green-600 dark:text-green-400' \n                  : 'text-red-600 dark:text-red-400'\n                }`}>\n                  {transaction.type === 'INCOME' ? '+' : '-'}{formatCurrencyBE(transaction.amount)}\n                </TableCell>\n                <TableCell>\n                  {transaction.method === 'SEPA' ? 'SEPA' : \n                   transaction.method === 'OVERSCHRIJVING' ? 'Overschrijving' : \n                   transaction.method === 'BANCONTACT' ? 'Bancontact' : 'Contant'}\n                </TableCell>\n                <TableCell className=\"max-w-[200px] truncate\">\n                  {transaction.description || '-'}\n                </TableCell>\n                <TableCell>\n                  <RowActions\n                    transaction={transaction}\n                    onEdit={onTransactionEdit}\n                    onDelete={onTransactionDelete}\n                    onView={onTransactionSelect}\n                  />\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-between\">\n          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n            Toont {(currentPage - 1) * itemsPerPage + 1} tot {Math.min(currentPage * itemsPerPage, filteredAndSortedTransactions.length)} van {filteredAndSortedTransactions.length} transacties\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n              disabled={currentPage === 1}\n              data-testid=\"button-prev-page\"\n            >\n              Vorige\n            </Button>\n            <div className=\"flex items-center px-3 text-sm\">\n              Pagina {currentPage} van {totalPages}\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\n              disabled={currentPage === totalPages}\n              data-testid=\"button-next-page\"\n            >\n              Volgende\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nexport { TransactionsTable };","size_bytes":10374},"client/src/components/ui/ConfirmDialog.tsx":{"content":"\"use client\";\n\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface ConfirmDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title?: string;\n  description?: string;\n  confirmText?: string;\n  cancelText?: string;\n  variant?: 'default' | 'destructive';\n}\n\nexport function ConfirmDialog({\n  open,\n  onClose,\n  onConfirm,\n  title = \"Weet je het zeker?\",\n  description = \"Deze actie kan niet ongedaan worden gemaakt.\",\n  confirmText = \"Doorgaan\",\n  cancelText = \"Annuleren\",\n  variant = 'default'\n}: ConfirmDialogProps) {\n  const handleConfirm = () => {\n    onConfirm();\n    onClose();\n  };\n\n  return (\n    <AlertDialog open={open} onOpenChange={onClose}>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{title}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {description}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={onClose}>\n            {cancelText}\n          </AlertDialogCancel>\n          <AlertDialogAction\n            onClick={handleConfirm}\n            className={variant === 'destructive' \n              ? 'bg-red-600 hover:bg-red-700 dark:bg-red-600 dark:hover:bg-red-700' \n              : ''\n            }\n          >\n            {confirmText}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}","size_bytes":1607},"client/src/components/ui/EmptyState.tsx":{"content":"import { FileX, Plus } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface EmptyStateProps {\n  title: string;\n  description: string;\n  actionText?: string;\n  onAction?: () => void;\n  icon?: React.ReactNode;\n}\n\nexport function EmptyState({\n  title,\n  description,\n  actionText,\n  onAction,\n  icon\n}: EmptyStateProps) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n        {title}\n      </h3>\n      <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n        {description}\n      </p>\n      {actionText && onAction && (\n        <Button onClick={onAction} className=\"gap-2\">\n          <Plus className=\"w-4 h-4\" />\n          {actionText}\n        </Button>\n      )}\n    </div>\n  );\n}","size_bytes":851},"client/src/components/ui/ErrorState.tsx":{"content":"import { AlertCircle, RefreshCw } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface ErrorStateProps {\n  title?: string;\n  description?: string;\n  onRetry?: () => void;\n}\n\nexport function ErrorState({\n  title = \"Er is een fout opgetreden\",\n  description = \"We konden de gegevens niet laden. Probeer het opnieuw.\",\n  onRetry\n}: ErrorStateProps) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n      <div className=\"flex items-center justify-center w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full mb-4\">\n        <AlertCircle className=\"w-8 h-8 text-red-500\" />\n      </div>\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n        {title}\n      </h3>\n      <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n        {description}\n      </p>\n      {onRetry && (\n        <Button onClick={onRetry} variant=\"outline\" className=\"gap-2\">\n          <RefreshCw className=\"w-4 h-4\" />\n          Opnieuw proberen\n        </Button>\n      )}\n    </div>\n  );\n}","size_bytes":1076},"client/src/components/ui/MethodChip.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface MethodChipProps {\n  method: 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n  className?: string;\n}\n\nconst methodConfig = {\n  SEPA: {\n    label: 'SEPA',\n    className: \"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400\"\n  },\n  OVERSCHRIJVING: {\n    label: 'Overschrijving',\n    className: \"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400\"\n  },\n  BANCONTACT: {\n    label: 'Bancontact',\n    className: \"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400\"\n  },\n  CASH: {\n    label: 'Contant',\n    className: \"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400\"\n  }\n};\n\nexport function MethodChip({ method, className }: MethodChipProps) {\n  const config = methodConfig[method];\n  \n  return (\n    <div\n      className={cn(\n        \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\",\n        config.className,\n        className\n      )}\n    >\n      {config.label}\n    </div>\n  );\n}","size_bytes":1022},"client/src/components/ui/StatusChip.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface StatusChipProps {\n  type: 'INCOME' | 'EXPENSE';\n  className?: string;\n}\n\nexport function StatusChip({ type, className }: StatusChipProps) {\n  return (\n    <div\n      className={cn(\n        \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\",\n        type === 'INCOME'\n          ? \"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400\"\n          : \"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400\",\n        className\n      )}\n    >\n      {type === 'INCOME' ? 'Inkomsten' : 'Uitgaven'}\n    </div>\n  );\n}","size_bytes":597},"client/src/lib/csv.ts":{"content":"export interface CSVRow {\n  [key: string]: string;\n}\n\nexport interface CSVParseResult {\n  headers: string[];\n  rows: CSVRow[];\n  success: boolean;\n  error?: string;\n}\n\n/**\n * Simple CSV parser for import functionality\n */\nexport function parseCSV(csvContent: string): CSVParseResult {\n  try {\n    const lines = csvContent.trim().split('\\n');\n    if (lines.length < 2) {\n      return {\n        headers: [],\n        rows: [],\n        success: false,\n        error: 'CSV moet minimaal een header en één rij bevatten'\n      };\n    }\n\n    // Parse headers\n    const headers = lines[0].split(';').map(h => h.trim().replace(/\"/g, ''));\n    \n    // Parse rows\n    const rows: CSVRow[] = [];\n    for (let i = 1; i < lines.length; i++) {\n      const line = lines[i].trim();\n      if (!line) continue;\n      \n      const values = line.split(';').map(v => v.trim().replace(/\"/g, ''));\n      const row: CSVRow = {};\n      \n      headers.forEach((header, index) => {\n        row[header] = values[index] || '';\n      });\n      \n      rows.push(row);\n    }\n\n    return {\n      headers,\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van CSV bestand'\n    };\n  }\n}\n\n/**\n * Mock MT940 parser (simplified for demo)\n */\nexport function parseMT940(content: string): CSVParseResult {\n  // Mock implementation - in real app would parse MT940 format\n  try {\n    const lines = content.split('\\n').filter(line => line.trim());\n    const rows: CSVRow[] = [];\n    \n    // Simple mock parsing - extract transaction-like lines\n    lines.forEach((line, index) => {\n      if (line.includes(':61:') || line.includes(':86:')) {\n        rows.push({\n          datum: `2025-01-${(index % 28) + 1}`,\n          bedrag: (Math.random() * 1000).toFixed(2),\n          omschrijving: `MT940 transactie ${index}`,\n          type: Math.random() > 0.5 ? 'Credit' : 'Debet'\n        });\n      }\n    });\n\n    return {\n      headers: ['datum', 'bedrag', 'omschrijving', 'type'],\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van MT940 bestand'\n    };\n  }\n}\n\n/**\n * Mock CODA parser (simplified for demo)\n */\nexport function parseCODA(content: string): CSVParseResult {\n  // Mock implementation - in real app would parse CODA format\n  try {\n    const lines = content.split('\\n').filter(line => line.trim());\n    const rows: CSVRow[] = [];\n    \n    // Simple mock parsing\n    lines.forEach((line, index) => {\n      if (line.startsWith('21') || line.startsWith('22')) {\n        rows.push({\n          datum: `2025-01-${(index % 28) + 1}`,\n          bedrag: (Math.random() * 1000).toFixed(2),\n          omschrijving: `CODA transactie ${index}`,\n          type: Math.random() > 0.5 ? 'C' : 'D'\n        });\n      }\n    });\n\n    return {\n      headers: ['datum', 'bedrag', 'omschrijving', 'type'],\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van CODA bestand'\n    };\n  }\n}\n\n/**\n * Export transactions to CSV\n */\nexport function exportToCSV(data: any[], filename: string = 'transacties.csv'): void {\n  if (data.length === 0) return;\n  \n  const headers = Object.keys(data[0]);\n  const csvContent = [\n    headers.join(';'),\n    ...data.map(row => \n      headers.map(header => {\n        const value = row[header];\n        return typeof value === 'string' && value.includes(';') \n          ? `\"${value}\"` \n          : value;\n      }).join(';')\n    )\n  ].join('\\n');\n  \n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n  const link = document.createElement('a');\n  link.href = URL.createObjectURL(blob);\n  link.download = filename;\n  link.click();\n  URL.revokeObjectURL(link.href);\n}","size_bytes":3903},"client/src/lib/mock/fees-store.ts":{"content":"export type FeeStatus = 'OPEN' | 'PAID' | 'OVERDUE';\nexport type PaymentMethod = 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n\nexport type Fee = {\n  id: string;\n  memberId: string;\n  memberNumber: string;\n  memberName: string;\n  periodStart: string; // ISO\n  periodEnd: string;   // ISO\n  amount: number;      // in € for mock\n  method: PaymentMethod;\n  status: FeeStatus;\n  paidAt?: string;\n  sepaEligible?: boolean;\n  note?: string;\n};\n\n// In-memory store\nlet fees: Fee[] = [\n  {\n    id: 'f1',\n    memberId: 'm1',\n    memberNumber: '0001',\n    memberName: 'Emma van der Berg',\n    periodStart: '2024-01-01',\n    periodEnd: '2024-12-31',\n    amount: 120.00,\n    method: 'SEPA',\n    status: 'PAID',\n    paidAt: '2024-01-15',\n    sepaEligible: true\n  },\n  {\n    id: 'f2', \n    memberId: 'm3',\n    memberNumber: '0003',\n    memberName: 'Fatima El Amrani',\n    periodStart: '2024-06-01',\n    periodEnd: '2024-06-30',\n    amount: 25.00,\n    method: 'OVERSCHRIJVING',\n    status: 'OPEN',\n    sepaEligible: false\n  }\n];\n\nexport function createFee(payload: {\n  memberId: string;\n  memberNumber: string;\n  memberName: string;\n  periodStart: string;\n  periodEnd: string;\n  amount: number;\n  method: PaymentMethod;\n  sepaEligible?: boolean;\n  note?: string;\n}): Fee {\n  const newFee: Fee = {\n    id: `f${Date.now()}`,\n    ...payload,\n    status: 'OPEN'\n  };\n  \n  fees.push(newFee);\n  return newFee;\n}\n\nexport function markPaid(id: string, paidAt: string): void {\n  const fee = fees.find(f => f.id === id);\n  if (fee) {\n    fee.status = 'PAID';\n    fee.paidAt = paidAt;\n  }\n}\n\nexport function listFees(): Fee[] {\n  return [...fees];\n}\n\nexport function overlaps(memberId: string, startISO: string, endISO: string): boolean {\n  const start = new Date(startISO);\n  const end = new Date(endISO);\n  \n  return fees.some(fee => {\n    if (fee.memberId !== memberId) return false;\n    \n    const feeStart = new Date(fee.periodStart);\n    const feeEnd = new Date(fee.periodEnd);\n    \n    // Check if periods overlap\n    return start <= feeEnd && end >= feeStart;\n  });\n}","size_bytes":2057},"client/src/lib/mock/members-lite.ts":{"content":"export type MemberLite = {\n  id: string;\n  memberNumber: string;\n  firstName: string;\n  lastName: string;\n  category: 'Senior' | 'Standaard' | 'Student' | 'Jeugd';\n  hasMandate: boolean;\n  iban?: string;\n};\n\nexport const membersLite: MemberLite[] = [\n  { \n    id: 'm1', \n    memberNumber: '0001', \n    firstName: 'Emma', \n    lastName: 'van der Berg', \n    category: 'Senior', \n    hasMandate: true, \n    iban: 'BE71 0961 2345 6769' \n  },\n  { \n    id: 'm2', \n    memberNumber: '0002', \n    firstName: 'Lars', \n    lastName: 'Jansen', \n    category: 'Jeugd', \n    hasMandate: false \n  },\n  { \n    id: 'm3', \n    memberNumber: '0003', \n    firstName: 'Fatima', \n    lastName: 'El Amrani', \n    category: 'Standaard', \n    hasMandate: true,\n    iban: 'BE68 5390 0754 7034'\n  },\n  { \n    id: 'm4', \n    memberNumber: '0004', \n    firstName: 'Ahmed', \n    lastName: 'Hassan', \n    category: 'Standaard', \n    hasMandate: true,\n    iban: 'BE02 2100 0012 3456'\n  },\n  { \n    id: 'm5', \n    memberNumber: '0005', \n    firstName: 'Sophie', \n    lastName: 'Dubois', \n    category: 'Student', \n    hasMandate: false\n  },\n  { \n    id: 'm6', \n    memberNumber: '0006', \n    firstName: 'Omar', \n    lastName: 'Benali', \n    category: 'Standaard', \n    hasMandate: true,\n    iban: 'BE45 2300 1234 5678'\n  },\n  { \n    id: 'm7', \n    memberNumber: '0007', \n    firstName: 'Maria', \n    lastName: 'Rodriguez', \n    category: 'Senior', \n    hasMandate: false\n  },\n  { \n    id: 'm8', \n    memberNumber: '0008', \n    firstName: 'Ibrahim', \n    lastName: 'Yilmaz', \n    category: 'Standaard', \n    hasMandate: true,\n    iban: 'BE12 0001 2345 6789'\n  }\n];","size_bytes":1632},"client/src/lib/mock/transactions.ts":{"content":"export type Transaction = {\n  id: string;\n  date: string; // ISO\n  type: 'INCOME' | 'EXPENSE';\n  category: string;\n  memberId?: string;\n  memberName?: string;\n  amount: number; // €\n  method: 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n  description?: string;\n};\n\nexport const categories = {\n  INCOME: [\n    'Lidgeld',\n    'Donatie',\n    'Evenement',\n    'Verhuur',\n    'Subsidie',\n    'Verkoop',\n    'Overig inkomen'\n  ],\n  EXPENSE: [\n    'Huur',\n    'Nutsvoorzieningen',\n    'Onderhoud',\n    'Evenement',\n    'Administratie',\n    'Verzekeringen',\n    'Schoonmaak',\n    'Overig uitgaven'\n  ]\n};\n\n// Mock members voor selectie\nexport const mockMembers = [\n  { id: 'm1', name: 'Emma van den Berg' },\n  { id: 'm2', name: 'Ahmed Hassan' },\n  { id: 'm3', name: 'Maria Santos' },\n  { id: 'm4', name: 'Jan Peeters' },\n  { id: 'm5', name: 'Fatima Al-Rashid' },\n  { id: 'm6', name: 'Pieter Vandenberghe' },\n  { id: 'm7', name: 'Layla Benali' },\n  { id: 'm8', name: 'Thomas De Vries' },\n  { id: 'm9', name: 'Zeinab Khalil' },\n  { id: 'm10', name: 'Lucas Martens' }\n];\n\n// Generate comprehensive mock transaction data\nexport const transactions: Transaction[] = [\n  // Januari 2025 - Inkomsten\n  { id: 't1', date: '2025-01-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm1', memberName: 'Emma van den Berg', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't2', date: '2025-01-13', type: 'INCOME', category: 'Lidgeld', memberId: 'm2', memberName: 'Ahmed Hassan', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't3', date: '2025-01-14', type: 'INCOME', category: 'Lidgeld', memberId: 'm3', memberName: 'Maria Santos', amount: 120, method: 'OVERSCHRIJVING', description: 'Lidgeld 2025' },\n  { id: 't4', date: '2025-01-15', type: 'INCOME', category: 'Lidgeld', memberId: 'm4', memberName: 'Jan Peeters', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't5', date: '2025-01-16', type: 'INCOME', category: 'Lidgeld', memberId: 'm5', memberName: 'Fatima Al-Rashid', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't6', date: '2025-01-20', type: 'INCOME', category: 'Donatie', amount: 250, method: 'CASH', description: 'Vrijwillige gift ramadan' },\n  { id: 't7', date: '2025-01-22', type: 'INCOME', category: 'Donatie', amount: 500, method: 'OVERSCHRIJVING', description: 'Donatie moskee renovatie' },\n  { id: 't8', date: '2025-01-25', type: 'INCOME', category: 'Evenement', amount: 1250, method: 'BANCONTACT', description: 'Nieuwjaarsbijeenkomst inschrijvingen' },\n  { id: 't9', date: '2025-01-28', type: 'INCOME', category: 'Verhuur', amount: 300, method: 'OVERSCHRIJVING', description: 'Zaalhuur bruiloft weekend' },\n\n  // Januari 2025 - Uitgaven\n  { id: 't10', date: '2025-01-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur januari 2025' },\n  { id: 't11', date: '2025-01-18', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 180, method: 'OVERSCHRIJVING', description: 'Elektriciteit januari' },\n  { id: 't12', date: '2025-01-20', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 85, method: 'OVERSCHRIJVING', description: 'Gas verwarming januari' },\n  { id: 't13', date: '2025-01-22', type: 'EXPENSE', category: 'Onderhoud', amount: 320, method: 'BANCONTACT', description: 'Loodgieter sanitair reparatie' },\n  { id: 't14', date: '2025-01-24', type: 'EXPENSE', category: 'Schoonmaak', amount: 150, method: 'CASH', description: 'Schoonmaakproducten en materiaal' },\n  { id: 't15', date: '2025-01-26', type: 'EXPENSE', category: 'Administratie', amount: 45, method: 'OVERSCHRIJVING', description: 'Bankkosten en administratie' },\n  { id: 't16', date: '2025-01-30', type: 'EXPENSE', category: 'Evenement', amount: 280, method: 'CASH', description: 'Catering nieuwjaarsbijeenkomst' },\n\n  // December 2024 - Voor historische data\n  { id: 't17', date: '2024-12-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm6', memberName: 'Pieter Vandenberghe', amount: 120, method: 'SEPA', description: 'Lidgeld december 2024' },\n  { id: 't18', date: '2024-12-15', type: 'INCOME', category: 'Lidgeld', memberId: 'm7', memberName: 'Layla Benali', amount: 120, method: 'SEPA', description: 'Lidgeld december 2024' },\n  { id: 't19', date: '2024-12-18', type: 'INCOME', category: 'Subsidie', amount: 2500, method: 'OVERSCHRIJVING', description: 'Gemeentelijke subsidie religieuze activiteiten' },\n  { id: 't20', date: '2024-12-22', type: 'INCOME', category: 'Donatie', amount: 800, method: 'OVERSCHRIJVING', description: 'Eid al-Mawlid donaties' },\n  \n  { id: 't21', date: '2024-12-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur december 2024' },\n  { id: 't22', date: '2024-12-20', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 220, method: 'OVERSCHRIJVING', description: 'Elektriciteit december (verwarming)' },\n  { id: 't23', date: '2024-12-25', type: 'EXPENSE', category: 'Evenement', amount: 450, method: 'CASH', description: 'Eid al-Mawlid viering kosten' },\n\n  // November 2024\n  { id: 't24', date: '2024-11-10', type: 'INCOME', category: 'Lidgeld', memberId: 'm8', memberName: 'Thomas De Vries', amount: 120, method: 'SEPA', description: 'Lidgeld november 2024' },\n  { id: 't25', date: '2024-11-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm9', memberName: 'Zeinab Khalil', amount: 120, method: 'SEPA', description: 'Lidgeld november 2024' },\n  { id: 't26', date: '2024-11-18', type: 'INCOME', category: 'Verkoop', amount: 320, method: 'BANCONTACT', description: 'Verkoop islamitische boeken en materiaal' },\n  \n  { id: 't27', date: '2024-11-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur november 2024' },\n  { id: 't28', date: '2024-11-22', type: 'EXPENSE', category: 'Verzekeringen', amount: 180, method: 'OVERSCHRIJVING', description: 'Gebouwverzekering kwartaal' },\n  { id: 't29', date: '2024-11-25', type: 'EXPENSE', category: 'Onderhoud', amount: 125, method: 'CASH', description: 'Kleine herstellingen en onderhoud' },\n\n  // Oktober 2024\n  { id: 't30', date: '2024-10-08', type: 'INCOME', category: 'Lidgeld', memberId: 'm10', memberName: 'Lucas Martens', amount: 120, method: 'SEPA', description: 'Lidgeld oktober 2024' },\n  { id: 't31', date: '2024-10-12', type: 'INCOME', category: 'Evenement', amount: 890, method: 'BANCONTACT', description: 'Islamitische cursussen inschrijvingen' },\n  { id: 't32', date: '2024-10-20', type: 'INCOME', category: 'Donatie', amount: 650, method: 'OVERSCHRIJVING', description: 'Donaties gebedsruimte uitbreiding' },\n  \n  { id: 't33', date: '2024-10-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur oktober 2024' },\n  { id: 't34', date: '2024-10-18', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 145, method: 'OVERSCHRIJVING', description: 'Elektriciteit oktober' },\n  { id: 't35', date: '2024-10-25', type: 'EXPENSE', category: 'Administratie', amount: 85, method: 'OVERSCHRIJVING', description: 'Boekhouding en administratieve kosten' },\n\n  // Extra transacties voor completere dataset\n  { id: 't36', date: '2024-09-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur september 2024' },\n  { id: 't37', date: '2024-09-20', type: 'INCOME', category: 'Verhuur', amount: 450, method: 'OVERSCHRIJVING', description: 'Zaalhuur evenement weekend' },\n  { id: 't38', date: '2024-08-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur augustus 2024' },\n  { id: 't39', date: '2024-08-25', type: 'INCOME', category: 'Donatie', amount: 1500, method: 'OVERSCHRIJVING', description: 'Eid al-Adha donaties' },\n  { id: 't40', date: '2024-07-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur juli 2024' },\n\n  // Meer recente transacties voor uitgebreidere data\n  { id: 't41', date: '2025-01-31', type: 'INCOME', category: 'Lidgeld', memberId: 'm1', memberName: 'Emma van den Berg', amount: 120, method: 'SEPA', description: 'Lidgeld februari vooruitbetaling' },\n  { id: 't42', date: '2025-01-29', type: 'EXPENSE', category: 'Schoonmaak', amount: 200, method: 'CASH', description: 'Extra schoonmaak na evenement' },\n  { id: 't43', date: '2025-01-27', type: 'INCOME', category: 'Donatie', amount: 75, method: 'CASH', description: 'Vrijdaggebed collecte' },\n  { id: 't44', date: '2025-01-26', type: 'EXPENSE', category: 'Onderhoud', amount: 95, method: 'BANCONTACT', description: 'Vervangingslampen LED verlichting' },\n  { id: 't45', date: '2025-01-24', type: 'INCOME', category: 'Donatie', amount: 150, method: 'CASH', description: 'Vrijdaggebed collecte' }\n];\n\nexport function generateTransactionId(): string {\n  return 't' + Date.now() + Math.random().toString(36).substr(2, 9);\n}\n\nexport function getTransactionsByDateRange(startDate: string, endDate: string): Transaction[] {\n  return transactions.filter(t => t.date >= startDate && t.date <= endDate);\n}\n\nexport function getTransactionsByType(type: 'INCOME' | 'EXPENSE'): Transaction[] {\n  return transactions.filter(t => t.type === type);\n}\n\nexport function getTransactionsByCategory(category: string): Transaction[] {\n  return transactions.filter(t => t.category === category);\n}\n\nexport function getTotalByType(type: 'INCOME' | 'EXPENSE'): number {\n  return transactions\n    .filter(t => t.type === type)\n    .reduce((sum, t) => sum + t.amount, 0);\n}\n\nexport function getMonthlyTotals(): { month: string; income: number; expense: number }[] {\n  const monthlyData: { [key: string]: { income: number; expense: number } } = {};\n  \n  transactions.forEach(t => {\n    const date = new Date(t.date);\n    const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n    \n    if (!monthlyData[monthKey]) {\n      monthlyData[monthKey] = { income: 0, expense: 0 };\n    }\n    \n    if (t.type === 'INCOME') {\n      monthlyData[monthKey].income += t.amount;\n    } else {\n      monthlyData[monthKey].expense += t.amount;\n    }\n  });\n  \n  return Object.entries(monthlyData)\n    .sort(([a], [b]) => a.localeCompare(b))\n    .map(([month, data]) => ({\n      month,\n      ...data\n    }));\n}\n\nexport function getCategoryTotals(type: 'INCOME' | 'EXPENSE'): { category: string; amount: number }[] {\n  const categoryData: { [key: string]: number } = {};\n  \n  transactions\n    .filter(t => t.type === type)\n    .forEach(t => {\n      categoryData[t.category] = (categoryData[t.category] || 0) + t.amount;\n    });\n  \n  return Object.entries(categoryData)\n    .map(([category, amount]) => ({ category, amount }))\n    .sort((a, b) => b.amount - a.amount);\n}","size_bytes":10731},"client/src/lib/zod/transaction.ts":{"content":"import { z } from 'zod';\n\nexport const TransactionSchema = z.object({\n  type: z.enum(['INCOME', 'EXPENSE'], {\n    required_error: 'Type is verplicht',\n    invalid_type_error: 'Selecteer Inkomsten of Uitgaven'\n  }),\n  date: z.string().min(1, 'Datum is verplicht'),\n  category: z.string().min(2, 'Categorie moet minimaal 2 karakters bevatten'),\n  amount: z.number({\n    required_error: 'Bedrag is verplicht',\n    invalid_type_error: 'Bedrag moet een getal zijn'\n  }).positive('Bedrag moet groter zijn dan 0'),\n  method: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH'], {\n    required_error: 'Betaalmethode is verplicht'\n  }),\n  memberId: z.string().optional(),\n  memberName: z.string().optional(),\n  description: z.string().max(500, 'Omschrijving mag maximaal 500 karakters bevatten').optional()\n});\n\nexport type TransactionFormData = z.infer<typeof TransactionSchema>;\n\nexport const ImportMappingSchema = z.object({\n  dateColumn: z.string().min(1, 'Selecteer een datumkolom'),\n  amountColumn: z.string().min(1, 'Selecteer een bedragkolom'),\n  descriptionColumn: z.string().optional(),\n  categoryColumn: z.string().optional()\n});\n\nexport type ImportMappingData = z.infer<typeof ImportMappingSchema>;\n\nexport const FilterSchema = z.object({\n  search: z.string().optional(),\n  type: z.enum(['ALL', 'INCOME', 'EXPENSE']).optional().default('ALL'),\n  category: z.string().optional(),\n  method: z.enum(['ALL', 'SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']).optional().default('ALL'),\n  memberId: z.string().optional(),\n  dateFrom: z.string().optional(),\n  dateTo: z.string().optional(),\n  amountMin: z.number().optional(),\n  amountMax: z.number().optional()\n});\n\nexport type FilterData = z.infer<typeof FilterSchema>;","size_bytes":1720},"client/src/pages/FinancePage.tsx":{"content":"\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { KpiCards } from \"@/components/finance/KpiCards\";\nimport { Toolbar } from \"@/components/finance/Toolbar\";\nimport { FiltersToolbar } from \"@/components/finance/FiltersDrawer\";\nimport { TransactionsTable } from \"@/components/finance/TransactionsTable\";\nimport { DetailSlideOver } from \"@/components/finance/DetailSlideOver\";\nimport { TransactionDetailDialog } from \"@/components/finance/TransactionDetailDialog\";\nimport { NewTransactionDialog } from \"@/components/finance/NewTransactionDialog\";\nimport { ImportDialog } from \"@/components/finance/ImportDialog\";\nimport { ExportDialog } from \"@/components/finance/ExportDialog\";\nimport { JournalView } from \"@/components/finance/JournalView\";\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\nimport { FilterData } from \"@/lib/zod/transaction\";\nimport { Plus, BarChart3, BookOpen, RefreshCw, PieChart } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function FinancePage() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // State management - now using real API data\n  const [selectedTransaction, setSelectedTransaction] = useState<any | null>(null);\n  const [editTransaction, setEditTransaction] = useState<any | null>(null);\n  const [deleteTransactionId, setDeleteTransactionId] = useState<string>('');\n  \n  // UI state\n  const [showDetailSlideOver, setShowDetailSlideOver] = useState(false);\n  const [showDetailDialog, setShowDetailDialog] = useState(false);\n  const [showNewTransactionDialog, setShowNewTransactionDialog] = useState(false);\n  const [showImportDialog, setShowImportDialog] = useState(false);\n  const [showExportDialog, setShowExportDialog] = useState(false);\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [activeTab, setActiveTab] = useState('overview');\n  \n  // Filter state\n  const [filters, setFilters] = useState<FilterData>({\n    search: '',\n    type: 'ALL',\n    category: undefined,\n    method: 'ALL',\n    memberId: undefined,\n    dateFrom: undefined,\n    dateTo: undefined,\n    amountMin: undefined,\n    amountMax: undefined\n  });\n\n  // Period filter state\n  const [periodFilter, setPeriodFilter] = useState('ALL');\n  \n  // Fetch transactions from API\n  const { data: transactions = [], isLoading } = useQuery({\n    queryKey: [\"/api/transactions\"],\n  });\n\n  // Apply period filters to date range\n  const getDateRangeFromPeriod = (period: string) => {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = now.getMonth();\n    \n    switch (period) {\n      case 'THIS_MONTH':\n        return {\n          dateFrom: new Date(year, month, 1).toISOString().split('T')[0],\n          dateTo: new Date(year, month + 1, 0).toISOString().split('T')[0]\n        };\n      case 'LAST_MONTH':\n        return {\n          dateFrom: new Date(year, month - 1, 1).toISOString().split('T')[0],\n          dateTo: new Date(year, month, 0).toISOString().split('T')[0]\n        };\n      case 'THIS_YEAR':\n        return {\n          dateFrom: new Date(year, 0, 1).toISOString().split('T')[0],\n          dateTo: new Date(year, 11, 31).toISOString().split('T')[0]\n        };\n      case 'LAST_YEAR':\n        return {\n          dateFrom: new Date(year - 1, 0, 1).toISOString().split('T')[0],\n          dateTo: new Date(year - 1, 11, 31).toISOString().split('T')[0]\n        };\n      default:\n        return {};\n    }\n  };\n\n  // Combined filters with period\n  const effectiveFilters = useMemo(() => {\n    const periodDates = getDateRangeFromPeriod(periodFilter);\n    return {\n      ...filters,\n      ...periodDates\n    };\n  }, [filters, periodFilter]);\n\n  // Filtered transactions\n  const filteredTransactions = useMemo(() => {\n    if (!Array.isArray(transactions)) return [];\n    return transactions.filter((transaction: any) => {\n      // Apply all filters here for consistency across components\n      if (effectiveFilters.search) {\n        const search = effectiveFilters.search.toLowerCase();\n        const matchesSearch = \n          transaction.category.toLowerCase().includes(search) ||\n          (transaction.description?.toLowerCase().includes(search)) ||\n          (transaction.memberName?.toLowerCase().includes(search));\n        if (!matchesSearch) return false;\n      }\n\n      if (effectiveFilters.type && effectiveFilters.type !== 'ALL') {\n        if (transaction.type !== effectiveFilters.type) return false;\n      }\n\n      if (effectiveFilters.category) {\n        if (transaction.category !== effectiveFilters.category) return false;\n      }\n\n      if (effectiveFilters.method && effectiveFilters.method !== 'ALL') {\n        if (transaction.method !== effectiveFilters.method) return false;\n      }\n\n      if (effectiveFilters.memberId) {\n        if (transaction.memberId !== effectiveFilters.memberId) return false;\n      }\n\n      if (effectiveFilters.dateFrom) {\n        if (transaction.date < effectiveFilters.dateFrom) return false;\n      }\n\n      if (effectiveFilters.dateTo) {\n        if (transaction.date > effectiveFilters.dateTo) return false;\n      }\n\n      if (effectiveFilters.amountMin) {\n        if (transaction.amount < effectiveFilters.amountMin) return false;\n      }\n\n      if (effectiveFilters.amountMax) {\n        if (transaction.amount > effectiveFilters.amountMax) return false;\n      }\n\n      return true;\n    });\n  }, [transactions, effectiveFilters]);\n\n  // Handlers\n  const handleTransactionSelect = (transaction: any) => {\n    setSelectedTransaction(transaction);\n    setShowDetailDialog(true);\n  };\n\n  const handleTransactionEdit = (transaction: any) => {\n    setEditTransaction(transaction);\n    setShowNewTransactionDialog(true);\n  };\n\n  const handleTransactionDelete = (transactionId: string) => {\n    setDeleteTransactionId(transactionId);\n    setShowDeleteConfirm(true);\n  };\n\n  const deleteTransactionMutation = useMutation({\n    mutationFn: async (transactionId: string) => {\n      const response = await apiRequest(\"DELETE\", `/api/transactions/${transactionId}`, {});\n      return response.json();\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/transactions\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/transactions\"] });\n      await queryClient.invalidateQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      await queryClient.refetchQueries({ queryKey: [\"/api/dashboard/stats\"] });\n      toast({\n        title: \"Transactie verwijderd\",\n        description: \"De transactie is succesvol verwijderd.\",\n      });\n    },\n  });\n\n  const confirmDelete = () => {\n    deleteTransactionMutation.mutate(deleteTransactionId);\n    setDeleteTransactionId('');\n  };\n\n\n\n  const handleImport = (importedTransactions: any[]) => {\n    // For now, just show the notification - bulk import can be implemented later\n    toast({\n      title: \"Import voltooid\",\n      description: `${importedTransactions.length} transacties zijn geïmporteerd.`,\n    });\n  };\n\n  const handleSearch = (search: string) => {\n    setFilters(prev => ({ ...prev, search }));\n  };\n\n  const handleTypeFilter = (type: string) => {\n    setFilters(prev => ({ ...prev, type: type as any }));\n  };\n\n  const handleFiltersChange = (newFilters: FilterData) => {\n    setFilters(newFilters);\n  };\n\n  const handleClearFilters = () => {\n    setFilters({\n      search: '',\n      type: 'ALL',\n      category: undefined,\n      method: 'ALL',\n      memberId: undefined,\n      dateFrom: undefined,\n      dateTo: undefined,\n      amountMin: undefined,\n      amountMax: undefined\n    });\n    setPeriodFilter('ALL');\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">\n              Financiën\n            </h1>\n            <p className=\"mt-2 text-sm text-gray-600 font-medium\">\n              Overzicht van inkomsten en uitgaven\n            </p>\n          </div>\n        </div>\n\n        {/* Main Content Tabs */}\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-4 lg:w-auto lg:grid-cols-4\">\n            <TabsTrigger value=\"overview\" className=\"gap-1 sm:gap-2\" data-testid=\"tab-overview\">\n              <BarChart3 className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Overzicht</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"journal\" className=\"gap-1 sm:gap-2\" data-testid=\"tab-journal\">\n              <BookOpen className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Journaal</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"reconciliation\" className=\"gap-1 sm:gap-2\" data-testid=\"tab-reconciliation\">\n              <RefreshCw className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Reconciliatie</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"reports\" className=\"gap-1 sm:gap-2\" data-testid=\"tab-reports\">\n              <PieChart className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Rapporten</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"overview\" className=\"space-y-8 mt-8\">\n            {/* KPI Cards */}\n            <KpiCards />\n\n            {/* Toolbar */}\n            <Toolbar\n              searchValue={effectiveFilters.search || ''}\n              typeFilter={effectiveFilters.type || 'ALL'}\n              periodFilter={periodFilter}\n              onSearch={handleSearch}\n              onTypeFilter={handleTypeFilter}\n              onPeriodFilter={setPeriodFilter}\n              onNewTransaction={() => setShowNewTransactionDialog(true)}\n              onImport={() => setShowImportDialog(true)}\n              onExport={() => setShowExportDialog(true)}\n              onAdvancedFilters={() => setShowAdvancedFilters(!showAdvancedFilters)}\n              advancedFilters={filters}\n              onAdvancedFiltersChange={handleFiltersChange}\n              onClearAdvancedFilters={handleClearFilters}\n            />\n\n            {/* Transactions Table */}\n            <TransactionsTable\n              transactions={filteredTransactions}\n              filters={effectiveFilters}\n              onTransactionSelect={handleTransactionSelect}\n              onTransactionEdit={handleTransactionEdit}\n              onTransactionDelete={handleTransactionDelete}\n            />\n          </TabsContent>\n\n          <TabsContent value=\"journal\" className=\"space-y-8 mt-8\">\n            {/* Journal View */}\n            <JournalView transactions={filteredTransactions} />\n          </TabsContent>\n\n          <TabsContent value=\"reconciliation\" className=\"space-y-8 mt-8\">\n            {/* Reconciliatie Content */}\n            <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n              <div className=\"text-center py-12\">\n                <RefreshCw className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                  Bankreconciliatie\n                </h3>\n                <p className=\"text-gray-500 max-w-md mx-auto mb-6\">\n                  Importeer bankafschriften, match transacties automatisch met lidgelden en categoriseer uitgaven. \n                  Deze functionaliteit wordt binnenkort beschikbaar gesteld.\n                </p>\n                <div className=\"flex justify-center gap-3\">\n                  <Button variant=\"outline\" disabled>\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Afschrift Importeren\n                  </Button>\n                  <Button variant=\"outline\" disabled>\n                    <BarChart3 className=\"h-4 w-4 mr-2\" />\n                    Transacties Bekijken\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"reports\" className=\"space-y-8 mt-8\">\n            {/* Rapporten Content */}\n            <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n              <div className=\"text-center py-12\">\n                <PieChart className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n                  Financiële Rapporten\n                </h3>\n                <p className=\"text-gray-500 max-w-md mx-auto mb-6\">\n                  Interactieve dashboards met cashflow analyse, categorie breakdowns, \n                  fee status trends en top leden overzichten. Binnenkort beschikbaar.\n                </p>\n                <div className=\"flex justify-center gap-3\">\n                  <Button variant=\"outline\" disabled>\n                    <BarChart3 className=\"h-4 w-4 mr-2\" />\n                    Cashflow Analyse\n                  </Button>\n                  <Button variant=\"outline\" disabled>\n                    <PieChart className=\"h-4 w-4 mr-2\" />\n                    Categorie Breakdown\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n        </Tabs>\n\n        {/* Dialogs and Overlays */}\n        <DetailSlideOver\n          open={showDetailSlideOver}\n          onClose={() => setShowDetailSlideOver(false)}\n          transaction={selectedTransaction}\n          onEdit={handleTransactionEdit}\n          onDelete={handleTransactionDelete}\n        />\n\n        <TransactionDetailDialog\n          open={showDetailDialog}\n          onClose={() => setShowDetailDialog(false)}\n          transaction={selectedTransaction}\n          onEdit={handleTransactionEdit}\n        />\n\n        <NewTransactionDialog\n          open={showNewTransactionDialog}\n          onClose={() => {\n            setShowNewTransactionDialog(false);\n            setEditTransaction(null);\n          }}\n          editTransaction={editTransaction}\n        />\n\n        <ImportDialog\n          open={showImportDialog}\n          onClose={() => setShowImportDialog(false)}\n          onImport={handleImport}\n        />\n\n        <ExportDialog\n          open={showExportDialog}\n          onClose={() => setShowExportDialog(false)}\n          transactions={filteredTransactions}\n        />\n\n        {showAdvancedFilters && (\n          <div className=\"mb-6\">\n            <FiltersToolbar\n              filters={filters}\n              onFiltersChange={handleFiltersChange}\n              onClearFilters={handleClearFilters}\n            />\n          </div>\n        )}\n\n        <ConfirmDialog\n          open={showDeleteConfirm}\n          onClose={() => setShowDeleteConfirm(false)}\n          onConfirm={confirmDelete}\n          title=\"Transactie verwijderen\"\n          description=\"Weet je zeker dat je deze transactie wilt verwijderen? Deze actie kan niet ongedaan worden gemaakt.\"\n          confirmText=\"Verwijderen\"\n          variant=\"destructive\"\n        />\n      </div>\n    </main>\n  );\n}","size_bytes":15438},"components/finance/Charts.tsx":{"content":"\"use client\";\n\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { formatCurrencyBE, formatMonthYearBE } from \"@/lib/format\";\nimport { getMonthlyTotals, getCategoryTotals } from \"@/lib/mock/transactions\";\nimport { \n  LineChart, \n  Line, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  ResponsiveContainer,\n  PieChart,\n  Pie,\n  Cell,\n  Legend\n} from \"recharts\";\nimport { useMemo } from \"react\";\n\nconst COLORS = [\n  '#3B82F6', // blue\n  '#EF4444', // red\n  '#F59E0B', // amber\n  '#10B981', // emerald\n  '#8B5CF6', // violet\n  '#F97316', // orange\n  '#06B6D4', // cyan\n  '#84CC16', // lime\n];\n\nexport function Charts() {\n  const monthlyData = useMemo(() => {\n    const data = getMonthlyTotals();\n    return data.map(item => ({\n      ...item,\n      monthLabel: formatMonthYearBE(`${item.month}-01`)\n    }));\n  }, []);\n\n  const expenseCategories = useMemo(() => {\n    return getCategoryTotals('EXPENSE').map((item, index) => ({\n      ...item,\n      fill: COLORS[index % COLORS.length]\n    }));\n  }, []);\n\n  const CustomTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length) {\n      return (\n        <div className=\"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg\">\n          <p className=\"font-medium mb-2\">{label}</p>\n          {payload.map((entry: any, index: number) => (\n            <div key={index} className=\"flex items-center gap-2\">\n              <div \n                className=\"w-3 h-3 rounded-full\" \n                style={{ backgroundColor: entry.color }}\n              />\n              <span className=\"text-sm\">\n                {entry.name}: {formatCurrencyBE(entry.value)}\n              </span>\n            </div>\n          ))}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  const PieTooltip = ({ active, payload }: any) => {\n    if (active && payload && payload.length) {\n      const data = payload[0];\n      return (\n        <div className=\"bg-white dark:bg-gray-800 p-3 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg\">\n          <p className=\"font-medium\">{data.payload.category}</p>\n          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n            {formatCurrencyBE(data.value)}\n          </p>\n        </div>\n      );\n    }\n    return null;\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n      {/* Line Chart - Income vs Expenses */}\n      <Card className=\"col-span-1\">\n        <CardHeader>\n          <CardTitle>Inkomsten vs Uitgaven</CardTitle>\n          <CardDescription>\n            Maandelijkse ontwikkeling van financiële stromen\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <LineChart data={monthlyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"opacity-30\" />\n                <XAxis \n                  dataKey=\"monthLabel\" \n                  fontSize={12}\n                  tickMargin={8}\n                />\n                <YAxis \n                  fontSize={12}\n                  tickMargin={8}\n                  tickFormatter={(value) => `€${(value / 1000).toFixed(0)}k`}\n                />\n                <Tooltip content={<CustomTooltip />} />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"income\" \n                  stroke=\"#10B981\" \n                  strokeWidth={3}\n                  name=\"Inkomsten\"\n                  dot={{ fill: '#10B981', strokeWidth: 2, r: 4 }}\n                  activeDot={{ r: 6, stroke: '#10B981', strokeWidth: 2 }}\n                />\n                <Line \n                  type=\"monotone\" \n                  dataKey=\"expense\" \n                  stroke=\"#EF4444\" \n                  strokeWidth={3}\n                  name=\"Uitgaven\"\n                  dot={{ fill: '#EF4444', strokeWidth: 2, r: 4 }}\n                  activeDot={{ r: 6, stroke: '#EF4444', strokeWidth: 2 }}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Pie Chart - Expense Categories */}\n      <Card className=\"col-span-1\">\n        <CardHeader>\n          <CardTitle>Uitgaven per Categorie</CardTitle>\n          <CardDescription>\n            Verdeling van uitgaven over verschillende categorieën\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <PieChart>\n                <Pie\n                  data={expenseCategories}\n                  cx=\"50%\"\n                  cy=\"50%\"\n                  labelLine={false}\n                  label={({ category, percent }) => \n                    `${category} (${(percent * 100).toFixed(0)}%)`\n                  }\n                  outerRadius={80}\n                  fill=\"#8884d8\"\n                  dataKey=\"amount\"\n                  className=\"text-xs\"\n                >\n                  {expenseCategories.map((entry, index) => (\n                    <Cell key={`cell-${index}`} fill={entry.fill} />\n                  ))}\n                </Pie>\n                <Tooltip content={<PieTooltip />} />\n              </PieChart>\n            </ResponsiveContainer>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":5440},"components/finance/DetailSlideOver.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle } from \"@/components/ui/sheet\";\nimport { StatusChip } from \"@/components/ui/StatusChip\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { Edit, Trash2, User, Calendar, Tag, CreditCard, FileText } from \"lucide-react\";\n\ninterface DetailSlideOverProps {\n  open: boolean;\n  onClose: () => void;\n  transaction: Transaction | null;\n  onEdit: (transaction: Transaction) => void;\n  onDelete: (transactionId: string) => void;\n}\n\nexport function DetailSlideOver({\n  open,\n  onClose,\n  transaction,\n  onEdit,\n  onDelete\n}: DetailSlideOverProps) {\n  if (!transaction) return null;\n\n  const handleEdit = () => {\n    onEdit(transaction);\n    onClose();\n  };\n\n  const handleDelete = () => {\n    onDelete(transaction.id);\n    onClose();\n  };\n\n  return (\n    <Sheet open={open} onOpenChange={onClose}>\n      <SheetContent className=\"w-[400px] sm:w-[540px]\">\n        <SheetHeader>\n          <SheetTitle className=\"flex items-center gap-3\">\n            <span className={transaction.type === 'INCOME' \n              ? 'text-green-600 dark:text-green-400' \n              : 'text-red-600 dark:text-red-400'\n            }>\n              {formatCurrencyBE(transaction.amount)}\n            </span>\n            <StatusChip type={transaction.type} />\n          </SheetTitle>\n          <SheetDescription>\n            Transactiedetails van {formatDateBE(transaction.date)}\n          </SheetDescription>\n        </SheetHeader>\n        \n        <div className=\"mt-6 space-y-6\">\n          {/* Basic Info */}\n          <div className=\"grid gap-4\">\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <Calendar className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Datum</div>\n                <div className=\"text-gray-600 dark:text-gray-400\">\n                  {formatDateBE(transaction.date)}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <Tag className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Categorie</div>\n                <div className=\"text-gray-600 dark:text-gray-400\">\n                  {transaction.category}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n              <CreditCard className=\"h-5 w-5 text-gray-500\" />\n              <div>\n                <div className=\"text-sm font-medium\">Betaalmethode</div>\n                <div className=\"pt-1\">\n                  <MethodChip method={transaction.method} />\n                </div>\n              </div>\n            </div>\n\n            {transaction.memberName && (\n              <div className=\"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n                <User className=\"h-5 w-5 text-gray-500\" />\n                <div>\n                  <div className=\"text-sm font-medium\">Lid</div>\n                  <div className=\"text-blue-600 dark:text-blue-400\">\n                    {transaction.memberName}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {transaction.description && (\n              <div className=\"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n                <FileText className=\"h-5 w-5 text-gray-500 mt-0.5\" />\n                <div>\n                  <div className=\"text-sm font-medium\">Omschrijving</div>\n                  <div className=\"text-gray-600 dark:text-gray-400 mt-1\">\n                    {transaction.description}\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* Amount Display */}\n          <div className=\"p-4 border-2 border-dashed border-gray-200 dark:border-gray-700 rounded-lg text-center\">\n            <div className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">\n              {transaction.type === 'INCOME' ? 'Ontvangen bedrag' : 'Uitgegeven bedrag'}\n            </div>\n            <div className={`text-3xl font-bold ${\n              transaction.type === 'INCOME' \n                ? 'text-green-600 dark:text-green-400' \n                : 'text-red-600 dark:text-red-400'\n            }`}>\n              {formatCurrencyBE(transaction.amount)}\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n            <Button \n              onClick={handleEdit} \n              className=\"flex-1 gap-2\"\n              data-testid=\"button-edit-transaction\"\n            >\n              <Edit className=\"h-4 w-4\" />\n              Bewerken\n            </Button>\n            <Button \n              variant=\"outline\" \n              onClick={handleDelete}\n              className=\"flex-1 gap-2 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800 hover:bg-red-50 dark:hover:bg-red-900/10\"\n              data-testid=\"button-delete-transaction\"\n            >\n              <Trash2 className=\"h-4 w-4\" />\n              Verwijderen\n            </Button>\n          </div>\n        </div>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":5534},"components/finance/ExportDialog.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { exportToCSV } from \"@/lib/csv\";\nimport { Download, FileText, FileSpreadsheet, FileImage } from \"lucide-react\";\n\ninterface ExportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  transactions: Transaction[];\n}\n\ntype ExportFormat = 'csv' | 'excel' | 'pdf';\n\nexport function ExportDialog({ open, onClose, transactions }: ExportDialogProps) {\n  const [format, setFormat] = useState<ExportFormat>('csv');\n  const [loading, setLoading] = useState(false);\n\n  const handleExport = async () => {\n    setLoading(true);\n    \n    try {\n      const exportData = transactions.map(t => ({\n        Datum: formatDateBE(t.date),\n        Type: t.type === 'INCOME' ? 'Inkomsten' : 'Uitgaven',\n        Categorie: t.category,\n        Lid: t.memberName || '',\n        Bedrag: t.amount,\n        'Bedrag (geformatteerd)': formatCurrencyBE(t.amount),\n        Methode: t.method,\n        Omschrijving: t.description || ''\n      }));\n\n      if (format === 'csv') {\n        exportToCSV(exportData, `transacties_${new Date().toISOString().split('T')[0]}.csv`);\n      } else if (format === 'excel') {\n        // Mock Excel export - in real app would use a library like xlsx\n        exportToCSV(exportData, `transacties_${new Date().toISOString().split('T')[0]}.xlsx`);\n        alert('Excel export is een mock implementatie. In productie zou dit een echte Excel file genereren.');\n      } else if (format === 'pdf') {\n        // Mock PDF export - in real app would use a library like jsPDF\n        alert('PDF export is een mock implementatie. In productie zou dit een echte PDF genereren.');\n      }\n      \n      onClose();\n    } catch (error) {\n      alert('Fout bij het exporteren van gegevens');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatOptions = [\n    {\n      value: 'csv',\n      label: 'CSV',\n      description: 'Comma-separated values, compatible met Excel',\n      icon: FileText,\n      recommended: true\n    },\n    {\n      value: 'excel',\n      label: 'Excel',\n      description: 'Microsoft Excel spreadsheet (.xlsx)',\n      icon: FileSpreadsheet,\n      recommended: false\n    },\n    {\n      value: 'pdf',\n      label: 'PDF',\n      description: 'Portable Document Format voor rapporten',\n      icon: FileImage,\n      recommended: false\n    }\n  ];\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle>Transacties exporteren</DialogTitle>\n          <DialogDescription>\n            Exporteer {transactions.length} transacties naar het gewenste formaat\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"py-6\">\n          <div className=\"space-y-4\">\n            <Label className=\"text-base font-medium\">Selecteer export formaat:</Label>\n            \n            <RadioGroup value={format} onValueChange={(value) => setFormat(value as ExportFormat)}>\n              {formatOptions.map((option) => {\n                const Icon = option.icon;\n                return (\n                  <div key={option.value} className=\"flex items-center space-x-3\">\n                    <RadioGroupItem value={option.value} id={option.value} />\n                    <Card className=\"flex-1 cursor-pointer\" onClick={() => setFormat(option.value as ExportFormat)}>\n                      <CardHeader className=\"pb-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            <Icon className=\"h-5 w-5\" />\n                            <CardTitle className=\"text-sm\">{option.label}</CardTitle>\n                            {option.recommended && (\n                              <span className=\"text-xs bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400 px-2 py-0.5 rounded-full\">\n                                Aanbevolen\n                              </span>\n                            )}\n                          </div>\n                        </div>\n                        <CardDescription className=\"text-xs\">\n                          {option.description}\n                        </CardDescription>\n                      </CardHeader>\n                    </Card>\n                  </div>\n                );\n              })}\n            </RadioGroup>\n          </div>\n\n          {/* Export Summary */}\n          <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg\">\n            <h4 className=\"text-sm font-medium mb-2\">Export overzicht:</h4>\n            <div className=\"text-sm text-gray-600 dark:text-gray-400 space-y-1\">\n              <div className=\"flex justify-between\">\n                <span>Aantal transacties:</span>\n                <span className=\"font-medium\">{transactions.length}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Formaat:</span>\n                <span className=\"font-medium\">{formatOptions.find(f => f.value === format)?.label}</span>\n              </div>\n              <div className=\"flex justify-between\">\n                <span>Bestandsnaam:</span>\n                <span className=\"font-medium\">\n                  transacties_{new Date().toISOString().split('T')[0]}.{format === 'excel' ? 'xlsx' : format}\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} data-testid=\"button-cancel-export\">\n            Annuleren\n          </Button>\n          <Button \n            onClick={handleExport} \n            disabled={loading}\n            className=\"gap-2\"\n            data-testid=\"button-start-export\"\n          >\n            <Download className=\"h-4 w-4\" />\n            {loading ? 'Exporteren...' : 'Exporteren'}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":6437},"components/finance/FiltersDrawer.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle, SheetFooter } from \"@/components/ui/sheet\";\nimport { categories, mockMembers } from \"@/lib/mock/transactions\";\nimport { FilterData } from \"@/lib/zod/transaction\";\n\ninterface FiltersDrawerProps {\n  open: boolean;\n  onClose: () => void;\n  filters: FilterData;\n  onFiltersChange: (filters: FilterData) => void;\n  onApplyFilters: () => void;\n  onClearFilters: () => void;\n}\n\nexport function FiltersDrawer({\n  open,\n  onClose,\n  filters,\n  onFiltersChange,\n  onApplyFilters,\n  onClearFilters\n}: FiltersDrawerProps) {\n  const updateFilter = (key: keyof FilterData, value: any) => {\n    onFiltersChange({ ...filters, [key]: value });\n  };\n\n  const allCategories = [...categories.INCOME, ...categories.EXPENSE].sort();\n\n  return (\n    <Sheet open={open} onOpenChange={onClose}>\n      <SheetContent className=\"w-[400px] sm:w-[540px]\">\n        <SheetHeader>\n          <SheetTitle>Geavanceerde Filters</SheetTitle>\n          <SheetDescription>\n            Verfijn je zoekresultaten met specifieke criteria\n          </SheetDescription>\n        </SheetHeader>\n        \n        <div className=\"grid gap-6 py-6\">\n          {/* Category Filter */}\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"category\">Categorie</Label>\n            <Select value={filters.category || \"\"} onValueChange={(value) => updateFilter('category', value || undefined)}>\n              <SelectTrigger data-testid=\"select-category-filter\">\n                <SelectValue placeholder=\"Selecteer categorie\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"\">Alle categorieën</SelectItem>\n                {allCategories.map((category) => (\n                  <SelectItem key={category} value={category}>\n                    {category}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {/* Method Filter */}\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"method\">Betaalmethode</Label>\n            <Select value={filters.method || \"ALL\"} onValueChange={(value) => updateFilter('method', value)}>\n              <SelectTrigger data-testid=\"select-method-filter\">\n                <SelectValue placeholder=\"Selecteer methode\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"ALL\">Alle methodes</SelectItem>\n                <SelectItem value=\"SEPA\">SEPA</SelectItem>\n                <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                <SelectItem value=\"CASH\">Contant</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {/* Member Filter */}\n          <div className=\"grid gap-2\">\n            <Label htmlFor=\"member\">Lid</Label>\n            <Select value={filters.memberId || \"\"} onValueChange={(value) => updateFilter('memberId', value || undefined)}>\n              <SelectTrigger data-testid=\"select-member-filter\">\n                <SelectValue placeholder=\"Selecteer lid\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"\">Alle leden</SelectItem>\n                {mockMembers.map((member) => (\n                  <SelectItem key={member.id} value={member.id}>\n                    {member.name}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {/* Date Range */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"dateFrom\">Van datum</Label>\n              <Input\n                id=\"dateFrom\"\n                type=\"date\"\n                value={filters.dateFrom || \"\"}\n                onChange={(e) => updateFilter('dateFrom', e.target.value || undefined)}\n                data-testid=\"input-date-from\"\n              />\n            </div>\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"dateTo\">Tot datum</Label>\n              <Input\n                id=\"dateTo\"\n                type=\"date\"\n                value={filters.dateTo || \"\"}\n                onChange={(e) => updateFilter('dateTo', e.target.value || undefined)}\n                data-testid=\"input-date-to\"\n              />\n            </div>\n          </div>\n          \n          {/* Amount Range */}\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"amountMin\">Min. bedrag (€)</Label>\n              <Input\n                id=\"amountMin\"\n                type=\"number\"\n                step=\"0.01\"\n                min=\"0\"\n                placeholder=\"0,00\"\n                value={filters.amountMin || \"\"}\n                onChange={(e) => updateFilter('amountMin', e.target.value ? parseFloat(e.target.value) : undefined)}\n                data-testid=\"input-amount-min\"\n              />\n            </div>\n            <div className=\"grid gap-2\">\n              <Label htmlFor=\"amountMax\">Max. bedrag (€)</Label>\n              <Input\n                id=\"amountMax\"\n                type=\"number\"\n                step=\"0.01\"\n                min=\"0\"\n                placeholder=\"1000,00\"\n                value={filters.amountMax || \"\"}\n                onChange={(e) => updateFilter('amountMax', e.target.value ? parseFloat(e.target.value) : undefined)}\n                data-testid=\"input-amount-max\"\n              />\n            </div>\n          </div>\n        </div>\n        \n        <SheetFooter className=\"gap-2\">\n          <Button variant=\"outline\" onClick={onClearFilters} data-testid=\"button-clear-filters\">\n            Wis filters\n          </Button>\n          <Button onClick={() => { onApplyFilters(); onClose(); }} data-testid=\"button-apply-filters\">\n            Toepassen\n          </Button>\n        </SheetFooter>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":6332},"components/finance/ImportDialog.tsx":{"content":"\"use client\";\n\nimport { useState, useRef } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ImportMappingSchema, ImportMappingData } from \"@/lib/zod/transaction\";\nimport { parseCSV, parseMT940, parseCODA, CSVRow } from \"@/lib/csv\";\nimport { generateTransactionId, Transaction } from \"@/lib/mock/transactions\";\nimport { Upload, FileText, AlertTriangle, CheckCircle } from \"lucide-react\";\n\ninterface ImportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onImport: (transactions: Transaction[]) => void;\n}\n\ntype ImportStep = 'upload' | 'mapping' | 'preview' | 'complete';\n\nexport function ImportDialog({ open, onClose, onImport }: ImportDialogProps) {\n  const [step, setStep] = useState<ImportStep>('upload');\n  const [fileName, setFileName] = useState('');\n  const [fileType, setFileType] = useState<'csv' | 'mt940' | 'coda'>('csv');\n  const [headers, setHeaders] = useState<string[]>([]);\n  const [rows, setRows] = useState<CSVRow[]>([]);\n  const [mappedTransactions, setMappedTransactions] = useState<Transaction[]>([]);\n  const [loading, setLoading] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const form = useForm<ImportMappingData>({\n    resolver: zodResolver(ImportMappingSchema),\n    defaultValues: {\n      dateColumn: '',\n      amountColumn: '',\n      descriptionColumn: '',\n      categoryColumn: ''\n    }\n  });\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file) return;\n\n    setLoading(true);\n    setFileName(file.name);\n    \n    try {\n      const content = await file.text();\n      let parseResult;\n\n      // Determine file type and parse accordingly\n      if (file.name.toLowerCase().endsWith('.csv')) {\n        setFileType('csv');\n        parseResult = parseCSV(content);\n      } else if (file.name.toLowerCase().includes('mt940')) {\n        setFileType('mt940');\n        parseResult = parseMT940(content);\n      } else if (file.name.toLowerCase().includes('coda')) {\n        setFileType('coda');\n        parseResult = parseCODA(content);\n      } else {\n        // Default to CSV\n        setFileType('csv');\n        parseResult = parseCSV(content);\n      }\n\n      if (parseResult.success) {\n        setHeaders(parseResult.headers);\n        setRows(parseResult.rows.slice(0, 10)); // Preview first 10 rows\n        setStep('mapping');\n      } else {\n        alert(parseResult.error || 'Fout bij het parseren van het bestand');\n      }\n    } catch (error) {\n      alert('Fout bij het lezen van het bestand');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleMapping = (data: ImportMappingData) => {\n    setLoading(true);\n    \n    try {\n      const transactions: Transaction[] = rows.map(row => {\n        const dateStr = row[data.dateColumn];\n        const amountStr = row[data.amountColumn];\n        const description = data.descriptionColumn ? row[data.descriptionColumn] : '';\n        const category = data.categoryColumn ? row[data.categoryColumn] : 'Onbekend';\n        \n        // Parse amount and determine type\n        const amount = Math.abs(parseFloat(amountStr.replace(',', '.')) || 0);\n        const isNegative = amountStr.includes('-') || amountStr.startsWith('D') || row.type === 'D' || row.type === 'Debet';\n        const type = isNegative ? 'EXPENSE' : 'INCOME';\n        \n        // Parse date (try different formats)\n        let date = dateStr;\n        if (dateStr.includes('/')) {\n          const parts = dateStr.split('/');\n          if (parts.length === 3) {\n            date = `${parts[2]}-${parts[1].padStart(2, '0')}-${parts[0].padStart(2, '0')}`;\n          }\n        } else if (dateStr.includes('-') && dateStr.length === 8) {\n          // Format: ddmmyyyy or yyyymmdd\n          if (dateStr.startsWith('20')) {\n            date = `${dateStr.substr(0, 4)}-${dateStr.substr(4, 2)}-${dateStr.substr(6, 2)}`;\n          } else {\n            date = `20${dateStr.substr(4, 2)}-${dateStr.substr(2, 2)}-${dateStr.substr(0, 2)}`;\n          }\n        }\n\n        return {\n          id: generateTransactionId(),\n          date,\n          type,\n          category,\n          amount,\n          method: fileType === 'csv' ? 'OVERSCHRIJVING' : 'SEPA',\n          description\n        } as Transaction;\n      });\n\n      setMappedTransactions(transactions);\n      setStep('preview');\n    } catch (error) {\n      alert('Fout bij het verwerken van de gegevens');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleImport = () => {\n    onImport(mappedTransactions);\n    setStep('complete');\n  };\n\n  const handleClose = () => {\n    setStep('upload');\n    setFileName('');\n    setHeaders([]);\n    setRows([]);\n    setMappedTransactions([]);\n    form.reset();\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n    onClose();\n  };\n\n  const renderUploadStep = () => (\n    <div className=\"space-y-6\">\n      <div className=\"text-center\">\n        <Upload className=\"mx-auto h-12 w-12 text-gray-400\" />\n        <h3 className=\"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100\">\n          Upload bestand\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          Selecteer een CSV, MT940 of CODA bestand om te importeren\n        </p>\n      </div>\n      \n      <div className=\"mt-6\">\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          accept=\".csv,.txt,.mt940,.coda\"\n          onChange={handleFileUpload}\n          className=\"hidden\"\n          data-testid=\"input-file-upload\"\n        />\n        <Button\n          onClick={() => fileInputRef.current?.click()}\n          className=\"w-full\"\n          disabled={loading}\n          data-testid=\"button-select-file\"\n        >\n          {loading ? 'Bezig met laden...' : 'Bestand selecteren'}\n        </Button>\n      </div>\n      \n      <div className=\"text-xs text-gray-500 dark:text-gray-400 space-y-1\">\n        <p><strong>Ondersteunde formaten:</strong></p>\n        <ul className=\"list-disc list-inside space-y-1\">\n          <li>CSV: Comma/semicolon separated values</li>\n          <li>MT940: SWIFT bank statement format</li>\n          <li>CODA: Belgian bank statement format</li>\n        </ul>\n      </div>\n    </div>\n  );\n\n  const renderMappingStep = () => (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium\">Kolom mapping</h3>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          Koppel de kolommen uit je bestand aan de juiste velden\n        </p>\n      </div>\n\n      <Form {...form}>\n        <form onSubmit={form.handleSubmit(handleMapping)} className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <FormField\n              control={form.control}\n              name=\"dateColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Datum kolom *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-date-column\">\n                        <SelectValue placeholder=\"Selecteer kolom\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"amountColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Bedrag kolom *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-amount-column\">\n                        <SelectValue placeholder=\"Selecteer kolom\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"descriptionColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Omschrijving kolom</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-description-column\">\n                        <SelectValue placeholder=\"Selecteer kolom (optioneel)\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"\">Geen</SelectItem>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"categoryColumn\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Categorie kolom</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-category-column\">\n                        <SelectValue placeholder=\"Selecteer kolom (optioneel)\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"\">Geen</SelectItem>\n                      {headers.map(header => (\n                        <SelectItem key={header} value={header}>{header}</SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n          </div>\n\n          {/* Preview of first few rows */}\n          <div className=\"mt-6\">\n            <h4 className=\"text-sm font-medium mb-2\">Voorbeeld data:</h4>\n            <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    {headers.map(header => (\n                      <TableHead key={header} className=\"text-xs\">{header}</TableHead>\n                    ))}\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {rows.slice(0, 3).map((row, index) => (\n                    <TableRow key={index}>\n                      {headers.map(header => (\n                        <TableCell key={header} className=\"text-xs\">\n                          {row[header]}\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n\n          <div className=\"flex justify-between pt-4\">\n            <Button type=\"button\" variant=\"outline\" onClick={() => setStep('upload')}>\n              Terug\n            </Button>\n            <Button type=\"submit\" disabled={loading} data-testid=\"button-continue-mapping\">\n              {loading ? 'Verwerken...' : 'Doorgaan'}\n            </Button>\n          </div>\n        </form>\n      </Form>\n    </div>\n  );\n\n  const renderPreviewStep = () => (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium\">Voorbeeld import</h3>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          Controleer de geïmporteerde transacties voordat je ze toevoegt\n        </p>\n      </div>\n\n      <div className=\"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg\">\n        <div className=\"flex items-center gap-2\">\n          <FileText className=\"h-5 w-5 text-blue-600\" />\n          <span className=\"text-sm font-medium\">\n            {mappedTransactions.length} transacties gevonden in {fileName}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden max-h-80 overflow-y-auto\">\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead>Datum</TableHead>\n              <TableHead>Type</TableHead>\n              <TableHead>Categorie</TableHead>\n              <TableHead>Bedrag</TableHead>\n              <TableHead>Omschrijving</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {mappedTransactions.slice(0, 20).map((transaction, index) => (\n              <TableRow key={index}>\n                <TableCell className=\"text-xs\">{transaction.date}</TableCell>\n                <TableCell>\n                  <Badge variant={transaction.type === 'INCOME' ? 'secondary' : 'destructive'}>\n                    {transaction.type === 'INCOME' ? 'Inkomst' : 'Uitgave'}\n                  </Badge>\n                </TableCell>\n                <TableCell className=\"text-xs\">{transaction.category}</TableCell>\n                <TableCell className=\"text-xs\">€{transaction.amount.toFixed(2)}</TableCell>\n                <TableCell className=\"text-xs max-w-[200px] truncate\">\n                  {transaction.description || '-'}\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n\n      {mappedTransactions.length > 20 && (\n        <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n          ... en nog {mappedTransactions.length - 20} transacties\n        </p>\n      )}\n\n      <div className=\"flex justify-between pt-4\">\n        <Button type=\"button\" variant=\"outline\" onClick={() => setStep('mapping')}>\n          Terug\n        </Button>\n        <Button onClick={handleImport} data-testid=\"button-confirm-import\">\n          Transacties importeren\n        </Button>\n      </div>\n    </div>\n  );\n\n  const renderCompleteStep = () => (\n    <div className=\"text-center space-y-6\">\n      <div>\n        <CheckCircle className=\"mx-auto h-12 w-12 text-green-500\" />\n        <h3 className=\"mt-2 text-lg font-medium text-gray-900 dark:text-gray-100\">\n          Import voltooid!\n        </h3>\n        <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\n          {mappedTransactions.length} transacties zijn succesvol geïmporteerd\n        </p>\n      </div>\n      \n      <Button onClick={handleClose} className=\"w-full\" data-testid=\"button-close-import\">\n        Sluiten\n      </Button>\n    </div>\n  );\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[800px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Transacties importeren</DialogTitle>\n          <DialogDescription>\n            Import transacties vanuit CSV, MT940 of CODA bestanden\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"py-6\">\n          {step === 'upload' && renderUploadStep()}\n          {step === 'mapping' && renderMappingStep()}\n          {step === 'preview' && renderPreviewStep()}\n          {step === 'complete' && renderCompleteStep()}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":16373},"components/finance/JournalView.tsx":{"content":"\"use client\";\n\nimport { useMemo } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\n\ninterface JournalViewProps {\n  transactions: Transaction[];\n}\n\nexport function JournalView({ transactions }: JournalViewProps) {\n  const { debitTransactions, creditTransactions, totals } = useMemo(() => {\n    const debit = transactions.filter(t => t.type === 'EXPENSE').sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    const credit = transactions.filter(t => t.type === 'INCOME').sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    \n    const debitTotal = debit.reduce((sum, t) => sum + t.amount, 0);\n    const creditTotal = credit.reduce((sum, t) => sum + t.amount, 0);\n    \n    return {\n      debitTransactions: debit,\n      creditTransactions: credit,\n      totals: {\n        debit: debitTotal,\n        credit: creditTotal,\n        balance: creditTotal - debitTotal\n      }\n    };\n  }, [transactions]);\n\n  const TransactionRow = ({ transaction }: { transaction: Transaction }) => (\n    <TableRow>\n      <TableCell className=\"text-sm\">{formatDateBE(transaction.date)}</TableCell>\n      <TableCell className=\"text-sm\">{transaction.category}</TableCell>\n      <TableCell className=\"text-sm\">\n        {transaction.memberName ? (\n          <span className=\"text-blue-600 dark:text-blue-400\">\n            {transaction.memberName}\n          </span>\n        ) : (\n          <span className=\"text-gray-400\">-</span>\n        )}\n      </TableCell>\n      <TableCell className=\"text-sm\">\n        <MethodChip method={transaction.method} />\n      </TableCell>\n      <TableCell className=\"text-sm max-w-[150px] truncate\">\n        {transaction.description || '-'}\n      </TableCell>\n      <TableCell className=\"text-right font-medium\">\n        {formatCurrencyBE(transaction.amount)}\n      </TableCell>\n    </TableRow>\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-red-600 dark:text-red-400\">\n              Debet (Uitgaven)\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n              {formatCurrencyBE(totals.debit)}\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              {debitTransactions.length} transacties\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-green-600 dark:text-green-400\">\n              Credit (Inkomsten)\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n              {formatCurrencyBE(totals.credit)}\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              {creditTransactions.length} transacties\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium\">\n              Saldo\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className={`text-2xl font-bold ${\n              totals.balance >= 0 \n                ? 'text-green-600 dark:text-green-400' \n                : 'text-red-600 dark:text-red-400'\n            }`}>\n              {formatCurrencyBE(Math.abs(totals.balance))}\n            </div>\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              {totals.balance >= 0 ? 'Overschot' : 'Tekort'}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Journal Tables */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Debet (Uitgaven) */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-red-600 dark:text-red-400 flex items-center gap-2\">\n              Debet (Uitgaven)\n              <Badge variant=\"outline\" className=\"text-red-600 dark:text-red-400 border-red-200 dark:border-red-800\">\n                {debitTransactions.length}\n              </Badge>\n            </CardTitle>\n            <CardDescription>\n              Alle uitgaande transacties\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n              <Table>\n                <TableHeader>\n                  <TableRow className=\"bg-red-50 dark:bg-red-900/10\">\n                    <TableHead className=\"text-xs\">Datum</TableHead>\n                    <TableHead className=\"text-xs\">Categorie</TableHead>\n                    <TableHead className=\"text-xs\">Lid</TableHead>\n                    <TableHead className=\"text-xs\">Methode</TableHead>\n                    <TableHead className=\"text-xs\">Omschrijving</TableHead>\n                    <TableHead className=\"text-xs text-right\">Bedrag</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody className=\"max-h-80 overflow-y-auto\">\n                  {debitTransactions.length > 0 ? (\n                    debitTransactions.map((transaction) => (\n                      <TransactionRow key={transaction.id} transaction={transaction} />\n                    ))\n                  ) : (\n                    <TableRow>\n                      <TableCell colSpan={6} className=\"text-center text-gray-500 dark:text-gray-400 py-8\">\n                        Geen uitgaven gevonden\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n            \n            {debitTransactions.length > 0 && (\n              <div className=\"mt-4 p-3 bg-red-50 dark:bg-red-900/10 rounded-lg\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm font-medium\">Totaal Debet:</span>\n                  <span className=\"text-lg font-bold text-red-600 dark:text-red-400\">\n                    {formatCurrencyBE(totals.debit)}\n                  </span>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Credit (Inkomsten) */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-green-600 dark:text-green-400 flex items-center gap-2\">\n              Credit (Inkomsten)\n              <Badge variant=\"outline\" className=\"text-green-600 dark:text-green-400 border-green-200 dark:border-green-800\">\n                {creditTransactions.length}\n              </Badge>\n            </CardTitle>\n            <CardDescription>\n              Alle inkomende transacties\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden\">\n              <Table>\n                <TableHeader>\n                  <TableRow className=\"bg-green-50 dark:bg-green-900/10\">\n                    <TableHead className=\"text-xs\">Datum</TableHead>\n                    <TableHead className=\"text-xs\">Categorie</TableHead>\n                    <TableHead className=\"text-xs\">Lid</TableHead>\n                    <TableHead className=\"text-xs\">Methode</TableHead>\n                    <TableHead className=\"text-xs\">Omschrijving</TableHead>\n                    <TableHead className=\"text-xs text-right\">Bedrag</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody className=\"max-h-80 overflow-y-auto\">\n                  {creditTransactions.length > 0 ? (\n                    creditTransactions.map((transaction) => (\n                      <TransactionRow key={transaction.id} transaction={transaction} />\n                    ))\n                  ) : (\n                    <TableRow>\n                      <TableCell colSpan={6} className=\"text-center text-gray-500 dark:text-gray-400 py-8\">\n                        Geen inkomsten gevonden\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n            \n            {creditTransactions.length > 0 && (\n              <div className=\"mt-4 p-3 bg-green-50 dark:bg-green-900/10 rounded-lg\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-sm font-medium\">Totaal Credit:</span>\n                  <span className=\"text-lg font-bold text-green-600 dark:text-green-400\">\n                    {formatCurrencyBE(totals.credit)}\n                  </span>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Balance Summary */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Journaal Saldo</CardTitle>\n          <CardDescription>\n            Overzicht van de balans tussen debet en credit\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-center\">\n            <div className=\"p-4 bg-red-50 dark:bg-red-900/10 rounded-lg\">\n              <div className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n                {formatCurrencyBE(totals.debit)}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Totaal Debet</div>\n            </div>\n            \n            <div className=\"p-4 bg-green-50 dark:bg-green-900/10 rounded-lg\">\n              <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                {formatCurrencyBE(totals.credit)}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">Totaal Credit</div>\n            </div>\n            \n            <div className={`p-4 rounded-lg ${\n              totals.balance >= 0 \n                ? 'bg-green-50 dark:bg-green-900/10' \n                : 'bg-red-50 dark:bg-red-900/10'\n            }`}>\n              <div className={`text-2xl font-bold ${\n                totals.balance >= 0 \n                  ? 'text-green-600 dark:text-green-400' \n                  : 'text-red-600 dark:text-red-400'\n              }`}>\n                {formatCurrencyBE(Math.abs(totals.balance))}\n              </div>\n              <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Saldo ({totals.balance >= 0 ? 'Overschot' : 'Tekort'})\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":11157},"components/finance/KpiCards.tsx":{"content":"\"use client\";\n\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { formatCurrencyBE } from \"@/lib/format\";\nimport { transactions, getTotalByType } from \"@/lib/mock/transactions\";\nimport { TrendingUp, TrendingDown, DollarSign, AlertTriangle } from \"lucide-react\";\nimport { useMemo } from \"react\";\n\nexport function KpiCards() {\n  const kpiData = useMemo(() => {\n    const totalIncome = getTotalByType('INCOME');\n    const totalExpense = getTotalByType('EXPENSE');\n    const balance = totalIncome - totalExpense;\n    \n    // Mock achterstallig bedrag (in real app, this would come from overdue fees)\n    const overdue = 1450;\n    \n    return {\n      income: totalIncome,\n      expense: totalExpense,\n      balance,\n      overdue\n    };\n  }, []);\n\n  const kpis = [\n    {\n      title: \"Ontvangen\",\n      value: kpiData.income,\n      icon: TrendingUp,\n      color: \"text-green-600\",\n      bgColor: \"bg-green-50 dark:bg-green-900/10\",\n      description: \"Totale inkomsten\"\n    },\n    {\n      title: \"Uitgegeven\",\n      value: kpiData.expense,\n      icon: TrendingDown,\n      color: \"text-red-600\",\n      bgColor: \"bg-red-50 dark:bg-red-900/10\",\n      description: \"Totale uitgaven\"\n    },\n    {\n      title: \"Saldo\",\n      value: kpiData.balance,\n      icon: DollarSign,\n      color: kpiData.balance >= 0 ? \"text-green-600\" : \"text-red-600\",\n      bgColor: kpiData.balance >= 0 \n        ? \"bg-green-50 dark:bg-green-900/10\" \n        : \"bg-red-50 dark:bg-red-900/10\",\n      description: \"Netto resultaat\"\n    },\n    {\n      title: \"Achterstallig\",\n      value: kpiData.overdue,\n      icon: AlertTriangle,\n      color: \"text-orange-600\",\n      bgColor: \"bg-orange-50 dark:bg-orange-900/10\",\n      description: \"Te betalen lidgeld\"\n    }\n  ];\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n      {kpis.map((kpi) => {\n        const Icon = kpi.icon;\n        return (\n          <Card key={kpi.title} className=\"relative overflow-hidden\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">\n                {kpi.title}\n              </CardTitle>\n              <div className={`p-2 rounded-lg ${kpi.bgColor}`}>\n                <Icon className={`h-4 w-4 ${kpi.color}`} />\n              </div>\n            </CardHeader>\n            <CardContent>\n              <div className={`text-2xl font-bold ${kpi.color}`}>\n                {formatCurrencyBE(kpi.value)}\n              </div>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                {kpi.description}\n              </p>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n}","size_bytes":2786},"components/finance/NewTransactionDialog.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { TransactionSchema, TransactionFormData } from \"@/lib/zod/transaction\";\nimport { categories, mockMembers, Transaction, generateTransactionId } from \"@/lib/mock/transactions\";\nimport { format } from \"date-fns\";\n\ninterface NewTransactionDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onSave: (transaction: Transaction) => void;\n  editTransaction?: Transaction | null;\n}\n\nexport function NewTransactionDialog({\n  open,\n  onClose,\n  onSave,\n  editTransaction\n}: NewTransactionDialogProps) {\n  const [loading, setLoading] = useState(false);\n  \n  const isEditing = !!editTransaction;\n  \n  const form = useForm<TransactionFormData>({\n    resolver: zodResolver(TransactionSchema),\n    defaultValues: {\n      type: editTransaction?.type || 'INCOME',\n      date: editTransaction?.date || format(new Date(), 'yyyy-MM-dd'),\n      category: editTransaction?.category || '',\n      amount: editTransaction?.amount || 0,\n      method: editTransaction?.method || 'SEPA',\n      memberId: editTransaction?.memberId || '',\n      memberName: editTransaction?.memberName || '',\n      description: editTransaction?.description || ''\n    }\n  });\n\n  const selectedType = form.watch('type');\n  const selectedMemberId = form.watch('memberId');\n  \n  // Update member name when member is selected\n  const handleMemberChange = (memberId: string) => {\n    const member = mockMembers.find(m => m.id === memberId);\n    form.setValue('memberName', member?.name || '');\n  };\n\n  const onSubmit = async (data: TransactionFormData) => {\n    setLoading(true);\n    try {\n      const transaction: Transaction = {\n        id: editTransaction?.id || generateTransactionId(),\n        date: data.date,\n        type: data.type,\n        category: data.category,\n        amount: data.amount,\n        method: data.method,\n        memberId: data.memberId || undefined,\n        memberName: data.memberName || undefined,\n        description: data.description || undefined\n      };\n      \n      onSave(transaction);\n      \n      if (!isEditing) {\n        form.reset();\n      }\n      onClose();\n    } catch (error) {\n      console.error('Error saving transaction:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (!isEditing) {\n      form.reset();\n    }\n    onClose();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[600px] max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>\n            {isEditing ? 'Transactie bewerken' : 'Nieuwe transactie'}\n          </DialogTitle>\n          <DialogDescription>\n            {isEditing \n              ? 'Wijzig de details van deze transactie.'\n              : 'Voeg een nieuwe inkomst of uitgave toe aan je financiële administratie.'\n            }\n          </DialogDescription>\n        </DialogHeader>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Type */}\n            <FormField\n              control={form.control}\n              name=\"type\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Type *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-transaction-type\">\n                        <SelectValue placeholder=\"Selecteer type\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"INCOME\">Inkomsten</SelectItem>\n                      <SelectItem value=\"EXPENSE\">Uitgaven</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Date and Amount Row */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"date\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Datum *</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"date\"\n                        {...field}\n                        data-testid=\"input-transaction-date\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"amount\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Bedrag (€) *</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"number\"\n                        step=\"0.01\"\n                        min=\"0\"\n                        placeholder=\"0,00\"\n                        {...field}\n                        onChange={(e) => field.onChange(parseFloat(e.target.value) || 0)}\n                        data-testid=\"input-transaction-amount\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            {/* Category */}\n            <FormField\n              control={form.control}\n              name=\"category\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Categorie *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-transaction-category\">\n                        <SelectValue placeholder=\"Selecteer categorie\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {categories[selectedType].map((category) => (\n                        <SelectItem key={category} value={category}>\n                          {category}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Payment Method */}\n            <FormField\n              control={form.control}\n              name=\"method\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Betaalmethode *</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-transaction-method\">\n                        <SelectValue placeholder=\"Selecteer methode\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"SEPA\">SEPA</SelectItem>\n                      <SelectItem value=\"OVERSCHRIJVING\">Overschrijving</SelectItem>\n                      <SelectItem value=\"BANCONTACT\">Bancontact</SelectItem>\n                      <SelectItem value=\"CASH\">Contant</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Member (Optional) */}\n            <FormField\n              control={form.control}\n              name=\"memberId\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Lid (optioneel)</FormLabel>\n                  <Select \n                    onValueChange={(value) => {\n                      field.onChange(value);\n                      handleMemberChange(value);\n                    }} \n                    defaultValue={field.value}\n                  >\n                    <FormControl>\n                      <SelectTrigger data-testid=\"select-transaction-member\">\n                        <SelectValue placeholder=\"Selecteer lid\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"\">Geen lid gekoppeld</SelectItem>\n                      {mockMembers.map((member) => (\n                        <SelectItem key={member.id} value={member.id}>\n                          {member.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormDescription>\n                    Koppel deze transactie aan een specifiek lid (bijv. voor lidgeld)\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Description */}\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Omschrijving (optioneel)</FormLabel>\n                  <FormControl>\n                    <Textarea\n                      placeholder=\"Voeg een omschrijving toe...\"\n                      className=\"resize-none\"\n                      rows={3}\n                      {...field}\n                      data-testid=\"input-transaction-description\"\n                    />\n                  </FormControl>\n                  <FormDescription>\n                    Maximaal 500 karakters\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <DialogFooter>\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={handleClose}\n                data-testid=\"button-cancel-transaction\"\n              >\n                Annuleren\n              </Button>\n              <Button \n                type=\"submit\" \n                disabled={loading}\n                data-testid=\"button-save-transaction\"\n              >\n                {loading ? 'Bezig...' : (isEditing ? 'Wijzigingen opslaan' : 'Transactie toevoegen')}\n              </Button>\n            </DialogFooter>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":10987},"components/finance/RowActions.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { MoreHorizontal, Eye, Edit, Trash2 } from \"lucide-react\";\nimport { Transaction } from \"@/lib/mock/transactions\";\n\ninterface RowActionsProps {\n  transaction: Transaction;\n  onView: (transaction: Transaction) => void;\n  onEdit: (transaction: Transaction) => void;\n  onDelete: (transactionId: string) => void;\n}\n\nexport function RowActions({ transaction, onView, onEdit, onDelete }: RowActionsProps) {\n  const [open, setOpen] = useState(false);\n\n  const handleAction = (action: () => void) => {\n    action();\n    setOpen(false);\n  };\n\n  return (\n    <DropdownMenu open={open} onOpenChange={setOpen}>\n      <DropdownMenuTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"h-8 w-8 p-0\"\n          onClick={(e) => e.stopPropagation()}\n          data-testid={`button-actions-${transaction.id}`}\n        >\n          <span className=\"sr-only\">Acties openen</span>\n          <MoreHorizontal className=\"h-4 w-4\" />\n        </Button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"end\" className=\"w-[160px]\">\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onView(transaction));\n          }}\n          data-testid={`menu-view-${transaction.id}`}\n        >\n          <Eye className=\"mr-2 h-4 w-4\" />\n          Details\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onEdit(transaction));\n          }}\n          data-testid={`menu-edit-${transaction.id}`}\n        >\n          <Edit className=\"mr-2 h-4 w-4\" />\n          Bewerken\n        </DropdownMenuItem>\n        <DropdownMenuItem \n          onClick={(e) => {\n            e.stopPropagation();\n            handleAction(() => onDelete(transaction.id));\n          }}\n          className=\"text-red-600 dark:text-red-400\"\n          data-testid={`menu-delete-${transaction.id}`}\n        >\n          <Trash2 className=\"mr-2 h-4 w-4\" />\n          Verwijderen\n        </DropdownMenuItem>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n}","size_bytes":2333},"components/finance/Toolbar.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Search, Download, Upload, Plus, Filter } from \"lucide-react\";\n\ninterface ToolbarProps {\n  onSearch: (search: string) => void;\n  onTypeFilter: (type: string) => void;\n  onPeriodFilter: (period: string) => void;\n  onNewTransaction: () => void;\n  onImport: () => void;\n  onExport: () => void;\n  onAdvancedFilters: () => void;\n  searchValue: string;\n  typeFilter: string;\n  periodFilter: string;\n}\n\nexport function Toolbar({\n  onSearch,\n  onTypeFilter,\n  onPeriodFilter,\n  onNewTransaction,\n  onImport,\n  onExport,\n  onAdvancedFilters,\n  searchValue,\n  typeFilter,\n  periodFilter\n}: ToolbarProps) {\n  return (\n    <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between bg-white dark:bg-gray-900 p-4 rounded-lg border border-gray-200 dark:border-gray-700\">\n      {/* Search and Quick Filters */}\n      <div className=\"flex flex-col sm:flex-row gap-3 flex-1 w-full sm:w-auto\">\n        {/* Search Bar */}\n        <div className=\"relative flex-1 min-w-0 sm:max-w-sm\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n          <Input\n            placeholder=\"Zoek op categorie, omschrijving of lidnummer...\"\n            value={searchValue}\n            onChange={(e) => onSearch(e.target.value)}\n            className=\"pl-10\"\n            data-testid=\"input-search\"\n          />\n        </div>\n        \n        {/* Type Filter */}\n        <Select value={typeFilter} onValueChange={onTypeFilter}>\n          <SelectTrigger className=\"w-full sm:w-40\" data-testid=\"select-type-filter\">\n            <SelectValue placeholder=\"Type\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL\">Alle types</SelectItem>\n            <SelectItem value=\"INCOME\">Inkomsten</SelectItem>\n            <SelectItem value=\"EXPENSE\">Uitgaven</SelectItem>\n          </SelectContent>\n        </Select>\n        \n        {/* Period Filter */}\n        <Select value={periodFilter} onValueChange={onPeriodFilter}>\n          <SelectTrigger className=\"w-full sm:w-40\" data-testid=\"select-period-filter\">\n            <SelectValue placeholder=\"Periode\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL\">Alle periodes</SelectItem>\n            <SelectItem value=\"THIS_MONTH\">Deze maand</SelectItem>\n            <SelectItem value=\"LAST_MONTH\">Vorige maand</SelectItem>\n            <SelectItem value=\"THIS_YEAR\">Dit jaar</SelectItem>\n            <SelectItem value=\"LAST_YEAR\">Vorig jaar</SelectItem>\n          </SelectContent>\n        </Select>\n        \n        {/* Advanced Filters Button */}\n        <Button\n          variant=\"outline\"\n          onClick={onAdvancedFilters}\n          className=\"gap-2\"\n          data-testid=\"button-advanced-filters\"\n        >\n          <Filter className=\"h-4 w-4\" />\n          Filters\n        </Button>\n      </div>\n      \n      {/* Action Buttons */}\n      <div className=\"flex gap-2 w-full sm:w-auto\">\n        <Button\n          variant=\"outline\"\n          onClick={onImport}\n          className=\"gap-2 flex-1 sm:flex-none\"\n          data-testid=\"button-import\"\n        >\n          <Upload className=\"h-4 w-4\" />\n          Import\n        </Button>\n        <Button\n          variant=\"outline\"\n          onClick={onExport}\n          className=\"gap-2 flex-1 sm:flex-none\"\n          data-testid=\"button-export\"\n        >\n          <Download className=\"h-4 w-4\" />\n          Export\n        </Button>\n        <Button\n          onClick={onNewTransaction}\n          className=\"gap-2 flex-1 sm:flex-none\"\n          data-testid=\"button-new-transaction\"\n        >\n          <Plus className=\"h-4 w-4\" />\n          Nieuwe transactie\n        </Button>\n      </div>\n    </div>\n  );\n}","size_bytes":3986},"components/finance/TransactionsTable.tsx":{"content":"\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Button } from \"@/components/ui/button\";\nimport { StatusChip } from \"@/components/ui/StatusChip\";\nimport { MethodChip } from \"@/components/ui/MethodChip\";\nimport { EmptyState } from \"@/components/ui/EmptyState\";\nimport { formatDateBE, formatCurrencyBE } from \"@/lib/format\";\nimport { Transaction } from \"@/lib/mock/transactions\";\nimport { FilterData } from \"@/lib/zod/transaction\";\nimport { ChevronUp, ChevronDown, MoreHorizontal } from \"lucide-react\";\nimport { RowActions } from \"./RowActions\";\n\ninterface TransactionsTableProps {\n  transactions: Transaction[];\n  filters: FilterData;\n  onTransactionSelect: (transaction: Transaction) => void;\n  onTransactionEdit: (transaction: Transaction) => void;\n  onTransactionDelete: (transactionId: string) => void;\n  loading?: boolean;\n}\n\ntype SortField = 'date' | 'amount' | 'category' | 'type';\ntype SortDirection = 'asc' | 'desc';\n\nexport function TransactionsTable({\n  transactions,\n  filters,\n  onTransactionSelect,\n  onTransactionEdit,\n  onTransactionDelete,\n  loading = false\n}: TransactionsTableProps) {\n  const [sortField, setSortField] = useState<SortField>('date');\n  const [sortDirection, setSortDirection] = useState<SortDirection>('desc');\n  const [currentPage, setCurrentPage] = useState(1);\n  const itemsPerPage = 20;\n\n  // Filter and sort transactions\n  const filteredAndSortedTransactions = useMemo(() => {\n    let filtered = transactions;\n\n    // Apply filters\n    if (filters.search) {\n      const search = filters.search.toLowerCase();\n      filtered = filtered.filter(t => \n        t.category.toLowerCase().includes(search) ||\n        (t.description?.toLowerCase().includes(search)) ||\n        (t.memberName?.toLowerCase().includes(search))\n      );\n    }\n\n    if (filters.type && filters.type !== 'ALL') {\n      filtered = filtered.filter(t => t.type === filters.type);\n    }\n\n    if (filters.category) {\n      filtered = filtered.filter(t => t.category === filters.category);\n    }\n\n    if (filters.method && filters.method !== 'ALL') {\n      filtered = filtered.filter(t => t.method === filters.method);\n    }\n\n    if (filters.memberId) {\n      filtered = filtered.filter(t => t.memberId === filters.memberId);\n    }\n\n    if (filters.dateFrom) {\n      filtered = filtered.filter(t => t.date >= filters.dateFrom!);\n    }\n\n    if (filters.dateTo) {\n      filtered = filtered.filter(t => t.date <= filters.dateTo!);\n    }\n\n    if (filters.amountMin) {\n      filtered = filtered.filter(t => t.amount >= filters.amountMin!);\n    }\n\n    if (filters.amountMax) {\n      filtered = filtered.filter(t => t.amount <= filters.amountMax!);\n    }\n\n    // Sort\n    filtered.sort((a, b) => {\n      let aValue: any, bValue: any;\n      \n      switch (sortField) {\n        case 'date':\n          aValue = new Date(a.date);\n          bValue = new Date(b.date);\n          break;\n        case 'amount':\n          aValue = a.amount;\n          bValue = b.amount;\n          break;\n        case 'category':\n          aValue = a.category;\n          bValue = b.category;\n          break;\n        case 'type':\n          aValue = a.type;\n          bValue = b.type;\n          break;\n        default:\n          return 0;\n      }\n\n      if (aValue < bValue) return sortDirection === 'asc' ? -1 : 1;\n      if (aValue > bValue) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n\n    return filtered;\n  }, [transactions, filters, sortField, sortDirection]);\n\n  // Pagination\n  const totalPages = Math.ceil(filteredAndSortedTransactions.length / itemsPerPage);\n  const paginatedTransactions = filteredAndSortedTransactions.slice(\n    (currentPage - 1) * itemsPerPage,\n    currentPage * itemsPerPage\n  );\n\n  const handleSort = (field: SortField) => {\n    if (field === sortField) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortField(field);\n      setSortDirection('asc');\n    }\n  };\n\n  const SortIcon = ({ field }: { field: SortField }) => {\n    if (sortField !== field) return null;\n    return sortDirection === 'asc' ? \n      <ChevronUp className=\"w-4 h-4\" /> : \n      <ChevronDown className=\"w-4 h-4\" />;\n  };\n\n  if (loading) {\n    return (\n      <div className=\"animate-pulse\">\n        <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded mb-4\"></div>\n        {Array.from({ length: 5 }).map((_, i) => (\n          <div key={i} className=\"h-12 bg-gray-100 dark:bg-gray-800 rounded mb-2\"></div>\n        ))}\n      </div>\n    );\n  }\n\n  if (filteredAndSortedTransactions.length === 0) {\n    return (\n      <EmptyState\n        title=\"Geen transacties gevonden\"\n        description=\"Er zijn geen transacties die voldoen aan de geselecteerde filters.\"\n      />\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Table */}\n      <div className=\"rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden\">\n        <Table>\n          <TableHeader>\n            <TableRow className=\"bg-gray-50 dark:bg-gray-900\">\n              <TableHead \n                className=\"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-800\"\n                onClick={() => handleSort('date')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Datum\n                  <SortIcon field=\"date\" />\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-800\"\n                onClick={() => handleSort('type')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Type\n                  <SortIcon field=\"type\" />\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-800\"\n                onClick={() => handleSort('category')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Categorie\n                  <SortIcon field=\"category\" />\n                </div>\n              </TableHead>\n              <TableHead>Lid</TableHead>\n              <TableHead \n                className=\"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-800 text-right\"\n                onClick={() => handleSort('amount')}\n              >\n                <div className=\"flex items-center justify-end gap-2\">\n                  Bedrag\n                  <SortIcon field=\"amount\" />\n                </div>\n              </TableHead>\n              <TableHead>Methode</TableHead>\n              <TableHead>Omschrijving</TableHead>\n              <TableHead className=\"w-[50px]\">Acties</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {paginatedTransactions.map((transaction) => (\n              <TableRow \n                key={transaction.id}\n                className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-900\"\n                onClick={() => onTransactionSelect(transaction)}\n                data-testid={`row-transaction-${transaction.id}`}\n              >\n                <TableCell className=\"font-medium\">\n                  {formatDateBE(transaction.date)}\n                </TableCell>\n                <TableCell>\n                  <StatusChip type={transaction.type} />\n                </TableCell>\n                <TableCell>{transaction.category}</TableCell>\n                <TableCell>\n                  {transaction.memberName ? (\n                    <span className=\"text-blue-600 dark:text-blue-400\">\n                      {transaction.memberName}\n                    </span>\n                  ) : (\n                    <span className=\"text-gray-400\">-</span>\n                  )}\n                </TableCell>\n                <TableCell className=\"text-right font-medium\">\n                  <span className={transaction.type === 'INCOME' \n                    ? 'text-green-600 dark:text-green-400' \n                    : 'text-red-600 dark:text-red-400'\n                  }>\n                    {formatCurrencyBE(transaction.amount)}\n                  </span>\n                </TableCell>\n                <TableCell>\n                  <MethodChip method={transaction.method} />\n                </TableCell>\n                <TableCell className=\"max-w-[200px] truncate\">\n                  {transaction.description || '-'}\n                </TableCell>\n                <TableCell>\n                  <RowActions\n                    transaction={transaction}\n                    onEdit={onTransactionEdit}\n                    onDelete={onTransactionDelete}\n                    onView={onTransactionSelect}\n                  />\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n      </div>\n\n      {/* Pagination */}\n      {totalPages > 1 && (\n        <div className=\"flex items-center justify-between\">\n          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n            Toont {(currentPage - 1) * itemsPerPage + 1} tot {Math.min(currentPage * itemsPerPage, filteredAndSortedTransactions.length)} van {filteredAndSortedTransactions.length} transacties\n          </div>\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\n              disabled={currentPage === 1}\n              data-testid=\"button-prev-page\"\n            >\n              Vorige\n            </Button>\n            <span className=\"flex items-center px-3 text-sm\">\n              Pagina {currentPage} van {totalPages}\n            </span>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\n              disabled={currentPage === totalPages}\n              data-testid=\"button-next-page\"\n            >\n              Volgende\n            </Button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":10140},"components/ui/ConfirmDialog.tsx":{"content":"\"use client\";\n\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\ninterface ConfirmDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onConfirm: () => void;\n  title?: string;\n  description?: string;\n  confirmText?: string;\n  cancelText?: string;\n  variant?: 'default' | 'destructive';\n}\n\nexport function ConfirmDialog({\n  open,\n  onClose,\n  onConfirm,\n  title = \"Weet je het zeker?\",\n  description = \"Deze actie kan niet ongedaan worden gemaakt.\",\n  confirmText = \"Doorgaan\",\n  cancelText = \"Annuleren\",\n  variant = 'default'\n}: ConfirmDialogProps) {\n  const handleConfirm = () => {\n    onConfirm();\n    onClose();\n  };\n\n  return (\n    <AlertDialog open={open} onOpenChange={onClose}>\n      <AlertDialogContent>\n        <AlertDialogHeader>\n          <AlertDialogTitle>{title}</AlertDialogTitle>\n          <AlertDialogDescription>\n            {description}\n          </AlertDialogDescription>\n        </AlertDialogHeader>\n        <AlertDialogFooter>\n          <AlertDialogCancel onClick={onClose}>\n            {cancelText}\n          </AlertDialogCancel>\n          <AlertDialogAction\n            onClick={handleConfirm}\n            className={variant === 'destructive' \n              ? 'bg-red-600 hover:bg-red-700 dark:bg-red-600 dark:hover:bg-red-700' \n              : ''\n            }\n          >\n            {confirmText}\n          </AlertDialogAction>\n        </AlertDialogFooter>\n      </AlertDialogContent>\n    </AlertDialog>\n  );\n}","size_bytes":1607},"components/ui/EmptyState.tsx":{"content":"import { FileX, Plus } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface EmptyStateProps {\n  title: string;\n  description: string;\n  actionText?: string;\n  onAction?: () => void;\n  icon?: React.ReactNode;\n}\n\nexport function EmptyState({\n  title,\n  description,\n  actionText,\n  onAction,\n  icon\n}: EmptyStateProps) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n      <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n        {icon || <FileX className=\"w-8 h-8 text-gray-400\" />}\n      </div>\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n        {title}\n      </h3>\n      <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n        {description}\n      </p>\n      {actionText && onAction && (\n        <Button onClick={onAction} className=\"gap-2\">\n          <Plus className=\"w-4 h-4\" />\n          {actionText}\n        </Button>\n      )}\n    </div>\n  );\n}","size_bytes":1040},"components/ui/ErrorState.tsx":{"content":"import { AlertCircle, RefreshCw } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface ErrorStateProps {\n  title?: string;\n  description?: string;\n  onRetry?: () => void;\n}\n\nexport function ErrorState({\n  title = \"Er is een fout opgetreden\",\n  description = \"We konden de gegevens niet laden. Probeer het opnieuw.\",\n  onRetry\n}: ErrorStateProps) {\n  return (\n    <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n      <div className=\"flex items-center justify-center w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full mb-4\">\n        <AlertCircle className=\"w-8 h-8 text-red-500\" />\n      </div>\n      <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n        {title}\n      </h3>\n      <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n        {description}\n      </p>\n      {onRetry && (\n        <Button onClick={onRetry} variant=\"outline\" className=\"gap-2\">\n          <RefreshCw className=\"w-4 h-4\" />\n          Opnieuw proberen\n        </Button>\n      )}\n    </div>\n  );\n}","size_bytes":1076},"components/ui/MethodChip.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface MethodChipProps {\n  method: 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n  className?: string;\n}\n\nconst methodConfig = {\n  SEPA: {\n    label: 'SEPA',\n    className: \"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400\"\n  },\n  OVERSCHRIJVING: {\n    label: 'Overschrijving',\n    className: \"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-400\"\n  },\n  BANCONTACT: {\n    label: 'Bancontact',\n    className: \"bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-400\"\n  },\n  CASH: {\n    label: 'Contant',\n    className: \"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400\"\n  }\n};\n\nexport function MethodChip({ method, className }: MethodChipProps) {\n  const config = methodConfig[method];\n  \n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\",\n        config.className,\n        className\n      )}\n    >\n      {config.label}\n    </span>\n  );\n}","size_bytes":1024},"components/ui/StatusChip.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface StatusChipProps {\n  type: 'INCOME' | 'EXPENSE';\n  className?: string;\n}\n\nexport function StatusChip({ type, className }: StatusChipProps) {\n  return (\n    <span\n      className={cn(\n        \"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium\",\n        type === 'INCOME'\n          ? \"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400\"\n          : \"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400\",\n        className\n      )}\n    >\n      {type === 'INCOME' ? 'Inkomsten' : 'Uitgaven'}\n    </span>\n  );\n}","size_bytes":599},"lib/csv.ts":{"content":"export interface CSVRow {\n  [key: string]: string;\n}\n\nexport interface CSVParseResult {\n  headers: string[];\n  rows: CSVRow[];\n  success: boolean;\n  error?: string;\n}\n\n/**\n * Simple CSV parser for import functionality\n */\nexport function parseCSV(csvContent: string): CSVParseResult {\n  try {\n    const lines = csvContent.trim().split('\\n');\n    if (lines.length < 2) {\n      return {\n        headers: [],\n        rows: [],\n        success: false,\n        error: 'CSV moet minimaal een header en één rij bevatten'\n      };\n    }\n\n    // Parse headers\n    const headers = lines[0].split(';').map(h => h.trim().replace(/\"/g, ''));\n    \n    // Parse rows\n    const rows: CSVRow[] = [];\n    for (let i = 1; i < lines.length; i++) {\n      const line = lines[i].trim();\n      if (!line) continue;\n      \n      const values = line.split(';').map(v => v.trim().replace(/\"/g, ''));\n      const row: CSVRow = {};\n      \n      headers.forEach((header, index) => {\n        row[header] = values[index] || '';\n      });\n      \n      rows.push(row);\n    }\n\n    return {\n      headers,\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van CSV bestand'\n    };\n  }\n}\n\n/**\n * Mock MT940 parser (simplified for demo)\n */\nexport function parseMT940(content: string): CSVParseResult {\n  // Mock implementation - in real app would parse MT940 format\n  try {\n    const lines = content.split('\\n').filter(line => line.trim());\n    const rows: CSVRow[] = [];\n    \n    // Simple mock parsing - extract transaction-like lines\n    lines.forEach((line, index) => {\n      if (line.includes(':61:') || line.includes(':86:')) {\n        rows.push({\n          datum: `2025-01-${(index % 28) + 1}`,\n          bedrag: (Math.random() * 1000).toFixed(2),\n          omschrijving: `MT940 transactie ${index}`,\n          type: Math.random() > 0.5 ? 'Credit' : 'Debet'\n        });\n      }\n    });\n\n    return {\n      headers: ['datum', 'bedrag', 'omschrijving', 'type'],\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van MT940 bestand'\n    };\n  }\n}\n\n/**\n * Mock CODA parser (simplified for demo)\n */\nexport function parseCODA(content: string): CSVParseResult {\n  // Mock implementation - in real app would parse CODA format\n  try {\n    const lines = content.split('\\n').filter(line => line.trim());\n    const rows: CSVRow[] = [];\n    \n    // Simple mock parsing\n    lines.forEach((line, index) => {\n      if (line.startsWith('21') || line.startsWith('22')) {\n        rows.push({\n          datum: `2025-01-${(index % 28) + 1}`,\n          bedrag: (Math.random() * 1000).toFixed(2),\n          omschrijving: `CODA transactie ${index}`,\n          type: Math.random() > 0.5 ? 'C' : 'D'\n        });\n      }\n    });\n\n    return {\n      headers: ['datum', 'bedrag', 'omschrijving', 'type'],\n      rows,\n      success: true\n    };\n  } catch (error) {\n    return {\n      headers: [],\n      rows: [],\n      success: false,\n      error: 'Fout bij het parseren van CODA bestand'\n    };\n  }\n}\n\n/**\n * Export transactions to CSV\n */\nexport function exportToCSV(data: any[], filename: string = 'transacties.csv'): void {\n  if (data.length === 0) return;\n  \n  const headers = Object.keys(data[0]);\n  const csvContent = [\n    headers.join(';'),\n    ...data.map(row => \n      headers.map(header => {\n        const value = row[header];\n        return typeof value === 'string' && value.includes(';') \n          ? `\"${value}\"` \n          : value;\n      }).join(';')\n    )\n  ].join('\\n');\n  \n  const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n  const link = document.createElement('a');\n  link.href = URL.createObjectURL(blob);\n  link.download = filename;\n  link.click();\n  URL.revokeObjectURL(link.href);\n}","size_bytes":3903},"lib/format.ts":{"content":"import { format, parseISO } from 'date-fns';\nimport { nl } from 'date-fns/locale';\n\n/**\n * Format a date to Belgian format (dd-mm-jjjj)\n */\nexport function formatDateBE(date: string | Date): string {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date;\n  return format(dateObj, 'dd-MM-yyyy', { locale: nl });\n}\n\n/**\n * Format a date to Belgian short format (dd-mm)\n */\nexport function formatDateShortBE(date: string | Date): string {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date;\n  return format(dateObj, 'dd-MM', { locale: nl });\n}\n\n/**\n * Format a date to month year format (januari 2025)\n */\nexport function formatMonthYearBE(date: string | Date): string {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date;\n  return format(dateObj, 'MMMM yyyy', { locale: nl });\n}\n\n/**\n * Format currency to Belgian format (€ 1.234,56)\n */\nexport function formatCurrencyBE(amount: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    style: 'currency',\n    currency: 'EUR',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\n/**\n * Format currency without symbol (1.234,56)\n */\nexport function formatAmountBE(amount: number): string {\n  return new Intl.NumberFormat('nl-BE', {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(amount);\n}\n\n/**\n * Parse Belgian date format (dd-mm-jjjj) to ISO string\n */\nexport function parseDateBE(dateString: string): string {\n  const [day, month, year] = dateString.split('-');\n  return new Date(`${year}-${month}-${day}`).toISOString().split('T')[0];\n}\n\n/**\n * Get relative time in Dutch\n */\nexport function getRelativeTimeBE(date: string | Date): string {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date;\n  const now = new Date();\n  const diffInDays = Math.floor((now.getTime() - dateObj.getTime()) / (1000 * 60 * 60 * 24));\n  \n  if (diffInDays === 0) return 'Vandaag';\n  if (diffInDays === 1) return 'Gisteren';\n  if (diffInDays < 7) return `${diffInDays} dagen geleden`;\n  if (diffInDays < 30) return `${Math.floor(diffInDays / 7)} weken geleden`;\n  if (diffInDays < 365) return `${Math.floor(diffInDays / 30)} maanden geleden`;\n  return `${Math.floor(diffInDays / 365)} jaar geleden`;\n}","size_bytes":2254},"lib/mock/transactions.ts":{"content":"export type Transaction = {\n  id: string;\n  date: string; // ISO\n  type: 'INCOME' | 'EXPENSE';\n  category: string;\n  memberId?: string;\n  memberName?: string;\n  amount: number; // €\n  method: 'SEPA' | 'OVERSCHRIJVING' | 'BANCONTACT' | 'CASH';\n  description?: string;\n};\n\nexport const categories = {\n  INCOME: [\n    'Lidgeld',\n    'Donatie',\n    'Evenement',\n    'Verhuur',\n    'Subsidie',\n    'Verkoop',\n    'Overig inkomen'\n  ],\n  EXPENSE: [\n    'Huur',\n    'Nutsvoorzieningen',\n    'Onderhoud',\n    'Evenement',\n    'Administratie',\n    'Verzekeringen',\n    'Schoonmaak',\n    'Overig uitgaven'\n  ]\n};\n\n// Mock members voor selectie\nexport const mockMembers = [\n  { id: 'm1', name: 'Emma van den Berg' },\n  { id: 'm2', name: 'Ahmed Hassan' },\n  { id: 'm3', name: 'Maria Santos' },\n  { id: 'm4', name: 'Jan Peeters' },\n  { id: 'm5', name: 'Fatima Al-Rashid' },\n  { id: 'm6', name: 'Pieter Vandenberghe' },\n  { id: 'm7', name: 'Layla Benali' },\n  { id: 'm8', name: 'Thomas De Vries' },\n  { id: 'm9', name: 'Zeinab Khalil' },\n  { id: 'm10', name: 'Lucas Martens' }\n];\n\n// Generate comprehensive mock transaction data\nexport const transactions: Transaction[] = [\n  // Januari 2025 - Inkomsten\n  { id: 't1', date: '2025-01-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm1', memberName: 'Emma van den Berg', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't2', date: '2025-01-13', type: 'INCOME', category: 'Lidgeld', memberId: 'm2', memberName: 'Ahmed Hassan', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't3', date: '2025-01-14', type: 'INCOME', category: 'Lidgeld', memberId: 'm3', memberName: 'Maria Santos', amount: 120, method: 'OVERSCHRIJVING', description: 'Lidgeld 2025' },\n  { id: 't4', date: '2025-01-15', type: 'INCOME', category: 'Lidgeld', memberId: 'm4', memberName: 'Jan Peeters', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't5', date: '2025-01-16', type: 'INCOME', category: 'Lidgeld', memberId: 'm5', memberName: 'Fatima Al-Rashid', amount: 120, method: 'SEPA', description: 'Lidgeld 2025' },\n  { id: 't6', date: '2025-01-20', type: 'INCOME', category: 'Donatie', amount: 250, method: 'CASH', description: 'Vrijwillige gift ramadan' },\n  { id: 't7', date: '2025-01-22', type: 'INCOME', category: 'Donatie', amount: 500, method: 'OVERSCHRIJVING', description: 'Donatie moskee renovatie' },\n  { id: 't8', date: '2025-01-25', type: 'INCOME', category: 'Evenement', amount: 1250, method: 'BANCONTACT', description: 'Nieuwjaarsbijeenkomst inschrijvingen' },\n  { id: 't9', date: '2025-01-28', type: 'INCOME', category: 'Verhuur', amount: 300, method: 'OVERSCHRIJVING', description: 'Zaalhuur bruiloft weekend' },\n\n  // Januari 2025 - Uitgaven\n  { id: 't10', date: '2025-01-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur januari 2025' },\n  { id: 't11', date: '2025-01-18', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 180, method: 'OVERSCHRIJVING', description: 'Elektriciteit januari' },\n  { id: 't12', date: '2025-01-20', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 85, method: 'OVERSCHRIJVING', description: 'Gas verwarming januari' },\n  { id: 't13', date: '2025-01-22', type: 'EXPENSE', category: 'Onderhoud', amount: 320, method: 'BANCONTACT', description: 'Loodgieter sanitair reparatie' },\n  { id: 't14', date: '2025-01-24', type: 'EXPENSE', category: 'Schoonmaak', amount: 150, method: 'CASH', description: 'Schoonmaakproducten en materiaal' },\n  { id: 't15', date: '2025-01-26', type: 'EXPENSE', category: 'Administratie', amount: 45, method: 'OVERSCHRIJVING', description: 'Bankkosten en administratie' },\n  { id: 't16', date: '2025-01-30', type: 'EXPENSE', category: 'Evenement', amount: 280, method: 'CASH', description: 'Catering nieuwjaarsbijeenkomst' },\n\n  // December 2024 - Voor historische data\n  { id: 't17', date: '2024-12-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm6', memberName: 'Pieter Vandenberghe', amount: 120, method: 'SEPA', description: 'Lidgeld december 2024' },\n  { id: 't18', date: '2024-12-15', type: 'INCOME', category: 'Lidgeld', memberId: 'm7', memberName: 'Layla Benali', amount: 120, method: 'SEPA', description: 'Lidgeld december 2024' },\n  { id: 't19', date: '2024-12-18', type: 'INCOME', category: 'Subsidie', amount: 2500, method: 'OVERSCHRIJVING', description: 'Gemeentelijke subsidie religieuze activiteiten' },\n  { id: 't20', date: '2024-12-22', type: 'INCOME', category: 'Donatie', amount: 800, method: 'OVERSCHRIJVING', description: 'Eid al-Mawlid donaties' },\n  \n  { id: 't21', date: '2024-12-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur december 2024' },\n  { id: 't22', date: '2024-12-20', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 220, method: 'OVERSCHRIJVING', description: 'Elektriciteit december (verwarming)' },\n  { id: 't23', date: '2024-12-25', type: 'EXPENSE', category: 'Evenement', amount: 450, method: 'CASH', description: 'Eid al-Mawlid viering kosten' },\n\n  // November 2024\n  { id: 't24', date: '2024-11-10', type: 'INCOME', category: 'Lidgeld', memberId: 'm8', memberName: 'Thomas De Vries', amount: 120, method: 'SEPA', description: 'Lidgeld november 2024' },\n  { id: 't25', date: '2024-11-12', type: 'INCOME', category: 'Lidgeld', memberId: 'm9', memberName: 'Zeinab Khalil', amount: 120, method: 'SEPA', description: 'Lidgeld november 2024' },\n  { id: 't26', date: '2024-11-18', type: 'INCOME', category: 'Verkoop', amount: 320, method: 'BANCONTACT', description: 'Verkoop islamitische boeken en materiaal' },\n  \n  { id: 't27', date: '2024-11-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur november 2024' },\n  { id: 't28', date: '2024-11-22', type: 'EXPENSE', category: 'Verzekeringen', amount: 180, method: 'OVERSCHRIJVING', description: 'Gebouwverzekering kwartaal' },\n  { id: 't29', date: '2024-11-25', type: 'EXPENSE', category: 'Onderhoud', amount: 125, method: 'CASH', description: 'Kleine herstellingen en onderhoud' },\n\n  // Oktober 2024\n  { id: 't30', date: '2024-10-08', type: 'INCOME', category: 'Lidgeld', memberId: 'm10', memberName: 'Lucas Martens', amount: 120, method: 'SEPA', description: 'Lidgeld oktober 2024' },\n  { id: 't31', date: '2024-10-12', type: 'INCOME', category: 'Evenement', amount: 890, method: 'BANCONTACT', description: 'Islamitische cursussen inschrijvingen' },\n  { id: 't32', date: '2024-10-20', type: 'INCOME', category: 'Donatie', amount: 650, method: 'OVERSCHRIJVING', description: 'Donaties gebedsruimte uitbreiding' },\n  \n  { id: 't33', date: '2024-10-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur oktober 2024' },\n  { id: 't34', date: '2024-10-18', type: 'EXPENSE', category: 'Nutsvoorzieningen', amount: 145, method: 'OVERSCHRIJVING', description: 'Elektriciteit oktober' },\n  { id: 't35', date: '2024-10-25', type: 'EXPENSE', category: 'Administratie', amount: 85, method: 'OVERSCHRIJVING', description: 'Boekhouding en administratieve kosten' },\n\n  // Extra transacties voor completere dataset\n  { id: 't36', date: '2024-09-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur september 2024' },\n  { id: 't37', date: '2024-09-20', type: 'INCOME', category: 'Verhuur', amount: 450, method: 'OVERSCHRIJVING', description: 'Zaalhuur evenement weekend' },\n  { id: 't38', date: '2024-08-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur augustus 2024' },\n  { id: 't39', date: '2024-08-25', type: 'INCOME', category: 'Donatie', amount: 1500, method: 'OVERSCHRIJVING', description: 'Eid al-Adha donaties' },\n  { id: 't40', date: '2024-07-15', type: 'EXPENSE', category: 'Huur', amount: 1200, method: 'OVERSCHRIJVING', description: 'Zaalhuur juli 2024' },\n\n  // Meer recente transacties voor uitgebreidere data\n  { id: 't41', date: '2025-01-31', type: 'INCOME', category: 'Lidgeld', memberId: 'm1', memberName: 'Emma van den Berg', amount: 120, method: 'SEPA', description: 'Lidgeld februari vooruitbetaling' },\n  { id: 't42', date: '2025-01-29', type: 'EXPENSE', category: 'Schoonmaak', amount: 200, method: 'CASH', description: 'Extra schoonmaak na evenement' },\n  { id: 't43', date: '2025-01-27', type: 'INCOME', category: 'Donatie', amount: 75, method: 'CASH', description: 'Vrijdaggebed collecte' },\n  { id: 't44', date: '2025-01-26', type: 'EXPENSE', category: 'Onderhoud', amount: 95, method: 'BANCONTACT', description: 'Vervangingslampen LED verlichting' },\n  { id: 't45', date: '2025-01-24', type: 'INCOME', category: 'Donatie', amount: 150, method: 'CASH', description: 'Vrijdaggebed collecte' }\n];\n\nexport function generateTransactionId(): string {\n  return 't' + Date.now() + Math.random().toString(36).substr(2, 9);\n}\n\nexport function getTransactionsByDateRange(startDate: string, endDate: string): Transaction[] {\n  return transactions.filter(t => t.date >= startDate && t.date <= endDate);\n}\n\nexport function getTransactionsByType(type: 'INCOME' | 'EXPENSE'): Transaction[] {\n  return transactions.filter(t => t.type === type);\n}\n\nexport function getTransactionsByCategory(category: string): Transaction[] {\n  return transactions.filter(t => t.category === category);\n}\n\nexport function getTotalByType(type: 'INCOME' | 'EXPENSE'): number {\n  return transactions\n    .filter(t => t.type === type)\n    .reduce((sum, t) => sum + t.amount, 0);\n}\n\nexport function getMonthlyTotals(): { month: string; income: number; expense: number }[] {\n  const monthlyData: { [key: string]: { income: number; expense: number } } = {};\n  \n  transactions.forEach(t => {\n    const date = new Date(t.date);\n    const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n    \n    if (!monthlyData[monthKey]) {\n      monthlyData[monthKey] = { income: 0, expense: 0 };\n    }\n    \n    if (t.type === 'INCOME') {\n      monthlyData[monthKey].income += t.amount;\n    } else {\n      monthlyData[monthKey].expense += t.amount;\n    }\n  });\n  \n  return Object.entries(monthlyData)\n    .sort(([a], [b]) => a.localeCompare(b))\n    .map(([month, data]) => ({\n      month,\n      ...data\n    }));\n}\n\nexport function getCategoryTotals(type: 'INCOME' | 'EXPENSE'): { category: string; amount: number }[] {\n  const categoryData: { [key: string]: number } = {};\n  \n  transactions\n    .filter(t => t.type === type)\n    .forEach(t => {\n      categoryData[t.category] = (categoryData[t.category] || 0) + t.amount;\n    });\n  \n  return Object.entries(categoryData)\n    .map(([category, amount]) => ({ category, amount }))\n    .sort((a, b) => b.amount - a.amount);\n}","size_bytes":10731},"lib/server/fees/anchor.ts":{"content":"import { db } from '../../../server/db';\nimport { beNow } from '../time';\n\n/**\n * Get billing anchor for a member. Priority: billingAnchorAt > joinDate > current time\n */\nexport async function getBillingAnchor(memberId: string): Promise<Date> {\n  const member = await db.query.members.findFirst({\n    where: (members, { eq }) => eq(members.id, memberId),\n    with: {\n      financialSettings: true\n    }\n  });\n  \n  if (!member) {\n    throw new Error(`Member ${memberId} not found`);\n  }\n  \n  // Priority: billingAnchorAt > joinDate > current time\n  if (member.financialSettings?.billingAnchorAt) {\n    return new Date(member.financialSettings.billingAnchorAt);\n  }\n  \n  if (member.joinDate) {\n    return new Date(member.joinDate);\n  }\n  \n  return beNow();\n}\n\n/**\n * Set billing anchor for a member\n */\nexport async function setBillingAnchor(memberId: string, anchorDate: Date): Promise<void> {\n  // First, get or create financial settings\n  const existing = await db.query.memberFinancialSettings.findFirst({\n    where: (settings, { eq }) => eq(settings.memberId, memberId)\n  });\n  \n  if (existing) {\n    await db.update(memberFinancialSettings)\n      .set({ billingAnchorAt: anchorDate.toISOString() })\n      .where(eq(memberFinancialSettings.memberId, memberId));\n  } else {\n    await db.insert(memberFinancialSettings).values({\n      memberId,\n      billingAnchorAt: anchorDate.toISOString(),\n      // Set default values for other required fields\n      preferredMethod: 'SEPA',\n      monthlyAmount: 0,\n      yearlyAmount: 0\n    });\n  }\n}\n\n/**\n * Initialize billing anchor for new member if not already set\n */\nexport async function initializeBillingAnchor(memberId: string, joinDate?: Date): Promise<Date> {\n  const anchorDate = joinDate || beNow();\n  await setBillingAnchor(memberId, anchorDate);\n  return anchorDate;\n}","size_bytes":1822},"lib/server/fees/first-fee.ts":{"content":"/**\n * First fee creation logic for new members\n */\n\nimport { db } from '../../../server/db';\nimport { membershipFees, memberFinancialSettings, members } from '../../../shared/schema';\nimport { eq } from 'drizzle-orm';\n\n/**\n * Create the first membership fee for a new member\n */\nexport async function createFirstFeeForMember(memberId: string, joinDate?: Date): Promise<void> {\n  try {\n    // Get member's financial settings\n    const [settings] = await db\n      .select()\n      .from(memberFinancialSettings)\n      .where(eq(memberFinancialSettings.memberId, memberId));\n\n    if (!settings) {\n      throw new Error(`No financial settings found for member ${memberId}`);\n    }\n\n    const anchorDate = joinDate || new Date();\n    const amount = settings.preferredTerm === 'YEARLY' \n      ? parseFloat(settings.yearlyAmount) \n      : parseFloat(settings.monthlyAmount);\n\n    // Get member details for the fee record\n    const [member] = await db.select().from(members).where(eq(members.id, memberId));\n    if (!member) {\n      throw new Error(`Member ${memberId} not found`);\n    }\n\n    // Create the first fee\n    await db.insert(membershipFees).values({\n      tenantId: member.tenantId,\n      memberId,\n      memberNumber: member.memberNumber,\n      memberName: `${member.firstName} ${member.lastName}`,\n      amount: amount.toString(),\n      status: 'OPEN',\n      periodStart: anchorDate,\n      periodEnd: getNextPeriodEnd(anchorDate, settings.preferredTerm)\n    });\n\n  } catch (error) {\n    console.error('Error creating first fee:', error);\n    throw error;\n  }\n}\n\n/**\n * Calculate the end date for the next period\n */\nfunction getNextPeriodEnd(startDate: Date, term: 'MONTHLY' | 'YEARLY'): Date {\n  const endDate = new Date(startDate);\n  \n  if (term === 'MONTHLY') {\n    endDate.setMonth(endDate.getMonth() + 1);\n  } else {\n    endDate.setFullYear(endDate.getFullYear() + 1);\n  }\n  \n  // Subtract 1 day to get the last day of the period\n  endDate.setDate(endDate.getDate() - 1);\n  \n  return endDate;\n}","size_bytes":2005},"lib/server/fees/generator.ts":{"content":"/**\n * Fee generation logic for all tenants and members\n */\n\nimport { db } from '../../../server/db';\nimport { members, memberFinancialSettings, membershipFees } from '../../../shared/schema';\nimport { eq, and, or, lt } from 'drizzle-orm';\n\n/**\n * Generate fees for all members of a tenant\n */\nexport async function generateTenantFees(\n  tenantId: string, \n  asOf: Date, \n  strategy: 'current' | 'catchup' = 'current'\n): Promise<void> {\n  console.log(`Generating fees for tenant ${tenantId} as of ${asOf.toISOString()} with strategy: ${strategy}`);\n\n  try {\n    // Get all active members with their financial settings\n    const membersWithSettings = await db\n      .select({\n        member: members,\n        settings: memberFinancialSettings\n      })\n      .from(members)\n      .leftJoin(memberFinancialSettings, eq(members.id, memberFinancialSettings.memberId))\n      .where(and(\n        eq(members.tenantId, tenantId),\n        eq(members.active, true)\n      ));\n\n    let feesGenerated = 0;\n\n    for (const { member, settings } of membersWithSettings) {\n      if (!settings) {\n        console.log(`Skipping member ${member.id} - no financial settings`);\n        continue;\n      }\n\n      try {\n        const generated = await generateMemberFees(member.id, settings, asOf, strategy);\n        feesGenerated += generated;\n      } catch (error) {\n        console.error(`Error generating fees for member ${member.id}:`, error);\n        // Continue with next member\n      }\n    }\n\n    console.log(`Generated ${feesGenerated} fees for tenant ${tenantId}`);\n\n  } catch (error) {\n    console.error('Error in generateTenantFees:', error);\n    throw error;\n  }\n}\n\n/**\n * Generate fees for a specific member\n */\nasync function generateMemberFees(\n  memberId: string,\n  settings: any,\n  asOf: Date,\n  strategy: 'current' | 'catchup'\n): Promise<number> {\n  \n  // Get the member's billing anchor date\n  const billingAnchor = new Date(settings.billingAnchorAt);\n  const amount = settings.preferredTerm === 'YEARLY' \n    ? parseFloat(settings.yearlyAmount) \n    : parseFloat(settings.monthlyAmount);\n\n  if (amount <= 0) {\n    console.log(`Skipping member ${memberId} - zero amount`);\n    return 0;\n  }\n\n  // Get existing fees to avoid duplicates\n  const existingFees = await db\n    .select()\n    .from(membershipFees)\n    .where(eq(membershipFees.memberId, memberId));\n\n  const periodsToGenerate = calculatePeriodsToGenerate(\n    billingAnchor, \n    asOf, \n    settings.preferredTerm, \n    existingFees, \n    strategy\n  );\n\n  let generated = 0;\n\n  for (const period of periodsToGenerate) {\n    // Get member details for the fee record\n    const [member] = await db.select().from(members).where(eq(members.id, memberId));\n    if (!member) throw new Error(`Member ${memberId} not found`);\n\n    await db.insert(membershipFees).values({\n      tenantId: member.tenantId,\n      memberId,\n      memberNumber: member.memberNumber,\n      memberName: `${member.firstName} ${member.lastName}`,\n      amount: amount.toString(),\n      status: 'OPEN',\n      periodStart: period.start,\n      periodEnd: period.end\n    });\n    generated++;\n  }\n\n  return generated;\n}\n\n/**\n * Calculate which periods need fees generated\n */\nfunction calculatePeriodsToGenerate(\n  anchor: Date,\n  asOf: Date,\n  term: 'MONTHLY' | 'YEARLY',\n  existingFees: any[],\n  strategy: 'current' | 'catchup'\n): { start: Date; end: Date }[] {\n  \n  const periods: { start: Date; end: Date }[] = [];\n  const current = new Date(anchor);\n\n  // Find existing period starts to avoid duplicates\n  const existingStarts = new Set(\n    existingFees.map(fee => new Date(fee.periodStart).getTime())\n  );\n\n  while (current <= asOf) {\n    const periodStart = new Date(current);\n    const periodEnd = new Date(current);\n    \n    if (term === 'MONTHLY') {\n      periodEnd.setMonth(periodEnd.getMonth() + 1);\n    } else {\n      periodEnd.setFullYear(periodEnd.getFullYear() + 1);\n    }\n    \n    periodEnd.setDate(periodEnd.getDate() - 1);\n\n    // Only add if we don't already have a fee for this period\n    if (!existingStarts.has(periodStart.getTime())) {\n      periods.push({ start: periodStart, end: periodEnd });\n    }\n\n    // Move to next period\n    if (term === 'MONTHLY') {\n      current.setMonth(current.getMonth() + 1);\n    } else {\n      current.setFullYear(current.getFullYear() + 1);\n    }\n  }\n\n  return periods;\n}","size_bytes":4344},"lib/server/fees/periods.ts":{"content":"import { addMonths, addYears, isAfter, subMilliseconds } from 'date-fns';\nimport { fromZonedTime, toZonedTime } from 'date-fns-tz';\n\nconst TZ = 'Europe/Brussels';\n\n/**\n * Clamp day to valid day in target month (handles edge cases like Jan 31 -> Feb 28/29)\n */\nfunction clampDay(year: number, monthIndex0: number, day: number): Date {\n  // Create date; JS auto-clamps overflow days (31 → next month),\n  // so build on the 1st, then set day min(lastDay, desired).\n  const base = new Date(Date.UTC(year, monthIndex0 + 1, 0, 0, 0, 0, 0)); // last day of month in UTC\n  const last = base.getUTCDate();\n  const d = Math.min(last, day);\n  return new Date(Date.UTC(year, monthIndex0, d, 0, 0, 0, 0));\n}\n\n/**\n * Add months to a Brussels-anchored date, clamping day if necessary\n */\nexport function addMonthsClamped(beAnchor: Date, months: number): Date {\n  // Keep local wall-clock day/hour/min/sec of anchor in Brussels.\n  const z = toZonedTime(beAnchor, TZ);\n  const y = z.getFullYear();\n  const m = z.getMonth();\n  const d = z.getDate();\n  const hh = z.getHours(), mm = z.getMinutes(), ss = z.getSeconds(), ms = z.getMilliseconds();\n\n  const target = clampDay(y, m + months, d);\n  target.setUTCHours(hh, mm, ss, ms);\n  return fromZonedTime(target, TZ);\n}\n\n/**\n * Add years to a Brussels-anchored date, clamping day if necessary (leap year Feb 29 -> Feb 28)\n */\nexport function addYearsClamped(beAnchor: Date, years: number): Date {\n  const z = toZonedTime(beAnchor, TZ);\n  const y = z.getFullYear();\n  const m = z.getMonth();\n  const d = z.getDate();\n  const hh = z.getHours(), mm = z.getMinutes(), ss = z.getSeconds(), ms = z.getMilliseconds();\n\n  const target = clampDay(y + years, m, d);\n  target.setUTCHours(hh, mm, ss, ms);\n  return fromZonedTime(target, TZ);\n}\n\n/**\n * Find the rolling period start that contains asOf date\n */\nexport function floorToRollingStart(anchor: Date, asOf: Date, term: 'MONTHLY' | 'YEARLY'): Date {\n  let start = anchor;\n  if (isAfter(start, asOf)) {\n    // If anchor is in the future, current period is [anchor, anchor+term)\n    return anchor;\n  }\n  \n  if (term === 'MONTHLY') {\n    // Compute how many months between anchor and asOf approximately, then correct.\n    let s = anchor;\n    const zA = utcToZonedTime(anchor, TZ);\n    const zB = utcToZonedTime(asOf, TZ);\n    const approxMonths = (zB.getFullYear() - zA.getFullYear()) * 12 + (zB.getMonth() - zA.getMonth());\n    s = addMonthsClamped(anchor, approxMonths);\n    if (isAfter(s, asOf)) s = addMonthsClamped(anchor, approxMonths - 1);\n    // Walk forward until next > asOf\n    while (!isAfter(addMonthsClamped(s, 1), asOf)) {\n      s = addMonthsClamped(s, 1);\n    }\n    return s;\n  } else {\n    let s = anchor;\n    const zA = utcToZonedTime(anchor, TZ);\n    const zB = utcToZonedTime(asOf, TZ);\n    const approxYears = (zB.getFullYear() - zA.getFullYear());\n    s = addYearsClamped(anchor, approxYears);\n    if (isAfter(s, asOf)) s = addYearsClamped(anchor, approxYears - 1);\n    while (!isAfter(addYearsClamped(s, 1), asOf)) {\n      s = addYearsClamped(s, 1);\n    }\n    return s;\n  }\n}\n\n/**\n * Calculate monthly rolling period that contains asOf date\n */\nexport function rollingMonthly(anchor: Date, asOf: Date) {\n  const start = floorToRollingStart(anchor, asOf, 'MONTHLY');\n  const nextStart = addMonthsClamped(start, 1);\n  const end = subMilliseconds(nextStart, 1);\n  return { start, end, nextStart };\n}\n\n/**\n * Calculate yearly rolling period that contains asOf date\n */\nexport function rollingYearly(anchor: Date, asOf: Date) {\n  const start = floorToRollingStart(anchor, asOf, 'YEARLY');\n  const nextStart = addYearsClamped(start, 1);\n  const end = subMilliseconds(nextStart, 1);\n  return { start, end, nextStart };\n}\n\n/**\n * Calculate the next rolling period after the given start\n */\nexport function nextRollingPeriod(start: Date, term: 'MONTHLY' | 'YEARLY') {\n  const nextStart = term === 'MONTHLY' ? addMonthsClamped(start, 1) : addYearsClamped(start, 1);\n  const end = subMilliseconds(nextStart, 1);\n  return { start: nextStart, end };\n}\n\n/**\n * Calculate rolling period for given anchor, asOf date and term\n */\nexport function getRollingPeriod(anchor: Date, asOf: Date, term: 'MONTHLY' | 'YEARLY') {\n  return term === 'MONTHLY' ? rollingMonthly(anchor, asOf) : rollingYearly(anchor, asOf);\n}","size_bytes":4290},"lib/server/time.ts":{"content":"/**\n * Time utilities for Belgian timezone and date handling\n */\n\n/**\n * Get current time in Belgian timezone\n */\nexport function beNow(): Date {\n  return new Date();\n}\n\n/**\n * Format date to Belgian timezone\n */\nexport function formatBEDate(date: Date): string {\n  return date.toLocaleDateString('nl-BE');\n}\n\n/**\n * Get Belgian timezone offset\n */\nexport function getBETimezoneOffset(): number {\n  // Belgium is UTC+1 (CET) or UTC+2 (CEST)\n  return -60; // in minutes\n}","size_bytes":470},"lib/zod/transaction.ts":{"content":"import { z } from 'zod';\n\nexport const TransactionSchema = z.object({\n  type: z.enum(['INCOME', 'EXPENSE'], {\n    required_error: 'Type is verplicht',\n    invalid_type_error: 'Selecteer Inkomsten of Uitgaven'\n  }),\n  date: z.string().min(1, 'Datum is verplicht'),\n  category: z.string().min(2, 'Categorie moet minimaal 2 karakters bevatten'),\n  amount: z.number({\n    required_error: 'Bedrag is verplicht',\n    invalid_type_error: 'Bedrag moet een getal zijn'\n  }).positive('Bedrag moet groter zijn dan 0'),\n  method: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH'], {\n    required_error: 'Betaalmethode is verplicht'\n  }),\n  memberId: z.string().optional(),\n  memberName: z.string().optional(),\n  description: z.string().max(500, 'Omschrijving mag maximaal 500 karakters bevatten').optional()\n});\n\nexport type TransactionFormData = z.infer<typeof TransactionSchema>;\n\nexport const ImportMappingSchema = z.object({\n  dateColumn: z.string().min(1, 'Selecteer een datumkolom'),\n  amountColumn: z.string().min(1, 'Selecteer een bedragkolom'),\n  descriptionColumn: z.string().optional(),\n  categoryColumn: z.string().optional()\n});\n\nexport type ImportMappingData = z.infer<typeof ImportMappingSchema>;\n\nexport const FilterSchema = z.object({\n  search: z.string().optional(),\n  type: z.enum(['ALL', 'INCOME', 'EXPENSE']).optional().default('ALL'),\n  category: z.string().optional(),\n  method: z.enum(['ALL', 'SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']).optional().default('ALL'),\n  memberId: z.string().optional(),\n  dateFrom: z.string().optional(),\n  dateTo: z.string().optional(),\n  amountMin: z.number().optional(),\n  amountMax: z.number().optional()\n});\n\nexport type FilterData = z.infer<typeof FilterSchema>;","size_bytes":1720},"server/api/jobs/fees/generate.ts":{"content":"import { Request, Response } from 'express';\nimport { z } from 'zod';\nimport { generateTenantFees } from '../../../../lib/server/fees/generator';\nimport { beNow } from '../../../../lib/server/time';\n\nconst generateFeesSchema = z.object({\n  tenantId: z.string().optional(),\n  asOf: z.string().optional().transform(val => val ? new Date(val) : undefined),\n  strategy: z.enum(['current', 'catchup']).default('current')\n});\n\nexport async function generateFeesHandler(req: Request, res: Response) {\n  try {\n    // Check authorization header (should contain API key or JWT)\n    const authHeader = req.headers.authorization;\n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res.status(401).json({ error: 'Missing or invalid authorization header' });\n    }\n\n    // TODO: Validate the token/API key here\n    // For now, we'll accept any Bearer token\n\n    const body = generateFeesSchema.parse(req.body);\n    const { tenantId, asOf, strategy } = body;\n\n    // If no tenantId provided, try to get from request context (middleware)\n    const targetTenantId = tenantId || (req as any).tenantId;\n    \n    if (!targetTenantId) {\n      return res.status(400).json({ error: 'tenantId is required' });\n    }\n\n    const currentTime = asOf || beNow();\n\n    await generateTenantFees(targetTenantId, currentTime, strategy);\n\n    res.json({\n      success: true,\n      message: `Fees generated successfully for tenant ${targetTenantId}`,\n      strategy,\n      asOf: currentTime.toISOString()\n    });\n\n  } catch (error) {\n    console.error('Fee generation error:', error);\n    \n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ \n        error: 'Validation error', \n        details: error.errors \n      });\n    }\n\n    res.status(500).json({ \n      error: 'Internal server error',\n      message: error instanceof Error ? error.message : 'Unknown error'\n    });\n  }\n}","size_bytes":1888},"server/api/members/create.ts":{"content":"import { Request, Response } from 'express';\nimport { z } from 'zod';\nimport { db } from '../../db';\nimport { members, memberFinancialSettings, tenants } from '../../../shared/schema';\nimport { eq } from 'drizzle-orm';\nimport { createFirstFeeForMember } from '../../../lib/server/fees/first-fee';\nimport { beNow } from '../../../lib/server/time';\n\nconst createMemberSchema = z.object({\n  memberNumber: z.string(),\n  firstName: z.string(),\n  lastName: z.string(),\n  gender: z.enum(['M', 'V']),\n  birthDate: z.string().optional().transform(val => val ? new Date(val) : undefined),\n  category: z.enum(['STUDENT', 'VOLWASSEN', 'SENIOR']),\n  email: z.string().email().optional(),\n  phone: z.string().optional(),\n  street: z.string().optional(),\n  number: z.string().optional(),\n  postalCode: z.string().optional(),\n  city: z.string().optional(),\n  country: z.string().optional(),\n  joinDate: z.string().optional().transform(val => val ? new Date(val) : undefined),\n  \n  // Financial settings\n  preferredMethod: z.enum(['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH']),\n  preferredTerm: z.enum(['MONTHLY', 'YEARLY']),\n  monthlyAmount: z.number().default(0),\n  yearlyAmount: z.number().default(0),\n  iban: z.string().optional(),\n  sepaMandate: z.string().optional(),\n});\n\nexport async function createMemberHandler(req: Request, res: Response) {\n  try {\n    const tenantId = (req as any).tenantId;\n    if (!tenantId) {\n      return res.status(400).json({ error: 'Tenant context required' });\n    }\n\n    const body = createMemberSchema.parse(req.body);\n    const joinDate = body.joinDate || beNow();\n\n    // Start transaction\n    const result = await db.transaction(async (tx) => {\n      // Create member\n      const [member] = await tx.insert(members).values({\n        tenantId,\n        memberNumber: body.memberNumber,\n        firstName: body.firstName,\n        lastName: body.lastName,\n        gender: body.gender,\n        birthDate: body.birthDate,\n        category: body.category,\n        email: body.email,\n        phone: body.phone,\n        street: body.street,\n        number: body.number,\n        postalCode: body.postalCode,\n        city: body.city,\n        country: body.country,\n        active: true\n      }).returning();\n\n      // Get tenant settings for calculating amounts\n      const tenant = await tx.select().from(tenants).where(eq(tenants.id, tenantId)).limit(1);\n      const tenantData = tenant[0];\n      \n      // Calculate amounts based on category and tenant settings\n      let yearlyAmount = parseFloat(tenantData?.adultFee || '25.00'); // Default for VOLWASSEN\n      if (body.category === 'STUDENT') yearlyAmount = parseFloat(tenantData?.studentFee || '15.00');\n      if (body.category === 'SENIOR') yearlyAmount = parseFloat(tenantData?.seniorFee || '20.00');\n      \n      const monthlyAmount = yearlyAmount / 12;\n\n      // Create financial settings\n      await tx.insert(memberFinancialSettings).values({\n        memberId: member.id,\n        paymentMethod: body.preferredMethod,\n        paymentTerm: body.preferredTerm,\n        monthlyAmount: monthlyAmount.toString(),\n        yearlyAmount: yearlyAmount.toString(),\n        iban: body.iban\n      });\n\n      return member;\n    });\n\n    // Create first fee (outside transaction to avoid issues)\n    try {\n      await createFirstFeeForMember(result.id, joinDate);\n    } catch (feeError) {\n      console.error('Failed to create first fee:', feeError);\n      // Don't fail the member creation, just log the error\n    }\n\n    res.status(201).json({\n      success: true,\n      member: result,\n      message: 'Member created successfully with first fee'\n    });\n\n  } catch (error) {\n    console.error('Member creation error:', error);\n    \n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ \n        error: 'Validation error', \n        details: error.errors \n      });\n    }\n\n    res.status(500).json({ \n      error: 'Internal server error',\n      message: error instanceof Error ? error.message : 'Unknown error'\n    });\n  }\n}","size_bytes":4010},"tests/fees/generator.rolling.test.ts":{"content":"import { describe, it, expect, beforeEach, vi } from 'vitest';\nimport { ensureCurrentRollingFeeForMember, generateTenantFees } from '../../lib/server/fees/generator';\n\n// Mock dependencies\nvi.mock('../../lib/server/db', () => ({\n  db: {\n    query: {\n      members: {\n        findFirst: vi.fn(),\n        findMany: vi.fn()\n      },\n      membershipFees: {\n        findFirst: vi.fn()\n      }\n    },\n    insert: vi.fn().mockReturnValue({\n      values: vi.fn()\n    })\n  }\n}));\n\nvi.mock('../../lib/server/fees/anchor', () => ({\n  getBillingAnchor: vi.fn()\n}));\n\nvi.mock('../../lib/server/time', () => ({\n  beNow: vi.fn(),\n  toUtcISO: vi.fn((date) => date.toISOString())\n}));\n\nimport { db } from '../../lib/server/db';\nimport { getBillingAnchor } from '../../lib/server/fees/anchor';\nimport { beNow } from '../../lib/server/time';\n\ndescribe('Fee Generator', () => {\n  beforeEach(() => {\n    vi.clearAllMocks();\n  });\n\n  describe('ensureCurrentRollingFeeForMember', () => {\n    it('should create fee for active member with no existing fee', async () => {\n      const memberId = 'member-123';\n      const anchor = new Date('2025-01-15T10:00:00.000Z');\n      const asOf = new Date('2025-06-01T12:00:00.000Z');\n\n      // Mock getBillingAnchor\n      (getBillingAnchor as any).mockResolvedValue(anchor);\n\n      // Mock member with financial settings\n      (db.query.members.findFirst as any).mockResolvedValue({\n        id: memberId,\n        tenantId: 'tenant-123',\n        memberNumber: 'M001',\n        firstName: 'John',\n        lastName: 'Doe',\n        isActive: true,\n        financialSettings: {\n          preferredTerm: 'MONTHLY',\n          preferredMethod: 'SEPA',\n          monthlyAmount: 25.00,\n          yearlyAmount: 300.00,\n          sepaMandate: 'MANDATE-123'\n        }\n      });\n\n      // Mock no existing fee\n      (db.query.membershipFees.findFirst as any).mockResolvedValue(null);\n\n      // Mock insert\n      const mockInsert = {\n        values: vi.fn()\n      };\n      (db.insert as any).mockReturnValue(mockInsert);\n\n      await ensureCurrentRollingFeeForMember(memberId, asOf);\n\n      expect(getBillingAnchor).toHaveBeenCalledWith(memberId);\n      expect(db.query.members.findFirst).toHaveBeenCalled();\n      expect(db.query.membershipFees.findFirst).toHaveBeenCalled();\n      expect(db.insert).toHaveBeenCalled();\n      expect(mockInsert.values).toHaveBeenCalledWith(\n        expect.objectContaining({\n          tenantId: 'tenant-123',\n          memberId,\n          memberNumber: 'M001',\n          memberName: 'John Doe',\n          amount: 25.00,\n          method: 'SEPA',\n          status: 'OPEN',\n          sepaEligible: true\n        })\n      );\n    });\n\n    it('should skip inactive members', async () => {\n      const memberId = 'member-456';\n      \n      (getBillingAnchor as any).mockResolvedValue(new Date());\n      (db.query.members.findFirst as any).mockResolvedValue({\n        id: memberId,\n        isActive: false\n      });\n\n      await ensureCurrentRollingFeeForMember(memberId);\n\n      expect(db.query.membershipFees.findFirst).not.toHaveBeenCalled();\n      expect(db.insert).not.toHaveBeenCalled();\n    });\n\n    it('should skip members with zero amount', async () => {\n      const memberId = 'member-789';\n      \n      (getBillingAnchor as any).mockResolvedValue(new Date());\n      (db.query.members.findFirst as any).mockResolvedValue({\n        id: memberId,\n        isActive: true,\n        financialSettings: {\n          preferredTerm: 'MONTHLY',\n          monthlyAmount: 0,\n          yearlyAmount: 0\n        }\n      });\n\n      await ensureCurrentRollingFeeForMember(memberId);\n\n      expect(db.query.membershipFees.findFirst).not.toHaveBeenCalled();\n      expect(db.insert).not.toHaveBeenCalled();\n    });\n\n    it('should not duplicate existing fees', async () => {\n      const memberId = 'member-existing';\n      \n      (getBillingAnchor as any).mockResolvedValue(new Date('2025-01-15T10:00:00.000Z'));\n      (db.query.members.findFirst as any).mockResolvedValue({\n        id: memberId,\n        isActive: true,\n        financialSettings: {\n          preferredTerm: 'MONTHLY',\n          monthlyAmount: 25.00\n        }\n      });\n\n      // Mock existing fee\n      (db.query.membershipFees.findFirst as any).mockResolvedValue({\n        id: 'fee-123',\n        memberId\n      });\n\n      await ensureCurrentRollingFeeForMember(memberId);\n\n      expect(db.insert).not.toHaveBeenCalled();\n    });\n  });\n\n  describe('generateTenantFees', () => {\n    it('should process all active members in tenant', async () => {\n      const tenantId = 'tenant-abc';\n      const members = [\n        {\n          id: 'member-1',\n          isActive: true,\n          financialSettings: { preferredTerm: 'MONTHLY', monthlyAmount: 25 }\n        },\n        {\n          id: 'member-2',\n          isActive: true,\n          financialSettings: { preferredTerm: 'YEARLY', yearlyAmount: 300 }\n        }\n      ];\n\n      (db.query.members.findMany as any).mockResolvedValue(members);\n      (beNow as any).mockReturnValue(new Date('2025-06-01T12:00:00.000Z'));\n\n      // Mock the other calls for each member\n      (getBillingAnchor as any).mockResolvedValue(new Date('2025-01-15T10:00:00.000Z'));\n      (db.query.members.findFirst as any).mockImplementation(({ where }) => {\n        const memberId = where.toString(); // Simplified for test\n        return Promise.resolve(members.find(m => m.id.includes(memberId.slice(-1))));\n      });\n      (db.query.membershipFees.findFirst as any).mockResolvedValue(null);\n\n      const mockInsert = { values: vi.fn() };\n      (db.insert as any).mockReturnValue(mockInsert);\n\n      await generateTenantFees(tenantId, undefined, 'current');\n\n      expect(db.query.members.findMany).toHaveBeenCalledWith(\n        expect.objectContaining({\n          where: expect.anything(),\n          with: { financialSettings: true }\n        })\n      );\n    });\n\n    it('should handle errors gracefully and continue with other members', async () => {\n      const tenantId = 'tenant-error';\n      const members = [\n        { id: 'member-1', isActive: true, financialSettings: {} },\n        { id: 'member-2', isActive: true, financialSettings: {} }\n      ];\n\n      (db.query.members.findMany as any).mockResolvedValue(members);\n      (getBillingAnchor as any).mockImplementation((memberId) => {\n        if (memberId === 'member-1') {\n          throw new Error('Test error');\n        }\n        return Promise.resolve(new Date());\n      });\n\n      // Should not throw, but continue processing\n      await expect(generateTenantFees(tenantId)).resolves.toBeUndefined();\n    });\n  });\n\n  describe('Idempotency', () => {\n    it('should not create duplicate fees when run multiple times', async () => {\n      const memberId = 'member-idempotent';\n      const anchor = new Date('2025-01-15T10:00:00.000Z');\n      \n      (getBillingAnchor as any).mockResolvedValue(anchor);\n      (db.query.members.findFirst as any).mockResolvedValue({\n        id: memberId,\n        isActive: true,\n        financialSettings: {\n          preferredTerm: 'MONTHLY',\n          monthlyAmount: 25.00\n        }\n      });\n\n      let callCount = 0;\n      (db.query.membershipFees.findFirst as any).mockImplementation(() => {\n        callCount++;\n        // First call: no existing fee, second call: fee exists\n        return callCount === 1 ? null : { id: 'fee-123', memberId };\n      });\n\n      const mockInsert = { values: vi.fn() };\n      (db.insert as any).mockReturnValue(mockInsert);\n\n      // First run - should create fee\n      await ensureCurrentRollingFeeForMember(memberId);\n      expect(mockInsert.values).toHaveBeenCalledTimes(1);\n\n      // Second run - should not create duplicate\n      await ensureCurrentRollingFeeForMember(memberId);\n      expect(mockInsert.values).toHaveBeenCalledTimes(1); // Still 1, not 2\n    });\n  });\n});","size_bytes":7810},"tests/fees/periods.rolling.test.ts":{"content":"import { describe, it, expect } from 'vitest';\nimport {\n  rollingMonthly,\n  rollingYearly,\n  addMonthsClamped,\n  addYearsClamped,\n  nextRollingPeriod,\n  floorToRollingStart\n} from '../../lib/server/fees/periods';\n\ndescribe('Rolling Period Calculations', () => {\n  describe('addMonthsClamped', () => {\n    it('should handle month overflow correctly', () => {\n      // January 31 + 1 month should clamp to February 28/29\n      const anchor = new Date('2025-01-31T10:00:00.000Z');\n      const result = addMonthsClamped(anchor, 1);\n      \n      // Should be February 28, 2025 (not a leap year)\n      expect(result.getUTCDate()).toBe(28);\n      expect(result.getUTCMonth()).toBe(1); // February (0-indexed)\n      expect(result.getUTCFullYear()).toBe(2025);\n    });\n\n    it('should handle leap year correctly', () => {\n      // January 31, 2024 + 1 month should clamp to February 29 (leap year)\n      const anchor = new Date('2024-01-31T10:00:00.000Z');\n      const result = addMonthsClamped(anchor, 1);\n      \n      expect(result.getUTCDate()).toBe(29);\n      expect(result.getUTCMonth()).toBe(1); // February\n      expect(result.getUTCFullYear()).toBe(2024);\n    });\n  });\n\n  describe('addYearsClamped', () => {\n    it('should handle leap year to non-leap year', () => {\n      // February 29, 2024 + 1 year should clamp to February 28, 2025\n      const anchor = new Date('2024-02-29T10:00:00.000Z');\n      const result = addYearsClamped(anchor, 1);\n      \n      expect(result.getUTCDate()).toBe(28);\n      expect(result.getUTCMonth()).toBe(1); // February\n      expect(result.getUTCFullYear()).toBe(2025);\n    });\n\n    it('should preserve normal dates', () => {\n      const anchor = new Date('2025-03-15T10:00:00.000Z');\n      const result = addYearsClamped(anchor, 1);\n      \n      expect(result.getUTCDate()).toBe(15);\n      expect(result.getUTCMonth()).toBe(2); // March\n      expect(result.getUTCFullYear()).toBe(2026);\n    });\n  });\n\n  describe('rollingMonthly', () => {\n    it('should calculate current monthly period correctly', () => {\n      const anchor = new Date('2025-03-15T10:00:00.000Z');\n      const asOf = new Date('2025-06-01T12:00:00.000Z');\n      \n      const result = rollingMonthly(anchor, asOf);\n      \n      // Current period should be 2025-05-15 10:00 to 2025-06-14 09:59:59.999\n      expect(result.start.getUTCDate()).toBe(15);\n      expect(result.start.getUTCMonth()).toBe(4); // May (0-indexed)\n      expect(result.start.getUTCFullYear()).toBe(2025);\n      \n      expect(result.end.getUTCDate()).toBe(14);\n      expect(result.end.getUTCMonth()).toBe(5); // June\n      expect(result.end.getUTCFullYear()).toBe(2025);\n    });\n\n    it('should handle anchor clamping in February', () => {\n      const anchor = new Date('2025-01-31T09:00:00.000Z');\n      const asOf = new Date('2025-02-15T12:00:00.000Z');\n      \n      const result = rollingMonthly(anchor, asOf);\n      \n      // Should clamp to Feb 28 for the February period\n      expect(result.start.getUTCDate()).toBe(28);\n      expect(result.start.getUTCMonth()).toBe(1); // February\n    });\n  });\n\n  describe('rollingYearly', () => {\n    it('should calculate yearly period correctly', () => {\n      const anchor = new Date('2025-03-10T10:00:00.000Z');\n      const asOf = new Date('2025-06-01T12:00:00.000Z');\n      \n      const result = rollingYearly(anchor, asOf);\n      \n      // Period should be 2025-03-10 10:00 to 2026-03-09 09:59:59.999\n      expect(result.start.getUTCDate()).toBe(10);\n      expect(result.start.getUTCMonth()).toBe(2); // March\n      expect(result.start.getUTCFullYear()).toBe(2025);\n      \n      expect(result.end.getUTCDate()).toBe(9);\n      expect(result.end.getUTCMonth()).toBe(2); // March\n      expect(result.end.getUTCFullYear()).toBe(2026);\n    });\n  });\n\n  describe('nextRollingPeriod', () => {\n    it('should calculate next monthly period', () => {\n      const start = new Date('2025-03-15T10:00:00.000Z');\n      const result = nextRollingPeriod(start, 'MONTHLY');\n      \n      expect(result.start.getUTCDate()).toBe(15);\n      expect(result.start.getUTCMonth()).toBe(3); // April\n      expect(result.start.getUTCFullYear()).toBe(2025);\n    });\n\n    it('should calculate next yearly period', () => {\n      const start = new Date('2025-03-15T10:00:00.000Z');\n      const result = nextRollingPeriod(start, 'YEARLY');\n      \n      expect(result.start.getUTCDate()).toBe(15);\n      expect(result.start.getUTCMonth()).toBe(2); // March\n      expect(result.start.getUTCFullYear()).toBe(2026);\n    });\n  });\n\n  describe('Period Contiguity', () => {\n    it('should ensure periods are contiguous', () => {\n      const anchor = new Date('2025-03-15T10:00:00.000Z');\n      const firstPeriod = rollingMonthly(anchor, anchor);\n      const secondPeriod = nextRollingPeriod(firstPeriod.start, 'MONTHLY');\n      \n      // End of first period + 1ms should equal start of second period\n      const endPlusOne = new Date(firstPeriod.end.getTime() + 1);\n      expect(endPlusOne.getTime()).toBe(secondPeriod.start.getTime());\n    });\n  });\n\n  describe('Edge Cases', () => {\n    it('should handle future anchor date', () => {\n      const anchor = new Date('2025-12-01T10:00:00.000Z');\n      const asOf = new Date('2025-06-01T12:00:00.000Z');\n      \n      const result = rollingMonthly(anchor, asOf);\n      \n      // Current period should be the anchor itself\n      expect(result.start.getTime()).toBe(anchor.getTime());\n    });\n\n    it('should handle DST transitions correctly', () => {\n      // Test around DST transition in Brussels (last Sunday in March)\n      const anchor = new Date('2025-03-15T10:00:00.000Z');\n      const asOf = new Date('2025-04-01T12:00:00.000Z');\n      \n      const result = rollingMonthly(anchor, asOf);\n      \n      // Should maintain the same local time despite DST\n      expect(result.start.getUTCDate()).toBe(15);\n      expect(result.start.getUTCMonth()).toBe(2); // March\n    });\n  });\n});","size_bytes":5908},"client/src/components/public-screens/EditScreenDrawer.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { PublicScreen, publicScreensStore, PaymentMatrixConfig, AnnouncementsConfig } from \"@/lib/mock/public-screens\";\nimport { Sheet, SheetContent, SheetHeader, SheetTitle } from \"@/components/ui/sheet\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Save, ExternalLink, Power, Link2 } from \"lucide-react\";\nimport { MatrixConfigForm } from \"./types/PaymentMatrix/MatrixConfigForm\";\nimport { AnnouncementsConfigForm } from \"./types/Announcements/AnnouncementsConfigForm\";\nimport { PreviewFrame } from \"./PreviewFrame\";\nimport { CopyField } from \"@/components/ui/CopyField\";\n\ninterface EditScreenDrawerProps {\n  screen: PublicScreen | null;\n  onClose: () => void;\n  onSave: (screen: PublicScreen) => void;\n}\n\nexport function EditScreenDrawer({ screen, onClose, onSave }: EditScreenDrawerProps) {\n  const [name, setName] = useState('');\n  const [active, setActive] = useState(false);\n  const [config, setConfig] = useState<PaymentMatrixConfig | AnnouncementsConfig | null>(null);\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useEffect(() => {\n    if (screen) {\n      setName(screen.name);\n      setActive(screen.active);\n      setConfig(screen.config);\n      setHasChanges(false);\n    }\n  }, [screen]);\n\n  const handleSave = () => {\n    if (!screen || !config) return;\n\n    const updatedScreen = publicScreensStore.update(screen.id, {\n      name: name.trim(),\n      active,\n      config\n    });\n\n    onSave(updatedScreen);\n    setHasChanges(false);\n  };\n\n  const handleToggleStatus = () => {\n    if (!screen) return;\n    \n    const newActive = !active;\n    setActive(newActive);\n    setHasChanges(true);\n    \n    // Auto-save status changes\n    const updatedScreen = publicScreensStore.update(screen.id, { active: newActive });\n    onSave(updatedScreen);\n  };\n\n  const handleOpenPublic = () => {\n    if (!screen) return;\n    const publicUrl = `${window.location.origin}/public/screen/${screen.publicToken}`;\n    window.open(publicUrl, '_blank');\n  };\n\n  const handleNameChange = (value: string) => {\n    setName(value);\n    setHasChanges(true);\n  };\n\n  const handleConfigChange = (newConfig: PaymentMatrixConfig | AnnouncementsConfig) => {\n    setConfig(newConfig);\n    setHasChanges(true);\n  };\n\n  if (!screen) return null;\n\n  const publicUrl = `${window.location.origin}/public/screen/${screen.publicToken}`;\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'PAYMENT_MATRIX': return 'Betaalstatus Matrix';\n      case 'ANNOUNCEMENTS': return 'Mededelingen Carousel';\n      default: return type;\n    }\n  };\n\n  return (\n    <Sheet open={!!screen} onOpenChange={onClose}>\n      <SheetContent className=\"w-full sm:max-w-7xl overflow-y-auto\">\n        <SheetHeader className=\"pb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <SheetTitle>Scherm bewerken</SheetTitle>\n              <div className=\"flex items-center gap-2 mt-2\">\n                <Badge variant=\"outline\">{getTypeLabel(screen.type)}</Badge>\n                <Badge \n                  variant={active ? \"default\" : \"secondary\"}\n                  className={active ? \"bg-green-100 text-green-800\" : \"bg-gray-100 text-gray-800\"}\n                >\n                  {active ? \"Actief\" : \"Inactief\"}\n                </Badge>\n              </div>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={handleOpenPublic}>\n                <ExternalLink className=\"h-4 w-4 mr-2\" />\n                Open publiek\n              </Button>\n              <Button variant=\"outline\" size=\"sm\" onClick={handleToggleStatus}>\n                <Power className=\"h-4 w-4 mr-2\" />\n                {active ? \"Deactiveren\" : \"Activeren\"}\n              </Button>\n            </div>\n          </div>\n        </SheetHeader>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 h-full\">\n          {/* Configuration Panel */}\n          <div className=\"space-y-6\">\n            <div>\n              <h3 className=\"text-lg font-semibold mb-4\">Configuratie</h3>\n              \n              <div className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"edit-screen-name\">Naam</Label>\n                  <Input\n                    id=\"edit-screen-name\"\n                    value={name}\n                    onChange={(e) => handleNameChange(e.target.value)}\n                    data-testid=\"input-edit-screen-name\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Publieke URL</Label>\n                  <CopyField value={publicUrl} />\n                </div>\n              </div>\n            </div>\n\n            <Separator />\n\n            <div>\n              <h4 className=\"font-medium mb-4\">Type-specifieke instellingen</h4>\n              \n              {screen.type === 'PAYMENT_MATRIX' && config && (\n                <MatrixConfigForm\n                  config={config as PaymentMatrixConfig}\n                  onChange={handleConfigChange}\n                />\n              )}\n              \n              {screen.type === 'ANNOUNCEMENTS' && config && (\n                <AnnouncementsConfigForm\n                  config={config as AnnouncementsConfig}\n                  onChange={handleConfigChange}\n                />\n              )}\n            </div>\n\n            <div className=\"flex gap-2 pt-4\">\n              <Button \n                onClick={handleSave} \n                disabled={!hasChanges}\n                className=\"flex-1\"\n              >\n                <Save className=\"h-4 w-4 mr-2\" />\n                Wijzigingen opslaan\n              </Button>\n            </div>\n          </div>\n\n          {/* Preview Panel */}\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-semibold\">Live preview</h3>\n            <div className=\"border rounded-lg overflow-hidden bg-gray-50 h-96\">\n              <PreviewFrame screen={{ ...screen, name, active, config: config! }} />\n            </div>\n            <div className=\"text-sm text-gray-500\">\n              Preview toont hoe het scherm er publiek uit zal zien\n            </div>\n          </div>\n        </div>\n      </SheetContent>\n    </Sheet>\n  );\n}","size_bytes":6541},"client/src/components/public-screens/NewScreenDialog.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus } from \"lucide-react\";\nimport { ScreenType, LedenlijstConfig, MededelingenConfig, MultimediaConfig } from \"@/lib/mock/public-screens\";\nimport { ScreenWizard } from \"./wizard/ScreenWizard\";\n\ninterface NewScreenDialogProps {\n  onCreateScreen: (screen: {\n    name: string;\n    type: ScreenType;\n    config: LedenlijstConfig | MededelingenConfig | MultimediaConfig;\n  }) => void;\n}\n\nexport function NewScreenDialog({ onCreateScreen }: NewScreenDialogProps) {\n  const [wizardOpen, setWizardOpen] = useState(false);\n\n  return (\n    <>\n      <Button \n        onClick={() => setWizardOpen(true)}\n        className=\"gap-2\"\n        data-testid=\"button-new-screen\"\n      >\n        <Plus className=\"w-4 h-4\" />\n        Nieuw Scherm\n      </Button>\n\n      <ScreenWizard\n        open={wizardOpen}\n        onOpenChange={setWizardOpen}\n        onComplete={onCreateScreen}\n      />\n    </>\n  );\n}","size_bytes":991},"client/src/components/public-screens/PreviewFrame.tsx":{"content":"\"use client\";\n\nimport { PublicScreen, PaymentMatrixConfig, AnnouncementsConfig } from \"@/lib/mock/public-screens\";\nimport { MatrixPreview } from \"./types/PaymentMatrix/MatrixPreview\";\nimport { AnnouncementsPreview } from \"./types/Announcements/AnnouncementsPreview\";\n\ninterface PreviewFrameProps {\n  screen: PublicScreen;\n}\n\nexport function PreviewFrame({ screen }: PreviewFrameProps) {\n  if (!screen.active) {\n    return (\n      <div className=\"h-full flex items-center justify-center bg-gray-100\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"text-gray-600 font-medium\">Scherm is inactief</div>\n          <div className=\"text-sm text-gray-500\">\n            Activeer het scherm om de preview te zien\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-full overflow-hidden bg-white\">\n      {screen.type === 'PAYMENT_MATRIX' && (\n        <MatrixPreview config={screen.config as PaymentMatrixConfig} />\n      )}\n      {screen.type === 'ANNOUNCEMENTS' && (\n        <AnnouncementsPreview config={screen.config as AnnouncementsConfig} />\n      )}\n    </div>\n  );\n}","size_bytes":1127},"client/src/components/public-screens/PublicScreensList.tsx":{"content":"\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { PublicScreen } from \"@/lib/mock/public-screens\";\nimport { ScreenCard } from \"./ScreenCard\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Search, Monitor } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface PublicScreensListProps {\n  onEdit: (screen: PublicScreen) => void;\n  onDelete: (screenName: string) => void;\n}\n\nexport function PublicScreensList({ onEdit, onDelete }: PublicScreensListProps) {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [typeFilter, setTypeFilter] = useState<string>(\"ALL\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"ALL\");\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n  \n  const { data: screens = [], isLoading } = useQuery({\n    queryKey: ['/api/public-screens']\n  });\n\n  const toggleStatusMutation = useMutation({\n    mutationFn: async ({ id, active }: { id: string; active: boolean }) => {\n      const token = localStorage.getItem(\"authToken\");\n      const response = await fetch(`/api/public-screens/${id}`, {\n        method: 'PATCH',\n        headers: { \n          'Content-Type': 'application/json',\n          ...(token && { 'Authorization': `Bearer ${token}` })\n        },\n        body: JSON.stringify({ active })\n      });\n      if (!response.ok) throw new Error('Failed to update screen');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/public-screens'] });\n    }\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const token = localStorage.getItem(\"authToken\");\n      const response = await fetch(`/api/public-screens/${id}`, {\n        method: 'DELETE',\n        headers: {\n          ...(token && { 'Authorization': `Bearer ${token}` })\n        }\n      });\n      if (!response.ok) throw new Error('Failed to delete screen');\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/public-screens'] });\n    }\n  });\n\n  const filteredScreens = useMemo(() => {\n    return screens.filter(screen => {\n      const matchesSearch = screen.name.toLowerCase().includes(searchTerm.toLowerCase());\n      const matchesType = typeFilter === \"ALL\" || screen.type === typeFilter;\n      const matchesStatus = statusFilter === \"ALL\" || \n        (statusFilter === \"ACTIVE\" && screen.active) ||\n        (statusFilter === \"INACTIVE\" && !screen.active);\n      \n      return matchesSearch && matchesType && matchesStatus;\n    });\n  }, [screens, searchTerm, typeFilter, statusFilter]);\n\n  const handleToggleStatus = (screen: PublicScreen) => {\n    toggleStatusMutation.mutate({ id: screen.id, active: !screen.active });\n  };\n\n  const handleDelete = (screen: PublicScreen) => {\n    deleteMutation.mutate(screen.id);\n    onDelete(screen.name);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"text-center py-12\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n        <p className=\"text-gray-600\">Schermen laden...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Filters */}\n      <div className=\"glass-card card-hover animate-fade-in group border-0 p-6 rounded-xl\">\n        <div className=\"flex flex-col sm:flex-row gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n          <Input\n            placeholder=\"Zoek schermen...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"pl-10\"\n            data-testid=\"search-screens\"\n          />\n        </div>\n        <Select value={typeFilter} onValueChange={setTypeFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"filter-type\">\n            <SelectValue placeholder=\"Type\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL\">Alle types</SelectItem>\n            <SelectItem value=\"LEDENLIJST\">Ledenlijst</SelectItem>\n            <SelectItem value=\"MEDEDELINGEN\">Mededelingen</SelectItem>\n            <SelectItem value=\"MULTIMEDIA\">Multimedia</SelectItem>\n          </SelectContent>\n        </Select>\n        <Select value={statusFilter} onValueChange={setStatusFilter}>\n          <SelectTrigger className=\"w-full sm:w-48\" data-testid=\"filter-status\">\n            <SelectValue placeholder=\"Status\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"ALL\">Alle statussen</SelectItem>\n            <SelectItem value=\"ACTIVE\">Actief</SelectItem>\n            <SelectItem value=\"INACTIVE\">Inactief</SelectItem>\n          </SelectContent>\n        </Select>\n        </div>\n      </div>\n\n      {/* Results */}\n      {filteredScreens.length === 0 ? (\n        <div className=\"flex flex-col items-center justify-center py-12 px-4 text-center\">\n          <div className=\"flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-800 rounded-full mb-4\">\n            <Monitor className=\"w-8 h-8 text-gray-400\" />\n          </div>\n          <h3 className=\"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2\">\n            Geen schermen gevonden\n          </h3>\n          <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-sm\">\n            {searchTerm || typeFilter !== \"ALL\" || statusFilter !== \"ALL\" \n              ? \"Probeer je zoekcriteria aan te passen\" \n              : \"Maak je eerste publiek scherm aan\"\n            }\n          </p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredScreens.map(screen => (\n            <ScreenCard\n              key={screen.id}\n              screen={screen}\n              onEdit={() => onEdit(screen)}\n              onToggleStatus={() => handleToggleStatus(screen)}\n              onDelete={() => handleDelete(screen)}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":6220},"client/src/components/public-screens/ScreenCard.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { PublicScreen } from \"@/lib/mock/public-screens\";\nimport { formatDateBE } from \"@/lib/mock/utils\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { ConfirmDialog } from \"@/components/ui/ConfirmDialog\";\nimport { CopyField } from \"@/components/ui/CopyField\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Edit, Trash2, ExternalLink, Check } from \"lucide-react\";\nimport { GiPowerButton } from \"react-icons/gi\";\nimport { FaRegCopy } from \"react-icons/fa\";\nimport { EditScreenDialog } from \"./EditScreenDialog\";\n\ninterface ScreenCardProps {\n  screen: PublicScreen;\n  onToggleStatus: () => void;\n  onDelete: () => void;\n}\n\nexport function ScreenCard({ screen, onToggleStatus, onDelete }: ScreenCardProps) {\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [showUrlDialog, setShowUrlDialog] = useState(false);\n  const [justCopied, setJustCopied] = useState(false);\n  const [showEditDialog, setShowEditDialog] = useState(false);\n\n  const handleCopyUrl = async () => {\n    try {\n      await navigator.clipboard.writeText(publicUrl);\n      setJustCopied(true);\n      setTimeout(() => setJustCopied(false), 2000);\n    } catch (err) {\n      // Fallback for older browsers\n      setShowUrlDialog(true);\n    }\n  };\n\n  const publicUrl = `${window.location.origin}/screen/${screen.publicToken || screen.id}`;\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'PAYMENT_MATRIX': return 'Betaalstatus';\n      case 'ANNOUNCEMENTS': return 'Mededelingen';\n      default: return type;\n    }\n  };\n\n  const getTypeVariant = (type: string) => {\n    switch (type) {\n      case 'PAYMENT_MATRIX': return 'default';\n      case 'ANNOUNCEMENTS': return 'secondary';\n      default: return 'outline';\n    }\n  };\n\n  const handleOpenPublic = () => {\n    window.open(publicUrl, '_blank');\n  };\n\n  return (\n    <>\n      <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n        <CardHeader className=\"pb-3\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"space-y-1 flex-1 min-w-0\">\n              <h3 className=\"font-semibold text-gray-900 truncate\" title={screen.name}>\n                {screen.name}\n              </h3>\n              <div className=\"flex items-center gap-2\">\n                <Badge variant={getTypeVariant(screen.type)} className=\"text-xs\">\n                  {getTypeLabel(screen.type)}\n                </Badge>\n                <Badge \n                  variant={screen.active ? \"default\" : \"secondary\"}\n                  className={screen.active \n                    ? \"bg-green-100 text-green-800 hover:bg-green-100\" \n                    : \"bg-red-100 text-red-800 hover:bg-red-100\"\n                  }\n                >\n                  {screen.active ? \"Actief\" : \"Inactief\"}\n                </Badge>\n              </div>\n            </div>\n            <div className=\"flex gap-1\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleCopyUrl}\n                className={`h-8 w-8 p-0 ${justCopied ? 'text-green-600' : ''}`}\n                title={justCopied ? \"Gekopieerd!\" : \"Kopieer URL\"}\n              >\n                {justCopied ? (\n                  <Check className=\"h-4 w-4\" />\n                ) : (\n                  <FaRegCopy className=\"h-4 w-4\" />\n                )}\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleOpenPublic}\n                className=\"h-8 w-8 p-0\"\n                title=\"Open publieke view\"\n              >\n                <ExternalLink className=\"h-4 w-4\" />\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowEditDialog(true)}\n                className=\"h-8 w-8 p-0\"\n                title=\"Bewerken\"\n              >\n                <Edit className=\"h-4 w-4\" />\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={onToggleStatus}\n                className={`h-8 w-8 p-0 ${screen.active ? 'text-green-600' : 'text-gray-400'}`}\n                title={screen.active ? \"Deactiveren\" : \"Activeren\"}\n              >\n                <GiPowerButton className=\"h-4 w-4\" />\n              </Button>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={() => setShowDeleteConfirm(true)}\n                className=\"h-8 w-8 p-0 text-red-600 hover:text-red-700\"\n                title=\"Verwijderen\"\n              >\n                <Trash2 className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"pt-0\">\n          <div className=\"text-sm text-gray-500\">\n            Laatst gewijzigd: {formatDateBE(screen.updatedAt)}\n          </div>\n          \n          <div className=\"mt-2 p-2 bg-gray-50 rounded text-xs\">\n            <div className=\"flex items-center gap-1 text-gray-600\">\n              <span>Publieke URL:</span>\n              <a \n                href={`/screen/${screen.publicToken || screen.id}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-blue-600 hover:text-blue-800 underline truncate\"\n                data-testid={`link-public-${screen.id}`}\n              >\n                /screen/{screen.publicToken || screen.id}\n              </a>\n            </div>\n          </div>\n          \n        </CardContent>\n      </Card>\n      {/* Copy URL Dialog */}\n      <Dialog open={showUrlDialog} onOpenChange={setShowUrlDialog}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Publieke URL</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <p className=\"text-sm text-gray-600\">\n              Deel deze URL om het scherm publiek te tonen:\n            </p>\n            <CopyField value={publicUrl} />\n          </div>\n        </DialogContent>\n      </Dialog>\n      {/* Delete Confirmation */}\n      <ConfirmDialog\n        open={showDeleteConfirm}\n        onClose={() => setShowDeleteConfirm(false)}\n        onConfirm={() => {\n          onDelete();\n          setShowDeleteConfirm(false);\n        }}\n        title=\"Scherm verwijderen\"\n        description={`Weet je zeker dat je \"${screen.name}\" wilt verwijderen? Deze actie kan niet ongedaan worden gemaakt.`}\n        confirmText=\"Verwijderen\"\n        variant=\"destructive\"\n      />\n      \n      {/* Edit Screen Dialog */}\n      <EditScreenDialog\n        screen={screen}\n        open={showEditDialog}\n        onOpenChange={setShowEditDialog}\n      />\n    </>\n  );\n}","size_bytes":6982},"client/src/components/public-screens/types/Announcements/AnnouncementsConfigForm.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { AnnouncementsConfig, AnnouncementSlide } from \"@/lib/mock/public-screens\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Plus, Trash2, GripVertical } from \"lucide-react\";\n\ninterface AnnouncementsConfigFormProps {\n  config: AnnouncementsConfig;\n  onChange: (config: AnnouncementsConfig) => void;\n}\n\nexport function AnnouncementsConfigForm({ config, onChange }: AnnouncementsConfigFormProps) {\n  const updateConfig = (updates: Partial<AnnouncementsConfig>) => {\n    onChange({ ...config, ...updates });\n  };\n\n  const updateAutoplay = (updates: Partial<AnnouncementsConfig['autoplay']>) => {\n    onChange({\n      ...config,\n      autoplay: { ...config.autoplay, ...updates }\n    });\n  };\n\n  const updateStyle = (updates: Partial<AnnouncementsConfig['style']>) => {\n    onChange({\n      ...config,\n      style: { ...config.style, ...updates }\n    });\n  };\n\n  const addSlide = () => {\n    const newSlide: AnnouncementSlide = {\n      id: `slide-${Date.now()}`,\n      title: '',\n      body: '',\n      active: true,\n      durationSec: 8\n    };\n    updateConfig({ slides: [...config.slides, newSlide] });\n  };\n\n  const updateSlide = (index: number, updates: Partial<AnnouncementSlide>) => {\n    const updatedSlides = [...config.slides];\n    updatedSlides[index] = { ...updatedSlides[index], ...updates };\n    updateConfig({ slides: updatedSlides });\n  };\n\n  const removeSlide = (index: number) => {\n    const updatedSlides = config.slides.filter((_, i) => i !== index);\n    updateConfig({ slides: updatedSlides });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Slides Management */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h4 className=\"font-medium\">Slides</h4>\n          <Button onClick={addSlide} size=\"sm\" variant=\"outline\">\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Slide toevoegen\n          </Button>\n        </div>\n\n        <div className=\"space-y-4 max-h-96 overflow-y-auto\">\n          {config.slides.map((slide, index) => (\n            <Card key={slide.id}>\n              <CardHeader className=\"pb-3\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"text-sm flex items-center gap-2\">\n                    <GripVertical className=\"h-4 w-4 text-gray-400\" />\n                    Slide {index + 1}\n                  </CardTitle>\n                  <div className=\"flex items-center gap-2\">\n                    <Switch\n                      checked={slide.active}\n                      onCheckedChange={(checked) => updateSlide(index, { active: checked })}\n                    />\n                    <Button\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => removeSlide(index)}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"space-y-2\">\n                  <Label>Titel *</Label>\n                  <Input\n                    value={slide.title}\n                    onChange={(e) => updateSlide(index, { title: e.target.value })}\n                    placeholder=\"Bijvoorbeeld: Belangrijke mededeling\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Inhoud</Label>\n                  <Textarea\n                    value={slide.body || ''}\n                    onChange={(e) => updateSlide(index, { body: e.target.value })}\n                    placeholder=\"Voeg hier de inhoud van je mededeling toe...\"\n                    rows={3}\n                  />\n                </div>\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Media URL</Label>\n                    <Input\n                      value={slide.mediaUrl || ''}\n                      onChange={(e) => updateSlide(index, { mediaUrl: e.target.value })}\n                      placeholder=\"https://...\"\n                    />\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Media type</Label>\n                    <Select \n                      value={slide.mediaType || ''} \n                      onValueChange={(value: 'image' | 'video') => updateSlide(index, { mediaType: value })}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Selecteer type\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"image\">Afbeelding</SelectItem>\n                        <SelectItem value=\"video\">Video</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Geldig vanaf</Label>\n                    <Input\n                      type=\"date\"\n                      value={slide.validFrom?.split('T')[0] || ''}\n                      onChange={(e) => updateSlide(index, { \n                        validFrom: e.target.value ? `${e.target.value}T00:00:00Z` : undefined \n                      })}\n                    />\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Geldig tot</Label>\n                    <Input\n                      type=\"date\"\n                      value={slide.validTo?.split('T')[0] || ''}\n                      onChange={(e) => updateSlide(index, { \n                        validTo: e.target.value ? `${e.target.value}T23:59:59Z` : undefined \n                      })}\n                    />\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Duur (sec)</Label>\n                    <Input\n                      type=\"number\"\n                      min=\"3\"\n                      max=\"60\"\n                      value={slide.durationSec}\n                      onChange={(e) => updateSlide(index, { durationSec: parseInt(e.target.value) || 8 })}\n                    />\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n\n        {config.slides.length === 0 && (\n          <div className=\"text-center py-8 text-gray-500\">\n            <div className=\"mb-2\">Nog geen slides toegevoegd</div>\n            <Button onClick={addSlide} size=\"sm\">\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Eerste slide toevoegen\n            </Button>\n          </div>\n        )}\n      </div>\n\n      <Separator />\n\n      {/* Autoplay Settings */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Autoplay instellingen</h4>\n        \n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"text-sm font-medium\">Autoplay</Label>\n              <div className=\"text-xs text-gray-500\">\n                Automatisch doorschakelen tussen slides\n              </div>\n            </div>\n            <Switch\n              checked={config.autoplay.enabled}\n              onCheckedChange={(checked) => updateAutoplay({ enabled: checked })}\n            />\n          </div>\n\n          {config.autoplay.enabled && (\n            <>\n              <div className=\"space-y-2\">\n                <Label>Interval (seconden)</Label>\n                <Input\n                  type=\"number\"\n                  min=\"3\"\n                  max=\"60\"\n                  value={config.autoplay.interval}\n                  onChange={(e) => updateAutoplay({ interval: parseInt(e.target.value) || 8 })}\n                />\n              </div>\n\n              <div className=\"space-y-2\">\n                <Label>Volgorde</Label>\n                <Select \n                  value={config.autoplay.order} \n                  onValueChange={(value: 'date' | 'manual' | 'shuffle') => updateAutoplay({ order: value })}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"date\">Op datum</SelectItem>\n                    <SelectItem value=\"manual\">Handmatige volgorde</SelectItem>\n                    <SelectItem value=\"shuffle\">Willekeurig</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Style Settings */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Stijl instellingen</h4>\n        \n        <div className=\"space-y-3\">\n          <div className=\"space-y-2\">\n            <Label>Tekst contrast</Label>\n            <Select \n              value={config.style.textContrast} \n              onValueChange={(value: 'light' | 'dark') => updateStyle({ textContrast: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"light\">Licht (op donkere achtergrond)</SelectItem>\n                <SelectItem value=\"dark\">Donker (op lichte achtergrond)</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Achtergrond</Label>\n            <Select \n              value={config.style.background} \n              onValueChange={(value: 'white' | 'black' | 'transparent') => updateStyle({ background: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"white\">Wit</SelectItem>\n                <SelectItem value=\"black\">Zwart</SelectItem>\n                <SelectItem value=\"transparent\">Transparant</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>Max tekst breedte (px)</Label>\n            <Input\n              type=\"number\"\n              min=\"400\"\n              max=\"1200\"\n              value={config.style.maxTextWidth}\n              onChange={(e) => updateStyle({ maxTextWidth: parseInt(e.target.value) || 800 })}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":11112},"client/src/components/public-screens/types/Announcements/AnnouncementsPreview.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { AnnouncementsConfig } from \"@/lib/mock/public-screens\";\nimport { getActiveSlides } from \"@/lib/mock/announcements\";\nimport { ChevronLeft, ChevronRight, Play, Pause } from \"lucide-react\";\n\ninterface AnnouncementsPreviewProps {\n  config: AnnouncementsConfig;\n}\n\nexport function AnnouncementsPreview({ config }: AnnouncementsPreviewProps) {\n  const [currentSlide, setCurrentSlide] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(config.autoplay.enabled);\n  \n  // Get active slides based on current time and config\n  const activeSlides = getActiveSlides(new Date().toISOString()).filter(slide => \n    config.slides.some(configSlide => \n      configSlide.id === slide.id && configSlide.active\n    )\n  );\n\n  // Merge config slides with active slides to get latest config\n  const slides = activeSlides.map(activeSlide => {\n    const configSlide = config.slides.find(s => s.id === activeSlide.id);\n    return configSlide || activeSlide;\n  });\n\n  useEffect(() => {\n    if (slides.length === 0) return;\n    \n    // Reset current slide if it's out of bounds\n    if (currentSlide >= slides.length) {\n      setCurrentSlide(0);\n    }\n  }, [slides.length, currentSlide]);\n\n  useEffect(() => {\n    if (!isPlaying || slides.length <= 1) return;\n\n    const currentSlideDuration = slides[currentSlide]?.durationSec || config.autoplay.interval;\n    const timer = setTimeout(() => {\n      setCurrentSlide(prev => (prev + 1) % slides.length);\n    }, currentSlideDuration * 1000);\n\n    return () => clearTimeout(timer);\n  }, [currentSlide, isPlaying, slides, config.autoplay.interval]);\n\n  const goToNext = () => {\n    if (slides.length > 1) {\n      setCurrentSlide(prev => (prev + 1) % slides.length);\n    }\n  };\n\n  const goToPrevious = () => {\n    if (slides.length > 1) {\n      setCurrentSlide(prev => (prev - 1 + slides.length) % slides.length);\n    }\n  };\n\n  if (slides.length === 0) {\n    return (\n      <div className=\"h-full flex items-center justify-center bg-gray-900 text-white\">\n        <div className=\"text-center space-y-2\">\n          <div className=\"text-lg font-semibold\">Geen actieve slides</div>\n          <div className=\"text-sm opacity-75\">\n            Voeg slides toe of controleer de geldigheidsdata\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const slide = slides[currentSlide];\n  const backgroundClass = config.style.background === 'white' ? 'bg-white' : \n                         config.style.background === 'black' ? 'bg-black' : 'bg-transparent';\n  const textClass = config.style.textContrast === 'light' ? 'text-white' : 'text-black';\n\n  return (\n    <div className={`h-full relative ${backgroundClass} ${textClass} overflow-hidden`}>\n      {/* Slide Content */}\n      <div className=\"h-full flex items-center justify-center p-8\">\n        <div \n          className=\"text-center space-y-6 max-w-4xl\"\n          style={{ maxWidth: `${config.style.maxTextWidth}px` }}\n          role=\"group\"\n          aria-label={`Slide ${currentSlide + 1} van ${slides.length}: ${slide.title}`}\n        >\n          {/* Media */}\n          {slide.mediaUrl && (\n            <div className=\"mb-6\">\n              {slide.mediaType === 'image' ? (\n                <img \n                  src={slide.mediaUrl} \n                  alt=\"\"\n                  className=\"max-w-full max-h-64 mx-auto object-contain rounded-lg\"\n                />\n              ) : slide.mediaType === 'video' ? (\n                <video \n                  src={slide.mediaUrl}\n                  className=\"max-w-full max-h-64 mx-auto object-contain rounded-lg\"\n                  autoPlay\n                  muted\n                  loop\n                />\n              ) : null}\n            </div>\n          )}\n\n          {/* Title */}\n          <h1 className=\"text-4xl font-bold mb-4\">\n            {slide.title}\n          </h1>\n\n          {/* Body */}\n          {slide.body && (\n            <div className=\"text-xl leading-relaxed whitespace-pre-wrap\">\n              {slide.body}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Controls (for preview) */}\n      <div className=\"absolute top-4 right-4 flex gap-2\">\n        <button\n          onClick={() => setIsPlaying(!isPlaying)}\n          className=\"p-2 bg-black bg-opacity-50 text-white rounded-lg hover:bg-opacity-75 transition-opacity\"\n          aria-label={isPlaying ? \"Pauzeren\" : \"Afspelen\"}\n        >\n          {isPlaying ? <Pause className=\"h-4 w-4\" /> : <Play className=\"h-4 w-4\" />}\n        </button>\n        \n        {slides.length > 1 && (\n          <>\n            <button\n              onClick={goToPrevious}\n              className=\"p-2 bg-black bg-opacity-50 text-white rounded-lg hover:bg-opacity-75 transition-opacity\"\n              aria-label=\"Vorige slide\"\n            >\n              <ChevronLeft className=\"h-4 w-4\" />\n            </button>\n            \n            <button\n              onClick={goToNext}\n              className=\"p-2 bg-black bg-opacity-50 text-white rounded-lg hover:bg-opacity-75 transition-opacity\"\n              aria-label=\"Volgende slide\"\n            >\n              <ChevronRight className=\"h-4 w-4\" />\n            </button>\n          </>\n        )}\n      </div>\n\n      {/* Progress Indicator */}\n      {slides.length > 1 && (\n        <div className=\"absolute bottom-6 left-1/2 transform -translate-x-1/2\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"text-sm opacity-75\">\n              {currentSlide + 1} / {slides.length}\n            </div>\n            <div className=\"flex gap-1\">\n              {slides.map((_, index) => (\n                <div\n                  key={index}\n                  className={`w-2 h-2 rounded-full transition-opacity ${\n                    index === currentSlide ? 'bg-current' : 'bg-current opacity-30'\n                  }`}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":5974},"client/src/components/public-screens/types/PaymentMatrix/MatrixConfigForm.tsx":{"content":"\"use client\";\n\nimport { PaymentMatrixConfig } from \"@/lib/mock/public-screens\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Separator } from \"@/components/ui/separator\";\n\ninterface MatrixConfigFormProps {\n  config: PaymentMatrixConfig;\n  onChange: (config: PaymentMatrixConfig) => void;\n}\n\nexport function MatrixConfigForm({ config, onChange }: MatrixConfigFormProps) {\n  const currentYear = new Date().getFullYear();\n  const years = Array.from({ length: 5 }, (_, i) => currentYear + i - 2);\n\n  const updateConfig = (updates: Partial<PaymentMatrixConfig>) => {\n    onChange({ ...config, ...updates });\n  };\n\n  const updateFilters = (updates: Partial<PaymentMatrixConfig['filters']>) => {\n    onChange({\n      ...config,\n      filters: { ...config.filters, ...updates }\n    });\n  };\n\n  const updateDisplay = (updates: Partial<PaymentMatrixConfig['display']>) => {\n    onChange({\n      ...config,\n      display: { ...config.display, ...updates }\n    });\n  };\n\n  const updateColors = (updates: Partial<PaymentMatrixConfig['colors']>) => {\n    onChange({\n      ...config,\n      colors: { ...config.colors, ...updates }\n    });\n  };\n\n  const updateLayout = (updates: Partial<PaymentMatrixConfig['layout']>) => {\n    onChange({\n      ...config,\n      layout: { ...config.layout, ...updates }\n    });\n  };\n\n  const categories = ['Senior', 'Standaard', 'Student'];\n\n  const toggleCategory = (category: string) => {\n    const newCategories = config.filters.categories.includes(category)\n      ? config.filters.categories.filter(c => c !== category)\n      : [...config.filters.categories, category];\n    updateFilters({ categories: newCategories });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Basic Settings */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Basis instellingen</h4>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"matrix-year\">Jaar</Label>\n          <Select value={config.year.toString()} onValueChange={(value) => updateConfig({ year: parseInt(value) })}>\n            <SelectTrigger id=\"matrix-year\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {years.map(year => (\n                <SelectItem key={year} value={year.toString()}>\n                  {year}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Filters */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Filters</h4>\n        \n        <div className=\"space-y-3\">\n          <div>\n            <Label className=\"text-sm font-medium\">Categorieën</Label>\n            <div className=\"mt-2 space-y-2\">\n              {categories.map(category => (\n                <div key={category} className=\"flex items-center space-x-2\">\n                  <Checkbox\n                    id={`category-${category}`}\n                    checked={config.filters.categories.includes(category)}\n                    onCheckedChange={() => toggleCategory(category)}\n                  />\n                  <Label \n                    htmlFor={`category-${category}`}\n                    className=\"text-sm font-normal\"\n                  >\n                    {category}\n                  </Label>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"text-sm font-medium\">Alleen actieve leden</Label>\n              <div className=\"text-xs text-gray-500\">\n                Toon alleen leden die momenteel actief zijn\n              </div>\n            </div>\n            <Switch\n              checked={config.filters.activeOnly}\n              onCheckedChange={(checked) => updateFilters({ activeOnly: checked })}\n            />\n          </div>\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Display Options */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Weergave opties</h4>\n        \n        <div className=\"space-y-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"text-sm font-medium\">Toon grafiek</Label>\n              <div className=\"text-xs text-gray-500\">\n                Donut grafiek met betaalstatistieken\n              </div>\n            </div>\n            <Switch\n              checked={config.display.showChart}\n              onCheckedChange={(checked) => updateDisplay({ showChart: checked })}\n            />\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"text-sm font-medium\">Compacte labels</Label>\n              <div className=\"text-xs text-gray-500\">\n                Voornaam initiaal + volledige achternaam\n              </div>\n            </div>\n            <Switch\n              checked={config.display.compactLabels}\n              onCheckedChange={(checked) => updateDisplay({ compactLabels: checked })}\n            />\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <Label className=\"text-sm font-medium\">Toon percentage</Label>\n              <div className=\"text-xs text-gray-500\">\n                Percentage betaalde bedragen in header\n              </div>\n            </div>\n            <Switch\n              checked={config.display.showPercentage}\n              onCheckedChange={(checked) => updateDisplay({ showPercentage: checked })}\n            />\n          </div>\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Colors */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Kleuren</h4>\n        \n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"color-paid\">Betaald</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"color-paid\"\n                type=\"color\"\n                value={config.colors.paid}\n                onChange={(e) => updateColors({ paid: e.target.value })}\n                className=\"w-12 h-8 p-1 border\"\n              />\n              <Input\n                value={config.colors.paid}\n                onChange={(e) => updateColors({ paid: e.target.value })}\n                className=\"font-mono text-sm\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"color-open\">Openstaand</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"color-open\"\n                type=\"color\"\n                value={config.colors.open}\n                onChange={(e) => updateColors({ open: e.target.value })}\n                className=\"w-12 h-8 p-1 border\"\n              />\n              <Input\n                value={config.colors.open}\n                onChange={(e) => updateColors({ open: e.target.value })}\n                className=\"font-mono text-sm\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"color-overdue\">Vervallen</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"color-overdue\"\n                type=\"color\"\n                value={config.colors.overdue}\n                onChange={(e) => updateColors({ overdue: e.target.value })}\n                className=\"w-12 h-8 p-1 border\"\n              />\n              <Input\n                value={config.colors.overdue}\n                onChange={(e) => updateColors({ overdue: e.target.value })}\n                className=\"font-mono text-sm\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"color-unknown\">Onbekend</Label>\n            <div className=\"flex gap-2\">\n              <Input\n                id=\"color-unknown\"\n                type=\"color\"\n                value={config.colors.unknown}\n                onChange={(e) => updateColors({ unknown: e.target.value })}\n                className=\"w-12 h-8 p-1 border\"\n              />\n              <Input\n                value={config.colors.unknown}\n                onChange={(e) => updateColors({ unknown: e.target.value })}\n                className=\"font-mono text-sm\"\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Layout */}\n      <div className=\"space-y-4\">\n        <h4 className=\"font-medium\">Layout</h4>\n        \n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"max-row-height\">Max rij hoogte (px)</Label>\n            <Input\n              id=\"max-row-height\"\n              type=\"number\"\n              min=\"32\"\n              max=\"80\"\n              value={config.layout.maxRowHeight}\n              onChange={(e) => updateLayout({ maxRowHeight: parseInt(e.target.value) || 48 })}\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"column-width\">Kolom breedte (px)</Label>\n            <Input\n              id=\"column-width\"\n              type=\"number\"\n              min=\"32\"\n              max=\"80\"\n              value={config.layout.columnWidth}\n              onChange={(e) => updateLayout({ columnWidth: parseInt(e.target.value) || 48 })}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":9700},"client/src/components/public-screens/types/PaymentMatrix/MatrixPreview.tsx":{"content":"\"use client\";\n\nimport { PaymentMatrixConfig } from \"@/lib/mock/public-screens\";\nimport { getPaymentSnapshot, monthShortNl, Cell } from \"@/lib/mock/fees-snapshot\";\nimport { PieChart, Pie, ResponsiveContainer, Legend } from \"recharts\";\nimport { Check, X, AlertTriangle } from \"lucide-react\";\n\ninterface MatrixPreviewProps {\n  config: PaymentMatrixConfig;\n}\n\nexport function MatrixPreview({ config }: MatrixPreviewProps) {\n  const snapshot = getPaymentSnapshot(config.year, {\n    categories: config.filters.categories,\n    activeOnly: config.filters.activeOnly\n  });\n\n  const chartData = [\n    { name: 'Betaald', value: snapshot.totals.paid, color: config.colors.paid },\n    { name: 'Openstaand', value: snapshot.totals.open, color: config.colors.open },\n    { name: 'Vervallen', value: snapshot.totals.overdue, color: config.colors.overdue }\n  ];\n\n  const totalPayments = snapshot.totals.paid + snapshot.totals.open + snapshot.totals.overdue;\n  const paidPercentage = totalPayments > 0 ? Math.round((snapshot.totals.paid / totalPayments) * 100) : 0;\n\n  const getCellContent = (status: Cell) => {\n    switch (status) {\n      case 'PAID':\n        return <Check className=\"h-3 w-3 text-white\" />;\n      case 'OPEN':\n        return <X className=\"h-3 w-3 text-gray-600\" />;\n      case 'OVERDUE':\n        return <AlertTriangle className=\"h-3 w-3 text-white\" />;\n      default:\n        return null;\n    }\n  };\n\n  const getCellStyle = (status: Cell) => {\n    const baseStyle = {\n      width: `${config.layout.columnWidth}px`,\n      height: `${config.layout.maxRowHeight}px`,\n      minHeight: '32px'\n    };\n\n    switch (status) {\n      case 'PAID':\n        return { ...baseStyle, backgroundColor: config.colors.paid };\n      case 'OPEN':\n        return { ...baseStyle, backgroundColor: config.colors.open };\n      case 'OVERDUE':\n        return { ...baseStyle, backgroundColor: config.colors.overdue };\n      default:\n        return { ...baseStyle, backgroundColor: config.colors.unknown };\n    }\n  };\n\n  const formatMemberName = (name: string) => {\n    if (!config.display.compactLabels) return name;\n    \n    const parts = name.split(' ');\n    if (parts.length < 2) return name;\n    \n    const firstName = parts[0];\n    const lastName = parts.slice(1).join(' ');\n    return `${firstName.charAt(0)}. ${lastName}`;\n  };\n\n  return (\n    <div className=\"h-full p-4 bg-white overflow-auto text-sm\">\n      {/* Header */}\n      <div className=\"mb-6\">\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <h1 className=\"text-xl font-bold text-gray-900 mb-1\">\n              Betaalstatus Matrix {config.year}\n            </h1>\n            {config.filters.categories.length > 0 && (\n              <div className=\"text-sm text-gray-600\">\n                Categorieën: {config.filters.categories.join(', ')}\n              </div>\n            )}\n            {config.display.showPercentage && (\n              <div className=\"text-lg font-semibold text-blue-600 mt-1\">\n                {paidPercentage}% betaald\n              </div>\n            )}\n          </div>\n\n          {config.display.showChart && (\n            <div className=\"w-48 h-32\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <PieChart>\n                  <Pie\n                    data={chartData}\n                    dataKey=\"value\"\n                    nameKey=\"name\"\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={20}\n                    outerRadius={50}\n                    fill=\"#8884d8\"\n                  />\n                  <Legend \n                    verticalAlign=\"bottom\" \n                    height={20}\n                    iconSize={8}\n                    wrapperStyle={{ fontSize: '10px' }}\n                  />\n                </PieChart>\n              </ResponsiveContainer>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Matrix */}\n      <div className=\"overflow-auto\">\n        <table role=\"table\" className=\"border-collapse\">\n          <thead>\n            <tr>\n              <th \n                scope=\"col\" \n                className=\"sticky left-0 bg-white border border-gray-200 p-2 text-left font-medium text-gray-900 min-w-24\"\n              >\n                Lid\n              </th>\n              {monthShortNl.map((month, index) => (\n                <th \n                  key={index}\n                  scope=\"col\"\n                  className=\"border border-gray-200 p-1 text-center font-medium text-gray-900 text-xs\"\n                  style={{ width: `${config.layout.columnWidth}px` }}\n                >\n                  {month}\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {snapshot.rows.map((row) => (\n              <tr key={row.memberId}>\n                <th \n                  scope=\"row\"\n                  className=\"sticky left-0 bg-white border border-gray-200 p-2 font-medium text-gray-900 text-xs\"\n                  style={{ maxHeight: `${config.layout.maxRowHeight}px` }}\n                >\n                  <div className=\"truncate\" title={row.name}>\n                    {formatMemberName(row.name)}\n                  </div>\n                </th>\n                {Array.from({ length: 12 }, (_, monthIndex) => {\n                  const monthNum = monthIndex + 1;\n                  const status = row.months[monthNum] || 'NA';\n                  return (\n                    <td \n                      key={monthNum}\n                      className=\"border border-gray-200 p-0\"\n                      aria-label={`${row.name}, ${monthShortNl[monthIndex]}: ${status.toLowerCase()}`}\n                    >\n                      <div \n                        className=\"flex items-center justify-center\"\n                        style={getCellStyle(status)}\n                      >\n                        {getCellContent(status)}\n                      </div>\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Footer Stats */}\n      <div className=\"mt-6 flex gap-6 text-xs text-gray-600\">\n        <div>Totaal leden: {snapshot.count}</div>\n        <div>Betaalde transacties: {snapshot.totals.paid}</div>\n        <div>Openstaande transacties: {snapshot.totals.open}</div>\n        <div>Vervallen transacties: {snapshot.totals.overdue}</div>\n      </div>\n    </div>\n  );\n}","size_bytes":6448},"client/src/components/public-view/AnnouncementsView.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { AnnouncementsConfig } from \"@/lib/mock/public-screens\";\nimport { getActiveSlides } from \"@/lib/mock/announcements\";\nimport { SyncClient } from \"./SyncClient\";\n\ninterface AnnouncementsViewProps {\n  config: AnnouncementsConfig;\n}\n\nexport function AnnouncementsView({ config }: AnnouncementsViewProps) {\n  const [currentSlide, setCurrentSlide] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(config.autoplay.enabled);\n  const [slides, setSlides] = useState(() => {\n    // Get active slides and merge with config\n    const activeSlides = getActiveSlides(new Date().toISOString()).filter(slide => \n      config.slides.some(configSlide => \n        configSlide.id === slide.id && configSlide.active\n      )\n    );\n    \n    return activeSlides.map(activeSlide => {\n      const configSlide = config.slides.find(s => s.id === activeSlide.id);\n      return configSlide || activeSlide;\n    });\n  });\n\n  // Auto-sync every 30 seconds\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const activeSlides = getActiveSlides(new Date().toISOString()).filter(slide => \n        config.slides.some(configSlide => \n          configSlide.id === slide.id && configSlide.active\n        )\n      );\n      \n      const updatedSlides = activeSlides.map(activeSlide => {\n        const configSlide = config.slides.find(s => s.id === activeSlide.id);\n        return configSlide || activeSlide;\n      });\n      \n      setSlides(updatedSlides);\n    }, 30000);\n\n    return () => clearInterval(interval);\n  }, [config.slides]);\n\n  // Autoplay logic\n  useEffect(() => {\n    if (!isPlaying || slides.length <= 1) return;\n\n    const currentSlideDuration = slides[currentSlide]?.durationSec || config.autoplay.interval;\n    const timer = setTimeout(() => {\n      setCurrentSlide(prev => (prev + 1) % slides.length);\n    }, currentSlideDuration * 1000);\n\n    return () => clearTimeout(timer);\n  }, [currentSlide, isPlaying, slides, config.autoplay.interval]);\n\n  // Reset current slide if out of bounds\n  useEffect(() => {\n    if (slides.length > 0 && currentSlide >= slides.length) {\n      setCurrentSlide(0);\n    }\n  }, [slides.length, currentSlide]);\n\n  // Keyboard controls\n  useEffect(() => {\n    const handleKeyPress = (e: KeyboardEvent) => {\n      switch (e.key) {\n        case ' ':\n          e.preventDefault();\n          setIsPlaying(!isPlaying);\n          break;\n        case 'ArrowLeft':\n          e.preventDefault();\n          if (slides.length > 1) {\n            setCurrentSlide(prev => (prev - 1 + slides.length) % slides.length);\n          }\n          break;\n        case 'ArrowRight':\n          e.preventDefault();\n          if (slides.length > 1) {\n            setCurrentSlide(prev => (prev + 1) % slides.length);\n          }\n          break;\n      }\n    };\n\n    document.addEventListener('keydown', handleKeyPress);\n    return () => document.removeEventListener('keydown', handleKeyPress);\n  }, [isPlaying, slides.length]);\n\n  if (slides.length === 0) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-900 text-white\">\n        <SyncClient />\n        <div className=\"text-center space-y-4\">\n          <div className=\"text-3xl font-bold\">Geen actieve mededelingen</div>\n          <div className=\"text-lg opacity-75\">\n            Er zijn momenteel geen mededelingen beschikbaar\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const slide = slides[currentSlide];\n  const backgroundClass = config.style.background === 'white' ? 'bg-white' : \n                         config.style.background === 'black' ? 'bg-black' : 'bg-transparent';\n  const textClass = config.style.textContrast === 'light' ? 'text-white' : 'text-black';\n\n  return (\n    <div className={`min-h-screen relative ${backgroundClass} ${textClass} overflow-hidden`}>\n      <SyncClient />\n      \n      {/* Slide Content */}\n      <div className=\"h-screen flex items-center justify-center p-12\">\n        <div \n          className=\"text-center space-y-8 max-w-full\"\n          style={{ maxWidth: `${config.style.maxTextWidth}px` }}\n          role=\"group\"\n          aria-label={`Slide ${currentSlide + 1} van ${slides.length}: ${slide.title}`}\n        >\n          {/* Media */}\n          {slide.mediaUrl && (\n            <div className=\"mb-12\">\n              {slide.mediaType === 'image' ? (\n                <img \n                  src={slide.mediaUrl} \n                  alt=\"\"\n                  className=\"max-w-full max-h-96 mx-auto object-contain rounded-lg shadow-lg\"\n                />\n              ) : slide.mediaType === 'video' ? (\n                <video \n                  src={slide.mediaUrl}\n                  className=\"max-w-full max-h-96 mx-auto object-contain rounded-lg shadow-lg\"\n                  autoPlay\n                  muted\n                  loop\n                />\n              ) : null}\n            </div>\n          )}\n\n          {/* Title */}\n          <h1 className=\"text-6xl font-bold leading-tight\">\n            {slide.title}\n          </h1>\n\n          {/* Body */}\n          {slide.body && (\n            <div className=\"text-2xl leading-relaxed whitespace-pre-wrap max-w-4xl mx-auto\">\n              {slide.body}\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress Indicator */}\n      {slides.length > 1 && (\n        <div className=\"absolute bottom-8 left-1/2 transform -translate-x-1/2\">\n          <div className=\"flex items-center gap-4 bg-black bg-opacity-50 rounded-full px-6 py-3\">\n            <div className=\"text-lg opacity-90\">\n              {currentSlide + 1} / {slides.length}\n            </div>\n            <div className=\"flex gap-2\">\n              {slides.map((_, index) => (\n                <div\n                  key={index}\n                  className={`w-3 h-3 rounded-full transition-all duration-300 ${\n                    index === currentSlide \n                      ? 'bg-current scale-125' \n                      : 'bg-current opacity-40'\n                  }`}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Play/Pause Status */}\n      {config.autoplay.enabled && (\n        <div \n          className=\"absolute top-8 right-8 text-sm opacity-60\"\n          aria-live=\"polite\"\n        >\n          {isPlaying ? 'Autoplay actief' : 'Gepauzeerd'}\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":6408},"client/src/components/public-view/Controls.tsx":{"content":"\"use client\";\n\nimport { PublicScreen } from \"@/lib/mock/public-screens\";\nimport { Button } from \"@/components/ui/button\";\nimport { RefreshCw, Maximize, Minimize } from \"lucide-react\";\n\ninterface ControlsProps {\n  screen: PublicScreen;\n  isFullscreen: boolean;\n  showControls: boolean;\n  onFullscreen: () => void;\n  onRefresh: () => void;\n}\n\nexport function Controls({ \n  screen, \n  isFullscreen, \n  showControls, \n  onFullscreen, \n  onRefresh \n}: ControlsProps) {\n  return (\n    <div \n      className={`fixed top-4 right-4 flex gap-2 transition-opacity duration-300 z-50 ${\n        showControls ? 'opacity-100' : 'opacity-0 pointer-events-none'\n      }`}\n    >\n      <Button\n        variant=\"secondary\"\n        size=\"sm\"\n        onClick={onRefresh}\n        className=\"bg-black bg-opacity-75 text-white hover:bg-opacity-90 border-0\"\n        aria-label=\"Vernieuwen (R)\"\n      >\n        <RefreshCw className=\"h-4 w-4\" />\n      </Button>\n      \n      <Button\n        variant=\"secondary\"\n        size=\"sm\"\n        onClick={onFullscreen}\n        className=\"bg-black bg-opacity-75 text-white hover:bg-opacity-90 border-0\"\n        aria-label={isFullscreen ? \"Volledig scherm verlaten (F)\" : \"Volledig scherm (F)\"}\n      >\n        {isFullscreen ? <Minimize className=\"h-4 w-4\" /> : <Maximize className=\"h-4 w-4\" />}\n      </Button>\n    </div>\n  );\n}","size_bytes":1340},"client/src/components/public-view/PaymentMatrixView.tsx":{"content":"\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\n// Removed specific config import for now\ninterface PaymentMatrixConfig {\n  year: number;\n  filters: {\n    categories: string[];\n    activeOnly: boolean;\n  };\n  colors: {\n    paid: string;\n    open: string;\n    overdue: string;\n    unknown: string;\n  };\n  layout: {\n    columnWidth: number;\n    maxRowHeight: number;\n  };\n  display: {\n    showLegend: boolean;\n    showStats: boolean;\n  };\n}\nimport { getPaymentSnapshot, monthShortNl, Cell } from \"@/lib/mock/fees-snapshot\";\nimport { PieChart, Pie, ResponsiveContainer, Legend } from \"recharts\";\nimport { Check, X, AlertTriangle } from \"lucide-react\";\nimport { SyncClient } from \"./SyncClient\";\n\ninterface PaymentMatrixViewProps {\n  config: PaymentMatrixConfig;\n}\n\nconst PaymentMatrixView = React.memo(function PaymentMatrixView({ config }: PaymentMatrixViewProps) {\n  const [snapshot, setSnapshot] = useState(() => \n    getPaymentSnapshot(config.year, {\n      categories: config.filters.categories,\n      activeOnly: config.filters.activeOnly\n    })\n  );\n\n  // Auto-sync every 30 seconds (reduced for better performance)\n  useEffect(() => {\n    const interval = setInterval(() => {\n      const newSnapshot = getPaymentSnapshot(config.year, {\n        categories: config.filters.categories,\n        activeOnly: config.filters.activeOnly\n      });\n      setSnapshot(newSnapshot);\n    }, 30000);\n\n    return () => clearInterval(interval);\n  }, [config]);\n\n  const chartData = [\n    { name: 'Betaald', value: snapshot.totals.paid, color: config.colors.paid },\n    { name: 'Openstaand', value: snapshot.totals.open, color: config.colors.open },\n    { name: 'Vervallen', value: snapshot.totals.overdue, color: config.colors.overdue }\n  ];\n\n  const totalPayments = snapshot.totals.paid + snapshot.totals.open + snapshot.totals.overdue;\n  const paidPercentage = totalPayments > 0 ? Math.round((snapshot.totals.paid / totalPayments) * 100) : 0;\n\n  const getCellContent = (status: Cell) => {\n    switch (status) {\n      case 'PAID':\n        return <Check className=\"h-4 w-4 text-white\" />;\n      case 'OPEN':\n        return <X className=\"h-4 w-4 text-gray-600\" />;\n      case 'OVERDUE':\n        return <AlertTriangle className=\"h-4 w-4 text-white\" />;\n      default:\n        return null;\n    }\n  };\n\n  const getCellStyle = (status: Cell) => {\n    const baseStyle = {\n      width: `${config.layout.columnWidth}px`,\n      height: `${config.layout.maxRowHeight}px`,\n      minHeight: '40px'\n    };\n\n    switch (status) {\n      case 'PAID':\n        return { ...baseStyle, backgroundColor: config.colors.paid };\n      case 'OPEN':\n        return { ...baseStyle, backgroundColor: config.colors.open };\n      case 'OVERDUE':\n        return { ...baseStyle, backgroundColor: config.colors.overdue };\n      default:\n        return { ...baseStyle, backgroundColor: config.colors.unknown };\n    }\n  };\n\n  const formatMemberName = (name: string) => {\n    if (!config.display.compactLabels) return name;\n    \n    const parts = name.split(' ');\n    if (parts.length < 2) return name;\n    \n    const firstName = parts[0];\n    const lastName = parts.slice(1).join(' ');\n    return `${firstName.charAt(0)}. ${lastName}`;\n  };\n\n  return (\n    <div className=\"min-h-screen bg-white p-8 overflow-auto\">\n      <SyncClient />\n      \n      {/* Header */}\n      <div className=\"mb-8\">\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <h1 className=\"text-4xl font-bold text-gray-900 mb-2\">\n              Betaalstatus Matrix {config.year}\n            </h1>\n            {config.filters.categories.length > 0 && (\n              <div className=\"text-lg text-gray-600 mb-2\">\n                Categorieën: {config.filters.categories.join(', ')}\n              </div>\n            )}\n            {config.display.showPercentage && (\n              <div className=\"text-2xl font-semibold text-blue-600\">\n                {paidPercentage}% betaald\n              </div>\n            )}\n          </div>\n\n          {config.display.showChart && (\n            <div className=\"w-80 h-64\">\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\n                <PieChart>\n                  <Pie\n                    data={chartData}\n                    dataKey=\"value\"\n                    nameKey=\"name\"\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    innerRadius={40}\n                    outerRadius={80}\n                    fill=\"#8884d8\"\n                  />\n                  <Legend \n                    verticalAlign=\"bottom\" \n                    height={36}\n                    iconSize={12}\n                    wrapperStyle={{ fontSize: '14px' }}\n                  />\n                </PieChart>\n              </ResponsiveContainer>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Matrix */}\n      <div className=\"overflow-auto\">\n        <table role=\"table\" className=\"border-collapse w-full\">\n          <thead>\n            <tr>\n              <th \n                scope=\"col\" \n                className=\"sticky left-0 bg-white border-2 border-gray-300 p-4 text-left font-bold text-gray-900 text-lg min-w-48\"\n              >\n                Lid\n              </th>\n              {monthShortNl.map((month, index) => (\n                <th \n                  key={index}\n                  scope=\"col\"\n                  className=\"border-2 border-gray-300 p-2 text-center font-bold text-gray-900\"\n                  style={{ width: `${config.layout.columnWidth}px` }}\n                >\n                  {month}\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {snapshot.rows.map((row) => (\n              <tr key={row.memberId}>\n                <th \n                  scope=\"row\"\n                  className=\"sticky left-0 bg-white border-2 border-gray-300 p-4 font-semibold text-gray-900\"\n                  style={{ maxHeight: `${config.layout.maxRowHeight}px` }}\n                >\n                  <div className=\"truncate\" title={row.name}>\n                    {formatMemberName(row.name)}\n                  </div>\n                </th>\n                {Array.from({ length: 12 }, (_, monthIndex) => {\n                  const monthNum = monthIndex + 1;\n                  const status = row.months[monthNum] || 'NA';\n                  return (\n                    <td \n                      key={monthNum}\n                      className=\"border-2 border-gray-300 p-0\"\n                      aria-label={`${row.name}, ${monthShortNl[monthIndex]}: ${status.toLowerCase()}`}\n                    >\n                      <div \n                        className=\"flex items-center justify-center\"\n                        style={getCellStyle(status)}\n                      >\n                        {getCellContent(status)}\n                      </div>\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n\n      {/* Footer Stats */}\n      <div className=\"mt-8 grid grid-cols-2 md:grid-cols-4 gap-6 text-center\">\n        <div className=\"bg-gray-50 p-4 rounded-lg\">\n          <div className=\"text-2xl font-bold text-gray-900\">{snapshot.count}</div>\n          <div className=\"text-sm text-gray-600\">Totaal leden</div>\n        </div>\n        <div className=\"bg-blue-50 p-4 rounded-lg\">\n          <div className=\"text-2xl font-bold text-blue-600\">{snapshot.totals.paid}</div>\n          <div className=\"text-sm text-gray-600\">Betaald</div>\n        </div>\n        <div className=\"bg-yellow-50 p-4 rounded-lg\">\n          <div className=\"text-2xl font-bold text-yellow-600\">{snapshot.totals.open}</div>\n          <div className=\"text-sm text-gray-600\">Openstaand</div>\n        </div>\n        <div className=\"bg-red-50 p-4 rounded-lg\">\n          <div className=\"text-2xl font-bold text-red-600\">{snapshot.totals.overdue}</div>\n          <div className=\"text-sm text-gray-600\">Vervallen</div>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport { PaymentMatrixView };","size_bytes":8072},"client/src/components/public-view/SyncClient.tsx":{"content":"\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nexport function SyncClient() {\n  const [lastSync, setLastSync] = useState<Date>(new Date());\n  const [isOnline, setIsOnline] = useState(navigator.onLine);\n\n  useEffect(() => {\n    // Check reduced motion preference\n    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n    \n    if (prefersReducedMotion) {\n      return; // Skip sync animations if user prefers reduced motion\n    }\n\n    // Mock sync indicator (in real app this would sync with server)\n    const interval = setInterval(() => {\n      setLastSync(new Date());\n    }, 30000); // Update every 30 seconds\n\n    // Online/offline detection\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n    \n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      clearInterval(interval);\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  return (\n    <div \n      className=\"fixed bottom-4 left-4 text-xs text-gray-500 z-50\"\n      aria-live=\"polite\"\n    >\n      <div className={`flex items-center gap-2 ${isOnline ? 'text-green-600' : 'text-red-600'}`}>\n        <div \n          className={`w-2 h-2 rounded-full ${\n            isOnline ? 'bg-green-500' : 'bg-red-500'\n          }`}\n        />\n        <span>\n          {isOnline ? 'Online' : 'Offline'} • Laatst gesynchroniseerd: {lastSync.toLocaleTimeString('nl-BE')}\n        </span>\n      </div>\n    </div>\n  );\n}","size_bytes":1631},"client/src/components/ui/CopyField.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"./button\";\nimport { Input } from \"./input\";\nimport { Copy, Check } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface CopyFieldProps {\n  value: string;\n  placeholder?: string;\n}\n\nexport function CopyField({ value, placeholder }: CopyFieldProps) {\n  const [copied, setCopied] = useState(false);\n  const { toast } = useToast();\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(value);\n      setCopied(true);\n      toast({\n        title: \"Gekopieerd\",\n        description: \"URL is gekopieerd naar klembord\",\n      });\n      setTimeout(() => setCopied(false), 2000);\n    } catch (error) {\n      toast({\n        title: \"Fout\",\n        description: \"Kon niet kopiëren naar klembord\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  return (\n    <div className=\"flex gap-2\">\n      <Input \n        value={value} \n        placeholder={placeholder}\n        readOnly \n        className=\"font-mono text-sm\"\n      />\n      <Button\n        type=\"button\"\n        variant=\"outline\"\n        size=\"sm\"\n        onClick={handleCopy}\n        className=\"shrink-0\"\n      >\n        {copied ? <Check className=\"h-4 w-4\" /> : <Copy className=\"h-4 w-4\" />}\n      </Button>\n    </div>\n  );\n}","size_bytes":1310},"client/src/lib/mock/announcements.ts":{"content":"export interface Slide {\n  id: string;\n  title: string;\n  body?: string;\n  mediaUrl?: string;\n  mediaType?: 'image' | 'video';\n  validFrom?: string;\n  validTo?: string;\n  active: boolean;\n  durationSec?: number;\n}\n\nconst mockSlides: Slide[] = [\n  {\n    id: \"slide1\",\n    title: \"Ramadan Mubarak\",\n    body: \"Wensen jullie allemaal een gezegend Ramadan. Moge Allah jullie gebeden en goede daden aanvaarden.\",\n    active: true,\n    durationSec: 12,\n    validFrom: \"2025-03-01T00:00:00Z\",\n    validTo: \"2025-04-30T23:59:59Z\"\n  },\n  {\n    id: \"slide2\", \n    title: \"Vrijdaggebed\",\n    body: \"Elke vrijdag om 13:00 uur. Kom op tijd voor een plaats vooraan.\",\n    active: true,\n    durationSec: 8,\n    validFrom: \"2025-01-01T00:00:00Z\",\n    validTo: \"2025-12-31T23:59:59Z\"\n  },\n  {\n    id: \"slide3\",\n    title: \"Gemeenschapsfeest\",\n    body: \"Zaterdag 15 februari - groot feest voor alle families. Inschrijving bij de receptie.\",\n    active: true,\n    durationSec: 10,\n    validFrom: \"2025-01-15T00:00:00Z\",\n    validTo: \"2025-02-15T23:59:59Z\"\n  },\n  {\n    id: \"slide4\",\n    title: \"Quran Lessen\",\n    body: \"Nieuwe cursus begint maandag. Voor kinderen van 6-12 jaar.\",\n    active: false,\n    durationSec: 8,\n    validFrom: \"2025-01-01T00:00:00Z\",\n    validTo: \"2025-06-30T23:59:59Z\"\n  }\n];\n\nexport function getActiveSlides(nowISO: string): Slide[] {\n  const now = new Date(nowISO);\n  \n  return mockSlides.filter(slide => {\n    if (!slide.active) return false;\n    \n    if (slide.validFrom) {\n      const validFrom = new Date(slide.validFrom);\n      if (now < validFrom) return false;\n    }\n    \n    if (slide.validTo) {\n      const validTo = new Date(slide.validTo);\n      if (now > validTo) return false;\n    }\n    \n    return true;\n  });\n}\n\nexport function getAllSlides(): Slide[] {\n  return [...mockSlides];\n}\n\nexport function updateSlide(id: string, updates: Partial<Slide>): Slide {\n  const index = mockSlides.findIndex(s => s.id === id);\n  if (index === -1) throw new Error('Slide not found');\n  \n  mockSlides[index] = { ...mockSlides[index], ...updates };\n  return mockSlides[index];\n}\n\nexport function createSlide(slide: Omit<Slide, 'id'>): Slide {\n  const newSlide: Slide = {\n    ...slide,\n    id: `slide${Date.now()}`\n  };\n  mockSlides.push(newSlide);\n  return newSlide;\n}\n\nexport function deleteSlide(id: string): void {\n  const index = mockSlides.findIndex(s => s.id === id);\n  if (index !== -1) {\n    mockSlides.splice(index, 1);\n  }\n}","size_bytes":2443},"client/src/lib/mock/fees-snapshot.ts":{"content":"export type Cell = 'PAID' | 'OPEN' | 'OVERDUE' | 'NA';\n\nexport interface MemberRow {\n  memberId: string;\n  name: string;\n  category: 'Senior' | 'Standaard' | 'Student';\n  months: Record<number, Cell>; // 1..12\n}\n\nexport interface PaymentSnapshot {\n  rows: MemberRow[];\n  totals: {\n    paid: number;\n    open: number;\n    overdue: number;\n    na: number;\n  };\n  count: number;\n}\n\nconst mockMembers: MemberRow[] = [\n  {\n    memberId: \"1\",\n    name: \"Ahmed Hassan\",\n    category: \"Standaard\",\n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'PAID', 4: 'PAID',\n      5: 'PAID', 6: 'OPEN', 7: 'OPEN', 8: 'OPEN',\n      9: 'OPEN', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  },\n  {\n    memberId: \"2\",\n    name: \"Fatima Al-Zahra\",\n    category: \"Standaard\", \n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'PAID', 4: 'PAID',\n      5: 'PAID', 6: 'PAID', 7: 'PAID', 8: 'OPEN',\n      9: 'OPEN', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  },\n  {\n    memberId: \"3\",\n    name: \"Omar Ibrahim\",\n    category: \"Student\",\n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'OVERDUE', 4: 'OVERDUE',\n      5: 'OPEN', 6: 'OPEN', 7: 'OPEN', 8: 'OPEN',\n      9: 'OPEN', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  },\n  {\n    memberId: \"4\",\n    name: \"Khadija Benali\",\n    category: \"Senior\",\n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'PAID', 4: 'PAID',\n      5: 'PAID', 6: 'PAID', 7: 'PAID', 8: 'PAID',\n      9: 'PAID', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  },\n  {\n    memberId: \"5\",\n    name: \"Youssef Mansour\",\n    category: \"Standaard\",\n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'PAID', 4: 'OVERDUE',\n      5: 'OVERDUE', 6: 'OPEN', 7: 'OPEN', 8: 'OPEN',\n      9: 'OPEN', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  },\n  {\n    memberId: \"6\",\n    name: \"Aisha El-Khoury\",\n    category: \"Student\",\n    months: {\n      1: 'PAID', 2: 'PAID', 3: 'PAID', 4: 'PAID',\n      5: 'PAID', 6: 'PAID', 7: 'OPEN', 8: 'OPEN',\n      9: 'OPEN', 10: 'OPEN', 11: 'OPEN', 12: 'OPEN'\n    }\n  }\n];\n\nexport function getPaymentSnapshot(\n  year: number, \n  filters?: {\n    categories?: string[];\n    activeOnly?: boolean;\n  }\n): PaymentSnapshot {\n  let filteredRows = [...mockMembers];\n\n  if (filters?.categories && filters.categories.length > 0) {\n    filteredRows = filteredRows.filter(row => \n      filters.categories!.includes(row.category)\n    );\n  }\n\n  // Calculate totals\n  let paid = 0, open = 0, overdue = 0, na = 0;\n  \n  filteredRows.forEach(row => {\n    Object.values(row.months).forEach(status => {\n      switch (status) {\n        case 'PAID': paid++; break;\n        case 'OPEN': open++; break;\n        case 'OVERDUE': overdue++; break;\n        case 'NA': na++; break;\n      }\n    });\n  });\n\n  return {\n    rows: filteredRows,\n    totals: { paid, open, overdue, na },\n    count: filteredRows.length\n  };\n}\n\nexport const monthShortNl = [\n  'Jan', 'Feb', 'Mrt', 'Apr', 'Mei', 'Jun',\n  'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec'\n];","size_bytes":2888},"client/src/lib/mock/public-screens.ts":{"content":"import { generateId } from \"./utils\";\n\nexport type ScreenType = 'LEDENLIJST' | 'MEDEDELINGEN' | 'MULTIMEDIA';\n\n// Styling configuratie voor titel en ondertitel\nexport interface TitleStyling {\n  text: string;\n  fontSize: number;\n  fontFamily: string;\n  color: string;\n  fontWeight: 'normal' | 'bold';\n}\n\n// Ledenlijst configuratie\nexport interface LedenlijstConfig {\n  description?: string;\n  title: TitleStyling;\n  subtitle: TitleStyling;\n  display: {\n    useFullNames: boolean;\n    useInitials: boolean;\n    filterByCategories: boolean;\n    showVotingRights: boolean;\n    rowsPerPage: number;\n    secondsPerPage?: number;\n  };\n  year: number;\n  categories: string[];\n}\n\n// Mededelingen configuratie\nexport interface MededelingenSlide {\n  id: string;\n  title: string;\n  subtitle?: string;\n  body?: string;\n  mediaUrl?: string;\n  mediaType?: 'image' | 'video';\n  validFrom?: string;\n  validTo?: string;\n  active: boolean;\n  durationSec: number;\n  styling?: {\n    titleFontSize: number;\n    titleFontWeight: 'normal' | 'bold' | 'lighter';\n    titleFontFamily: string;\n    titleColor: string;\n    subtitleFontSize: number;\n    subtitleFontWeight: 'normal' | 'bold' | 'lighter';\n    subtitleFontFamily: string;\n    subtitleColor: string;\n    bodyFontSize: number;\n    bodyFontWeight: 'normal' | 'bold' | 'lighter';\n    bodyFontFamily: string;\n    bodyColor: string;\n    backgroundColor: string;\n  };\n}\n\nexport interface MededelingenConfig {\n  description?: string;\n  title: TitleStyling;\n  subtitle: TitleStyling;\n  slides: MededelingenSlide[];\n  autoplay: {\n    enabled: boolean;\n    interval: number;\n    order: 'date' | 'manual' | 'shuffle';\n  };\n  style: {\n    textContrast: 'light' | 'dark';\n    background: 'white' | 'black' | 'transparent';\n    maxTextWidth: number;\n  };\n}\n\n// Multimedia configuratie\nexport interface MultimediaConfig {\n  description?: string;\n  title: TitleStyling;\n  subtitle: TitleStyling;\n  mediaItems: {\n    id: string;\n    url: string;\n    type: 'image' | 'video';\n    duration: number;\n    active: boolean;\n  }[];\n  autoplay: {\n    enabled: boolean;\n    interval: number;\n  };\n}\n\nexport interface PublicScreen {\n  id: string;\n  name: string;\n  type: ScreenType;\n  active: boolean;\n  publicToken: string;\n  updatedAt: string;\n  config: LedenlijstConfig | MededelingenConfig | MultimediaConfig;\n}\n\n// In-memory store\nlet screens: PublicScreen[] = [\n  {\n    id: \"1\",\n    name: \"Ledenlijst 2025\",\n    type: \"LEDENLIJST\",\n    active: true,\n    publicToken: \"ledenlijst-2025-abc123\",\n    updatedAt: new Date().toISOString(),\n    config: {\n      description: \"Overzicht van alle leden met betaalstatus\",\n      title: {\n        text: \"Ledenlijst\",\n        fontSize: 32,\n        fontFamily: \"Poppins\",\n        color: \"#1f2937\",\n        fontWeight: \"bold\"\n      },\n      subtitle: {\n        text: \"Betaalstatus 2025\",\n        fontSize: 18,\n        fontFamily: \"Poppins\",\n        color: \"#6b7280\",\n        fontWeight: \"normal\"\n      },\n      display: {\n        useFullNames: true,\n        useInitials: false,\n        filterByCategories: true,\n        showVotingRights: false,\n        rowsPerPage: 20\n      },\n      year: 2025,\n      categories: [\"Standaard\", \"Student\"]\n    } as LedenlijstConfig\n  },\n  {\n    id: \"2\", \n    name: \"Algemene Mededelingen\",\n    type: \"MEDEDELINGEN\",\n    active: false,\n    publicToken: \"mededelingen-xyz789\",\n    updatedAt: new Date(Date.now() - 86400000).toISOString(),\n    config: {\n      description: \"Belangrijke mededelingen voor de gemeenschap\",\n      title: {\n        text: \"Mededelingen\",\n        fontSize: 28,\n        fontFamily: \"Poppins\",\n        color: \"#1f2937\",\n        fontWeight: \"bold\"\n      },\n      subtitle: {\n        text: \"Laatste updates\",\n        fontSize: 16,\n        fontFamily: \"Poppins\",\n        color: \"#6b7280\",\n        fontWeight: \"normal\"\n      },\n      slides: [\n        {\n          id: \"slide1\",\n          title: \"Welkom bij onze moskee\",\n          body: \"Vrede zij met u. Welkom in ons gemeenschapshuis.\",\n          active: true,\n          durationSec: 10\n        }\n      ],\n      autoplay: {\n        enabled: true,\n        interval: 8,\n        order: \"date\"\n      },\n      style: {\n        textContrast: \"light\",\n        background: \"black\",\n        maxTextWidth: 800\n      }\n    } as MededelingenConfig\n  }\n];\n\nexport const publicScreensStore = {\n  list(): PublicScreen[] {\n    return [...screens];\n  },\n\n  create(input: Omit<PublicScreen, 'id' | 'publicToken' | 'updatedAt'>): PublicScreen {\n    const screen: PublicScreen = {\n      ...input,\n      id: generateId(),\n      publicToken: this.generateToken(),\n      updatedAt: new Date().toISOString()\n    };\n    screens.push(screen);\n    return screen;\n  },\n\n  update(id: string, patch: Partial<PublicScreen>): PublicScreen {\n    const index = screens.findIndex(s => s.id === id);\n    if (index === -1) throw new Error('Screen not found');\n    \n    screens[index] = {\n      ...screens[index],\n      ...patch,\n      updatedAt: new Date().toISOString()\n    };\n    return screens[index];\n  },\n\n  remove(id: string): void {\n    screens = screens.filter(s => s.id !== id);\n  },\n\n  byToken(token: string): PublicScreen | undefined {\n    return screens.find(s => s.publicToken === token);\n  },\n\n  generateToken(): string {\n    return `screen-${Math.random().toString(36).substring(2, 15)}`;\n  }\n};","size_bytes":5324},"client/src/lib/mock/utils.ts":{"content":"export function generateId(): string {\n  return Math.random().toString(36).substring(2, 15);\n}\n\nexport function formatDateBE(dateString: string): string {\n  const date = new Date(dateString);\n  return date.toLocaleDateString('nl-BE', {\n    day: '2-digit',\n    month: '2-digit', \n    year: 'numeric'\n  });\n}\n\nexport function cn(...classes: (string | undefined | null | false)[]): string {\n  return classes.filter(Boolean).join(' ');\n}","size_bytes":433},"client/src/pages/PublicScreenViewPage.tsx":{"content":"\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { useRoute } from \"wouter\";\nimport { PublicScreen, LedenlijstConfig, MededelingenConfig, MultimediaConfig } from \"@/lib/mock/public-screens\";\nimport { LedenlijstView } from \"@/components/public-view/LedenlijstView\";\nimport { MededelingenView } from \"@/components/public-view/MededelingenView\";\nimport { Controls } from \"@/components/public-view/Controls\";\n\nexport default function PublicScreenViewPage() {\n  const [match, params] = useRoute(\"/screen/:publicToken\");\n  const publicToken = params?.publicToken;\n  const [screen, setScreen] = useState<PublicScreen | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<{type: string, message: string} | null>(null);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [showControls, setShowControls] = useState(true);\n\n\n  // FETCH DATA WHEN COMPONENT MOUNTS OR TOKEN CHANGES\n  React.useEffect(() => {\n    if (!publicToken) {\n      setLoading(false);\n      return;\n    }\n\n    setLoading(true);\n\n    const fetchData = async () => {\n      try {\n        const timestamp = new Date().getTime();\n        const url = `/api/public-screens/token/${publicToken}?t=${timestamp}`;\n        \n        const response = await fetch(url, {\n          method: 'GET',\n          cache: 'no-store',\n          headers: {\n            'Cache-Control': 'no-cache, no-store, must-revalidate',\n            'Pragma': 'no-cache',\n            'Expires': '0'\n          }\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          setScreen(data);\n          setError(null);\n        } else {\n          // Handle different error responses\n          if (response.status === 403) {\n            const errorData = await response.json();\n            setError({\n              type: errorData.type || 'UNKNOWN',\n              message: errorData.message || 'Dit scherm is momenteel niet actief'\n            });\n          } else {\n            setError({\n              type: 'NOT_FOUND',\n              message: 'Het opgevraagde scherm bestaat niet of is verwijderd'\n            });\n          }\n          setScreen(null);\n        }\n      } catch (error) {\n        console.error('Error loading screen:', error);\n        setError({\n          type: 'CONNECTION_ERROR',\n          message: 'Kan geen verbinding maken met de server'\n        });\n        setScreen(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [publicToken]);\n\n  // Update document title\n  React.useEffect(() => {\n    if (screen?.name) {\n      document.title = screen.name;\n    }\n    return () => {\n      document.title = 'Ledenbeheer';\n    };\n  }, [screen?.name]);\n\n  // Handle keyboard shortcuts and mouse controls\n  React.useEffect(() => {\n    const timer = setTimeout(() => setShowControls(false), 3000);\n    \n    const handleMouseMove = () => {\n      setShowControls(true);\n      clearTimeout(timer);\n      setTimeout(() => setShowControls(false), 3000);\n    };\n\n    const handleKeyPress = (e: KeyboardEvent) => {\n      switch (e.key.toLowerCase()) {\n        case 'f':\n          e.preventDefault();\n          handleFullscreen();\n          break;\n        case 'r':\n          e.preventDefault();\n          setLoading(true);\n          // Trigger re-fetch by incrementing a counter\n          window.location.reload();\n          break;\n      }\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('keydown', handleKeyPress);\n    \n    return () => {\n      clearTimeout(timer);\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('keydown', handleKeyPress);\n    };\n  }, []);\n\n  const handleFullscreen = async () => {\n    if (!document.fullscreenElement) {\n      try {\n        await document.documentElement.requestFullscreen();\n        setIsFullscreen(true);\n      } catch (error) {\n        console.error('Fullscreen failed:', error);\n      }\n    } else {\n      try {\n        await document.exitFullscreen();\n        setIsFullscreen(false);\n      } catch (error) {\n        console.error('Exit fullscreen failed:', error);\n      }\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-900 text-white\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto\"></div>\n          <div>Scherm laden...</div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!screen && error) {\n    // Type-specific error messages\n    const getErrorContent = () => {\n      switch (error.type) {\n        case 'MEDEDELINGEN':\n          return {\n            title: 'Geen actieve mededelingen',\n            message: 'Er zijn momenteel geen mededelingen beschikbaar.'\n          };\n        case 'LEDENLIJST':\n          return {\n            title: 'Geen actieve ledenlijst',\n            message: 'De ledenlijst is momenteel niet beschikbaar.'\n          };\n        case 'NOT_FOUND':\n          return {\n            title: 'Scherm niet gevonden',\n            message: error.message\n          };\n        default:\n          return {\n            title: 'Scherm niet beschikbaar',\n            message: error.message\n          };\n      }\n    };\n\n    const errorContent = getErrorContent();\n    \n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-900 text-white\">\n        <div className=\"text-center space-y-4\">\n          <h1 className=\"text-2xl font-bold\">{errorContent.title}</h1>\n          <p className=\"text-gray-400\">\n            {errorContent.message}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!screen) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-900 text-white\">\n        <div className=\"text-center space-y-4\">\n          <h1 className=\"text-2xl font-bold\">Scherm niet gevonden</h1>\n          <p className=\"text-gray-400\">\n            Het opgevraagde scherm bestaat niet of is verwijderd.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n\n  return (\n    <div className=\"min-h-screen relative\">\n      {/* Main Content */}\n      {screen.type === 'LEDENLIJST' && (\n        <LedenlijstView \n          key={`ledenlijst-${Date.now()}`}\n          config={screen.config as LedenlijstConfig} \n          members={(screen as any).members || []}\n        />\n      )}\n      \n      {screen.type === 'MEDEDELINGEN' && (\n        <MededelingenView config={screen.config as MededelingenConfig} />\n      )}\n      \n      {screen.type === 'MULTIMEDIA' && (\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-100\">\n          <p className=\"text-gray-600\">Multimedia viewer komt binnenkort...</p>\n        </div>\n      )}\n\n      {/* Controls */}\n      <Controls \n        visible={showControls}\n        isFullscreen={isFullscreen}\n        onFullscreen={handleFullscreen}\n        onRefresh={() => window.location.reload()}\n      />\n    </div>\n  );\n}","size_bytes":7038},"client/src/pages/PublicScreensPage.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Plus } from \"lucide-react\";\nimport { PublicScreensList } from \"@/components/public-screens/PublicScreensList\";\nimport { NewScreenDialog } from \"@/components/public-screens/NewScreenDialog\";\nimport { EditScreenDrawer } from \"@/components/public-screens/EditScreenDrawer\";\nimport { PublicScreen } from \"@/lib/mock/public-screens\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nexport default function PublicScreensPage() {\n  const [showNewDialog, setShowNewDialog] = useState(false);\n  const [editScreen, setEditScreen] = useState<PublicScreen | null>(null);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const handleCreateScreen = async (screenData: {\n    name: string;\n    type: any;\n    config: any;\n  }) => {\n    try {\n      const response = await apiRequest('POST', '/api/public-screens', {\n        name: screenData.name,\n        type: screenData.type,\n        active: true,\n        config: screenData.config\n      });\n\n      const screen = await response.json();\n      \n      // Gebruik slimme cache invalidation in plaats van page reload\n      queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n      \n      toast({\n        title: \"Scherm aangemaakt\",\n        description: `${screen.name} is succesvol aangemaakt.`,\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het aanmaken van het scherm.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleUpdateScreen = (screen: PublicScreen) => {\n    // Invalideer cache voor snellere updates\n    queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n    \n    toast({\n      title: \"Scherm bijgewerkt\",\n      description: `${screen.name} is succesvol bijgewerkt.`,\n    });\n    setEditScreen(null);\n  };\n\n  const handleDeleteScreen = (screenName: string) => {\n    // Invalideer cache na verwijdering\n    queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n    \n    toast({\n      title: \"Scherm verwijderd\",\n      description: `${screenName} is verwijderd.`,\n    });\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-6 mb-8\">\n          <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">\n                Publieke Schermen\n              </h1>\n              <p className=\"mt-3 text-sm text-gray-700\">\n                Genereer & beheer schermen voor betaalstatus en mededelingen\n              </p>\n            </div>\n            <NewScreenDialog onCreateScreen={handleCreateScreen} />\n          </div>\n        </div>\n\n        {/* Screens List */}\n        <PublicScreensList\n          onEdit={setEditScreen}\n          onDelete={handleDeleteScreen}\n        />\n\n        {/* Edit Dialog */}\n\n        <EditScreenDrawer\n          screen={editScreen}\n          onClose={() => setEditScreen(null)}\n          onSave={handleUpdateScreen}\n        />\n      </div>\n    </main>\n  );\n}","size_bytes":3474},"server/routes/public-screens.ts":{"content":"import { Router } from \"express\";\nimport { z } from \"zod\";\nimport { storage } from \"../storage\";\nimport { authMiddleware } from \"../middleware/auth\";\nimport { tenantMiddleware } from \"../middleware/tenant\";\n\nconst router = Router();\n\n\n// Get all public screens (requires auth)\nrouter.get('/', authMiddleware, tenantMiddleware, async (req, res) => {\n  try {\n    const tenantId = req.user?.tenantId;\n    if (!tenantId) {\n      return res.status(401).json({ error: 'Unauthorized' });\n    }\n    const screens = await storage.getPublicScreensByTenant(tenantId);\n    res.json(screens);\n  } catch (error) {\n    console.error('Error fetching public screens:', error);\n    res.status(500).json({ error: 'Failed to fetch public screens' });\n  }\n});\n\n// Get public screen by token (public route)\nrouter.get('/token/:token', async (req, res) => {\n  try {\n    const screen = await storage.getPublicScreenByToken(req.params.token);\n    if (!screen) {\n      return res.status(404).json({ error: 'Screen not found' });\n    }\n    \n    // Check if the screen is active\n    if (!screen.active) {\n      return res.status(403).json({ \n        error: 'Screen inactive', \n        message: 'Dit scherm is momenteel niet actief',\n        type: screen.type \n      });\n    }\n    \n    // For LEDENLIJST screens, also fetch member and fee data\n    let screenData: any = screen;\n    if (screen.type === 'LEDENLIJST') {\n      try {\n        console.log(`Fetching members for tenant: ${screen.tenantId}`);\n        const members = await storage.getMembersByTenant(screen.tenantId);\n        console.log(`Found ${members.length} total members`);\n        // Only send active members for public display\n        const activeMembers = members.filter(member => member.active);\n        console.log(`Found ${activeMembers.length} active members for public display`);\n        \n        // Also fetch membership fees for payment status\n        const allFees = await storage.getMembershipFeesByTenant(screen.tenantId);\n        console.log(`Found ${allFees.length} membership fees`);\n        \n        // Organize fees by member and period for easy lookup\n        const feesByMember = allFees.reduce((acc: any, fee: any) => {\n          if (!acc[fee.memberId]) acc[fee.memberId] = [];\n          acc[fee.memberId].push(fee);\n          return acc;\n        }, {});\n        \n        // Add payment status to each member\n        const membersWithPayments = activeMembers.map(member => ({\n          ...member,\n          membershipFees: feesByMember[member.id] || []\n        }));\n        \n        screenData = {\n          ...screen,\n          members: membersWithPayments\n        } as any;\n      } catch (error) {\n        console.error('Error fetching members for public screen:', error);\n        // Continue without member data rather than failing the whole request\n      }\n    }\n    \n    res.json(screenData);\n  } catch (error) {\n    console.error('Error fetching public screen:', error);\n    res.status(500).json({ error: 'Failed to fetch public screen' });\n  }\n});\n\n// Create new public screen (requires auth)\nrouter.post('/', authMiddleware, tenantMiddleware, async (req, res) => {\n  try {\n    const createSchema = z.object({\n      name: z.string().min(1),\n      type: z.enum(['LEDENLIJST', 'MEDEDELINGEN', 'MULTIMEDIA']),\n      active: z.boolean(),\n      config: z.any().default({})\n    });\n\n    const data = createSchema.parse(req.body);\n    const tenantId = req.user?.tenantId;\n    if (!tenantId) {\n      return res.status(401).json({ error: 'Unauthorized' });\n    }\n    \n    const screenData = {\n      ...data,\n      tenantId,\n      publicToken: `screen-${Math.random().toString(36).substring(2, 15)}`,\n      config: data.config || {}\n    };\n    \n    const screen = await storage.createPublicScreen(screenData);\n    res.status(201).json(screen);\n  } catch (error) {\n    console.error('Error creating public screen:', error);\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ error: 'Invalid data', details: error.errors });\n    }\n    res.status(500).json({ error: 'Failed to create public screen' });\n  }\n});\n\n// Update public screen (requires auth)\n// Also support PATCH for partial updates\nrouter.patch('/:id', authMiddleware, tenantMiddleware, async (req, res) => {\n  try {\n    const updateSchema = z.object({\n      name: z.string().min(1).optional(),\n      active: z.boolean().optional(),\n      config: z.any().optional()\n    });\n\n    const data = updateSchema.parse(req.body);\n    const screen = await storage.updatePublicScreen(req.params.id, data);\n    res.json(screen);\n  } catch (error) {\n    console.error('Error updating public screen:', error);\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ error: 'Invalid data', details: error.errors });\n    }\n    res.status(500).json({ error: 'Failed to update public screen' });\n  }\n});\n\n// Update public screen\nrouter.put('/:id', authMiddleware, tenantMiddleware, async (req, res) => {\n  try {\n    const updateSchema = z.object({\n      name: z.string().min(1).optional(),\n      active: z.boolean().optional(),\n      config: z.any().optional()\n    });\n\n    const data = updateSchema.parse(req.body);\n    const screen = await storage.updatePublicScreen(req.params.id, data);\n    res.json(screen);\n  } catch (error) {\n    console.error('Error updating public screen:', error);\n    if (error instanceof z.ZodError) {\n      return res.status(400).json({ error: 'Invalid data', details: error.errors });\n    }\n    res.status(500).json({ error: 'Failed to update public screen' });\n  }\n});\n\n// Delete public screen (requires auth)\nrouter.delete('/:id', authMiddleware, tenantMiddleware, async (req, res) => {\n  try {\n    await storage.deletePublicScreen(req.params.id);\n    res.status(204).send();\n  } catch (error) {\n    console.error('Error deleting public screen:', error);\n    res.status(500).json({ error: 'Failed to delete public screen' });\n  }\n});\n\nexport default router;","size_bytes":5929},"server/lib/mock/public-screens.ts":{"content":"// Re-export from client for server use\nexport * from \"../../../client/src/lib/mock/public-screens\";","size_bytes":100},"client/src/components/public-screens/wizard/ScreenWizard.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronLeft, ChevronRight, Monitor } from \"lucide-react\";\nimport { ScreenType, TitleStyling, LedenlijstConfig, MededelingenConfig } from \"@/lib/mock/public-screens\";\nimport { TypeSelectionStep } from \"./steps/TypeSelectionStep\";\nimport { DescriptionStep } from \"./steps/DescriptionStep\";\nimport { StylingStep } from \"./steps/StylingStep\";\nimport { LedenlijstConfigStep } from \"./steps/LedenlijstConfigStep\";\nimport { MededelingenConfigStep } from \"./steps/MededelingenConfigStep\";\nimport { MededelingenMessagesStep } from \"./steps/MededelingenMessagesStep\";\nimport { MededelingenCarouselStep } from \"./steps/MededelingenCarouselStep\";\n\ninterface ScreenWizardProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onComplete: (screenData: {\n    name: string;\n    type: ScreenType;\n    config: LedenlijstConfig | MededelingenConfig;\n  }) => void;\n  editingScreen?: {\n    id: string;\n    name: string;\n    type: ScreenType;\n    active: boolean;\n    config: LedenlijstConfig | MededelingenConfig;\n  };\n  mode?: 'create' | 'edit';\n}\n\ninterface WizardData {\n  type?: ScreenType;\n  name: string;\n  description?: string;\n  title: TitleStyling;\n  subtitle: TitleStyling;\n  ledenlijstSettings?: {\n    useFullNames: boolean;\n    useInitials: boolean;\n    filterByCategories: boolean;\n    showVotingRights: boolean;\n    rowsPerPage: number;\n    year: number;\n    categories: string[];\n  };\n  mededelingenSettings?: {\n    slides: Array<{\n      id: string;\n      title: string;\n      body?: string;\n      mediaUrl?: string;\n      mediaType?: 'image' | 'video';\n      active: boolean;\n      durationSec: number;\n    }>;\n    autoplay: {\n      enabled: boolean;\n      interval: number;\n      order: 'date' | 'manual' | 'shuffle';\n    };\n    style: {\n      textColor: string;\n      backgroundColor: string;\n      maxTextWidth: number;\n    };\n  };\n}\n\nconst defaultTitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 32,\n  fontFamily: \"Poppins\",\n  color: \"#1f2937\",\n  fontWeight: \"bold\"\n};\n\nconst defaultSubtitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 18,\n  fontFamily: \"Poppins\", \n  color: \"#6b7280\",\n  fontWeight: \"normal\"\n};\n\nconst resetWizardData = (editingScreen?: ScreenWizardProps['editingScreen']): WizardData => {\n  if (editingScreen) {\n    // Pre-populate with existing screen data\n    const config = editingScreen.config;\n    \n    return {\n      type: editingScreen.type,\n      name: editingScreen.name,\n      description: config.description,\n      title: config.title || { ...defaultTitleStyling },\n      subtitle: config.subtitle || { ...defaultSubtitleStyling },\n      ledenlijstSettings: editingScreen.type === 'LEDENLIJST' ? {\n        useFullNames: (config as LedenlijstConfig).display?.useFullNames ?? true,\n        useInitials: (config as LedenlijstConfig).display?.useInitials ?? false,\n        filterByCategories: (config as LedenlijstConfig).display?.filterByCategories ?? true,\n        showVotingRights: (config as LedenlijstConfig).display?.showVotingRights ?? false,\n        rowsPerPage: (config as LedenlijstConfig).display?.rowsPerPage ?? 20,\n        year: (config as LedenlijstConfig).year ?? new Date().getFullYear(),\n        categories: (config as LedenlijstConfig).categories ?? []\n      } : undefined,\n      mededelingenSettings: editingScreen.type === 'MEDEDELINGEN' ? {\n        slides: (config as MededelingenConfig).slides || [],\n        autoplay: (config as MededelingenConfig).autoplay || {\n          enabled: true,\n          interval: 8,\n          order: 'date'\n        },\n        style: {\n          textColor: (config as MededelingenConfig).style?.textContrast === 'light' ? '#ffffff' : '#000000',\n          backgroundColor: (config as MededelingenConfig).style?.background === 'white' ? '#ffffff' : '#000000',\n          maxTextWidth: (config as MededelingenConfig).style?.maxTextWidth || 800\n        }\n      } : undefined\n    };\n  }\n  \n  return {\n    name: \"\",\n    title: { ...defaultTitleStyling },\n    subtitle: { ...defaultSubtitleStyling }\n  };\n};\n\nexport function ScreenWizard({ open, onOpenChange, onComplete, editingScreen, mode = 'create' }: ScreenWizardProps) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [wizardData, setWizardData] = useState<WizardData>(resetWizardData());\n\n  // Reset wizard when dialog opens\n  useEffect(() => {\n    if (open) {\n      setCurrentStep(mode === 'edit' ? 1 : 0); // Skip type selection for edit mode\n      setWizardData(resetWizardData(editingScreen));\n    }\n  }, [open, editingScreen, mode]);\n\n  const getSteps = () => {\n    const baseSteps: Array<{ title: string; component: any }> = [];\n    \n    // Only show type selection for create mode\n    if (mode === 'create') {\n      baseSteps.push({ title: \"Type selecteren\", component: TypeSelectionStep });\n    }\n    \n    baseSteps.push(\n      { title: \"Beschrijving\", component: DescriptionStep },\n      { title: \"Opmaak\", component: StylingStep }\n    );\n    \n    if (wizardData.type === 'LEDENLIJST') {\n      baseSteps.push({ title: \"Configuratie\", component: LedenlijstConfigStep });\n    } else if (wizardData.type === 'MEDEDELINGEN') {\n      // Voor mededelingen slaan we de opmaak stap over en gaan direct naar berichten\n      baseSteps.splice(2, 1); // Verwijder de \"Opmaak\" stap\n      baseSteps.push({ title: \"Berichten\", component: MededelingenMessagesStep });\n      baseSteps.push({ title: \"Carrousel\", component: MededelingenCarouselStep });\n    }\n    \n    return baseSteps;\n  };\n\n  const steps = getSteps();\n\n  const isLastStep = currentStep === steps.length - 1;\n  const canGoNext = () => {\n    const adjustedStep = mode === 'edit' ? currentStep + 1 : currentStep;\n    \n    switch (adjustedStep) {\n      case 0: return !!wizardData.type;\n      case 1: return wizardData.name.length > 0;\n      case 2: \n        if (wizardData.type === 'MEDEDELINGEN') {\n          // Voor mededelingen is stap 2 de berichten stap\n          return !!wizardData.mededelingenSettings && wizardData.mededelingenSettings.slides.length > 0;\n        } else {\n          // Voor andere types is stap 2 de opmaak stap\n          return wizardData.title && wizardData.title.text && wizardData.title.text.length > 0;\n        }\n      case 3: \n        if (wizardData.type === 'LEDENLIJST') return !!wizardData.ledenlijstSettings;\n        if (wizardData.type === 'MEDEDELINGEN') {\n          // Voor mededelingen is stap 3 de carrousel stap\n          return !!wizardData.mededelingenSettings?.autoplay;\n        }\n        return true;\n      default: return true;\n    }\n  };\n\n  const handleNext = () => {\n    if (isLastStep) {\n      handleComplete();\n    } else {\n      setCurrentStep(prev => prev + 1);\n    }\n  };\n\n  const handleComplete = () => {\n    if (!wizardData.type) return;\n\n    let config: LedenlijstConfig | MededelingenConfig;\n\n    if (wizardData.type === 'LEDENLIJST') {\n      config = {\n        description: wizardData.description,\n        title: wizardData.title,\n        subtitle: wizardData.subtitle,\n        display: {\n          useFullNames: wizardData.ledenlijstSettings?.useFullNames ?? true,\n          useInitials: wizardData.ledenlijstSettings?.useInitials ?? false,\n          filterByCategories: wizardData.ledenlijstSettings?.filterByCategories ?? true,\n          showVotingRights: wizardData.ledenlijstSettings?.showVotingRights ?? false,\n          rowsPerPage: wizardData.ledenlijstSettings?.rowsPerPage ?? 20\n        },\n        year: wizardData.ledenlijstSettings?.year ?? new Date().getFullYear(),\n        categories: wizardData.ledenlijstSettings?.categories ?? []\n      } as LedenlijstConfig;\n    } else if (wizardData.type === 'MEDEDELINGEN') {\n      config = {\n        description: wizardData.description,\n        title: wizardData.title,\n        subtitle: wizardData.subtitle,\n        slides: wizardData.mededelingenSettings?.slides || [],\n        autoplay: wizardData.mededelingenSettings?.autoplay || {\n          enabled: true,\n          interval: 8,\n          order: 'date'\n        },\n        style: {\n          textContrast: wizardData.mededelingenSettings?.style.textColor === '#ffffff' ? 'light' : 'dark',\n          background: wizardData.mededelingenSettings?.style.backgroundColor === '#ffffff' ? 'white' : 'black',\n          maxTextWidth: wizardData.mededelingenSettings?.style.maxTextWidth || 800\n        }\n      } as MededelingenConfig;\n    } else {\n      // Fallback voor onbekende types - gebruik ledenlijst config\n      config = {\n        description: wizardData.description,\n        title: wizardData.title,\n        subtitle: wizardData.subtitle,\n        display: {\n          useFullNames: true,\n          useInitials: false,\n          filterByCategories: true,\n          showVotingRights: false,\n          rowsPerPage: 20\n        },\n        year: new Date().getFullYear(),\n        categories: []\n      } as LedenlijstConfig;\n    }\n\n    onComplete({\n      name: wizardData.name,\n      type: wizardData.type,\n      config\n    });\n\n    // Close dialog (reset happens automatically when reopened)\n    onOpenChange(false);\n  };\n\n  const StepComponent = steps[currentStep]?.component;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-6xl h-[95vh] flex flex-col\" data-testid=\"screen-wizard\">\n        <DialogHeader className=\"flex-shrink-0 pb-6 border-b border-border\">\n          <DialogTitle className=\"flex items-center gap-3 text-xl\">\n            <Monitor className=\"h-6 w-6\" />\n            {mode === 'edit' ? 'Scherm bewerken' : 'Nieuw scherm aanmaken'}: {steps[currentStep]?.title}\n          </DialogTitle>\n          <DialogDescription className=\"text-base mt-2\">\n            {currentStep === 0 && mode === 'create' && \"Kies het type scherm dat je wilt aanmaken\"}\n            {(currentStep === 0 && mode === 'edit') || (currentStep === 1 && mode === 'create') ? \"Geef je scherm een duidelijke naam\" : ''}\n            {((currentStep === 1 && mode === 'edit') || (currentStep === 2 && mode === 'create')) && wizardData.type === 'MEDEDELINGEN' && \"Maak en beheer je berichten\"}\n            {((currentStep === 1 && mode === 'edit') || (currentStep === 2 && mode === 'create')) && wizardData.type !== 'MEDEDELINGEN' && \"Pas de titel en ondertitel aan\"}\n            {((currentStep === 2 && mode === 'edit') || (currentStep === 3 && mode === 'create')) && wizardData.type === 'MEDEDELINGEN' && \"Stel de carrousel instellingen in\"}\n            {((currentStep === 2 && mode === 'edit') || (currentStep === 3 && mode === 'create')) && wizardData.type !== 'MEDEDELINGEN' && \"Configureer de specifieke instellingen\"}\n          </DialogDescription>\n          \n          {/* Progress indicator */}\n          <div className=\"flex items-center gap-4 mt-4\">\n            <div className=\"flex items-center gap-2\">\n              {steps.map((step, index) => (\n                <div key={index} className=\"flex items-center\">\n                  <div className={`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium transition-colors ${\n                    index < currentStep ? 'bg-primary text-primary-foreground' :\n                    index === currentStep ? 'bg-primary text-primary-foreground' :\n                    'bg-muted text-muted-foreground'\n                  }`}>\n                    {index + 1}\n                  </div>\n                  {index < steps.length - 1 && (\n                    <div className={`w-12 h-px mx-2 transition-colors ${\n                      index < currentStep ? 'bg-primary' : 'bg-muted'\n                    }`} />\n                  )}\n                </div>\n              ))}\n            </div>\n            <Badge variant=\"outline\" className=\"ml-auto\">\n              Stap {currentStep + 1} van {steps.length}\n            </Badge>\n          </div>\n        </DialogHeader>\n\n        {/* Main content area with fixed height */}\n        <div className=\"flex-1 py-6 overflow-y-auto\">\n          {StepComponent && (\n            <StepComponent\n              data={wizardData}\n              onUpdate={setWizardData}\n            />\n          )}\n        </div>\n\n        {/* Fixed footer */}\n        <div className=\"flex-shrink-0 flex justify-between items-center pt-6 border-t border-border\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentStep(prev => prev - 1)}\n            disabled={mode === 'edit' ? currentStep === 0 : currentStep === 0}\n            data-testid=\"wizard-back\"\n            size=\"lg\"\n          >\n            <ChevronLeft className=\"w-4 h-4 mr-2\" />\n            Vorige\n          </Button>\n\n          <div className=\"flex items-center gap-3\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => onOpenChange(false)}\n              data-testid=\"wizard-cancel\"\n            >\n              Annuleren\n            </Button>\n            \n            <Button\n              onClick={handleNext}\n              disabled={!canGoNext()}\n              data-testid=\"wizard-next\"\n              size=\"lg\"\n            >\n              {isLastStep ? 'Scherm Aanmaken' : 'Volgende'}\n              {!isLastStep && <ChevronRight className=\"w-4 h-4 ml-2\" />}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":13439},"client/src/components/public-screens/wizard/steps/DescriptionStep.tsx":{"content":"\"use client\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\ninterface DescriptionStepProps {\n  data: { name: string; description?: string };\n  onUpdate: (data: any) => void;\n}\n\nexport function DescriptionStep({ data, onUpdate }: DescriptionStepProps) {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Naam en beschrijving</h3>\n        <p className=\"text-sm text-gray-600\">\n          Geef het scherm een naam en optioneel een beschrijving voor intern gebruik\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        <div>\n          <Label htmlFor=\"screen-name\">Naam van het scherm *</Label>\n          <Input\n            id=\"screen-name\"\n            value={data.name}\n            onChange={(e) => onUpdate({ ...data, name: e.target.value })}\n            placeholder=\"Bijvoorbeeld: Ledenlijst hoofdgebouw\"\n            data-testid=\"input-screen-name\"\n          />\n        </div>\n\n        <div>\n          <Label htmlFor=\"screen-description\">Beschrijving (optioneel)</Label>\n          <Textarea\n            id=\"screen-description\"\n            value={data.description || \"\"}\n            onChange={(e) => onUpdate({ ...data, description: e.target.value })}\n            placeholder=\"Interne beschrijving van dit scherm (wordt niet getoond aan het publiek)\"\n            rows={3}\n            data-testid=\"input-screen-description\"\n          />\n          <p className=\"text-xs text-gray-500 mt-1\">\n            Deze beschrijving is alleen zichtbaar voor beheerders\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":1683},"client/src/components/public-screens/wizard/steps/LedenlijstConfigStep.tsx":{"content":"\"use client\";\n\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\n\ninterface LedenlijstConfigStepProps {\n  data: {\n    ledenlijstSettings?: {\n      useFullNames: boolean;\n      useInitials: boolean;\n      filterByCategories: boolean;\n      showVotingRights: boolean;\n      rowsPerPage: number;\n      secondsPerPage: number;\n      year: number;\n      categories: string[];\n    };\n  };\n  onUpdate: (data: any) => void;\n}\n\nconst availableCategories = ['Student', 'Standaard', 'Senior', 'Stemgerechtigd', 'Mannen', 'Vrouwen'];\n\nexport function LedenlijstConfigStep({ data, onUpdate }: LedenlijstConfigStepProps) {\n  const settings = data.ledenlijstSettings || {\n    useFullNames: true,\n    useInitials: false,\n    filterByCategories: true,\n    showVotingRights: false,\n    rowsPerPage: 20,\n    secondsPerPage: 15,\n    year: new Date().getFullYear(),\n    categories: [\"Student\", \"Standaard\"]\n  };\n\n  const updateSettings = (field: string, value: any) => {\n    const newSettings = { ...settings, [field]: value };\n    onUpdate({\n      ...data,\n      ledenlijstSettings: newSettings\n    });\n  };\n\n  const toggleCategory = (category: string) => {\n    const newCategories = settings.categories.includes(category)\n      ? settings.categories.filter(c => c !== category)\n      : [...settings.categories, category];\n    updateSettings('categories', newCategories);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Ledenlijst configuratie</h3>\n        <p className=\"text-sm text-gray-600\">\n          Stel in hoe de ledenlijst wordt weergegeven\n        </p>\n      </div>\n\n      {/* Weergave opties */}\n      <div className=\"space-y-4 p-4 border rounded-lg\">\n        <h4 className=\"font-medium\">Weergave opties</h4>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <Label>Naam weergave</Label>\n            <div className=\"mt-2 space-y-2\">\n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"radio\"\n                  id=\"full-names\"\n                  name=\"name-display\"\n                  checked={settings.useFullNames && !settings.useInitials}\n                  onChange={() => {\n                    updateSettings('useFullNames', true);\n                    updateSettings('useInitials', false);\n                  }}\n                  data-testid=\"radio-full-names\"\n                />\n                <Label htmlFor=\"full-names\">Volledige namen (bijv. Ahmed Hassan)</Label>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"radio\"\n                  id=\"initials-only\"\n                  name=\"name-display\"\n                  checked={!settings.useFullNames && settings.useInitials}\n                  onChange={() => {\n                    updateSettings('useFullNames', false);\n                    updateSettings('useInitials', true);\n                  }}\n                  data-testid=\"radio-initials-only\"\n                />\n                <Label htmlFor=\"initials-only\">Alleen initialen (bijv. A.H.)</Label>\n              </div>\n              \n              <div className=\"flex items-center space-x-2\">\n                <input\n                  type=\"radio\"\n                  id=\"short-names\"\n                  name=\"name-display\"\n                  checked={!settings.useFullNames && !settings.useInitials}\n                  onChange={() => {\n                    updateSettings('useFullNames', false);\n                    updateSettings('useInitials', false);\n                  }}\n                  data-testid=\"radio-short-names\"\n                />\n                <Label htmlFor=\"short-names\">Korte namen - alleen voornaam (bijv. Ahmed)</Label>\n              </div>\n            </div>\n          </div>\n\n          \n        </div>\n      </div>\n\n      {/* Filter */}\n      <div className=\"space-y-4 p-4 border rounded-lg\">\n        <h4 className=\"font-medium\">Filter</h4>\n        \n        <div>\n          <Label>Welke categorieën wil je tonen?</Label>\n          <div className=\"mt-2 space-y-2\">\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-alle\"\n                checked={settings.categories.length === 6}\n                onCheckedChange={() => {\n                  if (settings.categories.length === 6) {\n                    updateSettings('categories', []);\n                  } else {\n                    updateSettings('categories', ['Student', 'Standaard', 'Senior', 'Stemgerechtigd', 'Mannen', 'Vrouwen']);\n                  }\n                }}\n                data-testid=\"checkbox-category-alle\"\n              />\n              <Label htmlFor=\"category-alle\" className=\"font-medium\">Alle</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-student\"\n                checked={settings.categories.includes('Student')}\n                onCheckedChange={() => toggleCategory('Student')}\n                data-testid=\"checkbox-category-student\"\n              />\n              <Label htmlFor=\"category-student\">Student</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-standaard\"\n                checked={settings.categories.includes('Standaard')}\n                onCheckedChange={() => toggleCategory('Standaard')}\n                data-testid=\"checkbox-category-standaard\"\n              />\n              <Label htmlFor=\"category-standaard\">Standaard</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-senior\"\n                checked={settings.categories.includes('Senior')}\n                onCheckedChange={() => toggleCategory('Senior')}\n                data-testid=\"checkbox-category-senior\"\n              />\n              <Label htmlFor=\"category-senior\">Senior</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-stemgerechtigd\"\n                checked={settings.categories.includes('Stemgerechtigd')}\n                onCheckedChange={() => toggleCategory('Stemgerechtigd')}\n                data-testid=\"checkbox-category-stemgerechtigd\"\n              />\n              <Label htmlFor=\"category-stemgerechtigd\">Stemgerechtigd</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-mannen\"\n                checked={settings.categories.includes('Mannen')}\n                onCheckedChange={() => toggleCategory('Mannen')}\n                data-testid=\"checkbox-category-mannen\"\n              />\n              <Label htmlFor=\"category-mannen\">Mannen</Label>\n            </div>\n            \n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"category-vrouwen\"\n                checked={settings.categories.includes('Vrouwen')}\n                onCheckedChange={() => toggleCategory('Vrouwen')}\n                data-testid=\"checkbox-category-vrouwen\"\n              />\n              <Label htmlFor=\"category-vrouwen\">Vrouwen</Label>\n            </div>\n          </div>\n          <p className=\"text-xs text-gray-500 mt-2\">\n            Selecteer de categorieën die je wilt tonen in de ledenlijst\n          </p>\n        </div>\n      </div>\n\n\n      {/* Paginering */}\n      <div className=\"space-y-4 p-4 border rounded-lg\">\n        <h4 className=\"font-medium\">Paginering</h4>\n        \n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <Label htmlFor=\"rows-per-page\">Rijen per pagina</Label>\n            <Select\n              value={settings.rowsPerPage.toString()}\n              onValueChange={(value) => updateSettings('rowsPerPage', parseInt(value))}\n            >\n              <SelectTrigger data-testid=\"select-rows-per-page\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"10\">10</SelectItem>\n                <SelectItem value=\"20\">20</SelectItem>\n                <SelectItem value=\"30\">30</SelectItem>\n                <SelectItem value=\"50\">50</SelectItem>\n                <SelectItem value=\"100\">100</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          \n          <div>\n            <Label htmlFor=\"seconds-per-page\">Seconden per pagina</Label>\n            <Select\n              value={(settings.secondsPerPage || 15).toString()}\n              onValueChange={(value) => updateSettings('secondsPerPage', parseInt(value))}\n            >\n              <SelectTrigger data-testid=\"select-seconds-per-page\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"5\">5 seconden</SelectItem>\n                <SelectItem value=\"10\">10 seconden</SelectItem>\n                <SelectItem value=\"15\">15 seconden</SelectItem>\n                <SelectItem value=\"20\">20 seconden</SelectItem>\n                <SelectItem value=\"30\">30 seconden</SelectItem>\n                <SelectItem value=\"60\">1 minuut</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n      </div>\n\n      {/* Jaar */}\n      <div className=\"space-y-4 p-4 border rounded-lg\">\n        <h4 className=\"font-medium\">Jaar</h4>\n        <div>\n          <Label htmlFor=\"year\">Betaalstatus jaar</Label>\n          <Input\n            id=\"year\"\n            type=\"number\"\n            value={settings.year}\n            onChange={(e) => updateSettings('year', parseInt(e.target.value))}\n            min=\"2020\"\n            max=\"2030\"\n            data-testid=\"input-year\"\n          />\n        </div>\n      </div>\n\n      \n    </div>\n  );\n}","size_bytes":10168},"client/src/components/public-screens/wizard/steps/StylingStep.tsx":{"content":"\"use client\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { ColorPicker } from \"@/components/ui/color-wheel\";\nimport { TitleStyling } from \"@/lib/mock/public-screens\";\n\ninterface StylingStepProps {\n  data: {\n    title: TitleStyling;\n    subtitle: TitleStyling;\n  };\n  onUpdate: (data: any) => void;\n}\n\nconst fontFamilies = [\n  { value: \"Poppins\", label: \"Poppins\" },\n  { value: \"Inter\", label: \"Inter\" },\n  { value: \"Roboto\", label: \"Roboto\" },\n  { value: \"Open Sans\", label: \"Open Sans\" },\n  { value: \"Lato\", label: \"Lato\" },\n  { value: \"Montserrat\", label: \"Montserrat\" },\n  { value: \"Source Sans Pro\", label: \"Source Sans Pro\" },\n  { value: \"Nunito\", label: \"Nunito\" },\n  { value: \"PT Sans\", label: \"PT Sans\" },\n  { value: \"Ubuntu\", label: \"Ubuntu\" },\n  { value: \"Raleway\", label: \"Raleway\" },\n  { value: \"Merriweather\", label: \"Merriweather\" },\n  { value: \"Oswald\", label: \"Oswald\" },\n  { value: \"Playfair Display\", label: \"Playfair Display\" },\n  { value: \"Arial\", label: \"Arial\" },\n  { value: \"Helvetica\", label: \"Helvetica\" },\n  { value: \"Times New Roman\", label: \"Times New Roman\" },\n  { value: \"Georgia\", label: \"Georgia\" },\n  { value: \"Verdana\", label: \"Verdana\" },\n  { value: \"Trebuchet MS\", label: \"Trebuchet MS\" }\n];\n\nconst fontWeights = [\n  { value: \"normal\", label: \"Normaal\" },\n  { value: \"bold\", label: \"Vet\" }\n];\n\nconst colors = [\n  { value: \"#000000\", label: \"Zwart\" },\n  { value: \"#1f2937\", label: \"Donkergrijs\" },\n  { value: \"#374151\", label: \"Grijs\" },\n  { value: \"#6b7280\", label: \"Lichtgrijs\" },\n  { value: \"#9ca3af\", label: \"Zilvergijs\" },\n  { value: \"#ffffff\", label: \"Wit\" },\n  { value: \"#2563eb\", label: \"Blauw\" },\n  { value: \"#1d4ed8\", label: \"Donkerblauw\" },\n  { value: \"#3b82f6\", label: \"Lichtblauw\" },\n  { value: \"#06b6d4\", label: \"Cyaan\" },\n  { value: \"#0891b2\", label: \"Teal\" },\n  { value: \"#059669\", label: \"Groen\" },\n  { value: \"#16a34a\", label: \"Lichtgroen\" },\n  { value: \"#65a30d\", label: \"Lime\" },\n  { value: \"#eab308\", label: \"Geel\" },\n  { value: \"#f59e0b\", label: \"Amber\" },\n  { value: \"#ea580c\", label: \"Oranje\" },\n  { value: \"#dc2626\", label: \"Rood\" },\n  { value: \"#e11d48\", label: \"Rose\" },\n  { value: \"#c2410c\", label: \"Donkeroranje\" },\n  { value: \"#7c3aed\", label: \"Paars\" },\n  { value: \"#a855f7\", label: \"Violet\" },\n  { value: \"#d946ef\", label: \"Fuchsia\" },\n  { value: \"#ec4899\", label: \"Roze\" },\n  { value: \"#be185d\", label: \"Donkerroze\" },\n  { value: \"#92400e\", label: \"Bruin\" },\n  { value: \"#451a03\", label: \"Donkerbruin\" }\n];\n\nconst defaultTitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 32,\n  fontFamily: \"Poppins\",\n  color: \"#1f2937\",\n  fontWeight: \"bold\"\n};\n\nconst defaultSubtitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 18,\n  fontFamily: \"Poppins\", \n  color: \"#6b7280\",\n  fontWeight: \"normal\"\n};\n\nexport function StylingStep({ data, onUpdate }: StylingStepProps) {\n  // Ensure title and subtitle exist with defaults\n  const safeTitle = data.title || defaultTitleStyling;\n  const safeSubtitle = data.subtitle || defaultSubtitleStyling;\n\n  const updateTitle = (field: keyof TitleStyling, value: any) => {\n    onUpdate({\n      ...data,\n      title: { ...safeTitle, [field]: value }\n    });\n  };\n\n  const updateSubtitle = (field: keyof TitleStyling, value: any) => {\n    onUpdate({\n      ...data,\n      subtitle: { ...safeSubtitle, [field]: value }\n    });\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n      {/* Configuratie */}\n      <div className=\"space-y-6\">\n        <div>\n          <h3 className=\"text-lg font-medium mb-2\">Titel en ondertitel instellen</h3>\n          <p className=\"text-sm text-gray-600\">\n            Configureer de opmaak van de titel en ondertitel\n          </p>\n        </div>\n\n        {/* Titel configuratie */}\n        <div className=\"space-y-4 p-4 border rounded-lg\">\n          <h4 className=\"font-medium\">Titel</h4>\n          \n          <div>\n            <Label htmlFor=\"title-text\">Tekst *</Label>\n            <Input\n              id=\"title-text\"\n              value={safeTitle.text}\n              onChange={(e) => updateTitle('text', e.target.value)}\n              placeholder=\"Titel van het scherm\"\n              data-testid=\"input-title-text\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label htmlFor=\"title-fontsize\">Lettergrootte</Label>\n              <Input\n                id=\"title-fontsize\"\n                type=\"number\"\n                value={safeTitle.fontSize}\n                onChange={(e) => updateTitle('fontSize', parseInt(e.target.value))}\n                min=\"12\"\n                max=\"72\"\n                data-testid=\"input-title-fontsize\"\n              />\n            </div>\n            \n            <div>\n              <Label htmlFor=\"title-fontweight\">Gewicht</Label>\n              <Select value={safeTitle.fontWeight} onValueChange={(value) => updateTitle('fontWeight', value)}>\n                <SelectTrigger data-testid=\"select-title-fontweight\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {fontWeights.map(weight => (\n                    <SelectItem key={weight.value} value={weight.value}>\n                      {weight.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label htmlFor=\"title-fontfamily\">Lettertype</Label>\n              <Select value={safeTitle.fontFamily} onValueChange={(value) => updateTitle('fontFamily', value)}>\n                <SelectTrigger data-testid=\"select-title-fontfamily\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {fontFamilies.map(font => (\n                    <SelectItem key={font.value} value={font.value}>\n                      {font.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"title-color\">Kleur</Label>\n              <ColorPicker\n                value={safeTitle.color}\n                onChange={(color) => updateTitle('color', color)}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Ondertitel configuratie */}\n        <div className=\"space-y-4 p-4 border rounded-lg\">\n          <h4 className=\"font-medium\">Ondertitel</h4>\n          \n          <div>\n            <Label htmlFor=\"subtitle-text\">Tekst</Label>\n            <Input\n              id=\"subtitle-text\"\n              value={safeSubtitle.text}\n              onChange={(e) => updateSubtitle('text', e.target.value)}\n              placeholder=\"Ondertitel (optioneel)\"\n              data-testid=\"input-subtitle-text\"\n            />\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label htmlFor=\"subtitle-fontsize\">Lettergrootte</Label>\n              <Input\n                id=\"subtitle-fontsize\"\n                type=\"number\"\n                value={safeSubtitle.fontSize}\n                onChange={(e) => updateSubtitle('fontSize', parseInt(e.target.value))}\n                min=\"12\"\n                max=\"48\"\n                data-testid=\"input-subtitle-fontsize\"\n              />\n            </div>\n            \n            <div>\n              <Label htmlFor=\"subtitle-fontweight\">Gewicht</Label>\n              <Select value={safeSubtitle.fontWeight} onValueChange={(value) => updateSubtitle('fontWeight', value)}>\n                <SelectTrigger data-testid=\"select-subtitle-fontweight\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {fontWeights.map(weight => (\n                    <SelectItem key={weight.value} value={weight.value}>\n                      {weight.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label htmlFor=\"subtitle-fontfamily\">Lettertype</Label>\n              <Select value={safeSubtitle.fontFamily} onValueChange={(value) => updateSubtitle('fontFamily', value)}>\n                <SelectTrigger data-testid=\"select-subtitle-fontfamily\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {fontFamilies.map(font => (\n                    <SelectItem key={font.value} value={font.value}>\n                      {font.label}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label htmlFor=\"subtitle-color\">Kleur</Label>\n              <ColorPicker\n                value={safeSubtitle.color}\n                onChange={(color) => updateSubtitle('color', color)}\n              />\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Live Preview */}\n      <div className=\"space-y-4\">\n        <div>\n          <h3 className=\"text-lg font-medium mb-2\">Live preview</h3>\n          <p className=\"text-sm text-gray-600\">\n            Bekijk hoe de titel en ondertitel eruit zien\n          </p>\n        </div>\n\n        <div className=\"p-6 border rounded-lg bg-white min-h-[300px] flex flex-col justify-center items-center space-y-4\">\n          {safeTitle.text && (\n            <h1\n              style={{\n                fontSize: `${safeTitle.fontSize}px`,\n                fontFamily: safeTitle.fontFamily,\n                color: safeTitle.color,\n                fontWeight: safeTitle.fontWeight,\n                textAlign: 'center',\n                margin: 0\n              }}\n              data-testid=\"preview-title\"\n            >\n              {safeTitle.text}\n            </h1>\n          )}\n          \n          {safeSubtitle.text && (\n            <h2\n              style={{\n                fontSize: `${safeSubtitle.fontSize}px`,\n                fontFamily: safeSubtitle.fontFamily,\n                color: safeSubtitle.color,\n                fontWeight: safeSubtitle.fontWeight,\n                textAlign: 'center',\n                margin: 0\n              }}\n              data-testid=\"preview-subtitle\"\n            >\n              {safeSubtitle.text}\n            </h2>\n          )}\n\n          {!safeTitle.text && (\n            <p className=\"text-gray-400 text-center\">\n              Voer een titel in om de preview te zien\n            </p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":10830},"client/src/components/public-screens/wizard/steps/TypeSelectionStep.tsx":{"content":"\"use client\";\n\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { ScreenType } from \"@/lib/mock/public-screens\";\nimport { Users, MessageSquare } from \"lucide-react\";\n\ninterface TypeSelectionStepProps {\n  data: { type?: ScreenType };\n  onUpdate: (data: any) => void;\n}\n\nconst screenTypes = [\n  {\n    value: 'LEDENLIJST' as ScreenType,\n    label: 'Ledenlijst',\n    description: 'Toon leden met betaalstatus per maand',\n    icon: Users\n  },\n  {\n    value: 'MEDEDELINGEN' as ScreenType,\n    label: 'Mededelingen',\n    description: 'Carousel met tekstuele aankondigingen',\n    icon: MessageSquare\n  }\n];\n\nexport function TypeSelectionStep({ data, onUpdate }: TypeSelectionStepProps) {\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Kies het type publiek scherm</h3>\n        <p className=\"text-sm text-gray-600\">\n          Selecteer welk type scherm je wilt aanmaken\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-4\">\n        {screenTypes.map((type) => {\n          const Icon = type.icon;\n          const isSelected = data.type === type.value;\n          \n          return (\n            <div\n              key={type.value}\n              className={`p-4 border rounded-lg cursor-pointer transition-all ${\n                isSelected\n                  ? 'border-primary bg-primary/5 ring-2 ring-primary/20'\n                  : 'border-gray-200 hover:border-gray-300'\n              }`}\n              onClick={() => {\n                const baseUpdate = { ...data, type: type.value };\n                \n                // Initialize settings based on type\n                if (type.value === 'MEDEDELINGEN') {\n                  onUpdate({\n                    ...baseUpdate,\n                    mededelingenSettings: {\n                      slides: [{\n                        id: 'slide1',\n                        title: 'Eerste bericht',\n                        body: '',\n                        active: true,\n                        durationSec: 10,\n                        styling: {\n                          titleFontSize: 32,\n                          titleFontWeight: 'bold',\n                          titleFontFamily: 'Poppins',\n                          titleColor: '#1f2937',\n                          bodyFontSize: 18,\n                          bodyFontWeight: 'normal',\n                          bodyFontFamily: 'Poppins',\n                          bodyColor: '#374151',\n                          backgroundColor: '#ffffff'\n                        }\n                      }],\n                      autoplay: {\n                        enabled: true,\n                        interval: 8,\n                        order: 'manual'\n                      },\n                      style: {\n                        textColor: '#ffffff',\n                        backgroundColor: '#1f2937',\n                        maxTextWidth: 800\n                      }\n                    }\n                  });\n                } else {\n                  onUpdate(baseUpdate);\n                }\n              }}\n              data-testid={`screen-type-${type.value.toLowerCase()}`}\n            >\n              <div className=\"flex flex-col items-center text-center space-y-3\">\n                <div className={`p-3 rounded-full ${\n                  isSelected ? 'bg-primary text-white' : 'bg-gray-100 text-gray-600'\n                }`}>\n                  <Icon className=\"w-6 h-6\" />\n                </div>\n                <div>\n                  <h4 className=\"font-medium\">{type.label}</h4>\n                  <p className=\"text-sm text-gray-500 mt-1\">{type.description}</p>\n                </div>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n\n      {data.type && (\n        <div className=\"mt-6 p-4 bg-blue-50 rounded-lg\">\n          <h4 className=\"font-medium text-blue-900\">\n            {screenTypes.find(t => t.value === data.type)?.label} geselecteerd\n          </h4>\n          <p className=\"text-sm text-blue-700 mt-1\">\n            {screenTypes.find(t => t.value === data.type)?.description}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":4201},"client/src/components/public-view/LedenlijstView.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect, useMemo } from \"react\";\nimport { LedenlijstConfig } from \"@/lib/mock/public-screens\";\nimport { monthNames, getFilteredMembers, getMemberDisplayName, Member } from \"@/lib/mock/members-data\";\nimport { Check, X, Vote } from \"lucide-react\";\nimport backgroundImage from \"@assets/ramadan_15_03_2022_1_1756811846212.jpg\";\n\ninterface LedenlijstViewProps {\n  config: LedenlijstConfig;\n  members?: any[]; // Real member data from API\n}\n\nexport function LedenlijstView({ config, members = [] }: LedenlijstViewProps) {\n  \n  const [currentPage, setCurrentPage] = useState(0);\n\n  const convertedMembers = useMemo(() => {\n    return members.map((member: any) => {\n      // Map database categories to display categories\n      let displayCategory = member.category;\n      if (member.category === 'STUDENT') displayCategory = 'Student';\n      else if (member.category === 'SENIOR') displayCategory = 'Senior';  \n      else if (member.category === 'STANDAARD') displayCategory = 'Standaard';\n      \n      // Calculate payment status by month for current year\n      const currentYear = new Date().getFullYear();\n      const betalingenByMonth: { [key: number]: 'betaald' | 'open' | 'vervallen' } = {};\n      \n      // Process membership fees if available\n      if (member.membershipFees) {\n        member.membershipFees.forEach((fee: any) => {\n          const feeDate = new Date(fee.periodStart);\n          if (feeDate.getFullYear() === currentYear) {\n            const month = feeDate.getMonth() + 1; // Convert to 1-12\n            \n            // Determine status based on fee status and dates\n            if (fee.status === 'PAID') {\n              betalingenByMonth[month] = 'betaald';\n            } else if (fee.status === 'OVERDUE') {\n              betalingenByMonth[month] = 'vervallen';\n            } else {\n              betalingenByMonth[month] = 'open';\n            }\n          }\n        });\n      }\n      \n      return {\n        id: member.id,\n        lidnummer: member.memberNumber,\n        voornaam: member.firstName,\n        achternaam: member.lastName,\n        initialen: member.firstName.charAt(0) + member.lastName.charAt(0),\n        categorie: displayCategory,\n        actief: member.active,\n        stemrecht: member.votingRights,\n        betaalstatus: [], \n        betalingen: {\n          [currentYear]: betalingenByMonth\n        }\n      };\n    });\n  }, [members]);\n  \n  const filteredMembers = useMemo(() => {\n    \n    const filtered = getFilteredMembers(convertedMembers, {\n      categories: config.categories,\n      useFullNames: config.display.useFullNames,\n      useInitials: config.display.useInitials,\n      filterByCategories: config.display.filterByCategories,\n      showVotingRights: config.display.showVotingRights,\n      actieveLedenOnly: true\n    });\n    \n    return filtered;\n  }, [convertedMembers, config.categories, config.display.filterByCategories, config.display.useFullNames, config.display.useInitials, config.display.showVotingRights]);\n  \n  useEffect(() => {\n    setCurrentPage(0);\n  }, [filteredMembers.length]);\n\n  const totalPages = Math.ceil(filteredMembers.length / config.display.rowsPerPage);\n  const startIndex = currentPage * config.display.rowsPerPage;\n  const endIndex = startIndex + config.display.rowsPerPage;\n  const currentMembers = filteredMembers.slice(startIndex, endIndex);\n  \n  \n\n  // Auto-advance pages\n  useEffect(() => {\n    if (totalPages <= 1) return;\n\n    const secondsPerPage = config.display.secondsPerPage || 15;\n    const interval = setInterval(() => {\n      setCurrentPage(prev => (prev + 1) % totalPages);\n    }, secondsPerPage * 1000); // Gebruik ingestelde seconden per pagina\n\n    return () => clearInterval(interval);\n  }, [totalPages, config.display.secondsPerPage]);\n\n  const getPaymentStatusIcon = (status: 'betaald' | 'open' | 'vervallen') => {\n    switch (status) {\n      case 'betaald':\n        return <Check className=\"w-4 h-4 text-white\" />;\n      case 'vervallen':\n        return <X className=\"w-4 h-4 text-white\" />;\n      default:\n        return null;\n    }\n  };\n\n  const getPaymentStatusColor = (status: 'betaald' | 'open' | 'vervallen') => {\n    switch (status) {\n      case 'betaald':\n        return 'bg-green-500';\n      case 'vervallen':\n        return 'bg-red-500';\n      default:\n        return 'bg-gray-300';\n    }\n  };\n\n  // Category color mapping - consistent with dashboard\n  const getCategoryColor = (category: string) => {\n    switch (category.toLowerCase()) {\n      case 'senior':\n        return '#1E3A8A'; // Dark blue\n      case 'standaard':\n        return '#3B82F6'; // Medium blue  \n      case 'student':\n        return '#06B6D4'; // Light blue/cyan\n      default:\n        return '#6B7280'; // Gray fallback\n    }\n  };\n\n  return (\n    <div \n      className=\"min-h-screen p-8 relative font-sans\"\n      style={{\n        backgroundImage: `linear-gradient(rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.85)), url(\"${backgroundImage}\")`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n        backgroundRepeat: 'no-repeat'\n      }}\n    >\n      {/* Header */}\n      <div className=\"text-center mb-12 relative z-10\">\n        <div className=\"bg-white rounded-2xl p-8 border border-gray-200 shadow-lg\">\n          <h1\n            style={{\n              fontSize: `${config.title.fontSize}px`,\n              fontFamily: config.title.fontFamily,\n              color: config.title.color,\n              fontWeight: config.title.fontWeight,\n              margin: 0\n            }}\n            className=\"text-card-foreground\"\n            data-testid=\"ledenlijst-title\"\n          >\n            {config.title.text}\n          </h1>\n          \n          {config.subtitle.text && (\n            <h2\n              style={{\n                fontSize: `${config.subtitle.fontSize}px`,\n                fontFamily: config.subtitle.fontFamily,\n                color: config.subtitle.color,\n                fontWeight: config.subtitle.fontWeight,\n                margin: '8px 0 0 0'\n              }}\n              className=\"text-muted-foreground\"\n              data-testid=\"ledenlijst-subtitle\"\n            >\n              {config.subtitle.text}\n            </h2>\n          )}\n        </div>\n      </div>\n\n      {/* Tabel */}\n      <div className=\"w-full relative z-10\">\n        <div className=\"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-lg\">\n          <table className=\"w-full\">\n            <thead>\n              <tr className=\"bg-[#e6effd] border-b border-gray-200\">\n                <th className=\"px-6 py-4 text-left font-semibold text-blue-900 text-sm uppercase tracking-wider\">\n                  Lidnr.\n                </th>\n                <th className=\"px-6 py-4 text-left font-semibold text-blue-900 text-sm uppercase tracking-wider\">\n                  Naam\n                </th>\n                {config.display.showVotingRights && (\n                  <th className=\"px-4 py-4 text-center font-semibold text-blue-900 text-sm uppercase tracking-wider\">\n                    Stemrecht\n                  </th>\n                )}\n                {monthNames.map((month, index) => (\n                  <th\n                    key={month}\n                    className=\"px-3 py-4 text-center font-semibold text-blue-900 text-sm uppercase tracking-wider min-w-[60px]\"\n                  >\n                    {month}\n                  </th>\n                ))}\n              </tr>\n            </thead>\n            <tbody>\n              {currentMembers.map((member, memberIndex) => (\n                <tr key={member.id} className=\"hover:bg-gray-50 border-b border-gray-100 last:border-0 transition-all duration-200\">\n                  <td className=\"px-6 py-4 font-mono text-sm text-slate-600 font-medium\">\n                    {member.lidnummer}\n                  </td>\n                  <td className=\"px-6 py-4 text-blue-900 font-semibold text-base\">\n                    {getMemberDisplayName(member, {\n                      useFullNames: config.display.useFullNames,\n                      useInitials: config.display.useInitials\n                    })}\n                  </td>\n                  {config.display.showVotingRights && (\n                    <td className=\"px-4 py-4 text-center\">\n                      {member.stemrecht && (\n                        <Vote className=\"w-5 h-5 text-primary mx-auto\" />\n                      )}\n                    </td>\n                  )}\n                  {monthNames.map((month, monthIndex) => {\n                    const monthNumber = monthIndex + 1;\n                    const status = member.betalingen?.[config.year]?.[monthNumber] || 'open';\n                    \n                    return (\n                      <td\n                        key={month}\n                        className=\"px-3 py-4 text-center\"\n                      >\n                        <div\n                          className={`w-10 h-10 rounded-full mx-auto border transition-all duration-300 ${\n                            status === 'betaald' ? 'bg-emerald-500 border-emerald-400 shadow-emerald-200' :\n                            status === 'vervallen' ? 'bg-red-500 border-red-400 shadow-red-200' :\n                            'bg-gray-400 border-gray-300 shadow-gray-200'\n                          }`}\n                          style={{\n                            boxShadow: status === 'betaald' ? '0 4px 12px rgba(16, 185, 129, 0.25)' :\n                                     status === 'vervallen' ? '0 4px 12px rgba(239, 68, 68, 0.25)' :\n                                     '0 2px 8px rgba(156, 163, 175, 0.2)'\n                          }}\n                          title={`${month}: ${status === 'betaald' ? 'Betaald' : status === 'vervallen' ? 'Vervallen' : 'Open'}`}\n                        >\n                        </div>\n                      </td>\n                    );\n                  })}\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n\n        {/* Paginering info - subtiel rechtsbeneden */}\n        {totalPages > 1 && (\n          <div className=\"mt-4 flex justify-end relative z-10\">\n            <p className=\"text-gray-500 text-sm\">\n              {filteredMembers.length} leden weergegeven\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":10315},"client/src/lib/mock/members-data.ts":{"content":"import { generateId } from \"./utils\";\n\nexport interface Member {\n  id: string;\n  lidnummer: number;\n  voornaam: string;\n  achternaam: string;\n  initialen: string;\n  categorie: 'Standaard' | 'Student' | 'Kind' | 'Senior' | 'Gezin';\n  stemrecht: boolean;\n  actief: boolean;\n  betalingen: {\n    [year: number]: {\n      [month: number]: 'betaald' | 'open' | 'vervallen';\n    };\n  };\n}\n\n// Mock leden data\nexport const mockMembers: Member[] = [\n  {\n    id: generateId(),\n    lidnummer: 1001,\n    voornaam: \"Ahmed\",\n    achternaam: \"Hassan\",\n    initialen: \"A.H.\",\n    categorie: \"Standaard\",\n    stemrecht: true,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'betaald', 4: 'open', 5: 'open',\n        6: 'open', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1002,\n    voornaam: \"Fatima\",\n    achternaam: \"Al-Zahra\",\n    initialen: \"F.A.\",\n    categorie: \"Standaard\",\n    stemrecht: true,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'open', 4: 'vervallen', 5: 'vervallen',\n        6: 'open', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1003,\n    voornaam: \"Omar\",\n    achternaam: \"Abdallah\",\n    initialen: \"O.A.\",\n    categorie: \"Student\",\n    stemrecht: false,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'betaald', 4: 'betaald', 5: 'open',\n        6: 'open', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1004,\n    voornaam: \"Aisha\",\n    achternaam: \"Rahman\",\n    initialen: \"A.R.\",\n    categorie: \"Standaard\",\n    stemrecht: true,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'betaald', 4: 'betaald', 5: 'betaald',\n        6: 'betaald', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1005,\n    voornaam: \"Yusuf\",\n    achternaam: \"Al-Mansouri\",\n    initialen: \"Y.A.\",\n    categorie: \"Student\",\n    stemrecht: false,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'open', 3: 'vervallen', 4: 'vervallen', 5: 'vervallen',\n        6: 'open', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1006,\n    voornaam: \"Khadija\",\n    achternaam: \"Benali\",\n    initialen: \"K.B.\",\n    categorie: \"Standaard\",\n    stemrecht: true,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'betaald', 4: 'betaald', 5: 'betaald',\n        6: 'betaald', 7: 'betaald', 8: 'betaald', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1007,\n    voornaam: \"Mustafa\",\n    achternaam: \"El-Khoury\",\n    initialen: \"M.E.\",\n    categorie: \"Senior\",\n    stemrecht: true,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'betaald', 4: 'betaald', 5: 'betaald',\n        6: 'betaald', 7: 'betaald', 8: 'betaald', 9: 'betaald', 10: 'betaald', 11: 'open', 12: 'open'\n      }\n    }\n  },\n  {\n    id: generateId(),\n    lidnummer: 1008,\n    voornaam: \"Layla\",\n    achternaam: \"Habib\",\n    initialen: \"L.H.\",\n    categorie: \"Kind\",\n    stemrecht: false,\n    actief: true,\n    betalingen: {\n      2025: {\n        1: 'betaald', 2: 'betaald', 3: 'open', 4: 'open', 5: 'open',\n        6: 'open', 7: 'open', 8: 'open', 9: 'open', 10: 'open', 11: 'open', 12: 'open'\n      }\n    }\n  }\n];\n\nexport const monthNames = [\n  \"Jan\", \"Feb\", \"Mrt\", \"Apr\", \"Mei\", \"Jun\",\n  \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"\n];\n\nexport function getFilteredMembers(\n  members: Member[],\n  config: {\n    categories: string[];\n    useFullNames: boolean;\n    useInitials: boolean;\n    filterByCategories: boolean;\n    showVotingRights: boolean;\n    actieveLedenOnly?: boolean;\n  }\n): Member[] {\n  \n  let filtered = [...members];\n\n  if (config.actieveLedenOnly) {\n    filtered = filtered.filter(member => member.actief);\n  }\n\n  if (config.filterByCategories && config.categories.length > 0) {\n    filtered = filtered.filter(member => config.categories.includes(member.categorie));\n  }\n\n  // Sort chronologically by member number (lidnummer)\n  return filtered.sort((a, b) => {\n    const numA = parseInt(a.lidnummer.toString());\n    const numB = parseInt(b.lidnummer.toString());\n    return numA - numB;\n  });\n}\n\nexport function getMemberDisplayName(member: Member, config: { useFullNames: boolean; useInitials: boolean }): string {\n  if (config.useFullNames) {\n    const fullName = `${member.voornaam} ${member.achternaam}`;\n    return config.useInitials ? `${fullName} (${member.initialen})` : fullName;\n  }\n  return config.useInitials ? member.initialen : `${member.voornaam} ${member.achternaam.charAt(0)}.`;\n}","size_bytes":4975},"client/src/pages/PublicViewPage.tsx":{"content":"\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useParams } from \"wouter\";\nimport { LedenlijstView } from \"@/components/public-view/LedenlijstView\";\nimport { MededelingenView } from \"@/components/public-view/MededelingenView\";\nimport { MultimediaView } from \"@/components/public-view/MultimediaView\";\n\nexport function PublicViewPage() {\n  const { screenId } = useParams();\n  const [screen, setScreen] = useState<any>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    // Load screen data - treating screenId as publicToken\n    const loadScreen = async () => {\n      try {\n        const response = await fetch(`/api/public-screens/token/${screenId}`);\n        if (response.ok) {\n          const foundScreen = await response.json();\n          setScreen(foundScreen);\n        } else {\n          setScreen(null);\n        }\n      } catch (error) {\n        console.error('Error loading screen:', error);\n        setScreen(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (screenId) {\n      loadScreen();\n\n      // Auto-refresh every 5 minutes (300,000ms)\n      const refreshInterval = setInterval(loadScreen, 300000);\n\n      return () => clearInterval(refreshInterval);\n    }\n  }, [screenId]);\n\n  // Show loading state\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Scherm laden...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Show error if screen not found\n  if (!screen) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">Scherm niet gevonden</h1>\n          <p className=\"text-gray-600\">Het opgevraagde scherm bestaat niet of is niet actief.</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Render based on screen type\n  const renderScreen = () => {\n    switch (screen.type) {\n      case 'LEDENLIJST':\n        const defaultConfig = {\n          description: screen.name,\n          title: screen.config?.title || { \n            text: screen.name, \n            fontSize: 36, \n            fontFamily: 'Poppins', \n            color: '#1f2937', \n            fontWeight: 'bold' \n          },\n          subtitle: screen.config?.subtitle || { \n            text: '', \n            fontSize: 24, \n            fontFamily: 'Poppins', \n            color: '#6b7280', \n            fontWeight: 'normal' \n          },\n          display: {\n            useFullNames: screen.config?.ledenlijstSettings?.useFullNames ?? true,\n            useInitials: screen.config?.ledenlijstSettings?.useInitials ?? false,\n            filterByCategories: screen.config?.ledenlijstSettings?.filterByCategories ?? true,\n            showVotingRights: screen.config?.ledenlijstSettings?.showVotingRights ?? false,\n            rowsPerPage: screen.config?.ledenlijstSettings?.rowsPerPage ?? 20,\n          },\n          year: screen.config?.ledenlijstSettings?.year ?? new Date().getFullYear(),\n          categories: screen.config?.ledenlijstSettings?.categories ?? ['Student', 'Standaard']\n        };\n        \n        return (\n          <LedenlijstView \n            config={defaultConfig}\n          />\n        );\n      \n      case 'MEDEDELINGEN':\n        return (\n          <MededelingenView config={screen.config} />\n        );\n      \n      case 'MULTIMEDIA':\n        return (\n          <MultimediaView config={screen.config} />\n        );\n      \n      default:\n        return (\n          <div \n            className=\"min-h-screen bg-background flex items-center justify-center p-8 relative\"\n            style={{\n              backgroundImage: `url(/background.jpg)`,\n              backgroundSize: 'cover',\n              backgroundPosition: 'center',\n              backgroundRepeat: 'no-repeat'\n            }}\n          >\n            {/* Overlay to make background subtle */}\n            <div className=\"absolute inset-0 bg-white/95 backdrop-blur-md\"></div>\n            <div className=\"bg-card rounded-2xl p-8 shadow-sm border border-border text-center max-w-md hover:shadow-md transition-shadow duration-200 relative z-10\">\n              <h1 className=\"text-2xl font-bold text-card-foreground mb-4\">\n                ⚠️ Onbekend Schermtype\n              </h1>\n              <p className=\"text-muted-foreground\">\n                Dit schermtype wordt nog niet ondersteund.\n              </p>\n            </div>\n          </div>\n        );\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen\" data-testid=\"public-view-screen\">\n      {renderScreen()}\n      \n      {/* Auto-refresh indicator */}\n      <div className=\"fixed bottom-4 right-4 bg-black bg-opacity-50 text-white px-3 py-1 rounded text-xs\">\n        Auto-refresh: 5 min\n      </div>\n    </div>\n  );\n}","size_bytes":4992},"client/src/components/public-screens/wizard/steps/MededelingenConfigStep.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Trash2, Plus, Upload, Eye } from \"lucide-react\";\nimport { ColorPicker } from \"@/components/ui/color-wheel\";\nimport { MededelingenSlide } from \"@/lib/mock/public-screens\";\n\ninterface MededelingenSettings {\n  slides: MededelingenSlide[];\n  autoplay: {\n    enabled: boolean;\n    interval: number;\n    order: 'date' | 'manual' | 'shuffle';\n  };\n  style: {\n    textColor: string;\n    backgroundColor: string;\n    maxTextWidth: number;\n  };\n}\n\ninterface MededelingenConfigStepProps {\n  data: {\n    mededelingenSettings?: MededelingenSettings;\n  };\n  onUpdate: (data: any) => void;\n}\n\nexport function MededelingenConfigStep({ data, onUpdate }: MededelingenConfigStepProps) {\n  const [showPreview, setShowPreview] = useState(false);\n  const [currentSlide, setCurrentSlide] = useState(0);\n\n  const settings = data.mededelingenSettings || {\n    slides: [{\n      id: 'slide1',\n      title: 'Eerste bericht',\n      body: '',\n      active: true,\n      durationSec: 10\n    }],\n    autoplay: {\n      enabled: true,\n      interval: 8,\n      order: 'manual'\n    },\n    style: {\n      textColor: '#ffffff',\n      backgroundColor: '#1f2937',\n      maxTextWidth: 800\n    }\n  };\n\n  const updateSettings = (newSettings: Partial<MededelingenSettings>) => {\n    onUpdate({\n      mededelingenSettings: {\n        ...settings,\n        ...newSettings\n      }\n    });\n  };\n\n  const addSlide = () => {\n    const newSlide: MededelingenSlide = {\n      id: `slide${Date.now()}`,\n      title: `Bericht ${settings.slides.length + 1}`,\n      body: '',\n      active: true,\n      durationSec: 10\n    };\n    \n    updateSettings({\n      slides: [...settings.slides, newSlide]\n    });\n  };\n\n  const removeSlide = (slideId: string) => {\n    if (settings.slides.length <= 1) return;\n    \n    updateSettings({\n      slides: settings.slides.filter(s => s.id !== slideId)\n    });\n    \n    if (currentSlide >= settings.slides.length - 1) {\n      setCurrentSlide(Math.max(0, settings.slides.length - 2));\n    }\n  };\n\n  const updateSlide = (slideId: string, updates: Partial<MededelingenSlide>) => {\n    updateSettings({\n      slides: settings.slides.map(slide => \n        slide.id === slideId ? { ...slide, ...updates } : slide\n      )\n    });\n  };\n\n  const handleImageUpload = (slideId: string, event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Voor nu simuleren we een upload - in een echte app zou je dit naar een server uploaden\n      const imageUrl = URL.createObjectURL(file);\n      updateSlide(slideId, { \n        mediaUrl: imageUrl, \n        mediaType: 'image' \n      });\n    }\n  };\n\n  const PreviewSlide = ({ slide }: { slide: MededelingenSlide }) => (\n    <div \n      className=\"relative w-full h-64 rounded-lg overflow-hidden flex items-center justify-center\"\n      style={{ \n        backgroundColor: settings.style.backgroundColor,\n        color: settings.style.textColor \n      }}\n    >\n      {slide.mediaUrl && (\n        <img \n          src={slide.mediaUrl} \n          alt={slide.title}\n          className=\"absolute inset-0 w-full h-full object-cover opacity-70\"\n        />\n      )}\n      <div \n        className=\"relative z-10 text-center px-6\"\n        style={{ maxWidth: settings.style.maxTextWidth }}\n      >\n        <h2 className=\"text-xl font-bold mb-2\">{slide.title}</h2>\n        {slide.body && (\n          <p className=\"text-sm opacity-90\">{slide.body}</p>\n        )}\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Berichten beheer */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg font-semibold\">Berichten ({settings.slides.length})</h3>\n          <Button onClick={addSlide} size=\"sm\" className=\"gap-2\">\n            <Plus className=\"w-4 h-4\" />\n            Nieuw bericht\n          </Button>\n        </div>\n\n        {/* Berichten tabs */}\n        <div className=\"flex gap-2 overflow-x-auto\">\n          {settings.slides.map((slide, index) => (\n            <Button\n              key={slide.id}\n              variant={currentSlide === index ? \"default\" : \"outline\"}\n              size=\"sm\"\n              onClick={() => setCurrentSlide(index)}\n              className=\"shrink-0\"\n            >\n              {slide.title}\n            </Button>\n          ))}\n        </div>\n\n        {/* Huidig bericht bewerken */}\n        {settings.slides[currentSlide] && (\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <CardTitle className=\"text-base\">\n                  Bericht {currentSlide + 1} bewerken\n                </CardTitle>\n                {settings.slides.length > 1 && (\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => removeSlide(settings.slides[currentSlide].id)}\n                    className=\"text-red-600 hover:text-red-700\"\n                  >\n                    <Trash2 className=\"w-4 h-4\" />\n                  </Button>\n                )}\n              </div>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label>Titel</Label>\n                  <Input\n                    value={settings.slides[currentSlide].title}\n                    onChange={(e) => updateSlide(settings.slides[currentSlide].id, { title: e.target.value })}\n                    placeholder=\"Titel van het bericht\"\n                  />\n                </div>\n                <div>\n                  <Label>Weergavetijd (seconden)</Label>\n                  <Input\n                    type=\"number\"\n                    value={settings.slides[currentSlide].durationSec}\n                    onChange={(e) => updateSlide(settings.slides[currentSlide].id, { durationSec: parseInt(e.target.value) || 10 })}\n                    min={1}\n                    max={60}\n                  />\n                </div>\n              </div>\n\n              <div>\n                <Label>Berichttekst</Label>\n                <Textarea\n                  value={settings.slides[currentSlide].body || ''}\n                  onChange={(e) => updateSlide(settings.slides[currentSlide].id, { body: e.target.value })}\n                  placeholder=\"De inhoud van je bericht...\"\n                  rows={4}\n                />\n              </div>\n\n              <div>\n                <Label>Afbeelding (optioneel)</Label>\n                <div className=\"flex gap-3 items-center\">\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={(e) => handleImageUpload(settings.slides[currentSlide].id, e)}\n                    className=\"hidden\"\n                    id={`image-upload-${settings.slides[currentSlide].id}`}\n                  />\n                  <Button\n                    variant=\"outline\"\n                    asChild\n                    className=\"gap-2\"\n                  >\n                    <label htmlFor={`image-upload-${settings.slides[currentSlide].id}`}>\n                      <Upload className=\"w-4 h-4\" />\n                      Afbeelding uploaden\n                    </label>\n                  </Button>\n                  {settings.slides[currentSlide].mediaUrl && (\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => updateSlide(settings.slides[currentSlide].id, { mediaUrl: undefined, mediaType: undefined })}\n                    >\n                      Verwijderen\n                    </Button>\n                  )}\n                </div>\n                {settings.slides[currentSlide].mediaUrl && (\n                  <img \n                    src={settings.slides[currentSlide].mediaUrl} \n                    alt=\"Preview\" \n                    className=\"mt-2 w-32 h-20 object-cover rounded border\"\n                  />\n                )}\n              </div>\n\n              <div className=\"flex items-center space-x-2\">\n                <Switch\n                  checked={settings.slides[currentSlide].active}\n                  onCheckedChange={(active) => updateSlide(settings.slides[currentSlide].id, { active })}\n                />\n                <Label>Actief in carrousel</Label>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n\n      {/* Carrousel instellingen */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-base\">Carrousel instellingen</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"flex items-center space-x-2\">\n            <Switch\n              checked={settings.autoplay.enabled}\n              onCheckedChange={(enabled) => updateSettings({\n                autoplay: { ...settings.autoplay, enabled }\n              })}\n            />\n            <Label>Automatisch afspelen</Label>\n          </div>\n\n          {settings.autoplay.enabled && (\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <Label>Standaard interval (seconden)</Label>\n                <Input\n                  type=\"number\"\n                  value={settings.autoplay.interval}\n                  onChange={(e) => updateSettings({\n                    autoplay: { \n                      ...settings.autoplay, \n                      interval: parseInt(e.target.value) || 8 \n                    }\n                  })}\n                  min={1}\n                  max={60}\n                />\n              </div>\n              <div>\n                <Label>Volgorde</Label>\n                <Select\n                  value={settings.autoplay.order}\n                  onValueChange={(order: 'date' | 'manual' | 'shuffle') => updateSettings({\n                    autoplay: { ...settings.autoplay, order }\n                  })}\n                >\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"manual\">Handmatige volgorde</SelectItem>\n                    <SelectItem value=\"date\">Op datum</SelectItem>\n                    <SelectItem value=\"shuffle\">Willekeurig</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Styling */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"text-base\">Styling</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label>Tekstkleur</Label>\n              <ColorPicker\n                value={settings.style.textColor}\n                onChange={(color) => updateSettings({\n                  style: { ...settings.style, textColor: color }\n                })}\n              />\n            </div>\n            <div>\n              <Label>Achtergrondkleur</Label>\n              <ColorPicker\n                value={settings.style.backgroundColor}\n                onChange={(color) => updateSettings({\n                  style: { ...settings.style, backgroundColor: color }\n                })}\n              />\n            </div>\n          </div>\n          <div>\n            <Label>Maximale tekstbreedte (pixels)</Label>\n            <Input\n              type=\"number\"\n              value={settings.style.maxTextWidth}\n              onChange={(e) => updateSettings({\n                style: { \n                  ...settings.style, \n                  maxTextWidth: parseInt(e.target.value) || 800 \n                }\n              })}\n              min={300}\n              max={1200}\n            />\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Preview */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"text-base\">Preview</CardTitle>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setShowPreview(!showPreview)}\n              className=\"gap-2\"\n            >\n              <Eye className=\"w-4 h-4\" />\n              {showPreview ? 'Verberg' : 'Toon'} preview\n            </Button>\n          </div>\n        </CardHeader>\n        {showPreview && (\n          <CardContent>\n            {settings.slides[currentSlide] && (\n              <PreviewSlide slide={settings.slides[currentSlide]} />\n            )}\n            {settings.slides.length > 1 && (\n              <div className=\"flex justify-center gap-2 mt-4\">\n                {settings.slides.map((_, index) => (\n                  <button\n                    key={index}\n                    onClick={() => setCurrentSlide(index)}\n                    className={`w-2 h-2 rounded-full transition-colors ${\n                      index === currentSlide ? 'bg-primary' : 'bg-gray-300'\n                    }`}\n                  />\n                ))}\n              </div>\n            )}\n          </CardContent>\n        )}\n      </Card>\n    </div>\n  );\n}","size_bytes":13631},"client/src/components/public-view/MededelingenView.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport backgroundImage from \"@assets/ramadan_15_03_2022_1_1756811846212.jpg\";\n\ninterface MededelingenViewProps {\n  config: any;\n}\n\nexport function MededelingenView({ config }: MededelingenViewProps) {\n  const [currentSlideIndex, setCurrentSlideIndex] = useState(0);\n  const [fadeClass, setFadeClass] = useState(\"opacity-100\");\n\n  // Get slides/messages with safe fallback\n  const slides = config?.slides || config?.messages || [];\n  const activeSlides = slides.filter((slide: any) => slide.active === true);\n  const currentSlide = activeSlides[currentSlideIndex];\n\n  // Safe config defaults\n  const carouselConfig = config?.carousel || {};\n  const autoAdvance = carouselConfig.autoAdvance ?? config?.autoplay?.enabled ?? true;\n  const intervalTime = carouselConfig.intervalTime || (config?.autoplay?.interval * 1000) || 60000;\n\n  useEffect(() => {\n    if (!autoAdvance || activeSlides.length <= 1) return;\n\n    const slideInterval = currentSlide?.displayDuration || intervalTime;\n    \n    const timer = setTimeout(() => {\n      setFadeClass(\"opacity-0\");\n      \n      setTimeout(() => {\n        setCurrentSlideIndex(prev => (prev + 1) % activeSlides.length);\n        setFadeClass(\"opacity-100\");\n      }, 300);\n    }, slideInterval);\n\n    return () => clearTimeout(timer);\n  }, [currentSlideIndex, activeSlides.length, autoAdvance, intervalTime, currentSlide]);\n\n  if (!currentSlide) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-cyan-800 text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-4xl font-bold mb-4\">Geen actieve mededelingen</h1>\n          <p className=\"text-xl opacity-75\">Er zijn momenteel geen berichten om weer te geven.</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Get styling from slide or use defaults\n  const slideStyle = currentSlide.styling || {};\n  const backgroundColor = slideStyle.backgroundColor || config?.style?.background || '#f3f4f6';\n  const textColor = slideStyle.titleColor || config?.style?.textColor || '#1f2937';\n\n  return (\n    <div \n      className=\"min-h-screen relative flex items-center justify-center p-8\"\n      style={{\n        backgroundImage: `url(\"${backgroundImage}\")`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n        backgroundRepeat: 'no-repeat'\n      }}\n    >\n      {/* Large centered container for announcements */}\n      <div className=\"relative z-10 flex items-center justify-center min-h-screen\">\n        <div \n          className=\"bg-white/95 backdrop-blur-lg rounded-3xl border-2 border-white/30 p-24 text-center shadow-xl\"\n          style={{ \n            boxShadow: '0 25px 60px -12px rgba(0, 0, 0, 0.3), 0 8px 25px -8px rgba(0, 0, 0, 0.1)',\n            backdropFilter: 'blur(16px)',\n            width: '95vw',\n            maxWidth: '1600px',\n            minHeight: '85vh',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'flex-start'\n          }}\n        >\n          {/* Header section - always at top */}\n          <div className=\"mb-12\">\n            {/* Slide title */}\n            <h1 \n              className={`mb-4 transition-opacity duration-300 ${fadeClass}`}\n              style={{\n                fontSize: slideStyle.titleFontSize ? `${slideStyle.titleFontSize}px` : '56px',\n                fontFamily: slideStyle.titleFontFamily || 'Poppins',\n                fontWeight: slideStyle.titleFontWeight || 'bold',\n                color: slideStyle.titleColor || '#1f2937',\n                lineHeight: '1.1'\n              }}\n              data-testid=\"mededelingen-title\"\n            >\n              {currentSlide.title}\n            </h1>\n            \n            {/* Slide subtitle */}\n            {currentSlide.subtitle && (\n              <h2 \n                className={`transition-opacity duration-300 ${fadeClass}`}\n                style={{\n                  fontSize: slideStyle.subtitleFontSize ? `${slideStyle.subtitleFontSize}px` : '32px',\n                  fontFamily: slideStyle.subtitleFontFamily || 'Poppins',\n                  fontWeight: slideStyle.subtitleFontWeight || 'normal',\n                  color: slideStyle.subtitleColor || '#6b7280',\n                  lineHeight: '1.3'\n                }}\n                data-testid=\"mededelingen-subtitle\"\n              >\n                {currentSlide.subtitle}\n              </h2>\n            )}\n          </div>\n          \n          {/* Body content below header */}\n          {currentSlide.body && (\n            <div className=\"flex-1 flex items-center justify-center\">\n              <div \n                className={`leading-relaxed whitespace-pre-line max-w-5xl transition-opacity duration-300 ${fadeClass}`}\n                style={{\n                  fontSize: slideStyle.bodyFontSize ? `${slideStyle.bodyFontSize}px` : '28px',\n                  fontFamily: slideStyle.bodyFontFamily || 'Poppins',\n                  fontWeight: slideStyle.bodyFontWeight || 'normal',\n                  color: slideStyle.bodyColor || '#374151',\n                  lineHeight: '1.7'\n                }}\n                data-testid=\"mededelingen-body\"\n              >\n                {currentSlide.body}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Simple progress indicators only */}\n      {activeSlides.length > 1 && (\n        <div className=\"absolute bottom-8 left-1/2 transform -translate-x-1/2 z-10\">\n          <div className=\"flex justify-center items-center gap-3\">\n            {activeSlides.map((_: any, index: number) => (\n              <div\n                key={index}\n                className={`w-4 h-4 rounded-full transition-all duration-300 ${\n                  index === currentSlideIndex \n                    ? 'bg-white scale-125 shadow-lg' \n                    : 'bg-white/40'\n                }`}\n                data-testid={`slide-indicator-${index}`}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Auto-play progress bar */}\n      {autoAdvance && activeSlides.length > 1 && (\n        <div className=\"absolute bottom-0 left-0 right-0 z-10\">\n          <div className=\"h-1 bg-white/20\">\n            <div \n              className=\"h-full transition-all linear bg-white\"\n              style={{\n                width: '0%',\n                animation: `progress ${(currentSlide?.displayDuration || intervalTime) / 1000}s linear infinite`\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      <style>{`\n        @keyframes progress {\n          from { width: 0%; }\n          to { width: 100%; }\n        }\n      `}</style>\n    </div>\n  );\n}","size_bytes":6713},"client/src/components/ui/color-wheel.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Input } from \"@/components/ui/input\";\n\ninterface ColorPickerProps {\n  value: string;\n  onChange: (color: string) => void;\n  className?: string;\n}\n\nconst predefinedColors = [\n  \"#000000\", \"#1a1a1a\", \"#333333\", \"#4d4d4d\", \"#666666\", \"#808080\", \"#999999\", \"#b3b3b3\", \"#cccccc\", \"#e6e6e6\", \"#f5f5f5\", \"#ffffff\",\n  \"#ff0000\", \"#ff4d4d\", \"#ff9999\", \"#ffcccc\", \"#ffe6e6\", \"#800000\", \"#cc0000\", \"#ff6666\", \"#ffb3b3\", \"#ffd9d9\", \"#ffeeee\", \"#fff2f2\",\n  \"#ff8000\", \"#ffaa55\", \"#ffcc99\", \"#ffe6cc\", \"#fff0e6\", \"#804000\", \"#cc6600\", \"#ff9933\", \"#ffcc66\", \"#ffe0b3\", \"#ffedd9\", \"#fff7f0\",\n  \"#ffff00\", \"#ffff4d\", \"#ffff99\", \"#ffffcc\", \"#ffffe6\", \"#808000\", \"#cccc00\", \"#ffff66\", \"#ffffb3\", \"#ffffd9\", \"#ffffee\", \"#fffff2\",\n  \"#80ff00\", \"#aaff55\", \"#ccff99\", \"#e6ffcc\", \"#f0ffe6\", \"#408000\", \"#66cc00\", \"#99ff33\", \"#ccff66\", \"#e0ffb3\", \"#edffdd\", \"#f7fff0\",\n  \"#00ff00\", \"#4dff4d\", \"#99ff99\", \"#ccffcc\", \"#e6ffe6\", \"#008000\", \"#00cc00\", \"#66ff66\", \"#b3ffb3\", \"#d9ffd9\", \"#eeffee\", \"#f2fff2\",\n  \"#00ff80\", \"#55ffaa\", \"#99ffcc\", \"#ccffe6\", \"#e6fff0\", \"#008040\", \"#00cc66\", \"#33ff99\", \"#66ffcc\", \"#b3ffe0\", \"#ddfedd\", \"#f0fff7\",\n  \"#00ffff\", \"#4dffff\", \"#99ffff\", \"#ccffff\", \"#e6ffff\", \"#008080\", \"#00cccc\", \"#66ffff\", \"#b3ffff\", \"#d9ffff\", \"#eeffff\", \"#f2ffff\",\n  \"#0080ff\", \"#55aaff\", \"#99ccff\", \"#cce6ff\", \"#e6f0ff\", \"#004080\", \"#0066cc\", \"#3399ff\", \"#66ccff\", \"#b3e0ff\", \"#ddedff\", \"#f0f7ff\",\n  \"#0000ff\", \"#4d4dff\", \"#9999ff\", \"#ccccff\", \"#e6e6ff\", \"#000080\", \"#0000cc\", \"#6666ff\", \"#b3b3ff\", \"#d9d9ff\", \"#eeeeff\", \"#f2f2ff\",\n  \"#8000ff\", \"#aa55ff\", \"#cc99ff\", \"#e6ccff\", \"#f0e6ff\", \"#400080\", \"#6600cc\", \"#9933ff\", \"#cc66ff\", \"#e0b3ff\", \"#edddff\", \"#f7f0ff\",\n  \"#ff00ff\", \"#ff4dff\", \"#ff99ff\", \"#ffccff\", \"#ffe6ff\", \"#800080\", \"#cc00cc\", \"#ff66ff\", \"#ffb3ff\", \"#ffd9ff\", \"#ffeeff\", \"#fff2ff\",\n  \"#ff0080\", \"#ff55aa\", \"#ff99cc\", \"#ffcce6\", \"#ffe6f0\", \"#800040\", \"#cc0066\", \"#ff3399\", \"#ff66cc\", \"#ffb3e0\", \"#ffddfd\", \"#fff0f7\"\n];\n\nexport function ColorPicker({ value, onChange, className = \"\" }: ColorPickerProps) {\n  const [hexInput, setHexInput] = useState(value);\n\n  const handleHexChange = (hex: string) => {\n    setHexInput(hex);\n    if (/^#[0-9A-Fa-f]{6}$/.test(hex)) {\n      onChange(hex);\n    }\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          className={`h-10 w-full justify-start gap-3 ${className}`}\n        >\n          <div\n            className=\"w-6 h-6 rounded border border-gray-300 shadow-sm\"\n            style={{ backgroundColor: value }}\n          />\n          <span className=\"text-sm font-mono\">{value.toUpperCase()}</span>\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 p-4\" align=\"start\">\n        <div className=\"space-y-4\">\n          {/* Current Color Preview */}\n          <div className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n            <div\n              className=\"w-12 h-12 rounded-lg border-2 border-white shadow-lg\"\n              style={{ backgroundColor: value }}\n            />\n            <div>\n              <div className=\"text-sm font-medium\">Geselecteerde kleur</div>\n              <div className=\"text-xs font-mono text-gray-600\">{value.toUpperCase()}</div>\n            </div>\n          </div>\n\n          {/* Hex Input */}\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium\">Hex kleur</label>\n            <Input\n              value={hexInput}\n              onChange={(e) => handleHexChange(e.target.value)}\n              placeholder=\"#000000\"\n              className=\"font-mono\"\n            />\n          </div>\n\n          {/* Native Color Picker */}\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium\">Kleurenkiezer</label>\n            <input\n              type=\"color\"\n              value={value}\n              onChange={(e) => {\n                onChange(e.target.value);\n                setHexInput(e.target.value);\n              }}\n              className=\"w-full h-12 border border-gray-300 rounded-lg cursor-pointer\"\n            />\n          </div>\n\n\n          {/* Common Colors */}\n          <div className=\"space-y-2\">\n            <label className=\"text-sm font-medium\">Veel gebruikte kleuren</label>\n            <div className=\"flex gap-2\">\n              {[\"#000000\", \"#ffffff\", \"#2563eb\", \"#dc2626\", \"#16a34a\", \"#f59e0b\", \"#7c3aed\", \"#e11d48\"].map((color) => (\n                <button\n                  key={color}\n                  onClick={() => {\n                    onChange(color);\n                    setHexInput(color);\n                  }}\n                  className={`w-8 h-8 rounded-lg border-2 transition-all hover:scale-110 ${\n                    value === color ? 'border-gray-800 ring-2 ring-blue-500' : 'border-gray-300 hover:border-gray-500'\n                  }`}\n                  style={{ backgroundColor: color }}\n                  title={color.toUpperCase()}\n                />\n              ))}\n            </div>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}","size_bytes":5227},"client/src/components/public-view/MultimediaView.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect, useRef } from \"react\";\nimport { MultimediaConfig } from \"@/lib/mock/public-screens\";\n\ninterface MultimediaViewProps {\n  config: MultimediaConfig;\n}\n\nexport function MultimediaView({ config }: MultimediaViewProps) {\n  const [currentItemIndex, setCurrentItemIndex] = useState(0);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n  const videoRef = useRef<HTMLVideoElement>(null);\n\n  const activeItems = config.mediaItems.filter(item => item.active);\n  const currentItem = activeItems[currentItemIndex];\n\n  useEffect(() => {\n    if (!config.autoplay.enabled || activeItems.length <= 1) return;\n\n    // Voor video's met loop, gebruik de video duration als timing\n    let duration = currentItem?.duration || config.autoplay.interval;\n    \n    // Als het een video is met loop disabled, gebruik de standaard timing\n    if (currentItem?.type === 'video' && !currentItem.loop && videoRef.current) {\n      const videoDuration = videoRef.current.duration;\n      if (videoDuration && !isNaN(videoDuration)) {\n        duration = Math.min(videoDuration, currentItem.duration);\n      }\n    }\n\n    const timer = setTimeout(() => {\n      handleTransition();\n    }, duration * 1000);\n\n    return () => clearTimeout(timer);\n  }, [currentItemIndex, activeItems.length, config.autoplay, currentItem]);\n\n  const handleTransition = () => {\n    setIsTransitioning(true);\n    \n    setTimeout(() => {\n      setCurrentItemIndex(prev => (prev + 1) % activeItems.length);\n      setIsTransitioning(false);\n    }, 300); // Transition duration\n  };\n\n  const getTransitionClass = () => {\n    if (!isTransitioning) return \"opacity-100 transform scale-100\";\n    \n    switch (currentItem?.transition) {\n      case 'fade':\n        return \"opacity-0 transform scale-100\";\n      case 'slide':\n        return \"opacity-100 transform translate-x-full\";\n      case 'zoom':\n        return \"opacity-0 transform scale-110\";\n      default:\n        return \"opacity-100 transform scale-100\";\n    }\n  };\n\n  if (!currentItem) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-900 to-cyan-800 text-white\">\n        <div className=\"text-center\">\n          <h1 className=\"text-4xl font-bold mb-4\">Geen actieve media</h1>\n          <p className=\"text-xl opacity-75\">Er zijn momenteel geen media items om weer te geven.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen relative overflow-hidden flex flex-col bg-gradient-to-br from-blue-950 to-cyan-900\">\n      {/* Header with title and subtitle */}\n      <div className=\"relative z-10 p-8 text-center\">\n        <h1 \n          className=\"mb-2\"\n          style={{\n            fontSize: `${config.title.fontSize}px`,\n            fontFamily: config.title.fontFamily,\n            fontWeight: config.title.fontWeight,\n            color: config.title.color\n          }}\n        >\n          {config.title.text}\n        </h1>\n        {config.subtitle.text && (\n          <h2 \n            style={{\n              fontSize: `${config.subtitle.fontSize}px`,\n              fontFamily: config.subtitle.fontFamily,\n              fontWeight: config.subtitle.fontWeight,\n              color: config.subtitle.color\n            }}\n          >\n            {config.subtitle.text}\n          </h2>\n        )}\n      </div>\n\n      {/* Main media area */}\n      <div className=\"relative z-10 flex-1 flex items-center justify-center p-8\">\n        <div \n          className={`w-full h-full max-w-6xl max-h-[70vh] transition-all duration-300 ease-in-out ${getTransitionClass()}`}\n        >\n          {currentItem.type === 'video' ? (\n            <video\n              ref={videoRef}\n              src={currentItem.url}\n              className=\"w-full h-full object-contain rounded-lg shadow-2xl\"\n              autoPlay\n              muted\n              loop={currentItem.loop}\n              controls={currentItem.loop} // Show controls only for looped videos\n              onEnded={() => {\n                if (!currentItem.loop && activeItems.length > 1) {\n                  handleTransition();\n                }\n              }}\n            />\n          ) : (\n            <img \n              src={currentItem.url}\n              alt={currentItem.name || 'Media item'}\n              className=\"w-full h-full object-contain rounded-lg shadow-2xl\"\n            />\n          )}\n        </div>\n      </div>\n\n      {/* Media info overlay */}\n      <div className=\"absolute bottom-4 left-4 bg-blue-900 bg-opacity-90 text-white px-4 py-2 rounded-lg border border-blue-600/30 backdrop-blur-sm\">\n        <div className=\"text-sm font-medium\">{currentItem.name}</div>\n        <div className=\"text-xs opacity-75\">\n          {currentItem.type === 'video' ? \n            (currentItem.loop ? 'Video (Loop)' : `Video (${currentItem.duration}s)`) :\n            `Afbeelding (${currentItem.duration}s)`\n          }\n        </div>\n      </div>\n\n      {/* Progress indicators */}\n      {activeItems.length > 1 && (\n        <div className=\"absolute bottom-4 right-4 flex gap-2\">\n          {activeItems.map((_, index) => (\n            <div\n              key={index}\n              className={`w-3 h-3 rounded-full transition-all duration-300 ${\n                index === currentItemIndex \n                  ? 'bg-white scale-110' \n                  : 'bg-white opacity-40'\n              }`}\n            />\n          ))}\n        </div>\n      )}\n\n      {/* Auto-play progress bar (alleen voor niet-loop video's en afbeeldingen) */}\n      {config.autoplay.enabled && activeItems.length > 1 && \n       (!currentItem.loop || currentItem.type !== 'video') && (\n        <div className=\"absolute bottom-0 left-0 right-0 z-10\">\n          <div className=\"h-1 bg-white opacity-20\">\n            <div \n              className=\"h-full bg-white transition-all linear\"\n              style={{\n                width: '0%',\n                animation: `progress ${currentItem.duration}s linear infinite`\n              }}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Navigation overlay (bij hover) */}\n      {activeItems.length > 1 && (\n        <div className=\"absolute inset-0 z-10 opacity-0 hover:opacity-100 transition-opacity duration-300\">\n          <button\n            className=\"absolute left-4 top-1/2 transform -translate-y-1/2 bg-blue-900 bg-opacity-80 text-white p-3 rounded-full hover:bg-opacity-100 transition-all border border-blue-600/30 backdrop-blur-sm\"\n            onClick={() => setCurrentItemIndex(prev => \n              prev > 0 ? prev - 1 : activeItems.length - 1\n            )}\n          >\n            ←\n          </button>\n          <button\n            className=\"absolute right-4 top-1/2 transform -translate-y-1/2 bg-blue-900 bg-opacity-80 text-white p-3 rounded-full hover:bg-opacity-100 transition-all border border-blue-600/30 backdrop-blur-sm\"\n            onClick={() => setCurrentItemIndex(prev => \n              prev < activeItems.length - 1 ? prev + 1 : 0\n            )}\n          >\n            →\n          </button>\n        </div>\n      )}\n\n      <style>{`\n        @keyframes progress {\n          from { width: 0%; }\n          to { width: 100%; }\n        }\n      `}</style>\n    </div>\n  );\n}","size_bytes":7228},"client/src/components/public-screens/wizard/steps/MededelingenCarouselStep.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Play, Pause, RotateCcw, Shuffle } from \"lucide-react\";\n\ninterface MededelingenSettings {\n  slides: Array<{\n    id: string;\n    title: string;\n    body?: string;\n    active: boolean;\n    durationSec: number;\n  }>;\n  autoplay: {\n    enabled: boolean;\n    interval: number;\n    order: 'date' | 'manual' | 'shuffle';\n  };\n  style: {\n    textColor: string;\n    backgroundColor: string;\n    maxTextWidth: number;\n  };\n}\n\ninterface MededelingenCarouselStepProps {\n  data: {\n    mededelingenSettings?: MededelingenSettings;\n  };\n  onUpdate: (data: any) => void;\n}\n\nconst orderOptions = [\n  { value: 'manual', label: 'Handmatige volgorde', icon: RotateCcw },\n  { value: 'date', label: 'Op datum', icon: RotateCcw },\n  { value: 'shuffle', label: 'Willekeurig', icon: Shuffle }\n];\n\nexport function MededelingenCarouselStep({ data, onUpdate }: MededelingenCarouselStepProps) {\n  const settings = data.mededelingenSettings || {\n    slides: [],\n    autoplay: {\n      enabled: true,\n      interval: 8,\n      order: 'manual'\n    },\n    style: {\n      textColor: '#ffffff',\n      backgroundColor: '#1f2937',\n      maxTextWidth: 800\n    }\n  };\n\n  const updateSettings = (newSettings: Partial<MededelingenSettings>) => {\n    onUpdate({\n      ...data,\n      mededelingenSettings: {\n        ...settings,\n        ...newSettings\n      }\n    });\n  };\n\n  const updateAutoplay = (key: keyof typeof settings.autoplay, value: any) => {\n    updateSettings({\n      autoplay: {\n        ...settings.autoplay,\n        [key]: value\n      }\n    });\n  };\n\n  const activeSlides = settings.slides.filter(slide => slide.active);\n  const totalDuration = activeSlides.reduce((sum, slide) => sum + slide.durationSec, 0);\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Carrousel instellingen</h3>\n        <p className=\"text-sm text-gray-600\">\n          Configureer hoe de berichten worden afgespeeld\n        </p>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Afspeel instellingen */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Play className=\"h-5 w-5\" />\n              Afspeel instellingen\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <Label htmlFor=\"autoplay-enabled\">Automatisch afspelen</Label>\n              <Switch\n                id=\"autoplay-enabled\"\n                checked={settings.autoplay.enabled}\n                onCheckedChange={(checked) => updateAutoplay('enabled', checked)}\n                data-testid=\"switch-autoplay\"\n              />\n            </div>\n\n            {settings.autoplay.enabled && (\n              <>\n                <div>\n                  <Label htmlFor=\"interval\">Interval tussen berichten (seconden)</Label>\n                  <Input\n                    id=\"interval\"\n                    type=\"number\"\n                    value={settings.autoplay.interval}\n                    onChange={(e) => updateAutoplay('interval', parseInt(e.target.value) || 8)}\n                    min=\"1\"\n                    max=\"60\"\n                    data-testid=\"input-interval\"\n                  />\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    Tijd tussen berichten (onafhankelijk van bericht duur)\n                  </p>\n                </div>\n\n                <div>\n                  <Label htmlFor=\"order\">Afspeel volgorde</Label>\n                  <Select\n                    value={settings.autoplay.order}\n                    onValueChange={(value: 'date' | 'manual' | 'shuffle') => updateAutoplay('order', value)}\n                  >\n                    <SelectTrigger data-testid=\"select-order\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {orderOptions.map(option => {\n                        const Icon = option.icon;\n                        return (\n                          <SelectItem key={option.value} value={option.value}>\n                            <div className=\"flex items-center gap-2\">\n                              <Icon className=\"h-4 w-4\" />\n                              {option.label}\n                            </div>\n                          </SelectItem>\n                        );\n                      })}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Overzicht */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Carrousel overzicht</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-3\">\n              <div className=\"flex justify-between text-sm\">\n                <span>Totaal berichten:</span>\n                <span className=\"font-medium\">{settings.slides.length}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span>Actieve berichten:</span>\n                <span className=\"font-medium\">{activeSlides.length}</span>\n              </div>\n              <div className=\"flex justify-between text-sm\">\n                <span>Totale inhoud duur:</span>\n                <span className=\"font-medium\">{totalDuration}s</span>\n              </div>\n              {settings.autoplay.enabled && (\n                <div className=\"flex justify-between text-sm\">\n                  <span>Cyclus duur:</span>\n                  <span className=\"font-medium\">\n                    {totalDuration + (activeSlides.length * settings.autoplay.interval)}s\n                  </span>\n                </div>\n              )}\n            </div>\n\n            {activeSlides.length === 0 && (\n              <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                <p className=\"text-sm text-yellow-800\">\n                  ⚠️ Geen actieve berichten. Ga terug om berichten te activeren.\n                </p>\n              </div>\n            )}\n\n            {!settings.autoplay.enabled && (\n              <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-lg\">\n                <p className=\"text-sm text-blue-800\">\n                  ℹ️ Handmatige besturing. Berichten worden alleen getoond op actie.\n                </p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Voorbeeld tijdlijn */}\n      {settings.autoplay.enabled && activeSlides.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Voorbeeld tijdlijn</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-2\">\n              {activeSlides.slice(0, 3).map((slide, index) => (\n                <div key={slide.id} className=\"flex items-center gap-3 p-2 bg-gray-50 rounded\">\n                  <div className=\"w-6 h-6 bg-primary text-white rounded-full flex items-center justify-center text-xs font-medium\">\n                    {index + 1}\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-medium\">{slide.title}</p>\n                  </div>\n                  <div className=\"text-xs text-gray-500\">\n                    {slide.durationSec}s + {settings.autoplay.interval}s\n                  </div>\n                </div>\n              ))}\n              {activeSlides.length > 3 && (\n                <div className=\"text-center text-sm text-gray-500 py-2\">\n                  ... en {activeSlides.length - 3} andere berichten\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Configuratie samenvatting */}\n      <div className=\"p-4 bg-green-50 rounded-lg\">\n        <h4 className=\"font-medium text-green-900 mb-2\">Carrousel configuratie</h4>\n        <div className=\"text-sm text-green-700 space-y-1\">\n          <p>• Autoplay: {settings.autoplay.enabled ? 'Aan' : 'Uit'}</p>\n          {settings.autoplay.enabled && (\n            <>\n              <p>• Interval: {settings.autoplay.interval} seconden</p>\n              <p>• Volgorde: {orderOptions.find(o => o.value === settings.autoplay.order)?.label}</p>\n              <p>• Volledige cyclus: {totalDuration + (activeSlides.length * settings.autoplay.interval)} seconden</p>\n            </>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":8932},"client/src/components/public-screens/wizard/steps/MededelingenMessagesStep.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Trash2, Plus, GripVertical, Eye, EyeOff, ChevronUp, ChevronDown } from \"lucide-react\";\nimport { ColorPicker } from \"@/components/ui/color-wheel\";\nimport { MededelingenSlide } from \"@/lib/mock/public-screens\";\n\ninterface MededelingenSettings {\n  slides: MededelingenSlide[];\n  autoplay: {\n    enabled: boolean;\n    interval: number;\n    order: 'date' | 'manual' | 'shuffle';\n  };\n  style: {\n    textColor: string;\n    backgroundColor: string;\n    maxTextWidth: number;\n  };\n}\n\ninterface MededelingenMessagesStepProps {\n  data: {\n    mededelingenSettings?: MededelingenSettings;\n  };\n  onUpdate: (data: any) => void;\n}\n\nconst fontFamilies = [\n  { value: \"Poppins\", label: \"Poppins\" },\n  { value: \"Arial\", label: \"Arial\" },\n  { value: \"Helvetica\", label: \"Helvetica\" },\n  { value: \"Times New Roman\", label: \"Times New Roman\" },\n  { value: \"Georgia\", label: \"Georgia\" }\n];\n\nconst fontWeights = [\n  { value: \"normal\", label: \"Normaal\" },\n  { value: \"bold\", label: \"Vet\" },\n  { value: \"lighter\", label: \"Licht\" }\n];\n\nexport function MededelingenMessagesStep({ data, onUpdate }: MededelingenMessagesStepProps) {\n  const [previewSlide, setPreviewSlide] = useState<string | null>(null);\n\n  const settings = data.mededelingenSettings || {\n    slides: [{\n      id: 'slide1',\n      title: 'Eerste bericht',\n      body: '',\n      active: true,\n      durationSec: 10,\n      styling: {\n        titleFontSize: 32,\n        titleFontWeight: 'bold',\n        titleFontFamily: 'Poppins',\n        titleColor: '#1f2937',\n        subtitleFontSize: 20,\n        subtitleFontWeight: 'normal',\n        subtitleFontFamily: 'Poppins',\n        subtitleColor: '#6b7280',\n        bodyFontSize: 18,\n        bodyFontWeight: 'normal',\n        bodyFontFamily: 'Poppins',\n        bodyColor: '#374151',\n        backgroundColor: '#ffffff'\n      }\n    }],\n    autoplay: {\n      enabled: true,\n      interval: 8,\n      order: 'manual'\n    },\n    style: {\n      textColor: '#ffffff',\n      backgroundColor: '#1f2937',\n      maxTextWidth: 800\n    }\n  };\n\n  const updateSettings = (newSettings: Partial<MededelingenSettings>) => {\n    onUpdate({\n      ...data,\n      mededelingenSettings: {\n        ...settings,\n        ...newSettings\n      }\n    });\n  };\n\n  const addSlide = () => {\n    const newSlide: MededelingenSlide = {\n      id: `slide${Date.now()}`,\n      title: `Bericht ${settings.slides.length + 1}`,\n      body: '',\n      active: true,\n      durationSec: 10,\n      styling: {\n        titleFontSize: 32,\n        titleFontWeight: 'bold',\n        titleFontFamily: 'Poppins',\n        titleColor: '#1f2937',\n        subtitleFontSize: 20,\n        subtitleFontWeight: 'normal',\n        subtitleFontFamily: 'Poppins',\n        subtitleColor: '#6b7280',\n        bodyFontSize: 18,\n        bodyFontWeight: 'normal',\n        bodyFontFamily: 'Poppins',\n        bodyColor: '#374151',\n        backgroundColor: '#ffffff'\n      }\n    };\n\n    updateSettings({\n      slides: [...settings.slides, newSlide]\n    });\n  };\n\n  const updateSlide = (slideId: string, updates: Partial<MededelingenSlide>) => {\n    const updatedSlides = settings.slides.map(slide =>\n      slide.id === slideId ? { ...slide, ...updates } : slide\n    );\n    \n    updateSettings({ slides: updatedSlides });\n  };\n\n  const updateSlideStyle = (slideId: string, styleKey: string, value: any) => {\n    const updatedSlides = settings.slides.map(slide => {\n      if (slide.id === slideId) {\n        const defaultStyling = {\n          titleFontSize: 32,\n          titleFontWeight: 'bold' as const,\n          titleFontFamily: 'Poppins',\n          titleColor: '#1f2937',\n          bodyFontSize: 18,\n          bodyFontWeight: 'normal' as const,\n          bodyFontFamily: 'Poppins',\n          bodyColor: '#374151',\n          backgroundColor: '#ffffff'\n        };\n        return { \n          ...slide, \n          styling: { \n            ...defaultStyling,\n            ...slide.styling, \n            [styleKey]: value \n          } \n        };\n      }\n      return slide;\n    });\n    \n    updateSettings({ slides: updatedSlides });\n  };\n\n  const deleteSlide = (slideId: string) => {\n    if (settings.slides.length <= 1) return; // Altijd minstens 1 slide\n    \n    updateSettings({\n      slides: settings.slides.filter(slide => slide.id !== slideId)\n    });\n  };\n\n  const moveSlide = (fromIndex: number, toIndex: number) => {\n    const newSlides = [...settings.slides];\n    const [movedSlide] = newSlides.splice(fromIndex, 1);\n    newSlides.splice(toIndex, 0, movedSlide);\n    \n    updateSettings({ slides: newSlides });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h3 className=\"text-lg font-medium mb-2\">Berichten beheren</h3>\n        <p className=\"text-sm text-gray-600\">\n          Maak berichten aan, pas de styling aan en bepaal de volgorde\n        </p>\n      </div>\n\n      <div className=\"space-y-4\">\n        {settings.slides.map((slide, index) => (\n          <Card key={slide.id} className=\"relative\">\n            <CardHeader className=\"pb-3\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <GripVertical className=\"h-4 w-4 text-gray-400 cursor-move\" />\n                  <CardTitle className=\"text-base\">Bericht {index + 1}</CardTitle>\n                  <Badge variant={slide.active ? \"default\" : \"secondary\"}>\n                    {slide.active ? \"Actief\" : \"Inactief\"}\n                  </Badge>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  {/* Volgorde knoppen */}\n                  {settings.slides.length > 1 && (\n                    <>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => moveSlide(index, index - 1)}\n                        disabled={index === 0}\n                        data-testid={`move-up-${slide.id}`}\n                        title=\"Omhoog\"\n                      >\n                        <ChevronUp className=\"h-4 w-4\" />\n                      </Button>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => moveSlide(index, index + 1)}\n                        disabled={index === settings.slides.length - 1}\n                        data-testid={`move-down-${slide.id}`}\n                        title=\"Omlaag\"\n                      >\n                        <ChevronDown className=\"h-4 w-4\" />\n                      </Button>\n                    </>\n                  )}\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPreviewSlide(previewSlide === slide.id ? null : slide.id)}\n                    data-testid={`preview-slide-${slide.id}`}\n                  >\n                    {previewSlide === slide.id ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                  </Button>\n                  {settings.slides.length > 1 && (\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => deleteSlide(slide.id)}\n                      data-testid={`delete-slide-${slide.id}`}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </CardHeader>\n            \n            <CardContent className=\"space-y-4\">\n              {/* Bericht inhoud */}\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n                <div className=\"space-y-4\">\n                  <div>\n                    <Label htmlFor={`title-${slide.id}`}>Titel *</Label>\n                    <Input\n                      id={`title-${slide.id}`}\n                      value={slide.title}\n                      onChange={(e) => updateSlide(slide.id, { title: e.target.value })}\n                      placeholder=\"Titel van het bericht\"\n                      data-testid={`input-slide-title-${slide.id}`}\n                    />\n                  </div>\n\n                  <div>\n                    <Label htmlFor={`subtitle-${slide.id}`}>Ondertitel</Label>\n                    <Input\n                      id={`subtitle-${slide.id}`}\n                      value={slide.subtitle || ''}\n                      onChange={(e) => updateSlide(slide.id, { subtitle: e.target.value })}\n                      placeholder=\"Ondertitel (optioneel)\"\n                      data-testid={`input-slide-subtitle-${slide.id}`}\n                    />\n                  </div>\n\n                  <div>\n                    <Label htmlFor={`body-${slide.id}`}>Tekst</Label>\n                    <Textarea\n                      id={`body-${slide.id}`}\n                      value={slide.body || ''}\n                      onChange={(e) => updateSlide(slide.id, { body: e.target.value })}\n                      placeholder=\"Bericht tekst (optioneel)&#10;Gebruik Enter voor nieuwe regels\"\n                      rows={3}\n                      data-testid={`textarea-slide-body-${slide.id}`}\n                    />\n                  </div>\n\n                  <div>\n                    <Label htmlFor={`duration-${slide.id}`}>Duur (seconden)</Label>\n                    <Input\n                      id={`duration-${slide.id}`}\n                      type=\"number\"\n                      value={slide.durationSec}\n                      onChange={(e) => updateSlide(slide.id, { durationSec: parseInt(e.target.value) || 10 })}\n                      min=\"1\"\n                      max=\"60\"\n                      data-testid={`input-slide-duration-${slide.id}`}\n                    />\n                  </div>\n                </div>\n\n                {/* Styling */}\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium\">Styling</h4>\n                  \n                  {/* Titel styling */}\n                  <div className=\"space-y-3 p-3 border rounded-lg\">\n                    <h5 className=\"text-sm font-medium\">Titel</h5>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div>\n                        <Label className=\"text-xs\">Grootte</Label>\n                        <Input\n                          type=\"number\"\n                          value={slide.styling?.titleFontSize || 32}\n                          onChange={(e) => updateSlideStyle(slide.id, 'titleFontSize', parseInt(e.target.value))}\n                          min=\"12\"\n                          max=\"72\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Gewicht</Label>\n                        <Select \n                          value={slide.styling?.titleFontWeight || 'bold'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'titleFontWeight', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontWeights.map(weight => (\n                              <SelectItem key={weight.value} value={weight.value}>\n                                {weight.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Font</Label>\n                        <Select \n                          value={slide.styling?.titleFontFamily || 'Poppins'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'titleFontFamily', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontFamilies.map(font => (\n                              <SelectItem key={font.value} value={font.value}>\n                                {font.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Kleur</Label>\n                        <ColorPicker\n                          value={slide.styling?.titleColor || '#1f2937'}\n                          onChange={(color) => updateSlideStyle(slide.id, 'titleColor', color)}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Ondertitel styling */}\n                  <div className=\"space-y-3 p-3 border rounded-lg\">\n                    <h5 className=\"text-sm font-medium\">Ondertitel</h5>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div>\n                        <Label className=\"text-xs\">Grootte</Label>\n                        <Input\n                          type=\"number\"\n                          value={slide.styling?.subtitleFontSize || 20}\n                          onChange={(e) => updateSlideStyle(slide.id, 'subtitleFontSize', parseInt(e.target.value))}\n                          min=\"12\"\n                          max=\"48\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Gewicht</Label>\n                        <Select \n                          value={slide.styling?.subtitleFontWeight || 'normal'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'subtitleFontWeight', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontWeights.map(weight => (\n                              <SelectItem key={weight.value} value={weight.value}>\n                                {weight.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Font</Label>\n                        <Select \n                          value={slide.styling?.subtitleFontFamily || 'Poppins'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'subtitleFontFamily', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontFamilies.map(font => (\n                              <SelectItem key={font.value} value={font.value}>\n                                {font.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Kleur</Label>\n                        <ColorPicker\n                          value={slide.styling?.subtitleColor || '#6b7280'}\n                          onChange={(color) => updateSlideStyle(slide.id, 'subtitleColor', color)}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Tekst styling */}\n                  <div className=\"space-y-3 p-3 border rounded-lg\">\n                    <h5 className=\"text-sm font-medium\">Tekst</h5>\n                    <div className=\"grid grid-cols-2 gap-3\">\n                      <div>\n                        <Label className=\"text-xs\">Grootte</Label>\n                        <Input\n                          type=\"number\"\n                          value={slide.styling?.bodyFontSize || 18}\n                          onChange={(e) => updateSlideStyle(slide.id, 'bodyFontSize', parseInt(e.target.value))}\n                          min=\"12\"\n                          max=\"48\"\n                        />\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Gewicht</Label>\n                        <Select \n                          value={slide.styling?.bodyFontWeight || 'normal'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'bodyFontWeight', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontWeights.map(weight => (\n                              <SelectItem key={weight.value} value={weight.value}>\n                                {weight.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Font</Label>\n                        <Select \n                          value={slide.styling?.bodyFontFamily || 'Poppins'} \n                          onValueChange={(value) => updateSlideStyle(slide.id, 'bodyFontFamily', value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {fontFamilies.map(font => (\n                              <SelectItem key={font.value} value={font.value}>\n                                {font.label}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      <div>\n                        <Label className=\"text-xs\">Kleur</Label>\n                        <ColorPicker\n                          value={slide.styling?.bodyColor || '#374151'}\n                          onChange={(color) => updateSlideStyle(slide.id, 'bodyColor', color)}\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Achtergrond */}\n                  <div className=\"space-y-3 p-3 border rounded-lg\">\n                    <h5 className=\"text-sm font-medium\">Achtergrond</h5>\n                    <div>\n                      <Label className=\"text-xs\">Kleur</Label>\n                      <ColorPicker\n                        value={slide.styling?.backgroundColor || '#ffffff'}\n                        onChange={(color) => updateSlideStyle(slide.id, 'backgroundColor', color)}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Preview */}\n              {previewSlide === slide.id && (\n                <div className=\"mt-4 p-6 border rounded-lg\" style={{ backgroundColor: slide.styling?.backgroundColor || '#ffffff' }}>\n                  <div className=\"text-center space-y-3\">\n                    <h3\n                      style={{\n                        fontSize: `${slide.styling?.titleFontSize || 32}px`,\n                        fontFamily: slide.styling?.titleFontFamily || 'Poppins',\n                        fontWeight: slide.styling?.titleFontWeight || 'bold',\n                        color: slide.styling?.titleColor || '#1f2937',\n                        margin: 0,\n                        marginBottom: slide.subtitle ? '8px' : '16px'\n                      }}\n                    >\n                      {slide.title}\n                    </h3>\n                    {slide.subtitle && (\n                      <h4\n                        style={{\n                          fontSize: `${slide.styling?.subtitleFontSize || 20}px`,\n                          fontFamily: slide.styling?.subtitleFontFamily || 'Poppins',\n                          fontWeight: slide.styling?.subtitleFontWeight || 'normal',\n                          color: slide.styling?.subtitleColor || '#6b7280',\n                          margin: 0,\n                          marginBottom: '16px'\n                        }}\n                      >\n                        {slide.subtitle}\n                      </h4>\n                    )}\n                    {slide.body && (\n                      <p\n                        className=\"whitespace-pre-line\"\n                        style={{\n                          fontSize: `${slide.styling?.bodyFontSize || 18}px`,\n                          fontFamily: slide.styling?.bodyFontFamily || 'Poppins',\n                          fontWeight: slide.styling?.bodyFontWeight || 'normal',\n                          color: slide.styling?.bodyColor || '#374151',\n                          margin: 0\n                        }}\n                      >\n                        {slide.body}\n                      </p>\n                    )}\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      <Button\n        onClick={addSlide}\n        variant=\"outline\"\n        className=\"w-full\"\n        data-testid=\"add-slide-button\"\n      >\n        <Plus className=\"w-4 h-4 mr-2\" />\n        Nieuw bericht toevoegen\n      </Button>\n\n      {settings.slides.length > 0 && (\n        <div className=\"p-4 bg-blue-50 rounded-lg\">\n          <h4 className=\"font-medium text-blue-900 mb-2\">Berichten overzicht</h4>\n          <div className=\"text-sm text-blue-700 space-y-1\">\n            <p>• Aantal berichten: {settings.slides.length}</p>\n            <p>• Actieve berichten: {settings.slides.filter(s => s.active).length}</p>\n            <p>• Totale duur: {settings.slides.reduce((sum, slide) => sum + slide.durationSec, 0)} seconden</p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":22706},"client/src/components/members/member-import-dialog.tsx":{"content":"\"use client\";\n\nimport { useState, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { FileText, Upload, Download, Check, X, AlertTriangle, FileSpreadsheet, CheckCircle } from \"lucide-react\";\nimport { CiImport } from \"react-icons/ci\";\nimport { MdDownloading } from \"react-icons/md\";\nimport * as XLSX from 'xlsx';\nimport { saveAs } from 'file-saver';\nimport { apiRequest } from '@/lib/queryClient';\n\ninterface MemberImportDialogProps {\n  open: boolean;\n  onClose: () => void;\n  onImport: (members: any[]) => void;\n}\n\ntype ImportStep = 'upload' | 'validation' | 'importing' | 'complete';\n\ninterface CSVRow {\n  [key: string]: string;\n}\n\ninterface ValidationError {\n  row: number;\n  field: string;\n  message: string;\n}\n\n// Excel MIME types\nconst EXCEL_MIME_TYPES = [\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  'application/vnd.ms-excel'\n];\n\n// Template met alle member velden\nconst MEMBER_TEMPLATE_HEADERS = [\n  'Lidnummer*',\n  'Voornaam*', \n  'Achternaam*',\n  'Geslacht*', // M of V\n  'Geboortedatum*', // DD/MM/YYYY\n  'Categorie*', // STUDENT, STANDAARD, SENIOR\n  'E-mail',\n  'Telefoon',\n  'Straat*',\n  'Nummer*',\n  'Postcode*',\n  'Stad*',\n  'Land*',\n  'Betaalmethode*', // SEPA, OVERSCHRIJVING, BANCONTACT, CASH\n  'IBAN',\n  'Betalingsperiode*', // MONTHLY, YEARLY\n  'Actief rol interesse', // JA, NEE\n  'Rol beschrijving',\n  'Stemgerechtigd', // JA, NEE\n  'Privacy akkoord*', // JA\n  'Foto/video toestemming', // JA, NEE\n  'Nieuwsbrief', // JA, NEE\n  'WhatsApp lijst' // JA, NEE\n];\n\nconst FIELD_MAPPING = {\n  'Lidnummer*': 'memberNumber',\n  'Voornaam*': 'firstName',\n  'Achternaam*': 'lastName', \n  'Geslacht*': 'gender',\n  'Geboortedatum*': 'birthDate',\n  'Categorie*': 'category',\n  'E-mail': 'email',\n  'Telefoon': 'phone',\n  'Straat*': 'street',\n  'Nummer*': 'number',\n  'Postcode*': 'postalCode',\n  'Stad*': 'city',\n  'Land*': 'country',\n  'Betaalmethode*': 'paymentMethod',\n  'IBAN': 'iban',\n  'Betalingsperiode*': 'paymentTerm',\n  'Actief rol interesse': 'interestedInActiveRole',\n  'Rol beschrijving': 'roleDescription',\n  'Stemgerechtigd': 'votingEligible',\n  'Privacy akkoord*': 'privacyAgreement',\n  'Foto/video toestemming': 'photoVideoConsent',\n  'Nieuwsbrief': 'newsletterSubscription',\n  'WhatsApp lijst': 'whatsappList'\n};\n\nexport function MemberImportDialog({ open, onClose, onImport }: MemberImportDialogProps) {\n  const [step, setStep] = useState<ImportStep>('upload');\n  const [file, setFile] = useState<File | null>(null);\n  const [csvData, setCsvData] = useState<CSVRow[]>([]);\n  const [headers, setHeaders] = useState<string[]>([]);\n  const [validationErrors, setValidationErrors] = useState<ValidationError[]>([]);\n  const [validMembers, setValidMembers] = useState<any[]>([]);\n  const [importProgress, setImportProgress] = useState(0);\n  const [importedCount, setImportedCount] = useState(0);\n  const [duplicateWarnings, setDuplicateWarnings] = useState<string[]>([]);\n  const [duplicateCheckResults, setDuplicateCheckResults] = useState<any[]>([]);\n  const [showDuplicateConfirmation, setShowDuplicateConfirmation] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleClose = () => {\n    setStep('upload');\n    setFile(null);\n    setCsvData([]);\n    setHeaders([]);\n    setValidationErrors([]);\n    setValidMembers([]);\n    setImportProgress(0);\n    setImportedCount(0);\n    setDuplicateWarnings([]);\n    setDuplicateCheckResults([]);\n    setShowDuplicateConfirmation(false);\n    onClose();\n  };\n\n  const downloadTemplate = (format: 'csv' | 'excel' = 'csv') => {\n    if (format === 'excel') {\n      downloadExcelTemplate();\n    } else {\n      downloadCSVTemplate();\n    }\n  };\n\n  const downloadCSVTemplate = () => {\n    const csvContent = MEMBER_TEMPLATE_HEADERS.join(',') + '\\n';\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = 'leden_import_template.csv';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  };\n\n  const downloadSyntaxGuide = () => {\n    const guideContent = `SYNTAX HANDLEIDING - LEDEN IMPORT\n==================================\n\nDeze handleiding legt uit welke waarden acceptabel zijn voor elk veld in de leden import.\n\nVERPLICHTE VELDEN (*)\n=====================\n\nLidnummer*\n- Format: Uniek nummer\n- Voorbeeld: 0001, 0002, 0003\n- Moet uniek zijn\n\nVoornaam*\n- Format: Tekst\n- Voorbeeld: Ahmed, Fatima, Mohamed\n- Minimaal 2 karakters\n\nAchternaam*\n- Format: Tekst\n- Voorbeeld: Hassan, Al-Rashid, Van den Berg\n- Minimaal 2 karakters\n\nGeslacht*\n- Toegestane waarden: M, V\n- M = Man, V = Vrouw\n- Hoofdlettergevoelig\n\nGeboortedatum*\n- Format: DD/MM/YYYY\n- Voorbeeld: 15/03/1980, 01/12/1995\n- Moet geldige datum zijn\n\nCategorie*\n- Toegestane waarden: STUDENT, STANDAARD, SENIOR\n- STUDENT = Voor studenten\n- STANDAARD = Regulier lidmaatschap\n- SENIOR = Voor senioren\n\nStraat*\n- Format: Tekst\n- Voorbeeld: Kerkstraat, Avenue Louise\n- Minimaal 2 karakters\n\nNummer*\n- Format: Tekst/nummer\n- Voorbeeld: 25, 12A, 100 bus 3\n- Mag niet leeg zijn\n\nPostcode*\n- Format: 4 cijfers (België)\n- Voorbeeld: 1000, 2000, 3000\n\nStad*\n- Format: Tekst\n- Voorbeeld: Brussel, Antwerpen, Gent\n- Minimaal 2 karakters\n\nLand*\n- Format: Tekst\n- Voorbeeld: België, Nederland, Frankrijk\n- Minimaal 2 karakters\n\nBetaalmethode*\n- Toegestane waarden: SEPA, OVERSCHRIJVING, BANCONTACT, CASH\n- SEPA = Automatische incasso (vereist IBAN)\n- OVERSCHRIJVING = Handmatige bankoverschrijving\n- BANCONTACT = Bancontact betaling\n- CASH = Contante betaling\n\nBetalingsperiode*\n- Toegestane waarden: MONTHLY, YEARLY\n- MONTHLY = Maandelijkse betaling\n- YEARLY = Jaarlijkse betaling\n\nPrivacy akkoord*\n- Toegestane waarden: JA\n- Moet altijd JA zijn (verplicht)\n\nOPTIONELE VELDEN\n================\n\nE-mail\n- Format: geldig e-mailadres\n- Voorbeeld: naam@voorbeeld.com\n- Mag leeg blijven\n\nTelefoon\n- Format: telefoonnummer\n- Voorbeeld: +32123456789, 0123456789\n- Mag leeg blijven\n\nIBAN\n- Format: Belgisch IBAN\n- Voorbeeld: BE68539007547034\n- Verplicht voor SEPA en OVERSCHRIJVING betalingen\n- Mag leeg voor CASH en BANCONTACT betalingen\n\nActief rol interesse\n- Toegestane waarden: JA, NEE\n- JA = Interesse in actieve rol\n- NEE = Geen interesse\n- Standaard: NEE\n\nRol beschrijving\n- Format: Tekst\n- Voorbeeld: Vrijwilliger evenementen\n- Alleen relevant als \"Actief rol interesse\" = JA\n\nStemgerechtigd\n- Toegestane waarden: JA, NEE\n- JA = Lid is stemgerechtigd\n- NEE = Lid is niet stemgerechtigd\n- Standaard: NEE\n\nFoto/video toestemming\n- Toegestane waarden: JA, NEE\n- JA = Toestemming gegeven\n- NEE = Geen toestemming\n- Standaard: NEE\n\nNieuwsbrief\n- Toegestane waarden: JA, NEE\n- JA = Aangemeld voor nieuwsbrief\n- NEE = Niet aangemeld\n- Standaard: NEE\n\nWhatsApp lijst\n- Toegestane waarden: JA, NEE\n- JA = Toegevoegd aan WhatsApp lijst\n- NEE = Niet toegevoegd\n- Standaard: NEE\n\nBELANGRIJKE OPMERKINGEN\n=======================\n\n1. Alle JA/NEE waarden zijn hoofdlettergevoelig\n2. Datums moeten exact DD/MM/YYYY format hebben\n3. Lege velden voor optionele kolommen zijn toegestaan\n4. IBAN is verplicht voor SEPA betalingen\n5. Lidnummers moeten uniek zijn binnen de organisatie\n6. Bij duplicaten krijgt het nieuwe lid automatisch een uniek nummer\n\nVOORBEELD RIJ\n=============\n001,Ahmed,Hassan,M,15/03/1980,STANDAARD,ahmed@email.com,+32123456789,Kerkstraat,25,1000,Brussel,België,SEPA,BE68539007547034,MONTHLY,NEE,,NEE,JA,JA,JA,NEE\n\nVoor meer hulp: raadpleeg de Excel template met voorbeelden.`;\n\n    const blob = new Blob([guideContent], { type: 'text/plain;charset=utf-8' });\n    saveAs(blob, 'syntax-handleiding-leden-import.txt');\n  };\n\n  const downloadExcelTemplate = () => {\n    // Voorbeelddata voor Excel template\n    const exampleData = [\n      '001', 'Ahmed', 'Hassan', 'M', '15/03/1980', 'STANDAARD', 'ahmed@email.com', '+32123456789',\n      'Kerkstraat', '25', '1000', 'Brussel', 'België', 'SEPA', 'BE68539007547034', 'MONTHLY',\n      'NEE', '', 'JA', 'JA', 'JA', 'NEE'\n    ];\n\n    const workbook = XLSX.utils.book_new();\n    \n    // Maak werkblad met headers en voorbeelddata\n    const worksheet = XLSX.utils.aoa_to_sheet([\n      MEMBER_TEMPLATE_HEADERS,\n      exampleData\n    ]);\n    \n    // Voeg werkblad toe aan workbook\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Leden');\n    \n    // Genereer Excel bestand en download\n    const excelBuffer = XLSX.write(workbook, { bookType: 'xlsx', type: 'array' });\n    const blob = new Blob([excelBuffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n    saveAs(blob, 'leden-template.xlsx');\n  };\n\n  const parseCSV = (content: string): { headers: string[], rows: CSVRow[] } => {\n    const lines = content.split('\\n').filter(line => line.trim() !== '');\n    const headers = lines[0].split(',').map(h => h.trim());\n    const rows = lines.slice(1).map(line => {\n      const values = line.split(',').map(v => v.trim());\n      const row: CSVRow = {};\n      headers.forEach((header, index) => {\n        row[header] = values[index] || '';\n      });\n      return row;\n    });\n    \n    return { headers, rows };\n  };\n\n  const parseExcel = (file: File): Promise<{ headers: string[], rows: CSVRow[] }> => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        try {\n          const data = new Uint8Array(e.target?.result as ArrayBuffer);\n          const workbook = XLSX.read(data, { type: 'array' });\n          \n          // Neem het eerste werkblad\n          const worksheetName = workbook.SheetNames[0];\n          const worksheet = workbook.Sheets[worksheetName];\n          \n          // Converteer naar JSON\n          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 }) as string[][];\n          \n          if (jsonData.length === 0) {\n            reject(new Error('Excel bestand is leeg'));\n            return;\n          }\n          \n          const headers = jsonData[0].map(h => String(h || '').trim());\n          const rows = jsonData.slice(1).map(rowData => {\n            const row: CSVRow = {};\n            headers.forEach((header, index) => {\n              row[header] = String(rowData[index] || '').trim();\n            });\n            return row;\n          });\n          \n          resolve({ headers, rows });\n        } catch (error) {\n          reject(new Error('Fout bij het lezen van Excel bestand: ' + (error as Error).message));\n        }\n      };\n      reader.onerror = () => reject(new Error('Fout bij het lezen van bestand'));\n      reader.readAsArrayBuffer(file);\n    });\n  };\n\n  const isExcelFile = (file: File): boolean => {\n    const fileName = file.name.toLowerCase();\n    return fileName.endsWith('.xlsx') || fileName.endsWith('.xls') || \n           EXCEL_MIME_TYPES.includes(file.type);\n  };\n\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const uploadedFile = event.target.files?.[0];\n    if (!uploadedFile) return;\n\n    const isCSV = uploadedFile.name.toLowerCase().endsWith('.csv');\n    const isExcel = isExcelFile(uploadedFile);\n\n    if (!isCSV && !isExcel) {\n      alert('Alleen CSV en Excel bestanden (.csv, .xlsx, .xls) zijn toegestaan');\n      return;\n    }\n\n    setFile(uploadedFile);\n    \n    try {\n      let headers: string[];\n      let rows: CSVRow[];\n\n      if (isExcel) {\n        const result = await parseExcel(uploadedFile);\n        headers = result.headers;\n        rows = result.rows;\n      } else {\n        const content = await uploadedFile.text();\n        const result = parseCSV(content);\n        headers = result.headers;\n        rows = result.rows;\n      }\n      \n      setHeaders(headers);\n      setCsvData(rows);\n      setStep('validation');\n      \n      // Start validatie direct\n      validateData(rows);\n    } catch (error) {\n      console.error('Error parsing file:', error);\n      alert('Fout bij het lezen van het bestand: ' + (error as Error).message);\n    }\n  };\n\n  const validateData = (rows: CSVRow[]) => {\n    const errors: ValidationError[] = [];\n    const validMembers: any[] = [];\n\n    rows.forEach((row, index) => {\n      const member: any = {\n        financialSettings: {},\n        organization: {},\n        permissions: {}\n      };\n\n      // Required fields validation\n      const requiredFields = [\n        { csvKey: 'Lidnummer*', memberKey: 'memberNumber' },\n        { csvKey: 'Voornaam*', memberKey: 'firstName' },\n        { csvKey: 'Achternaam*', memberKey: 'lastName' },\n        { csvKey: 'Geslacht*', memberKey: 'gender' },\n        { csvKey: 'Geboortedatum*', memberKey: 'birthDate' },\n        { csvKey: 'Categorie*', memberKey: 'category' },\n        { csvKey: 'Straat*', memberKey: 'street' },\n        { csvKey: 'Nummer*', memberKey: 'number' },\n        { csvKey: 'Postcode*', memberKey: 'postalCode' },\n        { csvKey: 'Stad*', memberKey: 'city' },\n        { csvKey: 'Land*', memberKey: 'country' },\n        { csvKey: 'Betaalmethode*', memberKey: 'paymentMethod' },\n        { csvKey: 'Betalingsperiode*', memberKey: 'paymentTerm' },\n        { csvKey: 'Privacy akkoord*', memberKey: 'privacyAgreement' }\n      ];\n\n      requiredFields.forEach(({ csvKey, memberKey }) => {\n        if (!row[csvKey] || row[csvKey].trim() === '') {\n          errors.push({\n            row: index + 1,\n            field: csvKey,\n            message: `${csvKey} is verplicht`\n          });\n        }\n      });\n\n      // Parse basic fields\n      member.memberNumber = row['Lidnummer*'];\n      member.firstName = row['Voornaam*'];\n      member.lastName = row['Achternaam*'];\n      \n      // Gender validation\n      const gender = row['Geslacht*']?.toUpperCase();\n      if (gender && !['M', 'V'].includes(gender)) {\n        errors.push({\n          row: index + 1,\n          field: 'Geslacht*',\n          message: 'Geslacht moet M of V zijn'\n        });\n      } else {\n        member.gender = gender;\n      }\n\n      // Birth date validation\n      const birthDateStr = row['Geboortedatum*'];\n      if (birthDateStr) {\n        const dateRegex = /^(\\d{2})\\/(\\d{2})\\/(\\d{4})$/;\n        const match = birthDateStr.match(dateRegex);\n        if (match) {\n          const [, day, month, year] = match;\n          const date = new Date(parseInt(year), parseInt(month) - 1, parseInt(day));\n          if (date.getDate() === parseInt(day) && date.getMonth() === parseInt(month) - 1) {\n            member.birthDate = date;\n          } else {\n            errors.push({\n              row: index + 1,\n              field: 'Geboortedatum*',\n              message: 'Ongeldige datum'\n            });\n          }\n        } else {\n          errors.push({\n            row: index + 1,\n            field: 'Geboortedatum*',\n            message: 'Datum moet DD/MM/YYYY formaat hebben'\n          });\n        }\n      }\n\n      // Category validation\n      const category = row['Categorie*']?.toUpperCase();\n      if (category && !['STUDENT', 'STANDAARD', 'SENIOR'].includes(category)) {\n        errors.push({\n          row: index + 1,\n          field: 'Categorie*',\n          message: 'Categorie moet STUDENT, STANDAARD of SENIOR zijn'\n        });\n      } else {\n        member.category = category;\n      }\n\n      // Email validation\n      const email = row['E-mail'];\n      if (email && email.trim() !== '') {\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(email)) {\n          errors.push({\n            row: index + 1,\n            field: 'E-mail',\n            message: 'Ongeldig e-mailadres'\n          });\n        } else {\n          member.email = email;\n        }\n      }\n\n      // Address fields\n      member.phone = row['Telefoon'] || '';\n      member.street = row['Straat*'];\n      member.number = row['Nummer*'];\n      member.postalCode = row['Postcode*'];\n      member.city = row['Stad*'];\n      member.country = row['Land*'] || 'België';\n\n      // Payment method validation\n      const paymentMethod = row['Betaalmethode*']?.toUpperCase();\n      if (paymentMethod && !['SEPA', 'OVERSCHRIJVING', 'BANCONTACT', 'CASH'].includes(paymentMethod)) {\n        errors.push({\n          row: index + 1,\n          field: 'Betaalmethode*',\n          message: 'Betaalmethode moet SEPA, OVERSCHRIJVING, BANCONTACT of CASH zijn'\n        });\n      } else {\n        member.financialSettings.paymentMethod = paymentMethod;\n      }\n\n      // IBAN validation for non-cash payments\n      const iban = row['IBAN'];\n      if (paymentMethod !== 'CASH' && (!iban || iban.trim() === '')) {\n        errors.push({\n          row: index + 1,\n          field: 'IBAN',\n          message: 'IBAN is verplicht voor alle betaalmethoden behalve contant'\n        });\n      } else if (iban) {\n        member.financialSettings.iban = iban;\n      }\n\n      // Payment term validation\n      const paymentTerm = row['Betalingsperiode*']?.toUpperCase();\n      if (paymentTerm && !['MONTHLY', 'YEARLY'].includes(paymentTerm)) {\n        errors.push({\n          row: index + 1,\n          field: 'Betalingsperiode*',\n          message: 'Betalingsperiode moet MONTHLY of YEARLY zijn'\n        });\n      } else {\n        member.financialSettings.paymentTerm = paymentTerm;\n      }\n\n      // Organization/Permission fields\n      const roleInterest = row['Actief rol interesse']?.toUpperCase();\n      member.permissions.interestedInActiveRole = roleInterest === 'JA';\n      member.permissions.roleDescription = row['Rol beschrijving'] || '';\n\n      const votingEligible = row['Stemgerechtigd']?.toUpperCase();\n      member.permissions.votingEligible = votingEligible === 'JA';\n\n      // Permissions\n      const privacyAgreement = row['Privacy akkoord*']?.toUpperCase();\n      if (privacyAgreement !== 'JA') {\n        errors.push({\n          row: index + 1,\n          field: 'Privacy akkoord*',\n          message: 'Privacy akkoord moet JA zijn'\n        });\n      } else {\n        member.permissions.privacyAgreement = true;\n      }\n\n      const photoConsent = row['Foto/video toestemming']?.toUpperCase();\n      member.permissions.photoVideoConsent = photoConsent === 'JA';\n\n      const newsletter = row['Nieuwsbrief']?.toUpperCase();\n      member.permissions.newsletterSubscription = newsletter === 'JA';\n\n      const whatsapp = row['WhatsApp lijst']?.toUpperCase();\n      member.permissions.whatsappList = whatsapp === 'JA';\n\n      // Only add to valid members if no errors for this row\n      const rowErrors = errors.filter(e => e.row === index + 1);\n      if (rowErrors.length === 0) {\n        // Restructure member object to match expected API format\n        const structuredMember = {\n          memberNumber: member.memberNumber,\n          firstName: member.firstName,\n          lastName: member.lastName,\n          gender: member.gender,\n          birthDate: member.birthDate,\n          category: member.category,\n          email: member.email || \"\",\n          phone: member.phone || \"\",\n          street: member.street,\n          number: member.number,\n          postalCode: member.postalCode,\n          city: member.city,\n          country: member.country,\n          financialSettings: {\n            paymentMethod: member.financialSettings.paymentMethod,\n            paymentTerm: member.financialSettings.paymentTerm,\n            iban: member.financialSettings.iban || \"\",\n          },\n          organization: {\n            interestedInActiveRole: member.permissions.interestedInActiveRole,\n            roleDescription: member.permissions.roleDescription || \"\",\n            votingEligible: member.permissions.votingEligible || false,\n          },\n          permissions: {\n            privacyAgreement: member.permissions.privacyAgreement,\n            photoVideoConsent: member.permissions.photoVideoConsent,\n            newsletterSubscription: member.permissions.newsletterSubscription,\n            whatsappList: member.permissions.whatsappList,\n            interestedInActiveRole: member.permissions.interestedInActiveRole,\n            roleDescription: member.permissions.roleDescription || \"\",\n          }\n        };\n        validMembers.push(structuredMember);\n      }\n    });\n\n    setValidationErrors(errors);\n    setValidMembers(validMembers);\n  };\n\n  const checkForDuplicates = async (memberData: any) => {\n    try {\n      const response = await apiRequest('POST', '/api/members/check-duplicates', memberData);\n      return await response.json();\n    } catch (error) {\n      console.error('Error checking duplicates:', error);\n      return { hasDuplicates: false };\n    }\n  };\n\n  const checkDuplicatesBeforeImport = async () => {\n    if (validMembers.length === 0) return;\n\n    const duplicateResults = [];\n    \n    // Check for duplicates for all members\n    for (let i = 0; i < validMembers.length; i++) {\n      const member = validMembers[i];\n      const duplicateCheck = await checkForDuplicates(member);\n      \n      duplicateResults.push({\n        member,\n        duplicateCheck,\n        index: i\n      });\n    }\n\n    const duplicates = duplicateResults.filter(result => result.duplicateCheck.hasDuplicates);\n    \n    if (duplicates.length > 0) {\n      setDuplicateCheckResults(duplicates);\n      setShowDuplicateConfirmation(true);\n      // STOP de import - gebruiker moet eerst bevestigen\n      return;\n    } else {\n      // No duplicates, proceed with import\n      proceedWithImport(validMembers);\n    }\n  };\n\n  const proceedWithImport = async (membersToImport: any[]) => {\n    setShowDuplicateConfirmation(false);\n    setImportProgress(0);\n    setImportedCount(0);\n\n    try {\n      const finalMembers = [];\n      const warnings = [];\n      \n      // Process members and handle number duplicates\n      for (const member of membersToImport) {\n        const duplicateCheck = await checkForDuplicates(member);\n        \n        if (duplicateCheck.hasDuplicates && duplicateCheck.duplicateNumber && !duplicateCheck.duplicateNameAddress) {\n          // Only number duplicate - replace with suggested number\n          member.memberNumber = duplicateCheck.suggestedNumber;\n          warnings.push(`Dubbel lidnummer gedetecteerd. Vervangen door uniek lidnummer: ${duplicateCheck.suggestedNumber}`);\n        }\n        \n        finalMembers.push(member);\n      }\n\n      // Actually import the members\n      onImport(finalMembers);\n      setImportedCount(finalMembers.length);\n      setDuplicateWarnings(warnings);\n      setStep('complete');\n    } catch (error) {\n      console.error('Import error:', error);\n      setDuplicateWarnings(['Fout bij het importeren van leden']);\n    }\n  };\n\n  const handleImport = () => {\n    // Start duplicaat controle wanneer gebruiker expliciet op Importeren klikt\n    checkDuplicatesBeforeImport();\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-6xl max-h-[90vh] flex flex-col\">\n        <DialogHeader>\n          <DialogTitle>Leden Importeren</DialogTitle>\n          <DialogDescription>Import leden via Excel bestand. Download eerst een template om het juiste formaat te gebruiken.</DialogDescription>\n        </DialogHeader>\n\n        <Tabs value={step} className=\"w-full flex-1 flex flex-col\">\n          <TabsList className=\"grid w-full grid-cols-4\">\n            <TabsTrigger value=\"upload\" className=\"text-xs\">Upload</TabsTrigger>\n            <TabsTrigger value=\"validation\" className=\"text-xs\">Validatie</TabsTrigger>\n            <TabsTrigger value=\"importing\" className=\"text-xs\">Importeren</TabsTrigger>\n            <TabsTrigger value=\"complete\" className=\"text-xs\">Voltooid</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"upload\" className=\"space-y-4\">\n            <div className=\"space-y-4\">\n              <div>\n                <Label className=\"text-base font-medium\">Download Template</Label>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  Download eerst een template met alle benodigde velden en voorbeelden\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button onClick={() => downloadTemplate('excel')} variant=\"outline\" className=\"gap-2\">\n                    <FileSpreadsheet className=\"h-4 w-4\" />\n                    Excel Template\n                  </Button>\n                  <Button onClick={() => downloadSyntaxGuide()} variant=\"outline\" className=\"gap-2\">\n                    <MdDownloading className=\"h-4 w-4\" />\n                    Syntax Handleiding\n                  </Button>\n                </div>\n              </div>\n\n              <div className=\"border-t pt-4\">\n                <Label className=\"text-base font-medium\">Upload CSV of Excel Bestand</Label>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  Sleep een CSV of Excel bestand hieronder of klik om een bestand te selecteren\n                </p>\n                \n                <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center\">\n                  <CiImport className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                  <div className=\"space-y-2\">\n                    <p className=\"text-lg font-medium\">Sleep een Excel bestand hierheen</p>\n                    <p className=\"text-gray-600\">of klik om een bestand te selecteren</p>\n                    <Input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".csv,.xlsx,.xls\"\n                      onChange={handleFileUpload}\n                      className=\"hidden\"\n                    />\n                    <Button \n                      onClick={() => fileInputRef.current?.click()}\n                      className=\"gap-2\"\n                    >\n                      <Upload className=\"h-4 w-4\" />\n                      Bestand selecteren\n                    </Button>\n                  </div>\n                </div>\n\n                {file && (\n                  <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\n                    <div className=\"flex items-center gap-2\">\n                      <FileText className=\"h-5 w-5 text-blue-600\" />\n                      <span className=\"font-medium\">{file.name}</span>\n                      <span className=\"text-sm text-gray-500\">\n                        ({Math.round(file.size / 1024)} KB)\n                      </span>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"validation\" className=\"space-y-4\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h3 className=\"text-lg font-semibold\">Syntax Validatie</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    {csvData.length} rijen gevonden, {validMembers.length} geldig, {validationErrors.length} syntax fouten\n                  </p>\n                </div>\n              </div>\n\n              {/* Eerste rij preview */}\n              {csvData.length > 0 && (\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-medium\">Voorbeeld van eerste rij data:</h4>\n                  <div className=\"bg-gray-50 p-3 rounded border text-sm\">\n                    <div className=\"grid grid-cols-2 gap-2\">\n                      {Object.entries(csvData[0]).slice(0, 8).map(([key, value]) => (\n                        <div key={key}>\n                          <span className=\"font-medium\">{key}:</span> {value || '(leeg)'}\n                        </div>\n                      ))}\n                    </div>\n                    {Object.keys(csvData[0]).length > 8 && (\n                      <div className=\"mt-2 text-gray-500\">\n                        ... en {Object.keys(csvData[0]).length - 8} andere velden\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {validationErrors.length > 0 && (\n                <Alert className=\"border-red-200 bg-red-50\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  <AlertDescription>\n                    <div className=\"font-medium text-red-800 mb-2\">\n                      {validationErrors.length} validatiefouten gevonden:\n                    </div>\n                    <div className=\"max-h-32 overflow-y-auto space-y-1\">\n                      {validationErrors.slice(0, 10).map((error, index) => (\n                        <div key={index} className=\"text-sm text-red-700\">\n                          Rij {error.row}, {error.field}: {error.message}\n                        </div>\n                      ))}\n                      {validationErrors.length > 10 && (\n                        <div className=\"text-sm text-red-700\">\n                          ... en {validationErrors.length - 10} andere fouten\n                        </div>\n                      )}\n                    </div>\n                  </AlertDescription>\n                </Alert>\n              )}\n\n              {validationErrors.length === 0 && validMembers.length > 0 && (\n                <div className=\"space-y-2\">\n                  <Alert className=\"border-green-200 bg-green-50\">\n                    <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                    <AlertDescription className=\"text-green-800\">\n                      Alle {validMembers.length} rijen hebben geldige syntax. Klik op 'Volgende' om door te gaan naar de import stap.\n                    </AlertDescription>\n                  </Alert>\n                </div>\n              )}\n            </div>\n\n            <DialogFooter>\n              <Button variant=\"outline\" onClick={handleClose}>\n                Annuleren\n              </Button>\n              <Button \n                onClick={() => setStep('importing')}\n                disabled={validationErrors.length > 0 || validMembers.length === 0}\n                className=\"gap-2\"\n              >\n                Volgende: Importeren\n              </Button>\n            </DialogFooter>\n          </TabsContent>\n\n          <TabsContent value=\"importing\" className=\"space-y-4 flex-1 flex flex-col\">\n            {showDuplicateConfirmation ? (\n              // Show duplicate confirmation\n              (<div className=\"space-y-4\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">\n                    {duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNumber).length > 0 && \n                     duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNameAddress).length > 0 ? (\n                      <>\n                        <span className=\"font-medium\">Duplicates gevonden:</span>\n                        <br />• {duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNumber).length} dubbele lidnummers\n                        <br />• {duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNameAddress).length} leden die al bestaan\n                      </>\n                    ) : duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNumber).length > 0 ? (\n                      <>\n                        <span className=\"font-medium\">Dubbele lidnummers gevonden:</span>\n                        <br />• {duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNumber).length} leden met dubbel lidnummer\n                      </>\n                    ) : (\n                      <>\n                        <span className=\"font-medium\">Bestaande leden gevonden:</span>\n                        <br />• {duplicateCheckResults.filter(result => result.duplicateCheck.duplicateNameAddress).length} leden die al bestaan\n                      </>\n                    )}\n                  </p>\n                </div>\n                {/* Leden die NIET geïmporteerd worden */}\n                {duplicateCheckResults.filter(result => \n                  (result.duplicateCheck.duplicateNumber && result.duplicateCheck.duplicateNameAddress) || \n                  result.duplicateCheck.duplicateNameAddress\n                ).length > 0 && (\n                  <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                    <h4 className=\"font-medium text-red-800 mb-3\">\n                      Leden die NIET worden geïmporteerd:\n                    </h4>\n                    <div className=\"space-y-2\">\n                      {duplicateCheckResults\n                        .filter(result => \n                          (result.duplicateCheck.duplicateNumber && result.duplicateCheck.duplicateNameAddress) || \n                          result.duplicateCheck.duplicateNameAddress\n                        )\n                        .map((result, index) => (\n                          <div key={index} className=\"flex items-start gap-2 text-sm\">\n                            <X className=\"h-4 w-4 mt-0.5 flex-shrink-0 text-red-600\" />\n                            <div className=\"text-red-800\">\n                              <div className=\"font-medium mb-1\">{result.member.firstName} {result.member.lastName}</div>\n                              <div className=\"space-y-1 text-sm\">\n                                {result.duplicateCheck.duplicateNumber && (\n                                  <div>• Lidnummer bestaat al: {result.duplicateCheck.duplicateNumber.memberNumber} \n                                    {result.duplicateCheck.duplicateNameAddress && (\n                                      <span className=\"text-gray-600\"> (zou vervangen worden door nieuw uniek nummer)</span>\n                                    )}\n                                  </div>\n                                )}\n                                {result.duplicateCheck.duplicateNameAddress && (\n                                  <div>• De persoon lijkt al te bestaan met dezelfde gegevens</div>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                    </div>\n                  </div>\n                )}\n                {/* Leden met dubbel lidnummer die WEL geïmporteerd worden */}\n                {duplicateCheckResults.filter(result => \n                  result.duplicateCheck.duplicateNumber && !result.duplicateCheck.duplicateNameAddress\n                ).length > 0 && (\n                  <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\n                    <h4 className=\"font-medium text-amber-800 mb-3\">\n                      Leden met dubbel lidnummer (krijgen nieuw nummer):\n                    </h4>\n                    <div className=\"space-y-2\">\n                      {duplicateCheckResults\n                        .filter(result => result.duplicateCheck.duplicateNumber && !result.duplicateCheck.duplicateNameAddress)\n                        .map((result, index) => (\n                          <div key={index} className=\"flex items-start gap-2 text-sm\">\n                            <AlertTriangle className=\"h-4 w-4 mt-0.5 flex-shrink-0 text-amber-600\" />\n                            <div className=\"text-amber-800\">\n                              <strong>{result.member.firstName} {result.member.lastName}</strong> \n                              <span className=\"text-amber-600\"> - lidnummer {result.member.memberNumber} → {result.duplicateCheck.suggestedNumber}</span>\n                            </div>\n                          </div>\n                        ))}\n                    </div>\n                  </div>\n                )}\n                <DialogFooter>\n                  <Button variant=\"outline\" onClick={() => setShowDuplicateConfirmation(false)}>\n                    Annuleren\n                  </Button>\n                  <Button \n                    onClick={() => {\n                      const membersToImport = validMembers.filter(member => {\n                        const result = duplicateCheckResults.find(r => r.member === member);\n                        return !result || !(result.duplicateCheck.duplicateNumber && result.duplicateCheck.duplicateNameAddress) && !result.duplicateCheck.duplicateNameAddress;\n                      });\n                      proceedWithImport(membersToImport);\n                    }}\n                    disabled={validMembers.filter(member => {\n                      const result = duplicateCheckResults.find(r => r.member === member);\n                      return !result || !(result.duplicateCheck.duplicateNumber && result.duplicateCheck.duplicateNameAddress) && !result.duplicateCheck.duplicateNameAddress;\n                    }).length === 0}\n                    className=\"gap-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed\"\n                  >\n                    {validMembers.filter(member => {\n                      const result = duplicateCheckResults.find(r => r.member === member);\n                      return !result || !(result.duplicateCheck.duplicateNumber && result.duplicateCheck.duplicateNameAddress) && !result.duplicateCheck.duplicateNameAddress;\n                    }).length === 0 ? 'Geen leden om te importeren' : 'Toch Importeren'}\n                  </Button>\n                </DialogFooter>\n              </div>)\n            ) : importProgress === 0 ? (\n              // Preview before import\n              (<div className=\"space-y-4 flex-1 flex flex-col\">\n                <div>\n                  <h3 className=\"text-lg font-semibold\">Import Preview</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    {validMembers.length} rijen klaar voor import. Controleer de gegevens en klik op 'Importeren' om door te gaan.\n                  </p>\n                </div>\n                <div className=\"flex-1 overflow-auto border rounded\">\n                  <div className=\"min-w-max\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          {csvData.length > 0 && Object.keys(csvData[0]).map((header) => (\n                            <TableHead key={header} className=\"whitespace-nowrap min-w-[120px]\">{header}</TableHead>\n                          ))}\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {csvData.slice(0, validMembers.length).map((row, index) => (\n                          <TableRow key={index}>\n                            {Object.entries(row).map(([key, value]) => (\n                              <TableCell key={key} className=\"whitespace-nowrap min-w-[120px] text-sm\">\n                                {value || '-'}\n                              </TableCell>\n                            ))}\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                </div>\n                {validMembers.length !== csvData.length && (\n                  <div className=\"text-sm text-amber-600 bg-amber-50 p-3 rounded border\">\n                    Let op: {csvData.length - validMembers.length} rijen hebben validatiefouten en worden niet geïmporteerd.\n                  </div>\n                )}\n                <DialogFooter>\n                  <Button variant=\"outline\" onClick={() => setStep('validation')}>\n                    Terug\n                  </Button>\n                  <Button \n                    onClick={handleImport}\n                    className=\"gap-2\"\n                  >\n                    <CiImport className=\"h-4 w-4\" />\n                    {validMembers.length} leden importeren\n                  </Button>\n                </DialogFooter>\n              </div>)\n            ) : (\n              // Progress during import\n              (<div className=\"text-center space-y-4\">\n                <div>\n                  <h3 className=\"text-lg font-semibold\">Leden aan het importeren...</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    {importedCount} van {validMembers.length} leden geïmporteerd\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <Progress value={importProgress} className=\"w-full\" />\n                  <p className=\"text-sm text-gray-500\">\n                    {Math.round(importProgress)}% voltooid\n                  </p>\n                </div>\n              </div>)\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"complete\" className=\"space-y-4\">\n            <div className=\"text-center space-y-4\">\n              <div className=\"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center\">\n                <Check className=\"h-8 w-8 text-green-600\" />\n              </div>\n              \n              <div>\n                <h3 className=\"text-lg font-semibold text-green-800\">Import Voltooid!</h3>\n                <p className=\"text-sm text-gray-600\">\n                  {importedCount} leden succesvol geïmporteerd\n                </p>\n              </div>\n            </div>\n\n            {/* Duplicate warnings */}\n            {duplicateWarnings.length > 0 && (\n              <div className=\"space-y-2\">\n                <h4 className=\"font-medium text-amber-800\">Duplicate meldingen:</h4>\n                <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\n                  {duplicateWarnings.map((warning, index) => (\n                    <div key={index} className=\"flex items-start gap-2 text-sm text-amber-800\">\n                      <AlertTriangle className=\"h-4 w-4 mt-0.5 flex-shrink-0\" />\n                      <span>{warning}</span>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            <DialogFooter>\n              <Button onClick={handleClose} className=\"w-full\">\n                Sluiten\n              </Button>\n            </DialogFooter>\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":42555},"client/src/components/public-screens/EditScreenModal.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Save, X } from \"lucide-react\";\nimport { PublicScreen } from \"@/lib/mock/public-screens\";\n\ninterface EditScreenModalProps {\n  screen: PublicScreen | null;\n  open: boolean;\n  onClose: () => void;\n  onSave: (screen: PublicScreen) => void;\n}\n\nexport function EditScreenModal({ screen, open, onClose, onSave }: EditScreenModalProps) {\n  const [name, setName] = useState(\"\");\n  const [active, setActive] = useState(false);\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useEffect(() => {\n    if (screen) {\n      setName(screen.name);\n      setActive(screen.active);\n      setHasChanges(false);\n    }\n  }, [screen]);\n\n  const handleSave = () => {\n    if (!screen) return;\n\n    // Create updated screen object\n    const updatedScreen: PublicScreen = {\n      ...screen,\n      name: name.trim(),\n      active,\n      updatedAt: new Date().toISOString()\n    };\n\n    onSave(updatedScreen);\n    setHasChanges(false);\n  };\n\n  const handleNameChange = (value: string) => {\n    setName(value);\n    setHasChanges(true);\n  };\n\n  const handleActiveChange = (checked: boolean) => {\n    setActive(checked);\n    setHasChanges(true);\n  };\n\n  const handleClose = () => {\n    if (hasChanges) {\n      if (confirm(\"Er zijn niet-opgeslagen wijzigingen. Weet je zeker dat je wilt sluiten?\")) {\n        onClose();\n      }\n    } else {\n      onClose();\n    }\n  };\n\n  if (!screen) return null;\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'LEDENLIJST': return 'Ledenlijst';\n      case 'MEDEDELINGEN': return 'Mededelingen';\n      default: return type;\n    }\n  };\n\n  const publicUrl = `${window.location.origin}/screen/${screen.publicToken || screen.id}`;\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader className=\"pb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <DialogTitle className=\"text-2xl\">Scherm bewerken</DialogTitle>\n              <div className=\"flex items-center gap-2 mt-2\">\n                <Badge variant=\"outline\">{getTypeLabel(screen.type)}</Badge>\n                <Badge \n                  variant={active ? \"default\" : \"secondary\"}\n                  className={active ? \"bg-green-100 text-green-800\" : \"bg-gray-100 text-gray-800\"}\n                >\n                  {active ? \"Actief\" : \"Inactief\"}\n                </Badge>\n              </div>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleClose}\n              className=\"h-8 w-8 p-0\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Basic Settings */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Basis Instellingen</CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"space-y-2\">\n                <Label htmlFor=\"screen-name\">Naam van het scherm</Label>\n                <Input\n                  id=\"screen-name\"\n                  value={name}\n                  onChange={(e) => handleNameChange(e.target.value)}\n                  placeholder=\"Voer een naam in voor dit scherm\"\n                />\n              </div>\n\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label htmlFor=\"screen-active\">Scherm actief</Label>\n                  <p className=\"text-sm text-gray-500\">\n                    Wanneer actief, is het scherm toegankelijk via de publieke URL\n                  </p>\n                </div>\n                <Switch\n                  id=\"screen-active\"\n                  checked={active}\n                  onCheckedChange={handleActiveChange}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Screen Configuration */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Scherm Configuratie</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <Tabs defaultValue=\"basic\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-2\">\n                  <TabsTrigger value=\"basic\">Basis</TabsTrigger>\n                  <TabsTrigger value=\"advanced\">Geavanceerd</TabsTrigger>\n                </TabsList>\n                \n                <TabsContent value=\"basic\" className=\"space-y-4 mt-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Scherm Type</Label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      <Badge variant=\"outline\" className=\"text-sm\">\n                        {getTypeLabel(screen.type)}\n                      </Badge>\n                      <p className=\"text-sm text-gray-500 mt-1\">\n                        Het scherm type kan niet worden gewijzigd na aanmaak\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Publieke URL</Label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      <code className=\"text-sm text-blue-600\">\n                        {publicUrl}\n                      </code>\n                      <p className=\"text-sm text-gray-500 mt-1\">\n                        Deze URL wordt automatisch gegenereerd en kan niet worden gewijzigd\n                      </p>\n                    </div>\n                  </div>\n                </TabsContent>\n\n                <TabsContent value=\"advanced\" className=\"space-y-4 mt-4\">\n                  <div className=\"space-y-2\">\n                    <Label>Token</Label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      <code className=\"text-sm font-mono\">\n                        {screen.publicToken || screen.id}\n                      </code>\n                      <p className=\"text-sm text-gray-500 mt-1\">\n                        Unieke identificator voor dit scherm\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Aangemaakt</Label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      <p className=\"text-sm\">\n                        {new Date(screen.createdAt).toLocaleString('nl-NL')}\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label>Laatst gewijzigd</Label>\n                    <div className=\"p-3 bg-gray-50 rounded border\">\n                      <p className=\"text-sm\">\n                        {new Date(screen.updatedAt).toLocaleString('nl-NL')}\n                      </p>\n                    </div>\n                  </div>\n                </TabsContent>\n              </Tabs>\n            </CardContent>\n          </Card>\n\n          {/* Actions */}\n          <div className=\"flex justify-end gap-3 pt-4 border-t\">\n            <Button\n              variant=\"outline\"\n              onClick={handleClose}\n            >\n              Annuleren\n            </Button>\n            <Button\n              onClick={handleSave}\n              disabled={!hasChanges || !name.trim()}\n              className=\"gap-2\"\n            >\n              <Save className=\"h-4 w-4\" />\n              {hasChanges ? \"Wijzigingen opslaan\" : \"Opgeslagen\"}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":8195},"client/src/components/public-screens/EditScreenDialog.tsx":{"content":"\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { PublicScreen, TitleStyling, LedenlijstConfig, MededelingenConfig } from \"@/lib/mock/public-screens\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ChevronLeft, ChevronRight, Edit } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { DescriptionStep } from \"./wizard/steps/DescriptionStep\";\nimport { StylingStep } from \"./wizard/steps/StylingStep\";\nimport { LedenlijstConfigStep } from \"./wizard/steps/LedenlijstConfigStep\";\nimport { MededelingenMessagesStep } from \"./wizard/steps/MededelingenMessagesStep\";\nimport { MededelingenCarouselStep } from \"./wizard/steps/MededelingenCarouselStep\";\n\ninterface EditScreenDialogProps {\n  screen: PublicScreen | null;\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\ninterface WizardData {\n  name: string;\n  description?: string;\n  title: TitleStyling;\n  subtitle: TitleStyling;\n  ledenlijstSettings?: {\n    useFullNames: boolean;\n    useInitials: boolean;\n    filterByCategories: boolean;\n    showVotingRights: boolean;\n    rowsPerPage: number;\n    year: number;\n    categories: string[];\n  };\n  mededelingenSettings?: {\n    slides: Array<{\n      id: string;\n      title: string;\n      body?: string;\n      mediaUrl?: string;\n      mediaType?: 'image' | 'video';\n      active: boolean;\n      durationSec: number;\n    }>;\n    autoplay: {\n      enabled: boolean;\n      interval: number;\n      order: 'date' | 'manual' | 'shuffle';\n    };\n    style: {\n      textColor: string;\n      backgroundColor: string;\n      maxTextWidth: number;\n    };\n  };\n}\n\nconst defaultTitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 32,\n  fontFamily: \"Poppins\",\n  color: \"#1f2937\",\n  fontWeight: \"bold\"\n};\n\nconst defaultSubtitleStyling: TitleStyling = {\n  text: \"\",\n  fontSize: 18,\n  fontFamily: \"Poppins\", \n  color: \"#6b7280\",\n  fontWeight: \"normal\"\n};\n\nexport function EditScreenDialog({ screen, open, onOpenChange }: EditScreenDialogProps) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [wizardData, setWizardData] = useState<WizardData>({\n    name: \"\",\n    title: { ...defaultTitleStyling },\n    subtitle: { ...defaultSubtitleStyling }\n  });\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  useEffect(() => {\n    if (screen && open) {\n      const config = screen.config;\n      setCurrentStep(0);\n      setWizardData({\n        name: screen.name,\n        description: config.description,\n        title: config.title || { ...defaultTitleStyling },\n        subtitle: config.subtitle || { ...defaultSubtitleStyling },\n        ledenlijstSettings: screen.type === 'LEDENLIJST' ? {\n          useFullNames: (config as LedenlijstConfig).display?.useFullNames ?? true,\n          useInitials: (config as LedenlijstConfig).display?.useInitials ?? false,\n          filterByCategories: (config as LedenlijstConfig).display?.filterByCategories ?? true,\n          showVotingRights: (config as LedenlijstConfig).display?.showVotingRights ?? false,\n          rowsPerPage: (config as LedenlijstConfig).display?.rowsPerPage ?? 20,\n          year: (config as LedenlijstConfig).year ?? new Date().getFullYear(),\n          categories: (config as LedenlijstConfig).categories ?? []\n        } : undefined,\n        mededelingenSettings: screen.type === 'MEDEDELINGEN' ? {\n          slides: (config as MededelingenConfig).slides || [],\n          autoplay: (config as MededelingenConfig).autoplay || {\n            enabled: true,\n            interval: 8,\n            order: 'date'\n          },\n          style: {\n            textColor: (config as MededelingenConfig).style?.textContrast === 'light' ? '#ffffff' : '#000000',\n            backgroundColor: (config as MededelingenConfig).style?.background === 'white' ? '#ffffff' : '#000000',\n            maxTextWidth: (config as MededelingenConfig).style?.maxTextWidth || 800\n          }\n        } : undefined\n      });\n    }\n  }, [screen, open]);\n\n  const getSteps = () => {\n    if (!screen) return [];\n    \n    const baseSteps: Array<{ title: string; component: any }> = [\n      { title: \"Beschrijving\", component: DescriptionStep },\n      { title: \"Opmaak\", component: StylingStep }\n    ];\n    \n    if (screen.type === 'LEDENLIJST') {\n      baseSteps.push({ title: \"Configuratie\", component: LedenlijstConfigStep });\n    } else if (screen.type === 'MEDEDELINGEN') {\n      // Voor mededelingen slaan we de opmaak stap over en gaan direct naar berichten\n      baseSteps.splice(1, 1); // Verwijder de \"Opmaak\" stap\n      baseSteps.push({ title: \"Berichten\", component: MededelingenMessagesStep });\n      baseSteps.push({ title: \"Carrousel\", component: MededelingenCarouselStep });\n    }\n    \n    return baseSteps;\n  };\n\n  const steps = getSteps();\n  const isLastStep = currentStep === steps.length - 1;\n\n  const canGoNext = () => {\n    switch (currentStep) {\n      case 0: return wizardData.name.length > 0;\n      case 1: \n        if (screen?.type === 'MEDEDELINGEN') {\n          // Voor mededelingen is stap 1 de berichten stap\n          return !!wizardData.mededelingenSettings && wizardData.mededelingenSettings.slides.length > 0;\n        } else {\n          // Voor andere types is stap 1 de opmaak stap\n          return wizardData.title && wizardData.title.text && wizardData.title.text.length > 0;\n        }\n      case 2: \n        if (screen?.type === 'LEDENLIJST') return !!wizardData.ledenlijstSettings;\n        if (screen?.type === 'MEDEDELINGEN') {\n          // Voor mededelingen is stap 2 de carrousel stap\n          return !!wizardData.mededelingenSettings?.autoplay;\n        }\n        return true;\n      default: return true;\n    }\n  };\n\n  const handleNext = () => {\n    if (isLastStep) {\n      handleComplete();\n    } else {\n      setCurrentStep(prev => prev + 1);\n    }\n  };\n\n  const handleComplete = async () => {\n    if (!screen) return;\n\n    setIsLoading(true);\n    try {\n      let config: LedenlijstConfig | MededelingenConfig;\n\n      if (screen.type === 'LEDENLIJST') {\n        config = {\n          description: wizardData.description,\n          title: wizardData.title,\n          subtitle: wizardData.subtitle,\n          display: {\n            useFullNames: wizardData.ledenlijstSettings?.useFullNames ?? true,\n            useInitials: wizardData.ledenlijstSettings?.useInitials ?? false,\n            filterByCategories: wizardData.ledenlijstSettings?.filterByCategories ?? true,\n            showVotingRights: wizardData.ledenlijstSettings?.showVotingRights ?? false,\n            rowsPerPage: wizardData.ledenlijstSettings?.rowsPerPage ?? 20\n          },\n          year: wizardData.ledenlijstSettings?.year ?? new Date().getFullYear(),\n          categories: wizardData.ledenlijstSettings?.categories ?? []\n        } as LedenlijstConfig;\n      } else if (screen.type === 'MEDEDELINGEN') {\n        config = {\n          description: wizardData.description,\n          title: wizardData.title,\n          subtitle: wizardData.subtitle,\n          slides: wizardData.mededelingenSettings?.slides || [],\n          autoplay: wizardData.mededelingenSettings?.autoplay || {\n            enabled: true,\n            interval: 8,\n            order: 'date'\n          },\n          style: {\n            textContrast: wizardData.mededelingenSettings?.style.textColor === '#ffffff' ? 'light' : 'dark',\n            background: wizardData.mededelingenSettings?.style.backgroundColor === '#ffffff' ? 'white' : 'black',\n            maxTextWidth: wizardData.mededelingenSettings?.style.maxTextWidth || 800\n          }\n        } as MededelingenConfig;\n      } else {\n        // Fallback\n        config = {\n          description: wizardData.description,\n          title: wizardData.title,\n          subtitle: wizardData.subtitle,\n          display: {\n            useFullNames: true,\n            useInitials: false,\n            filterByCategories: true,\n            showVotingRights: false,\n            rowsPerPage: 20\n          },\n          year: new Date().getFullYear(),\n          categories: []\n        } as LedenlijstConfig;\n      }\n\n      await apiRequest('PATCH', `/api/public-screens/${screen.id}`, {\n        name: wizardData.name,\n        config: config\n      });\n      \n      queryClient.invalidateQueries({ queryKey: [\"/api/public-screens\"] });\n      toast({\n        title: \"Scherm bijgewerkt\",\n        description: `${wizardData.name} is succesvol bijgewerkt.`,\n      });\n      onOpenChange(false);\n    } catch (error: any) {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het bijwerken van het scherm.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'LEDENLIJST': return 'Ledenlijst';\n      case 'MEDEDELINGEN': return 'Mededelingen';\n      case 'MULTIMEDIA': return 'Multimedia';\n      default: return type;\n    }\n  };\n\n  const StepComponent = steps[currentStep]?.component;\n\n  if (!screen) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-6xl h-[95vh] flex flex-col !bg-white\" data-testid=\"edit-screen-dialog\">\n        <DialogHeader className=\"flex-shrink-0 pb-6 border-b border-border\">\n          <DialogTitle className=\"flex items-center gap-3 text-xl\">\n            <Edit className=\"h-6 w-6\" />\n            Scherm bewerken: {steps[currentStep]?.title}\n          </DialogTitle>\n          <DialogDescription className=\"text-base mt-2\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <Badge variant=\"outline\" className=\"h-8\">\n                {getTypeLabel(screen.type)}\n              </Badge>\n              <Badge \n                variant={screen.active ? \"default\" : \"secondary\"}\n                className={screen.active ? \"bg-green-100 text-green-800\" : \"bg-gray-100 text-gray-800\"}\n              >\n                {screen.active ? \"Actief\" : \"Inactief\"}\n              </Badge>\n            </div>\n            {currentStep === 0 && \"Geef je scherm een duidelijke naam en beschrijving\"}\n            {currentStep === 1 && screen.type === 'MEDEDELINGEN' && \"Maak en beheer je berichten\"}\n            {currentStep === 1 && screen.type !== 'MEDEDELINGEN' && \"Pas de titel en ondertitel aan\"}\n            {currentStep === 2 && screen.type === 'MEDEDELINGEN' && \"Stel de carrousel instellingen in\"}\n            {currentStep === 2 && screen.type !== 'MEDEDELINGEN' && \"Configureer de specifieke instellingen\"}\n          </DialogDescription>\n          \n          {/* Progress indicator */}\n          <div className=\"flex items-center gap-4 mt-4\">\n            <div className=\"flex items-center gap-2\">\n              {steps.map((step, index) => (\n                <div key={index} className=\"flex items-center\">\n                  <div className={`flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium transition-colors ${\n                    index < currentStep ? 'bg-primary text-primary-foreground' :\n                    index === currentStep ? 'bg-primary text-primary-foreground' :\n                    'bg-muted text-muted-foreground'\n                  }`}>\n                    {index + 1}\n                  </div>\n                  {index < steps.length - 1 && (\n                    <div className={`w-12 h-px mx-2 transition-colors ${\n                      index < currentStep ? 'bg-primary' : 'bg-muted'\n                    }`} />\n                  )}\n                </div>\n              ))}\n            </div>\n            <Badge variant=\"outline\" className=\"ml-auto\">\n              Stap {currentStep + 1} van {steps.length}\n            </Badge>\n          </div>\n        </DialogHeader>\n\n        {/* Main content area with fixed height */}\n        <div className=\"flex-1 py-6 overflow-y-auto\">\n          {StepComponent && (\n            <StepComponent\n              data={wizardData}\n              onUpdate={setWizardData}\n            />\n          )}\n        </div>\n\n        {/* Fixed footer */}\n        <div className=\"flex-shrink-0 flex justify-between items-center pt-6 border-t border-border\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setCurrentStep(prev => prev - 1)}\n            disabled={currentStep === 0}\n            data-testid=\"wizard-back\"\n            size=\"lg\"\n          >\n            <ChevronLeft className=\"w-4 h-4 mr-2\" />\n            Vorige\n          </Button>\n\n          <div className=\"flex items-center gap-3\">\n            <Button\n              variant=\"ghost\"\n              onClick={() => onOpenChange(false)}\n              data-testid=\"wizard-cancel\"\n            >\n              Annuleren\n            </Button>\n            \n            <Button\n              onClick={handleNext}\n              disabled={!canGoNext() || isLoading}\n              data-testid=\"wizard-next\"\n              size=\"lg\"\n            >\n              {isLoading ? 'Opslaan...' : (isLastStep ? 'Wijzigingen Opslaan' : 'Volgende')}\n              {!isLastStep && !isLoading && <ChevronRight className=\"w-4 h-4 ml-2\" />}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":13457},"client/src/components/ui/CustomTooltip.tsx":{"content":"\"use client\";\n\nimport { useState, useRef, useEffect } from 'react';\n\ninterface CustomTooltipProps {\n  title: string;\n  count: number;\n  percentage: number;\n  color: string;\n  children: React.ReactNode;\n}\n\nexport function CustomTooltip({ title, count, percentage, color, children }: CustomTooltipProps) {\n  const [isVisible, setIsVisible] = useState(false);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const tooltipRef = useRef<HTMLDivElement>(null);\n\n  const handleMouseEnter = (e: React.MouseEvent) => {\n    setIsVisible(true);\n    updatePosition(e);\n  };\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    updatePosition(e);\n  };\n\n  const handleMouseLeave = () => {\n    setIsVisible(false);\n  };\n\n  const updatePosition = (e: React.MouseEvent) => {\n    const rect = e.currentTarget.getBoundingClientRect();\n    const x = e.clientX - rect.left;\n    const y = e.clientY - rect.top;\n    setPosition({ x, y });\n  };\n\n  return (\n    <div className=\"relative\">\n      <div\n        onMouseEnter={handleMouseEnter}\n        onMouseMove={handleMouseMove}\n        onMouseLeave={handleMouseLeave}\n      >\n        {children}\n      </div>\n      \n      {isVisible && (\n        <div\n          ref={tooltipRef}\n          className=\"absolute z-50 pointer-events-none\"\n          style={{\n            left: position.x + 10,\n            top: position.y - 10,\n            transform: 'translateY(-100%)'\n          }}\n        >\n          <div className=\"bg-white border border-gray-200 rounded-lg shadow-lg p-3 min-w-[140px]\">\n            <div className=\"flex items-center gap-2 mb-1\">\n              <div \n                className=\"w-3 h-3 rounded-full flex-shrink-0\" \n                style={{ backgroundColor: color }}\n              />\n              <span className=\"font-medium text-gray-900 text-sm\">{title}</span>\n            </div>\n            <div className=\"space-y-1\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-xs text-gray-500\">Aantal:</span>\n                <span className=\"text-sm font-semibold text-gray-900\">{count}</span>\n              </div>\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-xs text-gray-500\">Percentage:</span>\n                <span className=\"text-sm font-semibold text-gray-900\">{percentage}%</span>\n              </div>\n            </div>\n            {/* Arrow pointing down */}\n            <div \n              className=\"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0\"\n              style={{\n                borderLeft: '6px solid transparent',\n                borderRight: '6px solid transparent',\n                borderTop: '6px solid white',\n                filter: 'drop-shadow(0 1px 1px rgba(0,0,0,0.1))'\n              }}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":2872},"README-import.md":{"content":"# Leden Import Handleiding\n\n## Overzicht\n\nDeze handleiding beschrijft hoe je leden kunt importeren in het ledenbeheer systeem via CSV of Excel bestanden. Het systeem ondersteunt beide formaten en biedt gedetailleerde validatie om ervoor te zorgen dat alle gegevens correct worden geïmporteerd.\n\n## Ondersteunde Bestandsformaten\n\n- **CSV (.csv)** - Comma Separated Values\n- **Excel (.xlsx, .xls)** - Microsoft Excel bestanden\n\n## Templates Downloaden\n\nVoor een succesvolle import is het belangrijk om de juiste template te gebruiken:\n\n1. **CSV Template** - Download voor gebruik in teksteditors of eenvoudige spreadsheet programma's\n2. **Excel Template** - Download voor gebruik in Microsoft Excel met voorbeelddata\n\nBeide templates bevatten alle vereiste kolommen en voorbeelddata om je te helpen bij het invullen.\n\n## Veld Specificaties\n\n### Verplichte Velden (*)\n\nDeze velden moeten altijd ingevuld worden en mogen niet leeg zijn:\n\n#### **Lidnummer***\n- **Beschrijving**: Uniek identificatienummer voor het lid\n- **Format**: Tekst of nummer\n- **Voorbeeld**: `001`, `L-123`, `2024-001`\n- **Validatie**: Moet uniek zijn binnen de organisatie\n\n#### **Voornaam***\n- **Beschrijving**: Voornaam van het lid\n- **Format**: Tekst\n- **Voorbeeld**: `Ahmed`, `Fatima`, `Mohamed`\n- **Validatie**: Minimaal 2 karakters\n\n#### **Achternaam***\n- **Beschrijving**: Achternaam van het lid\n- **Format**: Tekst\n- **Voorbeeld**: `Hassan`, `Al-Rashid`, `Van den Berg`\n- **Validatie**: Minimaal 2 karakters\n\n#### **Geslacht***\n- **Beschrijving**: Geslacht van het lid\n- **Toegestane waarden**: `M` (Man), `V` (Vrouw)\n- **Voorbeeld**: `M` of `V`\n- **Validatie**: Moet exact M of V zijn\n\n#### **Geboortedatum***\n- **Beschrijving**: Geboortedatum van het lid\n- **Format**: DD/MM/YYYY\n- **Voorbeeld**: `15/03/1980`, `01/12/1995`\n- **Validatie**: Moet geldig datum formaat zijn\n\n#### **Categorie***\n- **Beschrijving**: Lidmaatschap categorie\n- **Toegestane waarden**:\n  - `STUDENT` - Voor studenten (vaak met korting)\n  - `STANDAARD` - Regulier lidmaatschap\n  - `SENIOR` - Voor senioren (vaak 65+)\n- **Voorbeeld**: `STANDAARD`\n- **Validatie**: Moet een van de toegestane waarden zijn\n\n#### **Straat***\n- **Beschrijving**: Straatnaam van het adres\n- **Format**: Tekst\n- **Voorbeeld**: `Kerkstraat`, `Avenue Louise`\n- **Validatie**: Minimaal 2 karakters\n\n#### **Nummer***\n- **Beschrijving**: Huisnummer (met bus indien van toepassing)\n- **Format**: Tekst/nummer\n- **Voorbeeld**: `25`, `12A`, `100 bus 3`\n- **Validatie**: Mag niet leeg zijn\n\n#### **Postcode***\n- **Beschrijving**: Postcode van de woonplaats\n- **Format**: Nummer (België: 4 cijfers)\n- **Voorbeeld**: `1000`, `2000`, `3000`\n- **Validatie**: Voor België: 4 cijfers\n\n#### **Stad***\n- **Beschrijving**: Stad of gemeente\n- **Format**: Tekst\n- **Voorbeeld**: `Brussel`, `Antwerpen`, `Gent`\n- **Validatie**: Minimaal 2 karakters\n\n#### **Land***\n- **Beschrijving**: Land van verblijf\n- **Format**: Tekst\n- **Voorbeeld**: `België`, `Nederland`, `Frankrijk`\n- **Validatie**: Minimaal 2 karakters\n\n#### **Betaalmethode***\n- **Beschrijving**: Voorkeurswijze van betaling\n- **Toegestane waarden**:\n  - `SEPA` - SEPA automatische incasso (vereist IBAN)\n  - `OVERSCHRIJVING` - Handmatige bankoverschrijving\n  - `BANCONTACT` - Bancontact betaling\n  - `CASH` - Contante betaling\n- **Voorbeeld**: `SEPA`\n- **Validatie**: Moet een van de toegestane waarden zijn\n\n#### **Betalingsperiode***\n- **Beschrijving**: Frequentie van contributie betaling\n- **Toegestane waarden**:\n  - `MONTHLY` - Maandelijkse betaling\n  - `YEARLY` - Jaarlijkse betaling\n- **Voorbeeld**: `MONTHLY`\n- **Validatie**: Moet MONTHLY of YEARLY zijn\n\n#### **Privacy akkoord***\n- **Beschrijving**: Akkoord met privacyverklaring\n- **Toegestane waarden**: `JA`\n- **Voorbeeld**: `JA`\n- **Validatie**: Moet altijd JA zijn (wettelijk vereist)\n\n### Optionele Velden\n\nDeze velden mogen leeg gelaten worden:\n\n#### **E-mail**\n- **Beschrijving**: E-mailadres van het lid\n- **Format**: Geldig e-mailadres\n- **Voorbeeld**: `ahmed@email.com`, `contact@mosque.be`\n- **Validatie**: Als ingevuld, moet geldig e-mailadres formaat hebben\n\n#### **Telefoon**\n- **Beschrijving**: Telefoonnummer van het lid\n- **Format**: Internationaal formaat aanbevolen\n- **Voorbeeld**: `+32123456789`, `0123456789`\n- **Validatie**: Geen specifieke validatie\n\n#### **IBAN**\n- **Beschrijving**: Bankrekeningnummer voor SEPA betalingen\n- **Format**: Geldig IBAN formaat\n- **Voorbeeld**: `BE68539007547034`\n- **Validatie**: \n  - Verplicht als betaalmethode SEPA is\n  - Moet geldig IBAN formaat hebben\n\n#### **Actief rol interesse**\n- **Beschrijving**: Interest in actieve rol binnen de organisatie\n- **Toegestane waarden**: `JA`, `NEE`\n- **Standaard**: `NEE`\n- **Voorbeeld**: `JA`\n\n#### **Rol beschrijving**\n- **Beschrijving**: Beschrijving van gewenste rol of vaardigheden\n- **Format**: Vrije tekst\n- **Voorbeeld**: `IT ondersteuning`, `Evenementen organiseren`\n\n#### **Foto/video toestemming**\n- **Beschrijving**: Toestemming voor foto's en video's\n- **Toegestane waarden**: `JA`, `NEE`\n- **Standaard**: `NEE`\n- **Voorbeeld**: `JA`\n\n#### **Nieuwsbrief**\n- **Beschrijving**: Inschrijving voor nieuwsbrief\n- **Toegestane waarden**: `JA`, `NEE`\n- **Standaard**: `NEE`\n- **Voorbeeld**: `JA`\n\n#### **WhatsApp lijst**\n- **Beschrijving**: Toevoeging aan WhatsApp communicatie groepen\n- **Toegestane waarden**: `JA`, `NEE`\n- **Standaard**: `NEE`\n- **Voorbeeld**: `NEE`\n\n## Import Proces\n\n### Stap 1: Template Downloaden\n1. Klik op \"CSV Template\" of \"Excel Template\"\n2. Sla het bestand op naar je computer\n3. Open het bestand in je favoriete programma\n\n### Stap 2: Gegevens Invullen\n1. Vul de gegevens in volgens de specificaties hierboven\n2. Gebruik de voorbeelddata als referentie\n3. Zorg ervoor dat alle verplichte velden (*) zijn ingevuld\n4. Controleer de formaten en toegestane waarden\n\n### Stap 3: Bestand Uploaden\n1. Sla je bestand op (behoud het CSV/Excel formaat)\n2. Upload het bestand via de import functie\n3. Het systeem controleert automatisch alle gegevens\n\n### Stap 4: Validatie Controleren\n- Bekijk eventuele foutmeldingen\n- Corrigeer fouten in je bestand\n- Upload opnieuw indien nodig\n\n### Stap 5: Import Bevestigen\n- Controleer de preview van te importeren leden\n- Bevestig de import\n- Wacht tot het proces voltooid is\n\n## Veelvoorkomende Fouten\n\n### Formaat Fouten\n- **Geboortedatum**: Gebruik DD/MM/YYYY formaat\n- **Geslacht**: Alleen M of V toegestaan\n- **E-mail**: Controleer @ en geldig domein\n- **IBAN**: Controleer geldig IBAN formaat\n\n### Verplichte Velden\n- Alle velden met * moeten ingevuld zijn\n- Privacy akkoord moet altijd JA zijn\n- IBAN is verplicht bij betaalmethode SEPA\n\n### Categorie Fouten\n- Gebruik exact: STUDENT, STANDAARD, of SENIOR\n- Let op hoofdletters/kleine letters\n\n### Betaalmethode Fouten\n- Gebruik exact: SEPA, OVERSCHRIJVING, BANCONTACT, of CASH\n- Bij SEPA is IBAN verplicht\n\n## Tips voor Succesvolle Import\n\n1. **Gebruik de template**: Start altijd met de gedownloade template\n2. **Test met kleine groep**: Probeer eerst een paar leden te importeren\n3. **Controleer unieke lidnummers**: Zorg dat elk lidnummer uniek is\n4. **Consistente formaten**: Gebruik consistente datum- en tekstformaten\n5. **Backup maken**: Maak een backup voordat je grote imports doet\n\n## Ondersteuning\n\nAls je problemen ondervindt met de import:\n1. Controleer deze handleiding voor veld specificaties\n2. Download een nieuwe template en vergelijk met je bestand\n3. Test met een klein bestand eerst\n4. Neem contact op met de systeembeheerder bij blijvende problemen\n\n## Technische Opmerkingen\n\n- Maximum bestandsgrootte: Geen specifieke limiet, maar grote bestanden kunnen langer duren\n- Ondersteunde karaktersets: UTF-8 (ondersteunt alle karakters)\n- Excel versies: .xlsx (Excel 2007+) en .xls (oudere versies)\n- CSV formaat: Komma gescheiden, UTF-8 encoding aanbevolen","size_bytes":7834},"client/src/hooks/useDebounce.ts":{"content":"import { useState, useEffect } from 'react';\n\nexport function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}","size_bytes":385},"server/cache.ts":{"content":"// Simple in-memory cache for frequently accessed data\ninterface CacheEntry<T> {\n  data: T;\n  timestamp: number;\n  ttl: number; // Time to live in milliseconds\n}\n\nclass MemoryCache {\n  private cache = new Map<string, CacheEntry<any>>();\n  private readonly DEFAULT_TTL = 30000; // 30 seconds default\n\n  set<T>(key: string, data: T, ttl: number = this.DEFAULT_TTL): void {\n    this.cache.set(key, {\n      data,\n      timestamp: Date.now(),\n      ttl\n    });\n  }\n\n  get<T>(key: string): T | null {\n    const entry = this.cache.get(key);\n    if (!entry) return null;\n\n    const now = Date.now();\n    if (now - entry.timestamp > entry.ttl) {\n      this.cache.delete(key);\n      return null;\n    }\n\n    return entry.data;\n  }\n\n  delete(key: string): void {\n    this.cache.delete(key);\n  }\n\n  deletePattern(pattern: string): void {\n    const regex = new RegExp(pattern);\n    const keysToDelete: string[] = [];\n    this.cache.forEach((value, key) => {\n      if (regex.test(key)) {\n        keysToDelete.push(key);\n      }\n    });\n    keysToDelete.forEach(key => this.cache.delete(key));\n  }\n\n  clear(): void {\n    this.cache.clear();\n  }\n\n  // Clean expired entries periodically\n  cleanup(): void {\n    const now = Date.now();\n    const keysToDelete: string[] = [];\n    this.cache.forEach((entry, key) => {\n      if (now - entry.timestamp > entry.ttl) {\n        keysToDelete.push(key);\n      }\n    });\n    keysToDelete.forEach(key => this.cache.delete(key));\n  }\n}\n\nexport const cache = new MemoryCache();\n\n// Cleanup expired entries every 5 minutes\nsetInterval(() => {\n  cache.cleanup();\n}, 5 * 60 * 1000);","size_bytes":1598},"client/src/components/finance/TransactionDetailDialog.tsx":{"content":"import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport type { Transaction } from \"@shared/schema\";\nimport { formatCurrencyBE, formatDateBE, formatDateTime } from \"@/lib/format\";\nimport { User, Calendar, CreditCard, FileText, ArrowUpRight, ArrowDownLeft, X } from \"lucide-react\";\n\ninterface TransactionDetailDialogProps {\n  transaction: Transaction | null;\n  open: boolean;\n  onClose: () => void;\n  onEdit?: (transaction: Transaction) => void;\n}\n\nexport function TransactionDetailDialog({ transaction, open, onClose, onEdit }: TransactionDetailDialogProps) {\n  if (!transaction) return null;\n\n  const isIncome = transaction.type === \"INCOME\";\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Transactie Details</DialogTitle>\n          <DialogDescription>\n            Bekijk alle details van deze transactie\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Header Info */}\n          <div className=\"bg-gray-50 dark:bg-gray-900 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <div className=\"flex items-center gap-2\">\n                {isIncome ? (\n                  <ArrowUpRight className=\"h-5 w-5 text-green-600\" />\n                ) : (\n                  <ArrowDownLeft className=\"h-5 w-5 text-red-600\" />\n                )}\n                <Badge variant={isIncome ? \"default\" : \"secondary\"}>\n                  {isIncome ? \"Inkomst\" : \"Uitgave\"}\n                </Badge>\n              </div>\n              <span className=\"text-2xl font-bold\">\n                {formatCurrencyBE(transaction.amount)}\n              </span>\n            </div>\n            <h3 className=\"font-semibold text-lg\">\n              {transaction.description}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {formatDateBE(transaction.date)}\n            </p>\n          </div>\n\n          {/* Transaction Details */}\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium flex items-center gap-2\">\n              <CreditCard className=\"h-4 w-4\" />\n              Transactie informatie\n            </h4>\n            <div className=\"grid grid-cols-3 gap-6 text-sm\">\n              <div>\n                <span className=\"text-gray-500\">Type</span>\n                <p className=\"font-medium\">{isIncome ? \"Inkomst\" : \"Uitgave\"}</p>\n              </div>\n              <div>\n                <span className=\"text-gray-500\">Categorie</span>\n                <p className=\"font-medium\">{transaction.category}</p>\n              </div>\n              <div>\n                <span className=\"text-gray-500\">Bedrag</span>\n                <p className=\"font-semibold text-lg\">{formatCurrencyBE(transaction.amount)}</p>\n              </div>\n              <div>\n                <span className=\"text-gray-500\">Datum</span>\n                <p className=\"font-medium\">{formatDateBE(transaction.date)}</p>\n              </div>\n              {transaction.reference && (\n                <div>\n                  <span className=\"text-gray-500\">Referentie</span>\n                  <p className=\"font-mono text-xs\">{transaction.reference}</p>\n                </div>\n              )}\n              {transaction.paymentMethod && (\n                <div>\n                  <span className=\"text-gray-500\">Betaalmethode</span>\n                  <p className=\"font-medium\">{transaction.paymentMethod}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          <Separator />\n\n          {/* Member Details */}\n          {transaction.memberName && (\n            <>\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium flex items-center gap-2\">\n                  <User className=\"h-4 w-4\" />\n                  Lid informatie\n                </h4>\n                <div className=\"grid grid-cols-2 gap-6 text-sm\">\n                  <div>\n                    <span className=\"text-gray-500\">Naam</span>\n                    <p className=\"font-medium\">{transaction.memberName}</p>\n                  </div>\n                  {transaction.memberId && (\n                    <div>\n                      <span className=\"text-gray-500\">Lid ID</span>\n                      <p className=\"font-mono text-xs\">{transaction.memberId}</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n              <Separator />\n            </>\n          )}\n\n          {/* Notes */}\n          {transaction.notes && (\n            <>\n              <div className=\"space-y-4\">\n                <h4 className=\"font-medium flex items-center gap-2\">\n                  <FileText className=\"h-4 w-4\" />\n                  Opmerkingen\n                </h4>\n                <div className=\"bg-gray-50 dark:bg-gray-900 rounded-lg p-3\">\n                  <p className=\"text-sm\">{transaction.notes}</p>\n                </div>\n              </div>\n              <Separator />\n            </>\n          )}\n\n          {/* System Info */}\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4\" />\n              Systeem informatie\n            </h4>\n            <div className=\"grid grid-cols-2 gap-6 text-sm\">\n              <div>\n                <span className=\"text-gray-500\">Aangemaakt op</span>\n                <p className=\"font-medium\">{formatDateTime(transaction.createdAt)}</p>\n              </div>\n              {transaction.updatedAt && (\n                <div>\n                  <span className=\"text-gray-500\">Laatst gewijzigd</span>\n                  <p className=\"font-medium\">{formatDateTime(transaction.updatedAt)}</p>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"pt-4 border-t\">\n            <div className=\"flex gap-3\">\n              {onEdit && (\n                <Button \n                  onClick={() => {\n                    onEdit(transaction);\n                    onClose();\n                  }}\n                  className=\"flex-1\"\n                  data-testid=\"button-edit-transaction\"\n                >\n                  <CreditCard className=\"h-4 w-4 mr-2\" />\n                  Bewerken\n                </Button>\n              )}\n              <Button \n                onClick={onClose}\n                variant=\"outline\"\n                className=\"flex-1\"\n                data-testid=\"button-close-detail\"\n              >\n                <X className=\"h-4 w-4 mr-2\" />\n                Sluiten\n              </Button>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":7017},"client/src/components/members/member-detail-dialog.tsx":{"content":"import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Member, MemberFinancialSettings } from \"@shared/schema\";\nimport { formatCurrencyBE, formatDateBE, getMemberCategoryLabel } from \"@/lib/format\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { User, Calendar, CreditCard, Phone, Mail, MapPin, FileText, Edit, X, UserCircle, Contact, Shield, Settings, Home, Building2, CheckSquare, Crown } from \"lucide-react\";\n\n// Extended member type that includes related data\ninterface MemberWithDetails extends Member {\n  financialSettings?: MemberFinancialSettings;\n  permissions?: {\n    privacyAgreement: boolean;\n    photoVideoConsent: boolean;\n    newsletterSubscription: boolean;\n    whatsappList: boolean;\n    interestedInActiveRole: boolean;\n    roleDescription?: string;\n  };\n}\n\ninterface MemberDetailDialogProps {\n  member: MemberWithDetails | null;\n  open: boolean;\n  onClose: () => void;\n  onEdit?: (member: MemberWithDetails) => void;\n}\n\nexport function MemberDetailDialog({ member, open, onClose, onEdit }: MemberDetailDialogProps) {\n  const [activeTab, setActiveTab] = useState('personal');\n  \n  // Check if member is a board member\n  const { data: boardMembership } = useQuery<any>({\n    queryKey: [\"/api/board/members/by-member\", member?.id],\n    enabled: open && !!member?.id,\n    staleTime: 10000,\n  });\n  \n  if (!member) return null;\n\n  return (\n    <Dialog open={open} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-4xl h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Lid Details</DialogTitle>\n          <DialogDescription>\n            Bekijk alle details van dit lid\n          </DialogDescription>\n        </DialogHeader>\n\n        {/* Header Info */}\n        <div className=\"bg-gray-50 dark:bg-gray-900 rounded-lg p-2 mb-3\">\n          <div className=\"flex items-center justify-between mb-1\">\n            <span className=\"font-mono text-xs text-gray-600\">#{member.memberNumber}</span>\n            <Badge variant={member.active ? \"default\" : \"secondary\"} className=\"text-xs\">\n              {member.active ? 'Actief' : 'Inactief'}\n            </Badge>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <h3 className=\"font-semibold text-base\">\n              {member.firstName} {member.lastName}\n            </h3>\n            {boardMembership && (\n              <div className=\"flex items-center gap-1 text-amber-600\">\n                <Crown className=\"h-4 w-4\" />\n                <span className=\"text-xs font-medium\">Bestuurslid</span>\n              </div>\n            )}\n          </div>\n          <p className=\"text-gray-600 dark:text-gray-400 text-sm\">\n            {getMemberCategoryLabel(member.category)}\n          </p>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-4\">\n          <TabsList className=\"grid w-full grid-cols-5\">\n            <TabsTrigger value=\"personal\" className=\"flex items-center gap-2\">\n              <UserCircle className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Persoonlijk</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"address\" className=\"flex items-center gap-2\">\n              <Home className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Adres</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"financial\" className=\"flex items-center gap-2\">\n              <CreditCard className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Financieel</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"organization\" className=\"flex items-center gap-2\">\n              <Building2 className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Organisatie</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"permissions\" className=\"flex items-center gap-2\">\n              <CheckSquare className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Toestemmingen</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <div className=\"min-h-[400px]\">\n          <TabsContent value=\"personal\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <User className=\"h-4 w-4\" />\n                Persoonlijke gegevens\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Naam</span>\n                  <p className=\"font-medium\">{member.firstName} {member.lastName}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Geslacht</span>\n                  <p className=\"font-medium\">{member.gender || '-'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Geboortedatum</span>\n                  <p className=\"font-medium\">{member.birthDate ? formatDateBE(member.birthDate) : '-'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Categorie</span>\n                  <p className=\"font-medium\">{getMemberCategoryLabel(member.category)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">E-mail adres</span>\n                  <p className=\"font-medium\">{member.email}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Telefoon</span>\n                  <p className=\"font-medium\">{member.phone || '-'}</p>\n                </div>\n              </div>\n            </div>\n\n          </TabsContent>\n\n          <TabsContent value=\"address\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <Home className=\"h-4 w-4\" />\n                Adresgegevens\n              </h4>\n              <div className=\"grid grid-cols-1 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Adres</span>\n                  <div className=\"font-medium\">\n                    {(member.street || member.number) ? (\n                      <>\n                        <p>{member.street} {member.number}{member.bus ? ` bus ${member.bus}` : ''}</p>\n                        {(member.city || member.postalCode) && (\n                          <p>{member.postalCode} {member.city}</p>\n                        )}\n                        {member.country && <p>{member.country}</p>}\n                      </>\n                    ) : (\n                      <p>-</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n          </TabsContent>\n\n          <TabsContent value=\"financial\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <CreditCard className=\"h-4 w-4\" />\n                Financiële gegevens\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Betaalmethode</span>\n                  <p className=\"font-medium\">{member.financialSettings?.paymentMethod || 'SEPA'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">IBAN</span>\n                  <p className=\"font-medium font-mono\">{member.financialSettings?.iban || '-'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Betalingstermijn</span>\n                  <p className=\"font-medium\">{member.financialSettings?.paymentTerm === 'MONTHLY' ? 'Maandelijks' : member.financialSettings?.paymentTerm === 'YEARLY' ? 'Jaarlijks' : '-'}</p>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"organization\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <Building2 className=\"h-4 w-4\" />\n                Organisatie gegevens\n              </h4>\n              <div className=\"grid grid-cols-1 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Stemgerechtigd</span>\n                  <p className=\"font-medium\">{member.votingRights ? 'Ja' : 'Nee'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Interesse in actieve rol</span>\n                  <p className=\"font-medium\">{member.permissions?.interestedInActiveRole ? 'Ja' : 'Nee'}</p>\n                  {member.permissions?.interestedInActiveRole && member.permissions?.roleDescription && (\n                    <div className=\"mt-2\">\n                      <span className=\"text-gray-500\">Beschrijving</span>\n                      <p className=\"font-medium text-sm\">{member.permissions.roleDescription}</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"permissions\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <CheckSquare className=\"h-4 w-4\" />\n                Toestemmingen\n              </h4>\n              <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Privacy verklaring</span>\n                  <p className=\"font-medium\">{member.permissions?.privacyAgreement ? 'Akkoord gegeven' : 'Niet gegeven'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Foto/video toestemming</span>\n                  <p className=\"font-medium\">{member.permissions?.photoVideoConsent ? 'Ja' : 'Nee'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Nieuwsbrief</span>\n                  <p className=\"font-medium\">{member.permissions?.newsletterSubscription ? 'Ja' : 'Nee'}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">WhatsApp lijst</span>\n                  <p className=\"font-medium\">{member.permissions?.whatsappList ? 'Ja' : 'Nee'}</p>\n                </div>\n              </div>\n            </div>\n\n            {/* System Info moved here */}\n            <Separator />\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <Calendar className=\"h-4 w-4\" />\n                Systeem informatie\n              </h4>\n              <div className=\"grid grid-cols-1 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Aangemaakt op</span>\n                  <p className=\"font-medium\">{formatDateBE(member.createdAt)}</p>\n                </div>\n              </div>\n            </div>\n          </TabsContent>\n          </div>\n        </Tabs>\n\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":11429},"client/src/components/cards/live-card.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { RefreshCw, Wifi, WifiOff, Clock } from \"lucide-react\";\nimport { PiUserCircleCheckLight } from \"react-icons/pi\";\nimport { cn } from \"@/lib/utils\";\nimport { BoardMemberBadge } from \"@/components/ui/board-member-badge\";\nimport { useBoardMemberStatus } from \"@/hooks/useBoardMemberStatus\";\nimport { Crown } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport type { Member, CardMeta, Tenant } from \"@shared/schema\";\nimport fadingBlueBackground from \"@assets/fading-blue-background_1756897101831.jpg\";\n\ninterface LiveCardProps {\n  member: Member;\n  cardMeta: CardMeta;\n  tenant: Tenant;\n  onRefresh?: () => void;\n  isRefreshing?: boolean;\n  standalone?: boolean;\n  className?: string;\n}\n\ninterface StatusLEDProps {\n  status: 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN';\n  className?: string;\n}\n\nfunction StatusLED({ status, className }: StatusLEDProps) {\n  const statusConfig = {\n    ACTUEEL: {\n      color: 'bg-[#22C55E]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(34, 197, 94, 0.18)' },\n      label: 'Actueel',\n      icon: Wifi,\n    },\n    NIET_ACTUEEL: {\n      color: 'bg-[#F59E0B]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(245, 158, 11, 0.18)' },\n      label: 'Niet actueel',\n      icon: WifiOff,\n    },\n    VERLOPEN: {\n      color: 'bg-[#EF4444]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(239, 68, 68, 0.18)' },\n      label: 'Verlopen',\n      icon: Clock,\n    },\n  };\n\n  const config = statusConfig[status];\n  const Icon = config.icon;\n\n  return (\n    <div className={cn(\"flex items-center gap-2\", className)}>\n      <div \n        className={cn(\"w-3 h-3 rounded-full\", config.color)}\n        style={config.glowStyle}\n        aria-hidden=\"true\"\n      />\n      <span className=\"text-xs font-medium card-font debossed-text\">\n        {config.label}\n      </span>\n    </div>\n  );\n}\n\nfunction getMemberCategoryLabel(category: string): string {\n  switch (category) {\n    case 'STUDENT':\n      return 'Student';\n    case 'STANDAARD':\n      return 'Standaard';\n    case 'SENIOR':\n      return 'Senior';\n    default:\n      return category;\n  }\n}\n\nexport function LiveCard({ \n  member, \n  cardMeta, \n  tenant, \n  onRefresh, \n  isRefreshing = false,\n  standalone = false,\n  className = \"\"\n}: LiveCardProps) {\n  const [showQRModal, setShowQRModal] = useState(false);\n  const [showGloss, setShowGloss] = useState(false);\n  const [isInstallable, setIsInstallable] = useState(false);\n  const [isFlipping, setIsFlipping] = useState(false);\n  const [isOffline, setIsOffline] = useState(!navigator.onLine);\n  \n  // Check board member status\n  const { isActiveBoardMember } = useBoardMemberStatus(member.id);\n\n  // Check for PWA installability and reduced motion\n  useEffect(() => {\n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      setIsInstallable(true);\n    };\n\n    // Listen for online/offline events\n    const handleOnline = () => setIsOffline(false);\n    const handleOfflineEvent = () => setIsOffline(true);\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOfflineEvent);\n    \n    // Check for reduced motion preference\n    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;\n    document.documentElement.style.setProperty('--animation-duration', prefersReducedMotion ? '0ms' : '800ms');\n    \n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOfflineEvent);\n    };\n  }, []);\n\n  // Generate QR code URL for verification\n  const qrCodeUrl = `${window.location.origin}/card/verify/${cardMeta.qrToken}`;\n\n  // Determine primary color with fallback\n  const primaryColor = tenant.primaryColor || '#bb2e2e';\n\n  // Trigger flip animation when refreshing state changes\n  useEffect(() => {\n    if (isRefreshing) {\n      setIsFlipping(true);\n      setTimeout(() => setIsFlipping(false), 400);\n    }\n  }, [isRefreshing]);\n\n  // Handle refresh with animation\n  const handleRefresh = () => {\n    console.log('Refresh clicked, starting flip animation');\n    console.log('Current isFlipping state:', isFlipping);\n    setIsFlipping(true);\n    setTimeout(() => {\n      setIsFlipping(false);\n      console.log('Flip animation ended');\n    }, 400);\n    \n    if (onRefresh) {\n      onRefresh();\n    }\n  };\n\n  // Determine display status based on connectivity and membership validity\n  // VERLOPEN = membership expired (server determines this)\n  // NIET_ACTUEEL = offline PWA (no internet)  \n  // ACTUEEL = online PWA with valid membership\n  const displayStatus = cardMeta.status === 'VERLOPEN' \n    ? 'VERLOPEN' \n    : (isOffline ? 'NIET_ACTUEEL' : 'ACTUEEL');\n\n  // Calculate valid until date\n  const validUntil = cardMeta.validUntil || new Date();\n\n  return (\n    <>\n      {/* PWA Install Banner */}\n      {isInstallable && !standalone && (\n        <div className=\"fixed top-4 left-4 right-4 bg-blue-600 text-white p-3 rounded-lg shadow-lg z-10\">\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm font-medium\">Op beginscherm installeren</span>\n            <Button variant=\"outline\" size=\"sm\" className=\"text-blue-600\">\n              Installeer\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {/* Live Card - Credit card aspect ratio */}\n      <div className=\"w-[min(95vw,75vh*1.586)] sm:w-[min(96vw,96vh*1.586)] lg:w-[clamp(600px,75vmin,920px)] aspect-[1586/1000]\">\n        <div \n          className={cn(\n            \"relative w-full h-full rounded-3xl overflow-hidden border border-white/10 card-font transition-transform duration-800\",\n            isFlipping && \"animate-flip-horizontal\"\n          )}\n          style={{\n            backgroundImage: `url(${fadingBlueBackground}), linear-gradient(135deg, rgba(8, 35, 66, 0.9) 0%, rgba(6, 47, 89, 0.95) 100%)`,\n            backgroundSize: \"cover\",\n            backgroundPosition: \"center\",\n            backgroundBlendMode: \"overlay\",\n            transformStyle: 'preserve-3d',\n            boxShadow: \"0 18px 40px rgba(0,0,0,0.35)\",\n            transform: isFlipping ? 'rotateY(360deg)' : 'rotateY(0deg)',\n            transition: 'transform 800ms ease-in-out'\n          }}\n          data-testid=\"live-card\"\n        >\n          {/* Enhanced glossy sheen overlay */}\n          <div \n            className=\"absolute inset-0 pointer-events-none opacity-30 mix-blend-screen\"\n            style={{\n              background: \"linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.1) 20%, transparent 40%, rgba(255,255,255,0.05) 70%, rgba(255,255,255,0.15) 100%)\"\n            }}\n            aria-hidden=\"true\"\n          />\n          {/* Additional highlight for premium effect */}\n          <div \n            className=\"absolute top-0 left-0 w-full h-1/3 pointer-events-none opacity-20\"\n            style={{\n              background: \"linear-gradient(180deg, rgba(255,255,255,0.2) 0%, transparent 100%)\"\n            }}\n            aria-hidden=\"true\"\n          />\n          {/* Interactive shine overlay */}\n          <div \n            className={cn(\n              \"absolute inset-0 pointer-events-none\",\n              \"transition-transform duration-800 ease-out\",\n              showGloss ? \"card-shine\" : \"\"\n            )}\n            style={{\n              background: \"linear-gradient(35deg, transparent 40%, rgba(255,255,255,0.25) 50%, transparent 60%)\",\n              width: \"100px\",\n              height: \"200%\",\n              transform: showGloss ? \"translateX(-100%) rotate(35deg)\" : \"translateX(-200%) rotate(35deg)\"\n            }}\n            aria-hidden=\"true\"\n          />\n\n          {/* Card Content */}\n          <div className=\"relative h-full p-6 flex flex-col text-white\">\n            {/* Top row: Organization and Status */}\n            <div className=\"flex items-start justify-between mb-6\">\n              <div className=\"flex-1\">\n                {tenant.logoUrl && (\n                  <img \n                    src={tenant.logoUrl} \n                    alt={tenant.name}\n                    className=\"h-6 w-auto mb-2 opacity-90\"\n                  />\n                )}\n                <h1 className={`embossed-text font-bold uppercase tracking-wider ${\n                  tenant.name.length > 15 ? 'text-xl' : \n                  tenant.name.length > 10 ? 'text-2xl' : 'text-3xl'\n                }`}>\n                  Lidkaart {tenant.name.toUpperCase()}\n                </h1>\n              </div>\n              \n              <div className=\"flex items-start gap-3\">\n                <StatusLED status={displayStatus} />\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  className=\"h-5 w-5 text-white/60 hover:text-white hover:bg-white/10 rounded-full\"\n                  onClick={handleRefresh}\n                  disabled={isRefreshing}\n                  data-testid=\"button-refresh\"\n                  aria-label=\"Ververs kaart\"\n                >\n                  <RefreshCw className={cn(\"h-3 w-3\", isRefreshing && \"animate-spin\")} />\n                </Button>\n              </div>\n            </div>\n\n            {/* QR Code and Voting Rights Section */}\n            <div className=\"flex justify-between items-center mb-8 ml-4 mt-4\">\n              {/* QR Code - Left side */}\n              <button\n                onClick={() => setShowQRModal(true)}\n                className=\"debossed-qr-container transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 hover:scale-105\"\n                data-testid=\"qr-plate\"\n                aria-label=\"Toon scanbare QR code\"\n                style={{ \n                  minWidth: 'clamp(75px, 8vmin, 100px)', \n                  minHeight: 'clamp(75px, 8vmin, 100px)' \n                }}\n              >\n                <div className=\"debossed-qr-frame\">\n                  <QRCodeSVG\n                    value={qrCodeUrl}\n                    size={Math.min(70, window.innerWidth * 0.08)}\n                    className=\"debossed-qr\"\n                    fgColor=\"#D1D5DB\"\n                    bgColor=\"transparent\"\n                  />\n                </div>\n              </button>\n              \n              {/* Status Badge - Right side (Board Member takes priority over Voting Rights) */}\n              {(isActiveBoardMember || member.votingRights) && (\n                <div className=\"flex flex-col items-center mr-8\">\n                  {isActiveBoardMember ? (\n                    <Crown \n                      className=\"w-[clamp(36px, 5vmin, 48px)] h-[clamp(36px, 5vmin, 48px)]\"\n                      data-testid=\"board-member-icon\"\n                      style={{\n                        color: '#FFD700',\n                        textShadow: `\n                          3px 3px 0 rgba(255,255,255,0.3),\n                          -3px -3px 0 rgba(0,0,0,0.9),\n                          -4px -4px 0 rgba(0,0,0,0.8),\n                          -5px -5px 0 rgba(0,0,0,0.6),\n                          -6px -6px 0 rgba(0,0,0,0.4),\n                          -7px -7px 0 rgba(0,0,0,0.2),\n                          inset 4px 4px 8px rgba(0,0,0,0.8),\n                          inset -2px -2px 4px rgba(255,215,0,0.2),\n                          0 0 12px rgba(255,215,0,0.4),\n                          0 0 20px rgba(255,215,0,0.2)\n                        `,\n                        filter: 'drop-shadow(3px 3px 8px rgba(0,0,0,0.6)) brightness(1.2)'\n                      }}\n                    />\n                  ) : (\n                    member.votingRights && (\n                      <PiUserCircleCheckLight \n                        className=\"w-[clamp(36px, 5vmin, 48px)] h-[clamp(36px, 5vmin, 48px)]\"\n                        data-testid=\"voting-icon\"\n                        style={{\n                          color: '#C0C0C0',\n                          textShadow: `\n                            3px 3px 0 rgba(255,255,255,0.3),\n                            -3px -3px 0 rgba(0,0,0,0.9),\n                            -4px -4px 0 rgba(0,0,0,0.8),\n                            -5px -5px 0 rgba(0,0,0,0.6),\n                            -6px -6px 0 rgba(0,0,0,0.4),\n                            -7px -7px 0 rgba(0,0,0,0.2),\n                            inset 4px 4px 8px rgba(0,0,0,0.8),\n                            inset -2px -2px 4px rgba(192,192,192,0.2),\n                            0 0 12px rgba(192,192,192,0.4),\n                            0 0 20px rgba(192,192,192,0.2)\n                          `,\n                          filter: 'drop-shadow(3px 3px 8px rgba(0,0,0,0.6)) brightness(1.2)'\n                        }}\n                      />\n                    )\n                  )}\n                  \n                  {/* Primary text - Board Member takes priority */}\n                  {isActiveBoardMember ? (\n                    <span className=\"embossed-text text-[clamp(10px, 1.2vmin, 14px)] uppercase tracking-[0.1em] font-bold mt-3\" style={{\n                      color: '#FFD700',\n                      textShadow: `\n                        2px 2px 0 rgba(255,255,255,0.3),\n                        -2px -2px 0 rgba(0,0,0,0.8),\n                        -3px -3px 0 rgba(0,0,0,0.6),\n                        inset 2px 2px 4px rgba(0,0,0,0.6),\n                        0 0 8px rgba(255,215,0,0.4)\n                      `,\n                      filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                    }}>\n                      BESTUURSLID\n                    </span>\n                  ) : (\n                    member.votingRights && (\n                      <span className=\"embossed-text text-[clamp(10px, 1.2vmin, 14px)] uppercase tracking-[0.1em] font-bold mt-3\" style={{\n                        color: '#C0C0C0',\n                        textShadow: `\n                          1px 1px 0 rgba(255,255,255,0.2),\n                          -1px -1px 0 rgba(0,0,0,0.7),\n                          -2px -2px 0 rgba(0,0,0,0.5),\n                          inset 2px 2px 4px rgba(0,0,0,0.6),\n                          0 0 6px rgba(192,192,192,0.3)\n                        `,\n                        filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                      }}>\n                        STEMGERECHTIGD\n                      </span>\n                    )\n                  )}\n                  \n                  {/* Secondary text - show voting rights if board member */}\n                  {isActiveBoardMember && member.votingRights && (\n                    <span className=\"embossed-text text-[clamp(8px, 1.0vmin, 12px)] uppercase tracking-[0.1em] font-bold mt-1\" style={{\n                      color: '#C0C0C0',\n                      textShadow: `\n                        1px 1px 0 rgba(255,255,255,0.2),\n                        -1px -1px 0 rgba(0,0,0,0.7),\n                        -2px -2px 0 rgba(0,0,0,0.5),\n                        inset 2px 2px 4px rgba(0,0,0,0.6),\n                        0 0 6px rgba(192,192,192,0.3)\n                      `,\n                      filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                    }}>\n                      STEMGERECHTIGD\n                    </span>\n                  )}\n                </div>\n              )}\n            </div>\n\n            {/* Member Information */}\n            <div className=\"mb-4 space-y-4 ml-8\">\n              {/* Member Name */}\n              <div>\n                <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                  NAAM\n                </p>\n                <h2 className=\"embossed-text text-[clamp(20px,2.4vmin,22px)] font-semibold uppercase tracking-wide leading-tight\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                  {member.firstName} {member.lastName}\n                </h2>\n                {/* No status badges under name anymore - moved to QR section */}\n              </div>\n\n              {/* Lidnummer and Category - side by side */}\n              <div className=\"grid grid-cols-2 gap-4 mt-3\">\n                <div>\n                  <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                    LIDNUMMER\n                  </p>\n                  <p className=\"embossed-text text-[clamp(20px,2.4vmin,22px)] font-mono font-bold tracking-[0.2em] leading-tight\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                    {member.memberNumber}\n                  </p>\n                </div>\n                \n                <div>\n                  <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                    CATEGORIE\n                  </p>\n                  <span className=\"embossed-text text-[clamp(20px,2.4vmin,22px)] font-medium uppercase\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                    {getMemberCategoryLabel(member.category)}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n          {/* Bottom right: Valid until */}\n          <div className=\"absolute bottom-4 right-4\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"embossed-text text-[clamp(7px,1.0vmin,9px)] uppercase tracking-wide opacity-70 font-medium\">\n                GELDIG TOT\n              </span>\n              <span className=\"embossed-text text-[clamp(8px,1.1vmin,10px)] font-medium font-mono tabular-nums\">\n                {cardMeta.validUntil ? format(cardMeta.validUntil, 'dd-MM-yyyy', { locale: nl }) : '31-12-2025'}\n              </span>\n            </div>\n          </div>\n          </div>\n        </div>\n      </div>\n\n      {/* QR Code Modal */}\n      <Dialog open={showQRModal} onOpenChange={setShowQRModal}>\n        <DialogContent className=\"max-w-sm\" data-testid=\"qr-modal\">\n          <DialogHeader>\n            <DialogTitle>Verificatie QR Code</DialogTitle>\n          </DialogHeader>\n          <div className=\"flex flex-col items-center gap-4 py-4\">\n            <div className=\"bg-white p-6 rounded-xl shadow-xl border\">\n              <QRCodeSVG\n                value={qrCodeUrl}\n                size={320}\n                className=\"w-full h-full\"\n                fgColor=\"#000000\"\n                bgColor=\"#ffffff\"\n              />\n            </div>\n            <p className=\"text-center text-sm text-gray-600\">\n              Scan deze QR code om lid te bekijken\n            </p>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","size_bytes":19328},"client/src/pages/card.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useRoute } from \"wouter\";\nimport { MembershipCard } from \"@/components/card/MembershipCard\";\nimport { CardCanvas } from \"@/components/card/CardCanvas\";\nimport { AspectBox } from \"@/components/card/AspectBox\";\nimport { InstallCoach, useInstallCoach } from \"@/components/pwa/InstallCoach\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ninterface CardData {\n  memberId: string;\n  firstName: string;\n  lastName: string;\n  memberNumber: string;\n  category: 'STUDENT' | 'STANDAARD' | 'SENIOR';\n  status: 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN';\n  validUntil: Date | null;\n  votingRights: boolean;\n  badges: string[];\n  qrToken: string;\n  tenant: {\n    name: string;\n    logoUrl?: string | null;\n    primaryColor: string;\n  };\n  etag: string;\n}\n\nexport function CardPage() {\n  const [, params] = useRoute(\"/card/:memberId\");\n  const [isOffline, setIsOffline] = useState(!navigator.onLine);\n  const [isFlipping, setIsFlipping] = useState(false);\n  const installCoach = useInstallCoach();\n\n  // Listen for online/offline events\n  useEffect(() => {\n    const handleOnline = () => setIsOffline(false);\n    const handleOffline = () => setIsOffline(true);\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Fetch card data from the new API endpoint\n  const { data, isLoading, error, refetch } = useQuery({\n    queryKey: ['/api/card', params?.memberId],\n    queryFn: async () => {\n      if (!params?.memberId) return null;\n      \n      const response = await fetch(`/api/card/${params.memberId}`);\n      if (!response.ok) {\n        throw new Error('Card not found');\n      }\n      \n      const cardData = await response.json();\n      \n      // Convert dates from ISO strings\n      return {\n        ...cardData,\n        validUntil: cardData.validUntil ? new Date(cardData.validUntil) : null\n      };\n    },\n    enabled: !!params?.memberId,\n    retry: (failureCount, error: any) => {\n      // Don't retry if offline or if it's a 404\n      if (!navigator.onLine || error?.message === 'Card not found') {\n        return false;\n      }\n      return failureCount < 3;\n    }\n  });\n\n  const handleRefresh = () => {\n    console.log('PWA handleRefresh called - triggering flip animation');\n    setIsFlipping(true);\n    setTimeout(() => {\n      setIsFlipping(false);\n      console.log('PWA flip animation ended');\n    }, 400);\n    refetch();\n  };\n\n  // Update document title when card data loads\n  useEffect(() => {\n    if (data) {\n      document.title = `Lidkaart ${data.firstName} ${data.lastName}`;\n    } else {\n      document.title = 'Lidkaart';\n    }\n    \n    // Cleanup - reset title when component unmounts\n    return () => {\n      document.title = 'Ledenbeheer';\n    };\n  }, [data]);\n\n  if (!params?.memberId) {\n    return (\n      <CardCanvas>\n        <div className=\"h-full w-full flex items-center justify-center text-center text-white/80\">\n          <div>\n            <h1 className=\"text-2xl font-bold mb-2\">Geen lid geselecteerd</h1>\n            <p>Selecteer een lid om de digitale kaart te bekijken.</p>\n          </div>\n        </div>\n      </CardCanvas>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <CardCanvas>\n        <div className=\"h-full w-full flex items-center justify-center text-center text-white/80\">\n          <div>\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400 mx-auto mb-4\"></div>\n            <p>Lidkaart laden...</p>\n          </div>\n        </div>\n      </CardCanvas>\n    );\n  }\n\n  if (error || !data) {\n    return (\n      <CardCanvas>\n        <div className=\"h-full w-full flex items-center justify-center text-center text-white/80\">\n          <div>\n            <h1 className=\"text-2xl font-bold mb-2\">Lidkaart niet gevonden</h1>\n            <p>De opgevraagde lidkaart bestaat niet of is niet beschikbaar.</p>\n          </div>\n        </div>\n      </CardCanvas>\n    );\n  }\n\n  // Handle offline status - if offline or fetch failed, show NIET_ACTUEEL\n  const displayData = data ? {\n    ...data,\n    status: (isOffline || error) ? 'NIET_ACTUEEL' as const : data.status\n  } : null;\n\n  return (\n    <CardCanvas>\n      {/* Refresh Button - Top Right */}\n      {displayData && (\n        <button\n          onClick={handleRefresh}\n          disabled={isLoading}\n          className=\"fixed top-6 right-6 z-50 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full p-3 text-white transition-all\"\n          data-testid=\"refresh-button-top\"\n          aria-label=\"Ververs kaart\"\n        >\n          <svg \n            className={`w-6 h-6 ${isLoading ? 'animate-spin' : ''}`} \n            fill=\"none\" \n            stroke=\"currentColor\" \n            viewBox=\"0 0 24 24\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n          </svg>\n        </button>\n      )}\n\n      {/* Offline Banner */}\n      {(isOffline || error) && (\n        <div \n          className=\"fixed top-6 left-6 right-6 bg-orange-500 text-white px-4 py-3 rounded-lg shadow-lg z-50 text-center\"\n          data-testid=\"offline-banner\"\n        >\n          <span className=\"text-sm font-medium\">\n            Offline – status niet bevestigd\n          </span>\n        </div>\n      )}\n      \n      <AspectBox>\n        {displayData ? (\n          <MembershipCard\n            cardData={displayData}\n            onRefresh={handleRefresh}\n            isRefreshing={isFlipping || isLoading}\n            isOffline={isOffline || !!error}\n            className=\"w-full h-full\"\n          />\n        ) : (\n          <div className=\"w-full h-full rounded-3xl bg-gray-800 flex items-center justify-center text-white\">\n            <div className=\"text-center\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-4\"></div>\n              <p>Lidkaart laden...</p>\n            </div>\n          </div>\n        )}\n      </AspectBox>\n      \n      <InstallCoach \n        isOpen={installCoach.isOpen} \n        onClose={installCoach.close} \n      />\n    </CardCanvas>\n  );\n}","size_bytes":6338},"public/sw.js":{"content":"// Service Worker voor Ledenbeheer PWA\n// Versie: 2.0.0\n\nconst CACHE_VERSION = '2.0.0';\nconst STATIC_CACHE = `ledenbeheer-static-v${CACHE_VERSION}`;\nconst DYNAMIC_CACHE = `ledenbeheer-dynamic-v${CACHE_VERSION}`;\nconst API_CACHE = `ledenbeheer-api-v${CACHE_VERSION}`;\n\n// Bestanden die altijd gecached moeten worden\nconst STATIC_ASSETS = [\n  '/',\n  '/index.html',\n  '/manifest.json'\n];\n\n// API endpoints die gecached mogen worden (niet verify endpoint!)\nconst CACHEABLE_APIS = [\n  '/api/members',\n  '/api/dashboard/stats',\n  '/api/cards/stats',\n  '/api/cards',\n  '/api/tenant/current',\n  '/api/card/'  // Card data can be cached with stale-while-revalidate\n];\n\n// API endpoints die NOOIT gecached mogen worden\nconst NO_CACHE_APIS = [\n  '/api/card/verify',\n  '/api/auth'\n];\n\nself.addEventListener('install', event => {\n  console.log('[SW] Installing service worker v' + CACHE_VERSION);\n  \n  event.waitUntil(\n    caches.open(STATIC_CACHE)\n      .then(cache => {\n        console.log('[SW] Caching static assets');\n        return cache.addAll(STATIC_ASSETS);\n      })\n      .then(() => {\n        console.log('[SW] Static assets cached successfully');\n        return self.skipWaiting();\n      })\n      .catch(error => {\n        console.error('[SW] Error caching static assets:', error);\n      })\n  );\n});\n\nself.addEventListener('activate', event => {\n  console.log('[SW] Activating service worker v' + CACHE_VERSION);\n  \n  event.waitUntil(\n    caches.keys()\n      .then(cacheNames => {\n        return Promise.all(\n          cacheNames.map(cacheName => {\n            if (cacheName !== STATIC_CACHE && \n                cacheName !== DYNAMIC_CACHE && \n                cacheName !== API_CACHE) {\n              console.log('[SW] Deleting old cache:', cacheName);\n              return caches.delete(cacheName);\n            }\n          })\n        );\n      })\n      .then(() => {\n        console.log('[SW] Service worker activated');\n        return self.clients.claim();\n      })\n  );\n});\n\nself.addEventListener('fetch', event => {\n  const request = event.request;\n  const url = new URL(request.url);\n  \n  // Alleen GET requests verwerken\n  if (request.method !== 'GET') {\n    return;\n  }\n\n  // Skip chrome-extension en andere protocollen\n  if (url.protocol !== 'http:' && url.protocol !== 'https:') {\n    return;\n  }\n\n  // API requests\n  if (url.pathname.startsWith('/api/')) {\n    event.respondWith(handleApiRequest(request));\n    return;\n  }\n\n  // Static assets en pagina's\n  event.respondWith(handleStaticRequest(request));\n});\n\n// Behandel API requests met verschillende strategieën\nasync function handleApiRequest(request) {\n  const url = new URL(request.url);\n  \n  // Verificatie endpoint: altijd NetworkFirst (belangrijke live data)\n  if (url.pathname.startsWith('/api/card/verify/')) {\n    console.log('[SW] NetworkFirst for verify endpoint:', url.pathname);\n    return networkFirstStrategy(request, API_CACHE);\n  }\n  \n  // Andere no-cache API's: NetworkOnly\n  if (NO_CACHE_APIS.some(api => url.pathname.startsWith(api))) {\n    console.log('[SW] NetworkOnly for:', url.pathname);\n    try {\n      return await fetch(request);\n    } catch (error) {\n      console.error('[SW] Network error for no-cache API:', error);\n      return new Response(\n        JSON.stringify({ \n          error: 'Geen internetverbinding',\n          offline: true \n        }), \n        { \n          status: 503,\n          headers: { 'Content-Type': 'application/json' }\n        }\n      );\n    }\n  }\n\n  // Cacheable API's: NetworkFirst strategie\n  if (CACHEABLE_APIS.some(api => url.pathname.startsWith(api))) {\n    console.log('[SW] NetworkFirst for:', url.pathname);\n    return networkFirstStrategy(request, API_CACHE);\n  }\n\n  // Andere API's: direct naar netwerk\n  try {\n    return await fetch(request);\n  } catch (error) {\n    console.error('[SW] Network error for API:', error);\n    return new Response(\n      JSON.stringify({ \n        error: 'API niet bereikbaar',\n        offline: true \n      }), \n      { \n        status: 503,\n        headers: { 'Content-Type': 'application/json' }\n      }\n    );\n  }\n}\n\n// Behandel statische requests\nasync function handleStaticRequest(request) {\n  // Voor navigatie requests: NetworkFirst met fallback naar index.html\n  if (request.mode === 'navigate') {\n    console.log('[SW] Navigation request:', request.url);\n    return networkFirstStrategy(request, DYNAMIC_CACHE, '/');\n  }\n\n  // Voor andere static assets: CacheFirst\n  return cacheFirstStrategy(request, STATIC_CACHE);\n}\n\n// NetworkFirst strategie: probeer netwerk eerst, fallback naar cache\nasync function networkFirstStrategy(request, cacheName, fallbackUrl = null) {\n  try {\n    const networkResponse = await fetch(request);\n    \n    // Als succesvol, update cache\n    if (networkResponse.ok) {\n      const cache = await caches.open(cacheName);\n      cache.put(request, networkResponse.clone());\n    }\n    \n    return networkResponse;\n  } catch (error) {\n    console.log('[SW] Network failed, trying cache:', request.url);\n    \n    // Probeer uit cache\n    const cachedResponse = await caches.match(request);\n    if (cachedResponse) {\n      console.log('[SW] Serving from cache (offline)');\n      return cachedResponse;\n    }\n    \n    // Fallback voor navigatie\n    if (fallbackUrl) {\n      const fallbackResponse = await caches.match(fallbackUrl);\n      if (fallbackResponse) {\n        return fallbackResponse;\n      }\n    }\n    \n    // Geen cache beschikbaar\n    throw error;\n  }\n}\n\n// CacheFirst strategie: cache eerst, fallback naar netwerk\nasync function cacheFirstStrategy(request, cacheName) {\n  const cachedResponse = await caches.match(request);\n  \n  if (cachedResponse) {\n    console.log('[SW] Serving from cache:', request.url);\n    return cachedResponse;\n  }\n  \n  console.log('[SW] Cache miss, fetching:', request.url);\n  try {\n    const networkResponse = await fetch(request);\n    \n    if (networkResponse.ok) {\n      const cache = await caches.open(cacheName);\n      cache.put(request, networkResponse.clone());\n    }\n    \n    return networkResponse;\n  } catch (error) {\n    console.error('[SW] Failed to fetch:', request.url, error);\n    throw error;\n  }\n}\n\n// Background sync voor offline acties\nself.addEventListener('sync', event => {\n  console.log('[SW] Background sync event:', event.tag);\n  \n  if (event.tag === 'background-sync') {\n    event.waitUntil(doBackgroundSync());\n  }\n});\n\nasync function doBackgroundSync() {\n  console.log('[SW] Performing background sync...');\n  // Implementeer background sync logica hier\n}\n\n// Push notifications\nself.addEventListener('push', event => {\n  console.log('[SW] Push notification received');\n  \n  if (event.data) {\n    const data = event.data.json();\n    \n    const options = {\n      body: data.body || 'Nieuwe melding van Ledenbeheer',\n      icon: '/icon-192.svg',\n      badge: '/icon-192.svg',\n      vibrate: [200, 100, 200],\n      data: data.data || {},\n      actions: data.actions || []\n    };\n    \n    event.waitUntil(\n      self.registration.showNotification(data.title || 'Ledenbeheer', options)\n    );\n  }\n});\n\n// Notification click handling\nself.addEventListener('notificationclick', event => {\n  console.log('[SW] Notification clicked');\n  \n  event.notification.close();\n  \n  event.waitUntil(\n    clients.openWindow(event.notification.data.url || '/')\n  );\n});\n\n// Listen for messages from the main thread\nself.addEventListener('message', event => {\n  if (event.data && event.data.type === 'SKIP_WAITING') {\n    console.log('[SW] Received SKIP_WAITING message');\n    self.skipWaiting();\n  }\n});\n\nconsole.log('[SW] Service worker script loaded v' + CACHE_VERSION);","size_bytes":7606},"server/services/card.ts":{"content":"import { storage } from \"../storage\";\nimport { createHash, randomBytes } from \"crypto\";\nimport type { Member, CardMeta, Tenant, CardVerifyResponse } from \"@shared/schema\";\nimport { computeCardStatus } from \"../lib/card/status\";\n\nexport class CardService {\n  /**\n   * Generate a secure token for card operations\n   */\n  private generateSecureToken(): string {\n    return randomBytes(32).toString('hex');\n  }\n\n  /**\n   * Calculate ETag based on member data and tenant branding version\n   */\n  private calculateETag(member: Member, tenant: Tenant): string {\n    const data = {\n      memberNumber: member.memberNumber,\n      firstName: member.firstName,\n      lastName: member.lastName,\n      category: member.category,\n      active: member.active,\n      // Add tenant branding version when available\n      brandingVersion: 1, // tenant.brandingVersion || 1\n    };\n    \n    return createHash('sha256')\n      .update(JSON.stringify(data))\n      .digest('hex')\n      .substring(0, 16);\n  }\n\n  /**\n   * Get or create card metadata for a member\n   */\n  async getOrCreateCardMeta(memberId: string): Promise<{ member: Member; cardMeta: CardMeta; tenant: Tenant } | null> {\n    try {\n      // Try to get existing card data\n      let cardData = await storage.getMemberWithCardAndTenant(memberId);\n      \n      if (cardData) {\n        // Check if ETag is still valid\n        const currentETag = this.calculateETag(cardData.member, cardData.tenant);\n        if (cardData.cardMeta.etag !== currentETag) {\n          // ETag mismatch, need to bump version and rotate tokens\n          const updatedCardMeta = await this.invalidateCard(cardData.cardMeta.id, currentETag);\n          cardData.cardMeta = updatedCardMeta;\n        }\n        return cardData;\n      }\n\n      // No card exists, create one\n      const member = await storage.getMember(memberId);\n      if (!member) return null;\n\n      const tenant = await storage.getTenant(member.tenantId);\n      if (!tenant) return null;\n\n      const etag = this.calculateETag(member, tenant);\n      const newCardMeta = await storage.createCardMeta({\n        tenantId: member.tenantId,\n        memberId: member.id,\n        version: 1,\n        etag,\n        secureToken: this.generateSecureToken(),\n        qrToken: this.generateSecureToken(),\n        status: 'ACTUEEL',\n        validUntil: new Date(new Date().getFullYear(), 11, 31), // End of current year\n      });\n\n      return { member, cardMeta: newCardMeta, tenant };\n    } catch (error) {\n      console.error('Error in getOrCreateCardMeta:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Invalidate a card by bumping version and rotating tokens\n   */\n  async invalidateCard(cardId: string, newETag?: string): Promise<CardMeta> {\n    // Find the card by ID - note: cardId parameter should be memberId for this function\n    const existingCard = await storage.getCardMetaByMember(cardId);\n    if (!existingCard) {\n      throw new Error('Card not found');\n    }\n\n    const updates = {\n      version: existingCard.version + 1,\n      etag: newETag || existingCard.etag,\n      secureToken: this.generateSecureToken(),\n      qrToken: this.generateSecureToken(),\n      status: 'ACTUEEL' as const,\n      lastRenderedAt: new Date(),\n    };\n\n    return await storage.updateCardMeta(existingCard.id, updates);\n  }\n\n  /**\n   * Verify card using QR token\n   */\n  async verifyCardByQrToken(qrToken: string): Promise<CardVerifyResponse | null> {\n    try {\n      const cardMeta = await storage.getCardMetaByQrToken(qrToken);\n      if (!cardMeta) return null;\n\n      const member = await storage.getMember(cardMeta.memberId);\n      if (!member) return null;\n\n      const tenant = await storage.getTenant(cardMeta.tenantId);\n      if (!tenant) return null;\n\n      // Check if member has paid for current year (simplified logic)\n      const currentYear = new Date().getFullYear();\n      const memberFees = await storage.getMembershipFeesByMember(member.id);\n      const currentYearFees = memberFees.filter(fee => {\n        const feeYear = new Date(fee.periodStart).getFullYear();\n        return feeYear === currentYear;\n      });\n      const currentYearPaid = currentYearFees.some(fee => fee.status === 'PAID');\n\n      return {\n        ok: true,\n        member: {\n          naam: `${member.firstName} ${member.lastName}`,\n          nummer: member.memberNumber,\n        },\n        status: {\n          actief: member.active,\n          betaaldDitJaar: currentYearPaid,\n          geldigTot: cardMeta.validUntil?.toISOString().split('T')[0] || null,\n        },\n        tenant: {\n          naam: tenant.name,\n          slug: tenant.slug,\n        },\n        ts: Date.now(),\n      };\n    } catch (error) {\n      console.error('Error in verifyCardByQrToken:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Get card data for display\n   */\n  async getCardData(memberId: string): Promise<{ member: Member; cardMeta: CardMeta; tenant: Tenant } | null> {\n    return await this.getOrCreateCardMeta(memberId);\n  }\n\n  /**\n   * Recalculate card status based on member data and payments\n   */\n  async recalculateCardStatus(memberId: string, tenantId: string): Promise<void> {\n    try {\n      // Get existing card metadata\n      const cardMeta = await storage.getCardMetaByMember(memberId);\n      if (!cardMeta || cardMeta.tenantId !== tenantId) {\n        console.warn(`Card not found for member ${memberId} in tenant ${tenantId}`);\n        return;\n      }\n\n      // Compute new status\n      const newStatus = await computeCardStatus(memberId);\n      \n      // Update card with new status\n      await storage.updateCardMeta(cardMeta.id, {\n        status: newStatus,\n      });\n\n      console.log(`Updated card status for member ${memberId} to ${newStatus}`);\n    } catch (error) {\n      console.error(`Error recalculating card status for member ${memberId}:`, error);\n      throw error;\n    }\n  }\n}\n\nexport const cardService = new CardService();","size_bytes":5892},"client/src/pages/lidkaarten.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { LiveCard } from \"@/components/cards/live-card\";\nimport { CardCanvas } from \"@/components/card/CardCanvas\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { \n  Search, \n  Filter, \n  Eye, \n  RefreshCw, \n  Trash2,\n  CreditCard,\n  Users,\n  CheckCircle2,\n  Clock,\n  MoreHorizontal,\n  Plus,\n  ExternalLink,\n  AlertTriangle,\n  ChevronUp,\n  ChevronDown\n} from \"lucide-react\";\nimport { CiExport, CiCreditCardOff } from \"react-icons/ci\";\nimport { MdOutlineBrowserUpdated } from \"react-icons/md\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport type { Member, CardMeta, Tenant } from \"@shared/schema\";\nimport previewBackgroundImage from \"@assets/de-lege-achtergrond-van-de-fotograafstudio-samenvatting-achtergrondtextuur-van-schoonheid-donker-en-licht-duidelijk-blauw-koud-grijs-sneeuwwit-gradient-vlakke-muur-en-vloer_1757089301495.jpg\";\n\ninterface CardWithMember {\n  member: Member;\n  cardMeta: CardMeta | null;\n}\n\ninterface CardStats {\n  totalActive: number;\n  validPercentage: number;\n  lastUpdated: Date | null;\n}\n\ninterface SortConfig {\n  key: string | null;\n  direction: 'asc' | 'desc';\n}\n\nfunction getMemberCategoryLabel(category: string): string {\n  switch (category) {\n    case 'STUDENT':\n      return 'Student';\n    case 'STANDAARD':\n      return 'Volwassen';\n    case 'SENIOR':\n      return 'Senior';\n    default:\n      return category;\n  }\n}\n\nfunction getStatusLabel(status: string): string {\n  switch (status) {\n    case 'ACTUEEL':\n      return 'Actueel';\n    case 'MOMENTOPNAME':\n      return 'Momentopname';\n    case 'VERLOPEN':\n      return 'Verlopen';\n    default:\n      return status;\n  }\n}\n\nfunction getStatusVariant(status: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" {\n  switch (status) {\n    case 'ACTUEEL':\n      return 'default';\n    case 'MOMENTOPNAME':\n      return 'secondary';\n    case 'VERLOPEN':\n      return 'destructive';\n    default:\n      return 'outline';\n  }\n}\n\nexport default function LidkaartenPage() {\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n  const [categoryFilter, setCategoryFilter] = useState<string>('all');\n  const [previewCard, setPreviewCard] = useState<CardWithMember | null>(null);\n  const [selectedIds, setSelectedIds] = useState<string[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: null, direction: 'asc' });\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch cards data\n  const { data: cards = [], isLoading: cardsLoading } = useQuery<CardWithMember[]>({\n    queryKey: ['/api/cards'],\n    queryFn: async () => {\n      const response = await apiRequest('GET', '/api/cards');\n      return response.json();\n    },\n  });\n\n  // Fetch card statistics\n  const { data: stats } = useQuery<CardStats>({\n    queryKey: ['/api/cards/stats'],\n    queryFn: async () => {\n      const response = await apiRequest('GET', '/api/cards/stats');\n      return response.json();\n    },\n  });\n\n  // Fetch tenant data for card preview\n  const { data: tenant } = useQuery<Tenant>({\n    queryKey: ['/api/tenant/current'],\n    queryFn: async () => {\n      const response = await apiRequest('GET', '/api/tenant/current');\n      return response.json();\n    },\n  });\n\n  // Create card mutation\n  const createCardMutation = useMutation({\n    mutationFn: async (memberId: string) => {\n      const response = await apiRequest('POST', `/api/cards/${memberId}/create`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/cards'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/cards/stats'] });\n      toast({ title: \"Lidkaart aangemaakt\", description: \"De kaart is succesvol aangemaakt.\" });\n    },\n    onError: () => {\n      toast({ \n        title: \"Fout\", \n        description: \"Kon de kaart niet aanmaken. Probeer opnieuw.\", \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  // Regenerate card mutation\n  const regenerateCardMutation = useMutation({\n    mutationFn: async (memberId: string) => {\n      const response = await apiRequest('POST', `/api/cards/${memberId}/regenerate`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/cards'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/cards/stats'] });\n      toast({ title: \"Lidkaart geregenereerd\", description: \"De kaart is succesvol bijgewerkt met nieuwe tokens.\" });\n    },\n    onError: () => {\n      toast({ \n        title: \"Fout\", \n        description: \"Kon de kaart niet regenereren. Probeer opnieuw.\", \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  // Deactivate card mutation\n  const deactivateCardMutation = useMutation({\n    mutationFn: async (memberId: string) => {\n      const response = await apiRequest('POST', `/api/cards/${memberId}/deactivate`);\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/cards'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/cards/stats'] });\n      toast({ title: \"Lidkaart gedeactiveerd\", description: \"De kaart is verlopen en niet meer geldig.\" });\n    },\n    onError: () => {\n      toast({ \n        title: \"Fout\", \n        description: \"Kon de kaart niet deactiveren. Probeer opnieuw.\", \n        variant: \"destructive\" \n      });\n    },\n  });\n\n  // Sort and selection functions\n  const handleSort = (key: string) => {\n    const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';\n    setSortConfig({ key, direction });\n  };\n\n  const handleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(filteredCards.map(({ member }) => member.id));\n    } else {\n      setSelectedIds([]);\n    }\n  };\n\n  const handleSelectRow = (memberId: string, checked: boolean) => {\n    if (checked) {\n      setSelectedIds([...selectedIds, memberId]);\n    } else {\n      setSelectedIds(selectedIds.filter(id => id !== memberId));\n    }\n  };\n\n  const getSortIcon = (key: string) => {\n    if (sortConfig.key !== key) {\n      return <ChevronUp className=\"h-3 w-3 text-gray-400\" />;\n    }\n    return sortConfig.direction === 'asc' \n      ? <ChevronUp className=\"h-3 w-3 text-gray-700\" />\n      : <ChevronDown className=\"h-3 w-3 text-gray-700\" />;\n  };\n\n  // Filter and sort cards based on search, filters, and sort config\n  const filteredCards = useMemo(() => {\n    let filtered = cards.filter(({ member, cardMeta }) => {\n      // Search filter\n      const searchMatch = searchTerm === '' || \n        member.memberNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        `${member.firstName} ${member.lastName}`.toLowerCase().includes(searchTerm.toLowerCase());\n\n      // Status filter\n      const statusMatch = statusFilter === 'all' || \n        (cardMeta?.status === statusFilter) ||\n        (statusFilter === 'geen-kaart' && !cardMeta);\n\n      // Category filter  \n      const categoryMatch = categoryFilter === 'all' || member.category === categoryFilter;\n\n      return searchMatch && statusMatch && categoryMatch;\n    });\n\n    // Apply sorting\n    if (sortConfig.key) {\n      filtered.sort((a, b) => {\n        let aValue: any;\n        let bValue: any;\n\n        switch (sortConfig.key) {\n          case 'memberNumber':\n            aValue = a.member.memberNumber;\n            bValue = b.member.memberNumber;\n            break;\n          case 'name':\n            aValue = `${a.member.lastName} ${a.member.firstName}`;\n            bValue = `${b.member.lastName} ${b.member.firstName}`;\n            break;\n          case 'category':\n            aValue = a.member.category;\n            bValue = b.member.category;\n            break;\n          case 'status':\n            aValue = a.cardMeta?.status || 'GEEN_KAART';\n            bValue = b.cardMeta?.status || 'GEEN_KAART';\n            break;\n          case 'validUntil':\n            aValue = a.cardMeta?.validUntil || '';\n            bValue = b.cardMeta?.validUntil || '';\n            break;\n          case 'lastRenderedAt':\n            aValue = a.cardMeta?.lastRenderedAt || '';\n            bValue = b.cardMeta?.lastRenderedAt || '';\n            break;\n          default:\n            return 0;\n        }\n\n        if (aValue < bValue) {\n          return sortConfig.direction === 'asc' ? -1 : 1;\n        }\n        if (aValue > bValue) {\n          return sortConfig.direction === 'asc' ? 1 : -1;\n        }\n        return 0;\n      });\n    }\n\n    return filtered;\n  }, [cards, searchTerm, statusFilter, categoryFilter, sortConfig]);\n\n  const handlePreview = (cardData: CardWithMember) => {\n    setPreviewCard(cardData);\n  };\n\n  const handleCreateCard = (memberId: string) => {\n    createCardMutation.mutate(memberId);\n  };\n\n  const handleRegenerateCard = (memberId: string) => {\n    regenerateCardMutation.mutate(memberId);\n  };\n\n  const handleDeactivateCard = (memberId: string) => {\n    deactivateCardMutation.mutate(memberId);\n  };\n\n\n  const handleViewCard = (member: Member) => {\n    // Use public card page - standalone like public screens\n    const cardUrl = `/public/card/${member.id}`;\n    // Open in new tab/window for standalone viewing\n    window.open(cardUrl, '_blank');\n  };\n\n  const handleExport = () => {\n    // TODO: Implement export functionality\n    toast({ title: \"Export\", description: \"Export functionaliteit wordt binnenkort toegevoegd.\" });\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Lidkaarten</h1>\n            <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer alle digitale lidkaarten van uw leden</p>\n          </div>\n        </div>\n\n        {/* KPI Cards */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\n          <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Actieve Lidkaarten</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">{stats?.totalActive || 0}</p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-green-600\">\n                  kaarten met status 'Actueel'\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-green-50 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <CreditCard className=\"h-4 w-4 text-green-600\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Verlopen Kaarten</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">\n                {filteredCards.filter(({ cardMeta }) => \n                  cardMeta?.status === 'VERLOPEN'\n                ).length}\n              </p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-red-500\">\n                  kaarten met status 'Verlopen'\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-red-50 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <AlertTriangle className=\"h-4 w-4 text-red-500\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Geen Kaart</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">\n                {filteredCards.filter(({ cardMeta }) => \n                  !cardMeta\n                ).length}\n              </p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-gray-400\">\n                  leden zonder lidkaart\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <CiCreditCardOff className=\"h-4 w-4 text-gray-400\" />\n            </div>\n          </div>\n        </div>\n\n        <div className=\"glass-card rounded-xl p-4 card-hover animate-fade-in group\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex-1\">\n              <p className=\"text-xs font-medium text-muted-foreground mb-1\">Laatst Bijgewerkt</p>\n              <p className=\"text-lg font-bold text-foreground mb-2 group-hover:text-primary transition-colors duration-300\">\n                {stats?.lastUpdated \n                  ? format(new Date(stats.lastUpdated), 'dd MMM', { locale: nl })\n                  : 'N.v.t.'\n                }\n              </p>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-xs font-medium text-amber-500\">\n                  meest recente kaartupdate\n                </span>\n              </div>\n            </div>\n            <div className=\"w-10 h-10 bg-amber-50 rounded-xl flex items-center justify-center shadow-md ring-2 ring-white/10 group-hover:scale-110 transition-transform duration-300\">\n              <MdOutlineBrowserUpdated className=\"h-4 w-4 text-amber-500\" />\n            </div>\n          </div>\n        </div>\n      </div>\n\n        {/* Search and Filters */}\n        <Card className=\"mb-6\">\n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              {/* Search and Export Button */}\n              <div className=\"flex flex-col lg:flex-row gap-4\">\n                <div className=\"relative flex-1\">\n                  <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                  <Input\n                    placeholder=\"Zoek op lidnummer of naam...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-10 pr-16 h-10 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20\"\n                    data-testid=\"input-search\"\n                  />\n                </div>\n                \n                <div className=\"flex gap-2 lg:flex-shrink-0\">\n                  {selectedIds.length > 0 && (\n                    <div className=\"flex gap-2 mr-2\">\n                      <Badge variant=\"secondary\" className=\"px-3 py-1\">\n                        {selectedIds.length} geselecteerd\n                      </Badge>\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\"\n                        onClick={() => setSelectedIds([])}\n                        className=\"h-8\"\n                      >\n                        Wis selectie\n                      </Button>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Filters */}\n              <div className=\"flex flex-wrap gap-3\">\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\n                  <SelectTrigger className=\"w-[160px] h-9 border-gray-200\" data-testid=\"select-status\">\n                    <SelectValue placeholder=\"Alle statussen\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Alle statussen</SelectItem>\n                    <SelectItem value=\"ACTUEEL\">Actueel</SelectItem>\n                    <SelectItem value=\"VERLOPEN\">Verlopen</SelectItem>\n                    <SelectItem value=\"geen-kaart\">Geen kaart</SelectItem>\n                  </SelectContent>\n                </Select>\n\n                <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n                  <SelectTrigger className=\"w-[170px] h-9 border-gray-200\" data-testid=\"select-category\">\n                    <SelectValue placeholder=\"Alle categorieën\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Alle categorieën</SelectItem>\n                    <SelectItem value=\"STUDENT\">Student</SelectItem>\n                    <SelectItem value=\"STANDAARD\">Standaard</SelectItem>\n                    <SelectItem value=\"SENIOR\">Senior</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n      {/* Cards Table */}\n      <Card>\n        <Table>\n          <TableHeader>\n            <TableRow>\n              <TableHead className=\"w-12\">\n                <Checkbox\n                  checked={selectedIds.length === filteredCards.length && filteredCards.length > 0}\n                  onCheckedChange={handleSelectAll}\n                  aria-label=\"Selecteer alle kaarten\"\n                />\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('memberNumber')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Lidnummer\n                  {getSortIcon('memberNumber')}\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('name')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Naam\n                  {getSortIcon('name')}\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"hidden md:table-cell cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('category')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Categorie\n                  {getSortIcon('category')}\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('status')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Status\n                  {getSortIcon('status')}\n                </div>\n              </TableHead>\n              <TableHead \n                className=\"hidden lg:table-cell cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('validUntil')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Geldig tot\n                  {getSortIcon('validUntil')}\n                </div>\n              </TableHead>\n              <TableHead className=\"hidden lg:table-cell\">Versie</TableHead>\n              <TableHead \n                className=\"hidden xl:table-cell cursor-pointer hover:bg-gray-50\"\n                onClick={() => handleSort('lastRenderedAt')}\n              >\n                <div className=\"flex items-center gap-2\">\n                  Laatste update\n                  {getSortIcon('lastRenderedAt')}\n                </div>\n              </TableHead>\n              <TableHead className=\"text-right\">Acties</TableHead>\n            </TableRow>\n          </TableHeader>\n          <TableBody>\n            {cardsLoading ? (\n              <TableRow>\n                <TableCell colSpan={9} className=\"text-center py-8\">\n                  <div className=\"flex items-center justify-center gap-2\">\n                    <RefreshCw className=\"h-4 w-4 animate-spin\" />\n                    Lidkaarten laden...\n                  </div>\n                </TableCell>\n              </TableRow>\n            ) : filteredCards.length === 0 ? (\n              <TableRow>\n                <TableCell colSpan={9} className=\"text-center py-8 text-muted-foreground\">\n                  Geen lidkaarten gevonden die voldoen aan de filters\n                </TableCell>\n              </TableRow>\n            ) : (\n              filteredCards.map(({ member, cardMeta }) => (\n                <TableRow \n                  key={member.id}\n                  className={selectedIds.includes(member.id) ? \"bg-blue-50\" : \"\"}\n                >\n                  <TableCell>\n                    <Checkbox\n                      checked={selectedIds.includes(member.id)}\n                      onCheckedChange={(checked) => handleSelectRow(member.id, !!checked)}\n                      aria-label={`Selecteer ${member.firstName} ${member.lastName}`}\n                    />\n                  </TableCell>\n                  <TableCell className=\"font-mono\">{member.memberNumber}</TableCell>\n                  <TableCell className=\"font-medium\">\n                    {member.firstName} {member.lastName}\n                  </TableCell>\n                  <TableCell className=\"hidden md:table-cell\">{getMemberCategoryLabel(member.category)}</TableCell>\n                  <TableCell>\n                    <Badge variant={getStatusVariant(cardMeta?.status || 'GEEN_KAART')}>\n                      {cardMeta ? getStatusLabel(cardMeta.status) : 'Geen kaart'}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"hidden lg:table-cell\">\n                    {cardMeta?.validUntil \n                      ? format(new Date(cardMeta.validUntil), 'dd/MM/yyyy', { locale: nl })\n                      : '-'\n                    }\n                  </TableCell>\n                  <TableCell className=\"hidden lg:table-cell\">{cardMeta?.version || '-'}</TableCell>\n                  <TableCell className=\"hidden xl:table-cell\">\n                    {cardMeta?.lastRenderedAt \n                      ? format(new Date(cardMeta.lastRenderedAt), 'dd/MM/yyyy HH:mm', { locale: nl })\n                      : '-'\n                    }\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"h-8 w-8\"\n                          data-testid={`actions-menu-${member.id}`}\n                        >\n                          <MoreHorizontal className=\"h-4 w-4\" />\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent align=\"end\" className=\"w-48\">\n                        {cardMeta ? (\n                          <>\n                            <DropdownMenuItem \n                              onClick={() => handlePreview({ member, cardMeta })}\n                              className=\"flex items-center gap-2\"\n                            >\n                              <Eye className=\"h-4 w-4\" />\n                              Bekijken\n                            </DropdownMenuItem>\n                            <DropdownMenuItem \n                              onClick={() => handleRegenerateCard(member.id)}\n                              disabled={regenerateCardMutation.isPending}\n                              className=\"flex items-center gap-2\"\n                            >\n                              <RefreshCw className={`h-4 w-4 ${regenerateCardMutation.isPending ? 'animate-spin' : ''}`} />\n                              Genereer\n                            </DropdownMenuItem>\n                          </>\n                        ) : (\n                          <DropdownMenuItem \n                            onClick={() => handleCreateCard(member.id)}\n                            disabled={createCardMutation.isPending}\n                            className=\"flex items-center gap-2\"\n                          >\n                            <Plus className=\"h-4 w-4\" />\n                            Maak kaart aan\n                          </DropdownMenuItem>\n                        )}\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  </TableCell>\n                </TableRow>\n              ))\n            )}\n          </TableBody>\n        </Table>\n      </Card>\n\n      {/* Preview Modal */}\n      <Dialog open={!!previewCard} onOpenChange={() => setPreviewCard(null)}>\n        <DialogContent className=\"max-w-5xl max-h-[95vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Lidkaart Preview</DialogTitle>\n          </DialogHeader>\n          \n          {previewCard && tenant && (\n            <div className=\"space-y-4\">\n              <div \n                className=\"relative min-h-[400px] rounded-lg overflow-hidden flex items-center justify-center p-8\"\n                style={{\n                  backgroundImage: `url(${previewBackgroundImage})`,\n                  backgroundSize: 'cover',\n                  backgroundPosition: 'center',\n                  backgroundRepeat: 'no-repeat'\n                }}\n              >\n                <div className=\"w-full max-w-[600px] aspect-[16/10]\">\n                  <CardCanvas className=\"rounded-lg shadow-2xl\">\n                    <LiveCard\n                      member={previewCard.member}\n                      cardMeta={previewCard.cardMeta!}\n                      tenant={tenant}\n                      standalone={true}\n                      className=\"h-full w-full\"\n                    />\n                  </CardCanvas>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-end gap-2 pt-4 border-t\">\n                <Button\n                  onClick={() => handleRegenerateCard(previewCard.member.id)}\n                  disabled={regenerateCardMutation.isPending}\n                  variant=\"outline\"\n                  className=\"gap-2\"\n                >\n                  <RefreshCw className={`h-4 w-4 ${regenerateCardMutation.isPending ? 'animate-spin' : ''}`} />\n                  Regenereren\n                </Button>\n                \n                <Button\n                  onClick={() => handleViewCard(previewCard.member)}\n                  variant=\"outline\"\n                  className=\"gap-2\"\n                >\n                  <ExternalLink className=\"h-4 w-4\" />\n                  Kaart openen\n                </Button>\n                \n                <Button\n                  onClick={() => setPreviewCard(null)}\n                  variant=\"default\"\n                >\n                  Sluiten\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n      </div>\n    </main>\n  );\n}","size_bytes":28483},"client/src/components/pwa/install-prompt.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { X, Download, Smartphone } from 'lucide-react';\nimport { PWAInstaller } from '@/lib/pwa';\n\nexport function InstallPrompt() {\n  const [showPrompt, setShowPrompt] = useState(false);\n  const [isInstalling, setIsInstalling] = useState(false);\n\n  useEffect(() => {\n    // Check if already installed\n    if (PWAInstaller.isInstalled()) {\n      return;\n    }\n\n    // Listen for installable event\n    const handleInstallable = () => {\n      setShowPrompt(true);\n    };\n\n    const handleInstalled = () => {\n      setShowPrompt(false);\n    };\n\n    window.addEventListener('pwa-installable', handleInstallable);\n    window.addEventListener('pwa-installed', handleInstalled);\n\n    return () => {\n      window.removeEventListener('pwa-installable', handleInstallable);\n      window.removeEventListener('pwa-installed', handleInstalled);\n    };\n  }, []);\n\n  const handleInstall = async () => {\n    try {\n      setIsInstalling(true);\n      const result = await PWAInstaller.showInstallPrompt();\n      \n      if (result === 'accepted') {\n        setShowPrompt(false);\n      }\n    } catch (error) {\n      console.error('Install failed:', error);\n    } finally {\n      setIsInstalling(false);\n    }\n  };\n\n  const handleDismiss = () => {\n    setShowPrompt(false);\n    // Don't show again for this session\n    sessionStorage.setItem('install-prompt-dismissed', 'true');\n  };\n\n  // Don't show if dismissed this session\n  if (sessionStorage.getItem('install-prompt-dismissed')) {\n    return null;\n  }\n\n  if (!showPrompt) {\n    return null;\n  }\n\n  return (\n    <Card className=\"fixed bottom-4 left-4 right-4 z-50 shadow-lg border-blue-200 bg-gradient-to-r from-blue-50 to-indigo-50 mx-auto max-w-md\">\n      <CardContent className=\"p-4\">\n        <div className=\"flex items-start gap-3\">\n          <div className=\"flex-shrink-0\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n              <Smartphone className=\"h-5 w-5 text-blue-600\" />\n            </div>\n          </div>\n          \n          <div className=\"flex-1 min-w-0\">\n            <h3 className=\"text-sm font-semibold text-gray-900 mb-1\">\n              Installeer Ledenbeheer\n            </h3>\n            <p className=\"text-xs text-gray-600 mb-3\">\n              Krijg snelle toegang tot uw lidkaarten en beheer, zelfs offline.\n            </p>\n            \n            <div className=\"flex gap-2\">\n              <Button\n                onClick={handleInstall}\n                disabled={isInstalling}\n                size=\"sm\"\n                className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n              >\n                <Download className=\"h-3 w-3 mr-1\" />\n                {isInstalling ? 'Installeren...' : 'Installeren'}\n              </Button>\n              \n              <Button\n                onClick={handleDismiss}\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"text-gray-500 hover:text-gray-700\"\n              >\n                Later\n              </Button>\n            </div>\n          </div>\n          \n          <Button\n            onClick={handleDismiss}\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"flex-shrink-0 h-6 w-6 text-gray-400 hover:text-gray-600\"\n          >\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":3519},"client/src/components/pwa/offline-indicator.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Card } from '@/components/ui/card';\nimport { WifiOff, Wifi, Clock } from 'lucide-react';\nimport { NetworkStatus } from '@/lib/pwa';\n\nexport function OfflineIndicator() {\n  const [isOnline, setIsOnline] = useState(NetworkStatus.isOnline());\n  const [showOfflineMessage, setShowOfflineMessage] = useState(false);\n\n  useEffect(() => {\n    // Initialize network monitoring\n    const cleanup = NetworkStatus.init((online) => {\n      setIsOnline(online);\n      \n      if (!online) {\n        setShowOfflineMessage(true);\n      } else {\n        // Hide offline message after 3 seconds when back online\n        setTimeout(() => setShowOfflineMessage(false), 3000);\n      }\n    });\n\n    return cleanup;\n  }, []);\n\n  // Don't show indicator if online and no recent offline event\n  if (isOnline && !showOfflineMessage) {\n    return null;\n  }\n\n  return (\n    <Card className={`fixed top-4 right-4 z-50 shadow-lg transition-all duration-300 ${\n      isOnline \n        ? 'bg-green-50 border-green-200' \n        : 'bg-amber-50 border-amber-200'\n    }`}>\n      <div className=\"px-4 py-3\">\n        <div className=\"flex items-center gap-3\">\n          <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${\n            isOnline \n              ? 'bg-green-100' \n              : 'bg-amber-100'\n          }`}>\n            {isOnline ? (\n              <Wifi className=\"h-4 w-4 text-green-600\" />\n            ) : (\n              <WifiOff className=\"h-4 w-4 text-amber-600\" />\n            )}\n          </div>\n          \n          <div className=\"flex-1\">\n            <div className={`text-sm font-medium ${\n              isOnline ? 'text-green-800' : 'text-amber-800'\n            }`}>\n              {isOnline ? 'Verbinding hersteld' : 'Offline modus'}\n            </div>\n            <div className={`text-xs ${\n              isOnline ? 'text-green-600' : 'text-amber-600'\n            }`}>\n              {isOnline ? (\n                'Alle functies beschikbaar'\n              ) : (\n                <div className=\"flex items-center gap-1\">\n                  <Clock className=\"h-3 w-3\" />\n                  Momentopname - beperkte functionaliteit\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </Card>\n  );\n}","size_bytes":2327},"client/src/components/pwa/pwa-manager.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { \n  Smartphone, \n  Download, \n  Trash2, \n  WifiOff, \n  Wifi, \n  RefreshCw,\n  Database,\n  Settings\n} from 'lucide-react';\nimport { CacheManager, NetworkStatus, NotificationManager, PWAInstaller } from '@/lib/pwa';\n\nexport function PWAManager() {\n  const [cacheSize, setCacheSize] = useState<number>(0);\n  const [isOnline, setIsOnline] = useState(NetworkStatus.isOnline());\n  const [isInstalled, setIsInstalled] = useState(PWAInstaller.isInstalled());\n  const [isInstallable, setIsInstallable] = useState(false);\n  const [notificationPermission, setNotificationPermission] = useState<NotificationPermission | 'unsupported'>('default');\n  const [isClearing, setIsClearing] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n\n  useEffect(() => {\n    // Load initial data\n    loadCacheSize();\n    setNotificationPermission(NotificationManager.getPermission());\n\n    // Listen for PWA events\n    const handleInstallable = () => setIsInstallable(true);\n    const handleInstalled = () => {\n      setIsInstalled(true);\n      setIsInstallable(false);\n    };\n    const handleOnline = () => setIsOnline(true);\n    const handleOffline = () => setIsOnline(false);\n\n    window.addEventListener('pwa-installable', handleInstallable);\n    window.addEventListener('pwa-installed', handleInstalled);\n    window.addEventListener('network-online', handleOnline);\n    window.addEventListener('network-offline', handleOffline);\n\n    return () => {\n      window.removeEventListener('pwa-installable', handleInstallable);\n      window.removeEventListener('pwa-installed', handleInstalled);\n      window.removeEventListener('network-online', handleOnline);\n      window.removeEventListener('network-offline', handleOffline);\n    };\n  }, []);\n\n  const loadCacheSize = async () => {\n    try {\n      const size = await CacheManager.getCacheSize();\n      setCacheSize(size);\n    } catch (error) {\n      console.error('Failed to get cache size:', error);\n    }\n  };\n\n  const handleClearCache = async () => {\n    setIsClearing(true);\n    try {\n      await CacheManager.clearCache();\n      setCacheSize(0);\n      console.log('[PWA] Cache cleared successfully');\n    } catch (error) {\n      console.error('Failed to clear cache:', error);\n    } finally {\n      setIsClearing(false);\n    }\n  };\n\n  const handleRefreshCache = async () => {\n    setIsRefreshing(true);\n    try {\n      // Reload the page to refresh cache\n      window.location.reload();\n    } catch (error) {\n      console.error('Failed to refresh cache:', error);\n    } finally {\n      setIsRefreshing(false);\n    }\n  };\n\n  const handleInstallApp = async () => {\n    try {\n      await PWAInstaller.showInstallPrompt();\n    } catch (error) {\n      console.error('Install failed:', error);\n    }\n  };\n\n  const handleRequestNotifications = async () => {\n    try {\n      const permission = await NotificationManager.requestPermission();\n      setNotificationPermission(permission);\n    } catch (error) {\n      console.error('Notification permission failed:', error);\n    }\n  };\n\n  const handleTestNotification = () => {\n    NotificationManager.showNotification('Test Melding', {\n      body: 'Dit is een test melding van de Ledenbeheer app',\n      tag: 'test-notification'\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* PWA Status */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Smartphone className=\"h-5 w-5\" />\n            PWA Status\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium\">Verbinding</span>\n                <Badge variant={isOnline ? 'default' : 'destructive'}>\n                  {isOnline ? (\n                    <>\n                      <Wifi className=\"h-3 w-3 mr-1\" />\n                      Online\n                    </>\n                  ) : (\n                    <>\n                      <WifiOff className=\"h-3 w-3 mr-1\" />\n                      Offline\n                    </>\n                  )}\n                </Badge>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium\">Installatie</span>\n                <Badge variant={isInstalled ? 'default' : 'secondary'}>\n                  {isInstalled ? 'Geïnstalleerd' : 'Browser'}\n                </Badge>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium\">Cache Grootte</span>\n                <span className=\"text-sm text-muted-foreground\">\n                  {CacheManager.formatBytes(cacheSize)}\n                </span>\n              </div>\n              \n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm font-medium\">Meldingen</span>\n                <Badge variant={\n                  notificationPermission === 'granted' ? 'default' :\n                  notificationPermission === 'denied' ? 'destructive' : 'secondary'\n                }>\n                  {notificationPermission === 'granted' ? 'Toegestaan' :\n                   notificationPermission === 'denied' ? 'Geweigerd' :\n                   notificationPermission === 'unsupported' ? 'Niet ondersteund' : 'Niet gevraagd'}\n                </Badge>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* PWA Actions */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Settings className=\"h-5 w-5\" />\n            PWA Acties\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n            {/* Install App */}\n            {!isInstalled && isInstallable && (\n              <Button \n                onClick={handleInstallApp} \n                className=\"flex items-center gap-2\"\n              >\n                <Download className=\"h-4 w-4\" />\n                App Installeren\n              </Button>\n            )}\n\n            {/* Clear Cache */}\n            <Button \n              onClick={handleClearCache} \n              disabled={isClearing || cacheSize === 0}\n              variant=\"outline\"\n              className=\"flex items-center gap-2\"\n            >\n              <Trash2 className=\"h-4 w-4\" />\n              {isClearing ? 'Wissen...' : 'Cache Wissen'}\n            </Button>\n\n            {/* Refresh Cache */}\n            <Button \n              onClick={handleRefreshCache} \n              disabled={isRefreshing}\n              variant=\"outline\"\n              className=\"flex items-center gap-2\"\n            >\n              <RefreshCw className={`h-4 w-4 ${isRefreshing ? 'animate-spin' : ''}`} />\n              {isRefreshing ? 'Vernieuwen...' : 'Cache Vernieuwen'}\n            </Button>\n\n            {/* Request Notifications */}\n            {notificationPermission === 'default' && (\n              <Button \n                onClick={handleRequestNotifications} \n                variant=\"outline\"\n                className=\"flex items-center gap-2\"\n              >\n                <Database className=\"h-4 w-4\" />\n                Meldingen Toestaan\n              </Button>\n            )}\n\n            {/* Test Notification */}\n            {notificationPermission === 'granted' && (\n              <Button \n                onClick={handleTestNotification} \n                variant=\"outline\"\n                className=\"flex items-center gap-2\"\n              >\n                <Database className=\"h-4 w-4\" />\n                Test Melding\n              </Button>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Development Info */}\n      {import.meta.env.DEV && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Database className=\"h-5 w-5\" />\n              Ontwikkelaar Info\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div className=\"space-y-2 text-sm\">\n              <div className=\"flex justify-between\">\n                <span className=\"font-medium\">Omgeving:</span>\n                <Badge variant=\"secondary\">Ontwikkeling</Badge>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"font-medium\">Service Worker:</span>\n                <Badge variant=\"secondary\">Uitgeschakeld</Badge>\n              </div>\n              <div className=\"flex justify-between\">\n                <span className=\"font-medium\">User Agent:</span>\n                <span className=\"text-xs text-muted-foreground max-w-64 truncate\">\n                  {navigator.userAgent}\n                </span>\n              </div>\n            </div>\n            \n            <div className=\"text-xs text-muted-foreground p-3 bg-muted rounded-md\">\n              <strong>Opmerking:</strong> In ontwikkelingsmodus is de service worker uitgeschakeld. \n              PWA functies zoals offline ondersteuning werken alleen in productie.\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":9719},"client/src/lib/pwa.ts":{"content":"// PWA Utilities voor Ledenbeheer\n\ninterface BeforeInstallPromptEvent extends Event {\n  readonly platforms: string[];\n  prompt(): Promise<void>;\n  readonly userChoice: Promise<{\n    outcome: 'accepted' | 'dismissed';\n    platform: string;\n  }>;\n}\n\ndeclare global {\n  interface WindowEventMap {\n    beforeinstallprompt: BeforeInstallPromptEvent;\n  }\n}\n\nlet deferredPrompt: BeforeInstallPromptEvent | null = null;\n\n// PWA Install Prompt Management\nexport const PWAInstaller = {\n  // Check if app is installable\n  isInstallable: () => {\n    return deferredPrompt !== null;\n  },\n\n  // Check if app is already installed\n  isInstalled: () => {\n    return window.matchMedia('(display-mode: standalone)').matches ||\n           window.matchMedia('(display-mode: fullscreen)').matches ||\n           // @ts-ignore\n           window.navigator.standalone === true;\n  },\n\n  // Initialize PWA install prompt\n  init: () => {\n    window.addEventListener('beforeinstallprompt', (e) => {\n      console.log('[PWA] Install prompt available');\n      e.preventDefault();\n      deferredPrompt = e;\n      \n      // Dispatch custom event for components to listen\n      window.dispatchEvent(new CustomEvent('pwa-installable'));\n    });\n\n    window.addEventListener('appinstalled', () => {\n      console.log('[PWA] App installed');\n      deferredPrompt = null;\n      \n      // Show success message\n      window.dispatchEvent(new CustomEvent('pwa-installed'));\n    });\n  },\n\n  // Show install prompt\n  showInstallPrompt: async () => {\n    if (!deferredPrompt) {\n      throw new Error('Install prompt not available');\n    }\n\n    try {\n      await deferredPrompt.prompt();\n      const choiceResult = await deferredPrompt.userChoice;\n      \n      console.log('[PWA] User choice:', choiceResult.outcome);\n      \n      if (choiceResult.outcome === 'accepted') {\n        console.log('[PWA] User accepted install');\n      } else {\n        console.log('[PWA] User dismissed install');\n      }\n      \n      deferredPrompt = null;\n      return choiceResult.outcome;\n    } catch (error) {\n      console.error('[PWA] Install prompt error:', error);\n      throw error;\n    }\n  }\n};\n\n// Online/Offline Status Management\nexport const NetworkStatus = {\n  // Check if currently online\n  isOnline: () => navigator.onLine,\n\n  // Initialize network status monitoring\n  init: (onStatusChange?: (isOnline: boolean) => void) => {\n    const handleOnline = () => {\n      console.log('[PWA] Network: Online');\n      onStatusChange?.(true);\n      window.dispatchEvent(new CustomEvent('network-online'));\n    };\n\n    const handleOffline = () => {\n      console.log('[PWA] Network: Offline');\n      onStatusChange?.(false);\n      window.dispatchEvent(new CustomEvent('network-offline'));\n    };\n\n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n\n    // Return cleanup function\n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }\n};\n\n// Cache Management\nexport const CacheManager = {\n  // Clear all caches\n  clearCache: async () => {\n    if ('caches' in window) {\n      const cacheNames = await caches.keys();\n      await Promise.all(\n        cacheNames.map(cacheName => caches.delete(cacheName))\n      );\n      console.log('[PWA] All caches cleared');\n    }\n  },\n\n  // Get cache size\n  getCacheSize: async (): Promise<number> => {\n    if (!('caches' in window)) return 0;\n\n    let totalSize = 0;\n    const cacheNames = await caches.keys();\n    \n    for (const cacheName of cacheNames) {\n      const cache = await caches.open(cacheName);\n      const requests = await cache.keys();\n      \n      for (const request of requests) {\n        const response = await cache.match(request);\n        if (response) {\n          const blob = await response.blob();\n          totalSize += blob.size;\n        }\n      }\n    }\n    \n    return totalSize;\n  },\n\n  // Format bytes to human readable\n  formatBytes: (bytes: number): string => {\n    if (bytes === 0) return '0 Bytes';\n    \n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    \n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }\n};\n\n// Background Sync\nexport const BackgroundSync = {\n  // Register background sync\n  register: async (tag: string = 'background-sync') => {\n    if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {\n      try {\n        const registration = await navigator.serviceWorker.ready;\n        await registration.sync.register(tag);\n        console.log('[PWA] Background sync registered:', tag);\n      } catch (error) {\n        console.error('[PWA] Background sync registration failed:', error);\n      }\n    }\n  }\n};\n\n// Notification Management\nexport const NotificationManager = {\n  // Check notification permission\n  getPermission: () => {\n    if ('Notification' in window) {\n      return Notification.permission;\n    }\n    return 'unsupported';\n  },\n\n  // Request notification permission\n  requestPermission: async (): Promise<NotificationPermission | 'unsupported'> => {\n    if (!('Notification' in window)) {\n      return 'unsupported';\n    }\n\n    const permission = await Notification.requestPermission();\n    console.log('[PWA] Notification permission:', permission);\n    return permission;\n  },\n\n  // Show local notification\n  showNotification: (title: string, options?: NotificationOptions) => {\n    if ('serviceWorker' in navigator && 'Notification' in window) {\n      navigator.serviceWorker.ready.then(registration => {\n        registration.showNotification(title, {\n          icon: '/icon-192.svg',\n          badge: '/icon-192.svg',\n          ...options\n        });\n      });\n    }\n  }\n};\n\n// Initialize all PWA features\nexport const initPWA = () => {\n  console.log('[PWA] Initializing PWA features...');\n  \n  // Always initialize these features regardless of service worker support\n  PWAInstaller.init();\n  NetworkStatus.init();\n  \n  // Log environment info\n  if (import.meta.env.DEV) {\n    console.log('[PWA] Running in development mode - service worker disabled');\n  }\n  \n  if (PWAInstaller.isInstalled()) {\n    console.log('[PWA] App is running as installed PWA');\n  }\n  \n  console.log('[PWA] PWA features initialized');\n};","size_bytes":6342},"client/src/pages/card-verify.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { useRoute } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { \n  CheckCircle, \n  XCircle, \n  AlertTriangle, \n  RefreshCw, \n  Calendar,\n  User,\n  Users,\n  Crown,\n  QrCode,\n  Scan\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { MembershipCard } from \"@/components/card/MembershipCard\";\nimport { QuickAuthModal } from \"@/components/auth/quick-auth-modal\";\nimport QrScanner from \"qr-scanner\";\nimport backgroundImage from \"@assets/Luxury Navy Background_1757015851301.jpg\";\n\ninterface CardVerificationData {\n  status: string;\n  validUntil: string | null;\n  eligibleToVote: boolean;\n  member: {\n    name: string;\n    memberNumber: string;\n    category: string;\n    age: number | null;\n  };\n  tenant: {\n    name: string;\n    logoUrl?: string;\n  };\n  fees: Array<{\n    id: string;\n    period: string;\n    amount: number;\n    status: string;\n    periodEnd: string;\n    paidAt: string | null;\n  }>;\n  paymentStatus: {\n    summary: string;\n    details: string[];\n    totalOutstanding: number;\n    totalPaid: number;\n    hasOutstanding: boolean;\n  };\n  boardInfo?: {\n    isActiveBoardMember: boolean;\n    role: string;\n    customRole?: string;\n  } | null;\n  refreshedAt: string;\n  etag: string;\n}\n\nconst STATUS_CONFIG = {\n  ACTUEEL: {\n    label: \"Actueel\",\n    color: \"bg-green-100 text-green-800 border-green-200\",\n    icon: CheckCircle\n  },\n  NIET_ACTUEEL: {\n    label: \"Niet actueel\",\n    color: \"bg-orange-100 text-orange-800 border-orange-200\",\n    icon: AlertTriangle\n  },\n  VERLOPEN: {\n    label: \"Verlopen\", \n    color: \"bg-red-100 text-red-800 border-red-200\",\n    icon: XCircle\n  },\n  INGETROKKEN: {\n    label: \"Ingetrokken\",\n    color: \"bg-gray-100 text-gray-800 border-gray-200\", \n    icon: XCircle\n  },\n  UNKNOWN: {\n    label: \"Onbekend\",\n    color: \"bg-yellow-100 text-yellow-800 border-yellow-200\",\n    icon: AlertTriangle\n  }\n} as const;\n\nfunction StatusBadge({ status }: { status: string }) {\n  const config = STATUS_CONFIG[status as keyof typeof STATUS_CONFIG] || STATUS_CONFIG.UNKNOWN;\n  const Icon = config.icon;\n\n  return (\n    <Badge className={cn(\"text-sm font-medium px-3 py-1.5 gap-2\", config.color)}>\n      <Icon className=\"h-4 w-4\" />\n      {config.label}\n    </Badge>\n  );\n}\n\nfunction VerificationView({ qrToken }: { qrToken: string }) {\n  // ALL HOOKS DECLARED AT THE TOP - NEVER CONDITIONAL\n  const [data, setData] = useState<CardVerificationData | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [refreshing, setRefreshing] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [authUser, setAuthUser] = useState<any>(null);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n  const [showScanner, setShowScanner] = useState(false);\n  const [scanning, setScanning] = useState(false);\n  const [authChecked, setAuthChecked] = useState(false);\n  \n  const videoRef = useRef<HTMLVideoElement>(null);\n  const qrScannerRef = useRef<QrScanner | null>(null);\n\n  // Stable fetch function\n  const fetchData = useCallback(async (isRefresh = false) => {\n    try {\n      if (isRefresh) setRefreshing(true);\n      else setLoading(true);\n      \n      const verifyToken = sessionStorage.getItem('qr_verify_token');\n      const response = await fetch(`/api/card/verify/${qrToken}`, {\n        headers: {\n          'Authorization': `Bearer ${verifyToken}`,\n        },\n      });\n      \n      if (response.status === 401) {\n        setIsAuthenticated(false);\n        setShowAuthModal(true);\n        setLoading(false);\n        setRefreshing(false);\n        return;\n      }\n      \n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || 'Er ging iets mis');\n      }\n      \n      const result = await response.json();\n      setData(result);\n      setError(null);\n    } catch (err: any) {\n      setError(err.message);\n      setData(null);\n    } finally {\n      setLoading(false);\n      setRefreshing(false);\n    }\n  }, [qrToken]);\n\n  const handleAuthenticated = useCallback((token: string) => {\n    setIsAuthenticated(true);\n    setShowAuthModal(false);\n    \n    const userJson = sessionStorage.getItem('qr_verify_user');\n    if (userJson) {\n      setAuthUser(JSON.parse(userJson));\n    }\n    \n    fetchData();\n  }, [fetchData]);\n\n  const handleLogout = useCallback(() => {\n    sessionStorage.removeItem('qr_verify_token');\n    sessionStorage.removeItem('qr_verify_user');\n    setIsAuthenticated(false);\n    setAuthUser(null);\n    setData(null);\n    setShowAuthModal(true);\n  }, []);\n\n  const stopScanning = useCallback(() => {\n    if (qrScannerRef.current) {\n      qrScannerRef.current.stop();\n      qrScannerRef.current.destroy();\n      qrScannerRef.current = null;\n    }\n    setScanning(false);\n    setShowScanner(false);\n  }, []);\n\n  const startScanning = useCallback(() => {\n    setShowScanner(true);\n  }, []);\n\n  // Initialize scanner when modal opens\n  useEffect(() => {\n    if (showScanner && videoRef.current && !qrScannerRef.current) {\n      const initScanner = async () => {\n        try {\n          setScanning(true);\n          \n          qrScannerRef.current = new QrScanner(\n            videoRef.current!,\n            (result) => {\n              const qrCodeText = result.data;\n              // Support both old and new URL patterns\n              const urlMatch = qrCodeText.match(/\\/card\\/(?:verify\\/)?([a-f0-9]+)/);\n              if (urlMatch && urlMatch[1]) {\n                const newToken = urlMatch[1];\n                stopScanning();\n                window.location.href = `/card/verify/${newToken}`;\n              }\n            },\n            {\n              returnDetailedScanResult: true,\n              highlightScanRegion: true,\n              highlightCodeOutline: true,\n            }\n          );\n          \n          await qrScannerRef.current.start();\n        } catch (err) {\n          console.error('Failed to start QR scanner:', err);\n          setScanning(false);\n          setShowScanner(false);\n        }\n      };\n\n      initScanner();\n    }\n  }, [showScanner, stopScanning]);\n\n  // Check for existing auth on load\n  useEffect(() => {\n    const token = sessionStorage.getItem('qr_verify_token');\n    const userJson = sessionStorage.getItem('qr_verify_user');\n    \n    if (token && userJson) {\n      setIsAuthenticated(true);\n      setAuthUser(JSON.parse(userJson));\n      fetchData();\n    } else {\n      setIsAuthenticated(false);\n      setShowAuthModal(true);\n      setLoading(false);\n    }\n    setAuthChecked(true);\n  }, [fetchData]);\n\n  // Cleanup scanner on unmount\n  useEffect(() => {\n    return () => {\n      stopScanning();\n    };\n  }, [stopScanning]);\n\n  // Show auth modal if not authenticated\n  if (!authChecked || (!isAuthenticated && showAuthModal)) {\n    return (\n      <QuickAuthModal\n        isOpen={showAuthModal}\n        onAuthenticated={handleAuthenticated}\n      />\n    );\n  }\n\n  if (loading) {\n    return (\n      <Card className=\"w-full max-w-4xl mx-auto\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex items-center justify-center py-12\">\n            <RefreshCw className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (error) {\n    return (\n      <Card className=\"w-full max-w-4xl mx-auto\">\n        <CardContent className=\"pt-6\">\n          <div className=\"text-center space-y-4\">\n            <XCircle className=\"h-12 w-12 text-red-500 mx-auto\" />\n            <div>\n              <h3 className=\"font-semibold text-lg\">Verificatie mislukt</h3>\n              <p className=\"text-muted-foreground mt-1\">{error}</p>\n            </div>\n            <Button \n              onClick={() => fetchData()} \n              variant=\"outline\"\n              className=\"gap-2\"\n            >\n              <RefreshCw className=\"h-4 w-4\" />\n              Opnieuw proberen\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  if (!data) {\n    return (\n      <Card className=\"w-full max-w-4xl mx-auto\">\n        <CardContent className=\"pt-6\">\n          <div className=\"text-center space-y-4\">\n            <AlertTriangle className=\"h-12 w-12 text-yellow-500 mx-auto\" />\n            <div>\n              <h3 className=\"font-semibold text-lg\">Geen gegevens gevonden</h3>\n              <p className=\"text-muted-foreground mt-1\">Er konden geen verificatiegegevens worden geladen.</p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"w-full max-w-4xl mx-auto\">\n      <CardHeader>\n        <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n          <div>\n            <CardTitle className=\"text-2xl font-bold\">Lidkaart Verificatie</CardTitle>\n            <p className=\"text-muted-foreground\">Controle van digitale lidkaart</p>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            {authUser && (\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <User className=\"h-4 w-4\" />\n                {authUser.name}\n              </div>\n            )}\n            <Button\n              onClick={handleLogout}\n              variant=\"outline\"\n              size=\"sm\"\n            >\n              Uitloggen\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      \n      <CardContent className=\"space-y-6\">\n        {/* Verification Result */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <CheckCircle className=\"h-5 w-5 text-green-500\" />\n                Verificatie Gelukt\n              </CardTitle>\n              <StatusBadge status={data.status || 'UNKNOWN'} />\n            </div>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <User className=\"h-4 w-4\" />\n                  Lid\n                </div>\n                <p className=\"font-medium\">\n                  {data.member.name}\n                </p>\n                <p className=\"text-sm text-muted-foreground\">\n                  Lidnummer: {data.member.memberNumber}\n                </p>\n                <div className=\"flex gap-4 text-sm\">\n                  <span className=\"text-muted-foreground\">Categorie:</span>\n                  <span className=\"font-medium\">{data.member.category}</span>\n                </div>\n                {data.member.age && (\n                  <div className=\"flex gap-4 text-sm\">\n                    <span className=\"text-muted-foreground\">Leeftijd:</span>\n                    <span className=\"font-medium\">{data.member.age} jaar</span>\n                  </div>\n                )}\n              </div>\n              \n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Calendar className=\"h-4 w-4\" />\n                  Geldigheid\n                </div>\n                <p className=\"text-sm\">\n                  <span className=\"text-muted-foreground\">Geldig tot:</span> {data.validUntil || 'Onbekend'}\n                </p>\n                <p className=\"text-sm\">\n                  <span className=\"text-muted-foreground\">Stemgerechtigd:</span> {data.eligibleToVote ? 'Ja' : 'Nee'}\n                </p>\n              </div>\n\n              {/* Board Member Information */}\n              {data.boardInfo?.isActiveBoardMember && (\n                <div className=\"space-y-2\">\n                  <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                    <Crown className=\"h-4 w-4\" />\n                    Bestuursinformatie\n                  </div>\n                  <div className=\"p-3 rounded-lg border bg-purple-50 border-purple-200 text-purple-800\">\n                    <p className=\"font-medium text-sm\">\n                      Actief Bestuurslid\n                    </p>\n                    <p className=\"text-xs mt-1\">\n                      Functie: {data.boardInfo.customRole || data.boardInfo.role}\n                    </p>\n                  </div>\n                </div>\n              )}\n\n              <div className=\"space-y-2\">\n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <Crown className=\"h-4 w-4\" />\n                  Betaalstatus\n                </div>\n                <div className={`p-3 rounded-lg border ${\n                  data.paymentStatus.hasOutstanding \n                    ? 'bg-orange-50 border-orange-200 text-orange-800' \n                    : 'bg-green-50 border-green-200 text-green-800'\n                }`}>\n                  <p className=\"font-medium text-sm\">\n                    {data.paymentStatus.summary}\n                  </p>\n                  {data.paymentStatus.hasOutstanding && data.paymentStatus.details && data.paymentStatus.details.length > 0 && (\n                    <div className=\"mt-2 space-y-1\">\n                      {data.paymentStatus.details.map((detail, index) => (\n                        <p key={index} className=\"text-xs opacity-90 leading-relaxed\">\n                          {detail}\n                        </p>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            <div className=\"pt-4 border-t\">\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground mb-2\">\n                <Users className=\"h-4 w-4\" />\n                Organisatie\n              </div>\n              <div className=\"flex items-center gap-3\">\n                {data.tenant.logoUrl && (\n                  <img \n                    src={data.tenant.logoUrl} \n                    alt={data.tenant.name}\n                    className=\"h-8 w-auto\"\n                  />\n                )}\n                <span className=\"font-medium\">{data.tenant.name}</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Actions */}\n        <div className=\"flex flex-wrap gap-3\">\n          <Button\n            onClick={() => fetchData(true)}\n            disabled={refreshing}\n            variant=\"outline\"\n            className=\"gap-2\"\n          >\n            <RefreshCw className={cn(\"h-4 w-4\", refreshing && \"animate-spin\")} />\n            {refreshing ? 'Vernieuwen...' : 'Vernieuwen'}\n          </Button>\n          \n          <Button\n            onClick={startScanning}\n            variant=\"default\"\n            className=\"gap-2 bg-blue-600 hover:bg-blue-700\"\n          >\n            <Scan className=\"h-4 w-4\" />\n            Scan Volgende QR Code\n          </Button>\n        </div>\n\n        {/* QR Scanner Modal */}\n        {showScanner && (\n          <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n            <Card className=\"max-w-sm w-full mx-4\">\n              <CardContent className=\"p-6 space-y-4\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-lg font-semibold\">QR Code Scannen</h3>\n                  <Button\n                    onClick={stopScanning}\n                    variant=\"ghost\"\n                    size=\"sm\"\n                  >\n                    <XCircle className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                \n                <div className=\"relative\">\n                  <video\n                    ref={videoRef}\n                    className=\"w-full rounded-lg bg-black\"\n                    style={{ aspectRatio: '1' }}\n                  />\n                  {scanning && (\n                    <div className=\"absolute inset-0 flex items-center justify-center\">\n                      <div className=\"text-white text-sm bg-black/50 px-2 py-1 rounded\">\n                        Zoeken naar QR code...\n                      </div>\n                    </div>\n                  )}\n                </div>\n                \n                <p className=\"text-sm text-muted-foreground text-center\">\n                  Richt de camera op de QR code van een lidkaart om deze te verifiëren\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function CardVerifyPage() {\n  const [, params] = useRoute(\"/card/verify/:qrToken\");\n  const qrToken = params?.qrToken;\n\n  return (\n    <div \n      className=\"min-h-screen flex items-center justify-center p-4\"\n      style={{\n        backgroundImage: `url(\"${backgroundImage}\")`,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center',\n        backgroundRepeat: 'no-repeat'\n      }}\n    >\n      {/* Background overlay */}\n      <div className=\"absolute inset-0 bg-black/30\"></div>\n      \n      <div className=\"relative z-10 w-full max-w-4xl\">\n        {!qrToken ? (\n          <Card className=\"max-w-md mx-auto\">\n            <CardContent className=\"pt-6\">\n              <div className=\"text-center space-y-4\">\n                <QrCode className=\"h-12 w-12 text-muted-foreground mx-auto\" />\n                <div>\n                  <h3 className=\"font-semibold text-lg\">Ongeldige QR Code</h3>\n                  <p className=\"text-muted-foreground mt-1\">De QR code kon niet worden gelezen.</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        ) : (\n          <VerificationView qrToken={qrToken} />\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":18014},"client/src/components/card/CardCanvas.tsx":{"content":"import React from 'react';\nimport '../../styles/card-canvas.css';\n\ninterface CardCanvasProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport function CardCanvas({ children, className = '' }: CardCanvasProps) {\n  // Check if we're in a modal/constrained container by checking if className contains modal indicators\n  const isConstrained = className.includes('rounded-lg') || className.includes('modal') || className.includes('preview');\n  \n  return (\n    <>\n      {React.isValidElement(children) && children.type && typeof children.type === 'function' && children.type.name === 'MembershipCard' \n        ? React.cloneElement(children as React.ReactElement<any>, { isConstrained })\n        : children}\n    </>\n  );\n}","size_bytes":729},"client/src/components/card/FullScreenButton.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { Maximize, Minimize } from 'lucide-react';\n\nexport function FullScreenButton() {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  useEffect(() => {\n    const handleFullscreenChange = () => {\n      setIsFullscreen(!!document.fullscreenElement);\n    };\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'f' || event.key === 'F') {\n        event.preventDefault();\n        toggleFullscreen();\n      }\n    };\n\n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    document.addEventListener('keydown', handleKeyDown);\n\n    return () => {\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, []);\n\n  const toggleFullscreen = async () => {\n    try {\n      if (!document.fullscreenElement) {\n        await document.documentElement.requestFullscreen();\n      } else {\n        await document.exitFullscreen();\n      }\n    } catch (error) {\n      console.warn('Volledig scherm niet ondersteund:', error);\n    }\n  };\n\n  // Only show on desktop/tablet devices\n  const isDesktop = typeof window !== 'undefined' && window.innerWidth >= 768;\n\n  if (!isDesktop) {\n    return null;\n  }\n\n  return (\n    <button\n      onClick={toggleFullscreen}\n      aria-label={isFullscreen ? 'Volledig scherm verlaten' : 'Volledig scherm'}\n      className={`\n        fixed top-4 right-4 z-50\n        p-3 rounded-full\n        bg-black/20 hover:bg-black/30\n        backdrop-blur-sm\n        text-white/80 hover:text-white\n        transition-all duration-200\n        focus:outline-none focus:ring-2 focus:ring-blue-400/50\n        focus-visible:ring-2 focus-visible:ring-blue-400\n      `}\n      data-testid=\"button-fullscreen\"\n    >\n      {isFullscreen ? (\n        <Minimize className=\"w-5 h-5\" />\n      ) : (\n        <Maximize className=\"w-5 h-5\" />\n      )}\n    </button>\n  );\n}","size_bytes":1968},"client/src/styles/card-canvas.css":{"content":"/* Premium studio background for digital membership cards */\n\n.bg-spotlight {\n  background-image: url('@assets/abstract-dark-blurred-background-smooth-gradient-texture-color-shiny-bright-website-pattern-banner-header-sidebar-graphic-art-image_1258-82927_1756899831718.jpg');\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n}\n\n.bg-vignette {\n  position: relative;\n}\n\n.bg-vignette::before {\n  content: '';\n  position: absolute;\n  inset: 0;\n  background: radial-gradient(circle at 50% 50%, transparent 40%, rgba(0, 0, 0, 0.1) 100%);\n  pointer-events: none;\n  z-index: 1;\n}\n\n.bg-sheen {\n  position: relative;\n}\n\n.bg-sheen::after {\n  content: '';\n  position: absolute;\n  inset: 0;\n  background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, transparent 50%, rgba(255, 255, 255, 0.03) 100%);\n  pointer-events: none;\n  z-index: 2;\n}\n\n.bg-grain {\n  position: relative;\n}\n\n.bg-grain::before {\n  content: '';\n  position: absolute;\n  inset: 0;\n  background-image: \n    url(\"data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='1' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E\");\n  opacity: 0.04;\n  pointer-events: none;\n  z-index: 3;\n  mix-blend-mode: overlay;\n}\n\n.bg-rimlight {\n  position: relative;\n}\n\n.bg-rimlight::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 120%;\n  height: 80%;\n  background: radial-gradient(ellipse, rgba(139, 92, 246, 0.12) 0%, transparent 70%);\n  transform: translate(-50%, -50%);\n  filter: blur(50px);\n  pointer-events: none;\n  z-index: 0;\n}\n\n/* Reduced motion support */\n@media (prefers-reduced-motion: reduce) {\n  .bg-sheen::after,\n  .bg-rimlight::after {\n    animation: none;\n  }\n}\n\n/* Status LED glow effects */\n.status-led-glow-green {\n  box-shadow: 0 0 8px rgba(34, 197, 94, 0.4), 0 0 16px rgba(34, 197, 94, 0.2);\n  animation: pulse-green 2s ease-in-out infinite;\n}\n\n.status-led-glow-orange {\n  box-shadow: 0 0 8px rgba(245, 158, 11, 0.4), 0 0 16px rgba(245, 158, 11, 0.2);\n  animation: pulse-orange 2s ease-in-out infinite;\n}\n\n.status-led-glow-red {\n  box-shadow: 0 0 8px rgba(239, 68, 68, 0.4), 0 0 16px rgba(239, 68, 68, 0.2);\n  animation: pulse-red 2s ease-in-out infinite;\n}\n\n@keyframes pulse-green {\n  0%, 100% { box-shadow: 0 0 8px rgba(34, 197, 94, 0.4), 0 0 16px rgba(34, 197, 94, 0.2); }\n  50% { box-shadow: 0 0 12px rgba(34, 197, 94, 0.6), 0 0 24px rgba(34, 197, 94, 0.3); }\n}\n\n@keyframes pulse-orange {\n  0%, 100% { box-shadow: 0 0 8px rgba(245, 158, 11, 0.4), 0 0 16px rgba(245, 158, 11, 0.2); }\n  50% { box-shadow: 0 0 12px rgba(245, 158, 11, 0.6), 0 0 24px rgba(245, 158, 11, 0.3); }\n}\n\n@keyframes pulse-red {\n  0%, 100% { box-shadow: 0 0 8px rgba(239, 68, 68, 0.4), 0 0 16px rgba(239, 68, 68, 0.2); }\n  50% { box-shadow: 0 0 12px rgba(239, 68, 68, 0.6), 0 0 24px rgba(239, 68, 68, 0.3); }\n}\n\n/* Card font - Space Grotesk for bank-card feel */\n.card-font {\n  font-family: 'Space Grotesk', -apple-system, BlinkMacSystemFont, sans-serif;\n  font-feature-settings: 'tnum' 1; /* Tabular numerals */\n}\n\n/* Embossed text effect */\n.embossed-text {\n  color: #EAF2FF;\n  text-shadow: \n    0 1px 0 rgba(255, 255, 255, 0.1),\n    0 -1px 0 rgba(0, 0, 0, 0.3),\n    0 1px 2px rgba(0, 0, 0, 0.5);\n}\n\n/* High contrast mode support */\n@media (prefers-contrast: high) {\n  .bg-spotlight {\n    background: #000000;\n  }\n  \n  .bg-vignette::before,\n  .bg-sheen::after,\n  .bg-grain::before,\n  .bg-rimlight::after {\n    display: none;\n  }\n  \n  .status-led-glow-green,\n  .status-led-glow-orange,\n  .status-led-glow-red {\n    box-shadow: none;\n    animation: none;\n  }\n}\n\n/* Reduced motion support */\n@media (prefers-reduced-motion: reduce) {\n  .status-led-glow-green,\n  .status-led-glow-orange,\n  .status-led-glow-red {\n    animation: none;\n  }\n}","size_bytes":3939},"client/public/sw.js":{"content":"// Service Worker for Digital Membership Card PWA\nconst CACHE_NAME = 'lidkaart-v1';\nconst STATIC_CACHE = 'lidkaart-static-v1';\n\n// Cache static assets with StaleWhileRevalidate\nconst STATIC_ASSETS = [\n  '/',\n  '/manifest.webmanifest',\n  '/icon-192.svg',\n  '/icon-512.svg'\n];\n\n// NetworkFirst strategy for verify API - offline shows NIET_ACTUEEL\nconst VERIFY_API_PATTERN = /\\/api\\/card\\/verify\\//;\n\nself.addEventListener('install', (event) => {\n  console.log('[SW] Installing service worker');\n  \n  event.waitUntil(\n    caches.open(STATIC_CACHE).then((cache) => {\n      return cache.addAll(STATIC_ASSETS);\n    })\n  );\n  \n  // Take control immediately\n  self.skipWaiting();\n});\n\nself.addEventListener('activate', (event) => {\n  console.log('[SW] Activating service worker');\n  \n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheName !== CACHE_NAME && cacheName !== STATIC_CACHE) {\n            console.log('[SW] Deleting old cache:', cacheName);\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    }).then(() => {\n      // Take control of all clients\n      return self.clients.claim();\n    })\n  );\n});\n\nself.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  // Handle verify API with NetworkFirst - offline = NIET_ACTUEEL\n  if (VERIFY_API_PATTERN.test(url.pathname)) {\n    event.respondWith(\n      fetch(request)\n        .then((response) => {\n          // Cache successful responses\n          if (response.ok) {\n            const responseClone = response.clone();\n            caches.open(CACHE_NAME).then((cache) => {\n              cache.put(request, responseClone);\n            });\n          }\n          return response;\n        })\n        .catch(() => {\n          // Offline: return NIET_ACTUEEL status\n          return caches.match(request).then((cachedResponse) => {\n            if (cachedResponse) {\n              return cachedResponse.json().then((data) => {\n                // Override status to show card is not current offline\n                const offlineData = {\n                  ...data,\n                  status: 'NIET_ACTUEEL',\n                  refreshedAt: new Date().toISOString(),\n                  offline: true\n                };\n                return new Response(JSON.stringify(offlineData), {\n                  headers: { 'Content-Type': 'application/json' }\n                });\n              });\n            }\n            \n            // No cache: return offline error\n            return new Response(JSON.stringify({\n              error: 'Geen internetverbinding',\n              status: 'NIET_ACTUEEL',\n              offline: true\n            }), {\n              status: 503,\n              headers: { 'Content-Type': 'application/json' }\n            });\n          });\n        })\n    );\n    return;\n  }\n\n  // Handle static assets with StaleWhileRevalidate\n  if (request.destination === 'document' || \n      request.destination === 'script' || \n      request.destination === 'style' ||\n      request.destination === 'image') {\n    \n    event.respondWith(\n      caches.open(STATIC_CACHE).then((cache) => {\n        return cache.match(request).then((cachedResponse) => {\n          const fetchPromise = fetch(request).then((networkResponse) => {\n            // Update cache with fresh response\n            if (networkResponse.ok) {\n              cache.put(request, networkResponse.clone());\n            }\n            return networkResponse;\n          }).catch(() => {\n            // Network failed, return cached version if available\n            return cachedResponse;\n          });\n\n          // Return cached version immediately, update in background\n          return cachedResponse || fetchPromise;\n        });\n      })\n    );\n    return;\n  }\n\n  // Default: network only for other requests\n  event.respondWith(fetch(request));\n});\n\n// Handle background sync for offline actions\nself.addEventListener('sync', (event) => {\n  console.log('[SW] Background sync:', event.tag);\n  \n  if (event.tag === 'card-refresh') {\n    event.waitUntil(\n      // Clear verify cache to force fresh fetch on next request\n      caches.open(CACHE_NAME).then((cache) => {\n        return cache.keys().then((keys) => {\n          return Promise.all(\n            keys.filter(key => VERIFY_API_PATTERN.test(key.url))\n                .map(key => cache.delete(key))\n          );\n        });\n      })\n    );\n  }\n});\n\n// Push notifications (if needed later)\nself.addEventListener('push', (event) => {\n  console.log('[SW] Push received');\n  // Handle push notifications for card updates\n});","size_bytes":4657},"client/src/components/pwa/InstallCoach.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { usePlatform } from '@/hooks/usePlatform';\nimport { useA2HS } from '@/hooks/useA2HS';\nimport { storage } from '@/lib/storage';\n\nconst installMessages = {\n  title: \"Zet je lidkaart op je startscherm\",\n  subtitle: \"Zo open je ze snel en blijft ze altijd bij de hand.\",\n  buttons: {\n    install: \"App installeren\",\n    later: \"Later\",\n    never: \"Niet meer tonen\",\n  },\n  ios: [\n    \"Tik op Deel (het vierkantje met pijltje omhoog).\",\n    \"Kies 'Zet op beginscherm' in de lijst.\",\n    \"Bevestig met 'Toevoegen'.\",\n  ],\n  android: [\n    \"Als er een knop 'App installeren' verschijnt, tik daarop om meteen toe te voegen.\",\n    \"Of open het Menu ⋮ rechtsboven.\",\n    \"Kies 'App installeren' of 'Aan startscherm toevoegen'.\",\n    \"Bevestig.\",\n  ],\n  samsung: [\n    \"Open het Menu ☰ (linksonder of rechtsboven, afhankelijk van toestel).\",\n    \"Kies 'Toevoegen aan startscherm'.\",\n    \"Bevestig.\",\n  ],\n  desktop: [\n    \"Klik in de adresbalk op het installatie-icoon (⤓ of +).\",\n    \"Kies 'Installeren'.\",\n    \"Je lidkaart opent voortaan in een apart venster als app.\",\n  ],\n  fallback: [\n    \"Sla deze pagina op als snelkoppeling via het browsermenu.\",\n    \"Daarna vind je de lidkaart terug in je startscherm of favorieten.\",\n  ],\n} as const;\n\ninterface InstallCoachProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function InstallCoach({ isOpen, onClose }: InstallCoachProps) {\n  const platform = usePlatform();\n  const { canPrompt, promptInstall } = useA2HS();\n\n  // Select platform-specific instructions\n  let steps: readonly string[] = [];\n  switch (platform) {\n    case \"ios-safari\":\n      steps = installMessages.ios;\n      break;\n    case \"android-chrome\":\n      steps = installMessages.android;\n      break;\n    case \"samsung-internet\":\n      steps = installMessages.samsung;\n      break;\n    case \"desktop-chromium\":\n      steps = installMessages.desktop;\n      break;\n    default:\n      steps = installMessages.fallback;\n  }\n\n  const handleInstall = async () => {\n    const success = await promptInstall();\n    if (success) {\n      onClose();\n    }\n  };\n\n  const handleDismiss = (permanent: boolean) => {\n    if (permanent) {\n      storage.set(storage.PWA_INSTALL_COACH_DISMISSED, 'true');\n    }\n    onClose();\n  };\n\n  const handleKeyDown = (event: React.KeyboardEvent) => {\n    if (event.key === 'Escape') {\n      handleDismiss(false);\n    }\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={() => handleDismiss(false)}>\n      <DialogContent \n        className=\"max-w-md focus:outline-none\"\n        onKeyDown={handleKeyDown}\n        aria-labelledby=\"install-coach-title\"\n        aria-describedby=\"install-coach-subtitle\"\n      >\n        <DialogHeader className=\"space-y-3\">\n          <DialogTitle id=\"install-coach-title\" className=\"text-lg font-semibold\">\n            {installMessages.title}\n          </DialogTitle>\n          \n          <p id=\"install-coach-subtitle\" className=\"text-sm text-muted-foreground\">\n            {installMessages.subtitle}\n          </p>\n        </DialogHeader>\n\n        <div className=\"space-y-6\">\n          {/* Platform-specific instructions */}\n          <div className=\"space-y-4\">\n            <ol className=\"list-decimal ml-6 space-y-1 text-sm text-muted-foreground\">\n              {steps.map((step, index) => (\n                <li key={index} className=\"leading-relaxed\">\n                  {step}\n                </li>\n              ))}\n            </ol>\n          </div>\n\n          {/* Action buttons */}\n          <div className=\"flex flex-col gap-3\">\n            {canPrompt && (\n              <Button \n                onClick={handleInstall}\n                className=\"w-full\"\n                data-testid=\"button-install-app\"\n              >\n                {installMessages.buttons.install}\n              </Button>\n            )}\n            \n            <div className=\"flex gap-2\">\n              <Button \n                variant=\"outline\" \n                onClick={() => handleDismiss(false)}\n                className=\"flex-1\"\n                data-testid=\"button-install-later\"\n              >\n                {installMessages.buttons.later}\n              </Button>\n              <Button \n                variant=\"ghost\" \n                onClick={() => handleDismiss(true)}\n                className=\"flex-1 text-muted-foreground\"\n                data-testid=\"button-install-dismiss\"\n              >\n                {installMessages.buttons.never}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n// Hook to manage InstallCoach state\nexport function useInstallCoach() {\n  const [isOpen, setIsOpen] = useState(false);\n  const { isInstalled } = useA2HS();\n\n  useEffect(() => {\n    // Don't show if already installed or previously dismissed\n    if (isInstalled) return;\n    \n    const dismissed = storage.get(storage.PWA_INSTALL_COACH_DISMISSED);\n    if (dismissed === 'true') return;\n\n    // Show after a short delay to avoid interfering with page load\n    const timer = setTimeout(() => {\n      setIsOpen(true);\n    }, 2000);\n\n    return () => clearTimeout(timer);\n  }, [isInstalled]);\n\n  return {\n    isOpen,\n    close: () => setIsOpen(false)\n  };\n}","size_bytes":5389},"client/src/hooks/useA2HS.ts":{"content":"import { useState, useEffect } from 'react';\n\ninterface BeforeInstallPromptEvent extends Event {\n  prompt(): Promise<void>;\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed' }>;\n}\n\nexport function useA2HS() {\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\n  const [isInstallable, setIsInstallable] = useState(false);\n  const [isInstalled, setIsInstalled] = useState(false);\n\n  useEffect(() => {\n    // Check if running as PWA\n    const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||\n                        (window.navigator as any).standalone ||\n                        document.referrer.includes('android-app://');\n    \n    setIsInstalled(isStandalone);\n\n    const handleBeforeInstallPrompt = (e: Event) => {\n      e.preventDefault();\n      setDeferredPrompt(e as BeforeInstallPromptEvent);\n      setIsInstallable(true);\n    };\n\n    const handleAppInstalled = () => {\n      setIsInstalled(true);\n      setIsInstallable(false);\n      setDeferredPrompt(null);\n    };\n\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    window.addEventListener('appinstalled', handleAppInstalled);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n    };\n  }, []);\n\n  const promptInstall = async (): Promise<boolean> => {\n    if (!deferredPrompt) return false;\n\n    try {\n      await deferredPrompt.prompt();\n      const { outcome } = await deferredPrompt.userChoice;\n      \n      if (outcome === 'accepted') {\n        setIsInstalled(true);\n        setIsInstallable(false);\n        setDeferredPrompt(null);\n        return true;\n      }\n      \n      return false;\n    } catch (error) {\n      console.warn('Install prompt failed:', error);\n      return false;\n    }\n  };\n\n  return {\n    isInstallable,\n    isInstalled,\n    promptInstall,\n    canPrompt: !!deferredPrompt\n  };\n}","size_bytes":1995},"client/src/hooks/usePlatform.ts":{"content":"import { useState, useEffect } from 'react';\n\nexport type Platform = 'ios-safari' | 'android-chrome' | 'samsung-internet' | 'desktop-chromium' | 'other';\n\nexport function usePlatform(): Platform {\n  const [platform, setPlatform] = useState<Platform>('other');\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n\n    const userAgent = window.navigator.userAgent.toLowerCase();\n    const isIOS = /iphone|ipad|ipod/.test(userAgent);\n    const isSafari = /safari/.test(userAgent) && !/chrome/.test(userAgent);\n    const isChrome = /chrome/.test(userAgent);\n    const isSamsung = /samsungbrowser/.test(userAgent);\n    const isAndroid = /android/.test(userAgent);\n    const isDesktop = !/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent);\n\n    if (isIOS && isSafari) {\n      setPlatform('ios-safari');\n    } else if (isAndroid && isSamsung) {\n      setPlatform('samsung-internet');\n    } else if (isAndroid && isChrome) {\n      setPlatform('android-chrome');\n    } else if (isDesktop && isChrome) {\n      setPlatform('desktop-chromium');\n    } else {\n      setPlatform('other');\n    }\n  }, []);\n\n  return platform;\n}","size_bytes":1157},"client/src/lib/storage.ts":{"content":"// Local storage utilities with error handling\n\nexport const storage = {\n  get: (key: string): string | null => {\n    try {\n      if (typeof window === 'undefined') return null;\n      return localStorage.getItem(key);\n    } catch (error) {\n      console.warn('localStorage get failed:', error);\n      return null;\n    }\n  },\n\n  set: (key: string, value: string): boolean => {\n    try {\n      if (typeof window === 'undefined') return false;\n      localStorage.setItem(key, value);\n      return true;\n    } catch (error) {\n      console.warn('localStorage set failed:', error);\n      return false;\n    }\n  },\n\n  remove: (key: string): boolean => {\n    try {\n      if (typeof window === 'undefined') return false;\n      localStorage.removeItem(key);\n      return true;\n    } catch (error) {\n      console.warn('localStorage remove failed:', error);\n      return false;\n    }\n  },\n\n  // PWA specific keys\n  PWA_INSTALL_COACH_DISMISSED: 'LB_PWA_INSTALL_COACH_V1'\n};","size_bytes":961},"client/src/components/card/AspectBox.tsx":{"content":"import { AspectRatio } from \"@/components/ui/aspect-ratio\";\nimport { cn } from \"@/lib/utils\";\n\ninterface AspectBoxProps {\n  children: React.ReactNode;\n  ratio?: number; // defaults to 1586/1000 (credit card ratio)\n  className?: string;\n}\n\nexport function AspectBox({ children, ratio = 1586/1000, className }: AspectBoxProps) {\n  return (\n    <div className={cn(\"w-full\", className)}>\n      <AspectRatio ratio={ratio}>\n        {children}\n      </AspectRatio>\n    </div>\n  );\n}","size_bytes":475},"client/src/components/card/MembershipCard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { RefreshCw, Wifi, WifiOff, Clock } from \"lucide-react\";\nimport { PiUserCircleCheckLight } from \"react-icons/pi\";\nimport { cn } from \"@/lib/utils\";\nimport { BoardMemberBadge } from \"@/components/ui/board-member-badge\";\nimport { useBoardMemberStatus } from \"@/hooks/useBoardMemberStatus\";\n// Crown import removed as icon is no longer used\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport fadingBlueBackground from \"@assets/fading-blue-background_1756897101831.jpg\";\n\ninterface CardData {\n  memberId?: string;\n  firstName: string;\n  lastName: string;\n  memberNumber: string;\n  category: 'STUDENT' | 'STANDAARD' | 'SENIOR';\n  status: 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN';\n  validUntil: Date | null;\n  votingRights: boolean;\n  qrToken: string;\n  tenant: {\n    name: string;\n    logoUrl?: string | null;\n    primaryColor: string;\n  };\n  etag: string;\n}\n\ninterface MembershipCardProps {\n  cardData: CardData;\n  onRefresh?: () => void;\n  isRefreshing?: boolean;\n  isOffline?: boolean;\n  className?: string;\n  triggerFlip?: boolean;\n  isConstrained?: boolean;\n}\n\ninterface StatusLEDProps {\n  status: CardData['status'];\n  className?: string;\n}\n\nfunction StatusLED({ status, className }: StatusLEDProps) {\n  const statusConfig = {\n    ACTUEEL: {\n      color: 'bg-[#22C55E]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(34, 197, 94, 0.18)' },\n      label: 'Actueel',\n    },\n    NIET_ACTUEEL: {\n      color: 'bg-[#F59E0B]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(245, 158, 11, 0.18)' },\n      label: 'Niet actueel',\n    },\n    VERLOPEN: {\n      color: 'bg-[#EF4444]',\n      glowStyle: { boxShadow: '0 0 0 3px rgba(239, 68, 68, 0.18)' },\n      label: 'Verlopen',\n    },\n  };\n\n  const config = statusConfig[status];\n\n  return (\n    <div className={cn(\"flex items-center gap-2\", className)}>\n      <div \n        className={cn(\"w-4 h-4 rounded-full\", config.color)}\n        style={config.glowStyle}\n        aria-hidden=\"true\"\n      />\n      <span className=\"text-sm font-medium card-font debossed-text\">\n        {config.label}\n      </span>\n    </div>\n  );\n}\n\nfunction getMemberCategoryLabel(category: CardData['category']): string {\n  switch (category) {\n    case 'STUDENT':\n      return 'Student';\n    case 'STANDAARD':\n      return 'Standaard';\n    case 'SENIOR':\n      return 'Senior';\n    default:\n      return category;\n  }\n}\n\nexport function MembershipCard({ \n  cardData, \n  onRefresh, \n  isRefreshing = false,\n  isOffline = false,\n  className = \"\",\n  triggerFlip = false,\n  isConstrained = false\n}: MembershipCardProps) {\n  const [showQRModal, setShowQRModal] = useState(false);\n  const [isFlipping, setIsFlipping] = useState(false);\n  \n  // Check board member status\n  const { isActiveBoardMember } = useBoardMemberStatus(cardData.memberId || '');\n  \n  // Board member status and voting rights are now properly displayed\n\n  // Generate QR code URL for verification\n  const qrCodeUrl = `${window.location.origin}/card/verify/${cardData.qrToken}`;\n\n  // Trigger flip animation when refreshing state changes\n  useEffect(() => {\n    if (isRefreshing) {\n      setIsFlipping(true);\n      setTimeout(() => {\n        setIsFlipping(false);\n      }, 400);\n    }\n  }, [isRefreshing]);\n\n  // Determine display status based on connectivity and membership validity\n  // VERLOPEN = membership expired (server determines this)\n  // NIET_ACTUEEL = offline PWA (no internet)  \n  // ACTUEEL = online PWA with valid membership\n  const displayStatus = cardData.status === 'VERLOPEN' \n    ? 'VERLOPEN' \n    : (isOffline ? 'NIET_ACTUEEL' : 'ACTUEEL');\n\n  return (\n    <>\n      <div \n        className={cn(\n          \"w-full h-full rounded-3xl shadow-card relative overflow-hidden card-font transition-transform duration-800\",\n          isFlipping && \"animate-flip-horizontal\",\n          className\n        )}\n        style={{\n          backgroundImage: `url(${fadingBlueBackground}), linear-gradient(135deg, rgba(8, 35, 66, 0.9) 0%, rgba(6, 47, 89, 0.95) 100%)`,\n          backgroundSize: \"cover\",\n          backgroundPosition: \"center\",\n          backgroundBlendMode: \"overlay\",\n          boxShadow: \"0 18px 40px rgba(0,0,0,0.35)\",\n          transform: isFlipping ? 'rotateY(360deg)' : 'rotateY(0deg)',\n          transition: 'transform 800ms ease-in-out'\n        }}\n        data-testid=\"membership-card\"\n      >\n        {/* Enhanced glossy sheen overlay */}\n        <div \n          className=\"absolute inset-0 pointer-events-none opacity-30 mix-blend-screen\"\n          style={{\n            background: \"linear-gradient(135deg, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0.1) 20%, transparent 40%, rgba(255,255,255,0.05) 70%, rgba(255,255,255,0.15) 100%)\"\n          }}\n          aria-hidden=\"true\"\n        />\n        {/* Additional highlight for premium effect */}\n        <div \n          className=\"absolute top-0 left-0 w-full h-1/3 pointer-events-none opacity-20\"\n          style={{\n            background: \"linear-gradient(180deg, rgba(255,255,255,0.2) 0%, transparent 100%)\"\n          }}\n          aria-hidden=\"true\"\n        />\n\n        {/* Card Content */}\n        <div className=\"relative h-full p-6 flex flex-col text-white\">\n          {/* Top row: Organization and Status */}\n          <div className=\"flex items-start justify-between mb-6\">\n            <div className=\"flex-1\">\n              {cardData.tenant.logoUrl && (\n                <img \n                  src={cardData.tenant.logoUrl} \n                  alt={cardData.tenant.name}\n                  className=\"h-6 w-auto mb-2 opacity-90\"\n                />\n              )}\n              <h1 className={`embossed-text font-bold uppercase tracking-wider ${isConstrained ? 'text-xl' : cardData.tenant.name.length > 15 ? 'text-2xl' : cardData.tenant.name.length > 10 ? 'text-3xl' : 'text-4xl'}`}>\n                Lidkaart {cardData.tenant.name.toUpperCase()}\n              </h1>\n            </div>\n            \n            <div className=\"flex items-start gap-3\">\n              <StatusLED status={displayStatus} />\n            </div>\n          </div>\n\n          {/* QR Code and Voting Rights Section */}\n          <div className={`flex justify-between items-center mb-8 ml-4 mt-4 ${isConstrained ? 'scale-75 origin-left' : ''}`}>\n            {/* QR Code - Left side */}\n            <button\n              onClick={() => setShowQRModal(true)}\n              className=\"debossed-qr-container transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 hover:scale-105\"\n              data-testid=\"qr-plate\"\n              aria-label=\"Toon scanbare QR code\"\n              style={{ minWidth: isConstrained ? '100px' : '140px', minHeight: isConstrained ? '100px' : '140px' }}\n            >\n              <div className=\"debossed-qr-frame\">\n                <QRCodeSVG\n                  value={qrCodeUrl}\n                  size={isConstrained ? 70 : 100}\n                  className=\"debossed-qr\"\n                  fgColor=\"#D1D5DB\"\n                  bgColor=\"transparent\"\n                />\n              </div>\n            </button>\n\n            {/* Status Badge - Right side (Board Member takes priority over Voting Rights) */}\n            {(isActiveBoardMember || cardData.votingRights) && (\n              <div className=\"flex flex-col items-center mr-8 -mt-8\">\n                {/* Icon removed as requested */}\n                <div className={`${isConstrained ? 'w-16 h-16' : 'w-24 h-24'} flex items-center justify-center`}>\n                  {/* Icon space maintained for text alignment */}\n                </div>\n                \n                {/* Primary text - Always show based on final status */}\n                {isActiveBoardMember && (\n                  <span \n                    className={`${isConstrained ? 'text-xs' : 'text-base'} uppercase tracking-[0.1em] font-bold mt-3`}\n                    style={{\n                      color: '#FFD700',\n                      textShadow: `\n                        2px 2px 0 rgba(255,255,255,0.3),\n                        -2px -2px 0 rgba(0,0,0,0.8),\n                        -3px -3px 0 rgba(0,0,0,0.6),\n                        inset 2px 2px 4px rgba(0,0,0,0.6),\n                        0 0 8px rgba(255,215,0,0.4)\n                      `,\n                      filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                    }}\n                  >\n                    BESTUURSLID\n                  </span>\n                )}\n                \n                {cardData.votingRights && !isActiveBoardMember && (\n                  <span \n                    className={`${isConstrained ? 'text-xs' : 'text-base'} uppercase tracking-[0.1em] font-bold mt-3`}\n                    style={{\n                      color: '#C0C0C0',\n                      textShadow: `\n                        1px 1px 0 rgba(255,255,255,0.2),\n                        -1px -1px 0 rgba(0,0,0,0.7),\n                        -2px -2px 0 rgba(0,0,0,0.5),\n                        inset 2px 2px 4px rgba(0,0,0,0.6),\n                        0 0 6px rgba(192,192,192,0.3)\n                      `,\n                      filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                    }}\n                  >\n                    STEMGERECHTIGD\n                  </span>\n                )}\n                \n                {/* Secondary text - show voting rights if board member */}\n                {isActiveBoardMember && cardData.votingRights && (\n                  <span \n                    className={`${isConstrained ? 'text-xs' : 'text-sm'} uppercase tracking-[0.1em] font-bold mt-1`}\n                    style={{\n                      color: '#C0C0C0',\n                      textShadow: `\n                        1px 1px 0 rgba(255,255,255,0.2),\n                        -1px -1px 0 rgba(0,0,0,0.7),\n                        -2px -2px 0 rgba(0,0,0,0.5),\n                        inset 2px 2px 4px rgba(0,0,0,0.6),\n                        0 0 6px rgba(192,192,192,0.3)\n                      `,\n                      filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.4))'\n                    }}\n                  >\n                    STEMGERECHTIGD\n                  </span>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Member Information */}\n          <div className={`mb-3 space-y-3 ml-8 -mt-4 ${isConstrained ? 'scale-75 origin-top-left' : ''}`}>\n            {/* Member Name */}\n            <div>\n              <p className=\"embossed-text text-[clamp(14px,1.8vmin,16px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                NAAM\n              </p>\n              <h2 className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] font-semibold uppercase tracking-wide leading-tight\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                {cardData.firstName} {cardData.lastName}\n              </h2>\n              {/* No status badges under name anymore - moved to QR section */}\n            </div>\n\n            {/* Lidnummer and Category - side by side */}\n            <div className=\"grid grid-cols-2 gap-4 mt-3\">\n              <div>\n                <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                  LIDNUMMER\n                </p>\n                <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] font-mono font-bold tracking-[0.2em] leading-tight\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                  {cardData.memberNumber}\n                </p>\n              </div>\n              \n              <div>\n                <p className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] uppercase tracking-wide opacity-80 mb-1 font-medium\">\n                  CATEGORIE\n                </p>\n                <span className=\"embossed-text text-[clamp(16px,2.0vmin,18px)] font-medium uppercase\" style={{textShadow: '2px 2px 4px rgba(0,0,0,0.9), -1px -1px 2px rgba(255,255,255,0.3), 0 0 8px rgba(255,255,255,0.1)', filter: 'drop-shadow(1px 1px 2px rgba(0,0,0,0.5))'}}>\n                  {getMemberCategoryLabel(cardData.category)}\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* Bottom right: Valid until */}\n          <div className=\"absolute bottom-4 right-4\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"embossed-text text-[clamp(9px,1.2vmin,12px)] uppercase tracking-wide opacity-70 font-medium\">\n                GELDIG TOT\n              </span>\n              <span className=\"embossed-text text-[clamp(10px,1.3vmin,14px)] font-medium font-mono tabular-nums\">\n                {cardData.validUntil ? format(cardData.validUntil, 'dd-MM-yyyy', { locale: nl }) : '31-12-2025'}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* QR Code Modal */}\n      <Dialog open={showQRModal} onOpenChange={setShowQRModal}>\n        <DialogContent className=\"max-w-sm\" data-testid=\"qr-modal\">\n          <DialogHeader>\n            <DialogTitle>Verificatie QR Code</DialogTitle>\n          </DialogHeader>\n          <div className=\"flex flex-col items-center gap-4 py-4\">\n            <div className=\"bg-white p-6 rounded-xl shadow-xl border\">\n              <QRCodeSVG\n                value={qrCodeUrl}\n                size={320}\n                className=\"w-full h-full\"\n                fgColor=\"#000000\"\n                bgColor=\"#ffffff\"\n              />\n            </div>\n            <p className=\"text-center text-sm text-gray-600\">\n              Scan deze QR code om de lidmaatschapsstatus te verifiëren\n            </p>\n            <Button \n              onClick={() => setShowQRModal(false)}\n              data-testid=\"button-close-qr\"\n            >\n              Sluiten\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}","size_bytes":14300},"client/src/pages/profiel.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { Lock, Save } from \"lucide-react\";\n\n// Schema voor profiel gegevens\nconst profileSchema = z.object({\n  name: z.string().min(1, \"Naam is verplicht\"),\n  email: z.string().email(\"Ongeldig email adres\"),\n});\n\n// Schema voor wachtwoord wijzigen\nconst passwordSchema = z.object({\n  currentPassword: z.string().min(1, \"Huidig wachtwoord is verplicht\"),\n  newPassword: z.string().min(6, \"Nieuw wachtwoord moet minimaal 6 karakters zijn\"),\n  confirmPassword: z.string().min(1, \"Bevestig het nieuwe wachtwoord\"),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"Wachtwoorden komen niet overeen\",\n  path: [\"confirmPassword\"],\n});\n\ntype ProfileFormData = z.infer<typeof profileSchema>;\ntype PasswordFormData = z.infer<typeof passwordSchema>;\n\nexport default function Profiel() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [profileSaved, setProfileSaved] = useState(false);\n\n  // Profiel formulier\n  const profileForm = useForm<ProfileFormData>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      name: \"\",\n      email: \"\",\n    },\n  });\n\n  // Wachtwoord formulier\n  const passwordForm = useForm<PasswordFormData>({\n    resolver: zodResolver(passwordSchema),\n    defaultValues: {\n      currentPassword: \"\",\n      newPassword: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  // Watch voor profiel formulier wijzigingen\n  const profileFormValues = profileForm.watch();\n\n  // Reset profiel saved state wanneer formulier wijzigt\n  useEffect(() => {\n    if (profileSaved) {\n      setProfileSaved(false);\n    }\n  }, [profileFormValues]);\n\n  // Initialiseer formulier met gebruikersgegevens\n  useEffect(() => {\n    if (user) {\n      profileForm.reset({\n        name: user.name || \"\",\n        email: user.email || \"\",\n      });\n      setProfileSaved(false);\n    }\n  }, [user, profileForm]);\n\n  // Profiel update mutatie\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormData) => {\n      const response = await apiRequest(\"PUT\", \"/api/profile\", data);\n      return response.json();\n    },\n    onSuccess: async (result, variables) => {\n      // Update de auth cache met nieuwe gebruikersgegevens\n      queryClient.setQueryData([\"/api/auth/me\"], (oldData: any) => {\n        if (!oldData || !oldData.user) return oldData;\n        return { \n          ...oldData, \n          user: { ...oldData.user, ...variables }\n        };\n      });\n      \n      setProfileSaved(true);\n      toast({\n        title: \"Profiel bijgewerkt\",\n        description: \"Uw profiel gegevens zijn succesvol bijgewerkt.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Fout\",\n        description: \"Er is een fout opgetreden bij het bijwerken van uw profiel.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Wachtwoord wijzigen mutatie\n  const changePasswordMutation = useMutation({\n    mutationFn: async (data: PasswordFormData) => {\n      const response = await apiRequest(\"PUT\", \"/api/profile/password\", {\n        currentPassword: data.currentPassword,\n        newPassword: data.newPassword,\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      passwordForm.reset();\n      toast({\n        title: \"Wachtwoord gewijzigd\",\n        description: \"Uw wachtwoord is succesvol gewijzigd.\",\n      });\n    },\n    onError: (error: any) => {\n      const errorMessage = error.message || \"Er is een fout opgetreden bij het wijzigen van het wachtwoord.\";\n      toast({\n        title: \"Fout\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onProfileSubmit = (data: ProfileFormData) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  const onPasswordSubmit = (data: PasswordFormData) => {\n    changePasswordMutation.mutate(data);\n  };\n\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Mijn Profiel</h1>\n              <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer uw account gegevens en instellingen</p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"grid gap-6 md:grid-cols-2 mt-6\">\n        {/* Profiel Gegevens */}\n        <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n          <CardHeader>\n            <CardTitle>Profiel Gegevens</CardTitle>\n            <CardDescription>\n              Werk uw naam en email adres bij\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...profileForm}>\n              <form onSubmit={profileForm.handleSubmit(onProfileSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={profileForm.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Naam</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          placeholder=\"Uw volledige naam\"\n                          data-testid=\"input-profile-name\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={profileForm.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          type=\"email\"\n                          placeholder=\"uw.email@voorbeeld.be\"\n                          data-testid=\"input-profile-email\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"flex items-center gap-2\">\n                  <Button \n                    type=\"submit\" \n                    disabled={updateProfileMutation.isPending || profileSaved}\n                    data-testid=\"button-save-profile\"\n                  >\n                    <Save className=\"h-4 w-4 mr-2\" />\n                    {updateProfileMutation.isPending \n                      ? \"Opslaan...\" \n                      : profileSaved \n                        ? \"Opgeslagen\" \n                        : \"Opslaan\"\n                    }\n                  </Button>\n                  {profileSaved && (\n                    <span className=\"text-sm text-green-600\">\n                      ✓ Wijzigingen opgeslagen\n                    </span>\n                  )}\n                </div>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n\n        {/* Wachtwoord Wijzigen */}\n        <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Lock className=\"h-5 w-5\" />\n              Wachtwoord Wijzigen\n            </CardTitle>\n            <CardDescription>\n              Wijzig uw account wachtwoord voor extra beveiliging\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...passwordForm}>\n              <form onSubmit={passwordForm.handleSubmit(onPasswordSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={passwordForm.control}\n                  name=\"currentPassword\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Huidig Wachtwoord</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          type=\"password\"\n                          placeholder=\"Voer uw huidige wachtwoord in\"\n                          data-testid=\"input-current-password\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={passwordForm.control}\n                  name=\"newPassword\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Nieuw Wachtwoord</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          type=\"password\"\n                          placeholder=\"Voer uw nieuwe wachtwoord in\"\n                          data-testid=\"input-new-password\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={passwordForm.control}\n                  name=\"confirmPassword\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Bevestig Nieuw Wachtwoord</FormLabel>\n                      <FormControl>\n                        <Input \n                          {...field} \n                          type=\"password\"\n                          placeholder=\"Bevestig uw nieuwe wachtwoord\"\n                          data-testid=\"input-confirm-password\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button \n                  type=\"submit\" \n                  disabled={changePasswordMutation.isPending}\n                  variant=\"outline\"\n                  data-testid=\"button-change-password\"\n                >\n                  <Lock className=\"h-4 w-4 mr-2\" />\n                  {changePasswordMutation.isPending ? \"Wijzigen...\" : \"Wachtwoord Wijzigen\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n        </div>\n\n        {/* Account Info */}\n        <Card className=\"mt-6 glass-card card-hover animate-fade-in group border-0\">\n        <CardHeader>\n          <CardTitle>Account Informatie</CardTitle>\n          <CardDescription>\n            Alleen-lezen informatie over uw account\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div>\n              <Label className=\"text-sm font-medium text-muted-foreground\">Rol</Label>\n              <p className=\"text-sm\" data-testid=\"text-user-role\">{user?.role}</p>\n            </div>\n            <div>\n              <Label className=\"text-sm font-medium text-muted-foreground\">Account aangemaakt</Label>\n              <p className=\"text-sm\" data-testid=\"text-created-at\">\n                {user?.createdAt ? new Date(user.createdAt).toLocaleDateString('nl-BE') : 'Onbekend'}\n              </p>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n      </div>\n    </main>\n  );\n}","size_bytes":12189},"client/src/components/members/export-dialog.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from '@/components/ui/dialog';\nimport { Button } from '@/components/ui/button';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Progress } from '@/components/ui/progress';\nimport { CiExport } from 'react-icons/ci';\nimport { Loader2, Check, FileSpreadsheet } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { apiRequest } from '@/lib/queryClient';\n\ninterface ExportDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  filteredMembers: any[];\n}\n\ninterface ExportField {\n  key: string;\n  label: string;\n  category: string;\n}\n\nconst EXPORT_FIELDS: ExportField[] = [\n  // Basis informatie\n  { key: 'memberNumber', label: 'Lidnummer', category: 'Basis' },\n  { key: 'firstName', label: 'Voornaam', category: 'Basis' },\n  { key: 'lastName', label: 'Achternaam', category: 'Basis' },\n  { key: 'birthDate', label: 'Geboortedatum', category: 'Basis' },\n  { key: 'gender', label: 'Geslacht', category: 'Basis' },\n  { key: 'nationality', label: 'Nationaliteit', category: 'Basis' },\n  \n  // Contact informatie\n  { key: 'email', label: 'E-mail', category: 'Contact' },\n  { key: 'phone', label: 'Telefoon', category: 'Contact' },\n  { key: 'address', label: 'Adres', category: 'Contact' },\n  { key: 'postalCode', label: 'Postcode', category: 'Contact' },\n  { key: 'city', label: 'Stad', category: 'Contact' },\n  { key: 'country', label: 'Land', category: 'Contact' },\n  \n  // Lidmaatschap\n  { key: 'status', label: 'Status', category: 'Lidmaatschap' },\n  { key: 'category', label: 'Categorie', category: 'Lidmaatschap' },\n  { key: 'joinDate', label: 'Inschrijfdatum', category: 'Lidmaatschap' },\n  { key: 'votingRights', label: 'Stemrecht', category: 'Lidmaatschap' },\n  \n  // Financieel\n  { key: 'membershipFee', label: 'Lidmaatschapsbijdrage', category: 'Financieel' },\n  { key: 'paymentMethod', label: 'Betaalmethode', category: 'Financieel' },\n  { key: 'iban', label: 'IBAN', category: 'Financieel' },\n  { key: 'paymentStatus', label: 'Betaalstatus', category: 'Financieel' },\n  \n  // Overig\n  { key: 'emergencyContact', label: 'Noodcontact', category: 'Overig' },\n  { key: 'emergencyPhone', label: 'Noodcontact telefoon', category: 'Overig' },\n  { key: 'notes', label: 'Notities', category: 'Overig' }\n];\n\nconst CATEGORIES = ['Basis', 'Contact', 'Lidmaatschap', 'Financieel', 'Overig'];\n\nexport function ExportDialog({ open, onOpenChange, filteredMembers }: ExportDialogProps) {\n  const [currentStep, setCurrentStep] = useState<'selection' | 'exporting' | 'complete'>('selection');\n  const [selectedFields, setSelectedFields] = useState<string[]>(['memberNumber', 'firstName', 'lastName', 'email', 'phone']);\n  const [exportProgress, setExportProgress] = useState(0);\n  const [exportedFile, setExportedFile] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const handleFieldToggle = (fieldKey: string) => {\n    setSelectedFields(prev => \n      prev.includes(fieldKey) \n        ? prev.filter(key => key !== fieldKey)\n        : [...prev, fieldKey]\n    );\n  };\n\n  const handleCategoryToggle = (category: string, isChecked: boolean) => {\n    const categoryFields = EXPORT_FIELDS.filter(field => field.category === category).map(field => field.key);\n    \n    if (isChecked) {\n      setSelectedFields(prev => {\n        const newFields = [...prev, ...categoryFields];\n        return Array.from(new Set(newFields));\n      });\n    } else {\n      setSelectedFields(prev => prev.filter(key => !categoryFields.includes(key)));\n    }\n  };\n\n  const isCategorySelected = (category: string) => {\n    const categoryFields = EXPORT_FIELDS.filter(field => field.category === category).map(field => field.key);\n    return categoryFields.every(key => selectedFields.includes(key));\n  };\n\n  const isCategoryPartiallySelected = (category: string) => {\n    const categoryFields = EXPORT_FIELDS.filter(field => field.category === category).map(field => field.key);\n    return categoryFields.some(key => selectedFields.includes(key)) && !isCategorySelected(category);\n  };\n\n  const handleSelectAll = () => {\n    setSelectedFields(EXPORT_FIELDS.map(field => field.key));\n  };\n\n  const handleSelectNone = () => {\n    setSelectedFields([]);\n  };\n\n  const handleExport = async () => {\n    if (selectedFields.length === 0) {\n      toast({\n        title: \"Geen velden geselecteerd\",\n        description: \"Selecteer minimaal één veld om te exporteren.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setCurrentStep('exporting');\n    setExportProgress(0);\n\n    try {\n      // Simulate progress steps\n      setExportProgress(25);\n      \n      // Get member IDs from filtered members\n      const memberIds = filteredMembers?.map(member => member.id) || [];\n      \n      setExportProgress(50);\n      \n      const response = await apiRequest('POST', '/api/members/export', {\n        memberIds,\n        fields: selectedFields\n      });\n\n      if (!response.ok) {\n        throw new Error('Export failed');\n      }\n\n      setExportProgress(75);\n\n      // Download the file\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.style.display = 'none';\n      a.href = url;\n      const fileName = `leden_export_${new Date().toISOString().split('T')[0]}.xlsx`;\n      a.download = fileName;\n      document.body.appendChild(a);\n      a.click();\n      window.URL.revokeObjectURL(url);\n      document.body.removeChild(a);\n\n      setExportProgress(100);\n      setExportedFile(fileName);\n      setCurrentStep('complete');\n\n      toast({\n        title: \"Export succesvol\",\n        description: `${filteredMembers?.length || 0} leden geëxporteerd naar Excel bestand.`\n      });\n    } catch (error) {\n      console.error('Export error:', error);\n      setCurrentStep('selection');\n      toast({\n        title: \"Export mislukt\",\n        description: \"Er is een fout opgetreden bij het exporteren van de leden.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleClose = () => {\n    setCurrentStep('selection');\n    setExportProgress(0);\n    setExportedFile(null);\n    onOpenChange(false);\n  };\n\n  const goToNext = () => {\n    if (currentStep === 'selection') {\n      handleExport();\n    }\n  };\n\n  const goToPrevious = () => {\n    if (currentStep === 'complete') {\n      setCurrentStep('selection');\n      setExportProgress(0);\n      setExportedFile(null);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[650px] max-h-[85vh] flex flex-col\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <FileSpreadsheet className=\"h-5 w-5\" />\n            Leden Export Wizard\n          </DialogTitle>\n          <p className=\"text-sm text-gray-600\">\n            {filteredMembers?.length || 0} leden klaar voor export\n          </p>\n        </DialogHeader>\n\n        {/* Progress Steps */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className={`flex items-center gap-2 ${currentStep === 'selection' ? 'text-blue-600' : currentStep === 'exporting' || currentStep === 'complete' ? 'text-green-600' : 'text-gray-400'}`}>\n            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${currentStep === 'selection' ? 'bg-blue-100' : currentStep === 'exporting' || currentStep === 'complete' ? 'bg-green-100' : 'bg-gray-100'}`}>\n              1\n            </div>\n            <span className=\"text-sm font-medium\">Velden</span>\n          </div>\n          <div className={`flex-1 h-0.5 mx-4 ${currentStep === 'exporting' || currentStep === 'complete' ? 'bg-green-200' : 'bg-gray-200'}`}></div>\n          <div className={`flex items-center gap-2 ${currentStep === 'exporting' ? 'text-blue-600' : currentStep === 'complete' ? 'text-green-600' : 'text-gray-400'}`}>\n            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${currentStep === 'exporting' ? 'bg-blue-100' : currentStep === 'complete' ? 'bg-green-100' : 'bg-gray-100'}`}>\n              2\n            </div>\n            <span className=\"text-sm font-medium\">Export</span>\n          </div>\n          <div className={`flex-1 h-0.5 mx-4 ${currentStep === 'complete' ? 'bg-green-200' : 'bg-gray-200'}`}></div>\n          <div className={`flex items-center gap-2 ${currentStep === 'complete' ? 'text-green-600' : 'text-gray-400'}`}>\n            <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${currentStep === 'complete' ? 'bg-green-100' : 'bg-gray-100'}`}>\n              3\n            </div>\n            <span className=\"text-sm font-medium\">Klaar</span>\n          </div>\n        </div>\n\n        {/* Step Content */}\n        <div className=\"flex-1 flex flex-col min-h-0\">\n          {currentStep === 'selection' && (\n            <div className=\"flex-1 flex flex-col space-y-4\">\n              <div>\n                <h3 className=\"text-lg font-semibold\">Selecteer Export Velden</h3>\n                <p className=\"text-sm text-gray-600\">\n                  Kies welke velden u wilt exporteren naar het Excel bestand.\n                </p>\n              </div>\n\n              <div className=\"flex gap-2\">\n                <Button variant=\"outline\" size=\"sm\" onClick={handleSelectAll}>\n                  Alles selecteren\n                </Button>\n                <Button variant=\"outline\" size=\"sm\" onClick={handleSelectNone}>\n                  Niets selecteren\n                </Button>\n              </div>\n\n              <div className=\"border rounded-lg p-4 max-h-[300px] overflow-y-auto\">\n                <div className=\"space-y-4\">\n                  {CATEGORIES.map(category => {\n                    const categoryFields = EXPORT_FIELDS.filter(field => field.category === category);\n                    const isSelected = isCategorySelected(category);\n                    const isPartiallySelected = isCategoryPartiallySelected(category);\n\n                    return (\n                      <div key={category} className=\"space-y-2\">\n                        <div className=\"flex items-center space-x-2\">\n                          <Checkbox\n                            id={`category-${category}`}\n                            checked={isSelected}\n                            data-state={isPartiallySelected ? \"indeterminate\" : undefined}\n                            onCheckedChange={(checked) => handleCategoryToggle(category, checked as boolean)}\n                          />\n                          <label \n                            htmlFor={`category-${category}`}\n                            className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                          >\n                            {category}\n                          </label>\n                        </div>\n                        \n                        <div className=\"ml-6 space-y-2\">\n                          {categoryFields.map(field => (\n                            <div key={field.key} className=\"flex items-center space-x-2\">\n                              <Checkbox\n                                id={field.key}\n                                checked={selectedFields.includes(field.key)}\n                                onCheckedChange={() => handleFieldToggle(field.key)}\n                              />\n                              <label \n                                htmlFor={field.key}\n                                className=\"text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                              >\n                                {field.label}\n                              </label>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {currentStep === 'exporting' && (\n            <div className=\"flex-1 flex items-center justify-center\">\n              <div className=\"text-center space-y-4\">\n                <div>\n                  <h3 className=\"text-lg font-semibold\">Export wordt uitgevoerd...</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    {filteredMembers?.length || 0} leden met {selectedFields.length} velden worden geëxporteerd\n                  </p>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Progress value={exportProgress} className=\"w-full\" />\n                  <p className=\"text-sm text-gray-500\">\n                    {Math.round(exportProgress)}% voltooid\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {currentStep === 'complete' && (\n            <div className=\"flex-1 flex items-center justify-center\">\n              <div className=\"text-center space-y-4\">\n                <div className=\"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center\">\n                  <Check className=\"h-8 w-8 text-green-600\" />\n                </div>\n                \n                <div>\n                  <h3 className=\"text-lg font-semibold text-green-800\">Export Voltooid!</h3>\n                  <p className=\"text-sm text-gray-600\">\n                    {filteredMembers?.length || 0} leden succesvol geëxporteerd\n                  </p>\n                  {exportedFile && (\n                    <p className=\"text-sm text-gray-500 mt-2\">\n                      Bestand: {exportedFile}\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Footer Buttons */}\n        <div className=\"flex justify-between pt-4 border-t\">\n          {currentStep === 'selection' && (\n            <>\n              <Button variant=\"outline\" onClick={handleClose}>\n                Annuleren\n              </Button>\n              <Button \n                onClick={goToNext}\n                disabled={selectedFields.length === 0}\n                className=\"gap-2\"\n              >\n                <CiExport className=\"h-4 w-4\" />\n                Volgende - Exporteren ({selectedFields.length} velden)\n              </Button>\n            </>\n          )}\n\n          {currentStep === 'complete' && (\n            <>\n              <Button variant=\"outline\" onClick={goToPrevious}>\n                Vorige\n              </Button>\n              <Button onClick={handleClose}>\n                Sluiten\n              </Button>\n            </>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":14917},"client/src/components/fees/FeeDetailDialog.tsx":{"content":"import { \n  Dialog, \n  DialogContent, \n  DialogHeader, \n  DialogTitle, \n  DialogDescription\n} from \"@/components/ui/dialog\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  Calendar, \n  Euro, \n  CreditCard, \n  Check, \n  Download, \n  Trash2, \n  User,\n  Phone,\n  Mail,\n  UserCircle,\n  Building2\n} from \"lucide-react\";\nimport { format, addDays } from \"date-fns\";\nimport { toZonedTime, fromZonedTime } from \"date-fns-tz\";\nimport { nl } from \"date-fns/locale\";\n\n// Types\ntype FeeStatus = \"OPENSTAAND\" | \"BETAALD\" | \"VERVALLEN\";\ntype PaymentTerm = \"MONTHLY\" | \"YEARLY\";\ntype PaymentMethod = \"SEPA\" | \"OVERSCHRIJVING\" | \"BANCONTACT\" | \"CASH\" | \"UNKNOWN\";\n\ntype MemberMini = {\n  id: string;\n  firstName: string;\n  lastName: string;\n  category: \"STUDENT\" | \"STANDAARD\" | \"SENIOR\";\n  email?: string | null;\n  phone?: string | null;\n  memberNumber: string;\n};\n\ntype FeeDetail = {\n  id: string;\n  amountCents: number;\n  currency?: \"EUR\";\n  term: PaymentTerm;\n  method?: PaymentMethod | null;\n  status: FeeStatus;\n  periodStart: string;\n  periodEnd: string;\n  paidAt?: string | null;\n  sepaBatchRef?: string | null;\n  tenantName: string;\n  member: MemberMini;\n};\n\ntype FeeDetailDialogProps = {\n  open: boolean;\n  onOpenChange: (v: boolean) => void;\n  fee: FeeDetail;\n  canManage?: boolean;\n  onMarkPaid?: (feeId: string) => Promise<void> | void;\n  onGenerateSepa?: (feeId: string) => Promise<void> | void;\n  onDelete?: (feeId: string) => Promise<void> | void;\n  onActionSuccess?: (msg: string) => void;\n  onActionError?: (msg: string) => void;\n};\n\n// Helper functions\nconst formatEUR = (amountCents: number): string => {\n  const euros = amountCents / 100;\n  return new Intl.NumberFormat('nl-BE', {\n    style: 'currency',\n    currency: 'EUR',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n  }).format(euros);\n};\n\nconst formatDateBE = (iso: string): string => {\n  const date = new Date(iso);\n  const belgianDate = toZonedTime(date, 'Europe/Brussels');\n  return format(belgianDate, 'dd-MM-yyyy', { locale: nl });\n};\n\nconst expiryDate = (isoEnd: string): string => {\n  const endDate = new Date(isoEnd);\n  const belgianEndDate = toZonedTime(endDate, 'Europe/Brussels');\n  const expiry = addDays(belgianEndDate, 1);\n  return format(expiry, 'dd-MM-yyyy', { locale: nl });\n};\n\nconst statusLabel = (status: FeeStatus): string => {\n  switch (status) {\n    case \"OPENSTAAND\": return \"Openstaand\";\n    case \"BETAALD\": return \"Betaald\";\n    case \"VERVALLEN\": return \"Vervallen\";\n    default: return status;\n  }\n};\n\nconst getStatusBadgeVariant = (status: FeeStatus) => {\n  switch (status) {\n    case \"OPENSTAAND\": return \"bg-amber-100 text-amber-800 border-amber-300\";\n    case \"BETAALD\": return \"bg-green-100 text-green-800 border-green-300\";\n    case \"VERVALLEN\": return \"bg-red-100 text-red-800 border-red-300\";\n    default: return \"bg-gray-100 text-gray-800 border-gray-300\";\n  }\n};\n\nconst getPaymentMethodLabel = (method?: PaymentMethod | null): string => {\n  if (!method) return \"Niet gespecificeerd\";\n  switch (method) {\n    case \"SEPA\": return \"SEPA\";\n    case \"OVERSCHRIJVING\": return \"Overschrijving\";\n    case \"BANCONTACT\": return \"Bancontact\";\n    case \"CASH\": return \"Contant\";\n    case \"UNKNOWN\": return \"Onbekend\";\n    default: return method;\n  }\n};\n\nconst getTermLabel = (term: PaymentTerm): string => {\n  switch (term) {\n    case \"MONTHLY\": return \"Maandelijks\";\n    case \"YEARLY\": return \"Jaarlijks\";\n    default: return term;\n  }\n};\n\nconst getCategoryLabel = (category: string): string => {\n  switch (category) {\n    case \"STUDENT\": return \"Student\";\n    case \"STANDAARD\": return \"Standaard\";\n    case \"SENIOR\": return \"Senior\";\n    default: return category;\n  }\n};\n\nexport function FeeDetailDialog({\n  open,\n  onOpenChange,\n  fee,\n  canManage = false,\n  onMarkPaid,\n  onGenerateSepa,\n  onDelete,\n  onActionSuccess,\n  onActionError\n}: FeeDetailDialogProps) {\n\n  const handleMarkPaid = async () => {\n    if (!onMarkPaid) return;\n    try {\n      await onMarkPaid(fee.id);\n      onActionSuccess?.(\"Lidgeld succesvol gemarkeerd als betaald\");\n      onOpenChange(false);\n    } catch (error) {\n      onActionError?.(\"Fout bij markeren als betaald\");\n    }\n  };\n\n  const handleGenerateSepa = async () => {\n    if (!onGenerateSepa) return;\n    try {\n      await onGenerateSepa(fee.id);\n      onActionSuccess?.(\"SEPA export succesvol gegenereerd\");\n    } catch (error) {\n      onActionError?.(\"Fout bij genereren SEPA export\");\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!onDelete) return;\n    try {\n      await onDelete(fee.id);\n      onActionSuccess?.(\"Lidgeld succesvol verwijderd\");\n      onOpenChange(false);\n    } catch (error) {\n      onActionError?.(\"Fout bij verwijderen lidgeld\");\n    }\n  };\n\n  const canMarkAsPaid = fee.status !== \"BETAALD\";\n  const canGenerateSepa = fee.method === \"SEPA\" && \n                          (fee.status === \"OPENSTAAND\" || fee.status === \"VERVALLEN\") && \n                          !fee.sepaBatchRef;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Lidgeld Details</DialogTitle>\n          <DialogDescription>\n            Bekijk alle details van dit lidgeld\n          </DialogDescription>\n        </DialogHeader>\n\n        {/* Header Info */}\n        <div className=\"bg-gray-50 dark:bg-gray-900 rounded-lg p-3 mb-4\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <span className=\"font-mono text-sm text-gray-600\">#{fee.member.memberNumber}</span>\n            <Badge className={getStatusBadgeVariant(fee.status)}>\n              {statusLabel(fee.status)}\n            </Badge>\n          </div>\n          <h3 className=\"font-semibold text-lg\">\n            {fee.member.firstName} {fee.member.lastName}\n          </h3>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            {formatEUR(fee.amountCents)} • {formatDateBE(fee.periodStart)} – {formatDateBE(fee.periodEnd)}\n          </p>\n        </div>\n\n        <Tabs defaultValue=\"fee\" className=\"space-y-4\">\n          <TabsList className=\"grid w-full grid-cols-3\">\n            <TabsTrigger value=\"fee\" className=\"flex items-center gap-2\">\n              <Euro className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Lidgeld</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"member\" className=\"flex items-center gap-2\">\n              <UserCircle className=\"h-4 w-4\" />\n              <span className=\"hidden sm:inline\">Lid</span>\n            </TabsTrigger>\n            {canManage && (\n              <TabsTrigger value=\"actions\" className=\"flex items-center gap-2\">\n                <Building2 className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline\">Acties</span>\n              </TabsTrigger>\n            )}\n          </TabsList>\n\n          <TabsContent value=\"fee\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <Euro className=\"h-4 w-4\" />\n                Lidgeld gegevens\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Bedrag</span>\n                  <p className=\"font-medium text-lg\">{formatEUR(fee.amountCents)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Status</span>\n                  <div>\n                    <Badge className={getStatusBadgeVariant(fee.status)}>\n                      {statusLabel(fee.status)}\n                    </Badge>\n                  </div>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Periode van</span>\n                  <p className=\"font-medium\">{formatDateBE(fee.periodStart)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Periode tot</span>\n                  <p className=\"font-medium\">{formatDateBE(fee.periodEnd)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Vervalt op</span>\n                  <p className=\"font-medium\">{expiryDate(fee.periodEnd)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Betaaltermijn</span>\n                  <p className=\"font-medium\">{getTermLabel(fee.term)}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Betaalmethode</span>\n                  <p className=\"font-medium\">{getPaymentMethodLabel(fee.method)}</p>\n                </div>\n                {fee.paidAt && (\n                  <div>\n                    <span className=\"text-gray-500\">Betaald op</span>\n                    <p className=\"font-medium\">{formatDateBE(fee.paidAt)}</p>\n                  </div>\n                )}\n                {fee.sepaBatchRef && (\n                  <div>\n                    <span className=\"text-gray-500\">SEPA batch</span>\n                    <p className=\"font-mono text-xs\">{fee.sepaBatchRef}</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"member\" className=\"space-y-3\">\n            <div className=\"space-y-3\">\n              <h4 className=\"font-medium flex items-center gap-2 text-sm\">\n                <User className=\"h-4 w-4\" />\n                Lid informatie\n              </h4>\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">Naam</span>\n                  <p className=\"font-medium\">{fee.member.firstName} {fee.member.lastName}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Lidnummer</span>\n                  <p className=\"font-medium font-mono\">#{fee.member.memberNumber}</p>\n                </div>\n                <div>\n                  <span className=\"text-gray-500\">Categorie</span>\n                  <p className=\"font-medium\">{getCategoryLabel(fee.member.category)}</p>\n                </div>\n                {fee.member.email && (\n                  <div>\n                    <span className=\"text-gray-500\">E-mail</span>\n                    <p>\n                      <a \n                        href={`mailto:${fee.member.email}`} \n                        className=\"text-blue-600 hover:text-blue-800\"\n                      >\n                        {fee.member.email}\n                      </a>\n                    </p>\n                  </div>\n                )}\n                {fee.member.phone && (\n                  <div>\n                    <span className=\"text-gray-500\">Telefoon</span>\n                    <p>\n                      <a \n                        href={`tel:${fee.member.phone}`} \n                        className=\"text-blue-600 hover:text-blue-800\"\n                      >\n                        {fee.member.phone}\n                      </a>\n                    </p>\n                  </div>\n                )}\n              </div>\n            </div>\n          </TabsContent>\n\n          {canManage && (\n            <TabsContent value=\"actions\" className=\"space-y-3\">\n              <div className=\"flex flex-wrap gap-3 justify-end\">\n                {canMarkAsPaid && (\n                    <Button onClick={handleMarkPaid} className=\"flex items-center gap-2 bg-green-600 hover:bg-green-700\">\n                      <Check className=\"h-4 w-4\" />\n                      Markeer als betaald\n                    </Button>\n                  )}\n                  \n                  {canGenerateSepa && (\n                    <Button \n                      onClick={handleGenerateSepa} \n                      variant=\"outline\"\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Download className=\"h-4 w-4\" />\n                      Genereer SEPA-export\n                    </Button>\n                  )}\n                  \n                  <Button \n                    onClick={handleDelete}\n                    variant=\"destructive\"\n                    className=\"flex items-center gap-2\"\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                    Verwijder lidgeld\n                  </Button>\n              </div>\n            </TabsContent>\n          )}\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":12683},"client/src/components/auth/quick-auth-modal.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Shield, Eye, EyeOff, AlertCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface QuickAuthModalProps {\n  onAuthenticated: (token: string) => void;\n  isOpen: boolean;\n}\n\nexport function QuickAuthModal({ onAuthenticated, isOpen }: QuickAuthModalProps) {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!email || !password) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\"/api/auth/quick-verify\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          email: email.trim(),\n          password: password,\n        }),\n      });\n\n      const result = await response.json();\n\n      if (!response.ok) {\n        throw new Error(result.error || \"Authenticatie mislukt\");\n      }\n\n      // Controleer of de gebruiker de juiste rol heeft\n      if (result.user.role !== 'BEHEERDER' && result.user.role !== 'MEDEWERKER') {\n        throw new Error(\"Geen toegang - alleen medewerkers en beheerders\");\n      }\n\n      // Sla verificatie token op in sessionStorage (gebruik token van server)\n      const verifyToken = result.token;\n      sessionStorage.setItem(\"qr_verify_token\", verifyToken);\n      sessionStorage.setItem(\"qr_verify_user\", JSON.stringify({\n        name: result.user.name,\n        role: result.user.role,\n        authenticatedAt: new Date().toISOString()\n      }));\n\n      onAuthenticated(verifyToken);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !loading && email && password) {\n      handleSubmit(e as any);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\n      {/* Backdrop */}\n      <div \n        className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\"\n        style={{\n          background: `radial-gradient(circle at 50% 50%, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.8) 100%)`\n        }}\n      />\n      \n      {/* Modal */}\n      <Card className=\"relative w-full max-w-md mx-auto shadow-2xl border-2\">\n        <CardHeader className=\"text-center pb-4\">\n          <div className=\"mx-auto mb-4 p-3 rounded-full bg-blue-100 w-fit\">\n            <Shield className=\"h-8 w-8 text-blue-600\" />\n          </div>\n          <CardTitle className=\"text-xl font-semibold\">\n            Veilige toegang vereist\n          </CardTitle>\n          <p className=\"text-sm text-muted-foreground mt-2\">\n            Log in als medewerker of beheerder om lidgegevens te bekijken\n          </p>\n        </CardHeader>\n\n        <CardContent className=\"space-y-4\">\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">E-mailadres</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder=\"jouw@email.nl\"\n                className=\"h-11\"\n                disabled={loading}\n                autoComplete=\"email\"\n                autoFocus\n                data-testid=\"input-auth-email\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Wachtwoord</Label>\n              <div className=\"relative\">\n                <Input\n                  id=\"password\"\n                  type={showPassword ? \"text\" : \"password\"}\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder=\"Wachtwoord\"\n                  className=\"h-11 pr-12\"\n                  disabled={loading}\n                  autoComplete=\"current-password\"\n                  data-testid=\"input-auth-password\"\n                />\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"absolute right-1 top-1 h-9 w-9\"\n                  onClick={() => setShowPassword(!showPassword)}\n                  disabled={loading}\n                  data-testid=\"button-toggle-password\"\n                >\n                  {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                </Button>\n              </div>\n            </div>\n\n            {error && (\n              <div className=\"flex items-start gap-2 p-3 rounded-lg bg-red-50 border border-red-200\">\n                <AlertCircle className=\"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0\" />\n                <p className=\"text-sm text-red-700\">{error}</p>\n              </div>\n            )}\n\n            <div className=\"flex gap-3 pt-2\">\n              <Button\n                type=\"submit\"\n                className=\"flex-1 h-11\"\n                disabled={loading || !email || !password}\n                data-testid=\"button-auth-submit\"\n              >\n                {loading ? (\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                    Verifiëren...\n                  </div>\n                ) : (\n                  \"Toegang verkrijgen\"\n                )}\n              </Button>\n            </div>\n          </form>\n\n          <div className=\"text-center pt-2 border-t\">\n            <p className=\"text-xs text-muted-foreground\">\n              Alleen geautoriseerd personeel heeft toegang tot deze informatie\n            </p>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":6331},"server/middleware/quickAuth.ts":{"content":"import { Request, Response, NextFunction } from 'express';\n\n// Simple in-memory store for verification tokens (in production use Redis or database)\nconst verifyTokens = new Map<string, { userId: string; role: string; createdAt: Date }>();\n\n// Cleanup expired tokens every hour\nsetInterval(() => {\n  const now = new Date();\n  const tokensToDelete: string[] = [];\n  \n  verifyTokens.forEach((data, token) => {\n    const hoursPassed = (now.getTime() - data.createdAt.getTime()) / (1000 * 60 * 60);\n    if (hoursPassed > 2) { // 2 hour expiry\n      tokensToDelete.push(token);\n    }\n  });\n  \n  tokensToDelete.forEach(token => verifyTokens.delete(token));\n}, 60 * 60 * 1000);\n\nexport const quickAuthMiddleware = (req: Request, res: Response, next: NextFunction) => {\n  try {\n    const authHeader = req.headers.authorization;\n    \n    if (!authHeader || !authHeader.startsWith('Bearer ')) {\n      return res.status(401).json({ error: 'Inloggen vereist. Log eerst in.' });\n    }\n\n    const token = authHeader.substring(7); // Remove 'Bearer ' prefix\n    const tokenData = verifyTokens.get(token);\n\n    if (!tokenData) {\n      return res.status(401).json({ error: 'Uw sessie is verlopen. Log opnieuw in.' });\n    }\n\n    // Check token age (2 hours max)\n    const now = new Date();\n    const hoursPassed = (now.getTime() - tokenData.createdAt.getTime()) / (1000 * 60 * 60);\n    \n    if (hoursPassed > 2) {\n      verifyTokens.delete(token);\n      return res.status(401).json({ error: 'Inlogtijd verlopen. Log opnieuw in.' });\n    }\n\n    // Check role permissions\n    if (tokenData.role !== 'BEHEERDER' && tokenData.role !== 'MEDEWERKER') {\n      return res.status(403).json({ error: 'Onvoldoende rechten voor deze actie' });\n    }\n\n    // Add user info to request\n    req.user = {\n      id: tokenData.userId,\n      role: tokenData.role,\n    } as any;\n\n    next();\n  } catch (error) {\n    res.status(401).json({ error: 'Inloggen mislukt. Probeer opnieuw.' });\n  }\n};\n\n// Helper to store verification tokens\nexport const storeVerifyToken = (token: string, userId: string, role: string) => {\n  verifyTokens.set(token, {\n    userId,\n    role,\n    createdAt: new Date(),\n  });\n};","size_bytes":2163},"server/lib/card/etag.ts":{"content":"import { createHash } from 'crypto';\n\n/**\n * Generate a stable ETag for card data\n * The ETag changes when any visible card information changes\n * Used for cache invalidation and client-side updates\n */\nexport function makeCardETag(\n  memberData: {\n    id: string;\n    firstName: string;\n    lastName: string;\n    memberNumber: string;\n    category: string;\n    votingRights: boolean;\n  },\n  tenantBranding: {\n    name: string;\n    logoUrl: string | null;\n    primaryColor: string;\n  },\n  cardStatus: string,\n  validUntil: Date | null,\n  badges: string[],\n  version?: number\n): string {\n  // Create a deterministic string representation of all card data\n  const cardDataString = JSON.stringify({\n    member: {\n      id: memberData.id,\n      firstName: memberData.firstName,\n      lastName: memberData.lastName,\n      memberNumber: memberData.memberNumber,\n      category: memberData.category,\n      votingRights: memberData.votingRights,\n    },\n    tenant: {\n      name: tenantBranding.name,\n      logoUrl: tenantBranding.logoUrl,\n      primaryColor: tenantBranding.primaryColor,\n    },\n    status: cardStatus,\n    validUntil: validUntil?.toISOString() || null,\n    badges: badges.sort(), // Sort badges for consistent ordering\n    version: version || 1,\n    // Include timestamp rounded to hour to force refresh periodically\n    timeGroup: Math.floor(Date.now() / (1000 * 60 * 60)),\n  });\n  \n  // Generate SHA-256 hash and take first 12 characters\n  const hash = createHash('sha256')\n    .update(cardDataString)\n    .digest('hex')\n    .substring(0, 12);\n  \n  return `\"${hash}\"`;\n}\n\n/**\n * Generate a simple version-based ETag\n * Useful for simple incrementing version tracking\n */\nexport function makeVersionETag(version: number): string {\n  return `\"v${version}\"`;\n}\n\n/**\n * Generate ETag based on last modified timestamp\n */\nexport function makeTimestampETag(lastModified: Date): string {\n  const timestamp = lastModified.getTime();\n  const hash = createHash('sha256')\n    .update(timestamp.toString())\n    .digest('hex')\n    .substring(0, 12);\n  \n  return `\"${hash}\"`;\n}\n\n/**\n * Extract version number from version-based ETag\n */\nexport function parseVersionFromETag(etag: string): number | null {\n  const match = etag.match(/^\"v(\\d+)\"$/);\n  return match ? parseInt(match[1], 10) : null;\n}\n\n/**\n * Check if ETag indicates a weak validator (W/ prefix)\n */\nexport function isWeakETag(etag: string): boolean {\n  return etag.startsWith('W/');\n}\n\n/**\n * Create a weak ETag (for content that changes frequently)\n */\nexport function makeWeakETag(content: string): string {\n  const hash = createHash('sha256')\n    .update(content)\n    .digest('hex')\n    .substring(0, 12);\n  \n  return `W/\"${hash}\"`;\n}\n\n/**\n * Compare two ETags for equality\n * Handles both strong and weak validators\n */\nexport function compareETags(etag1: string, etag2: string): boolean {\n  // Remove W/ prefix for weak validators\n  const clean1 = etag1.replace(/^W\\//, '');\n  const clean2 = etag2.replace(/^W\\//, '');\n  \n  return clean1 === clean2;\n}","size_bytes":3016},"server/lib/card/status.ts":{"content":"import { storage } from '../../storage';\nimport { nowBE, toBEDate } from '../time/beTime';\nimport { isDateInPeriod, isPeriodActive, isPeriodExpired } from '../fees/periods';\n\nexport type CardStatus = 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN';\n\n/**\n * Check if membership is expired \n * VERLOPEN = any OVERDUE fee exists\n */\nexport async function isMembershipExpired(memberId: string): Promise<boolean> {\n  try {\n    const fees = await storage.getMembershipFeesByMember(memberId);\n    \n    if (fees.length === 0) {\n      return false; // No fees = not expired\n    }\n    \n    // Membership is expired if ANY fee is OVERDUE\n    return fees.some(fee => fee.status === 'OVERDUE');\n    \n  } catch (error) {\n    console.error('Error checking membership expiry:', error);\n    return false;\n  }\n}\n\n/**\n * Compute the current card status for a member\n * Based on the correct domain rules:\n * - VERLOPEN: Any OVERDUE fee exists\n * - ACTUEEL: Default status for valid memberships\n * \n * Note: ACTUEEL/NIET_ACTUEEL connectivity status is handled in the PWA frontend\n */\nexport async function computeCardStatus(memberId: string): Promise<CardStatus> {\n  try {\n    // Check if membership is expired based on validUntil date\n    const expired = await isMembershipExpired(memberId);\n    if (expired) {\n      return 'VERLOPEN';\n    }\n    \n    // If not expired, default to ACTUEEL (frontend handles online/offline)\n    return 'ACTUEEL';\n    \n  } catch (error) {\n    console.error('Error computing card status:', error);\n    return 'ACTUEEL'; // Default to valid when in doubt\n  }\n}\n\n/**\n * Get detailed card status information including reason\n */\nexport async function getCardStatusDetails(memberId: string) {\n  const status = await computeCardStatus(memberId);\n  const fees = await storage.getMembershipFeesByMember(memberId);\n  const now = nowBE();\n  \n  const periods = fees.map(fee => ({\n    ...fee,\n    periodStart: toBEDate(fee.periodStart),\n    periodEnd: toBEDate(fee.periodEnd),\n    paidAt: fee.paidAt ? toBEDate(fee.paidAt) : null,\n  }));\n  \n  // Find current active period\n  const activePeriod = periods.find(period => \n    isDateInPeriod(now, {\n      start: period.periodStart,\n      end: period.periodEnd\n    })\n  );\n  \n  // Find latest period\n  const latestPeriod = periods.reduce((latest, current) => \n    current.periodEnd > latest.periodEnd ? current : latest\n  );\n  \n  return {\n    status,\n    activePeriod: activePeriod || null,\n    latestPeriod: latestPeriod || null,\n    allPeriods: periods,\n    computedAt: now,\n    reason: getStatusReason(status, activePeriod, latestPeriod, now),\n  };\n}\n\n/**\n * Get human readable reason for the status\n */\nfunction getStatusReason(\n  status: CardStatus, \n  activePeriod: any, \n  latestPeriod: any, \n  now: Date\n): string {\n  switch (status) {\n    case 'ACTUEEL':\n      return activePeriod \n        ? `Lopende periode betaald tot ${latestPeriod?.periodEnd?.toLocaleDateString('nl-BE')}`\n        : 'Lidmaatschap is actief';\n        \n    case 'VERLOPEN':\n      return latestPeriod\n        ? `Verlopen sinds ${latestPeriod.periodEnd.toLocaleDateString('nl-BE')}`\n        : 'Lidmaatschap is verlopen';\n        \n    case 'NIET_ACTUEEL':\n      return 'Lidmaatschap status onduidelijk';\n        \n    default:\n      return 'Onbekende status';\n  }\n}\n\n/**\n * Check if member has any paid periods\n */\nexport async function memberHasPaidPeriods(memberId: string): Promise<boolean> {\n  try {\n    const fees = await storage.getMembershipFeesByMember(memberId);\n    return fees.some(fee => fee.status === 'PAID');\n  } catch (error) {\n    console.error('Error checking paid periods:', error);\n    return false;\n  }\n}\n\n/**\n * Get the latest paid period for a member\n */\nexport async function getLatestPaidPeriod(memberId: string) {\n  try {\n    const fees = await storage.getMembershipFeesByMember(memberId);\n    const paidFees = fees.filter(fee => fee.status === 'PAID');\n    \n    if (paidFees.length === 0) {\n      return null;\n    }\n    \n    return paidFees.reduce((latest, current) => \n      current.periodEnd > latest.periodEnd ? current : latest\n    );\n  } catch (error) {\n    console.error('Error getting latest paid period:', error);\n    return null;\n  }\n}","size_bytes":4183},"server/lib/card/validUntil.ts":{"content":"import { storage } from '../../storage';\nimport { nowBE, toBEDate } from '../time/beTime';\nimport { getLatestPaidPeriod } from './status';\nimport { makeCardETag } from './etag';\nimport { randomBytes } from 'crypto';\n\n/**\n * Update the validUntil date for a member's card\n * This is the core lifecycle function that determines when a card expires\n * \n * Rules:\n * - validUntil = periodEnd of the latest PAID period\n * - If no paid periods, validUntil = null\n * - Updates version and ETag after changes\n */\nexport async function updateValidUntil(memberId: string): Promise<Date | null> {\n  try {\n    // Get the latest paid period for this member\n    const latestPaidPeriod = await getLatestPaidPeriod(memberId);\n    \n    let newValidUntil: Date | null = null;\n    \n    if (latestPaidPeriod) {\n      // validUntil is the end date of the latest paid period\n      newValidUntil = toBEDate(latestPaidPeriod.periodEnd);\n    }\n    \n    // Get or create card meta for this member\n    let cardMeta = await storage.getCardMetaByMember(memberId);\n    \n    if (!cardMeta) {\n      // Create initial card meta if it doesn't exist\n      const member = await storage.getMember(memberId);\n      if (!member) {\n        throw new Error(`Member ${memberId} not found`);\n      }\n      \n      const tenant = await storage.getTenant(member.tenantId);\n      if (!tenant) {\n        throw new Error(`Tenant ${member.tenantId} not found`);\n      }\n      \n      // Generate tokens for new card\n      const qrToken = generateSecureToken(32);\n      const secureToken = generateSecureToken(64);\n      \n      // Create initial ETag\n      const initialETag = makeCardETag(\n        {\n          id: member.id,\n          firstName: member.firstName,\n          lastName: member.lastName,\n          memberNumber: member.memberNumber,\n          category: member.category,\n          votingRights: member.votingRights || false,\n        },\n        {\n          name: tenant.name,\n          logoUrl: tenant.logoUrl,\n          primaryColor: tenant.primaryColor || '#bb2e2e',\n        },\n        'NIET_ACTUEEL', // Initial status\n        newValidUntil,\n        [], // No badges initially\n        1\n      );\n      \n      cardMeta = await storage.createCardMeta({\n        memberId,\n        tenantId: member.tenantId,\n        qrToken,\n        secureToken,\n        status: 'NIET_ACTUEEL',\n        validUntil: newValidUntil,\n        etag: initialETag,\n        version: 1,\n      });\n    } else {\n      // Update existing card meta\n      const member = await storage.getMember(memberId);\n      const tenant = await storage.getTenant(member!.tenantId);\n      \n      // Check if validUntil actually changed\n      const currentValidUntil = cardMeta.validUntil ? toBEDate(cardMeta.validUntil) : null;\n      const validUntilChanged = (\n        (currentValidUntil === null && newValidUntil !== null) ||\n        (currentValidUntil !== null && newValidUntil === null) ||\n        (currentValidUntil && newValidUntil && currentValidUntil.getTime() !== newValidUntil.getTime())\n      );\n      \n      if (validUntilChanged) {\n        // Increment version and regenerate ETag\n        const newVersion = (cardMeta.version || 1) + 1;\n        \n        const badges = [];\n        if (member!.votingRights) {\n          badges.push('Stemgerechtigd');\n        }\n        \n        const newETag = makeCardETag(\n          {\n            id: member!.id,\n            firstName: member!.firstName,\n            lastName: member!.lastName,\n            memberNumber: member!.memberNumber,\n            category: member!.category,\n            votingRights: member!.votingRights || false,\n          },\n          {\n            name: tenant!.name,\n            logoUrl: tenant!.logoUrl,\n            primaryColor: tenant!.primaryColor || '#bb2e2e',\n          },\n          cardMeta.status,\n          newValidUntil,\n          badges,\n          newVersion\n        );\n        \n        // Update card meta with new validUntil, version, and ETag\n        await storage.updateCardMeta(cardMeta.id, {\n          validUntil: newValidUntil,\n          version: newVersion,\n          etag: newETag,\n          updatedAt: nowBE(),\n        });\n        \n        console.log(`Updated validUntil for member ${memberId}: ${newValidUntil?.toISOString() || 'null'} (version ${newVersion})`);\n      }\n    }\n    \n    return newValidUntil;\n    \n  } catch (error) {\n    console.error('Error updating validUntil:', error);\n    throw error;\n  }\n}\n\n/**\n * Update validUntil for multiple members in batch\n * Useful for bulk operations and rollover processes\n */\nexport async function updateValidUntilBatch(memberIds: string[]): Promise<Map<string, Date | null>> {\n  const results = new Map<string, Date | null>();\n  \n  for (const memberId of memberIds) {\n    try {\n      const validUntil = await updateValidUntil(memberId);\n      results.set(memberId, validUntil);\n    } catch (error) {\n      console.error(`Error updating validUntil for member ${memberId}:`, error);\n      results.set(memberId, null);\n    }\n  }\n  \n  return results;\n}\n\n/**\n * Force refresh of card meta (regenerate tokens and ETag)\n * Used for security purposes or when card needs to be invalidated\n */\nexport async function refreshCardMeta(memberId: string, regenerateTokens: boolean = false): Promise<void> {\n  try {\n    const cardMeta = await storage.getCardMetaByMemberId(memberId);\n    if (!cardMeta) {\n      throw new Error(`No card meta found for member ${memberId}`);\n    }\n    \n    const member = await storage.getMember(memberId);\n    const tenant = await storage.getTenant(member!.tenantId);\n    \n    const newVersion = (cardMeta.version || 1) + 1;\n    const updateData: any = {\n      version: newVersion,\n      updatedAt: nowBE(),\n    };\n    \n    // Regenerate tokens if requested\n    if (regenerateTokens) {\n      updateData.qrToken = generateSecureToken(32);\n      updateData.secureToken = generateSecureToken(64);\n    }\n    \n    // Generate new ETag\n    const badges = [];\n    if (member!.votingRights) {\n      badges.push('Stemgerechtigd');\n    }\n    \n    const newETag = makeCardETag(\n      {\n        id: member!.id,\n        firstName: member!.firstName,\n        lastName: member!.lastName,\n        memberNumber: member!.memberNumber,\n        category: member!.category,\n        votingRights: member!.votingRights || false,\n      },\n      {\n        name: tenant!.name,\n        logoUrl: tenant!.logoUrl,\n        primaryColor: tenant!.primaryColor || '#bb2e2e',\n      },\n      cardMeta.status,\n      cardMeta.validUntil,\n      badges,\n      newVersion\n    );\n    \n    updateData.etag = newETag;\n    \n    await storage.updateCardMeta(cardMeta.id, updateData);\n    \n    console.log(`Refreshed card meta for member ${memberId} (version ${newVersion})`);\n    \n  } catch (error) {\n    console.error('Error refreshing card meta:', error);\n    throw error;\n  }\n}\n\n/**\n * Generate a cryptographically secure token\n */\nfunction generateSecureToken(length: number): string {\n  return randomBytes(Math.ceil(length / 2)).toString('hex').substring(0, length);\n}\n\n/**\n * Get the effective valid until date for a member\n * This is what should be displayed on the card\n */\nexport async function getEffectiveValidUntil(memberId: string): Promise<Date | null> {\n  try {\n    const cardMeta = await storage.getCardMetaByMemberId(memberId);\n    \n    if (!cardMeta || !cardMeta.validUntil) {\n      return null;\n    }\n    \n    return toBEDate(cardMeta.validUntil);\n    \n  } catch (error) {\n    console.error('Error getting effective validUntil:', error);\n    return null;\n  }\n}","size_bytes":7514},"server/lib/fees/periods.ts":{"content":"import { addMonths, addYears, startOfDay } from 'date-fns';\nimport { toBEDate, nowBE } from '../time/beTime';\n\nexport type PaymentTerm = 'MONTHLY' | 'YEARLY';\n\nexport interface Period {\n  start: Date;\n  end: Date;\n}\n\n/**\n * Create a monthly period starting from the given date\n * No prorata - full month period\n */\nexport function monthlyFrom(start: Date): Period {\n  const startDate = startOfDay(toBEDate(start));\n  const endDate = addMonths(startDate, 1);\n  \n  return {\n    start: startDate,\n    end: endDate,\n  };\n}\n\n/**\n * Create a yearly period starting from the given date\n * No prorata - full year period, handles leap years correctly\n */\nexport function yearlyFrom(start: Date): Period {\n  const startDate = startOfDay(toBEDate(start));\n  const endDate = addYears(startDate, 1);\n  \n  return {\n    start: startDate,\n    end: endDate,\n  };\n}\n\n/**\n * Generate the next period based on the end date of the previous period\n * Next period starts exactly where the previous one ended\n */\nexport function nextFrom(end: Date, term: PaymentTerm): Period {\n  const startDate = startOfDay(toBEDate(end));\n  \n  if (term === 'MONTHLY') {\n    return monthlyFrom(startDate);\n  } else {\n    return yearlyFrom(startDate);\n  }\n}\n\n/**\n * Create period based on payment term\n */\nexport function createPeriod(start: Date, term: PaymentTerm): Period {\n  if (term === 'MONTHLY') {\n    return monthlyFrom(start);\n  } else {\n    return yearlyFrom(start);\n  }\n}\n\n/**\n * Check if a date is within the given period (inclusive start, exclusive end)\n * Uses Belgium timezone for comparison\n */\nexport function isDateInPeriod(date: Date, period: Period): boolean {\n  const checkDate = toBEDate(date);\n  const periodStart = toBEDate(period.start);\n  const periodEnd = toBEDate(period.end);\n  \n  return checkDate >= periodStart && checkDate < periodEnd;\n}\n\n/**\n * Check if the current period is active (current date is within the period)\n */\nexport function isPeriodActive(period: Period): boolean {\n  return isDateInPeriod(nowBE(), period);\n}\n\n/**\n * Check if a period has expired (current date is after period end)\n */\nexport function isPeriodExpired(period: Period): boolean {\n  const now = nowBE();\n  const periodEnd = toBEDate(period.end);\n  \n  return now >= periodEnd;\n}\n\n/**\n * Get the number of days until period expires\n * Returns negative if already expired\n */\nexport function daysUntilExpiry(period: Period): number {\n  const now = nowBE();\n  const periodEnd = toBEDate(period.end);\n  \n  const diffMs = periodEnd.getTime() - now.getTime();\n  return Math.ceil(diffMs / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Generate a sequence of periods starting from a date\n * Useful for creating multiple periods in advance\n */\nexport function generatePeriods(startDate: Date, term: PaymentTerm, count: number): Period[] {\n  const periods: Period[] = [];\n  let currentStart = startOfDay(toBEDate(startDate));\n  \n  for (let i = 0; i < count; i++) {\n    const period = createPeriod(currentStart, term);\n    periods.push(period);\n    currentStart = period.end;\n  }\n  \n  return periods;\n}\n\n/**\n * Find the current active period from a list of periods\n */\nexport function findActivePeriod(periods: Period[]): Period | null {\n  const now = nowBE();\n  \n  return periods.find(period => isDateInPeriod(now, period)) || null;\n}\n\n/**\n * Find the latest period from a list of periods\n */\nexport function findLatestPeriod(periods: Period[]): Period | null {\n  if (periods.length === 0) return null;\n  \n  return periods.reduce((latest, current) => \n    current.end > latest.end ? current : latest\n  );\n}","size_bytes":3556},"server/lib/time/beTime.ts":{"content":"import { fromZonedTime, toZonedTime } from 'date-fns-tz';\nimport { format, isValid } from 'date-fns';\nimport { nl } from 'date-fns/locale';\n\nconst BE_TIMEZONE = 'Europe/Brussels';\n\n/**\n * Get current time in Belgium timezone\n */\nexport function nowBE(): Date {\n  return toZonedTime(new Date(), BE_TIMEZONE);\n}\n\n/**\n * Convert any date to Belgium timezone\n */\nexport function toBEDate(date: Date): Date {\n  if (!isValid(date)) {\n    throw new Error('Invalid date provided');\n  }\n  return toZonedTime(date, BE_TIMEZONE);\n}\n\n/**\n * Format date in Belgian format (dd-mm-yyyy)\n */\nexport function formatDateBE(date: Date): string {\n  if (!isValid(date)) {\n    return '';\n  }\n  \n  const beDate = toBEDate(date);\n  return format(beDate, 'dd-MM-yyyy', { locale: nl });\n}\n\n/**\n * Format date and time in Belgian format\n */\nexport function formatDateTimeBE(date: Date): string {\n  if (!isValid(date)) {\n    return '';\n  }\n  \n  const beDate = toBEDate(date);\n  return format(beDate, 'dd-MM-yyyy HH:mm', { locale: nl });\n}\n\n/**\n * Convert local Belgium time to UTC for storage\n */\nexport function beTimeToUtc(beDate: Date): Date {\n  if (!isValid(beDate)) {\n    throw new Error('Invalid date provided');\n  }\n  return fromZonedTime(beDate, BE_TIMEZONE);\n}\n\n/**\n * Check if a date is today in Belgium timezone\n */\nexport function isTodayBE(date: Date): boolean {\n  if (!isValid(date)) {\n    return false;\n  }\n  \n  const today = nowBE();\n  const checkDate = toBEDate(date);\n  \n  return format(today, 'yyyy-MM-dd') === format(checkDate, 'yyyy-MM-dd');\n}\n\n/**\n * Get start of day in Belgium timezone\n */\nexport function startOfDayBE(date: Date): Date {\n  if (!isValid(date)) {\n    throw new Error('Invalid date provided');\n  }\n  \n  const beDate = toBEDate(date);\n  const startOfDay = new Date(beDate);\n  startOfDay.setHours(0, 0, 0, 0);\n  \n  return startOfDay;\n}\n\n/**\n * Get end of day in Belgium timezone\n */\nexport function endOfDayBE(date: Date): Date {\n  if (!isValid(date)) {\n    throw new Error('Invalid date provided');\n  }\n  \n  const beDate = toBEDate(date);\n  const endOfDay = new Date(beDate);\n  endOfDay.setHours(23, 59, 59, 999);\n  \n  return endOfDay;\n}","size_bytes":2147},"server/lib/fees/rollover.ts":{"content":"import { storage } from '../../storage';\nimport { nowBE, startOfDayBE, toBEDate } from '../time/beTime';\nimport { computeCardStatus } from '../card/status';\n\nexport interface RolloverSummary {\n  processedAt: Date;\n  tenantId?: string;\n  expiredFeesCount: number;\n  newPeriodsCreated: number;\n  cardsUpdated: number;\n  errors: Array<{\n    memberId: string;\n    error: string;\n  }>;\n}\n\n/**\n * Daily rollover process to handle expired fees and create new periods\n * This should be run once per day, typically at midnight BE time\n */\nexport async function rolloverDaily(tenantId?: string): Promise<RolloverSummary> {\n  const startTime = nowBE();\n  const today = startOfDayBE(nowBE());\n  \n  console.log(`Starting daily rollover for ${tenantId ? `tenant ${tenantId}` : 'all tenants'} at ${startTime.toISOString()}`);\n  \n  const summary: RolloverSummary = {\n    processedAt: startTime,\n    tenantId,\n    expiredFeesCount: 0,\n    newPeriodsCreated: 0,\n    cardsUpdated: 0,\n    errors: [],\n  };\n  \n  try {\n    // Step 1: Get all open/outstanding fees that have passed their periodEnd\n    const allFees = tenantId \n      ? await storage.getMembershipFeesByTenant(tenantId)\n      : await storage.getAllMembershipFees();\n    \n    const expiredFees = allFees.filter(fee => {\n      const periodEnd = toBEDate(fee.periodEnd);\n      return fee.status === 'OPEN' && today > periodEnd;\n    });\n    \n    console.log(`Found ${expiredFees.length} expired fees to mark as overdue`);\n    \n    // Step 2: Mark expired fees as OVERDUE\n    for (const fee of expiredFees) {\n      try {\n        await storage.updateMembershipFee(fee.id, {\n          status: 'OVERDUE',\n        });\n        summary.expiredFeesCount++;\n      } catch (error) {\n        summary.errors.push({\n          memberId: fee.memberId,\n          error: `Failed to mark fee ${fee.id} as overdue: ${error}`,\n        });\n      }\n    }\n    \n    // Step 3: Update card statuses for affected members\n    const affectedMemberIds = [...new Set(expiredFees.map(fee => fee.memberId))];\n    \n    for (const memberId of affectedMemberIds) {\n      try {\n        const newStatus = await computeCardStatus(memberId);\n        const cardMeta = await storage.getCardMetaByMember(memberId);\n        \n        if (cardMeta && cardMeta.status !== newStatus) {\n          await storage.updateCardMeta(cardMeta.id, {\n            status: newStatus,\n            version: (cardMeta.version || 1) + 1,\n          });\n          summary.cardsUpdated++;\n          console.log(`Updated card status for member ${memberId}: ${cardMeta.status} -> ${newStatus}`);\n        }\n      } catch (error) {\n        summary.errors.push({\n          memberId,\n          error: `Failed to update card status: ${error}`,\n        });\n      }\n    }\n    \n    console.log(`Daily rollover completed: ${summary.expiredFeesCount} fees expired, ${summary.cardsUpdated} cards updated`);\n    \n  } catch (error) {\n    console.error('Daily rollover failed:', error);\n    summary.errors.push({\n      memberId: 'SYSTEM',\n      error: `Rollover process failed: ${error}`,\n    });\n  }\n  \n  return summary;\n}\n\n/**\n * Process rollover for a specific member (useful for testing or manual correction)\n */\nexport async function rolloverForMember(memberId: string): Promise<void> {\n  const today = startOfDayBE(nowBE());\n  \n  // Get member's fees\n  const fees = await storage.getMembershipFeesByMember(memberId);\n  \n  // Mark expired open fees as overdue\n  for (const fee of fees) {\n    if (fee.status === 'OPEN' && toBEDate(fee.periodEnd) < today) {\n      await storage.updateMembershipFee(fee.id, {\n        status: 'OVERDUE',\n      });\n    }\n  }\n  \n  // Update card status\n  const newStatus = await computeCardStatus(memberId);\n  const cardMeta = await storage.getCardMetaByMember(memberId);\n  \n  if (cardMeta && cardMeta.status !== newStatus) {\n    await storage.updateCardMeta(cardMeta.id, {\n      status: newStatus,\n      version: (cardMeta.version || 1) + 1,\n    });\n  }\n}\n\n/**\n * Check if rollover is needed (has overdue fees that haven't been processed)\n */\nexport async function checkRolloverNeeded(tenantId?: string): Promise<boolean> {\n  const today = startOfDayBE(nowBE());\n  \n  const allFees = tenantId \n    ? await storage.getMembershipFeesByTenant(tenantId)\n    : await storage.getAllMembershipFees();\n  \n  // Check if there are any OPEN fees past their periodEnd\n  const needsRollover = allFees.some(fee => {\n    const periodEnd = toBEDate(fee.periodEnd);\n    return fee.status === 'OPEN' && today > periodEnd;\n  });\n  \n  return needsRollover;\n}","size_bytes":4527},"tests/periods.test.ts":{"content":"import { describe, it, expect } from 'vitest';\nimport {\n  monthlyFrom,\n  yearlyFrom,\n  nextFrom,\n  createPeriod,\n  isDateInPeriod,\n  isPeriodActive,\n  isPeriodExpired,\n  generatePeriods,\n  type PaymentTerm\n} from '../server/lib/fees/periods';\n\ndescribe('Period Calculations', () => {\n  describe('monthlyFrom', () => {\n    it('creates monthly periods correctly', () => {\n      const jan2024 = monthlyFrom(new Date(2024, 0, 1)); // January 2024\n      expect(jan2024.start).toEqual(new Date(2024, 0, 1)); // Jan 1\n      expect(jan2024.end).toEqual(new Date(2024, 1, 1)); // Feb 1\n      \n      const dec2024 = monthlyFrom(new Date(2024, 11, 1)); // December 2024\n      expect(dec2024.start).toEqual(new Date(2024, 11, 1)); // Dec 1\n      expect(dec2024.end).toEqual(new Date(2025, 0, 1)); // Jan 1 2025\n    });\n  });\n\n  describe('yearlyFrom', () => {\n    it('creates yearly periods correctly', () => {\n      const year2024 = yearlyFrom(new Date(2024, 0, 1));\n      expect(year2024.start).toEqual(new Date(2024, 0, 1)); // Jan 1, 2024\n      expect(year2024.end).toEqual(new Date(2025, 0, 1)); // Jan 1, 2025\n    });\n  });\n\n  describe('generatePeriods', () => {\n    it('generates multiple monthly periods', () => {\n      const start = new Date(2024, 0, 1); // Jan 1, 2024\n      const periods = generatePeriods(start, 'MONTHLY', 3);\n      \n      expect(periods).toHaveLength(3);\n      expect(periods[0].start).toEqual(new Date(2024, 0, 1)); // Jan 1\n      expect(periods[0].end).toEqual(new Date(2024, 1, 1)); // Feb 1\n      expect(periods[1].start).toEqual(new Date(2024, 1, 1)); // Feb 1\n      expect(periods[2].end).toEqual(new Date(2024, 3, 1)); // Apr 1\n    });\n\n    it('generates multiple yearly periods', () => {\n      const start = new Date(2024, 5, 15); // June 15, 2024\n      const periods = generatePeriods(start, 'YEARLY', 2);\n      \n      expect(periods).toHaveLength(2);\n      expect(periods[0].start).toEqual(new Date(2024, 5, 15)); // June 15, 2024\n      expect(periods[0].end).toEqual(new Date(2025, 5, 15)); // June 15, 2025\n      expect(periods[1].start).toEqual(new Date(2025, 5, 15)); // June 15, 2025\n      expect(periods[1].end).toEqual(new Date(2026, 5, 15)); // June 15, 2026\n    });\n  });\n\n  describe('isDateInPeriod', () => {\n    const period = {\n      start: new Date(2024, 0, 1), // Jan 1, 2024\n      end: new Date(2024, 1, 1),   // Feb 1, 2024\n    };\n\n    it('returns true for dates within period', () => {\n      expect(isDateInPeriod(new Date(2024, 0, 1), period)).toBe(true); // Start date\n      expect(isDateInPeriod(new Date(2024, 0, 15), period)).toBe(true); // Middle\n      expect(isDateInPeriod(new Date(2024, 0, 31), period)).toBe(true); // Last day of Jan\n    });\n\n    it('returns false for dates outside period', () => {\n      expect(isDateInPeriod(new Date(2023, 11, 31), period)).toBe(false); // Before start\n      expect(isDateInPeriod(new Date(2024, 1, 1), period)).toBe(false); // On end date (exclusive)\n      expect(isDateInPeriod(new Date(2024, 1, 2), period)).toBe(false); // After end\n    });\n  });\n\n  describe('isPeriodActive', () => {\n    it('correctly identifies active periods with current time', () => {\n      const activePeriod = {\n        start: new Date(2024, 0, 1),   // Jan 1, 2024\n        end: new Date(2024, 1, 1),     // Feb 1, 2024\n      };\n      \n      // Test uses current time, so just test structure\n      const result = isPeriodActive(activePeriod);\n      expect(typeof result).toBe('boolean');\n    });\n  });\n\n  describe('isPeriodExpired', () => {\n    it('correctly identifies expired periods with current time', () => {\n      const expiredPeriod = {\n        start: new Date(2020, 0, 1),   // Jan 1, 2020 (definitely expired)\n        end: new Date(2020, 1, 1),     // Feb 1, 2020\n      };\n      \n      expect(isPeriodExpired(expiredPeriod)).toBe(true);\n      \n      const futurePeriod = {\n        start: new Date(2030, 1, 1),   // Future period\n        end: new Date(2030, 2, 1),\n      };\n      expect(isPeriodExpired(futurePeriod)).toBe(false);\n    });\n  });\n});","size_bytes":4025},"server/lib/card/simple-validuntil.ts":{"content":"import { storage } from '../../storage';\nimport { toBEDate } from '../time/beTime';\n\n/**\n * Simplified validUntil service that works with existing data structures\n * Updates validUntil to the end date of the latest paid period\n */\nexport async function updateMemberValidUntil(memberId: string): Promise<Date | null> {\n  try {\n    // Get all membership fees for this member\n    const fees = await storage.getMembershipFeesByMember(memberId);\n    \n    if (fees.length === 0) {\n      return null;\n    }\n    \n    // Find all paid periods\n    const paidFees = fees.filter(fee => fee.status === 'PAID');\n    \n    if (paidFees.length === 0) {\n      return null;\n    }\n    \n    // Get the latest paid period\n    const latestPaidPeriod = paidFees.reduce((latest, current) => \n      toBEDate(current.periodEnd) > toBEDate(latest.periodEnd) ? current : latest\n    );\n    \n    const validUntilDate = toBEDate(latestPaidPeriod.periodEnd);\n    \n    // Try to update card meta if it exists\n    try {\n      const cardMeta = await storage.getCardMetaByMember(memberId);\n      if (cardMeta) {\n        await storage.updateCardMeta(cardMeta.id, {\n          validUntil: validUntilDate,\n          version: (cardMeta.version || 1) + 1,\n        });\n      }\n    } catch (error) {\n      console.warn('Could not update card meta:', error);\n      // Continue, this is not critical for the validUntil calculation\n    }\n    \n    return validUntilDate;\n    \n  } catch (error) {\n    console.error('Error updating validUntil:', error);\n    throw error;\n  }\n}\n\n/**\n * Get the current validUntil date for a member based on their paid periods\n */\nexport async function getMemberValidUntil(memberId: string): Promise<Date | null> {\n  try {\n    const fees = await storage.getMembershipFeesByMember(memberId);\n    const paidFees = fees.filter(fee => fee.status === 'PAID');\n    \n    if (paidFees.length === 0) {\n      return null;\n    }\n    \n    const latestPaidPeriod = paidFees.reduce((latest, current) => \n      toBEDate(current.periodEnd) > toBEDate(latest.periodEnd) ? current : latest\n    );\n    \n    return toBEDate(latestPaidPeriod.periodEnd);\n    \n  } catch (error) {\n    console.error('Error getting validUntil:', error);\n    return null;\n  }\n}\n\n/**\n * Check if a member's card is currently valid\n */\nexport async function isMemberCardValid(memberId: string): Promise<boolean> {\n  const validUntil = await getMemberValidUntil(memberId);\n  \n  if (!validUntil) {\n    return false;\n  }\n  \n  const now = new Date();\n  return now <= validUntil;\n}","size_bytes":2512},"client/src/hooks/useReports.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { \n  MoneyPoint, \n  CategorySlice, \n  StackedMonth, \n  FeeStatusMonth, \n  TopMember, \n  MethodSlice \n} from \"@shared/schema\";\n\n// Rapportage filters interface\nexport interface ReportFilters {\n  from?: string;\n  to?: string;\n  types?: string[];\n  categories?: string[];\n  methods?: string[];\n  statuses?: string[];\n}\n\n/**\n * Hook voor cashflow rapportage\n */\nexport function useCashflowSeries(filters: ReportFilters = {}) {\n  return useQuery({\n    queryKey: ['/api/reports/cashflow', filters],\n    staleTime: 5 * 60 * 1000, // 5 minuten\n    select: (data): MoneyPoint[] => data || [],\n  });\n}\n\n/**\n * Hook voor categorie breakdown (inkomsten of uitgaven)\n */\nexport function useCategoryBreakdown(\n  filters: ReportFilters = {}, \n  kind: \"income\" | \"expense\" = \"expense\"\n) {\n  return useQuery({\n    queryKey: ['/api/reports/categories', { ...filters, kind }],\n    staleTime: 5 * 60 * 1000,\n    select: (data): CategorySlice[] => data || [],\n  });\n}\n\n/**\n * Hook voor gestapelde categorie data per maand\n */\nexport function useStackedByCategory(filters: ReportFilters = {}) {\n  return useQuery({\n    queryKey: ['/api/reports/stacked-by-category', filters],\n    staleTime: 5 * 60 * 1000,\n    select: (data): StackedMonth[] => data || [],\n  });\n}\n\n/**\n * Hook voor fee status trend over tijd\n */\nexport function useFeeStatusTrend(filters: ReportFilters = {}) {\n  return useQuery({\n    queryKey: ['/api/reports/fee-status-trend', filters],\n    staleTime: 5 * 60 * 1000,\n    select: (data): FeeStatusMonth[] => data || [],\n  });\n}\n\n/**\n * Hook voor top leden per totaal bedrag\n */\nexport function useTopMembers(filters: ReportFilters = {}) {\n  return useQuery({\n    queryKey: ['/api/reports/top-members', filters],\n    staleTime: 5 * 60 * 1000,\n    select: (data): TopMember[] => data || [],\n  });\n}\n\n/**\n * Hook voor betaalmethode breakdown\n */\nexport function useMethodBreakdown(filters: ReportFilters = {}) {\n  return useQuery({\n    queryKey: ['/api/reports/methods', filters],\n    staleTime: 5 * 60 * 1000,\n    select: (data): MethodSlice[] => data || [],\n  });\n}\n\n/**\n * Hook voor reconciliatie data\n */\nexport function useBankStatements() {\n  return useQuery({\n    queryKey: ['/api/finance/statements'],\n    staleTime: 30 * 1000, // 30 seconden\n  });\n}\n\nexport function useBankTransactions(filters: {\n  status?: string;\n  from?: string;\n  to?: string;\n  side?: 'CREDIT' | 'DEBET';\n  category?: string;\n  vendor?: string;\n  q?: string;\n} = {}) {\n  return useQuery({\n    queryKey: ['/api/finance/bank-transactions', filters],\n    staleTime: 30 * 1000,\n  });\n}\n\n/**\n * Hook voor expense categories\n */\nexport function useExpenseCategories() {\n  return useQuery({\n    queryKey: ['/api/finance/categories'],\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\n/**\n * Hook voor vendors\n */\nexport function useVendors() {\n  return useQuery({\n    queryKey: ['/api/finance/vendors'],\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\n/**\n * Hook voor match rules\n */\nexport function useMatchRules() {\n  return useQuery({\n    queryKey: ['/api/finance/rules'],\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\n/**\n * Utility hook voor combined financiële rapportage\n */\nexport function useFinancialDashboard(filters: ReportFilters = {}) {\n  const cashflow = useCashflowSeries(filters);\n  const categoryExpenses = useCategoryBreakdown(filters, \"expense\");\n  const categoryIncome = useCategoryBreakdown(filters, \"income\");\n  const feeStatusTrend = useFeeStatusTrend(filters);\n  const topMembers = useTopMembers(filters);\n  const methodBreakdown = useMethodBreakdown(filters);\n\n  return {\n    cashflow,\n    categoryExpenses,\n    categoryIncome,\n    feeStatusTrend,\n    topMembers,\n    methodBreakdown,\n    loading: cashflow.isLoading || \n             categoryExpenses.isLoading || \n             categoryIncome.isLoading || \n             feeStatusTrend.isLoading || \n             topMembers.isLoading || \n             methodBreakdown.isLoading,\n    error: cashflow.error || \n           categoryExpenses.error || \n           categoryIncome.error || \n           feeStatusTrend.error || \n           topMembers.error || \n           methodBreakdown.error,\n  };\n}","size_bytes":4170},"lib/reconcile/__tests__/csv-parser.test.ts":{"content":"import { describe, it, expect, beforeEach } from 'vitest';\nimport { CsvParser, bankConfigs } from '../parsers/csv';\n\ndescribe('CsvParser', () => {\n  let parser: CsvParser;\n\n  beforeEach(() => {\n    parser = new CsvParser();\n  });\n\n  describe('Basic CSV parsing', () => {\n    it('should parse a simple CSV with header', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving,Tegenpartij,IBAN,Referentie\n01/01/2024,123.45,\"Lidgeld Jan Janssen\",\"Jan Janssen\",\"BE12345678901234567890\",\"REF123\"\n02/01/2024,-45.67,\"Elektriciteit EANDIS\",\"EANDIS\",\"BE98765432109876543210\",\"INVOICE456\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(2);\n      \n      // Eerste transactie (credit)\n      expect(transactions[0]).toMatchObject({\n        amount: 12345, // in centen\n        side: 'CREDIT',\n        currency: 'EUR',\n        counterparty: 'Jan Janssen',\n        iban: 'BE12345678901234567890',\n        description: 'Lidgeld Jan Janssen',\n        ref: 'REF123',\n      });\n      \n      // Tweede transactie (debet)\n      expect(transactions[1]).toMatchObject({\n        amount: 4567, // in centen (altijd positief)\n        side: 'DEBET',\n        currency: 'EUR',\n        counterparty: 'EANDIS',\n        iban: 'BE98765432109876543210',\n        description: 'Elektriciteit EANDIS',\n        ref: 'INVOICE456',\n      });\n    });\n\n    it('should handle CSV without optional fields', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,100.00,\"Test transactie\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(1);\n      expect(transactions[0]).toMatchObject({\n        amount: 10000,\n        side: 'CREDIT',\n        description: 'Test transactie',\n        counterparty: undefined,\n        iban: undefined,\n        ref: undefined,\n      });\n    });\n\n    it('should handle Belgian number format (comma decimal, dot thousands)', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,\"1.234,56\",\"Groot bedrag\"\n02/01/2024,\"€ 45,67\",\"Met euro symbool\"\n03/01/2024,-789,01,\"Negatief bedrag\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(3);\n      expect(transactions[0].amount).toBe(123456); // 1.234,56 -> 123456 centen\n      expect(transactions[1].amount).toBe(4567);   // 45,67 -> 4567 centen\n      expect(transactions[2].amount).toBe(78901);  // 789,01 -> 78901 centen\n    });\n\n    it('should parse various date formats', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,100,\"Date format 1\"\n1/1/2024,200,\"Date format 2\"\n01-01-2024,300,\"Date format 3\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(3);\n      \n      // Alle transacties moeten een geldige datum hebben\n      transactions.forEach(tx => {\n        expect(tx.bookingDate).toBeInstanceOf(Date);\n        expect(tx.bookingDate.getFullYear()).toBe(2024);\n        expect(tx.bookingDate.getMonth()).toBe(0); // Januari (0-indexed)\n        expect(tx.bookingDate.getDate()).toBe(1);\n      });\n    });\n  });\n\n  describe('Bank-specific configurations', () => {\n    it('should use KBC configuration correctly', () => {\n      const kbcParser = new CsvParser(bankConfigs.KBC);\n      \n      // Mock KBC CSV formaat (semicolon separated)\n      const csvContent = `Header;Line;Datum;Tegenpartij;IBAN;Extra;Extra2;Bedrag;Mededeling;Referentie\n1;2;01/01/2024;Jan Janssen;BE12345678901234567890;X;Y;123,45;Lidgeld betaling;REF123`;\n\n      const transactions = kbcParser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(1);\n      expect(transactions[0]).toMatchObject({\n        amount: 12345,\n        side: 'CREDIT',\n        counterparty: 'Jan Janssen',\n        iban: 'BE12345678901234567890',\n        description: 'Lidgeld betaling',\n        ref: 'REF123',\n      });\n    });\n  });\n\n  describe('Edge cases', () => {\n    it('should handle empty CSV', () => {\n      const transactions = parser.parse('');\n      expect(transactions).toHaveLength(0);\n    });\n\n    it('should handle CSV with only header', () => {\n      const csvContent = 'Datum,Bedrag,Beschrijving';\n      const transactions = parser.parse(csvContent);\n      expect(transactions).toHaveLength(0);\n    });\n\n    it('should skip invalid lines and continue parsing', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,100,\"Valid transaction\"\ninvalid,line,here\n02/01/2024,200,\"Another valid transaction\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      // Should parse the valid transactions and skip the invalid one\n      expect(transactions).toHaveLength(2);\n      expect(transactions[0].amount).toBe(10000);\n      expect(transactions[1].amount).toBe(20000);\n    });\n\n    it('should handle quoted fields with commas', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,100,\"Description with, comma\"\n02/01/2024,200,\"Another, description, with commas\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(2);\n      expect(transactions[0].description).toBe('Description with, comma');\n      expect(transactions[1].description).toBe('Another, description, with commas');\n    });\n\n    it('should handle amount parsing edge cases', () => {\n      const csvContent = `Datum,Bedrag,Beschrijving\n01/01/2024,0,\"Zero amount\"\n02/01/2024,0.01,\"Minimum amount\"\n03/01/2024,-0.01,\"Negative minimum\"`;\n\n      const transactions = parser.parse(csvContent);\n      \n      expect(transactions).toHaveLength(3);\n      expect(transactions[0].amount).toBe(0);\n      expect(transactions[0].side).toBe('CREDIT'); // 0 wordt als credit behandeld\n      expect(transactions[1].amount).toBe(1);\n      expect(transactions[1].side).toBe('CREDIT');\n      expect(transactions[2].amount).toBe(1);\n      expect(transactions[2].side).toBe('DEBET');\n    });\n  });\n\n  describe('Configuration validation', () => {\n    it('should use default configuration when none provided', () => {\n      const defaultParser = new CsvParser();\n      // Test that it uses sensible defaults\n      expect(defaultParser).toBeDefined();\n    });\n\n    it('should merge provided config with defaults', () => {\n      const customParser = new CsvParser({\n        delimiter: ';',\n        hasHeader: false,\n      });\n      \n      // Should use custom delimiter but default other settings\n      expect(customParser).toBeDefined();\n    });\n  });\n});","size_bytes":6467},"lib/reconcile/__tests__/matching-engine.test.ts":{"content":"import { describe, it, expect, beforeEach } from 'vitest';\nimport { TransactionMatchingEngine } from '../engine';\nimport type { BankTransaction, MembershipFee, Member, MatchRule, MatchingContext } from '../engine';\n\ndescribe('TransactionMatchingEngine', () => {\n  let engine: TransactionMatchingEngine;\n  let mockContext: MatchingContext;\n\n  beforeEach(() => {\n    engine = new TransactionMatchingEngine();\n    \n    // Mock data voor tests\n    mockContext = {\n      tenantId: 'test-tenant',\n      fees: [\n        {\n          id: 'fee-1',\n          memberId: 'member-1',\n          memberNumber: '001',\n          memberName: 'Jan Janssen',\n          amount: '25.00',\n          status: 'OPEN',\n          periodStart: new Date('2024-01-01'),\n          periodEnd: new Date('2024-12-31'),\n        } as MembershipFee,\n        {\n          id: 'fee-2',\n          memberId: 'member-2',\n          memberNumber: '002',\n          memberName: 'Marie Peeters',\n          amount: '30.00',\n          status: 'OPEN',\n          periodStart: new Date('2024-01-01'),\n          periodEnd: new Date('2024-12-31'),\n        } as MembershipFee,\n      ],\n      members: [\n        {\n          id: 'member-1',\n          memberNumber: '001',\n          firstName: 'Jan',\n          lastName: 'Janssen',\n        } as Member,\n        {\n          id: 'member-2',\n          memberNumber: '002',\n          firstName: 'Marie',\n          lastName: 'Peeters',\n        } as Member,\n      ],\n      rules: [\n        {\n          id: 'rule-1',\n          name: 'Lidgeld matching',\n          priority: 100,\n          active: true,\n          criteria: {\n            contains: ['lidgeld'],\n            amountToleranceCents: 50,\n          },\n          action: {\n            linkTo: 'FEE',\n            categoryId: 'membership',\n          },\n        } as MatchRule,\n      ],\n      existingTransactions: [],\n    };\n  });\n\n  describe('Credit transaction matching (lidgelden)', () => {\n    it('should match exact amount with membership fee', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-1',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '25.00',\n        currency: 'EUR',\n        description: 'Lidgeld betaling',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.matchScore).toBeGreaterThan(70);\n      expect(result.status).toBe('VOORGESTELD');\n      expect(result.matchedFeeId).toBe('fee-1');\n      expect(result.matchedMemberId).toBe('member-1');\n    });\n\n    it('should match transaction with member number in description', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-2',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '25.50', // Slight difference\n        currency: 'EUR',\n        description: 'Betaling lid 001',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.matchScore).toBeGreaterThan(40);\n      expect(result.status).toBeOneOf(['VOORGESTELD', 'GEDEELTELIJK_GEMATCHT']);\n      expect(result.matchedFeeId).toBe('fee-1');\n    });\n\n    it('should match transaction with member name in description', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-3',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '30.00',\n        currency: 'EUR',\n        description: 'Marie Peeters lidgeld',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.matchScore).toBeGreaterThan(40);\n      expect(result.matchedFeeId).toBe('fee-2');\n      expect(result.matchedMemberId).toBe('member-2');\n    });\n\n    it('should have lower score for large amount difference', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-4',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '50.00', // Veel hoger dan verwacht\n        currency: 'EUR',\n        description: 'Betaling',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.matchScore).toBeLessThan(40);\n      expect(result.status).toBe('ONTVANGEN');\n    });\n  });\n\n  describe('Debit transaction matching (uitgaven)', () => {\n    it('should categorize utility expenses', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-5',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'DEBET',\n        amount: '120.50',\n        currency: 'EUR',\n        description: 'Elektriciteit rekening maart',\n        counterparty: 'EANDIS',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.matchScore).toBeGreaterThan(0);\n      expect(result.categoryId).toBe('utilities');\n      expect(result.reasons).toContain('Geclassificeerd als nutsvoorziening');\n    });\n\n    it('should categorize insurance expenses', () => {\n      const transaction: BankTransaction = {\n        id: 'tx-6',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'DEBET',\n        amount: '85.00',\n        currency: 'EUR',\n        description: 'Verzekering brand',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, mockContext);\n\n      expect(result.categoryId).toBe('insurance');\n      expect(result.reasons).toContain('Geclassificeerd als verzekering');\n    });\n  });\n\n  describe('Match rules application', () => {\n    it('should apply match rules with keyword matching', () => {\n      const contextWithRule: MatchingContext = {\n        ...mockContext,\n        rules: [\n          {\n            id: 'rule-2',\n            name: 'Elektriciteit regel',\n            priority: 90,\n            active: true,\n            criteria: {\n              contains: ['elektriciteit', 'stroom'],\n            },\n            action: {\n              categoryId: 'utilities',\n              vendorId: 'eandis',\n            },\n          } as MatchRule,\n        ],\n      };\n\n      const transaction: BankTransaction = {\n        id: 'tx-7',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'DEBET',\n        amount: '95.00',\n        currency: 'EUR',\n        description: 'Elektriciteit verbruik',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, contextWithRule);\n\n      expect(result.categoryId).toBe('utilities');\n      expect(result.vendorId).toBe('eandis');\n      expect(result.reasons).toContainEqual('Match rule toegepast: Elektriciteit regel');\n    });\n  });\n\n  describe('Duplicate detection', () => {\n    it('should detect duplicate transactions', () => {\n      const existingTransaction: BankTransaction = {\n        id: 'existing-tx',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '25.00',\n        currency: 'EUR',\n        description: 'Lidgeld Jan',\n        ref: 'REF123',\n        status: 'GEBOEKT',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const contextWithExisting: MatchingContext = {\n        ...mockContext,\n        existingTransactions: [existingTransaction],\n      };\n\n      const duplicateTransaction: BankTransaction = {\n        id: 'tx-8',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-2',\n        bookingDate: new Date('2024-03-15'), // Zelfde datum\n        side: 'CREDIT',\n        amount: '25.00', // Zelfde bedrag\n        currency: 'EUR',\n        description: 'Lidgeld Jan',\n        ref: 'REF123', // Zelfde referentie\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(duplicateTransaction, contextWithExisting);\n\n      expect(result.reasons).toContain('Mogelijke duplicaat gedetecteerd');\n      expect(result.matchScore).toBeLessThan(50); // Score penalty voor duplicaat\n    });\n  });\n\n  describe('Batch processing', () => {\n    it('should process multiple transactions', () => {\n      const transactions: BankTransaction[] = [\n        {\n          id: 'tx-9',\n          tenantId: 'test-tenant',\n          statementId: 'stmt-1',\n          bookingDate: new Date('2024-03-15'),\n          side: 'CREDIT',\n          amount: '25.00',\n          currency: 'EUR',\n          description: 'Lidgeld Jan Janssen',\n          status: 'ONTVANGEN',\n          createdAt: new Date(),\n        } as BankTransaction,\n        {\n          id: 'tx-10',\n          tenantId: 'test-tenant',\n          statementId: 'stmt-1',\n          bookingDate: new Date('2024-03-15'),\n          side: 'DEBET',\n          amount: '150.00',\n          currency: 'EUR',\n          description: 'Gas rekening',\n          status: 'ONTVANGEN',\n          createdAt: new Date(),\n        } as BankTransaction,\n      ];\n\n      const results = engine.suggestBatchMatches(transactions, mockContext);\n\n      expect(results).toHaveLength(2);\n      expect(results[0].transactionId).toBe('tx-9');\n      expect(results[1].transactionId).toBe('tx-10');\n      \n      // Eerste moet match hebben met lidgeld\n      expect(results[0].matchedFeeId).toBe('fee-1');\n      \n      // Tweede moet utility categorie hebben\n      expect(results[1].categoryId).toBe('utilities');\n    });\n  });\n\n  describe('Edge cases', () => {\n    it('should handle already processed transactions', () => {\n      const processedTransaction: BankTransaction = {\n        id: 'tx-11',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '25.00',\n        currency: 'EUR',\n        description: 'Lidgeld',\n        status: 'GEMATCHT', // Al gematcht\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(processedTransaction, mockContext);\n\n      expect(result.matchScore).toBe(0);\n      expect(result.status).toBe('ONTVANGEN');\n      expect(result.reasons).toContain('Transactie al verwerkt');\n    });\n\n    it('should handle transactions without context data', () => {\n      const emptyContext: MatchingContext = {\n        tenantId: 'test-tenant',\n        fees: [],\n        members: [],\n        rules: [],\n        existingTransactions: [],\n      };\n\n      const transaction: BankTransaction = {\n        id: 'tx-12',\n        tenantId: 'test-tenant',\n        statementId: 'stmt-1',\n        bookingDate: new Date('2024-03-15'),\n        side: 'CREDIT',\n        amount: '25.00',\n        currency: 'EUR',\n        description: 'Onbekende betaling',\n        status: 'ONTVANGEN',\n        createdAt: new Date(),\n      } as BankTransaction;\n\n      const result = engine.suggestMatches(transaction, emptyContext);\n\n      expect(result.matchScore).toBeLessThan(40);\n      expect(result.status).toBe('ONTVANGEN');\n    });\n  });\n});","size_bytes":11671},"lib/reconcile/engine.ts":{"content":"import { z } from \"zod\";\nimport { differenceInDays, format, parseISO } from \"date-fns\";\nimport type { \n  BankTransaction, \n  MembershipFee, \n  Member, \n  MatchRule \n} from \"../../shared/schema\";\n\n// Matching resultaat schema\nexport const matchResultSchema = z.object({\n  transactionId: z.string(),\n  matchedFeeId: z.string().optional(),\n  matchedMemberId: z.string().optional(),\n  categoryId: z.string().optional(),\n  vendorId: z.string().optional(),\n  matchScore: z.number().min(0).max(100),\n  status: z.enum(['VOORGESTELD', 'GEDEELTELIJK_GEMATCHT', 'ONTVANGEN']),\n  reasons: z.array(z.string()),\n});\n\nexport type MatchResult = z.infer<typeof matchResultSchema>;\n\n// Matching context voor database lookups\nexport interface MatchingContext {\n  tenantId: string;\n  fees: MembershipFee[];\n  members: Member[];\n  rules: MatchRule[];\n  existingTransactions: BankTransaction[];\n}\n\n/**\n * Automatische matching engine voor banktransacties\n */\nexport class TransactionMatchingEngine {\n  \n  /**\n   * Suggereer matches voor een transactie\n   */\n  suggestMatches(\n    transaction: BankTransaction, \n    context: MatchingContext\n  ): MatchResult {\n    \n    const reasons: string[] = [];\n    let score = 0;\n    let matchedFeeId: string | undefined;\n    let matchedMemberId: string | undefined;\n    let categoryId: string | undefined;\n    let vendorId: string | undefined;\n    \n    // Skip als transactie al gematcht is\n    if (transaction.status !== 'ONTVANGEN') {\n      return {\n        transactionId: transaction.id,\n        matchScore: 0,\n        status: 'ONTVANGEN',\n        reasons: ['Transactie al verwerkt'],\n      };\n    }\n    \n    // 1. Duplicaat detectie\n    if (this.isDuplicate(transaction, context.existingTransactions)) {\n      reasons.push('Mogelijke duplicaat gedetecteerd');\n      score -= 50; // Penalty voor duplicaten\n    }\n    \n    // 2. Credit transacties (inkomsten) - match met lidgelden\n    if (transaction.side === 'CREDIT') {\n      const feeMatch = this.matchWithMembershipFee(transaction, context);\n      if (feeMatch) {\n        score += feeMatch.score;\n        matchedFeeId = feeMatch.feeId;\n        matchedMemberId = feeMatch.memberId;\n        reasons.push(...feeMatch.reasons);\n        categoryId = 'membership-fee'; // Default category voor lidgelden\n      }\n    }\n    \n    // 3. Debet transacties (uitgaven) - match met categorieën\n    if (transaction.side === 'DEBET') {\n      const expenseMatch = this.matchExpenseCategory(transaction, context);\n      if (expenseMatch) {\n        score += expenseMatch.score;\n        categoryId = expenseMatch.categoryId;\n        vendorId = expenseMatch.vendorId;\n        reasons.push(...expenseMatch.reasons);\n      }\n    }\n    \n    // 4. Match rules toepassen\n    const ruleMatch = this.applyMatchRules(transaction, context);\n    if (ruleMatch) {\n      score += ruleMatch.score;\n      if (ruleMatch.categoryId) categoryId = ruleMatch.categoryId;\n      if (ruleMatch.vendorId) vendorId = ruleMatch.vendorId;\n      if (ruleMatch.feeId) matchedFeeId = ruleMatch.feeId;\n      if (ruleMatch.memberId) matchedMemberId = ruleMatch.memberId;\n      reasons.push(...ruleMatch.reasons);\n    }\n    \n    // Bepaal status op basis van score\n    let status: 'VOORGESTELD' | 'GEDEELTELIJK_GEMATCHT' | 'ONTVANGEN';\n    if (score >= 70) {\n      status = 'VOORGESTELD';\n    } else if (score >= 40) {\n      status = 'GEDEELTELIJK_GEMATCHT';\n    } else {\n      status = 'ONTVANGEN';\n    }\n    \n    return {\n      transactionId: transaction.id,\n      matchedFeeId,\n      matchedMemberId,\n      categoryId,\n      vendorId,\n      matchScore: Math.max(0, Math.min(100, score)),\n      status,\n      reasons,\n    };\n  }\n  \n  /**\n   * Batch verwerking van meerdere transacties\n   */\n  suggestBatchMatches(\n    transactions: BankTransaction[],\n    context: MatchingContext\n  ): MatchResult[] {\n    return transactions.map(transaction => \n      this.suggestMatches(transaction, context)\n    );\n  }\n  \n  /**\n   * Duplicaat detectie\n   */\n  private isDuplicate(\n    transaction: BankTransaction, \n    existingTransactions: BankTransaction[]\n  ): boolean {\n    const tolerance = 1; // 1 dag tolerantie\n    \n    return existingTransactions.some(existing => {\n      if (existing.id === transaction.id) return false;\n      \n      // Zelfde bedrag\n      const sameAmount = Math.abs(\n        parseFloat(existing.amount) - parseFloat(transaction.amount)\n      ) < 0.01;\n      \n      // Zelfde datum (±1 dag)\n      const daysDiff = Math.abs(differenceInDays(\n        new Date(existing.bookingDate),\n        new Date(transaction.bookingDate)\n      ));\n      const sameDate = daysDiff <= tolerance;\n      \n      // Zelfde referentie (indien aanwezig)\n      const sameRef = existing.ref && transaction.ref && \n                     existing.ref === transaction.ref;\n      \n      return sameAmount && (sameDate || sameRef);\n    });\n  }\n  \n  /**\n   * Match met lidgelden (voor credit transacties)\n   */\n  private matchWithMembershipFee(\n    transaction: BankTransaction,\n    context: MatchingContext\n  ): { score: number; feeId: string; memberId: string; reasons: string[] } | null {\n    \n    let bestMatch: { fee: MembershipFee; score: number; reasons: string[] } | null = null;\n    \n    for (const fee of context.fees) {\n      if (fee.status === 'PAID') continue; // Skip reeds betaalde fees\n      \n      const score = this.calculateFeeMatchScore(transaction, fee, context);\n      if (score > 0 && (!bestMatch || score > bestMatch.score)) {\n        bestMatch = { fee, score, reasons: [] };\n      }\n    }\n    \n    if (!bestMatch) return null;\n    \n    return {\n      score: bestMatch.score,\n      feeId: bestMatch.fee.id,\n      memberId: bestMatch.fee.memberId,\n      reasons: [`Gematcht met lidgeld voor ${bestMatch.fee.memberName}`],\n    };\n  }\n  \n  /**\n   * Bereken match score voor een lidgeld\n   */\n  private calculateFeeMatchScore(\n    transaction: BankTransaction,\n    fee: MembershipFee,\n    context: MatchingContext\n  ): number {\n    let score = 0;\n    \n    // 1. Bedrag matching (±€0,50 tolerantie)\n    const transactionAmount = parseFloat(transaction.amount);\n    const feeAmount = parseFloat(fee.amount);\n    const amountDiff = Math.abs(transactionAmount - feeAmount);\n    \n    if (amountDiff <= 0.50) {\n      score += 40; // Exacte bedrag match\n    } else if (amountDiff <= 2.00) {\n      score += 20; // Ongeveer bedrag match\n    }\n    \n    // 2. Beschrijving bevat lidnummer of naam\n    const description = transaction.description?.toLowerCase() || '';\n    const ref = transaction.ref?.toLowerCase() || '';\n    const memberNumber = fee.memberNumber.toLowerCase();\n    const memberName = fee.memberName.toLowerCase();\n    \n    if (description.includes(memberNumber) || ref.includes(memberNumber)) {\n      score += 25;\n    }\n    \n    if (description.includes(memberName) || ref.includes(memberName)) {\n      score += 15;\n    }\n    \n    // 3. IBAN matching met lid\n    if (transaction.iban) {\n      const member = context.members.find(m => m.id === fee.memberId);\n      // Hier zou je member financial settings moeten checken voor IBAN\n      // Voor nu simpele check\n      score += 10;\n    }\n    \n    // 4. Periode hint in beschrijving\n    const currentYear = new Date().getFullYear();\n    const feeYear = new Date(fee.periodStart).getFullYear();\n    \n    if (description.includes(feeYear.toString()) || \n        ref.includes(feeYear.toString())) {\n      score += 10;\n    }\n    \n    return score;\n  }\n  \n  /**\n   * Match uitgaven met categorieën\n   */\n  private matchExpenseCategory(\n    transaction: BankTransaction,\n    context: MatchingContext\n  ): { score: number; categoryId?: string; vendorId?: string; reasons: string[] } | null {\n    \n    // Basis categorisatie op basis van beschrijving\n    const description = transaction.description?.toLowerCase() || '';\n    const counterparty = transaction.counterparty?.toLowerCase() || '';\n    \n    let score = 0;\n    let categoryId: string | undefined;\n    let reasons: string[] = [];\n    \n    // Eenvoudige keyword matching\n    if (description.includes('elektriciteit') || description.includes('stroom')) {\n      categoryId = 'utilities';\n      score += 30;\n      reasons.push('Geclassificeerd als nutsvoorziening');\n    } else if (description.includes('water') || description.includes('gas')) {\n      categoryId = 'utilities';\n      score += 30;\n      reasons.push('Geclassificeerd als nutsvoorziening');\n    } else if (description.includes('verzekering')) {\n      categoryId = 'insurance';\n      score += 30;\n      reasons.push('Geclassificeerd als verzekering');\n    } else if (description.includes('onderhoud') || description.includes('reparatie')) {\n      categoryId = 'maintenance';\n      score += 25;\n      reasons.push('Geclassificeerd als onderhoud');\n    }\n    \n    if (score > 0) {\n      return { score, categoryId, reasons };\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Pas match rules toe\n   */\n  private applyMatchRules(\n    transaction: BankTransaction,\n    context: MatchingContext\n  ): { \n    score: number; \n    categoryId?: string; \n    vendorId?: string; \n    feeId?: string; \n    memberId?: string; \n    reasons: string[] \n  } | null {\n    \n    // Sorteer rules op prioriteit\n    const sortedRules = context.rules\n      .filter(rule => rule.active)\n      .sort((a, b) => (b.priority || 100) - (a.priority || 100));\n    \n    for (const rule of sortedRules) {\n      if (this.ruleMatches(transaction, rule)) {\n        const action = rule.action as any;\n        return {\n          score: 15, // Match rule bonus\n          categoryId: action.categoryId,\n          vendorId: action.vendorId,\n          feeId: action.linkTo === 'FEE' ? action.targetId : undefined,\n          memberId: action.linkTo === 'MEMBER' ? action.targetId : undefined,\n          reasons: [`Match rule toegepast: ${rule.name}`],\n        };\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * Check of een regel matched met de transactie\n   */\n  private ruleMatches(transaction: BankTransaction, rule: MatchRule): boolean {\n    const criteria = rule.criteria as any;\n    \n    // Contains check\n    if (criteria.contains && Array.isArray(criteria.contains)) {\n      const description = transaction.description?.toLowerCase() || '';\n      const hasKeyword = criteria.contains.some((keyword: string) => \n        description.includes(keyword.toLowerCase())\n      );\n      if (!hasKeyword) return false;\n    }\n    \n    // IBAN check\n    if (criteria.iban && transaction.iban) {\n      if (!transaction.iban.includes(criteria.iban)) return false;\n    }\n    \n    // Amount tolerance check\n    if (criteria.amountToleranceCents && criteria.targetAmount) {\n      const transactionCents = Math.round(parseFloat(transaction.amount) * 100);\n      const targetCents = criteria.targetAmount;\n      const tolerance = criteria.amountToleranceCents;\n      \n      if (Math.abs(transactionCents - targetCents) > tolerance) return false;\n    }\n    \n    return true;\n  }\n  \n  /**\n   * Update transactie met match resultaat\n   */\n  async applyMatch(\n    transactionId: string,\n    matchResult: MatchResult\n  ): Promise<void> {\n    // Hier zou je de database update implementeren\n    // Voor nu alleen logging\n    console.log(`Applying match for transaction ${transactionId}:`, matchResult);\n  }\n}\n\n/**\n * Utility functies\n */\nexport function createMatchingEngine(): TransactionMatchingEngine {\n  return new TransactionMatchingEngine();\n}\n\nexport function formatMatchScore(score: number): string {\n  if (score >= 70) return 'Hoge match';\n  if (score >= 40) return 'Gemiddelde match';\n  return 'Lage match';\n}","size_bytes":11554},"lib/reconcile/import.ts":{"content":"import { z } from \"zod\";\nimport { CsvParser, bankConfigs, type CsvConfig } from \"./parsers/csv\";\nimport { Mt940Parser } from \"./parsers/mt940\";\nimport { CodaParser } from \"./parsers/coda\";\nimport type { BankStatement, BankTransaction, InsertBankStatement, InsertBankTransaction } from \"../../shared/schema\";\n\n// Import validatie schemas\nexport const importFileSchema = z.object({\n  filename: z.string(),\n  content: z.string(),\n  size: z.number().max(10 * 1024 * 1024), // Max 10MB\n  type: z.enum(['CSV', 'MT940', 'CODA']),\n});\n\nexport const importOptionsSchema = z.object({\n  sourceName: z.string().min(1, \"Bron naam is verplicht\"),\n  type: z.enum(['CSV', 'MT940', 'CODA']),\n  csvConfig: z.object({\n    delimiter: z.string().default(\",\"),\n    hasHeader: z.boolean().default(true),\n    skipLines: z.number().default(0),\n    columns: z.object({\n      date: z.number(),\n      amount: z.number(),\n      description: z.number(),\n      counterparty: z.number().optional(),\n      iban: z.number().optional(),\n      ref: z.number().optional(),\n    }),\n    bankPreset: z.enum(['KBC', 'ING', 'BNP_PARIBAS_FORTIS', 'CUSTOM']).optional(),\n  }).optional(),\n});\n\nexport type ImportFile = z.infer<typeof importFileSchema>;\nexport type ImportOptions = z.infer<typeof importOptionsSchema>;\n\n/**\n * Import service voor bankafschriften\n */\nexport class StatementImportService {\n  \n  /**\n   * Importeer bankafschrift en creëer statement + transacties\n   */\n  async importStatement(\n    file: ImportFile,\n    options: ImportOptions,\n    tenantId: string,\n    userId?: string\n  ): Promise<{ statement: BankStatement; transactions: BankTransaction[] }> {\n    \n    // Valideer input\n    const validatedFile = importFileSchema.parse(file);\n    const validatedOptions = importOptionsSchema.parse(options);\n    \n    // Parse transacties op basis van type\n    const parsedTransactions = await this.parseTransactions(\n      validatedFile.content, \n      validatedOptions\n    );\n    \n    if (parsedTransactions.length === 0) {\n      throw new Error('Geen geldige transacties gevonden in het bestand');\n    }\n    \n    // Creëer BankStatement record\n    const statementData: InsertBankStatement = {\n      tenantId,\n      type: validatedOptions.type,\n      sourceName: validatedOptions.sourceName,\n      importedById: userId,\n      numTx: parsedTransactions.length,\n      rawFileUrl: null, // TODO: Implementeer file storage\n    };\n    \n    // Hier zou je normaal de database service gebruiken\n    // Voor nu returnen we mock data - dit moet geïntegreerd worden met de database service\n    const statement: BankStatement = {\n      id: 'mock-statement-id',\n      ...statementData,\n      importedAt: new Date(),\n    };\n    \n    // Converteer parsed transacties naar BankTransaction records\n    const bankTransactions: BankTransaction[] = parsedTransactions.map((parsed, index) => ({\n      id: `mock-transaction-${index}`,\n      tenantId,\n      statementId: statement.id,\n      bookingDate: parsed.bookingDate,\n      valueDate: parsed.valueDate || null,\n      side: parsed.side as 'CREDIT' | 'DEBET',\n      amount: parsed.amount.toString(), // Decimal als string\n      currency: parsed.currency,\n      counterparty: parsed.counterparty || null,\n      iban: parsed.iban || null,\n      description: parsed.description || null,\n      ref: parsed.ref || null,\n      status: 'ONTVANGEN' as const,\n      categoryId: null,\n      vendorId: null,\n      matchedFeeId: null,\n      matchedMemberId: null,\n      matchScore: null,\n      notes: null,\n      createdAt: new Date(),\n    }));\n    \n    return {\n      statement,\n      transactions: bankTransactions,\n    };\n  }\n  \n  /**\n   * Parse transacties op basis van bestandstype\n   */\n  private async parseTransactions(content: string, options: ImportOptions) {\n    switch (options.type) {\n      case 'CSV':\n        return this.parseCsvTransactions(content, options.csvConfig);\n        \n      case 'MT940':\n        const mt940Parser = new Mt940Parser();\n        return mt940Parser.parse(content);\n        \n      case 'CODA':\n        const codaParser = new CodaParser();\n        return codaParser.parse(content);\n        \n      default:\n        throw new Error(`Onondersteund bestandstype: ${options.type}`);\n    }\n  }\n  \n  /**\n   * Parse CSV transacties met configuratie\n   */\n  private parseCsvTransactions(content: string, csvConfig?: ImportOptions['csvConfig']) {\n    let config: CsvConfig;\n    \n    if (csvConfig?.bankPreset && csvConfig.bankPreset !== 'CUSTOM') {\n      // Gebruik vooraf gedefinieerde bank configuratie\n      const bankConfig = bankConfigs[csvConfig.bankPreset];\n      config = {\n        ...bankConfig,\n        ...csvConfig, // Override met custom settings\n        dateFormat: csvConfig.dateFormat || bankConfig.dateFormat || \"dd/MM/yyyy\",\n        decimalSeparator: csvConfig.decimalSeparator || \",\",\n        thousandsSeparator: csvConfig.thousandsSeparator || \".\",\n      };\n    } else if (csvConfig) {\n      // Gebruik volledig custom configuratie\n      config = csvConfig as CsvConfig;\n    } else {\n      // Gebruik standaard configuratie\n      config = {\n        delimiter: \",\",\n        hasHeader: true,\n        skipLines: 0,\n        columns: {\n          date: 0,\n          amount: 1,\n          description: 2,\n          counterparty: 3,\n          iban: 4,\n          ref: 5,\n        },\n        dateFormat: \"dd/MM/yyyy\",\n        decimalSeparator: \",\",\n        thousandsSeparator: \".\",\n      };\n    }\n    \n    const parser = new CsvParser(config);\n    return parser.parse(content);\n  }\n  \n  /**\n   * Valideer bestand voordat import\n   */\n  validateFile(file: ImportFile): { valid: boolean; errors: string[] } {\n    const errors: string[] = [];\n    \n    try {\n      importFileSchema.parse(file);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        errors.push(...error.errors.map(e => e.message));\n      } else {\n        errors.push('Onbekende validatiefout');\n      }\n    }\n    \n    // Aanvullende validaties\n    if (file.content.trim().length === 0) {\n      errors.push('Bestand is leeg');\n    }\n    \n    if (file.type === 'CSV') {\n      const lines = file.content.split('\\n').filter(l => l.trim());\n      if (lines.length < 2) {\n        errors.push('CSV bestand moet minimaal 2 lijnen bevatten');\n      }\n    }\n    \n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n  \n  /**\n   * Detecteer automatisch bestandstype op basis van content\n   */\n  detectFileType(content: string): 'CSV' | 'MT940' | 'CODA' | 'UNKNOWN' {\n    const trimmed = content.trim();\n    \n    // CODA detectie - begint met '0' record\n    if (trimmed.match(/^0\\d{8}/)) {\n      return 'CODA';\n    }\n    \n    // MT940 detectie - bevat SWIFT tags\n    if (trimmed.includes(':20:') && trimmed.includes(':25:')) {\n      return 'MT940';\n    }\n    \n    // CSV detectie - bevat separators en geen SWIFT tags\n    if (trimmed.includes(',') || trimmed.includes(';')) {\n      return 'CSV';\n    }\n    \n    return 'UNKNOWN';\n  }\n  \n  /**\n   * Preview transacties zonder opslaan\n   */\n  async previewTransactions(\n    file: ImportFile, \n    options: ImportOptions\n  ): Promise<{ count: number; sample: any[]; errors: string[] }> {\n    const errors: string[] = [];\n    \n    try {\n      const parsedTransactions = await this.parseTransactions(file.content, options);\n      \n      return {\n        count: parsedTransactions.length,\n        sample: parsedTransactions.slice(0, 5), // Eerste 5 transacties als voorbeeld\n        errors,\n      };\n    } catch (error) {\n      errors.push(error instanceof Error ? error.message : 'Onbekende fout bij preview');\n      return {\n        count: 0,\n        sample: [],\n        errors,\n      };\n    }\n  }\n}","size_bytes":7662},"lib/reconcile/parsers/coda.ts":{"content":"import { z } from \"zod\";\nimport { utcToZonedTime, zonedTimeToUtc } from \"date-fns-tz\";\nimport type { ParsedTransaction } from \"./csv\";\nimport { parsedTransactionSchema } from \"./csv\";\n\n/**\n * CODA Parser voor Belgische banktransacties\n * \n * CODA (COmputerised Data) is een Belgisch standaard formaat\n * gebruikt door Belgische banken voor rekeningafschriften.\n */\nexport class CodaParser {\n  \n  /**\n   * Parse CODA content naar transacties\n   */\n  parse(codaContent: string): ParsedTransaction[] {\n    const transactions: ParsedTransaction[] = [];\n    const lines = codaContent.split('\\n').map(line => line.trim());\n    \n    let currentAccount: string | null = null;\n    let statementDate: Date | null = null;\n    \n    for (const line of lines) {\n      if (line.length === 0) continue;\n      \n      const recordType = line.substring(0, 1);\n      \n      switch (recordType) {\n        case '0': // Header record\n          // Extracteer statement informatie indien nodig\n          break;\n          \n        case '1': // Account identification record\n          currentAccount = this.parseAccountRecord(line);\n          statementDate = this.parseStatementDate(line);\n          break;\n          \n        case '2': // Transaction record\n          try {\n            const transaction = this.parseTransactionRecord(line, statementDate);\n            if (transaction) {\n              transactions.push(transaction);\n            }\n          } catch (error) {\n            console.warn('Fout bij verwerken CODA transactie:', error);\n          }\n          break;\n          \n        case '3': // Information record\n          // Aanvullende informatie voor vorige transactie\n          // Kan gebruikt worden voor uitgebreide beschrijvingen\n          break;\n          \n        case '4': // Communication record\n          // Communicatie records bevatten vrije tekst\n          break;\n          \n        case '8': // Trailer record - nieuwe saldo\n          break;\n          \n        case '9': // End record\n          break;\n          \n        default:\n          console.warn(`Onbekend CODA record type: ${recordType}`);\n      }\n    }\n    \n    return transactions;\n  }\n  \n  /**\n   * Parse account identification record (type 1)\n   */\n  private parseAccountRecord(line: string): string {\n    // CODA record type 1: account number en datum\n    // Positie 5-16: Account number (12 characters)\n    return line.substring(4, 16).trim();\n  }\n  \n  /**\n   * Parse statement date from account record\n   */\n  private parseStatementDate(line: string): Date {\n    // CODA record type 1: datum in positie 57-62 (DDMMYY)\n    try {\n      const dateStr = line.substring(57, 63); // DDMMYY\n      const day = parseInt(dateStr.substring(0, 2), 10);\n      const month = parseInt(dateStr.substring(2, 4), 10);\n      const year = 2000 + parseInt(dateStr.substring(4, 6), 10);\n      \n      return zonedTimeToUtc(new Date(year, month - 1, day), 'Europe/Brussels');\n    } catch (error) {\n      console.warn('Fout bij parsen CODA datum:', error);\n      return new Date();\n    }\n  }\n  \n  /**\n   * Parse transaction record (type 2)\n   */\n  private parseTransactionRecord(line: string, statementDate: Date | null): ParsedTransaction | null {\n    try {\n      // CODA record type 2 structure:\n      // Pos 1: Record type (2)\n      // Pos 2-7: Reference number\n      // Pos 8-13: Bank reference\n      // Pos 14-19: Transaction date (DDMMYY)\n      // Pos 20-23: Reference\n      // Pos 24: Credit/Debit mark (0=debit, 1=credit)\n      // Pos 25-39: Amount (15 digits, last 3 are decimals)\n      // Pos 40-42: Currency code\n      // Pos 43-46: Transaction family\n      // Pos 47-50: Operation code\n      // Pos 51-113: Communication\n      \n      if (line.length < 128) {\n        throw new Error(`CODA lijn te kort: ${line.length} karakters`);\n      }\n      \n      // Datum extractie\n      const dateStr = line.substring(13, 19); // DDMMYY\n      const day = parseInt(dateStr.substring(0, 2), 10);\n      const month = parseInt(dateStr.substring(2, 4), 10);\n      const year = 2000 + parseInt(dateStr.substring(4, 6), 10);\n      const bookingDate = zonedTimeToUtc(new Date(year, month - 1, day), 'Europe/Brussels');\n      \n      // Credit/Debit indicator\n      const cdIndicator = line.substring(23, 24);\n      const side = cdIndicator === '1' ? 'CREDIT' : 'DEBET';\n      \n      // Bedrag (positie 24-39, laatste 3 cijfers zijn decimalen)\n      const amountStr = line.substring(24, 39);\n      const amountCents = parseInt(amountStr, 10);\n      \n      // Currency\n      const currency = line.substring(39, 42).trim() || 'EUR';\n      \n      // Communicatie/beschrijving\n      const communication = line.substring(62, 113).trim();\n      \n      // Bank referentie\n      const bankRef = line.substring(7, 13).trim();\n      \n      return parsedTransactionSchema.parse({\n        bookingDate,\n        amount: amountCents,\n        currency,\n        side: side as 'CREDIT' | 'DEBET',\n        description: communication || undefined,\n        ref: bankRef || undefined,\n        // CODA bevat meestal geen IBAN info in transaction records\n        counterparty: this.extractCounterpartyFromCommunication(communication),\n      });\n    } catch (error) {\n      console.warn(`Fout bij parsen CODA transactie record: ${line}`, error);\n      return null;\n    }\n  }\n  \n  /**\n   * Extract counterparty information from communication field\n   */\n  private extractCounterpartyFromCommunication(communication: string): string | undefined {\n    if (!communication || communication.trim().length === 0) {\n      return undefined;\n    }\n    \n    // Basis extractie - CODA communication velden kunnen gestructureerd zijn\n    // maar dit hangt af van de bank en type transactie\n    const trimmed = communication.trim();\n    \n    // Verwijder veelvoorkomende prefixes\n    const cleaned = trimmed\n      .replace(/^(OVERSCHRIJVING|STORTING|DOMICILIERING|KAART)/i, '')\n      .trim();\n    \n    return cleaned.length > 0 ? cleaned : undefined;\n  }\n}\n\n/**\n * Utility functie voor CODA parsing\n */\nexport function parseCoda(content: string): ParsedTransaction[] {\n  const parser = new CodaParser();\n  return parser.parse(content);\n}","size_bytes":6133},"lib/reconcile/parsers/csv.ts":{"content":"import { z } from \"zod\";\nimport { parseISO, format } from \"date-fns\";\nimport { utcToZonedTime, zonedTimeToUtc } from \"date-fns-tz\";\n\n// CSV parser configuratie schema\nexport const csvConfigSchema = z.object({\n  delimiter: z.string().default(\",\"),\n  hasHeader: z.boolean().default(true),\n  skipLines: z.number().default(0),\n  columns: z.object({\n    date: z.string().or(z.number()),\n    amount: z.string().or(z.number()),\n    description: z.string().or(z.number()),\n    counterparty: z.string().or(z.number()).optional(),\n    iban: z.string().or(z.number()).optional(),\n    ref: z.string().or(z.number()).optional(),\n  }),\n  dateFormat: z.string().default(\"dd/MM/yyyy\"), // Belgisch formaat\n  decimalSeparator: z.string().default(\",\"),\n  thousandsSeparator: z.string().default(\".\"),\n});\n\nexport type CsvConfig = z.infer<typeof csvConfigSchema>;\n\n// Parsed transactie schema\nexport const parsedTransactionSchema = z.object({\n  bookingDate: z.date(),\n  valueDate: z.date().optional(),\n  amount: z.number(), // in centen\n  currency: z.string().default(\"EUR\"),\n  counterparty: z.string().optional(),\n  iban: z.string().optional(),\n  description: z.string().optional(),\n  ref: z.string().optional(),\n  side: z.enum([\"CREDIT\", \"DEBET\"]),\n});\n\nexport type ParsedTransaction = z.infer<typeof parsedTransactionSchema>;\n\n/**\n * Parseert een CSV bestand naar BankTransaction objecten\n */\nexport class CsvParser {\n  private config: CsvConfig;\n\n  constructor(config: Partial<CsvConfig> = {}) {\n    this.config = csvConfigSchema.parse(config);\n  }\n\n  /**\n   * Parse CSV content naar transacties\n   */\n  parse(csvContent: string): ParsedTransaction[] {\n    const lines = csvContent.split('\\n').filter(line => line.trim());\n    \n    // Skip lijnen overslaan\n    const dataLines = lines.slice(this.config.skipLines);\n    \n    // Header overslaan indien aanwezig\n    const transactionLines = this.config.hasHeader \n      ? dataLines.slice(1) \n      : dataLines;\n\n    return transactionLines\n      .map((line, index) => {\n        try {\n          return this.parseLine(line);\n        } catch (error) {\n          console.warn(`Fout bij verwerken lijn ${index + 1}:`, error);\n          return null;\n        }\n      })\n      .filter((tx): tx is ParsedTransaction => tx !== null);\n  }\n\n  /**\n   * Parse een enkele CSV lijn\n   */\n  private parseLine(line: string): ParsedTransaction {\n    const fields = this.splitCsvLine(line);\n    \n    const dateStr = this.getField(fields, this.config.columns.date);\n    const amountStr = this.getField(fields, this.config.columns.amount);\n    const description = this.getField(fields, this.config.columns.description);\n    const counterparty = this.config.columns.counterparty ? this.getField(fields, this.config.columns.counterparty) : undefined;\n    const iban = this.config.columns.iban ? this.getField(fields, this.config.columns.iban) : undefined;\n    const ref = this.config.columns.ref ? this.getField(fields, this.config.columns.ref) : undefined;\n\n    // Datum parsing (Europe/Brussels tijdzone)\n    const bookingDate = this.parseDate(dateStr);\n    \n    // Bedrag parsing naar centen\n    const amount = this.parseAmount(amountStr);\n    \n    // Bepaal of het een credit of debet is\n    const side = amount >= 0 ? \"CREDIT\" : \"DEBET\";\n\n    return parsedTransactionSchema.parse({\n      bookingDate,\n      amount: Math.abs(amount), // Altijd positief opslaan, side bepaalt richting\n      currency: \"EUR\",\n      counterparty: counterparty?.trim() || undefined,\n      iban: iban?.trim() || undefined,\n      description: description?.trim() || undefined,\n      ref: ref?.trim() || undefined,\n      side,\n    });\n  }\n\n  /**\n   * Split CSV lijn met respect voor quotes\n   */\n  private splitCsvLine(line: string): string[] {\n    const fields: string[] = [];\n    let current = '';\n    let inQuotes = false;\n    \n    for (let i = 0; i < line.length; i++) {\n      const char = line[i];\n      \n      if (char === '\"') {\n        inQuotes = !inQuotes;\n      } else if (char === this.config.delimiter && !inQuotes) {\n        fields.push(current);\n        current = '';\n      } else {\n        current += char;\n      }\n    }\n    \n    fields.push(current);\n    return fields.map(f => f.replace(/^\"|\"$/g, '')); // Remove surrounding quotes\n  }\n\n  /**\n   * Haal veld op basis van kolom index of naam\n   */\n  private getField(fields: string[], column: string | number): string {\n    if (typeof column === 'number') {\n      return fields[column] || '';\n    }\n    // Als het een string is, assumeren we dat het een header naam is\n    // Dit zou uitgebreid kunnen worden met header mapping\n    throw new Error(`Column mapping by name not implemented: ${column}`);\n  }\n\n  /**\n   * Parse datum string naar Date object (Europe/Brussels tijdzone)\n   */\n  private parseDate(dateStr: string): Date {\n    try {\n      // Vervang Belgische datum separators\n      const normalized = dateStr\n        .replace(/[\\/\\-\\.]/g, '/') // Normaliseer separators\n        .trim();\n\n      // Parse verschillende formaten\n      if (normalized.match(/^\\d{1,2}\\/\\d{1,2}\\/\\d{4}$/)) {\n        // dd/MM/yyyy\n        const [day, month, year] = normalized.split('/');\n        const isoDate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;\n        return zonedTimeToUtc(parseISO(isoDate), 'Europe/Brussels');\n      }\n      \n      if (normalized.match(/^\\d{4}\\/\\d{1,2}\\/\\d{1,2}$/)) {\n        // yyyy/MM/dd\n        return zonedTimeToUtc(parseISO(normalized.replace(/\\//g, '-')), 'Europe/Brussels');\n      }\n\n      throw new Error(`Onbekend datum formaat: ${dateStr}`);\n    } catch (error) {\n      throw new Error(`Fout bij parsen datum '${dateStr}': ${error}`);\n    }\n  }\n\n  /**\n   * Parse bedrag string naar centen (integer)\n   */\n  private parseAmount(amountStr: string): number {\n    try {\n      let normalized = amountStr.trim();\n      \n      // Verwijder currency symbolen\n      normalized = normalized.replace(/[€$£]/g, '');\n      \n      // Belgische notatie: duizendtal separator is punt, decimaal is komma\n      // Voorbeeld: \"1.234,56\" -> 123456 centen\n      if (this.config.decimalSeparator === ',' && this.config.thousandsSeparator === '.') {\n        // Splits op komma voor decimalen\n        const parts = normalized.split(',');\n        \n        if (parts.length === 1) {\n          // Geen decimalen, verwijder duizendtal separators\n          const euros = parseInt(parts[0].replace(/\\./g, ''), 10);\n          return euros * 100;\n        } else if (parts.length === 2) {\n          // Decimalen aanwezig\n          const euros = parseInt(parts[0].replace(/\\./g, ''), 10);\n          const cents = parseInt(parts[1].padEnd(2, '0').slice(0, 2), 10);\n          return euros * 100 + cents;\n        }\n      }\n      \n      // Fallback: standaard JavaScript parsing\n      const amount = parseFloat(normalized.replace(/[^\\d\\.\\-]/g, ''));\n      return Math.round(amount * 100);\n    } catch (error) {\n      throw new Error(`Fout bij parsen bedrag '${amountStr}': ${error}`);\n    }\n  }\n}\n\n/**\n * Standaard configuraties voor veelgebruikte banken\n */\nexport const bankConfigs = {\n  KBC: {\n    delimiter: \";\",\n    hasHeader: true,\n    columns: {\n      date: 2,        // Datum\n      amount: 7,      // Bedrag\n      description: 8, // Mededeling\n      counterparty: 4, // Tegenpartij\n      iban: 5,        // Rekening tegenpartij\n      ref: 9,         // Referentie\n    },\n    dateFormat: \"dd/MM/yyyy\",\n  },\n  \n  ING: {\n    delimiter: \",\",\n    hasHeader: true,\n    columns: {\n      date: 0,\n      amount: 6,\n      description: 8,\n      counterparty: 2,\n      iban: 3,\n      ref: 7,\n    },\n  },\n  \n  BNP_PARIBAS_FORTIS: {\n    delimiter: \";\",\n    hasHeader: true,\n    columns: {\n      date: 1,\n      amount: 3,\n      description: 4,\n      counterparty: 5,\n      ref: 6,\n    },\n  },\n} as const;","size_bytes":7761},"lib/reconcile/parsers/mt940.ts":{"content":"import { z } from \"zod\";\nimport { parseISO } from \"date-fns\";\nimport { utcToZonedTime, zonedTimeToUtc } from \"date-fns-tz\";\nimport type { ParsedTransaction } from \"./csv\";\nimport { parsedTransactionSchema } from \"./csv\";\n\n/**\n * MT940 Parser voor SWIFT banktransacties\n * \n * MT940 is een SWIFT standard formaat gebruikt door vele banken\n * voor het versturen van rekeningafschriften.\n */\nexport class Mt940Parser {\n  \n  /**\n   * Parse MT940 content naar transacties\n   */\n  parse(mt940Content: string): ParsedTransaction[] {\n    const transactions: ParsedTransaction[] = [];\n    const lines = mt940Content.split('\\n').map(line => line.trim());\n    \n    let currentTransaction: Partial<ParsedTransaction> = {};\n    let statementDate: Date | null = null;\n    \n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n      \n      if (line.startsWith(':20:')) {\n        // Transaction Reference Number\n        continue;\n      }\n      \n      if (line.startsWith(':25:')) {\n        // Account Identification\n        continue;\n      }\n      \n      if (line.startsWith(':28C:')) {\n        // Statement Number/Sequence Number\n        continue;\n      }\n      \n      if (line.startsWith(':60F:') || line.startsWith(':60M:')) {\n        // Opening Balance\n        statementDate = this.parseStatementDate(line);\n        continue;\n      }\n      \n      if (line.startsWith(':61:')) {\n        // Statement Line\n        if (Object.keys(currentTransaction).length > 0) {\n          try {\n            const parsed = this.finalizeTransaction(currentTransaction, statementDate);\n            if (parsed) {\n              transactions.push(parsed);\n            }\n          } catch (error) {\n            console.warn('Fout bij verwerken MT940 transactie:', error);\n          }\n        }\n        \n        currentTransaction = this.parseStatementLine(line, statementDate);\n      }\n      \n      if (line.startsWith(':86:')) {\n        // Information to Account Owner\n        const description = line.substring(4);\n        currentTransaction.description = description;\n        currentTransaction.ref = this.extractReference(description);\n        currentTransaction.counterparty = this.extractCounterparty(description);\n      }\n      \n      if (line.startsWith(':62F:') || line.startsWith(':62M:')) {\n        // Closing Balance\n        if (Object.keys(currentTransaction).length > 0) {\n          try {\n            const parsed = this.finalizeTransaction(currentTransaction, statementDate);\n            if (parsed) {\n              transactions.push(parsed);\n            }\n          } catch (error) {\n            console.warn('Fout bij verwerken laatste MT940 transactie:', error);\n          }\n        }\n        break;\n      }\n    }\n    \n    return transactions;\n  }\n  \n  /**\n   * Parse statement datum uit opening balance lijn\n   */\n  private parseStatementDate(line: string): Date {\n    // :60F:C211031EUR1234567,89\n    // Format: C/D YYMMDD CUR Amount\n    const match = line.match(/:60[FM]:([CD])(\\d{6})/);\n    if (!match) {\n      throw new Error(`Ongeldig opening balance formaat: ${line}`);\n    }\n    \n    const dateStr = match[2]; // YYMMDD\n    const year = 2000 + parseInt(dateStr.substring(0, 2), 10);\n    const month = parseInt(dateStr.substring(2, 4), 10);\n    const day = parseInt(dateStr.substring(4, 6), 10);\n    \n    return zonedTimeToUtc(new Date(year, month - 1, day), 'Europe/Brussels');\n  }\n  \n  /**\n   * Parse statement lijn (:61:)\n   */\n  private parseStatementLine(line: string, statementDate: Date | null): Partial<ParsedTransaction> {\n    // :61:2110311031DR1234,56NTRFNONREF//ENDTOENDREF\n    // Format: YYMMDD MMDD C/D Amount Transaction Type Customer Reference Bank Reference\n    \n    try {\n      // Basis parsing - dit is een vereenvoudigde implementatie\n      const content = line.substring(4); // Remove ':61:'\n      \n      // Datum extractie (eerste 6 chars)\n      const dateStr = content.substring(0, 6);\n      const year = 2000 + parseInt(dateStr.substring(0, 2), 10);\n      const month = parseInt(dateStr.substring(2, 4), 10);\n      const day = parseInt(dateStr.substring(4, 6), 10);\n      const bookingDate = zonedTimeToUtc(new Date(year, month - 1, day), 'Europe/Brussels');\n      \n      // Credit/Debit indicator en bedrag\n      const cdMatch = content.match(/([CD])([0-9,]+)/);\n      if (!cdMatch) {\n        throw new Error(`Kan C/D en bedrag niet vinden in: ${line}`);\n      }\n      \n      const side = cdMatch[1] === 'C' ? 'CREDIT' : 'DEBET';\n      const amountStr = cdMatch[2];\n      const amount = this.parseAmount(amountStr);\n      \n      return {\n        bookingDate,\n        amount,\n        currency: 'EUR',\n        side: side as 'CREDIT' | 'DEBET',\n      };\n    } catch (error) {\n      console.warn(`Fout bij parsen statement lijn: ${line}`, error);\n      return {};\n    }\n  }\n  \n  /**\n   * Finaliseer transactie object\n   */\n  private finalizeTransaction(\n    transaction: Partial<ParsedTransaction>, \n    fallbackDate: Date | null\n  ): ParsedTransaction | null {\n    try {\n      return parsedTransactionSchema.parse({\n        bookingDate: transaction.bookingDate || fallbackDate || new Date(),\n        valueDate: transaction.valueDate,\n        amount: transaction.amount || 0,\n        currency: transaction.currency || 'EUR',\n        counterparty: transaction.counterparty,\n        iban: transaction.iban,\n        description: transaction.description,\n        ref: transaction.ref,\n        side: transaction.side || 'CREDIT',\n      });\n    } catch (error) {\n      console.warn('Fout bij finaliseren transactie:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * Extract reference from description\n   */\n  private extractReference(description: string): string | undefined {\n    // Zoek naar patronen zoals \"REF:\" of \"REFERENCE:\"\n    const refMatch = description.match(/(?:REF|REFERENCE|MEDEDELING)[:]\\s*([^\\s]+)/i);\n    return refMatch?.[1];\n  }\n  \n  /**\n   * Extract counterparty from description\n   */\n  private extractCounterparty(description: string): string | undefined {\n    // Basis extractie - kan verbeterd worden per bank\n    const lines = description.split(/[\\/\\\\]/);\n    for (const line of lines) {\n      if (line.trim() && !line.match(/^\\d+$/) && !line.match(/^[A-Z]{2}\\d+/)) {\n        return line.trim();\n      }\n    }\n    return undefined;\n  }\n  \n  /**\n   * Parse bedrag string naar centen\n   */\n  private parseAmount(amountStr: string): number {\n    try {\n      // MT940 gebruikt komma als decimaal separator\n      const normalized = amountStr.replace(',', '.');\n      const euros = parseFloat(normalized);\n      return Math.round(euros * 100);\n    } catch (error) {\n      throw new Error(`Fout bij parsen bedrag '${amountStr}': ${error}`);\n    }\n  }\n}\n\n/**\n * Utility functie voor MT940 parsing\n */\nexport function parseMt940(content: string): ParsedTransaction[] {\n  const parser = new Mt940Parser();\n  return parser.parse(content);\n}","size_bytes":6883},"client/src/components/forms/rule-override-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { AlertTriangle, CheckCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useVotingRightsOverride } from \"@/hooks/useRuleValidation\";\n\ninterface RuleOverrideDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  memberId: string;\n  memberName: string;\n  currentStatus: boolean;\n  warnings: string[];\n  ruleScope: 'STEMRECHT' | 'VERKIESBAAR';\n  onSuccess?: () => void;\n}\n\nexport function RuleOverrideDialog({\n  open,\n  onOpenChange,\n  memberId,\n  memberName,\n  currentStatus,\n  warnings,\n  ruleScope,\n  onSuccess\n}: RuleOverrideDialogProps) {\n  const [overrideValue, setOverrideValue] = useState<string>(currentStatus ? 'true' : 'false');\n  const [reason, setReason] = useState('');\n  const { toast } = useToast();\n  \n  const overrideMutation = useVotingRightsOverride();\n\n  const scopeLabels = {\n    'STEMRECHT': 'stemrecht',\n    'VERKIESBAAR': 'verkiesbaarheid'\n  };\n\n  const handleSubmit = async () => {\n    if (!reason.trim()) {\n      toast({\n        title: \"Reden vereist\",\n        description: \"Geef een reden op voor deze handmatige toekenning.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      await overrideMutation.mutateAsync({\n        memberId,\n        overrideValue: overrideValue === 'true',\n        reason: reason.trim()\n      });\n\n      toast({\n        title: \"Override toegepast\",\n        description: `${scopeLabels[ruleScope]} voor ${memberName} is handmatig ${overrideValue === 'true' ? 'toegekend' : 'ingetrokken'}.`,\n      });\n\n      onSuccess?.();\n      onOpenChange(false);\n      setReason('');\n    } catch (error) {\n      toast({\n        title: \"Fout\",\n        description: \"Er is een fout opgetreden bij het toepassen van de override.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <AlertTriangle className=\"h-5 w-5 text-amber-500\" />\n            Handmatige toekenning {scopeLabels[ruleScope]}\n          </DialogTitle>\n          <DialogDescription>\n            Handmatig toekennen van {scopeLabels[ruleScope]} voor <strong>{memberName}</strong>\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4\">\n          {/* Waarschuwingen tonen */}\n          {warnings.length > 0 && (\n            <div className=\"bg-amber-50 border border-amber-200 rounded-md p-3\">\n              <h4 className=\"text-sm font-medium text-amber-800 mb-2\">\n                Regelovertredingen gedetecteerd:\n              </h4>\n              <ul className=\"text-sm text-amber-700 space-y-1\">\n                {warnings.map((warning, index) => (\n                  <li key={index}>• {warning}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          {/* Override keuze */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-sm font-medium\">\n              {scopeLabels[ruleScope]} toekennen aan {memberName}?\n            </Label>\n            \n            <RadioGroup value={overrideValue} onValueChange={setOverrideValue}>\n              <div className=\"flex items-center space-x-2\">\n                <RadioGroupItem value=\"true\" id=\"grant\" />\n                <Label htmlFor=\"grant\" className=\"flex items-center gap-2 text-sm\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  Ja, {scopeLabels[ruleScope]} handmatig toekennen\n                </Label>\n              </div>\n              <div className=\"flex items-center space-x-2\">\n                <RadioGroupItem value=\"false\" id=\"deny\" />\n                <Label htmlFor=\"deny\" className=\"flex items-center gap-2 text-sm\">\n                  <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n                  Nee, {scopeLabels[ruleScope]} intrekken\n                </Label>\n              </div>\n            </RadioGroup>\n          </div>\n\n          {/* Reden */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"reason\" className=\"text-sm font-medium\">\n              Reden voor handmatige toekenning *\n            </Label>\n            <Textarea\n              id=\"reason\"\n              placeholder={`Leg uit waarom je ${scopeLabels[ruleScope]} handmatig ${overrideValue === 'true' ? 'toekent' : 'intrekt'}...`}\n              value={reason}\n              onChange={(e) => setReason(e.target.value)}\n              rows={3}\n              className=\"resize-none\"\n            />\n            <p className=\"text-xs text-muted-foreground\">\n              Deze reden wordt vastgelegd voor controle en auditdoeleinden.\n            </p>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex justify-end gap-2 pt-4\">\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                onOpenChange(false);\n                setReason('');\n              }}\n            >\n              Annuleren\n            </Button>\n            <Button\n              onClick={handleSubmit}\n              disabled={!reason.trim() || overrideMutation.isPending}\n              className={overrideValue === 'true' ? 'bg-green-600 hover:bg-green-700' : 'bg-red-600 hover:bg-red-700'}\n            >\n              {overrideMutation.isPending ? 'Bezig...' : \n               overrideValue === 'true' ? 'Toekennen' : 'Intrekken'}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":5893},"client/src/components/members/voting-status.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Check, X } from \"lucide-react\";\nimport { Member } from \"@shared/schema\";\n\ninterface VotingStatusProps {\n  member: Member;\n  compact?: boolean;\n}\n\nexport function VotingStatus({ member, compact = false }: VotingStatusProps) {\n  // Check if member has voting rights enabled in their settings\n  const hasVotingRights = member.votingRights;\n  \n  if (compact) {\n    // Compact view for mobile - just show icon and status\n    if (!hasVotingRights) {\n      return (\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          <X className=\"h-3 w-3 mr-1\" />\n          Geen\n        </Badge>\n      );\n    }\n    \n    return (\n      <Badge variant=\"default\" className=\"bg-green-100 text-green-800 text-xs\">\n        <Check className=\"h-3 w-3 mr-1\" />\n        Ja\n      </Badge>\n    );\n  }\n  \n  // Full view for desktop\n  if (!hasVotingRights) {\n    return (\n      <div className=\"flex items-center gap-2\">\n        <Badge variant=\"secondary\">\n          <X className=\"h-3 w-3 mr-1\" />\n          Geen stemrecht\n        </Badge>\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"flex items-center gap-2\">\n      <Badge variant=\"default\" className=\"bg-green-100 text-green-800\">\n        <Check className=\"h-4 w-4 mr-1\" />\n        Stemgerechtigd\n      </Badge>\n    </div>\n  );\n}","size_bytes":1327},"client/src/components/ui/rule-warning.tsx":{"content":"import { AlertTriangle, Info, CheckCircle } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\ninterface RuleWarningProps {\n  type: 'warning' | 'error' | 'info' | 'success';\n  title: string;\n  warnings: string[];\n  reasons?: string[];\n  showOverride?: boolean;\n  onOverride?: () => void;\n  overrideLabel?: string;\n  className?: string;\n}\n\nexport function RuleWarning({\n  type = 'warning',\n  title,\n  warnings,\n  reasons = [],\n  showOverride = false,\n  onOverride,\n  overrideLabel = 'Handmatig toekennen',\n  className\n}: RuleWarningProps) {\n  const getIcon = () => {\n    switch (type) {\n      case 'error':\n        return <AlertTriangle className=\"h-4 w-4\" />;\n      case 'warning':\n        return <AlertTriangle className=\"h-4 w-4\" />;\n      case 'info':\n        return <Info className=\"h-4 w-4\" />;\n      case 'success':\n        return <CheckCircle className=\"h-4 w-4\" />;\n      default:\n        return <Info className=\"h-4 w-4\" />;\n    }\n  };\n\n  const getVariant = () => {\n    switch (type) {\n      case 'error':\n      case 'warning':\n        return 'destructive';\n      case 'success':\n        return 'default';\n      case 'info':\n      default:\n        return 'default';\n    }\n  };\n\n  return (\n    <Alert variant={getVariant()} className={cn(\"border-l-4\", className)}>\n      <div className=\"flex items-start gap-3\">\n        {getIcon()}\n        <div className=\"flex-1 space-y-2\">\n          <h4 className=\"font-medium\">{title}</h4>\n          \n          {warnings.length > 0 && (\n            <div className=\"space-y-1\">\n              {warnings.map((warning, index) => (\n                <AlertDescription key={index} className=\"text-sm\">\n                  {warning}\n                </AlertDescription>\n              ))}\n            </div>\n          )}\n\n          {reasons.length > 0 && (\n            <div className=\"mt-3 space-y-1\">\n              <p className=\"text-xs font-medium text-muted-foreground\">Reden:</p>\n              {reasons.map((reason, index) => (\n                <p key={index} className=\"text-xs text-muted-foreground\">\n                  • {reason}\n                </p>\n              ))}\n            </div>\n          )}\n\n          {showOverride && onOverride && (\n            <div className=\"mt-3\">\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={onOverride}\n                className=\"text-xs\"\n              >\n                {overrideLabel}\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </Alert>\n  );\n}","size_bytes":2646},"client/src/hooks/useRuleValidation.ts":{"content":"import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { apiRequest } from '@/lib/queryClient';\n\nexport interface VotingRightsStatus {\n  eligible: boolean;\n  hasOverride: boolean;\n  reason: string;\n  warnings: string[];\n}\n\nexport interface RuleOverride {\n  id: string;\n  memberId: string;\n  ruleScope: 'STEMRECHT' | 'VERKIESBAAR';\n  overrideValue: boolean;\n  reason: string;\n  overriddenBy: string;\n  overriddenAt: string;\n  active: boolean;\n}\n\nexport const useVotingRights = (memberId: string) => {\n  return useQuery<VotingRightsStatus>({\n    queryKey: [`/api/members/${memberId}/voting-rights`],\n    enabled: !!memberId,\n  });\n};\n\nexport const useVotingRightsOverride = () => {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ \n      memberId, \n      overrideValue, \n      reason \n    }: { \n      memberId: string; \n      overrideValue: boolean; \n      reason: string; \n    }) => {\n      const response = await apiRequest('POST', `/api/members/${memberId}/voting-rights/override`, {\n        overrideValue,\n        reason\n      });\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      // Invalidate voting rights query for this member\n      queryClient.invalidateQueries({ \n        queryKey: [`/api/members/${variables.memberId}/voting-rights`] \n      });\n      \n      // Also invalidate member list to refresh any voting rights indicators\n      queryClient.invalidateQueries({ \n        queryKey: ['/api/members'] \n      });\n    },\n  });\n};\n\n// Hook for getting organizational rules from the database\nexport const useOrganizationRules = () => {\n  return useQuery({\n    queryKey: ['/api/rules'],\n  });\n};\n\nexport const useRuleValidation = () => {\n  const { data: rules = [] } = useOrganizationRules();\n  \n  const validateVotingRights = (member: any): { \n    isValid: boolean; \n    warnings: string[]; \n    reasons: string[] \n  } => {\n    const warnings: string[] = [];\n    const reasons: string[] = [];\n    let isValid = true;\n\n    // Get voting rules from the database\n    const votingRules = rules.filter((rule: any) => \n      rule.scope === 'STEMRECHT' && rule.active\n    );\n\n    // If no custom rules exist, apply default validation\n    if (votingRules.length === 0) {\n      // Age validation for voting rights\n      if (member.birthDate) {\n        const birthDate = new Date(member.birthDate);\n        const today = new Date();\n        let age = today.getFullYear() - birthDate.getFullYear();\n        const monthDiff = today.getMonth() - birthDate.getMonth();\n        \n        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n          age--;\n        }\n\n        if (age < 18) {\n          isValid = false;\n          warnings.push('⚠️ Lid is jonger dan 18 jaar');\n          reasons.push('Minimumleeftijd voor stemrecht is 18 jaar');\n        }\n      }\n\n      // Category validation\n      if (member.category === 'STUDENT') {\n        isValid = false;\n        warnings.push(`⚠️ Categorie '${member.category}' heeft normaliter geen stemrecht`);\n        reasons.push('Studenten hebben volgens standaard regels geen stemrecht');\n      }\n\n      // Active membership check\n      if (!member.active) {\n        isValid = false;\n        warnings.push('⚠️ Lid is niet actief');\n        reasons.push('Alleen actieve leden hebben stemrecht');\n      }\n    } else {\n      // Apply custom rules from the database\n      for (const rule of votingRules) {\n        const params = rule.parameters || {};\n        \n        // Check minimum years (if rule exists)\n        if (params.minYears) {\n          const membershipYears = member.createdAt ? \n            (Date.now() - new Date(member.createdAt).getTime()) / (1000 * 60 * 60 * 24 * 365) \n            : 0;\n          \n          if (membershipYears < params.minYears) {\n            isValid = false;\n            warnings.push(`⚠️ ${rule.name || 'Regel overtreden'}`);\n            reasons.push(`Minimaal ${params.minYears} jaar lidmaatschap vereist`);\n          }\n        }\n        \n        // Check minimum age\n        if (params.minAge && member.birthDate) {\n          const birthDate = new Date(member.birthDate);\n          const today = new Date();\n          let age = today.getFullYear() - birthDate.getFullYear();\n          const monthDiff = today.getMonth() - birthDate.getMonth();\n          \n          if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\n            age--;\n          }\n\n          if (age < params.minAge) {\n            isValid = false;\n            warnings.push(`⚠️ ${rule.name || 'Regel overtreden'}`);\n            reasons.push(`Minimumleeftijd ${params.minAge} jaar vereist`);\n          }\n        }\n        \n        // Check categories (if restricted)\n        if (params.categories && params.categories.length > 0) {\n          if (!params.categories.includes(member.category)) {\n            isValid = false;\n            warnings.push(`⚠️ ${rule.name || 'Regel overtreden'}`);\n            reasons.push(`Categorie '${member.category}' komt niet voor in toegestane categorieën`);\n          }\n        }\n      }\n      \n      // Always check if member is active\n      if (!member.active) {\n        isValid = false;\n        warnings.push('⚠️ Lid is niet actief');\n        reasons.push('Alleen actieve leden hebben stemrecht');\n      }\n    }\n\n    return { isValid, warnings, reasons };\n  };\n\n  return {\n    validateVotingRights\n  };\n};","size_bytes":5475},"server/services/ruleService.ts":{"content":"import { db } from '../db';\nimport { members, rules, ruleOutcomes, ruleOverrides } from '@shared/schema';\nimport { eq, and } from 'drizzle-orm';\nimport type { Member, Rule, RuleOverride } from '@shared/schema';\n\nexport interface RuleValidationResult {\n  eligible: boolean;\n  hasOverride: boolean;\n  override?: RuleOverride;\n  violatedRules?: Rule[];\n  warnings?: string[];\n}\n\nexport interface VotingRightsConfig {\n  minAge?: number;\n  maxAge?: number;\n  allowedCategories?: string[];\n  excludedCategories?: string[];\n  requireActiveMembership?: boolean;\n  requirePaidFees?: boolean;\n}\n\nexport interface CandidacyConfig {\n  minAge?: number;\n  maxAge?: number;\n  allowedCategories?: string[];\n  excludedCategories?: string[];\n  minMembershipDuration?: number; // in years\n  requirePaidFees?: boolean;\n}\n\nexport class RuleService {\n  \n  /**\n   * Evaluate voting rights for a member\n   */\n  async evaluateVotingRights(memberId: string, tenantId: string): Promise<RuleValidationResult> {\n    // Get member data\n    const [member] = await db\n      .select()\n      .from(members)\n      .where(and(eq(members.id, memberId), eq(members.tenantId, tenantId)));\n\n    if (!member) {\n      return {\n        eligible: false,\n        hasOverride: false,\n        warnings: ['Lid niet gevonden']\n      };\n    }\n\n    // Check for existing override\n    const [override] = await db\n      .select()\n      .from(ruleOverrides)\n      .where(and(\n        eq(ruleOverrides.memberId, memberId),\n        eq(ruleOverrides.tenantId, tenantId),\n        eq(ruleOverrides.ruleScope, 'STEMRECHT'),\n        eq(ruleOverrides.active, true)\n      ));\n\n    if (override) {\n      return {\n        eligible: override.overrideValue,\n        hasOverride: true,\n        override,\n        warnings: override.overrideValue ? ['Stemrecht handmatig toegekend'] : ['Stemrecht handmatig ingetrokken']\n      };\n    }\n\n    // Get voting rights rules for this tenant\n    const votingRules = await db\n      .select()\n      .from(rules)\n      .where(and(\n        eq(rules.tenantId, tenantId),\n        eq(rules.scope, 'STEMRECHT'),\n        eq(rules.active, true)\n      ));\n\n    const violatedRules: Rule[] = [];\n    const warnings: string[] = [];\n\n    // Apply default business rules if no custom rules exist\n    if (votingRules.length === 0) {\n      const defaultResult = this.applyDefaultVotingRules(member);\n      if (!defaultResult.eligible) {\n        warnings.push(...(defaultResult.warnings || []));\n      }\n      return defaultResult;\n    }\n\n    // Evaluate custom rules\n    for (const rule of votingRules) {\n      const config = rule.parameters as VotingRightsConfig;\n      const ruleResult = this.evaluateVotingRule(member, config);\n      \n      if (!ruleResult.eligible) {\n        violatedRules.push(rule);\n        warnings.push(...(ruleResult.warnings || []));\n      }\n    }\n\n    const eligible = violatedRules.length === 0;\n\n    return {\n      eligible,\n      hasOverride: false,\n      violatedRules,\n      warnings: warnings.length > 0 ? warnings : undefined\n    };\n  }\n\n  /**\n   * Apply default voting rights rules (Dutch/Belgian mosque standards)\n   */\n  private applyDefaultVotingRules(member: Member): RuleValidationResult {\n    const warnings: string[] = [];\n    let eligible = true;\n\n    // Must be active member\n    if (!member.active) {\n      eligible = false;\n      warnings.push('Lid is niet actief');\n    }\n\n    // Age restrictions (18+ for voting)\n    if (member.birthDate) {\n      const age = this.calculateAge(member.birthDate);\n      if (age < 18) {\n        eligible = false;\n        warnings.push('Lid is jonger dan 18 jaar');\n      }\n    }\n\n    // Category restrictions (no students/youth voting typically)\n    if (member.category === 'STUDENT' || member.category === 'JEUGD') {\n      eligible = false;\n      warnings.push('Studenten en jeugdleden hebben geen stemrecht');\n    }\n\n    return {\n      eligible,\n      hasOverride: false,\n      warnings: warnings.length > 0 ? warnings : undefined\n    };\n  }\n\n  /**\n   * Evaluate a specific voting rule\n   */\n  private evaluateVotingRule(member: Member, config: VotingRightsConfig): RuleValidationResult {\n    const warnings: string[] = [];\n    let eligible = true;\n\n    // Age checks\n    if (member.birthDate) {\n      const age = this.calculateAge(member.birthDate);\n      \n      if (config.minAge && age < config.minAge) {\n        eligible = false;\n        warnings.push(`Lid is jonger dan vereiste minimumleeftijd (${config.minAge})`);\n      }\n      \n      if (config.maxAge && age > config.maxAge) {\n        eligible = false;\n        warnings.push(`Lid is ouder dan vereiste maximumleeftijd (${config.maxAge})`);\n      }\n    }\n\n    // Category checks\n    if (config.allowedCategories && !config.allowedCategories.includes(member.category)) {\n      eligible = false;\n      warnings.push(`Lidcategorie '${member.category}' heeft geen stemrecht`);\n    }\n\n    if (config.excludedCategories && config.excludedCategories.includes(member.category)) {\n      eligible = false;\n      warnings.push(`Lidcategorie '${member.category}' is uitgesloten van stemrecht`);\n    }\n\n    // Active membership check\n    if (config.requireActiveMembership && !member.active) {\n      eligible = false;\n      warnings.push('Actief lidmaatschap is vereist voor stemrecht');\n    }\n\n    return {\n      eligible,\n      hasOverride: false,\n      warnings: warnings.length > 0 ? warnings : undefined\n    };\n  }\n\n  /**\n   * Create or update a rule override\n   */\n  async createRuleOverride(\n    memberId: string,\n    tenantId: string,\n    ruleScope: 'STEMRECHT' | 'VERKIESBAAR',\n    overrideValue: boolean,\n    reason: string,\n    overriddenBy: string\n  ): Promise<RuleOverride> {\n    // Deactivate any existing overrides for this member and scope\n    await db\n      .update(ruleOverrides)\n      .set({ active: false })\n      .where(and(\n        eq(ruleOverrides.memberId, memberId),\n        eq(ruleOverrides.tenantId, tenantId),\n        eq(ruleOverrides.ruleScope, ruleScope)\n      ));\n\n    // Create new override\n    const [override] = await db\n      .insert(ruleOverrides)\n      .values({\n        tenantId,\n        memberId,\n        ruleScope,\n        overrideValue,\n        reason,\n        overriddenBy\n      })\n      .returning();\n\n    return override;\n  }\n\n  /**\n   * Check if member has voting rights (with override support)\n   */\n  async hasVotingRights(memberId: string, tenantId: string): Promise<boolean> {\n    const result = await this.evaluateVotingRights(memberId, tenantId);\n    return result.eligible;\n  }\n\n  /**\n   * Get detailed voting rights status for display\n   */\n  async getVotingRightsStatus(memberId: string, tenantId: string): Promise<{\n    eligible: boolean;\n    hasOverride: boolean;\n    reason: string;\n    warnings: string[];\n  }> {\n    const result = await this.evaluateVotingRights(memberId, tenantId);\n    \n    let reason = '';\n    if (result.hasOverride) {\n      reason = result.override?.overrideValue \n        ? `Handmatig toegekend: ${result.override.reason}`\n        : `Handmatig ingetrokken: ${result.override.reason}`;\n    } else if (result.eligible) {\n      reason = 'Voldoet aan alle voorwaarden';\n    } else {\n      reason = result.warnings?.join('; ') || 'Voldoet niet aan voorwaarden';\n    }\n\n    return {\n      eligible: result.eligible,\n      hasOverride: result.hasOverride,\n      reason,\n      warnings: result.warnings || []\n    };\n  }\n\n  /**\n   * Calculate age from birth date\n   */\n  private calculateAge(birthDate: Date | string): number {\n    const birth = new Date(birthDate);\n    const today = new Date();\n    let age = today.getFullYear() - birth.getFullYear();\n    const monthDiff = today.getMonth() - birth.getMonth();\n    \n    if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\n      age--;\n    }\n    \n    return age;\n  }\n}\n\nexport const ruleService = new RuleService();","size_bytes":7849},"client/src/components/ui/board-member-badge.tsx":{"content":"import { Crown } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { useBoardMemberStatus } from \"@/hooks/useBoardMemberStatus\";\n\ninterface BoardMemberBadgeProps {\n  memberId: string;\n  className?: string;\n  size?: 'sm' | 'md' | 'lg';\n  variant?: 'subtle' | 'embossed';\n}\n\nconst sizeClasses = {\n  sm: \"w-3 h-3\",\n  md: \"w-4 h-4\", \n  lg: \"w-5 h-5\"\n};\n\nexport function BoardMemberBadge({ \n  memberId, \n  className,\n  size = 'md',\n  variant = 'subtle'\n}: BoardMemberBadgeProps) {\n  const { isActiveBoardMember } = useBoardMemberStatus(memberId);\n\n  if (!isActiveBoardMember) {\n    return null;\n  }\n\n  const baseStyles = cn(\n    \"text-yellow-500\",\n    sizeClasses[size],\n    className\n  );\n\n  const embossedStyles = variant === 'embossed' ? {\n    background: 'linear-gradient(45deg, #FFD700, #CDA434)',\n    WebkitBackgroundClip: 'text',\n    WebkitTextFillColor: 'transparent',\n    filter: 'drop-shadow(0 1px 3px rgba(255, 215, 0, 0.5))',\n  } : {};\n\n  return (\n    <Crown\n      className={baseStyles}\n      style={{\n        color: variant === 'subtle' ? '#FFD700' : undefined,\n        ...embossedStyles\n      }}\n      aria-label=\"Actief bestuurslid\"\n      data-testid={`crown-${memberId}`}\n    />\n  );\n}","size_bytes":1209},"client/src/hooks/useBoardMemberStatus.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\n\nexport function useBoardMemberStatus(memberId?: string) {\n  const { data: boardStatus } = useQuery({\n    queryKey: [\"/api/public/board-status\", memberId],\n    enabled: !!memberId,\n    staleTime: 30000, // Cache for 30 seconds\n    // Use public endpoint that doesn't require authentication\n    queryFn: async () => {\n      const response = await fetch(`/api/public/board-status/${memberId}`);\n      if (!response.ok) {\n        if (response.status === 404) return { isActiveBoardMember: false };\n        throw new Error('Failed to fetch board member status');\n      }\n      return response.json();\n    }\n  });\n\n  return {\n    isActiveBoardMember: boardStatus?.isActiveBoardMember || false,\n    boardMemberRole: boardStatus?.role,\n    boardMember: boardStatus,\n  };\n}\n\nexport function useBoardMemberBadge(memberId?: string) {\n  const { isActiveBoardMember } = useBoardMemberStatus(memberId);\n  \n  return {\n    shouldShowCrown: isActiveBoardMember,\n    crownProps: {\n      className: \"w-4 h-4\",\n      style: { color: '#FFD700' },\n      \"aria-label\": \"Actief bestuurslid\"\n    }\n  };\n}","size_bytes":1130},"client/src/pages/bestuur.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from \"@/components/ui/alert-dialog\";\nimport { BoardMemberForm } from \"@/components/forms/board-member-form\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { cn } from \"@/lib/utils\";\nimport { Crown, Plus, Edit, Phone, Mail, User } from \"lucide-react\";\nimport { FiUserX } from \"react-icons/fi\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\n\ninterface BoardMemberWithMember {\n  boardMember: {\n    id: string;\n    memberId?: string;\n    externalName?: string;\n    email?: string;\n    phone?: string;\n    role: string;\n    status: 'ACTIEF' | 'INACTIEF';\n    termStart: string;\n    termEnd?: string;\n    responsibilities?: string;\n    orderIndex: number;\n    avatarUrl?: string;\n  };\n  member?: {\n    id: string;\n    firstName: string;\n    lastName: string;\n    email?: string;\n    phone?: string;\n  };\n}\n\nconst roleLabels = {\n  VOORZITTER: \"Voorzitter\",\n  ONDERVERZITTER: \"Ondervoorzitter\",\n  SECRETARIS: \"Secretaris\",\n  PENNINGMEESTER: \"Penningmeester\",\n  BESTUURSLID: \"Bestuurslid\",\n  ADVISEUR: \"Adviseur\"\n};\n\nconst roleColors = {\n  VOORZITTER: \"bg-purple-100 text-purple-800\",\n  ONDERVERZITTER: \"bg-blue-100 text-blue-800\",\n  SECRETARIS: \"bg-green-100 text-green-800\",\n  PENNINGMEESTER: \"bg-orange-100 text-orange-800\",\n  BESTUURSLID: \"bg-gray-100 text-gray-800\",\n  ADVISEUR: \"bg-yellow-100 text-yellow-800\"\n};\n\nexport default function Bestuur() {\n  const [activeTab, setActiveTab] = useState(\"overzicht\");\n  const [statusFilter, setStatusFilter] = useState(\"ACTIEF\");\n  const [roleFilter, setRoleFilter] = useState(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [showNewMemberDialog, setShowNewMemberDialog] = useState(false);\n  const [selectedBoardMember, setSelectedBoardMember] = useState<any>(null);\n  const [memberToDeactivate, setMemberToDeactivate] = useState<BoardMemberWithMember | null>(null);\n  const [memberToReactivate, setMemberToReactivate] = useState<BoardMemberWithMember | null>(null);\n\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const { user } = useAuth();\n\n  // Check if user has write permissions (not MEDEWERKER)\n  const canEdit = user?.role !== 'MEDEWERKER';\n\n  const { data: boardMembers, isLoading } = useQuery({\n    queryKey: [\"/api/board/members\", { status: activeTab === \"historiek\" ? \"INACTIEF\" : statusFilter, role: roleFilter, q: searchTerm }],\n    staleTime: 30000, // 30 seconds - longer caching for stability\n    gcTime: 300000, // 5 minutes - keep data in cache longer\n    refetchOnWindowFocus: false,\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      // For history tab, always fetch inactive members\n      const currentStatus = activeTab === \"historiek\" ? \"INACTIEF\" : statusFilter;\n      if (currentStatus && currentStatus !== 'all') params.append('status', currentStatus);\n      if (roleFilter && roleFilter !== 'all') params.append('role', roleFilter);\n      if (searchTerm) params.append('q', searchTerm);\n      \n      const url = `/api/board/members${params.toString() ? '?' + params.toString() : ''}`;\n      const response = await apiRequest('GET', url);\n      return response.json();\n    },\n  });\n\n  // Mutation for creating new board member\n  const createBoardMemberMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return apiRequest('POST', '/api/board/members', data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/board/members\"] });\n      setShowNewMemberDialog(false);\n      toast({\n        title: \"Bestuurslid toegevoegd\",\n        description: \"Het nieuwe bestuurslid is succesvol toegevoegd.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het toevoegen van het bestuurslid.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCreateBoardMember = (formData: any) => {\n    createBoardMemberMutation.mutate(formData);\n  };\n\n  // Mutation for updating board member\n  const updateBoardMemberMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      return apiRequest('PUT', `/api/board/members/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/board/members\"] });\n      setSelectedBoardMember(null);\n      toast({\n        title: \"Bestuurslid bijgewerkt\",\n        description: \"Het bestuurslid is succesvol bijgewerkt.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het bijwerken van het bestuurslid.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation for deactivating board member\n  const deactivateBoardMemberMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest('POST', `/api/board/members/${id}/end-term`, { \n        endDate: new Date().toISOString(),\n        note: \"Beëindigd via bestuurspagina\"\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/board/members\"] });\n      toast({\n        title: \"Bestuurslid gedeactiveerd\",\n        description: \"Het bestuurslid is succesvol gedeactiveerd en verplaatst naar de historiek.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het deactiveren van het bestuurslid.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation for reactivating board member\n  const reactivateBoardMemberMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest('PUT', `/api/board/members/${id}`, { \n        status: 'ACTIEF',\n        termEnd: null\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/board/members\"] });\n      toast({\n        title: \"Bestuurslid gereactiveerd\",\n        description: \"Het bestuurslid is succesvol gereactiveerd.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout\",\n        description: error.message || \"Er is een fout opgetreden bij het reactiveren van het bestuurslid.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleUpdateBoardMember = (formData: any) => {\n    if (selectedBoardMember) {\n      updateBoardMemberMutation.mutate({ \n        id: selectedBoardMember.boardMember.id, \n        data: formData \n      });\n    }\n  };\n\n  const handleDeactivateBoardMember = (id: string) => {\n    deactivateBoardMemberMutation.mutate(id);\n    setMemberToDeactivate(null);\n  };\n\n  const handleReactivateBoardMember = (id: string) => {\n    reactivateBoardMemberMutation.mutate(id);\n    setMemberToReactivate(null);\n  };\n\n  const getName = (item: BoardMemberWithMember) => {\n    if (item.member) {\n      return `${item.member.firstName} ${item.member.lastName}`;\n    }\n    return item.boardMember.externalName || \"Onbekend\";\n  };\n\n  const getContact = (item: BoardMemberWithMember) => {\n    const email = item.member?.email || item.boardMember.email;\n    const phone = item.member?.phone || item.boardMember.phone;\n    return { email, phone };\n  };\n\n  const filteredBoardMembers = (boardMembers as BoardMemberWithMember[] || [])?.filter((item: BoardMemberWithMember) => {\n    const name = getName(item);\n    const matchesSearch = !searchTerm || \n      name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      item.boardMember.role.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesRole = roleFilter === \"all\" || item.boardMember.role === roleFilter;\n    const matchesStatus = item.boardMember.status === statusFilter;\n\n    return matchesSearch && matchesRole && matchesStatus;\n  }) || [];\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Mijn Bestuur</h1>\n              <p className=\"mt-2 text-sm text-gray-600 font-medium\" data-testid=\"page-description\">\n                Beheer bestuursleden en hun mandaten\n              </p>\n            </div>\n          </div>\n        </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <TabsList className=\"grid grid-cols-2 w-auto\" data-testid=\"board-tabs\">\n            <TabsTrigger value=\"overzicht\" data-testid=\"tab-overview\">Overzicht</TabsTrigger>\n            <TabsTrigger value=\"historiek\" data-testid=\"tab-history\">Historiek</TabsTrigger>\n          </TabsList>\n          {canEdit && (\n            <Button\n              onClick={() => setShowNewMemberDialog(true)}\n              className=\"flex items-center gap-2\"\n              data-testid=\"button-new-board-member\"\n            >\n              <Plus className=\"w-4 h-4\" />\n              Nieuw Bestuurslid\n            </Button>\n          )}\n        </div>\n\n        <TabsContent value=\"overzicht\" className=\"space-y-6\">\n          {/* Filters */}\n          <div className=\"glass-card card-hover animate-fade-in group border-0 p-6 rounded-xl\">\n            <div className=\"flex gap-4 items-center\">\n            <Input\n              placeholder=\"Zoek op naam of rol...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"max-w-xs\"\n              data-testid=\"input-search\"\n            />\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-[140px]\" data-testid=\"select-status-filter\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"ACTIEF\">Actief</SelectItem>\n                <SelectItem value=\"INACTIEF\">Inactief</SelectItem>\n              </SelectContent>\n            </Select>\n            <Select value={roleFilter} onValueChange={setRoleFilter}>\n              <SelectTrigger className=\"w-[160px]\" data-testid=\"select-role-filter\">\n                <SelectValue placeholder=\"Alle rollen\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">Alle rollen</SelectItem>\n                <SelectItem value=\"VOORZITTER\">Voorzitter</SelectItem>\n                <SelectItem value=\"ONDERVERZITTER\">Ondervoorzitter</SelectItem>\n                <SelectItem value=\"SECRETARIS\">Secretaris</SelectItem>\n                <SelectItem value=\"PENNINGMEESTER\">Penningmeester</SelectItem>\n                <SelectItem value=\"BESTUURSLID\">Bestuurslid</SelectItem>\n                <SelectItem value=\"ADVISEUR\">Adviseur</SelectItem>\n              </SelectContent>\n            </Select>\n            </div>\n          </div>\n\n          {/* Board Members Grid */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\" data-testid=\"board-members-grid\">\n            {isLoading ? (\n              Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i} className=\"glass-card animate-pulse\">\n                  <CardHeader>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-12 h-12 bg-gray-200 rounded-full\"></div>\n                      <div className=\"flex-1\">\n                        <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                        <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                      </div>\n                    </div>\n                  </CardHeader>\n                </Card>\n              ))\n            ) : filteredBoardMembers.length === 0 ? (\n              <div className=\"col-span-full text-center py-12\" data-testid=\"empty-state\">\n                <User className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Geen bestuursleden gevonden</h3>\n                <p className=\"text-gray-500 mb-4\">Voeg je eerste bestuurslid toe</p>\n                <Button onClick={() => setShowNewMemberDialog(true)} data-testid=\"button-add-first-member\">\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Voeg Bestuurslid Toe\n                </Button>\n              </div>\n            ) : (\n              filteredBoardMembers.map((item: BoardMemberWithMember) => {\n                const { email, phone } = getContact(item);\n                const name = getName(item);\n                \n                return (\n                  <Card key={item.boardMember.id} className=\"glass-card card-hover animate-fade-in group border-0\" data-testid={`card-board-member-${item.boardMember.id}`}>\n                    <CardHeader>\n                      <div className=\"flex items-center gap-3\">\n                        <Avatar className=\"w-12 h-12\">\n                          <AvatarImage src={item.boardMember.avatarUrl} />\n                          <AvatarFallback className=\"bg-blue-100 text-blue-600\">\n                            {name.split(' ').map(n => n[0]).join('').toUpperCase()}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-2\">\n                            <CardTitle className=\"text-base\" data-testid={`text-name-${item.boardMember.id}`}>{name}</CardTitle>\n                          </div>\n                          <Badge \n                            className={`text-xs ${roleColors[item.boardMember.role as keyof typeof roleColors] || 'bg-gray-100 text-gray-800'}`}\n                            data-testid={`badge-role-${item.boardMember.id}`}\n                          >\n                            {roleLabels[item.boardMember.role as keyof typeof roleLabels]}\n                          </Badge>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex items-center gap-2 text-gray-600\">\n                          <Crown className=\"w-4 h-4\" />\n                          <span data-testid={`text-status-${item.boardMember.id}`}>\n                            {item.boardMember.status === 'ACTIEF' ? 'Actief mandaat' : 'Beëindigd mandaat'}\n                          </span>\n                        </div>\n                        <div className=\"text-gray-600\">\n                          <strong>Mandaat:</strong> {format(new Date(item.boardMember.termStart), 'dd MMM yyyy', { locale: nl })}\n                          {item.boardMember.termEnd ? \n                            ` - ${format(new Date(item.boardMember.termEnd), 'dd MMM yyyy', { locale: nl })}` : \n                            ' - heden'\n                          }\n                        </div>\n                        {email && (\n                          <div className=\"flex items-center gap-2 text-gray-600\">\n                            <Mail className=\"w-4 h-4\" />\n                            <span className=\"truncate\" data-testid={`text-email-${item.boardMember.id}`}>{email}</span>\n                          </div>\n                        )}\n                        {phone && (\n                          <div className=\"flex items-center gap-2 text-gray-600\">\n                            <Phone className=\"w-4 h-4\" />\n                            <span data-testid={`text-phone-${item.boardMember.id}`}>{phone}</span>\n                          </div>\n                        )}\n                        {item.boardMember.responsibilities && (\n                          <div className=\"text-gray-600 text-xs mt-3 p-2 glass-card border-0 rounded\">\n                            <strong>Verantwoordelijkheden:</strong>\n                            <p className=\"mt-1\" data-testid={`text-responsibilities-${item.boardMember.id}`}>\n                              {item.boardMember.responsibilities}\n                            </p>\n                          </div>\n                        )}\n{canEdit && (\n                          <div className=\"flex gap-2 pt-2\">\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\"\n                              onClick={() => setSelectedBoardMember(item)}\n                              data-testid={`button-edit-${item.boardMember.id}`}\n                            >\n                              <Edit className=\"w-4 h-4\" />\n                            </Button>\n                            {item.boardMember.status === 'ACTIEF' && (\n                              <AlertDialog>\n                                <AlertDialogTrigger asChild>\n                                  <Button \n                                    size=\"sm\" \n                                    variant=\"outline\"\n                                    disabled={deactivateBoardMemberMutation.isPending}\n                                    data-testid={`button-end-term-${item.boardMember.id}`}\n                                  >\n                                    <FiUserX className=\"w-4 h-4\" />\n                                  </Button>\n                                </AlertDialogTrigger>\n                                <AlertDialogContent>\n                                  <AlertDialogHeader>\n                                    <AlertDialogTitle>Bestuurslid deactiveren</AlertDialogTitle>\n                                    <AlertDialogDescription>\n                                      Weet je zeker dat je <strong>{getName(item)}</strong> wilt deactiveren? \n                                      Het bestuurslid wordt verplaatst naar de historiek en kan later weer gereactiveerd worden.\n                                    </AlertDialogDescription>\n                                  </AlertDialogHeader>\n                                  <AlertDialogFooter>\n                                    <AlertDialogCancel>Annuleren</AlertDialogCancel>\n                                    <AlertDialogAction \n                                      onClick={() => handleDeactivateBoardMember(item.boardMember.id)}\n                                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                                    >\n                                      Deactiveren\n                                    </AlertDialogAction>\n                                  </AlertDialogFooter>\n                                </AlertDialogContent>\n                              </AlertDialog>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                    </CardContent>\n                  </Card>\n                );\n              })\n            )}\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"historiek\" className=\"space-y-6\">\n          {/* Historiek Filters */}\n          <div className=\"glass-card card-hover animate-fade-in group border-0 p-6 rounded-xl\">\n            <div className=\"flex gap-4 items-center\">\n            <Input\n              placeholder=\"Zoek in historiek...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"max-w-xs\"\n              data-testid=\"input-history-search\"\n            />\n            <Select value={roleFilter} onValueChange={setRoleFilter}>\n              <SelectTrigger className=\"w-[160px]\" data-testid=\"select-history-role-filter\">\n                <SelectValue placeholder=\"Alle rollen\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">Alle rollen</SelectItem>\n                <SelectItem value=\"VOORZITTER\">Voorzitter</SelectItem>\n                <SelectItem value=\"ONDERVERZITTER\">Ondervoorzitter</SelectItem>\n                <SelectItem value=\"SECRETARIS\">Secretaris</SelectItem>\n                <SelectItem value=\"PENNINGMEESTER\">Penningmeester</SelectItem>\n                <SelectItem value=\"BESTUURSLID\">Bestuurslid</SelectItem>\n                <SelectItem value=\"ADVISEUR\">Adviseur</SelectItem>\n              </SelectContent>\n            </Select>\n            </div>\n          </div>\n\n          {/* Historiek Grid */}\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\" data-testid=\"history-grid\">\n            {isLoading ? (\n              Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i} className=\"glass-card animate-pulse\">\n                  <CardHeader>\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-12 h-12 bg-gray-200 rounded-full\"></div>\n                      <div className=\"flex-1\">\n                        <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                        <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                      </div>\n                    </div>\n                  </CardHeader>\n                </Card>\n              ))\n            ) : (\n              (() => {\n                // Filter for inactive members\n                const inactiveMembers = (boardMembers as BoardMemberWithMember[] || [])?.filter((item: BoardMemberWithMember) => {\n                  const name = getName(item);\n                  const matchesSearch = !searchTerm || \n                    name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                    item.boardMember.role.toLowerCase().includes(searchTerm.toLowerCase());\n                  \n                  const matchesRole = roleFilter === \"all\" || item.boardMember.role === roleFilter;\n                  const matchesStatus = item.boardMember.status === 'INACTIEF';\n\n                  return matchesSearch && matchesRole && matchesStatus;\n                }) || [];\n\n                if (inactiveMembers.length === 0) {\n                  return (\n                    <div className=\"col-span-full text-center py-12\" data-testid=\"history-empty-state\">\n                      <User className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                      <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Geen historiek gevonden</h3>\n                      <p className=\"text-gray-500\">Er zijn nog geen voormalige bestuursleden</p>\n                    </div>\n                  );\n                }\n\n                return inactiveMembers.map((item: BoardMemberWithMember) => {\n                  const name = getName(item);\n                  const { email, phone } = getContact(item);\n\n                  return (\n                    <Card key={item.boardMember.id} className=\"glass-card card-hover animate-fade-in group border-0 opacity-75\" data-testid={`history-card-${item.boardMember.id}`}>\n                      <CardHeader className=\"pb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"w-12 h-12\">\n                            <AvatarImage src={item.boardMember.avatarUrl} />\n                            <AvatarFallback className=\"bg-gray-300 text-gray-600\">\n                              {name.split(' ').map(n => n[0]).join('').toUpperCase()}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"flex-1\">\n                            <h3 className=\"text-base font-semibold text-gray-700\" data-testid={`history-name-${item.boardMember.id}`}>\n                              {name}\n                            </h3>\n                            <Badge \n                              variant=\"secondary\" \n                              className={cn(\"text-xs\", roleColors[item.boardMember.role as keyof typeof roleColors])}\n                              data-testid={`history-role-badge-${item.boardMember.id}`}\n                            >\n                              {roleLabels[item.boardMember.role as keyof typeof roleLabels]}\n                            </Badge>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent className=\"pt-0\">\n                        <div className=\"space-y-2 text-sm\">\n                          <div className=\"flex items-center gap-2 text-gray-500\">\n                            <span className=\"font-medium\">Periode:</span>\n                            <span data-testid={`history-period-${item.boardMember.id}`}>\n                              {format(new Date(item.boardMember.termStart), \"dd MMM yyyy\", { locale: nl })}\n                              {item.boardMember.termEnd && (\n                                <> - {format(new Date(item.boardMember.termEnd), \"dd MMM yyyy\", { locale: nl })}</>\n                              )}\n                            </span>\n                          </div>\n                          {email && (\n                            <div className=\"flex items-center gap-2 text-gray-500\">\n                              <Mail className=\"w-4 h-4\" />\n                              <span data-testid={`history-email-${item.boardMember.id}`}>{email}</span>\n                            </div>\n                          )}\n                          {phone && (\n                            <div className=\"flex items-center gap-2 text-gray-500\">\n                              <Phone className=\"w-4 h-4\" />\n                              <span data-testid={`history-phone-${item.boardMember.id}`}>{phone}</span>\n                            </div>\n                          )}\n                          {item.boardMember.responsibilities && (\n                            <div className=\"text-gray-500 text-xs mt-3 p-2 glass-card border-0 rounded\">\n                              <strong>Verantwoordelijkheden:</strong>\n                              <p className=\"mt-1\" data-testid={`history-responsibilities-${item.boardMember.id}`}>\n                                {item.boardMember.responsibilities}\n                              </p>\n                            </div>\n                          )}\n                          {canEdit && (\n                            <div className=\"flex gap-2 pt-2 mt-3 border-t border-gray-200\">\n                              <AlertDialog>\n                                <AlertDialogTrigger asChild>\n                                  <Button \n                                    size=\"sm\" \n                                    variant=\"outline\"\n                                    disabled={reactivateBoardMemberMutation.isPending}\n                                    data-testid={`button-reactivate-${item.boardMember.id}`}\n                                    className=\"text-green-600 border-green-200 hover:bg-green-50\"\n                                  >\n                                    <User className=\"w-4 h-4 mr-1\" />\n                                    Reactiveren\n                                  </Button>\n                                </AlertDialogTrigger>\n                                <AlertDialogContent>\n                                  <AlertDialogHeader>\n                                    <AlertDialogTitle>Bestuurslid reactiveren</AlertDialogTitle>\n                                    <AlertDialogDescription>\n                                      Weet je zeker dat je <strong>{name}</strong> weer wilt activeren als bestuurslid? \n                                      Het bestuurslid wordt terug verplaatst naar het actieve overzicht.\n                                    </AlertDialogDescription>\n                                  </AlertDialogHeader>\n                                  <AlertDialogFooter>\n                                    <AlertDialogCancel>Annuleren</AlertDialogCancel>\n                                    <AlertDialogAction \n                                      onClick={() => handleReactivateBoardMember(item.boardMember.id)}\n                                      className=\"bg-green-600 text-white hover:bg-green-700\"\n                                    >\n                                      Reactiveren\n                                    </AlertDialogAction>\n                                  </AlertDialogFooter>\n                                </AlertDialogContent>\n                              </AlertDialog>\n                            </div>\n                          )}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  );\n                });\n              })()\n            )}\n          </div>\n        </TabsContent>\n      </Tabs>\n\n      {/* New Board Member Dialog */}\n      {canEdit && (\n        <Dialog open={showNewMemberDialog} onOpenChange={setShowNewMemberDialog}>\n          <DialogContent className=\"max-w-6xl max-h-[95vh] min-h-[600px] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <Plus className=\"h-5 w-5\" />\n                Nieuw Bestuurslid\n              </DialogTitle>\n              <DialogDescription>\n                Voeg een nieuw bestuurslid toe aan de bestuursadministratie\n              </DialogDescription>\n            </DialogHeader>\n            <BoardMemberForm\n              onSubmit={handleCreateBoardMember}\n              onCancel={() => setShowNewMemberDialog(false)}\n              isLoading={createBoardMemberMutation.isPending}\n            />\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Edit Board Member Dialog */}\n      {canEdit && (\n        <Dialog open={!!selectedBoardMember} onOpenChange={() => setSelectedBoardMember(null)}>\n          <DialogContent className=\"max-w-6xl max-h-[95vh] min-h-[600px] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <Edit className=\"h-5 w-5\" />\n                Bestuurslid Bewerken\n              </DialogTitle>\n              <DialogDescription>\n                Bewerk de gegevens van het bestuurslid\n              </DialogDescription>\n            </DialogHeader>\n            {selectedBoardMember && (\n              <BoardMemberForm\n                onSubmit={handleUpdateBoardMember}\n                onCancel={() => setSelectedBoardMember(null)}\n                isLoading={updateBoardMemberMutation.isPending}\n                isEditMode={true}\n                initialData={{\n                  memberId: selectedBoardMember.boardMember.memberId || '',\n                  externalName: selectedBoardMember.boardMember.externalName || '',\n                  email: selectedBoardMember.boardMember.email || '',\n                  phone: selectedBoardMember.boardMember.phone || '',\n                  role: selectedBoardMember.boardMember.role,\n                  termStart: selectedBoardMember.boardMember.termStart,\n                  termEnd: selectedBoardMember.boardMember.termEnd || '',\n                  responsibilities: selectedBoardMember.boardMember.responsibilities || '',\n                  orderIndex: selectedBoardMember.boardMember.orderIndex\n                }}\n              />\n            )}\n          </DialogContent>\n        </Dialog>\n      )}\n      </div>\n    </main>\n  );\n}","size_bytes":32351},"server/services/board.ts":{"content":"import { db } from \"../db\";\nimport { boardMembers, boardTerms, members, type BoardMember, type BoardTerm, type InsertBoardMember, type InsertBoardTerm } from \"@shared/schema\";\nimport { eq, and, desc, isNull, or } from \"drizzle-orm\";\n\nexport class BoardService {\n  async listBoardMembers(tenantId: string, filters?: {\n    status?: 'ACTIEF' | 'INACTIEF';\n    role?: string;\n    q?: string;\n  }) {\n    let whereConditions = [eq(boardMembers.tenantId, tenantId)];\n\n    if (filters?.status) {\n      whereConditions.push(eq(boardMembers.status, filters.status));\n    }\n\n    if (filters?.role) {\n      whereConditions.push(eq(boardMembers.role, filters.role as any));\n    }\n\n    return await db.select({\n      boardMember: boardMembers,\n      member: members,\n    })\n    .from(boardMembers)\n    .leftJoin(members, eq(boardMembers.memberId, members.id))\n    .where(and(...whereConditions))\n    .orderBy(boardMembers.orderIndex, boardMembers.role);\n  }\n\n  async getBoardMember(tenantId: string, id: string) {\n    const result = await db.select({\n      boardMember: boardMembers,\n      member: members,\n      terms: boardTerms,\n    })\n    .from(boardMembers)\n    .leftJoin(members, eq(boardMembers.memberId, members.id))\n    .leftJoin(boardTerms, eq(boardTerms.boardMemberId, boardMembers.id))\n    .where(and(\n      eq(boardMembers.tenantId, tenantId),\n      eq(boardMembers.id, id)\n    ))\n    .orderBy(desc(boardTerms.start));\n\n    if (result.length === 0) return null;\n\n    const boardMember = result[0].boardMember;\n    const member = result[0].member;\n    const terms = result.map(r => r.terms).filter(Boolean);\n\n    return {\n      ...boardMember,\n      member,\n      terms,\n    };\n  }\n\n  async createBoardMember(tenantId: string, data: InsertBoardMember) {\n    const boardMember = await db.insert(boardMembers)\n      .values({ ...data, tenantId })\n      .returning();\n\n    // Create initial board term\n    if (boardMember[0]) {\n      await db.insert(boardTerms).values({\n        tenantId,\n        boardMemberId: boardMember[0].id,\n        role: data.role,\n        start: data.termStart,\n        end: data.termEnd || null,\n      });\n    }\n\n    return boardMember[0];\n  }\n\n  async updateBoardMember(tenantId: string, id: string, data: Partial<InsertBoardMember>) {\n    const updated = await db.update(boardMembers)\n      .set({ ...data, updatedAt: new Date() })\n      .where(and(\n        eq(boardMembers.tenantId, tenantId),\n        eq(boardMembers.id, id)\n      ))\n      .returning();\n\n    return updated[0];\n  }\n\n  async endActiveTerm(tenantId: string, boardMemberId: string, endDate: Date, note?: string) {\n    // End current active term\n    await db.update(boardTerms)\n      .set({ end: endDate, note })\n      .where(and(\n        eq(boardTerms.tenantId, tenantId),\n        eq(boardTerms.boardMemberId, boardMemberId),\n        isNull(boardTerms.end)\n      ));\n\n    // Set board member status to INACTIEF if no active term\n    await db.update(boardMembers)\n      .set({ status: 'INACTIEF', termEnd: endDate, updatedAt: new Date() })\n      .where(and(\n        eq(boardMembers.tenantId, tenantId),\n        eq(boardMembers.id, boardMemberId)\n      ));\n\n    return true;\n  }\n\n  async reorderBoard(tenantId: string, orderData: { id: string; orderIndex: number }[]) {\n    for (const item of orderData) {\n      await db.update(boardMembers)\n        .set({ orderIndex: item.orderIndex, updatedAt: new Date() })\n        .where(and(\n          eq(boardMembers.tenantId, tenantId),\n          eq(boardMembers.id, item.id)\n        ));\n    }\n    return true;\n  }\n\n  async getActiveBoardMemberByMemberId(tenantId: string, memberId: string): Promise<BoardMember | null> {\n    const result = await db.select()\n      .from(boardMembers)\n      .where(and(\n        eq(boardMembers.tenantId, tenantId),\n        eq(boardMembers.memberId, memberId),\n        eq(boardMembers.status, 'ACTIEF')\n      ))\n      .limit(1);\n\n    return result[0] || null;\n  }\n\n  async getBoardMemberByMemberId(tenantId: string | null, memberId: string) {\n    const whereConditions = [eq(boardMembers.memberId, memberId)];\n    \n    // Only add tenant filter if tenantId is provided (for authenticated requests)\n    if (tenantId) {\n      whereConditions.push(eq(boardMembers.tenantId, tenantId));\n    }\n\n    const result = await db.select({\n      boardMember: boardMembers,\n      member: members,\n    })\n    .from(boardMembers)\n    .leftJoin(members, eq(boardMembers.memberId, members.id))\n    .where(and(...whereConditions))\n    .limit(1);\n\n    return result[0] || null;\n  }\n}\n\nexport const boardService = new BoardService();","size_bytes":4572},"client/src/components/forms/board-member-form.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { CalendarIcon, User, Mail, Phone, Link, Crown, FileText, Search, UserCircle } from \"lucide-react\";\nimport { MdOutlinePermIdentity } from \"react-icons/md\";\nimport { format } from \"date-fns\";\nimport { nl } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\n\nconst boardMemberSchema = z.object({\n  linkType: z.enum(['EXISTING_MEMBER', 'EXTERNAL_PERSON'], { required_error: \"Kies een type\" }),\n  \n  // For existing member\n  memberId: z.string().optional(),\n  \n  // For external person\n  externalName: z.string().optional(),\n  email: z.string()\n    .optional()\n    .or(z.literal(\"\"))\n    .refine((email) => {\n      if (!email || email === \"\") return true;\n      // Strikte email validatie\n      const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;\n      return emailRegex.test(email);\n    }, \"Ongeldig e-mailadres format\"),\n  phone: z.string()\n    .optional()\n    .refine((phone) => {\n      if (!phone || phone === \"\") return true;\n      // Belgisch/Nederlands telefoonnummer validatie\n      const phoneRegex = /^(\\+32|0032|0)[1-9]\\d{7,8}$|^(\\+31|0031|0)[1-9]\\d{7,8}$/;\n      // Ook accept internationale formaten\n      const internationalRegex = /^\\+[1-9]\\d{1,14}$/;\n      const cleanPhone = phone.replace(/[\\s\\-\\(\\)]/g, '');\n      return phoneRegex.test(cleanPhone) || internationalRegex.test(cleanPhone);\n    }, \"Ongeldig telefoonnummer format (Belgisch/Nederlands of internationaal format verwacht)\"),\n  \n  // Board role info\n  role: z.enum(['VOORZITTER', 'VICE_VOORZITTER', 'SECRETARIS', 'PENNINGMEESTER', 'BESTUURSLID', 'ANDERS']).default('BESTUURSLID'),\n  customRole: z.string().optional(),\n  status: z.enum(['ACTIEF', 'INACTIEF']).default('ACTIEF'),\n  termStart: z.union([\n    z.date(),\n    z.string().transform((val) => new Date(val))\n  ]).refine((date) => date instanceof Date && !isNaN(date.getTime()), {\n    message: \"Ongeldige startdatum\"\n  }),\n  termEnd: z.union([\n    z.date(),\n    z.string().transform((val) => new Date(val))\n  ]).refine((date) => date instanceof Date && !isNaN(date.getTime()), {\n    message: \"Einddatum is verplicht\"\n  }),\n  \n  // Additional info\n  responsibilities: z.string().optional(),\n  avatarUrl: z.string().optional(),\n  orderIndex: z.number().optional(),\n}).refine((data) => {\n  if (data.linkType === 'EXISTING_MEMBER') {\n    return !!data.memberId;\n  }\n  if (data.linkType === 'EXTERNAL_PERSON') {\n    return !!data.externalName;\n  }\n  return true;\n}, {\n  message: \"Selecteer een lid of voer externe naam in\",\n  path: [\"memberId\"]\n}).refine((data) => {\n  if (data.role === 'ANDERS') {\n    return data.customRole && data.customRole.trim().length > 0;\n  }\n  return true;\n}, {\n  message: \"Aangepaste rol is verplicht wanneer 'Anders' is geselecteerd\",\n  path: [\"customRole\"]\n}).refine((data) => {\n  // Einddatum moet na startdatum liggen\n  if (data.termStart && data.termEnd) {\n    const startDate = data.termStart instanceof Date ? data.termStart : new Date(data.termStart);\n    const endDate = data.termEnd instanceof Date ? data.termEnd : new Date(data.termEnd);\n    return endDate > startDate;\n  }\n  return true;\n}, {\n  message: \"Einddatum moet na startdatum liggen\",\n  path: [\"termEnd\"]\n});\n\ntype BoardMemberFormData = z.infer<typeof boardMemberSchema>;\n\ninterface BoardMemberFormProps {\n  onSubmit: (data: BoardMemberFormData) => void;\n  onCancel: () => void;\n  isLoading?: boolean;\n  isEditMode?: boolean;\n  initialData?: Partial<BoardMemberFormData & {\n    memberId: string;\n    externalName: string;\n    email: string;\n    phone: string;\n    termStart: string;\n    termEnd: string;\n    orderIndex: number;\n  }>;\n}\n\nexport function BoardMemberForm({ onSubmit, onCancel, isLoading = false, isEditMode = false, initialData }: BoardMemberFormProps) {\n  // Determine initial link type based on initialData\n  const getInitialLinkType = () => {\n    if (initialData?.memberId) return 'EXISTING_MEMBER';\n    if (initialData?.externalName) return 'EXTERNAL_PERSON';\n    return 'EXISTING_MEMBER';\n  };\n\n  const [linkType, setLinkType] = useState<'EXISTING_MEMBER' | 'EXTERNAL_PERSON'>(getInitialLinkType());\n  const [memberSearch, setMemberSearch] = useState(initialData?.externalName || \"\");\n  const [selectedMember, setSelectedMember] = useState<any>(null);\n  const [activeTab, setActiveTab] = useState(isEditMode ? \"personal\" : \"linking\");\n\n  // Fetch all members for search\n  const { data: allMembers = [] } = useQuery<any[]>({\n    queryKey: [\"/api/members\"],\n    staleTime: 10000,\n    enabled: linkType === 'EXISTING_MEMBER',\n  });\n\n  // Filter members based on search locally\n  const filteredMembers = allMembers.filter((member: any) => {\n    if (!memberSearch || memberSearch.length < 2) return false;\n    const searchLower = memberSearch.toLowerCase();\n    const fullName = `${member.firstName} ${member.lastName}`.toLowerCase();\n    return (\n      fullName.includes(searchLower) ||\n      member.memberNumber.toString().includes(searchLower)\n    );\n  }).slice(0, 10); // Limit to 10 results\n\n  // Fetch member details for edit mode\n  const { data: memberDetails } = useQuery<any>({\n    queryKey: [\"/api/members\", initialData?.memberId],\n    staleTime: 10000,\n    enabled: !!(isEditMode && initialData?.memberId),\n  });\n\n  const form = useForm<BoardMemberFormData>({\n    resolver: zodResolver(boardMemberSchema),\n    defaultValues: {\n      linkType: getInitialLinkType(),\n      status: initialData?.status || 'ACTIEF',\n      memberId: initialData?.memberId || '',\n      externalName: initialData?.externalName || '',\n      email: initialData?.email || '',\n      phone: initialData?.phone || '',\n      role: initialData?.role || 'BESTUURSLID',\n      customRole: initialData?.customRole || '',\n      termStart: initialData?.termStart ? new Date(initialData.termStart) : undefined,\n      termEnd: initialData?.termEnd ? new Date(initialData.termEnd) : undefined,\n      responsibilities: initialData?.responsibilities || '',\n      orderIndex: initialData?.orderIndex || 0,\n    },\n  });\n\n  const handleMemberSelect = (member: any) => {\n    setSelectedMember(member);\n    form.setValue('memberId', member.id);\n    setMemberSearch(`${member.firstName} ${member.lastName}`);\n    \n    // Auto-navigate to personal tab after selection\n    setActiveTab('personal');\n  };\n\n  // Function to check if a tab has errors\n  const hasTabErrors = (tabName: string) => {\n    const errors = form.formState.errors;\n    \n    switch (tabName) {\n      case \"linking\":\n        return !!(errors.linkType || errors.memberId || errors.externalName);\n      case \"personal\":\n        return !!(errors.externalName || errors.email || errors.phone);\n      case \"role\":\n        return !!(errors.role || errors.termStart || errors.termEnd || errors.status);\n      case \"extra\":\n        return !!(errors.responsibilities || errors.avatarUrl || errors.orderIndex);\n      default:\n        return false;\n    }\n  };\n\n  const handleLinkTypeChange = (type: 'EXISTING_MEMBER' | 'EXTERNAL_PERSON') => {\n    setLinkType(type);\n    form.setValue('linkType', type);\n    \n    // Reset fields when changing type\n    if (type === 'EXISTING_MEMBER') {\n      form.setValue('externalName', '');\n      form.setValue('email', '');\n      form.setValue('phone', '');\n    } else {\n      form.setValue('memberId', '');\n      setSelectedMember(null);\n      setMemberSearch('');\n      // Auto-navigate to personal tab for external person\n      setActiveTab('personal');\n    }\n  };\n\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit((data) => {\n        // Transform data for backend compatibility\n        const transformedData = {\n          ...data,\n          // Convert Date objects to ISO strings for backend\n          termStart: data.termStart ? data.termStart.toISOString() : undefined,\n          termEnd: data.termEnd ? data.termEnd.toISOString() : undefined,\n        };\n        onSubmit(transformedData);\n      }, (errors) => {\n        // Handle form validation errors - navigate to first tab with errors\n        if (!isEditMode && (errors.linkType || errors.memberId || errors.externalName)) {\n          setActiveTab('linking');\n        } else if (errors.externalName || errors.email || errors.phone) {\n          setActiveTab('personal');\n        } else if (errors.role || errors.termStart || errors.termEnd || errors.status) {\n          setActiveTab('role');\n        } else if (errors.responsibilities || errors.avatarUrl || errors.orderIndex) {\n          setActiveTab('extra');\n        }\n      })} className=\"space-y-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className={`grid w-full ${isEditMode ? 'grid-cols-3' : 'grid-cols-4'}`}>\n            {!isEditMode && (\n              <TabsTrigger value=\"linking\" data-testid=\"tab-linking\" className=\"flex items-center gap-2\">\n                <Link className=\"h-4 w-4\" />\n                Koppeling\n                {hasTabErrors(\"linking\") && <span className=\"text-red-500 ml-1\">•</span>}\n              </TabsTrigger>\n            )}\n            <TabsTrigger value=\"personal\" data-testid=\"tab-personal\" className=\"flex items-center gap-2\">\n              <MdOutlinePermIdentity className=\"h-4 w-4\" />\n              Persoonlijk\n              {hasTabErrors(\"personal\") && <span className=\"text-red-500 ml-1\">•</span>}\n            </TabsTrigger>\n            <TabsTrigger value=\"role\" data-testid=\"tab-role\" className=\"flex items-center gap-2\">\n              <Crown className=\"h-4 w-4\" />\n              Bestuursrol\n              {hasTabErrors(\"role\") && <span className=\"text-red-500 ml-1\">•</span>}\n            </TabsTrigger>\n            <TabsTrigger value=\"extra\" data-testid=\"tab-extra\" className=\"flex items-center gap-2\">\n              <FileText className=\"h-4 w-4\" />\n              Extra\n              {hasTabErrors(\"extra\") && <span className=\"text-red-500 ml-1\">•</span>}\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Tab 1: Koppeling */}\n          <TabsContent value=\"linking\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Koppeling</CardTitle>\n                <CardDescription>Kies of dit een bestaand lid of een externe persoon is</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <FormField\n                  control={form.control}\n                  name=\"linkType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormControl>\n                        <RadioGroup\n                          onValueChange={(value) => {\n                            field.onChange(value);\n                            handleLinkTypeChange(value as 'EXISTING_MEMBER' | 'EXTERNAL_PERSON');\n                          }}\n                          value={field.value}\n                          className=\"space-y-3\"\n                          data-testid=\"radio-link-type\"\n                        >\n                          <div className=\"flex items-center space-x-2\">\n                            <RadioGroupItem value=\"EXISTING_MEMBER\" id=\"existing\" />\n                            <Label htmlFor=\"existing\">Bestaand lid</Label>\n                          </div>\n                          \n                          {linkType === 'EXISTING_MEMBER' && (\n                            <div className=\"ml-6 mt-3 space-y-3\">\n                              <div className=\"relative\">\n                                <Input\n                                  placeholder=\"Zoek op naam of lidnummer...\"\n                                  value={memberSearch}\n                                  onChange={(e) => setMemberSearch(e.target.value)}\n                                  className=\"pr-10\"\n                                  data-testid=\"input-member-search\"\n                                />\n                                <Search className=\"absolute right-3 top-2.5 h-4 w-4 text-gray-400\" />\n                              </div>\n                              \n                              {memberSearch && memberSearch.length > 1 && (\n                                <div className=\"max-h-60 overflow-y-auto border border-gray-200 rounded-lg bg-white shadow-sm\">\n                                  {filteredMembers && filteredMembers.length > 0 ? (\n                                    <div className=\"p-2 space-y-1\">\n                                      {filteredMembers.map((member) => (\n                                        <div\n                                          key={member.id}\n                                          className=\"flex items-center gap-3 p-3 hover:bg-blue-50 cursor-pointer rounded-lg transition-colors duration-150 border border-transparent hover:border-blue-200\"\n                                          onClick={() => handleMemberSelect(member)}\n                                          data-testid={`member-option-${member.id}`}\n                                        >\n                                          <div className=\"flex-shrink-0\">\n                                            <div className=\"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-medium text-sm\">\n                                              {member.firstName.charAt(0)}{member.lastName.charAt(0)}\n                                            </div>\n                                          </div>\n                                          <div className=\"flex-1 min-w-0\">\n                                            <div className=\"font-medium text-gray-900 truncate text-sm\">\n                                              {member.firstName} {member.lastName}\n                                            </div>\n                                            <div className=\"flex items-center gap-2 text-sm text-gray-500\">\n                                              <span className=\"inline-flex items-center gap-1\">\n                                                <User className=\"h-3 w-3\" />\n                                                #{member.memberNumber}\n                                              </span>\n                                              {member.email && (\n                                                <span className=\"inline-flex items-center gap-1 truncate\">\n                                                  <Mail className=\"h-3 w-3\" />\n                                                  {member.email}\n                                                </span>\n                                              )}\n                                            </div>\n                                          </div>\n                                          <div className=\"flex-shrink-0 text-blue-500\">\n                                            <User className=\"h-4 w-4\" />\n                                          </div>\n                                        </div>\n                                      ))}\n                                    </div>\n                                  ) : (\n                                    <div className=\"p-6 text-center\">\n                                      <UserCircle className=\"h-12 w-12 text-gray-300 mx-auto mb-2\" />\n                                      <p className=\"text-gray-500 font-medium\">Geen leden gevonden</p>\n                                      <p className=\"text-sm text-gray-400 mt-1\">Probeer een andere zoekopdracht</p>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                              \n                              {selectedMember && (\n                                <div className=\"p-4 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg shadow-sm\">\n                                  <div className=\"flex items-center gap-3\">\n                                    <div className=\"flex-shrink-0\">\n                                      <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white font-medium\">\n                                        {selectedMember.firstName.charAt(0)}{selectedMember.lastName.charAt(0)}\n                                      </div>\n                                    </div>\n                                    <div className=\"flex-1 min-w-0\">\n                                      <div className=\"font-semibold text-blue-900 text-base\">\n                                        {selectedMember.firstName} {selectedMember.lastName}\n                                      </div>\n                                      <div className=\"flex items-center gap-4 text-sm text-blue-700 mt-1\">\n                                        <span className=\"inline-flex items-center gap-1\">\n                                          <User className=\"h-4 w-4\" />\n                                          Lidnummer #{selectedMember.memberNumber}\n                                        </span>\n                                        {selectedMember.email && (\n                                          <span className=\"inline-flex items-center gap-1\">\n                                            <Mail className=\"h-4 w-4\" />\n                                            {selectedMember.email}\n                                          </span>\n                                        )}\n                                      </div>\n                                    </div>\n                                    <Button\n                                      type=\"button\"\n                                      variant=\"ghost\"\n                                      size=\"sm\"\n                                      className=\"text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-full h-8 w-8 p-0\"\n                                      onClick={() => {\n                                        setSelectedMember(null);\n                                        setMemberSearch('');\n                                        form.setValue('memberId', '');\n                                      }}\n                                      data-testid=\"button-clear-member\"\n                                    >\n                                      ✕\n                                    </Button>\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                          <div className=\"flex items-center space-x-2\">\n                            <RadioGroupItem value=\"EXTERNAL_PERSON\" id=\"external\" />\n                            <Label htmlFor=\"external\">Externe persoon</Label>\n                          </div>\n                        </RadioGroup>\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Tab 2: Persoonsgegevens */}\n          <TabsContent value=\"personal\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Persoonsgegevens</CardTitle>\n                <CardDescription>\n                  {isEditMode ? \"Persoonlijke informatie (alleen bekijken)\" : \"Vul de persoonlijke gegevens in\"}\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                {isEditMode ? (\n                  /* Edit Mode: Different handling for internal vs external members */\n                  initialData?.memberId ? (\n                    /* Internal member - Read-only display */\n                    <div className=\"space-y-4 text-gray-600\">\n                      {/* Member Info */}\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Naam</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            {`${memberDetails?.firstName || 'Onbekend'} ${memberDetails?.lastName || 'Lid'}`}\n                          </div>\n                        </div>\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Type</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            Intern lid\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-3 gap-4\">\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Lidnummer</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            #{memberDetails?.memberNumber || 'Onbekend'}\n                          </div>\n                        </div>\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Categorie</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            {memberDetails?.category || 'Onbekend'}\n                          </div>\n                        </div>\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Status</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            {memberDetails?.active ? 'Actief' : 'Inactief'}\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">E-mail</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            {memberDetails?.email || 'Niet opgegeven'}\n                          </div>\n                        </div>\n                        <div>\n                          <Label className=\"text-sm font-medium text-gray-500\">Telefoon</Label>\n                          <div className=\"mt-1 p-2 bg-gray-50 rounded border text-gray-700\">\n                            {memberDetails?.phone || 'Niet opgegeven'}\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n                        <p className=\"text-sm text-blue-800\">\n                          💡 Persoonlijke gegevens van interne leden kunnen alleen via het lidmaatschap worden aangepast.\n                        </p>\n                      </div>\n                    </div>\n                  ) : (\n                    /* External person - Editable fields */\n                    <div className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"externalName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Naam *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"Volledige naam\"\n                                data-testid=\"input-external-name-edit\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>E-mail</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"email\"\n                                placeholder=\"naam@voorbeeld.com\"\n                                data-testid=\"input-external-email-edit\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"phone\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Telefoon</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"+32 123 456 789\"\n                                data-testid=\"input-external-phone-edit\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n                  )\n                ) : (\n                  /* Add Mode: Normal form fields */\n                  linkType === 'EXISTING_MEMBER' ? (\n                    selectedMember ? (\n                      /* Show selected member info (prefilled and greyed out) */\n                      <div className=\"space-y-4 text-gray-600\">\n                        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n                          <div className=\"flex items-center gap-2 text-green-800 mb-2\">\n                            <User className=\"w-4 h-4\" />\n                            <span className=\"font-medium\">Geselecteerd lid</span>\n                          </div>\n                          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                            <div>\n                              <span className=\"text-gray-500\">Naam</span>\n                              <p className=\"font-medium\">{selectedMember.firstName} {selectedMember.lastName}</p>\n                            </div>\n                            <div>\n                              <span className=\"text-gray-500\">Lidnummer</span>\n                              <p className=\"font-medium\">#{selectedMember.memberNumber}</p>\n                            </div>\n                            <div>\n                              <span className=\"text-gray-500\">Categorie</span>\n                              <p className=\"font-medium\">{selectedMember.category}</p>\n                            </div>\n                            <div>\n                              <span className=\"text-gray-500\">Status</span>\n                              <p className=\"font-medium\">{selectedMember.active ? 'Actief' : 'Inactief'}</p>\n                            </div>\n                            <div>\n                              <span className=\"text-gray-500\">E-mail</span>\n                              <p className=\"font-medium\">{selectedMember.email || 'Niet opgegeven'}</p>\n                            </div>\n                            <div>\n                              <span className=\"text-gray-500\">Telefoon</span>\n                              <p className=\"font-medium\">{selectedMember.phone || 'Niet opgegeven'}</p>\n                            </div>\n                          </div>\n                          <div className=\"mt-3 flex gap-2\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setActiveTab('role')}\n                              className=\"px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700\"\n                            >\n                              Ga naar Bestuursrol →\n                            </button>\n                            <button\n                              type=\"button\"\n                              onClick={() => {\n                                setSelectedMember(null);\n                                setMemberSearch('');\n                                form.setValue('memberId', '');\n                              }}\n                              className=\"px-3 py-2 bg-gray-600 text-white text-sm rounded hover:bg-gray-700\"\n                            >\n                              Ander lid kiezen\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                    ) : (\n                      <>\n                        {/* Member Search */}\n                        <div className=\"space-y-2\">\n                          <Label htmlFor=\"member-search\">Zoek lid</Label>\n                          <div className=\"relative\">\n                            <Input\n                              id=\"member-search\"\n                              placeholder=\"Zoek op naam of lidnummer (bijv. Ahmed Hassan of #0004)...\"\n                              value={memberSearch}\n                              onChange={(e) => setMemberSearch(e.target.value)}\n                              data-testid=\"input-member-search\"\n                            />\n                            {memberSearch.length > 1 && filteredMembers && filteredMembers.length > 0 && (\n                              <div className=\"absolute z-10 w-full bg-white border border-gray-200 rounded-md shadow-lg mt-1 max-h-40 overflow-y-auto\">\n                                {filteredMembers.map((member: any) => (\n                                  <button\n                                    key={member.id}\n                                    type=\"button\"\n                                    className=\"w-full px-3 py-2 text-left hover:bg-gray-50 border-b last:border-b-0\"\n                                    onClick={() => handleMemberSelect(member)}\n                                    data-testid={`option-member-${member.id}`}\n                                  >\n                                    <div className=\"font-medium\">{member.firstName} {member.lastName}</div>\n                                    <div className=\"text-sm text-gray-500\">#{member.memberNumber} • {member.category}</div>\n                                  </button>\n                                ))}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        {memberSearch.length > 1 && filteredMembers && filteredMembers.length === 0 && (\n                          <div className=\"text-sm text-gray-500 italic\">\n                            Geen leden gevonden voor \"{memberSearch}\"\n                          </div>\n                        )}\n                      </>\n                    )\n                  ) : (\n                    <>\n                      {/* External Person Fields */}\n                      <FormField\n                        control={form.control}\n                        name=\"externalName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Naam *</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"Volledige naam\"\n                                data-testid=\"input-external-name\"\n                                onBlur={(e) => {\n                                  field.onBlur();\n                                  // Auto navigate to role tab if name is filled\n                                  if (e.target.value.trim()) {\n                                    setTimeout(() => setActiveTab('role'), 500);\n                                  }\n                                }}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"email\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>E-mail</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                type=\"email\"\n                                placeholder=\"naam@voorbeeld.com\"\n                                data-testid=\"input-external-email\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"phone\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Telefoon</FormLabel>\n                            <FormControl>\n                              <Input \n                                {...field} \n                                placeholder=\"+32 123 456 789\"\n                                data-testid=\"input-external-phone\"\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </>\n                  )\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Tab 3: Bestuursrol */}\n          <TabsContent value=\"role\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Bestuursrol</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"role\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Rol</FormLabel>\n                      <Select \n                        onValueChange={field.onChange} \n                        defaultValue={field.value}\n                        data-testid=\"select-role\"\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Selecteer een rol\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"BESTUURSLID\">Gewoon Bestuurslid</SelectItem>\n                          <SelectItem value=\"VOORZITTER\">Voorzitter</SelectItem>\n                          <SelectItem value=\"VICE_VOORZITTER\">Vice-voorzitter</SelectItem>\n                          <SelectItem value=\"SECRETARIS\">Secretaris</SelectItem>\n                          <SelectItem value=\"PENNINGMEESTER\">Penningmeester</SelectItem>\n                          <SelectItem value=\"ANDERS\">Anders</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {/* Custom role field when \"ANDERS\" is selected */}\n                {form.watch(\"role\") === \"ANDERS\" && (\n                  <FormField\n                    control={form.control}\n                    name=\"customRole\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Aangepaste rol</FormLabel>\n                        <FormControl>\n                          <Input \n                            {...field} \n                            placeholder=\"Bijv. Coördinator, Adviseur, ...\"\n                            data-testid=\"input-custom-role\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"termStart\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Startdatum *</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Input\n                              value={field.value ? format(field.value, \"dd/MM/yyyy\", { locale: nl }) : \"\"}\n                              onChange={(e) => {\n                                const inputValue = e.target.value.trim();\n                                \n                                // Handle 8-digit numeric input: 04061993 -> 04/06/1993\n                                if (/^\\d{8}$/.test(inputValue)) {\n                                  const day = inputValue.substring(0, 2);\n                                  const month = inputValue.substring(2, 4);\n                                  const year = inputValue.substring(4, 8);\n                                  \n                                  const dayNum = parseInt(day);\n                                  const monthNum = parseInt(month);\n                                  const yearNum = parseInt(year);\n                                  \n                                  // Validate date components\n                                  if (dayNum >= 1 && dayNum <= 31 && monthNum >= 1 && monthNum <= 12 && yearNum >= 1900 && yearNum <= 2100) {\n                                    const date = new Date(yearNum, monthNum - 1, dayNum);\n                                    // Check if the date is valid (handles things like Feb 30)\n                                    if (date.getFullYear() === yearNum && date.getMonth() === monthNum - 1 && date.getDate() === dayNum) {\n                                      field.onChange(date);\n                                      return;\n                                    }\n                                  }\n                                }\n                                \n                                // Handle formatted input (DD/MM/YYYY)\n                                if (inputValue.includes('/')) {\n                                  const parts = inputValue.split('/');\n                                  if (parts.length === 3) {\n                                    const [day, month, year] = parts;\n                                    if (day && month && year && year.length === 4) {\n                                      const dayNum = parseInt(day);\n                                      const monthNum = parseInt(month);\n                                      const yearNum = parseInt(year);\n                                      \n                                      if (dayNum >= 1 && dayNum <= 31 && monthNum >= 1 && monthNum <= 12) {\n                                        const date = new Date(yearNum, monthNum - 1, dayNum);\n                                        if (date.getFullYear() === yearNum && date.getMonth() === monthNum - 1 && date.getDate() === dayNum) {\n                                          field.onChange(date);\n                                        }\n                                      }\n                                    }\n                                  }\n                                }\n                              }}\n                              placeholder=\"DD/MM/YYYY\"\n                              className=\"pr-10 border-gray-200\"\n                              data-testid=\"input-term-start\"\n                              maxLength={10}\n                            />\n                            <Popover>\n                              <PopoverTrigger asChild>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  type=\"button\"\n                                  className=\"absolute right-2 top-2 h-6 w-6 p-1 hover:bg-transparent hover:scale-100 focus:bg-transparent active:bg-transparent transition-none transform-none\"\n                                >\n                                  <CalendarIcon className=\"h-4 w-4\" />\n                                </Button>\n                              </PopoverTrigger>\n                              <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                                <div className=\"p-3 border-b\">\n                                  <div className=\"flex items-center justify-between space-x-2\">\n                                    <Select\n                                      value={field.value ? field.value.getMonth().toString() : \"\"}\n                                      onValueChange={(month) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(currentDate.getFullYear(), parseInt(month), Math.min(currentDate.getDate(), new Date(currentDate.getFullYear(), parseInt(month) + 1, 0).getDate()));\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[120px] h-8\">\n                                        <SelectValue placeholder=\"Maand\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 12 }, (_, i) => (\n                                          <SelectItem key={i} value={i.toString()}>\n                                            {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                          </SelectItem>\n                                        ))}\n                                      </SelectContent>\n                                    </Select>\n                                    <Select\n                                      value={field.value ? field.value.getFullYear().toString() : \"\"}\n                                      onValueChange={(year) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(parseInt(year), currentDate.getMonth(), Math.min(currentDate.getDate(), new Date(parseInt(year), currentDate.getMonth() + 1, 0).getDate()));\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[80px] h-8\">\n                                        <SelectValue placeholder=\"Jaar\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 100 }, (_, i) => {\n                                          const year = new Date().getFullYear() + 10 - i;\n                                          return (\n                                            <SelectItem key={year} value={year.toString()}>\n                                              {year}\n                                            </SelectItem>\n                                          );\n                                        })}\n                                      </SelectContent>\n                                    </Select>\n                                  </div>\n                                </div>\n                                <Calendar\n                                  mode=\"single\"\n                                  selected={field.value}\n                                  onSelect={field.onChange}\n                                  month={field.value || new Date()}\n                                  initialFocus\n                                  locale={nl}\n                                  classNames={{\n                                    months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n                                    month: \"space-y-4\",\n                                    caption: \"flex justify-center pt-1 relative items-center\",\n                                    caption_label: \"text-sm font-medium\",\n                                    nav: \"space-x-1 flex items-center\",\n                                    nav_button: cn(\n                                      \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n                                    ),\n                                    nav_button_previous: \"absolute left-1\",\n                                    nav_button_next: \"absolute right-1\",\n                                    table: \"w-full border-collapse space-y-1\",\n                                    head_row: \"flex\",\n                                    head_cell: \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n                                    row: \"flex w-full mt-2\",\n                                    cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n                                    day: cn(\"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"),\n                                    day_range_end: \"day-range-end\",\n                                    day_selected: \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                                    day_today: \"bg-accent text-accent-foreground\",\n                                    day_outside: \"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\n                                    day_disabled: \"text-muted-foreground opacity-50\",\n                                    day_range_middle: \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n                                    day_hidden: \"invisible\",\n                                  }}\n                                />\n                              </PopoverContent>\n                            </Popover>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"termEnd\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Einddatum *</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Input\n                              value={field.value ? format(field.value, \"dd/MM/yyyy\", { locale: nl }) : \"\"}\n                              onChange={(e) => {\n                                const inputValue = e.target.value.trim();\n                                \n                                // Handle 8-digit numeric input: 31122025 -> 31/12/2025\n                                if (/^\\d{8}$/.test(inputValue)) {\n                                  const day = inputValue.substring(0, 2);\n                                  const month = inputValue.substring(2, 4);\n                                  const year = inputValue.substring(4, 8);\n                                  \n                                  const dayNum = parseInt(day);\n                                  const monthNum = parseInt(month);\n                                  const yearNum = parseInt(year);\n                                  \n                                  // Validate date components\n                                  if (dayNum >= 1 && dayNum <= 31 && monthNum >= 1 && monthNum <= 12 && yearNum >= 1900 && yearNum <= 2100) {\n                                    const date = new Date(yearNum, monthNum - 1, dayNum);\n                                    // Check if the date is valid (handles things like Feb 30)\n                                    if (date.getFullYear() === yearNum && date.getMonth() === monthNum - 1 && date.getDate() === dayNum) {\n                                      field.onChange(date);\n                                      return;\n                                    }\n                                  }\n                                }\n                                \n                                // Handle formatted input (DD/MM/YYYY)\n                                if (inputValue.includes('/')) {\n                                  const parts = inputValue.split('/');\n                                  if (parts.length === 3) {\n                                    const [day, month, year] = parts;\n                                    if (day && month && year && year.length === 4) {\n                                      const dayNum = parseInt(day);\n                                      const monthNum = parseInt(month);\n                                      const yearNum = parseInt(year);\n                                      \n                                      if (dayNum >= 1 && dayNum <= 31 && monthNum >= 1 && monthNum <= 12) {\n                                        const date = new Date(yearNum, monthNum - 1, dayNum);\n                                        if (date.getFullYear() === yearNum && date.getMonth() === monthNum - 1 && date.getDate() === dayNum) {\n                                          field.onChange(date);\n                                        }\n                                      }\n                                    }\n                                  }\n                                }\n                              }}\n                              placeholder=\"DD/MM/YYYY\"\n                              className=\"pr-10 border-gray-200\"\n                              data-testid=\"input-term-end\"\n                              maxLength={10}\n                            />\n                            <Popover>\n                              <PopoverTrigger asChild>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"sm\"\n                                  type=\"button\"\n                                  className=\"absolute right-2 top-2 h-6 w-6 p-1 hover:bg-transparent hover:scale-100 focus:bg-transparent active:bg-transparent transition-none transform-none\"\n                                >\n                                  <CalendarIcon className=\"h-4 w-4\" />\n                                </Button>\n                              </PopoverTrigger>\n                              <PopoverContent className=\"w-auto p-0\" align=\"start\" side=\"bottom\">\n                                <div className=\"p-3 border-b\">\n                                  <div className=\"flex items-center justify-between space-x-2\">\n                                    <Select\n                                      value={field.value ? field.value.getMonth().toString() : \"\"}\n                                      onValueChange={(month) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(currentDate.getFullYear(), parseInt(month), Math.min(currentDate.getDate(), new Date(currentDate.getFullYear(), parseInt(month) + 1, 0).getDate()));\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[120px] h-8\">\n                                        <SelectValue placeholder=\"Maand\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 12 }, (_, i) => (\n                                          <SelectItem key={i} value={i.toString()}>\n                                            {format(new Date(2000, i, 1), \"MMMM\", { locale: nl })}\n                                          </SelectItem>\n                                        ))}\n                                      </SelectContent>\n                                    </Select>\n                                    <Select\n                                      value={field.value ? field.value.getFullYear().toString() : \"\"}\n                                      onValueChange={(year) => {\n                                        const currentDate = field.value || new Date();\n                                        const newDate = new Date(parseInt(year), currentDate.getMonth(), Math.min(currentDate.getDate(), new Date(parseInt(year), currentDate.getMonth() + 1, 0).getDate()));\n                                        field.onChange(newDate);\n                                      }}\n                                    >\n                                      <SelectTrigger className=\"w-[80px] h-8\">\n                                        <SelectValue placeholder=\"Jaar\" />\n                                      </SelectTrigger>\n                                      <SelectContent>\n                                        {Array.from({ length: 100 }, (_, i) => {\n                                          const year = new Date().getFullYear() + 10 - i;\n                                          return (\n                                            <SelectItem key={year} value={year.toString()}>\n                                              {year}\n                                            </SelectItem>\n                                          );\n                                        })}\n                                      </SelectContent>\n                                    </Select>\n                                  </div>\n                                </div>\n                                <Calendar\n                                  mode=\"single\"\n                                  selected={field.value}\n                                  onSelect={field.onChange}\n                                  month={field.value || new Date()}\n                                  initialFocus\n                                  locale={nl}\n                                  disabled={(date) => {\n                                    const startDate = form.getValues('termStart');\n                                    if (startDate) {\n                                      // Einddatum moet na startdatum liggen\n                                      return date <= startDate;\n                                    }\n                                    return false;\n                                  }}\n                                  classNames={{\n                                    months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n                                    month: \"space-y-4\",\n                                    caption: \"flex justify-center pt-1 relative items-center\",\n                                    caption_label: \"text-sm font-medium\",\n                                    nav: \"space-x-1 flex items-center\",\n                                    nav_button: cn(\n                                      \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n                                    ),\n                                    nav_button_previous: \"absolute left-1\",\n                                    nav_button_next: \"absolute right-1\",\n                                    table: \"w-full border-collapse space-y-1\",\n                                    head_row: \"flex\",\n                                    head_cell: \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n                                    row: \"flex w-full mt-2\",\n                                    cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n                                    day: cn(\"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"),\n                                    day_range_end: \"day-range-end\",\n                                    day_selected: \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                                    day_today: \"bg-accent text-accent-foreground\",\n                                    day_outside: \"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\n                                    day_disabled: \"text-muted-foreground opacity-50\",\n                                    day_range_middle: \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n                                    day_hidden: \"invisible\",\n                                  }}\n                                />\n                              </PopoverContent>\n                            </Popover>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <FormField\n                  control={form.control}\n                  name=\"status\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Status</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-status\">\n                            <SelectValue placeholder=\"Selecteer status\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"ACTIEF\">Actief</SelectItem>\n                          <SelectItem value=\"INACTIEF\">Inactief</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Tab 4: Extra informatie */}\n          <TabsContent value=\"extra\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Extra informatie</CardTitle>\n                <CardDescription>Optionele informatie over taken en verantwoordelijkheden</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"responsibilities\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Verantwoordelijkheden / Takenpakket</FormLabel>\n                      <FormControl>\n                        <Textarea \n                          {...field} \n                          placeholder=\"Beschrijf de hoofdtaken en verantwoordelijkheden...\"\n                          className=\"min-h-[100px]\"\n                          data-testid=\"textarea-responsibilities\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n\n        {/* Action Buttons */}\n        <div className=\"flex justify-end gap-2 pt-4\">\n          <Button \n            type=\"button\" \n            variant=\"outline\" \n            onClick={onCancel}\n            data-testid=\"button-cancel-form\"\n          >\n            Annuleren\n          </Button>\n          <Button \n            type=\"submit\" \n            disabled={isLoading}\n            data-testid=\"button-submit-form\"\n          >\n{isLoading ? \"Opslaan...\" : (initialData ? \"Opslaan\" : \"Bestuurslid Toevoegen\")}\n          </Button>\n        </div>\n      </form>\n    </Form>\n  );\n}","size_bytes":61953},"client/src/pages/berichten.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Mail, Plus, Send, Users, Eye, Settings, Ban, Edit, Play, TestTube, ChevronDown, ChevronRight, AlertTriangle, Calendar, Megaphone, Trash2 } from \"lucide-react\";\n\nimport { PiPuzzlePiece, PiHandWaving } from \"react-icons/pi\";\nimport { CgTemplate } from \"react-icons/cg\";\nimport { MdEvent } from \"react-icons/md\";\nimport { LuSend, LuLogs, LuPartyPopper, LuBellRing } from \"react-icons/lu\";\nimport { TbHandStop, TbClockExclamation } from \"react-icons/tb\";\nimport { GrGroup } from \"react-icons/gr\";\nimport { FaArrowsDownToPeople } from \"react-icons/fa6\";\n\n// Function to convert plain text to professional HTML\nfunction convertToHTML(plainText: string): string {\n  if (!plainText?.trim()) return \"\";\n  \n  const baseStyle = `\n  <html>\n  <head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <style>\n      body { font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9f9f9; }\n      .email-container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n      .content p { margin: 0 0 15px 0; }\n      .highlight { background-color: #f8f9fa; padding: 15px; border-left: 4px solid #007bff; margin: 20px 0; border-radius: 0 4px 4px 0; }\n      .expired-amount { background-color: #fef2f2; padding: 15px; border-left: 4px solid #dc2626; margin: 20px 0; border-radius: 0 4px 4px 0; }\n      .expired-amount p { color: #991b1b; font-weight: 500; }\n      .footer { text-align: center; padding-top: 20px; border-top: 1px solid #e0e0e0; margin-top: 25px; color: #666; font-size: 14px; }\n      .button { display: inline-block; background-color: #007bff; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; margin: 10px 0; }\n    </style>\n  </head>\n  <body>\n    <div class=\"email-container\">\n      <div class=\"content\">\n`;\n  \n  // Convert plain text to HTML paragraphs\n  const htmlContent = plainText\n    .split('\\n\\n') // Split into paragraphs\n    .filter(p => p.trim()) // Remove empty paragraphs\n    .map(paragraph => {\n      const trimmed = paragraph.trim();\n      // Handle Handlebars variables and links\n      if (trimmed.includes('{{') || trimmed.includes('http')) {\n        // Special formatting for links or variables\n        if (trimmed.includes('http') || trimmed.includes('{{card.url}}')) {\n          return `        <div class=\"highlight\">\n          <p>${trimmed}</p>\n        </div>`;\n        }\n      }\n      // Red highlighting for expired fee amounts and totals\n      if (trimmed.includes('€') && (trimmed.includes('{{#each member.fees.expired}}') || trimmed.includes('{{member.fees.totalExpiredAmount}}') || trimmed.includes('Totaal vervallen bedrag'))) {\n        return `        <div class=\"expired-amount\">\n        <p>${trimmed}</p>\n      </div>`;\n      }\n      \n      // Red highlighting for VERVALLEN BEDRAGEN section\n      if (trimmed.includes('VERVALLEN BEDRAGEN') || (trimmed.includes('{{#each vervallenFees}}') || trimmed.includes('vervallenFees'))) {\n        return `        <div class=\"expired-amount\">\n        <p>${trimmed}</p>\n      </div>`;\n      }\n      \n      // Yellow/orange highlighting for OPENSTAANDE BEDRAGEN section  \n      if (trimmed.includes('OPENSTAANDE BEDRAGEN') || trimmed.includes('{{#each openstaandeFees}}')) {\n        return `        <div style=\"background-color: #fef3c7; padding: 15px; border-left: 4px solid #f59e0b; margin: 20px 0; border-radius: 0 4px 4px 0;\">\n        <p style=\"color: #92400e; font-weight: 500;\">${trimmed}</p>\n      </div>`;\n      }\n      \n      // Green highlighting for BETAALDE BEDRAGEN section\n      if (trimmed.includes('BETAALDE BEDRAGEN') || trimmed.includes('{{#each betaaldeFees}}')) {\n        return `        <div style=\"background-color: #d1fae5; padding: 15px; border-left: 4px solid #10b981; margin: 20px 0; border-radius: 0 4px 4px 0;\">\n        <p style=\"color: #065f46; font-weight: 500;\">${trimmed}</p>\n      </div>`;\n      }\n      return `        <p>${trimmed}</p>`;\n    })\n    .join('\\n');\n  \n  const footer = `\n      </div>\n    </div>\n  </body>\n  </html>`;\n  \n  return baseStyle + htmlContent + footer;\n}\n\nfunction convertToPlainText(content: string): string {\n  if (!content?.trim()) return \"\";\n  \n  // Add professional plain text formatting\n  const lines = content\n    .split('\\n\\n')\n    .filter(p => p.trim())\n    .join('\\n\\n');\n    \n  return lines;\n}\n\n// Form schemas\nconst templateSchema = z.object({\n  name: z.string().min(1, \"Naam is verplicht\"),\n  code: z.string().min(1, \"Code is verplicht\"),\n  subject: z.string().min(1, \"Onderwerp is verplicht\"),\n  content: z.string().min(1, \"Inhoud is verplicht\")\n});\n\nconst segmentSchema = z.object({\n  name: z.string().min(1, \"Naam is verplicht\"),\n  rules: z.object({\n    memberActive: z.boolean().optional(),\n    category: z.array(z.string()).optional(),\n    city: z.string().optional(),\n    postalCode: z.string().optional(),\n    gender: z.string().optional(),\n    hasVotingRights: z.boolean().optional(),\n    minAge: z.number().optional(),\n    maxAge: z.number().optional()\n  })\n});\n\n\nexport default function Berichten() {\n  const [activeTab, setActiveTab] = useState(\"templates\");\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n\n  // Check if user has write permissions (not MEDEWERKER)\n  const canEdit = user?.role !== 'MEDEWERKER';\n\n  // Dialog states\n  const [showTemplateDialog, setShowTemplateDialog] = useState(false);\n  const [showSegmentDialog, setShowSegmentDialog] = useState(false);\n  const [showPreviewDialog, setShowPreviewDialog] = useState(false);\n  const [showMappingTool, setShowMappingTool] = useState(false);\n  const [showVariablesHelper, setShowVariablesHelper] = useState(false);\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n  const [editingTemplate, setEditingTemplate] = useState<any>(null);\n  const [editingSegment, setEditingSegment] = useState<any>(null);\n  const [previewTemplate, setPreviewTemplate] = useState<any>(null);\n  const [previewSegment, setPreviewSegment] = useState<any>(null);\n  const [showSegmentPreviewDialog, setShowSegmentPreviewDialog] = useState(false);\n  const [showDeleteSegmentDialog, setShowDeleteSegmentDialog] = useState(false);\n  const [segmentToDelete, setSegmentToDelete] = useState<any>(null);\n  const [templateToDelete, setTemplateToDelete] = useState<any>(null);\n  // Email Composer State\n  const [emailRecipients, setEmailRecipients] = useState<Array<{type: 'member' | 'segment' | 'email', label: string, value: string}>>([]);\n  const [emailSubject, setEmailSubject] = useState(\"\");\n  const [emailContent, setEmailContent] = useState(\"\");\n  const [selectedTemplateForComposer, setSelectedTemplateForComposer] = useState<any>(null);\n  const [recipientInput, setRecipientInput] = useState(\"\");\n  const [showRecipientSuggestions, setShowRecipientSuggestions] = useState(false);\n  const [originalTemplateData, setOriginalTemplateData] = useState<any>(null);\n  // Send Template State (missing variables)\n  const [sendTemplateCode, setSendTemplateCode] = useState(\"\");\n  const [sendRecipient, setSendRecipient] = useState(\"\");\n\n  // Fetch data for each tab\n  const { data: templatesData, isLoading: templatesLoading } = useQuery({\n    queryKey: [\"/api/messages/templates\"],\n    refetchOnWindowFocus: false,\n    refetchOnReconnect: false,\n    refetchOnMount: 'always',\n    staleTime: 0,\n    gcTime: 0,\n    select: (rows: any[]) => {\n      const seen = new Set<string>();\n      return rows.filter((r: any) => {\n        const k = `${r.tenantId}:${r.id}`;\n        if (seen.has(k)) return false;\n        seen.add(k);\n        return true;\n      });\n    },\n  });\n\n  // Use templates directly from query select deduplication\n  const templates = templatesData ?? [];\n\n\n  const { data: segments, isLoading: segmentsLoading } = useQuery({\n    queryKey: [\"/api/messages/segments\"],\n    staleTime: 10000,\n  });\n\n  // Fetch members for recipient autocomplete\n  const { data: members } = useQuery({\n    queryKey: [\"/api/members\"],\n    enabled: activeTab === \"send\",\n    staleTime: 10000,\n  });\n\n\n  // Forms\n  const templateForm = useForm({\n    resolver: zodResolver(templateSchema),\n    defaultValues: {\n      name: \"\",\n      code: \"\",\n      subject: \"\",\n      content: \"\"\n    }\n  });\n\n  const segmentForm = useForm({\n    resolver: zodResolver(segmentSchema),\n    defaultValues: {\n      name: \"\",\n      rules: {\n        memberActive: true,\n        category: [],\n        city: \"\",\n        postalCode: \"\",\n        gender: \"\",\n        hasVotingRights: undefined,\n        minAge: undefined,\n        maxAge: undefined\n      }\n    }\n  });\n\n\n  // Mutations\n  const createTemplateMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof templateSchema>) => {\n      return apiRequest(\"POST\", \"/api/messages/templates\", {\n        name: data.name,\n        code: data.code,\n        kind: \"TRANSACTIONEEL\", // Standaard waarde sinds type niet meer relevant is\n        subject: data.subject,\n        body_html: convertToHTML(data.content),\n        body_text: convertToPlainText(data.content),\n        content: data.content\n      });\n    },\n    onSuccess: () => {\n      // Invalidate and refetch templates\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/templates\"] });\n      toast({ title: \"Template aangemaakt\", description: \"De template is succesvol aangemaakt.\" });\n      setShowTemplateDialog(false);\n      setOriginalTemplateData(null);\n      templateForm.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij aanmaken template\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const updateTemplateMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: z.infer<typeof templateSchema> }) => {\n      const payload = {\n        name: data.name,\n        code: data.code,\n        kind: \"TRANSACTIONEEL\", // Standaard waarde sinds type niet meer relevant is\n        subject: data.subject,\n        body_html: convertToHTML(data.content),\n        body_text: convertToPlainText(data.content),\n        content: data.content\n      };\n      return apiRequest(\"PUT\", `/api/messages/templates/${id}`, payload);\n    },\n    onSuccess: (result) => {\n      // Invalidate and refetch templates\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/templates\"] });\n      toast({ title: \"Template bijgewerkt\", description: \"De template is succesvol bijgewerkt.\" });\n      setShowTemplateDialog(false);\n      setEditingTemplate(null);\n      setOriginalTemplateData(null);\n      templateForm.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij bijwerken template\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const deleteTemplateMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/messages/templates/${id}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch templates\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/templates\"] });\n      toast({ title: \"Template verwijderd\", description: \"De template is succesvol verwijderd.\" });\n      setShowDeleteDialog(false);\n      setTemplateToDelete(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij verwijderen template\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const deleteSegmentMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return apiRequest(\"DELETE\", `/api/messages/segments/${id}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch segments\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/segments\"] });\n      toast({ title: \"Verzendgroep verwijderd\", description: \"De verzendgroep is succesvol verwijderd.\" });\n      setShowDeleteSegmentDialog(false);\n      setSegmentToDelete(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij verwijderen verzendgroep\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const createSegmentMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof segmentSchema>) => {\n      return apiRequest(\"POST\", \"/api/messages/segments\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/segments\"] });\n      toast({ title: \"Segment aangemaakt\", description: \"Het segment is succesvol aangemaakt.\" });\n      setShowSegmentDialog(false);\n      segmentForm.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij aanmaken segment\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const updateSegmentMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: z.infer<typeof segmentSchema> }) => {\n      return apiRequest(\"PUT\", `/api/messages/segments/${id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/messages/segments\"] });\n      toast({ title: \"Segment bijgewerkt\", description: \"Het segment is succesvol bijgewerkt.\" });\n      setShowSegmentDialog(false);\n      setEditingSegment(null);\n      segmentForm.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij bijwerken segment\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n\n  // Check if template form has changes\n  const hasTemplateChanges = () => {\n    if (!editingTemplate || !originalTemplateData) return false;\n    const currentData = templateForm.getValues();\n    return (\n      currentData.name !== originalTemplateData.name ||\n      currentData.code !== originalTemplateData.code ||\n      currentData.subject !== originalTemplateData.subject ||\n      currentData.content !== originalTemplateData.content\n    );\n  };\n\n  // Handler functions\n  const handleEditTemplate = (template: any) => {\n    setEditingTemplate(template);\n    \n    let content = \"\";\n    \n    // Priority: content field (new format) > text content > simplified HTML\n    if (template.content) {\n      content = template.content;\n    } else {\n      const textContent = template.bodyText || template.body_text || \"\";\n      const htmlContent = template.bodyHtml || template.body_html || \"\";\n      \n      // Use text content if available, otherwise strip HTML tags from HTML content\n      if (textContent) {\n        content = textContent;\n      } else if (htmlContent) {\n        // Simple HTML tag removal for editing\n        content = htmlContent\n          .replace(/<[^>]*>/g, '') // Remove HTML tags\n          .replace(/\\s+/g, ' ') // Normalize whitespace\n          .trim();\n      }\n    }\n    \n    const formData = {\n      name: template.name,\n      code: template.code,\n      subject: template.subject,\n      content: content\n    };\n    \n    templateForm.reset(formData);\n    setOriginalTemplateData(formData); // Store original data for comparison\n    setShowTemplateDialog(true);\n  };\n\n  const handlePreviewTemplate = (template: any) => {\n    // Generate preview content from the stored content or use existing HTML/text\n    let previewData = { ...template };\n    \n    // Always prioritize content field and generate fresh HTML for preview\n    if (template.content) {\n      previewData.bodyHtml = convertToHTML(template.content);\n      previewData.bodyText = convertToPlainText(template.content);\n    } else {\n      // Fallback to existing HTML/text content for old templates\n      previewData.bodyHtml = template.bodyHtml || template.body_html;\n      previewData.bodyText = template.bodyText || template.body_text;\n    }\n    \n    setPreviewTemplate(previewData);\n    setShowPreviewDialog(true);\n  };\n\n  const handleDeleteTemplate = (template: any) => {\n    setTemplateToDelete(template);\n    setShowDeleteDialog(true);\n  };\n\n  const confirmDeleteTemplate = () => {\n    if (templateToDelete) {\n      deleteTemplateMutation.mutate(templateToDelete.id);\n    }\n  };\n\n\n  const handleEditSegment = (segment: any) => {\n    setEditingSegment(segment);\n    segmentForm.reset({\n      name: segment.name,\n      rules: segment.rules || {}\n    });\n    setShowSegmentDialog(true);\n  };\n\n  const handleDeleteSegment = (segment: any) => {\n    setSegmentToDelete(segment);\n    setShowDeleteSegmentDialog(true);\n  };\n\n  const confirmDeleteSegment = () => {\n    if (segmentToDelete) {\n      deleteSegmentMutation.mutate(segmentToDelete.id);\n    }\n  };\n\n  const sendComposedEmailMutation = useMutation({\n    mutationFn: async (data: { recipients: any[], subject: string, content: string }) => {\n      return apiRequest(\"POST\", \"/api/messages/composer/send\", data);\n    },\n    onSuccess: (result) => {\n      toast({\n        title: \"E-mail verzonden\",\n        description: (result as any).message || `E-mail verzonden naar ${(result as any).totalRecipients} geadresseerd(en)`,\n        variant: \"default\"\n      });\n      // Reset form\n      setEmailRecipients([]);\n      setEmailSubject(\"\");\n      setEmailContent(\"\");\n      setSelectedTemplateForComposer(null);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij verzenden\",\n        description: error.message || \"Er is een fout opgetreden bij het verzenden van de e-mail\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleSendComposedEmail = () => {\n    if (!emailSubject || !emailContent || emailRecipients.length === 0) {\n      toast({\n        title: \"Vereiste velden\",\n        description: \"Vul alle velden in: geadresseerden, onderwerp en inhoud\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    \n    sendComposedEmailMutation.mutate({\n      recipients: emailRecipients,\n      subject: emailSubject,\n      content: emailContent\n    });\n  };\n\n  // Autocomplete suggestions for recipients\n  const getRecipientSuggestions = () => {\n    if (!recipientInput.trim()) return [];\n    \n    const suggestions = [];\n    const input = recipientInput.toLowerCase();\n    \n    // Add member suggestions\n    if (members && Array.isArray(members)) {\n      members.forEach((member: any) => {\n        const fullName = `${member.firstName} ${member.lastName}`.toLowerCase();\n        const email = member.email?.toLowerCase() || '';\n        \n        if (fullName.includes(input) || email.includes(input)) {\n          suggestions.push({\n            type: 'member' as const,\n            label: `${member.firstName} ${member.lastName} (${member.email || 'Geen email'})`,\n            value: member.email || member.id,\n            member: member\n          });\n        }\n      });\n    }\n    \n    // Add segment suggestions\n    if (segments && Array.isArray(segments)) {\n      segments.forEach((segment: any) => {\n        if (segment.name.toLowerCase().includes(input)) {\n          suggestions.push({\n            type: 'segment' as const,\n            label: `${segment.name} (Verzendgroep)`,\n            value: segment.id,\n            segment: segment\n          });\n        }\n      });\n    }\n    \n    // Add email suggestion if it looks like an email\n    if (input.includes('@') && input.includes('.')) {\n      suggestions.push({\n        type: 'email' as const,\n        label: `📧 ${recipientInput} (Direct email)`,\n        value: recipientInput,\n      });\n    }\n    \n    return suggestions.slice(0, 10); // Limit to 10 suggestions\n  };\n\n  const addRecipient = (suggestion: any) => {\n    const isDuplicate = emailRecipients.some(r => r.value === suggestion.value);\n    if (!isDuplicate) {\n      setEmailRecipients([...emailRecipients, suggestion]);\n    }\n    setRecipientInput(\"\");\n    setShowRecipientSuggestions(false);\n  };\n\n  const removeRecipient = (index: number) => {\n    const newRecipients = emailRecipients.filter((_, i) => i !== index);\n    setEmailRecipients(newRecipients);\n  };\n\n  const handlePreviewSegment = (segment: any) => {\n    setPreviewSegment(segment);\n    setShowSegmentPreviewDialog(true);\n  };\n\n  const handleNewTemplate = () => {\n    setEditingTemplate(null);\n    setOriginalTemplateData(null);\n    templateForm.reset();\n    setShowTemplateDialog(true);\n  };\n\n  const handleNewSegment = () => {\n    setEditingSegment(null);\n    segmentForm.reset();\n    setShowSegmentDialog(true);\n  };\n\n\n  const onTemplateSubmit = (data: z.infer<typeof templateSchema>) => {\n    console.log('Submitting template with data:', data);\n    if (editingTemplate) {\n      console.log('Updating existing template:', editingTemplate.id);\n      updateTemplateMutation.mutate({ id: editingTemplate.id, data });\n    } else {\n      console.log('Creating new template');\n      createTemplateMutation.mutate(data);\n    }\n  };\n\n  const onSegmentSubmit = (data: z.infer<typeof segmentSchema>) => {\n    console.log('Submitting segment with data:', data);\n    if (editingSegment) {\n      console.log('Updating existing segment:', editingSegment.id);\n      updateSegmentMutation.mutate({ id: editingSegment.id, data });\n    } else {\n      console.log('Creating new segment');\n      createSegmentMutation.mutate(data);\n    }\n  };\n\n\n  // Send single email mutation\n  const sendSingleEmailMutation = useMutation({\n    mutationFn: async ({ templateCode, recipient }: { templateCode: string; recipient: string }) => {\n      return apiRequest(\"POST\", \"/api/messages/send\", {\n        template_code: templateCode,\n        recipient: recipient\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"E-mail verzonden\", description: \"De e-mail is succesvol verzonden.\" });\n      setSendTemplateCode(\"\");\n      setSendRecipient(\"\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Fout bij verzenden e-mail\",\n        description: error.message || \"Er is een fout opgetreden\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleSendSingleEmail = () => {\n    if (!sendTemplateCode || !sendRecipient) {\n      toast({\n        title: \"Invoer vereist\",\n        description: \"Vul zowel template code als ontvanger in\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n    sendSingleEmailMutation.mutate({ templateCode: sendTemplateCode, recipient: sendRecipient });\n  };\n\n  return (\n    <main className=\"flex-1 py-4\">\n      <div className=\"px-4 sm:px-6 lg:px-8 w-full\">\n        {/* Page Header */}\n        <div className=\"border-b border-gray-200 pb-5 mb-6\">\n          <div>\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent tracking-tight\" data-testid=\"page-title\">Berichten</h1>\n            <p className=\"mt-2 text-sm text-gray-600 font-medium\">Beheer e-mail templates, segmenten en campagnes</p>\n          </div>\n        </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-8\">\n        <TabsList className=\"grid grid-cols-3 w-full\" data-testid=\"message-tabs\">\n          <TabsTrigger value=\"templates\" data-testid=\"tab-templates\">\n            <Mail className=\"w-4 h-4 mr-2\" />\n            Templates\n          </TabsTrigger>\n          <TabsTrigger value=\"segments\" data-testid=\"tab-segments\">\n            <FaArrowsDownToPeople className=\"w-4 h-4 mr-2\" />\n            Verzendgroepen\n          </TabsTrigger>\n          <TabsTrigger value=\"send\" data-testid=\"tab-send\">\n            <Send className=\"w-4 h-4 mr-2\" />\n            Verzenden\n          </TabsTrigger>\n        </TabsList>\n\n        {/* Templates Tab */}\n        <TabsContent value=\"templates\" className=\"space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">E-mail Templates</h2>\n              <p className=\"text-sm text-gray-600 mt-1\">Beheer en bewerk je e-mail templates voor automatische berichten</p>\n            </div>\n            {canEdit && (\n              <Button onClick={handleNewTemplate} className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-700\" data-testid=\"button-new-template\">\n                <Plus className=\"w-4 h-4\" />\n                Nieuwe Template\n              </Button>\n            )}\n          </div>\n\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\" data-testid=\"templates-grid\">\n            {templatesLoading ? (\n              Array.from({ length: 6 }).map((_, i) => (\n                <Card key={i} className=\"glass-card animate-pulse\">\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                    <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      <div className=\"h-3 bg-gray-200 rounded w-full\"></div>\n                      <div className=\"h-3 bg-gray-200 rounded w-2/3\"></div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            ) : !templates || !Array.isArray(templates) || templates.length === 0 ? (\n              <div className=\"col-span-full\">\n                <Card className=\"glass-card border-dashed border-2 border-white/30\">\n                  <CardContent className=\"text-center py-16\">\n                    <div className=\"bg-gray-100 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-6\">\n                      <Mail className=\"w-10 h-10 text-gray-400\" />\n                    </div>\n                    <h3 className=\"text-xl font-semibold text-gray-900 mb-3\">Nog geen templates</h3>\n                    <p className=\"text-gray-600 mb-8 max-w-md mx-auto\">Begin met het aanmaken van je eerste e-mail template voor automatische berichten naar leden</p>\n                    {canEdit && (\n                      <Button onClick={handleNewTemplate} size=\"lg\" data-testid=\"button-add-first-template\">\n                        <Plus className=\"w-5 h-5 mr-2\" />\n                        Eerste Template Aanmaken\n                      </Button>\n                    )}\n                  </CardContent>\n                </Card>\n              </div>\n            ) : (\n              <>\n                {/* Actual Templates */}\n                {templates.map((template: any) => {\n                  // Set icon based on template type\n                  let templateIcon = Mail;\n                  \n                  if (template.name?.toLowerCase().includes('welkom') || template.name?.toLowerCase().includes('nieuw') || template.name?.toLowerCase().includes('verwelkoming')) {\n                    templateIcon = PiHandWaving;\n                  } else if (template.name?.toLowerCase().includes('vergadering') || template.name?.toLowerCase().includes('algemene')) {\n                    templateIcon = GrGroup;\n                  }\n                  \n                  const TemplateIcon = templateIcon;\n                  \n                  return (\n                    <Card key={template.id} className=\"glass-card card-hover animate-fade-in group border-0\" data-testid={`card-template-${template.id}`}>\n                      <CardHeader className=\"pb-4\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <TemplateIcon className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid={`text-template-name-${template.id}`}>\n                                {template.name}\n                              </CardTitle>\n                            </div>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <CardDescription className=\"text-gray-700 mb-4\" data-testid={`text-template-subject-${template.id}`}>\n                          {template.subject}\n                        </CardDescription>\n                        <div className=\"flex gap-2\">\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\" \n                            onClick={() => handlePreviewTemplate(template)} \n                            data-testid={`button-preview-${template.id}`}\n                          >\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          {canEdit && (\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\"\n                              onClick={() => handleEditTemplate(template)}\n                              data-testid={`button-edit-${template.id}`}\n                            >\n                              <Edit className=\"w-4 h-4 mr-1\" />\n                              Bewerk\n                            </Button>\n                          )}\n                        </div>\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n                \n                {/* Template Voorbeelden Cards verwijderd - we tonen alleen echte templates */}\n                {false && canEdit && templates.length === 0 && (\n                  <>\n                    {/* Welkomstmail Nieuw Lid Template Card */}\n                    <Card className=\"hover:shadow-lg transition-shadow border-gray-200 bg-gray-50\" data-testid=\"card-template-welcome\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <PiHandWaving className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid=\"text-template-name-welcome\">\n                                Welkomstmail Nieuw Lid\n                              </CardTitle>\n                            </div>\n                            <CardDescription className=\"text-gray-700\" data-testid=\"text-template-subject-welcome\">\n                              Verwelkomingsbericht voor nieuwe leden\n                            </CardDescription>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => {\n                            const welcomeTemplate = {\n                              name: \"Welkomstmail Nieuw Lid\",\n                              code: \"WELCOME_NEW_MEMBER\",\n                              subject: \"Welkom bij {{tenant.name}}\",\n                              content: `Beste {{member.firstName}} {{member.lastName}},\n\nVan harte welkom bij {{tenant.name}}!\n\nWe zijn verheugd u als nieuw lid te verwelkomen in onze gemeenschap.\n\nUw lidgegevens:\n- Lidnummer: {{member.memberNumber}}\n- Categorie: {{member.category}}\n- E-mailadres: {{member.email}}\n\nVoor vragen kunt u altijd contact met ons opnemen via {{tenant.email}} of telefonisch via {{tenant.phone}}.\n\nNogmaals welkom!\n\nMet vriendelijke groet,\n{{tenant.name}}`\n                            };\n                            handlePreviewTemplate(welcomeTemplate);\n                          }} data-testid=\"button-preview-welcome\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => {\n                              setEditingTemplate(null);\n                              templateForm.reset({\n                                name: \"Welkomstmail Nieuw Lid\",\n                                code: \"WELCOME_NEW_MEMBER\",\n                                subject: \"Welkom bij {{tenant.name}}\",\n                                content: `Beste {{member.firstName}} {{member.lastName}},\n\nVan harte welkom bij {{tenant.name}}!\n\nWe zijn verheugd u als nieuw lid te verwelkomen in onze gemeenschap.\n\nUw lidgegevens:\n- Lidnummer: {{member.memberNumber}}\n- Categorie: {{member.category}}\n- E-mailadres: {{member.email}}\n\nVoor vragen kunt u altijd contact met ons opnemen via {{tenant.email}} of telefonisch via {{tenant.phone}}.\n\nNogmaals welkom!\n\nMet vriendelijke groet,\n{{tenant.name}}`\n                              });\n                              setShowTemplateDialog(true);\n                            }}\n                            data-testid=\"button-create-welcome-template\"\n                          >\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    {/* Vervallen Lidgeld Template Card */}\n                    <Card className=\"hover:shadow-lg transition-shadow border-gray-200 bg-gray-50\" data-testid=\"card-template-expired\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <TbClockExclamation className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid=\"text-template-name-expired\">\n                                Vervallen Lidgeld\n                              </CardTitle>\n                            </div>\n                            <CardDescription className=\"text-gray-700\" data-testid=\"text-template-subject-expired\">\n                              Herinnering voor vervallen lidgeld\n                            </CardDescription>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => {\n                            const expiredTemplate = {\n                              name: \"Vervallen Lidgeld\",\n                              code: \"EXPIRED_MEMBERSHIP\",\n                              subject: \"Herinnering vervallen lidgeld - {{tenant.name}}\",\n                              content: `Beste {{member.firstName}} {{member.lastName}},\n\nWe willen u eraan herinneren dat uw lidgeld nog niet is betaald.\n\n{{#if vervallenFees}}\nVERVALLEN BEDRAGEN:\n{{#each vervallenFees}}\n- {{this.description}}: {{currency this.amount}} (vervaldatum: {{date this.dueDate}})\n{{/each}}\n\nTotaal vervallen bedrag: {{currency member.fees.totalExpiredAmount}}\n{{/if}}\n\n{{#if openstaandeFees}}\nOPENSTAANDE BEDRAGEN:\n{{#each openstaandeFees}}\n- {{this.description}}: {{currency this.amount}} (vervaldatum: {{date this.dueDate}})\n{{/each}}\n{{/if}}\n\n{{#if betaaldeFees}}\nBETAALDE BEDRAGEN (ter referentie):\n{{#each betaaldeFees}}\n- {{this.description}}: {{currency this.amount}} (betaald op: {{date this.paidAt}})\n{{/each}}\n{{/if}}\n\nGelieve de openstaande en vervallen bedragen zo spoedig mogelijk te voldoen. Voor vragen over de betaling kunt u contact met ons opnemen.\n\nBetaalgegevens:\nRekeningnummer: [IBAN NUMMER]\nOmschrijving: Lidgeld {{member.memberNumber}}\n\nMet vriendelijke groet,\n{{tenant.name}}`\n                            };\n                            handlePreviewTemplate(expiredTemplate);\n                          }} data-testid=\"button-preview-expired\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => {\n                              setEditingTemplate(null);\n                              templateForm.reset({\n                                name: \"Vervallen Lidgeld\",\n                                code: \"EXPIRED_MEMBERSHIP\",\n                                subject: \"Herinnering vervallen lidgeld - {{tenant.name}}\",\n                                content: `Beste {{member.firstName}} {{member.lastName}},\n\nWe willen u eraan herinneren dat uw lidgeld nog niet is betaald.\n\n{{#if vervallenFees}}\nVERVALLEN BEDRAGEN:\n{{#each vervallenFees}}\n- {{this.description}}: {{currency this.amount}} (vervaldatum: {{date this.dueDate}})\n{{/each}}\n\nTotaal vervallen bedrag: {{currency member.fees.totalExpiredAmount}}\n{{/if}}\n\n{{#if openstaandeFees}}\nOPENSTAANDE BEDRAGEN:\n{{#each openstaandeFees}}\n- {{this.description}}: {{currency this.amount}} (vervaldatum: {{date this.dueDate}})\n{{/each}}\n{{/if}}\n\n{{#if betaaldeFees}}\nBETAALDE BEDRAGEN (ter referentie):\n{{#each betaaldeFees}}\n- {{this.description}}: {{currency this.amount}} (betaald op: {{date this.paidAt}})\n{{/each}}\n{{/if}}\n\nGelieve de openstaande en vervallen bedragen zo spoedig mogelijk te voldoen. Voor vragen over de betaling kunt u contact met ons opnemen.\n\nBetaalgegevens:\nRekeningnummer: [IBAN NUMMER]\nOmschrijving: Lidgeld {{member.memberNumber}}\n\nMet vriendelijke groet,\n{{tenant.name}}`\n                              });\n                              setShowTemplateDialog(true);\n                            }}\n                            data-testid=\"button-create-expired-template\"\n                          >\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    {/* Algemene Vergadering Template Card */}\n                    <Card className=\"hover:shadow-lg transition-shadow border-gray-200 bg-gray-50\" data-testid=\"card-template-assembly\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <GrGroup className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid=\"text-template-name-assembly\">\n                                Uitnodiging Algemene Vergadering\n                              </CardTitle>\n                            </div>\n                            <CardDescription className=\"text-gray-700\" data-testid=\"text-template-subject-assembly\">\n                              Formele uitnodiging voor jaarvergadering\n                            </CardDescription>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => {\n                            const assemblyTemplate = {\n                              name: \"Uitnodiging Algemene Vergadering\",\n                              code: \"GENERAL_ASSEMBLY\",\n                              subject: \"Uitnodiging Algemene Vergadering - {{tenant.name}}\",\n                              content: `Beste {{member.firstName}} {{member.lastName}},\n\nHierbij nodigen wij u uit voor de Algemene Vergadering van {{tenant.name}}.\n\nDatum: [DATUM]\nTijd: [TIJD]\nLocatie: [LOCATIE/ADRES]\n\nAgenda:\n- Opening door de voorzitter\n- Verslag vorige vergadering\n- Jaarverslag bestuur\n- Financieel verslag\n- Verkiezing bestuur\n- Rondvraag\n\nUw aanwezigheid wordt zeer op prijs gesteld. Heeft u vragen of suggesties voor de agenda, dan kunt u contact met ons opnemen.\n\nVoor leden met stemrecht: vergeet niet uw lidkaart mee te nemen.\n\nMet vriendelijke groet,\nHet bestuur van {{tenant.name}}`\n                            };\n                            handlePreviewTemplate(assemblyTemplate);\n                          }} data-testid=\"button-preview-assembly\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => {\n                              setEditingTemplate(null);\n                              templateForm.reset({\n                                name: \"Uitnodiging Algemene Vergadering\",\n                                code: \"GENERAL_ASSEMBLY\",\n                                subject: \"Uitnodiging Algemene Vergadering - {{tenant.name}}\",\n                                content: `Beste {{member.firstName}} {{member.lastName}},\n\nHierbij nodigen wij u uit voor de Algemene Vergadering van {{tenant.name}}.\n\nDatum: [DATUM]\nTijd: [TIJD]\nLocatie: [LOCATIE/ADRES]\n\nAgenda:\n- Opening door de voorzitter\n- Verslag vorige vergadering\n- Jaarverslag bestuur\n- Financieel verslag\n- Verkiezing bestuur\n- Rondvraag\n\nUw aanwezigheid wordt zeer op prijs gesteld. Heeft u vragen of suggesties voor de agenda, dan kunt u contact met ons opnemen.\n\nVoor leden met stemrecht: vergeet niet uw lidkaart mee te nemen.\n\nMet vriendelijke groet,\nHet bestuur van {{tenant.name}}`\n                              });\n                              setShowTemplateDialog(true);\n                            }}\n                            data-testid=\"button-create-assembly-template\"\n                          >\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    {/* Activiteit/Evenement Template Card */}\n                    <Card className=\"hover:shadow-lg transition-shadow border-gray-200 bg-gray-50\" data-testid=\"card-template-activity\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <Megaphone className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid=\"text-template-name-activity\">\n                                Uitnodiging Activiteit/Evenement\n                              </CardTitle>\n                            </div>\n                            <CardDescription className=\"text-gray-700\" data-testid=\"text-template-subject-activity\">\n                              Template voor activiteiten en evenementen\n                            </CardDescription>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => {\n                            const activityTemplate = {\n                              name: \"Uitnodiging Activiteit/Evenement\",\n                              code: \"ACTIVITY_EVENT\",\n                              subject: \"Uitnodiging: [ACTIVITEIT NAAM] - {{tenant.name}}\",\n                              content: `Beste {{member.firstName}} {{member.lastName}},\n\nWe nodigen u graag uit voor onze aankomende activiteit!\n\n🎯 Activiteit: [ACTIVITEIT NAAM]\n📅 Datum: [DATUM]\n🕐 Tijd: [STARTTIJD] - [EINDTIJD]  \n📍 Locatie: [LOCATIE/ADRES]\n\nOver deze activiteit:\n[BESCHRIJVING VAN DE ACTIVITEIT]\n\nPraktische informatie:\n- Kosten: [GRATIS / €X per persoon]\n- Inschrijving vereist: [JA/NEE]\n- Wat meenemen: [ITEMS]\n- Contact voor vragen: {{tenant.email}}\n\nWe hopen u te zien bij deze bijzondere gelegenheid!\n\nHeeft u vragen of speciale wensen? Neem gerust contact met ons op.\n\nMet hartelijke groet,\n{{tenant.name}}`\n                            };\n                            handlePreviewTemplate(activityTemplate);\n                          }} data-testid=\"button-preview-activity\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => {\n                              setEditingTemplate(null);\n                              templateForm.reset({\n                                name: \"Uitnodiging Activiteit/Evenement\",\n                                code: \"ACTIVITY_EVENT\",\n                                subject: \"Uitnodiging: [ACTIVITEIT NAAM] - {{tenant.name}}\",\n                                content: `Beste {{member.firstName}} {{member.lastName}},\n\nWe nodigen u graag uit voor onze aankomende activiteit!\n\n🎯 Activiteit: [ACTIVITEIT NAAM]\n📅 Datum: [DATUM]\n🕐 Tijd: [STARTTIJD] - [EINDTIJD]  \n📍 Locatie: [LOCATIE/ADRES]\n\nOver deze activiteit:\n[BESCHRIJVING VAN DE ACTIVITEIT]\n\nPraktische informatie:\n- Kosten: [GRATIS / €X per persoon]\n- Inschrijving vereist: [JA/NEE]\n- Wat meenemen: [ITEMS]\n- Contact voor vragen: {{tenant.email}}\n\nWe hopen u te zien bij deze bijzondere gelegenheid!\n\nHeeft u vragen of speciale wensen? Neem gerust contact met ons op.\n\nMet hartelijke groet,\n{{tenant.name}}`\n                              });\n                              setShowTemplateDialog(true);\n                            }}\n                            data-testid=\"button-create-activity-template\"\n                          >\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n\n                    {/* Feestbegroeting Template Card */}\n                    <Card className=\"hover:shadow-lg transition-shadow border-gray-200 bg-gray-50\" data-testid=\"card-template-celebration\">\n                      <CardHeader>\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2\">\n                              <LuPartyPopper className=\"w-5 h-5 text-gray-600\" />\n                              <CardTitle className=\"text-base text-gray-900\" data-testid=\"text-template-name-celebration\">\n                                Feestbegroeting\n                              </CardTitle>\n                            </div>\n                            <CardDescription className=\"text-gray-700\" data-testid=\"text-template-subject-celebration\">\n                              Template voor feesten en festiviteiten\n                            </CardDescription>\n                          </div>\n                        </div>\n                      </CardHeader>\n                      <CardContent>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => {\n                            const celebrationTemplate = {\n                              name: \"Feestbegroeting\",\n                              code: \"CELEBRATION\",\n                              subject: \"Uitnodiging: [FESTIVITEIT] - {{tenant.name}}\",\n                              content: `Beste {{member.firstName}} {{member.lastName}},\n\nHet is ons een genoegen u uit te nodigen voor onze festiviteit!\n\n🎉 Gelegenheid: [FESTIVITEIT NAAM]\n📅 Datum: [DATUM]\n🕐 Tijd: [STARTTIJD]\n📍 Locatie: [LOCATIE/ADRES]\n\nProgramma:\n[TIJDSCHEMA VAN DE FESTIVITEIT]\n\nWat kunt u verwachten:\n- [ACTIVITEIT 1]\n- [ACTIVITEIT 2] \n- [ETEN/DRINKEN]\n- [ENTERTAINMENT]\n\nPraktische zaken:\n- Toegang: [GRATIS/BIJDRAGE]\n- Kledingcode: [INFORMEEL/FORMEEL/TRADITIONEEL]\n- Parkeren: [INFORMATIE]\n- Kinderen welkom: [JA/NEE]\n\nVoor catering en organisatie is het fijn als u uw komst bevestigt via {{tenant.email}} of telefonisch.\n\nWe kijken ernaar uit om samen met u te vieren!\n\nMet feestelijke groet,\nHet organisatieteam van {{tenant.name}}`\n                            };\n                            handlePreviewTemplate(celebrationTemplate);\n                          }} data-testid=\"button-preview-celebration\">\n                            <Eye className=\"w-4 h-4 mr-1\" />\n                            Preview\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => {\n                              setEditingTemplate(null);\n                              templateForm.reset({\n                                name: \"Feestbegroeting\",\n                                code: \"CELEBRATION\",\n                                subject: \"Uitnodiging: [FESTIVITEIT] - {{tenant.name}}\",\n                                content: `Beste {{member.firstName}} {{member.lastName}},\n\nHet is ons een genoegen u uit te nodigen voor onze festiviteit!\n\n🎉 Gelegenheid: [FESTIVITEIT NAAM]\n📅 Datum: [DATUM]\n🕐 Tijd: [STARTTIJD]\n📍 Locatie: [LOCATIE/ADRES]\n\nProgramma:\n[TIJDSCHEMA VAN DE FESTIVITEIT]\n\nWat kunt u verwachten:\n- [ACTIVITEIT 1]\n- [ACTIVITEIT 2] \n- [ETEN/DRINKEN]\n- [ENTERTAINMENT]\n\nPraktische zaken:\n- Toegang: [GRATIS/BIJDRAGE]\n- Kledingcode: [INFORMEEL/FORMEEL/TRADITIONEEL]\n- Parkeren: [INFORMATIE]\n- Kinderen welkom: [JA/NEE]\n\nVoor catering en organisatie is het fijn als u uw komst bevestigt via {{tenant.email}} of telefonisch.\n\nWe kijken ernaar uit om samen met u te vieren!\n\nMet feestelijke groet,\nHet organisatieteam van {{tenant.name}}`\n                              });\n                              setShowTemplateDialog(true);\n                            }}\n                            data-testid=\"button-create-celebration-template\"\n                          >\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </>\n                )}\n                \n              </>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* Verzendgroepen Tab */}\n        <TabsContent value=\"segments\" className=\"space-y-6\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">Verzendgroepen</h2>\n              <p className=\"text-sm text-gray-600 mt-1\">Maak groepen op basis van criteria zoals stemrecht, status, categorie, leeftijd en geslacht</p>\n            </div>\n            {canEdit && (\n              <Button onClick={handleNewSegment} className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-700\" data-testid=\"button-new-segment\">\n                <Plus className=\"w-4 h-4\" />\n                Nieuwe Verzendgroep\n              </Button>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\" data-testid=\"segments-grid\">\n            {segmentsLoading ? (\n              Array.from({ length: 3 }).map((_, i) => (\n                <Card key={i} className=\"glass-card animate-pulse\">\n                  <CardHeader>\n                    <div className=\"h-4 bg-gray-200 rounded w-3/4 mb-2\"></div>\n                    <div className=\"h-3 bg-gray-200 rounded w-1/2\"></div>\n                  </CardHeader>\n                </Card>\n              ))\n            ) : !segments || !Array.isArray(segments) || segments.length === 0 ? (\n              <div className=\"col-span-full text-center py-12\" data-testid=\"segments-empty-state\">\n                <FaArrowsDownToPeople className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Nog geen verzendgroepen</h3>\n                <p className=\"text-gray-500 mb-4\">Maak je eerste verzendgroep op basis van criteria zoals stemrecht, categorie of leeftijd</p>\n                {canEdit && (\n                  <Button onClick={handleNewSegment} data-testid=\"button-add-first-segment\">\n                    <Plus className=\"w-4 h-4 mr-2\" />\n                    Verzendgroep Toevoegen\n                  </Button>\n                )}\n              </div>\n            ) : (\n              Array.isArray(segments) && segments.map((segment: any) => (\n                <Card key={segment.id} className=\"glass-card card-hover animate-fade-in group border-0\" data-testid={`card-segment-${segment.id}`}>\n                  <CardHeader>\n                    <CardTitle className=\"text-base\" data-testid={`text-segment-name-${segment.id}`}>\n                      {segment.name}\n                    </CardTitle>\n                    <CardDescription data-testid={`text-segment-rules-${segment.id}`}>\n                      {Object.keys(segment.rules || {}).length} filter regels\n                    </CardDescription>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"flex gap-2\">\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => handlePreviewSegment(segment)} data-testid={`button-preview-segment-${segment.id}`}>\n                        <Eye className=\"w-4 h-4 mr-1\" />\n                        Preview\n                      </Button>\n                      {canEdit && (\n                        <>\n                          <Button size=\"sm\" variant=\"outline\" onClick={() => handleEditSegment(segment)} data-testid={`button-edit-segment-${segment.id}`}>\n                            <Edit className=\"w-4 h-4 mr-1\" />\n                            Bewerk\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => handleDeleteSegment(segment)}\n                            className=\"text-red-600 hover:text-red-700 hover:border-red-200 hover:bg-red-50\"\n                            data-testid={`button-delete-segment-${segment.id}`}\n                          >\n                            <Trash2 className=\"w-4 h-4\" />\n                          </Button>\n                        </>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </div>\n        </TabsContent>\n\n\n        {/* Email Composer Tab */}\n        <TabsContent value=\"send\" className=\"space-y-6\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900\">E-mail Opstellen</h2>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                Stel een nieuwe e-mail op met mogelijkheid om templates te gebruiken\n              </p>\n            </div>\n          </div>\n\n          {/* Email Composer */}\n          <Card className=\"glass-card card-hover animate-fade-in group border-0\">\n            <CardContent className=\"p-6\">\n              <div className=\"space-y-6\">\n                {/* Template Selector */}\n                <div>\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <Label className=\"text-sm font-medium text-gray-700\">Template laden (optioneel)</Label>\n                    {selectedTemplateForComposer && (\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\" \n                        onClick={() => {\n                          setSelectedTemplateForComposer(null);\n                          setEmailSubject(\"\");\n                          setEmailContent(\"\");\n                        }}\n                      >\n                        Template wissen\n                      </Button>\n                    )}\n                  </div>\n                  <Select \n                    value={selectedTemplateForComposer?.id || \"\"} \n                    onValueChange={(value) => {\n                      const template = templates?.find((t: any) => t.id === value);\n                      if (template) {\n                        setSelectedTemplateForComposer(template);\n                        setEmailSubject(template.subject || \"\");\n                        setEmailContent(template.content || template.body_text || \"\");\n                      }\n                    }}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Selecteer een template om te laden\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {Array.isArray(templates) && templates.map((template: any) => (\n                        <SelectItem key={template.id} value={template.id}>\n                          {template.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Recipients Field */}\n                <div className=\"relative\">\n                  <Label className=\"text-sm font-medium text-gray-700 mb-2 block\">Geadresseerden</Label>\n                  <div className=\"space-y-2\">\n                    {/* Recipients Tags */}\n                    {emailRecipients.length > 0 && (\n                      <div className=\"flex flex-wrap gap-2 p-3 glass-card border-0 rounded-md\">\n                        {emailRecipients.map((recipient, index) => (\n                          <div \n                            key={index} \n                            className={`flex items-center gap-1 px-2 py-1 rounded-md text-sm ${\n                              recipient.type === 'member' ? 'bg-green-100 text-green-800' :\n                              recipient.type === 'segment' ? 'bg-purple-100 text-purple-800' :\n                              'bg-blue-100 text-blue-800'\n                            }`}\n                          >\n                            {recipient.type === 'member' && <Users className=\"w-3 h-3 text-blue-600\" />}\n                            {recipient.type === 'segment' && <FaArrowsDownToPeople className=\"w-3 h-3\" />}\n                            {recipient.type === 'email' && <Mail className=\"w-3 h-3\" />}\n                            <span>{recipient.label}</span>\n                            <button \n                              onClick={() => removeRecipient(index)}\n                              className=\"text-current hover:text-red-600 ml-1 font-bold\"\n                            >\n                              ×\n                            </button>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                    \n                    {/* Add Recipients Input with Autocomplete */}\n                    <div className=\"relative\">\n                      <Input\n                        value={recipientInput}\n                        onChange={(e) => {\n                          setRecipientInput(e.target.value);\n                          setShowRecipientSuggestions(e.target.value.length > 0);\n                        }}\n                        onFocus={() => {\n                          if (recipientInput.length > 0) {\n                            setShowRecipientSuggestions(true);\n                          }\n                        }}\n                        onBlur={() => {\n                          // Delay hiding suggestions to allow for clicks\n                          setTimeout(() => setShowRecipientSuggestions(false), 200);\n                        }}\n                        placeholder=\"Type om leden, verzendgroepen of e-mailadressen te zoeken...\"\n                        className=\"flex-1\"\n                        data-testid=\"input-recipients\"\n                      />\n                      \n                      {/* Autocomplete Suggestions */}\n                      {showRecipientSuggestions && recipientInput.length > 0 && (\n                        <div className=\"absolute z-10 w-full mt-1 glass-card border-0 rounded-md max-h-60 overflow-y-auto\">\n                          {getRecipientSuggestions().map((suggestion, index) => (\n                            <button\n                              key={index}\n                              type=\"button\"\n                              className=\"w-full px-3 py-2 text-left hover:bg-gray-50 flex items-center gap-2 border-b border-gray-100 last:border-b-0\"\n                              onClick={() => addRecipient(suggestion)}\n                            >\n                              {suggestion.type === 'member' && <Users className=\"w-4 h-4 text-blue-600\" />}\n                              {suggestion.type === 'segment' && <FaArrowsDownToPeople className=\"w-4 h-4 text-purple-600\" />}\n                              {suggestion.type === 'email' && <Mail className=\"w-4 h-4 text-blue-600\" />}\n                              <span className=\"text-sm\">{suggestion.label}</span>\n                            </button>\n                          ))}\n                          {getRecipientSuggestions().length === 0 && (\n                            <div className=\"px-3 py-2 text-sm text-gray-500\">\n                              Geen resultaten gevonden\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                    \n                    {/* Helper Text */}\n                    <p className=\"text-xs text-gray-500\">\n                      Type om te zoeken naar leden op naam of email, verzendgroepen, of voer direct een e-mailadres in\n                    </p>\n                  </div>\n                </div>\n\n                {/* Subject Field */}\n                <div>\n                  <Label htmlFor=\"email-subject\" className=\"text-sm font-medium text-gray-700 mb-2 block\">Onderwerp</Label>\n                  <Input\n                    id=\"email-subject\"\n                    value={emailSubject}\n                    onChange={(e) => setEmailSubject(e.target.value)}\n                    placeholder=\"Voer het onderwerp van de e-mail in...\"\n                    data-testid=\"input-subject\"\n                  />\n                </div>\n\n                {/* Email Content */}\n                <div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <Label htmlFor=\"email-content\" className=\"text-sm font-medium text-gray-700\">E-mail Inhoud</Label>\n                    <Collapsible open={showVariablesHelper} onOpenChange={setShowVariablesHelper}>\n                      <CollapsibleTrigger asChild>\n                        <Button variant=\"outline\" size=\"sm\" className=\"text-xs\">\n                          {showVariablesHelper ? <ChevronDown className=\"w-3 h-3 mr-1\" /> : <ChevronRight className=\"w-3 h-3 mr-1\" />}\n                          Handlebars Variabelen\n                        </Button>\n                      </CollapsibleTrigger>\n                    </Collapsible>\n                  </div>\n                  \n                  <div className=\"flex gap-4\">\n                    <div className=\"flex-1\">\n                      <Textarea\n                        id=\"email-content\"\n                        value={emailContent}\n                        onChange={(e) => setEmailContent(e.target.value)}\n                        placeholder=\"Typ hier de inhoud van je e-mail...&#10;&#10;Je kunt Handlebars variabelen gebruiken zoals:&#10;- {{member.firstName}} voor voornaam&#10;- {{member.lastName}} voor achternaam&#10;- {{tenant.name}} voor organisatie naam\"\n                        className=\"min-h-[300px] font-mono text-sm\"\n                        data-testid=\"textarea-content\"\n                      />\n                      <p className=\"text-xs text-gray-500 mt-2\">\n                        Tip: Gebruik handlebars variabelen zoals {\"{{\"} member.firstName {\"}\"} voor personalisatie\n                      </p>\n                    </div>\n                    \n                    <Collapsible open={showVariablesHelper} onOpenChange={setShowVariablesHelper}>\n                      <CollapsibleContent className=\"w-80\">\n                        <div className=\"glass-card border-0 rounded-lg p-4 ml-2\">\n                          <h3 className=\"text-sm font-semibold mb-3 text-gray-900\">Beschikbare Variabelen</h3>\n                          <div className=\"space-y-4 max-h-80 overflow-y-auto\">\n                            \n                            <div className=\"space-y-2\">\n                              <h4 className=\"font-medium text-xs text-gray-900 uppercase tracking-wide\">Lid Informatie</h4>\n                              <div className=\"space-y-1 text-xs\">\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{member.firstName}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{member.firstName}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Voornaam</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{member.lastName}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{member.lastName}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Achternaam</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{member.email}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{member.email}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">E-mailadres</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{member.memberNumber}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{member.memberNumber}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Lidnummer</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{member.category}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{member.category}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Categorie</span>\n                                </div>\n                              </div>\n                            </div>\n\n                            <div className=\"space-y-2\">\n                              <h4 className=\"font-medium text-xs text-gray-900 uppercase tracking-wide\">Organisatie</h4>\n                              <div className=\"space-y-1 text-xs\">\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{tenant.name}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{tenant.name}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Naam</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{tenant.email}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{tenant.email}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">E-mail</span>\n                                </div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{tenant.phone}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{tenant.phone}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Telefoon</span>\n                                </div>\n                              </div>\n                            </div>\n\n                            <div className=\"space-y-2\">\n                              <h4 className=\"font-medium text-xs text-gray-900 uppercase tracking-wide\">Lidgelden</h4>\n                              <div className=\"space-y-1 text-xs\">\n                                <div className=\"text-gray-600 mb-1\">Alle lidgelden:</div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-white px-2 py-1 rounded border cursor-pointer hover:bg-blue-50 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{#each fees}}{{currency amount}} - {{status}}{{/each}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{#each fees}}...{{/each}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Loop</span>\n                                </div>\n                                <div className=\"text-gray-600 mb-1 mt-2\">Alleen openstaande:</div>\n                                <div className=\"flex justify-between items-center\">\n                                  <code \n                                    className=\"bg-blue-50 px-2 py-1 rounded border cursor-pointer hover:bg-blue-100 transition-colors\"\n                                    onClick={() => {\n                                      const cursorPos = document.getElementById('email-content')?.selectionStart || 0;\n                                      const newContent = emailContent.slice(0, cursorPos) + '{{#each openstaandeFees}}{{currency amount}}{{/each}}' + emailContent.slice(cursorPos);\n                                      setEmailContent(newContent);\n                                    }}\n                                  >\n                                    {\"{{#each openstaandeFees}}\"}\n                                  </code>\n                                  <span className=\"text-gray-500\">Openstaand</span>\n                                </div>\n                              </div>\n                            </div>\n\n                          </div>\n                        </div>\n                      </CollapsibleContent>\n                    </Collapsible>\n                  </div>\n                </div>\n\n                {/* Send Button */}\n                <div className=\"flex justify-between items-center pt-4 border-t border-gray-200\">\n                  <div className=\"text-sm text-gray-600\">\n                    {emailRecipients.length > 0 && (\n                      <span>{emailRecipients.length} geadresseerd(en)</span>\n                    )}\n                  </div>\n                  {canEdit && (\n                    <Button \n                      onClick={handleSendComposedEmail}\n                      disabled={!emailSubject || !emailContent || emailRecipients.length === 0 || sendComposedEmailMutation.isPending}\n                      className=\"bg-blue-600 hover:bg-blue-700\"\n                      data-testid=\"button-send-email\"\n                    >\n                      {sendComposedEmailMutation.isPending ? (\n                        <>Verzenden...</>\n                      ) : (\n                        <>\n                          <Send className=\"w-4 h-4 mr-2\" />\n                          E-mail Verzenden\n                        </>\n                      )}\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n      </Tabs>\n\n      {/* Template Dialog */}\n      <Dialog open={showTemplateDialog} onOpenChange={setShowTemplateDialog}>\n        <DialogContent className=\"max-w-7xl max-h-[90vh] overflow-hidden\">\n          <DialogHeader className=\"border-b pb-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"bg-blue-100 p-2 rounded-lg\">\n                <Mail className=\"w-5 h-5 text-blue-600\" />\n              </div>\n              <div>\n                <DialogTitle className=\"text-xl font-semibold\">\n                  {editingTemplate ? 'Template Bewerken' : 'Nieuwe Template Aanmaken'}\n                </DialogTitle>\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  {editingTemplate ? 'Bewerk de template details en inhoud' : 'Maak een nieuwe e-mail template voor automatische berichten'}\n                </p>\n              </div>\n            </div>\n          </DialogHeader>\n          \n          <div className=\"flex gap-6 overflow-hidden\" style={{ height: 'calc(90vh - 120px)' }}>\n            {/* Form Section */}\n            <div className=\"flex-1 overflow-y-auto pr-2\">\n              <Form {...templateForm}>\n                <form onSubmit={templateForm.handleSubmit(onTemplateSubmit)} className=\"space-y-6\">\n              <div className=\"grid grid-cols-2 gap-4\">\n                <FormField\n                  control={templateForm.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Naam</FormLabel>\n                      <FormControl>\n                        <Input {...field} placeholder=\"Bijv. Welkomstmail\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={templateForm.control}\n                  name=\"code\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Code</FormLabel>\n                      <FormControl>\n                        <Input {...field} placeholder=\"bijv. welkomst_mail\" />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={templateForm.control}\n                name=\"subject\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Onderwerp</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"E-mail onderwerp\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={templateForm.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Inhoud</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        {...field}\n                        placeholder=\"Schrijf hier de inhoud van je e-mail. Deze wordt automatisch omgezet naar een professionele layout.\"\n                        rows={8}\n                        className=\"resize-none\"\n                      />\n                    </FormControl>\n                    <FormDescription>\n                      Gebruik Handlebars variabelen zoals {\"{{member.firstName}}\"} voor personalisatie. De layout wordt automatisch toegepast.\n                    </FormDescription>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"flex justify-end gap-3\">\n                <Button type=\"button\" variant=\"outline\" onClick={() => {\n                  setShowTemplateDialog(false);\n                  setOriginalTemplateData(null);\n                }}>\n                  Annuleren\n                </Button>\n                <Button \n                  type=\"submit\" \n                  disabled={\n                    createTemplateMutation.isPending || \n                    updateTemplateMutation.isPending ||\n                    (editingTemplate && !hasTemplateChanges())\n                  }\n                  variant={editingTemplate && !hasTemplateChanges() ? \"secondary\" : \"default\"}\n                >\n                  {editingTemplate ? \n                    (hasTemplateChanges() ? 'Wijzigingen opslaan' : 'Opslaan') : \n                    'Aanmaken'\n                  }\n                </Button>\n              </div>\n            </form>\n          </Form>\n            </div>\n            \n            {/* Handlebars Mapping Tool */}\n            <div className=\"w-80 border-l pl-6\">\n              <div className=\"sticky top-0\">\n                <h3 className=\"text-lg font-semibold mb-4\">Handlebars Variabelen</h3>\n                <div className=\"space-y-4 max-h-96 overflow-y-auto\">\n                  \n                  <div className=\"space-y-2\">\n                    <h4 className=\"font-medium text-sm text-gray-900\">Lid Informatie</h4>\n                    <div className=\"space-y-1 text-xs\">\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.firstName}}\"}</code>\n                        <span className=\"text-gray-500\">Voornaam</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.lastName}}\"}</code>\n                        <span className=\"text-gray-500\">Achternaam</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.email}}\"}</code>\n                        <span className=\"text-gray-500\">E-mailadres</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.memberNumber}}\"}</code>\n                        <span className=\"text-gray-500\">Lidnummer</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.category}}\"}</code>\n                        <span className=\"text-gray-500\">Categorie</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{member.city}}\"}</code>\n                        <span className=\"text-gray-500\">Stad</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <h4 className=\"font-medium text-sm text-gray-900\">Organisatie</h4>\n                    <div className=\"space-y-1 text-xs\">\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.name}}\"}</code>\n                        <span className=\"text-gray-500\">Naam organisatie</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.email}}\"}</code>\n                        <span className=\"text-gray-500\">E-mailadres</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.phone}}\"}</code>\n                        <span className=\"text-gray-500\">Telefoonnummer</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.website}}\"}</code>\n                        <span className=\"text-gray-500\">Website</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.street}}\"}</code>\n                        <span className=\"text-gray-500\">Straat</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.number}}\"}</code>\n                        <span className=\"text-gray-500\">Huisnummer</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.postalCode}}\"}</code>\n                        <span className=\"text-gray-500\">Postcode</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.city}}\"}</code>\n                        <span className=\"text-gray-500\">Stad</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{tenant.country}}\"}</code>\n                        <span className=\"text-gray-500\">Land</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <h4 className=\"font-medium text-sm text-gray-900\">Lidkaart</h4>\n                    <div className=\"space-y-1 text-xs\">\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{card.url}}\"}</code>\n                        <span className=\"text-gray-500\">Link naar lidkaart</span>\n                      </div>\n                      <div className=\"flex justify-between\">\n                        <code className=\"bg-gray-100 px-1 rounded\">{\"{{card.qrCode}}\"}</code>\n                        <span className=\"text-gray-500\">QR code URL</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <h4 className=\"font-medium text-sm text-gray-900\">Lidgelden</h4>\n                    <div className=\"space-y-1 text-xs\">\n                      <div className=\"text-gray-600 mb-1\">Loop door alle lidgelden:</div>\n                      <code className=\"bg-gray-100 px-1 rounded text-xs\">{\"{{#each fees}}\"}</code>\n                      <div className=\"ml-2 space-y-1\">\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{currency amount}}\"}</code>\n                          <span className=\"text-gray-500\">Bedrag</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{date periodStart}}\"}</code>\n                          <span className=\"text-gray-500\">Start periode</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{date periodEnd}}\"}</code>\n                          <span className=\"text-gray-500\">Eind periode</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{date dueDate}}\"}</code>\n                          <span className=\"text-gray-500\">Vervaldatum</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{status}}\"}</code>\n                          <span className=\"text-gray-500\">Status (BETAALD/OPENSTAAND/VERVALLEN)</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{paymentMethod}}\"}</code>\n                          <span className=\"text-gray-500\">Betaalmethode</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <code className=\"bg-gray-100 px-1 rounded\">{\"{{category}}\"}</code>\n                          <span className=\"text-gray-500\">Lidgeld categorie</span>\n                        </div>\n                      </div>\n                      <code className=\"bg-gray-100 px-1 rounded text-xs\">{\"{{/each}}\"}</code>\n                      \n                      <div className=\"mt-3 pt-2 border-t\">\n                        <div className=\"text-gray-600 mb-1\">Gefilterde lidgelden:</div>\n                        <div className=\"space-y-1\">\n                          <div className=\"flex justify-between\">\n                            <code className=\"bg-blue-100 px-1 rounded\">{\"{{#each openstaandeFees}}\"}</code>\n                            <span className=\"text-gray-500\">Alleen openstaande</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <code className=\"bg-red-100 px-1 rounded\">{\"{{#each vervallenFees}}\"}</code>\n                            <span className=\"text-gray-500\">Alleen vervallen</span>\n                          </div>\n                          <div className=\"flex justify-between\">\n                            <code className=\"bg-green-100 px-1 rounded\">{\"{{#each betaaldeFees}}\"}</code>\n                            <span className=\"text-gray-500\">Alleen betaalde</span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n\n                </div>\n              </div>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Segment Dialog */}\n      <Dialog open={showSegmentDialog} onOpenChange={setShowSegmentDialog}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>{editingSegment ? 'Verzendgroep Bewerken' : 'Nieuwe Verzendgroep'}</DialogTitle>\n          </DialogHeader>\n          <Form {...segmentForm}>\n            <form onSubmit={segmentForm.handleSubmit(onSegmentSubmit)} className=\"space-y-6\">\n              <FormField\n                control={segmentForm.control}\n                name=\"name\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Verzendgroep Naam</FormLabel>\n                    <FormControl>\n                      <Input {...field} placeholder=\"Bijv. Stemgerechtigde Leden, Senioren 65+, Families\" />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"space-y-6\">\n                <div>\n                  <Label className=\"text-base font-medium\">Selectie Criteria</Label>\n                  <p className=\"text-sm text-gray-600 mt-1\">Selecteer leden op basis van stemrecht, status, categorie, leeftijd en geslacht</p>\n                </div>\n                \n                <div className=\"grid grid-cols-2 gap-6\">\n                  {/* Status Filters */}\n                  <div className=\"space-y-4\">\n                    <h4 className=\"font-medium text-sm\">Status & Rechten</h4>\n                    <div className=\"space-y-3\">\n                      <div>\n                        <Label>Stemrecht</Label>\n                        <Select\n                          value={segmentForm.watch(\"rules.hasVotingRights\") !== undefined ? (segmentForm.watch(\"rules.hasVotingRights\") ? \"true\" : \"false\") : \"ALL\"}\n                          onValueChange={(value) => {\n                            if (value === \"ALL\") {\n                              segmentForm.setValue(\"rules.hasVotingRights\" as any, undefined);\n                            } else {\n                              segmentForm.setValue(\"rules.hasVotingRights\" as any, value === \"true\");\n                            }\n                          }}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Alle leden\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"ALL\">Alle leden</SelectItem>\n                            <SelectItem value=\"true\">Alleen stemgerechtigde leden</SelectItem>\n                            <SelectItem value=\"false\">Alleen niet-stemgerechtigde leden</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      \n                      <div>\n                        <Label>Status</Label>\n                        <Select\n                          value={segmentForm.watch(\"rules.memberActive\") !== undefined ? (segmentForm.watch(\"rules.memberActive\") ? \"true\" : \"false\") : \"ALL\"}\n                          onValueChange={(value) => {\n                            if (value === \"ALL\") {\n                              segmentForm.setValue(\"rules.memberActive\", undefined);\n                            } else {\n                              segmentForm.setValue(\"rules.memberActive\", value === \"true\");\n                            }\n                          }}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Alle statussen\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"ALL\">Alle statussen</SelectItem>\n                            <SelectItem value=\"true\">Alleen actieve leden</SelectItem>\n                            <SelectItem value=\"false\">Alleen inactieve leden</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      \n                      <div>\n                        <Label>Categorie</Label>\n                        <Select\n                          value={segmentForm.watch(\"rules.category\")?.[0] || \"ALL\"}\n                          onValueChange={(value) => {\n                            segmentForm.setValue(\"rules.category\" as any, value === \"ALL\" ? [] : [value]);\n                          }}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Alle categorieën\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"ALL\">Alle categorieën</SelectItem>\n                            <SelectItem value=\"STUDENT\">Student</SelectItem>\n                            <SelectItem value=\"STANDAARD\">Standaard</SelectItem>\n                            <SelectItem value=\"SENIOR\">Senior</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      \n                      <div>\n                        <Label>Geslacht</Label>\n                        <Select\n                          value={segmentForm.watch(\"rules.gender\") || \"ALL\"}\n                          onValueChange={(value) => segmentForm.setValue(\"rules.gender\" as any, value === \"ALL\" ? undefined : value)}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"Alle geslachten\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"ALL\">Alle geslachten</SelectItem>\n                            <SelectItem value=\"M\">Man</SelectItem>\n                            <SelectItem value=\"V\">Vrouw</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n                      \n                    </div>\n                  </div>\n                  \n                  {/* Demographics */}\n                  <div className=\"space-y-4\">\n                    <h4 className=\"font-medium text-sm\">Leeftijd</h4>\n                    <div className=\"space-y-3\">\n                      <div className=\"grid grid-cols-2 gap-3\">\n                        <div>\n                          <Label>Min Leeftijd</Label>\n                          <Input \n                            type=\"number\"\n                            value={segmentForm.watch(\"rules.minAge\" as any)?.toString() || \"\"}\n                            onChange={(e) => {\n                              const val = e.target.value;\n                              segmentForm.setValue(\"rules.minAge\" as any, val ? parseInt(val) : undefined);\n                            }}\n                            placeholder=\"18\"\n                          />\n                        </div>\n                        <div>\n                          <Label>Max Leeftijd</Label>\n                          <Input \n                            type=\"number\"\n                            value={segmentForm.watch(\"rules.maxAge\" as any)?.toString() || \"\"}\n                            onChange={(e) => {\n                              const val = e.target.value;\n                              segmentForm.setValue(\"rules.maxAge\" as any, val ? parseInt(val) : undefined);\n                            }}\n                            placeholder=\"65\"\n                          />\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end gap-3\">\n                <Button type=\"button\" variant=\"outline\" onClick={() => setShowSegmentDialog(false)}>\n                  Annuleren\n                </Button>\n                <Button type=\"submit\" disabled={createSegmentMutation.isPending || updateSegmentMutation.isPending}>\n                  {editingSegment ? 'Bijwerken' : 'Aanmaken'}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </DialogContent>\n      </Dialog>\n\n\n      {/* Preview Dialog */}\n      <Dialog open={showPreviewDialog} onOpenChange={setShowPreviewDialog}>\n        <DialogContent className=\"max-w-4xl w-full max-h-[90vh] overflow-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Mail className=\"w-5 h-5 text-gray-600\" />\n              E-mail Preview\n            </DialogTitle>\n          </DialogHeader>\n          \n          {/* Email Interface Mock */}\n          <div className=\"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden\">\n            {/* Email Header */}\n            <div className=\"border-b border-gray-200 bg-gray-50 px-6 py-4\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center\">\n                      <Mail className=\"w-5 h-5 text-gray-600\" />\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-gray-900\">Uw Moskee</p>\n                      <p className=\"text-sm text-gray-600\">info@uwmoskee.nl</p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-sm text-gray-600\">Aan: lid@email.nl</p>\n                    <p className=\"text-xs text-gray-500\">Nu</p>\n                  </div>\n                </div>\n                \n                <div>\n                  <h2 className=\"text-lg font-semibold text-gray-900\">\n                    {previewTemplate?.subject || 'E-mail onderwerp'}\n                  </h2>\n                </div>\n              </div>\n            </div>\n            \n            {/* Email Body */}\n            <div className=\"bg-white\">\n              <div className=\"px-6 py-6\">\n                <div \n                  className=\"prose prose-sm max-w-none text-gray-800 leading-relaxed\"\n                  style={{\n                    fontFamily: 'system-ui, -apple-system, sans-serif',\n                    lineHeight: '1.6'\n                  }}\n                  dangerouslySetInnerHTML={{ \n                    __html: previewTemplate?.bodyHtml || previewTemplate?.body_html || \n                    '<p class=\"text-gray-500 italic\">Geen e-mail inhoud beschikbaar</p>' \n                  }}\n                />\n              </div>\n              \n              {/* Email Footer */}\n              <div className=\"border-t border-gray-100 bg-gray-50 px-6 py-4\">\n                <div className=\"text-center\">\n                  <p className=\"text-xs text-gray-500 mb-2\">\n                    Dit bericht is verzonden vanuit uw ledenbeheer systeem\n                  </p>\n                  <div className=\"flex justify-center items-center gap-4 text-xs text-gray-400\">\n                    <span>© 2024 Uw Moskee</span>\n                    <span>•</span>\n                    <span>Lidmaatschap & Communicatie</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end pt-4\">\n            <Button variant=\"outline\" onClick={() => setShowPreviewDialog(false)}>\n              Sluiten\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Confirmation Dialog */}\n      <Dialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"w-5 h-5 text-red-600\" />\n              Template verwijderen\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <p className=\"text-gray-600\">\n              Weet je zeker dat je de template \"<strong>{templateToDelete?.name}</strong>\" wilt verwijderen? \n              Deze actie kan niet ongedaan worden gemaakt.\n            </p>\n            <div className=\"flex justify-end gap-3\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setShowDeleteDialog(false)}\n                data-testid=\"button-cancel-delete\"\n              >\n                Annuleren\n              </Button>\n              <Button \n                type=\"button\"\n                variant=\"destructive\"\n                onClick={confirmDeleteTemplate}\n                disabled={deleteTemplateMutation.isPending}\n                data-testid=\"button-confirm-delete\"\n              >\n                {deleteTemplateMutation.isPending ? 'Verwijderen...' : 'Verwijderen'}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Segment Preview Dialog */}\n      <Dialog open={showSegmentPreviewDialog} onOpenChange={setShowSegmentPreviewDialog}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <FaArrowsDownToPeople className=\"w-5 h-5 text-gray-600\" />\n              Verzendgroep Preview: {previewSegment?.name}\n            </DialogTitle>\n          </DialogHeader>\n          \n          <div className=\"space-y-6\">\n            {/* Segment Info */}\n            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n              <h3 className=\"font-medium text-gray-900 mb-2\">Verzendgroep Details</h3>\n              <div className=\"space-y-2 text-sm\">\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Naam:</span>\n                  <span className=\"font-medium text-gray-900\">{previewSegment?.name}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span className=\"text-gray-600\">Aantal criteria:</span>\n                  <span className=\"font-medium text-gray-900\">\n                    {previewSegment?.rules ? Object.keys(previewSegment.rules).filter(key => previewSegment.rules[key] !== undefined && previewSegment.rules[key] !== null && previewSegment.rules[key] !== \"\").length : 0}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Criteria Details */}\n            <div>\n              <h4 className=\"font-medium text-gray-900 mb-3\">Selectie Criteria</h4>\n              <div className=\"space-y-3\">\n                {previewSegment?.rules ? (\n                  <>\n                    {previewSegment.rules.hasVotingRights !== undefined && (\n                      <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                        <span className=\"text-gray-700\">Stemrecht</span>\n                        <span className=\"font-medium text-gray-900\">\n                          {previewSegment.rules.hasVotingRights ? \"Alleen stemgerechtigde leden\" : \"Alleen niet-stemgerechtigde leden\"}\n                        </span>\n                      </div>\n                    )}\n                    \n                    {previewSegment.rules.memberActive !== undefined && (\n                      <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                        <span className=\"text-gray-700\">Status</span>\n                        <span className=\"font-medium text-gray-900\">\n                          {previewSegment.rules.memberActive ? \"Alleen actieve leden\" : \"Alleen inactieve leden\"}\n                        </span>\n                      </div>\n                    )}\n                    \n                    {previewSegment.rules.category && previewSegment.rules.category.length > 0 && (\n                      <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                        <span className=\"text-gray-700\">Categorie</span>\n                        <span className=\"font-medium text-gray-900\">\n                          {previewSegment.rules.category.join(\", \")}\n                        </span>\n                      </div>\n                    )}\n                    \n                    {previewSegment.rules.gender && (\n                      <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                        <span className=\"text-gray-700\">Geslacht</span>\n                        <span className=\"font-medium text-gray-900\">\n                          {previewSegment.rules.gender === \"M\" ? \"Man\" : previewSegment.rules.gender === \"V\" ? \"Vrouw\" : previewSegment.rules.gender}\n                        </span>\n                      </div>\n                    )}\n                    \n                    {(previewSegment.rules.minAge || previewSegment.rules.maxAge) && (\n                      <div className=\"flex justify-between items-center p-3 bg-gray-50 rounded-lg\">\n                        <span className=\"text-gray-700\">Leeftijd</span>\n                        <span className=\"font-medium text-gray-900\">\n                          {previewSegment.rules.minAge && previewSegment.rules.maxAge \n                            ? `${previewSegment.rules.minAge} - ${previewSegment.rules.maxAge} jaar`\n                            : previewSegment.rules.minAge \n                            ? `Minimaal ${previewSegment.rules.minAge} jaar`\n                            : `Maximaal ${previewSegment.rules.maxAge} jaar`\n                          }\n                        </span>\n                      </div>\n                    )}\n                  </>\n                ) : (\n                  <div className=\"text-center py-8 text-gray-500\">\n                    <p>Geen specifieke criteria ingesteld</p>\n                    <p className=\"text-sm\">Deze verzendgroep bevat alle leden</p>\n                  </div>\n                )}\n              </div>\n            </div>\n            \n            {/* Usage Info */}\n            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\n              <h4 className=\"font-medium text-gray-900 mb-2\">Gebruik</h4>\n              <p className=\"text-sm text-gray-600\">\n                Deze verzendgroep kan gebruikt worden bij het verzenden van emails naar specifieke groepen leden die voldoen aan de bovenstaande criteria.\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex justify-end pt-4\">\n            <Button onClick={() => {\n              setShowSegmentPreviewDialog(false);\n              handleEditSegment(previewSegment);\n            }}>\n              Bewerken\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Delete Segment Confirmation Dialog */}\n      <Dialog open={showDeleteSegmentDialog} onOpenChange={setShowDeleteSegmentDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"w-5 h-5 text-red-600\" />\n              Verzendgroep verwijderen\n            </DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <p className=\"text-gray-600\">\n              Weet je zeker dat je de verzendgroep \"<strong>{segmentToDelete?.name}</strong>\" wilt verwijderen? \n              Deze actie kan niet ongedaan worden gemaakt.\n            </p>\n            <div className=\"flex justify-end gap-3\">\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={() => setShowDeleteSegmentDialog(false)}\n                data-testid=\"button-cancel-delete-segment\"\n              >\n                Annuleren\n              </Button>\n              <Button \n                type=\"button\"\n                variant=\"destructive\"\n                onClick={confirmDeleteSegment}\n                data-testid=\"button-confirm-delete-segment\"\n              >\n                Verwijderen\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n\n      </div>\n    </main>\n  );\n}","size_bytes":112276},"server/services/email.ts":{"content":"import { MailService } from '@sendgrid/mail';\n\nconst mailService = new MailService();\n\n// Initialize with API key if available\nif (process.env.SENDGRID_API_KEY) {\n  mailService.setApiKey(process.env.SENDGRID_API_KEY);\n}\n\ninterface EmailParams {\n  to: string;\n  from: string;\n  subject: string;\n  text?: string;\n  html?: string;\n}\n\nexport async function sendEmail(params: EmailParams): Promise<boolean> {\n  try {\n    if (!process.env.SENDGRID_API_KEY) {\n      console.log(\"SendGrid API key not configured - email would be sent to:\", params.to);\n      console.log(\"Subject:\", params.subject);\n      console.log(\"Content:\", params.text || params.html);\n      return true; // Return success for development\n    }\n\n    await mailService.send({\n      to: params.to,\n      from: params.from,\n      subject: params.subject,\n      text: params.text,\n      html: params.html,\n    });\n    \n    console.log(\"Email sent successfully to:\", params.to);\n    return true;\n  } catch (error) {\n    console.error('SendGrid email error:', error);\n    return false;\n  }\n}\n\nexport function generatePasswordResetEmail(newPassword: string, userEmail: string) {\n  const subject = \"Uw nieuwe wachtwoord - IDARAH Ledenbeheer\";\n  \n  const text = `\nHallo,\n\nU heeft een nieuw wachtwoord aangevraagd voor uw IDARAH Ledenbeheer account.\n\nUw nieuwe wachtwoord is: ${newPassword}\n\nLog in op het systeem met dit nieuwe wachtwoord. We raden u aan om uw wachtwoord te wijzigen na het inloggen.\n\nMet vriendelijke groet,\nHet IDARAH team\n  `;\n\n  const html = `\n<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n  <h2 style=\"color: #333;\">Uw nieuwe wachtwoord</h2>\n  \n  <p>Hallo,</p>\n  \n  <p>U heeft een nieuw wachtwoord aangevraagd voor uw IDARAH Ledenbeheer account.</p>\n  \n  <div style=\"background-color: #f8f9fa; padding: 20px; border-radius: 5px; margin: 20px 0;\">\n    <strong>Uw nieuwe wachtwoord is: </strong>\n    <code style=\"background-color: #e9ecef; padding: 4px 8px; border-radius: 3px; font-size: 16px;\">${newPassword}</code>\n  </div>\n  \n  <p>Log in op het systeem met dit nieuwe wachtwoord. We raden u aan om uw wachtwoord te wijzigen na het inloggen.</p>\n  \n  <p>Met vriendelijke groet,<br>Het IDARAH team</p>\n</div>\n  `;\n\n  return { subject, text, html };\n}\n\n// Original email service implementation continues below...\nimport { db } from \"../db\";\nimport { \n  emailTemplates, \n  emailSegments, \n  emailCampaigns, \n  emailMessages, \n  emailSuppresses,\n  members,\n  tenants,\n  membershipFees,\n  type InsertEmailTemplate,\n  type InsertEmailSegment,\n  type InsertEmailCampaign,\n  type InsertEmailMessage,\n  type InsertEmailSuppress\n} from \"@shared/schema\";\nimport { eq, and, inArray, gte, lte, sql, desc } from \"drizzle-orm\";\nimport Handlebars from \"handlebars\";\nimport nodemailer from \"nodemailer\";\nimport { randomBytes } from \"crypto\";\n\nexport class EmailService {\n  private transporter: any;\n\n  constructor() {\n    this.setupTransporter();\n    this.registerHandlebarsHelpers();\n  }\n\n  private setupTransporter() {\n    this.transporter = nodemailer.createTransport({\n      host: process.env.SMTP_HOST,\n      port: parseInt(process.env.SMTP_PORT || '587'),\n      secure: false,\n      auth: {\n        user: process.env.SMTP_USER,\n        pass: process.env.SMTP_PASS,\n      },\n    });\n  }\n\n  private registerHandlebarsHelpers() {\n    // Register currency helper\n    Handlebars.registerHelper('currency', function(amount: number) {\n      return new Intl.NumberFormat('nl-BE', { \n        style: 'currency', \n        currency: 'EUR' \n      }).format(amount);\n    });\n\n    // Register date helper\n    Handlebars.registerHelper('date', function(date: Date | string) {\n      const d = typeof date === 'string' ? new Date(date) : date;\n      return d.toLocaleDateString('nl-BE');\n    });\n  }\n\n  // Templates\n  async listTemplates(tenantId: string) {\n    const templates = await db.select()\n      .from(emailTemplates)\n      .where(eq(emailTemplates.tenantId, tenantId))\n      .orderBy(desc(emailTemplates.createdAt));\n    \n    // Ensure uniqueness by ID to prevent duplicates\n    const seen = new Set<string>();\n    return templates.filter(template => {\n      if (seen.has(template.id)) {\n        return false;\n      }\n      seen.add(template.id);\n      return true;\n    });\n  }\n\n  async getTemplate(tenantId: string, id: string) {\n    const [template] = await db.select()\n      .from(emailTemplates)\n      .where(and(\n        eq(emailTemplates.tenantId, tenantId),\n        eq(emailTemplates.id, id)\n      ));\n    return template;\n  }\n\n  async createTemplate(tenantId: string, data: Omit<InsertEmailTemplate, 'tenantId'>) {\n    const [template] = await db.insert(emailTemplates)\n      .values({ ...data, tenantId })\n      .returning();\n    return template;\n  }\n\n  async updateTemplate(tenantId: string, id: string, data: Partial<InsertEmailTemplate>) {\n    const [template] = await db.update(emailTemplates)\n      .set({ ...data, updatedAt: new Date() })\n      .where(and(\n        eq(emailTemplates.tenantId, tenantId),\n        eq(emailTemplates.id, id)\n      ))\n      .returning();\n    return template;\n  }\n\n  async deleteTemplate(tenantId: string, id: string) {\n    await db.delete(emailTemplates)\n      .where(and(\n        eq(emailTemplates.tenantId, tenantId),\n        eq(emailTemplates.id, id)\n      ));\n  }\n\n  // Convert plain text to professional HTML\n  private convertToHTML(plainText: string): string {\n    if (!plainText?.trim()) return \"\";\n    \n    const baseStyle = `\n    <html>\n    <head>\n      <meta charset=\"utf-8\">\n      <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n      <style>\n        body { font-family: 'Segoe UI', Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; background-color: #f9f9f9; }\n        .email-container { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\n        .content p { margin: 0 0 15px 0; }\n        .highlight { background-color: #f8f9fa; padding: 15px; border-left: 4px solid #007bff; margin: 20px 0; border-radius: 0 4px 4px 0; }\n        .expired-amount { background-color: #fef2f2; padding: 15px; border-left: 4px solid #dc2626; margin: 20px 0; border-radius: 0 4px 4px 0; }\n        .expired-amount p { color: #991b1b; font-weight: 500; }\n        .footer { text-align: center; padding-top: 20px; border-top: 1px solid #e0e0e0; margin-top: 25px; color: #666; font-size: 14px; }\n        .button { display: inline-block; background-color: #007bff; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; margin: 10px 0; }\n      </style>\n    </head>\n    <body>\n      <div class=\"email-container\">\n        <div class=\"content\">\n    `;\n    \n    // Convert plain text to HTML paragraphs\n    const htmlContent = plainText\n      .split('\\n\\n') // Split into paragraphs\n      .filter(p => p.trim()) // Remove empty paragraphs\n      .map(paragraph => {\n        const trimmed = paragraph.trim();\n        // Handle Handlebars variables and links\n        if (trimmed.includes('{{') || trimmed.includes('http')) {\n          // Special formatting for links or variables\n          if (trimmed.includes('http') || trimmed.includes('{{card.url}}')) {\n            return `        <div class=\"highlight\">\n            <p>${trimmed}</p>\n          </div>`;\n          }\n        }\n        // Red highlighting for expired fee amounts and totals\n        if (trimmed.includes('€') && (trimmed.includes('{{#each member.fees.expired}}') || trimmed.includes('{{member.fees.totalExpiredAmount}}') || trimmed.includes('Totaal vervallen bedrag'))) {\n          return `        <div class=\"expired-amount\">\n          <p>${trimmed}</p>\n        </div>`;\n        }\n        return `        <p>${trimmed}</p>`;\n      })\n      .join('\\n');\n    \n    const footer = `\n        </div>\n      </div>\n    </body>\n    </html>`;\n    \n    return baseStyle + htmlContent + footer;\n  }\n\n  private convertToPlainText(content: string): string {\n    if (!content?.trim()) return \"\";\n    \n    // Add professional plain text formatting\n    const lines = content\n      .split('\\n\\n')\n      .filter(p => p.trim())\n      .join('\\n\\n');\n      \n    return lines;\n  }\n\n  // Render template with context\n  async renderTemplate(templateId: string, context: any) {\n    const template = await db.select()\n      .from(emailTemplates)\n      .where(eq(emailTemplates.id, templateId))\n      .limit(1);\n\n    if (!template[0]) throw new Error('Template not found');\n\n    const subjectTemplate = Handlebars.compile(template[0].subject);\n    \n    // Use content field if available (new format), otherwise fall back to old fields\n    let htmlContent: string;\n    let textContent: string;\n    \n    if (template[0].content) {\n      // Generate HTML and text from content field\n      htmlContent = this.convertToHTML(template[0].content);\n      textContent = this.convertToPlainText(template[0].content);\n    } else {\n      // Fall back to old bodyHtml and bodyText fields\n      htmlContent = template[0].bodyHtml || '';\n      textContent = template[0].bodyText || '';\n    }\n    \n    const htmlTemplate = Handlebars.compile(htmlContent);\n    const textTemplate = textContent ? Handlebars.compile(textContent) : null;\n\n    // Add tracking if needed\n    const enrichedContext = {\n      ...context,\n      openUrl: context.openUrl || '',\n      clickUrl: (original: string) => context.clickUrl ? context.clickUrl(original) : original,\n      unsubUrl: context.unsubUrl || '',\n      now: new Date().toISOString(),\n    };\n\n    return {\n      subject: subjectTemplate(enrichedContext),\n      html: htmlTemplate(enrichedContext),\n      text: textTemplate ? textTemplate(enrichedContext) : undefined,\n    };\n  }\n\n  // Segments\n  async listSegments(tenantId: string) {\n    return await db.select()\n      .from(emailSegments)\n      .where(eq(emailSegments.tenantId, tenantId))\n      .orderBy(desc(emailSegments.createdAt));\n  }\n\n  async createSegment(tenantId: string, data: Omit<InsertEmailSegment, 'tenantId'>) {\n    const [segment] = await db.insert(emailSegments)\n      .values({ ...data, tenantId })\n      .returning();\n    return segment;\n  }\n\n  async deleteSegment(tenantId: string, id: string) {\n    await db.delete(emailSegments)\n      .where(and(\n        eq(emailSegments.tenantId, tenantId),\n        eq(emailSegments.id, id)\n      ));\n  }\n\n  async resolveSegment(tenantId: string, rules: any): Promise<Array<{memberId: string, email: string}>> {\n    // Apply filters based on rules\n    const conditions: any[] = [eq(members.tenantId, tenantId)];\n\n    if (rules.memberActive !== undefined) {\n      conditions.push(eq(members.active, rules.memberActive));\n    }\n\n    if (rules.category && Array.isArray(rules.category) && rules.category.length > 0) {\n      conditions.push(inArray(members.category, rules.category));\n    }\n\n    if (rules.gender && Array.isArray(rules.gender) && rules.gender.length > 0) {\n      conditions.push(inArray(members.gender, rules.gender));\n    }\n\n    if (rules.city) {\n      conditions.push(eq(members.city, rules.city));\n    }\n\n    if (rules.createdFrom) {\n      conditions.push(gte(members.createdAt, new Date(rules.createdFrom)));\n    }\n\n    if (rules.createdTo) {\n      conditions.push(lte(members.createdAt, new Date(rules.createdTo)));\n    }\n\n    const results = await db.select({\n      id: members.id,\n      email: members.email,\n      firstName: members.firstName,\n      lastName: members.lastName,\n      category: members.category,\n      active: members.active,\n      city: members.city,\n      postalCode: members.postalCode,\n      createdAt: members.createdAt,\n    })\n    .from(members)\n    .where(and(...conditions));\n\n    return results\n      .filter((member: any) => member.email) // Only members with email\n      .map((member: any) => ({\n        memberId: member.id,\n        email: member.email!,\n      }));\n  }\n\n  async previewSegment(tenantId: string, rules: any) {\n    const members = await this.resolveSegment(tenantId, rules);\n    return {\n      count: members.length,\n      sample: members.slice(0, 10), // First 10 members as preview\n    };\n  }\n\n  // Build member context for template rendering\n  async buildMemberContext(tenantId: string, memberId: string) {\n    // Get member\n    const [member] = await db.select()\n      .from(members)\n      .where(and(\n        eq(members.tenantId, tenantId),\n        eq(members.id, memberId)\n      ));\n\n    if (!member) throw new Error('Member not found');\n\n    // Get tenant\n    const [tenant] = await db.select()\n      .from(tenants)\n      .where(eq(tenants.id, tenantId));\n\n    // Get recent fees\n    const memberFees = await db.select()\n      .from(membershipFees)\n      .where(and(\n        eq(membershipFees.tenantId, tenantId),\n        eq(membershipFees.memberId, memberId)\n      ))\n      .orderBy(desc(membershipFees.periodStart))\n      .limit(5);\n\n    return {\n      member: {\n        ...member,\n        city: member.city || 'Onbekend',\n      },\n      tenant: tenant || { name: 'Organisatie', logoUrl: '', primaryColor: '#000' },\n      card: {\n        url: `${process.env.APP_BASE_URL || 'http://localhost:5000'}/card/${memberId}?standalone=1`\n      },\n      fees: memberFees.map(fee => ({\n        amount: fee.amount,\n        periodStart: fee.periodStart,\n        periodEnd: fee.periodEnd,\n        status: fee.status,\n      })),\n    };\n  }\n\n  // Check if email is suppressed\n  async isEmailSuppressed(tenantId: string, email: string) {\n    const [suppression] = await db.select()\n      .from(emailSuppresses)\n      .where(and(\n        eq(emailSuppresses.tenantId, tenantId),\n        eq(emailSuppresses.email, email)\n      ))\n      .limit(1);\n    return !!suppression;\n  }\n\n  // Generate tracking tokens\n  generateTokens() {\n    return {\n      openToken: randomBytes(16).toString('hex'),\n      clickToken: randomBytes(16).toString('hex'),\n      unsubToken: randomBytes(16).toString('hex'),\n    };\n  }\n\n  // Send single transactional email\n  async sendTransactional(tenantId: string, templateCode: string, options: {\n    memberId?: string;\n    email?: string;\n    context?: any;\n  }) {\n    const [template] = await db.select()\n      .from(emailTemplates)\n      .where(and(\n        eq(emailTemplates.tenantId, tenantId),\n        eq(emailTemplates.code, templateCode)\n      ));\n\n    if (!template) throw new Error('Template not found');\n\n    let context = options.context || {};\n    \n    if (options.memberId) {\n      context = await this.buildMemberContext(tenantId, options.memberId);\n    }\n\n    const email = options.email || context.member?.email;\n    if (!email) throw new Error('No email address provided');\n\n    // Generate tokens\n    const tokens = this.generateTokens();\n    \n    // Render template\n    const rendered = await this.renderTemplate(template.id, {\n      ...context,\n      openUrl: `${process.env.APP_BASE_URL}/api/messages/track/open/{{messageId}}/${tokens.openToken}.png`,\n      clickUrl: (original: string) => `${process.env.APP_BASE_URL}/api/messages/track/click/{{messageId}}/${tokens.clickToken}?u=${encodeURIComponent(original)}`,\n    });\n\n    // Create message record\n    const [message] = await db.insert(emailMessages)\n      .values({\n        tenantId,\n        templateId: template.id,\n        memberId: options.memberId,\n        email,\n        subject: rendered.subject,\n        bodyHtml: rendered.html,\n        bodyText: rendered.text,\n        tokens,\n        status: 'QUEUED',\n      })\n      .returning();\n\n    // Replace placeholder in rendered content\n    const finalHtml = rendered.html.replace(/{{messageId}}/g, message.id);\n    \n    // Update message with final content\n    await db.update(emailMessages)\n      .set({\n        bodyHtml: finalHtml,\n      })\n      .where(eq(emailMessages.id, message.id));\n\n    // Send immediately for transactional\n    try {\n      await this.transporter.sendMail({\n        from: process.env.SMTP_FROM,\n        to: email,\n        subject: rendered.subject,\n        html: finalHtml,\n        text: rendered.text,\n      });\n\n      await db.update(emailMessages)\n        .set({\n          status: 'SENT',\n          sentAt: new Date(),\n        })\n        .where(eq(emailMessages.id, message.id));\n\n      return message;\n    } catch (error: any) {\n      await db.update(emailMessages)\n        .set({\n          status: 'FAILED',\n          lastError: error.message,\n        })\n        .where(eq(emailMessages.id, message.id));\n      \n      throw error;\n    }\n  }\n\n  // Campaigns\n  async listCampaigns(tenantId: string) {\n    return await db.select({\n      campaign: emailCampaigns,\n      template: emailTemplates,\n      segment: emailSegments,\n    })\n    .from(emailCampaigns)\n    .leftJoin(emailTemplates, eq(emailCampaigns.templateId, emailTemplates.id))\n    .leftJoin(emailSegments, eq(emailCampaigns.segmentId, emailSegments.id))\n    .where(eq(emailCampaigns.tenantId, tenantId))\n    .orderBy(desc(emailCampaigns.createdAt));\n  }\n\n  async createCampaign(tenantId: string, data: Omit<InsertEmailCampaign, 'tenantId'>) {\n    const [campaign] = await db.insert(emailCampaigns)\n      .values({ ...data, tenantId })\n      .returning();\n    return campaign;\n  }\n\n  // Queue campaign for sending\n  async queueCampaign(tenantId: string, campaignId: string) {\n    const [campaign] = await db.select({\n      campaign: emailCampaigns,\n      template: emailTemplates,\n      segment: emailSegments,\n    })\n    .from(emailCampaigns)\n    .leftJoin(emailTemplates, eq(emailCampaigns.templateId, emailTemplates.id))\n    .leftJoin(emailSegments, eq(emailCampaigns.segmentId, emailSegments.id))\n    .where(and(\n      eq(emailCampaigns.tenantId, tenantId),\n      eq(emailCampaigns.id, campaignId)\n    ));\n\n    if (!campaign) throw new Error('Campaign not found');\n\n    // Resolve recipients\n    let recipients: Array<{memberId: string, email: string}> = [];\n    \n    if (campaign.segment) {\n      recipients = await this.resolveSegment(tenantId, campaign.segment.rules);\n    }\n\n    // Create message records for each recipient\n    const messages = [];\n    for (const recipient of recipients) {\n      // Skip if suppressed for marketing\n      if (campaign.campaign.kind === 'MARKETING') {\n        const suppressed = await this.isEmailSuppressed(tenantId, recipient.email);\n        if (suppressed) continue;\n      }\n\n      const context = await this.buildMemberContext(tenantId, recipient.memberId);\n      const tokens = this.generateTokens();\n      \n      if (!campaign.template) {\n        throw new Error('Campaign template not found');\n      }\n\n      const rendered = await this.renderTemplate(campaign.template.id, {\n        ...context,\n        openUrl: `${process.env.APP_BASE_URL}/api/messages/track/open/{{messageId}}/${tokens.openToken}.png`,\n        clickUrl: (original: string) => `${process.env.APP_BASE_URL}/api/messages/track/click/{{messageId}}/${tokens.clickToken}?u=${encodeURIComponent(original)}`,\n        unsubUrl: campaign.campaign.kind === 'MARKETING' ? \n          `${process.env.APP_BASE_URL}/email/unsubscribe?token=${tokens.unsubToken}` : undefined,\n      });\n\n      messages.push({\n        tenantId,\n        campaignId,\n        templateId: campaign.template.id,\n        memberId: recipient.memberId,\n        email: recipient.email,\n        subject: rendered.subject,\n        bodyHtml: rendered.html,\n        bodyText: rendered.text,\n        tokens,\n        status: 'QUEUED' as const,\n      });\n    }\n\n    // Batch insert messages\n    if (messages.length > 0) {\n      await db.insert(emailMessages).values(messages);\n    }\n\n    // Update campaign status\n    await db.update(emailCampaigns)\n      .set({\n        status: 'QUEUED',\n        startedAt: new Date(),\n      })\n      .where(eq(emailCampaigns.id, campaignId));\n\n    return { messagesQueued: messages.length };\n  }\n\n  // Worker function to process queued messages\n  async processQueuedMessages(limit: number = 50) {\n    const queuedMessages = await db.select()\n      .from(emailMessages)\n      .where(eq(emailMessages.status, 'QUEUED'))\n      .limit(limit);\n\n    const results = {\n      processed: 0,\n      sent: 0,\n      failed: 0,\n    };\n\n    for (const message of queuedMessages) {\n      try {\n        // Replace placeholders with actual message ID\n        const finalHtml = message.bodyHtml.replace(/{{messageId}}/g, message.id);\n        \n        await this.transporter.sendMail({\n          from: process.env.SMTP_FROM,\n          to: message.email,\n          subject: message.subject,\n          html: finalHtml,\n          text: message.bodyText,\n        });\n\n        await db.update(emailMessages)\n          .set({\n            status: 'SENT',\n            sentAt: new Date(),\n            bodyHtml: finalHtml, // Save final version\n          })\n          .where(eq(emailMessages.id, message.id));\n\n        results.sent++;\n      } catch (error: any) {\n        const retryCount = message.retryCount + 1;\n        const status = retryCount >= 3 ? 'FAILED' : 'QUEUED';\n\n        await db.update(emailMessages)\n          .set({\n            status,\n            lastError: error.message,\n            retryCount,\n          })\n          .where(eq(emailMessages.id, message.id));\n\n        if (status === 'FAILED') {\n          results.failed++;\n        }\n      }\n\n      results.processed++;\n\n      // Rate limiting - wait between sends\n      const ratePerMinute = parseInt(process.env.EMAIL_RATE_PER_MIN || '50');\n      const delayMs = (60 * 1000) / ratePerMinute;\n      await new Promise(resolve => setTimeout(resolve, delayMs));\n    }\n\n    return results;\n  }\n\n  // Tracking\n  async trackOpen(messageId: string, openToken: string) {\n    const [message] = await db.select()\n      .from(emailMessages)\n      .where(eq(emailMessages.id, messageId));\n\n    if (!message || (message.tokens as any)?.openToken !== openToken) {\n      return false;\n    }\n\n    // Only set once\n    if (!message.openedAt) {\n      await db.update(emailMessages)\n        .set({ \n          openedAt: new Date(),\n          status: 'OPENED'\n        })\n        .where(eq(emailMessages.id, messageId));\n    }\n\n    return true;\n  }\n\n  async trackClick(messageId: string, clickToken: string, originalUrl: string) {\n    const [message] = await db.select()\n      .from(emailMessages)\n      .where(eq(emailMessages.id, messageId));\n\n    if (!message || (message.tokens as any)?.clickToken !== clickToken) {\n      return null;\n    }\n\n    // Only set once\n    if (!message.clickedAt) {\n      await db.update(emailMessages)\n        .set({ \n          clickedAt: new Date(),\n          status: 'CLICKED'\n        })\n        .where(eq(emailMessages.id, messageId));\n    }\n\n    return originalUrl;\n  }\n\n  // Suppress email\n  async suppressEmail(tenantId: string, email: string, memberId?: string, reason: string = 'UNSUB_REQUEST') {\n    await db.insert(emailSuppresses)\n      .values({\n        tenantId,\n        email,\n        memberId,\n        reason: reason as any,\n      })\n      .onConflictDoNothing();\n  }\n\n  // Test email\n  async sendTestEmail(tenantId: string, templateId: string, toEmail: string, sampleContext?: any) {\n    const context = sampleContext || await this.buildSampleContext(tenantId);\n    \n    const rendered = await this.renderTemplate(templateId, context);\n    \n    await this.transporter.sendMail({\n      from: process.env.SMTP_FROM,\n      to: toEmail,\n      subject: `[TEST] ${rendered.subject}`,\n      html: rendered.html,\n      text: rendered.text,\n    });\n  }\n\n  private async buildSampleContext(tenantId: string) {\n    // Get first active member as sample\n    const [sampleMember] = await db.select()\n      .from(members)\n      .where(and(\n        eq(members.tenantId, tenantId),\n        eq(members.active, true)\n      ))\n      .limit(1);\n\n    if (sampleMember) {\n      return await this.buildMemberContext(tenantId, sampleMember.id);\n    }\n\n    // Fallback sample data\n    return {\n      member: {\n        firstName: 'Jan',\n        lastName: 'Voorbeeld',\n        email: 'jan@voorbeeld.be',\n        memberNumber: '12345',\n        category: 'STANDAARD',\n        city: 'Antwerpen',\n      },\n      tenant: { name: 'Moskee Voorbeeld', logoUrl: '', primaryColor: '#000' },\n      card: { url: '#' },\n      fees: [],\n    };\n  }\n}","size_bytes":24103},"client/src/pages/public-card.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useParams } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { LiveCard } from \"@/components/cards/live-card\";\nimport { CardCanvas } from \"@/components/card/CardCanvas\";\nimport { Loader2 } from \"lucide-react\";\nimport type { Member, CardMeta, Tenant } from \"@shared/schema\";\nimport backgroundImage from \"@assets/de-lege-achtergrond-van-de-fotograafstudio-samenvatting-achtergrondtextuur-van-schoonheid-donker-en-licht-duidelijk-blauw-koud-grijs-sneeuwwit-gradient-vlakke-muur-en-vloer_1757088942721.jpg\";\n// Interface for the public card API response\ninterface PublicCardData {\n  memberId: string;\n  firstName: string;\n  lastName: string;\n  memberNumber: string;\n  category: 'STUDENT' | 'STANDAARD' | 'SENIOR';\n  votingRights: boolean;\n  status: 'ACTUEEL' | 'NIET_ACTUEEL' | 'VERLOPEN';\n  validUntil: Date | null;\n  qrToken: string;\n  tenant: {\n    id: string;\n    name: string;\n    logoUrl: string | null;\n  };\n}\n\nexport default function PublicCard() {\n  const { memberId } = useParams<{ memberId: string }>();\n  const [isOffline, setIsOffline] = useState(!navigator.onLine);\n\n  // Set body background when component mounts\n  useEffect(() => {\n    document.body.style.margin = '0';\n    document.body.style.padding = '0';\n    document.body.style.minHeight = '100vh';\n    document.body.style.overflow = 'hidden';\n    document.body.style.backgroundImage = `url(${backgroundImage})`;\n    document.body.style.backgroundSize = 'cover';\n    document.body.style.backgroundPosition = 'center';\n    document.body.style.backgroundRepeat = 'no-repeat';\n    \n    return () => {\n      // Reset body styles when component unmounts\n      document.body.style.margin = '';\n      document.body.style.padding = '';\n      document.body.style.minHeight = '';\n      document.body.style.overflow = '';\n      document.body.style.backgroundImage = '';\n      document.body.style.backgroundSize = '';\n      document.body.style.backgroundPosition = '';\n      document.body.style.backgroundRepeat = '';\n    };\n  }, []);\n\n  // Monitor online/offline status\n  useEffect(() => {\n    const handleOnline = () => setIsOffline(false);\n    const handleOffline = () => setIsOffline(true);\n    \n    window.addEventListener('online', handleOnline);\n    window.addEventListener('offline', handleOffline);\n    \n    return () => {\n      window.removeEventListener('online', handleOnline);\n      window.removeEventListener('offline', handleOffline);\n    };\n  }, []);\n\n  // Fetch card data - public endpoint (no auth required)\n  const { data: cardData, isLoading, error, refetch, isRefetching } = useQuery<PublicCardData>({\n    queryKey: [`/api/public/card/${memberId}`],\n    enabled: !!memberId,\n    staleTime: 10 * 1000, // 10 seconds\n    retry: (failureCount, error) => {\n      // Don't retry on 404 or 401 errors\n      if (error && 'status' in error && (error.status === 404 || error.status === 401)) {\n        return false;\n      }\n      return failureCount < 3;\n    }\n  });\n\n  const handleRefresh = () => {\n    refetch();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 flex items-center justify-center p-4\">\n        <div className=\"flex flex-col items-center gap-4\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-white\" />\n          <p className=\"text-white text-lg\">Lidkaart laden...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !cardData) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-700 flex items-center justify-center p-4\">\n        <div className=\"text-center\">\n          <h1 className=\"text-2xl font-bold text-white mb-4\">Lidkaart niet gevonden</h1>\n          <p className=\"text-gray-300 mb-6\">\n            Deze lidkaart bestaat niet of is niet beschikbaar.\n          </p>\n          <button\n            onClick={() => window.close()}\n            className=\"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n          >\n            Sluiten\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Transform API response to match LiveCard expectations\n  const member: Member = {\n    id: cardData.memberId,\n    firstName: cardData.firstName,\n    lastName: cardData.lastName,\n    memberNumber: cardData.memberNumber,\n    category: cardData.category,\n    votingRights: cardData.votingRights,\n    active: true,\n    tenantId: cardData.tenant.id,\n    email: '',\n    phoneNumber: null,\n    address: null,\n    birthDate: null,\n    joinDate: new Date(),\n    notes: null,\n    createdAt: new Date(),\n    updatedAt: new Date()\n  };\n\n  const cardMeta: CardMeta = {\n    id: '',\n    memberId: cardData.memberId,\n    tenantId: cardData.tenant.id,\n    qrToken: cardData.qrToken,\n    status: cardData.status,\n    validUntil: cardData.validUntil,\n    etag: '',\n    createdAt: new Date(),\n    updatedAt: new Date()\n  };\n\n  const tenant: Tenant = {\n    id: cardData.tenant.id,\n    name: cardData.tenant.name,\n    slug: '',\n    logoUrl: cardData.tenant.logoUrl,\n    primaryColor: '#bb2e2e',\n    description: null,\n    contactEmail: '',\n    contactPhone: null,\n    address: null,\n    website: null,\n    active: true,\n    createdAt: new Date(),\n    updatedAt: new Date()\n  };\n\n  return (\n    <div className=\"w-full h-screen flex items-center justify-center p-6\">\n      <CardCanvas className=\"rounded-lg\">\n        <LiveCard\n          member={member}\n          cardMeta={cardMeta}\n          tenant={tenant}\n          onRefresh={handleRefresh}\n          isRefreshing={isRefetching}\n          standalone={true}\n          className=\"h-full w-full\"\n        />\n      </CardCanvas>\n    </div>\n  );\n}","size_bytes":5718},"DEPLOYMENT.md":{"content":"# IDARAH Ledenbeheer - Vercel Deployment Guide\n\n## Stap 1: Vercel Account & Project Setup\n\n1. **Ga naar [vercel.com](https://vercel.com)** en maak een account aan\n2. **Connect je GitHub/GitLab repository** waar deze code staat\n3. **Import het project** in Vercel dashboard\n\n## Stap 2: Environment Variables instellen\n\nIn je Vercel project dashboard, ga naar **Settings > Environment Variables** en voeg toe:\n\n### Database\n```\nDATABASE_URL = [jouw Neon database connection string]\n```\n\n### JWT & Security\n```\nJWT_SECRET = [genereer een random 32+ karakter string]\n```\n\n### Email (optioneel)\n```\nSENDGRID_API_KEY = [jouw SendGrid API key]\n```\n\n### App Settings\n```\nNODE_ENV = production\n```\n\n## Stap 3: Neon Database Setup\n\n1. **Zorg dat je Neon database draait** en toegankelijk is vanuit externe verbindingen\n2. **Run database migraties**:\n   ```bash\n   npm run db:push\n   ```\n\n## Stap 4: Deploy\n\n1. **Push je code** naar je repository\n2. **Vercel deployed automatisch** bij elke push naar main branch\n3. **Check de build logs** in Vercel dashboard voor eventuele errors\n\n## Stap 5: Domein instellen\n\n1. **Ga naar Settings > Domains** in je Vercel project\n2. **Voeg je eigen domein toe** (bijv. ledenbeheer.jouwmoskee.be)\n3. **Update DNS records** zoals Vercel aangeeft\n\n## Troubleshooting\n\n### Build Errors\n- Check of alle environment variables correct zijn ingesteld\n- Zorg dat DATABASE_URL correct is en Neon database bereikbaar is\n\n### Runtime Errors\n- Check Function Logs in Vercel dashboard\n- Verificeer dat alle secrets correct zijn ingesteld\n\n### Performance\n- Vercel optimaliseerd automatisch\n- Edge functions zorgen voor snelle responstijden wereldwijd\n\n## Productie URLs\n\nNa deployment krijg je:\n- **Preview URL**: `https://jouw-project-123.vercel.app`\n- **Production URL**: `https://jouw-domein.be`\n\n## Kosten\n\n- **Vercel**: Gratis voor de meeste use cases, betaal alleen bij veel traffic\n- **Neon**: Gratis tier is ruim voldoende voor kleine tot middelgrote organisaties\n\nJe applicatie is nu live en schaalbaar! 🚀","size_bytes":2029},"sw.js":{"content":"// Service Worker for Digital Membership Card PWA\nconst CACHE_NAME = 'lidkaart-v1';\nconst STATIC_CACHE = 'lidkaart-static-v1';\n\n// Cache static assets with StaleWhileRevalidate\nconst STATIC_ASSETS = [\n  '/',\n  '/manifest.webmanifest',\n  '/icon-192.svg',\n  '/icon-512.svg'\n];\n\n// NetworkFirst strategy for verify API - offline shows NIET_ACTUEEL\nconst VERIFY_API_PATTERN = /\\/api\\/card\\/verify\\//;\n\nself.addEventListener('install', (event) => {\n  console.log('[SW] Installing service worker');\n  \n  event.waitUntil(\n    caches.open(STATIC_CACHE).then((cache) => {\n      return cache.addAll(STATIC_ASSETS);\n    })\n  );\n  \n  // Take control immediately\n  self.skipWaiting();\n});\n\nself.addEventListener('activate', (event) => {\n  console.log('[SW] Activating service worker');\n  \n  event.waitUntil(\n    caches.keys().then((cacheNames) => {\n      return Promise.all(\n        cacheNames.map((cacheName) => {\n          if (cacheName !== CACHE_NAME && cacheName !== STATIC_CACHE) {\n            console.log('[SW] Deleting old cache:', cacheName);\n            return caches.delete(cacheName);\n          }\n        })\n      );\n    }).then(() => {\n      // Take control of all clients\n      return self.clients.claim();\n    })\n  );\n});\n\nself.addEventListener('fetch', (event) => {\n  const { request } = event;\n  const url = new URL(request.url);\n\n  // Handle verify API with NetworkFirst - offline = NIET_ACTUEEL\n  if (VERIFY_API_PATTERN.test(url.pathname)) {\n    event.respondWith(\n      fetch(request)\n        .then((response) => {\n          // Cache successful responses\n          if (response.ok) {\n            const responseClone = response.clone();\n            caches.open(CACHE_NAME).then((cache) => {\n              cache.put(request, responseClone);\n            });\n          }\n          return response;\n        })\n        .catch(() => {\n          // Offline: return NIET_ACTUEEL status\n          return caches.match(request).then((cachedResponse) => {\n            if (cachedResponse) {\n              return cachedResponse.json().then((data) => {\n                // Override status to show card is not current offline\n                const offlineData = {\n                  ...data,\n                  status: 'NIET_ACTUEEL',\n                  refreshedAt: new Date().toISOString(),\n                  offline: true\n                };\n                return new Response(JSON.stringify(offlineData), {\n                  headers: { 'Content-Type': 'application/json' }\n                });\n              });\n            }\n            \n            // No cache: return offline error\n            return new Response(JSON.stringify({\n              error: 'Geen internetverbinding',\n              status: 'NIET_ACTUEEL',\n              offline: true\n            }), {\n              status: 503,\n              headers: { 'Content-Type': 'application/json' }\n            });\n          });\n        })\n    );\n    return;\n  }\n\n  // Handle static assets with StaleWhileRevalidate\n  if (request.destination === 'document' || \n      request.destination === 'script' || \n      request.destination === 'style' ||\n      request.destination === 'image') {\n    \n    event.respondWith(\n      caches.open(STATIC_CACHE).then((cache) => {\n        return cache.match(request).then((cachedResponse) => {\n          const fetchPromise = fetch(request).then((networkResponse) => {\n            // Update cache with fresh response\n            if (networkResponse.ok) {\n              cache.put(request, networkResponse.clone());\n            }\n            return networkResponse;\n          }).catch(() => {\n            // Network failed, return cached version if available\n            return cachedResponse;\n          });\n\n          // Return cached version immediately, update in background\n          return cachedResponse || fetchPromise;\n        });\n      })\n    );\n    return;\n  }\n\n  // Default: network only for other requests\n  event.respondWith(fetch(request));\n});\n\n// Handle background sync for offline actions\nself.addEventListener('sync', (event) => {\n  console.log('[SW] Background sync:', event.tag);\n  \n  if (event.tag === 'card-refresh') {\n    event.waitUntil(\n      // Clear verify cache to force fresh fetch on next request\n      caches.open(CACHE_NAME).then((cache) => {\n        return cache.keys().then((keys) => {\n          return Promise.all(\n            keys.filter(key => VERIFY_API_PATTERN.test(key.url))\n                .map(key => cache.delete(key))\n          );\n        });\n      })\n    );\n  }\n});\n\n// Push notifications (if needed later)\nself.addEventListener('push', (event) => {\n  console.log('[SW] Push received');\n  // Handle push notifications for card updates\n});","size_bytes":4657},"api/server.js":{"content":"// Vercel serverless function for API endpoints\nconst express = require('express');\nconst path = require('path');\n\n// Import the built Express server\nlet app;\ntry {\n  app = require('../dist/index.js').default;\n} catch (error) {\n  console.error('Error loading server:', error);\n  \n  // Fallback minimal server\n  app = express();\n  app.use(express.json());\n  app.get('/api/health', (req, res) => {\n    res.json({ status: 'Server loading...', error: error.message });\n  });\n}\n\nmodule.exports = app;","size_bytes":495},"assets/index-D4dumhiK.js":{"content":"var UT=e=>{throw TypeError(e)};var Y2=(e,t,r)=>t.has(e)||UT(\"Cannot \"+r);var le=(e,t,r)=>(Y2(e,t,\"read from private field\"),r?r.call(e):t.get(e)),wt=(e,t,r)=>t.has(e)?UT(\"Cannot add the same private member more than once\"):t instanceof WeakSet?t.add(e):t.set(e,r),lt=(e,t,r,n)=>(Y2(e,t,\"write to private field\"),n?n.call(e,r):t.set(e,r),r),Yt=(e,t,r)=>(Y2(e,t,\"access private method\"),r);var rv=(e,t,r,n)=>({set _(a){lt(e,t,a,r)},get _(){return le(e,t,n)}});function Mq(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!=\"string\"&&!Array.isArray(n)){for(const a in n)if(a!==\"default\"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}))}(function(){const t=document.createElement(\"link\").relList;if(t&&t.supports&&t.supports(\"modulepreload\"))return;for(const a of document.querySelectorAll('link[rel=\"modulepreload\"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type===\"childList\")for(const o of i.addedNodes)o.tagName===\"LINK\"&&o.rel===\"modulepreload\"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin===\"use-credentials\"?i.credentials=\"include\":a.crossOrigin===\"anonymous\"?i.credentials=\"omit\":i.credentials=\"same-origin\",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var gl=typeof globalThis<\"u\"?globalThis:typeof window<\"u\"?window:typeof global<\"u\"?global:typeof self<\"u\"?self:{};function Sr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,\"default\")?e.default:e}var G8={exports:{}},zb={},K8={exports:{}},sr={};/**\n * @license React\n * react.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var mx=Symbol.for(\"react.element\"),Dq=Symbol.for(\"react.portal\"),Iq=Symbol.for(\"react.fragment\"),Fq=Symbol.for(\"react.strict_mode\"),Rq=Symbol.for(\"react.profiler\"),Lq=Symbol.for(\"react.provider\"),$q=Symbol.for(\"react.context\"),Bq=Symbol.for(\"react.forward_ref\"),Vq=Symbol.for(\"react.suspense\"),zq=Symbol.for(\"react.memo\"),Uq=Symbol.for(\"react.lazy\"),WT=Symbol.iterator;function Wq(e){return e===null||typeof e!=\"object\"?null:(e=WT&&e[WT]||e[\"@@iterator\"],typeof e==\"function\"?e:null)}var Y8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q8=Object.assign,X8={};function M0(e,t,r){this.props=e,this.context=t,this.refs=X8,this.updater=r||Y8}M0.prototype.isReactComponent={};M0.prototype.setState=function(e,t){if(typeof e!=\"object\"&&typeof e!=\"function\"&&e!=null)throw Error(\"setState(...): takes an object of state variables to update or a function which returns an object of state variables.\");this.updater.enqueueSetState(this,e,t,\"setState\")};M0.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,\"forceUpdate\")};function Z8(){}Z8.prototype=M0.prototype;function _k(e,t,r){this.props=e,this.context=t,this.refs=X8,this.updater=r||Y8}var Ek=_k.prototype=new Z8;Ek.constructor=_k;q8(Ek,M0.prototype);Ek.isPureReactComponent=!0;var HT=Array.isArray,Q8=Object.prototype.hasOwnProperty,kk={current:null},J8={key:!0,ref:!0,__self:!0,__source:!0};function eF(e,t,r){var n,a={},i=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=\"\"+t.key),t)Q8.call(t,n)&&!J8.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:mx,type:e,key:i,ref:o,props:a,_owner:kk.current}}function Hq(e,t){return{$$typeof:mx,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ck(e){return typeof e==\"object\"&&e!==null&&e.$$typeof===mx}function Gq(e){var t={\"=\":\"=0\",\":\":\"=2\"};return\"$\"+e.replace(/[=:]/g,function(r){return t[r]})}var GT=/\\/+/g;function q2(e,t){return typeof e==\"object\"&&e!==null&&e.key!=null?Gq(\"\"+e.key):t.toString(36)}function ay(e,t,r,n,a){var i=typeof e;(i===\"undefined\"||i===\"boolean\")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case\"string\":case\"number\":o=!0;break;case\"object\":switch(e.$$typeof){case mx:case Dq:o=!0}}if(o)return o=e,a=a(o),e=n===\"\"?\".\"+q2(o,0):n,HT(a)?(r=\"\",e!=null&&(r=e.replace(GT,\"$&/\")+\"/\"),ay(a,t,r,\"\",function(u){return u})):a!=null&&(Ck(a)&&(a=Hq(a,r+(!a.key||o&&o.key===a.key?\"\":(\"\"+a.key).replace(GT,\"$&/\")+\"/\")+e)),t.push(a)),1;if(o=0,n=n===\"\"?\".\":n+\":\",HT(e))for(var l=0;l<e.length;l++){i=e[l];var c=n+q2(i,l);o+=ay(i,t,r,c,a)}else if(c=Wq(e),typeof c==\"function\")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=n+q2(i,l++),o+=ay(i,t,r,c,a);else if(i===\"object\")throw t=String(e),Error(\"Objects are not valid as a React child (found: \"+(t===\"[object Object]\"?\"object with keys {\"+Object.keys(e).join(\", \")+\"}\":t)+\"). If you meant to render a collection of children, use an array instead.\");return o}function nv(e,t,r){if(e==null)return e;var n=[],a=0;return ay(e,n,\"\",\"\",function(i){return t.call(r,i,a++)}),n}function Kq(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var rs={current:null},sy={transition:null},Yq={ReactCurrentDispatcher:rs,ReactCurrentBatchConfig:sy,ReactCurrentOwner:kk};function tF(){throw Error(\"act(...) is not supported in production builds of React.\")}sr.Children={map:nv,forEach:function(e,t,r){nv(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return nv(e,function(){t++}),t},toArray:function(e){return nv(e,function(t){return t})||[]},only:function(e){if(!Ck(e))throw Error(\"React.Children.only expected to receive a single React element child.\");return e}};sr.Component=M0;sr.Fragment=Iq;sr.Profiler=Rq;sr.PureComponent=_k;sr.StrictMode=Fq;sr.Suspense=Vq;sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yq;sr.act=tF;sr.cloneElement=function(e,t,r){if(e==null)throw Error(\"React.cloneElement(...): The argument must be a React element, but you passed \"+e+\".\");var n=q8({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=kk.current),t.key!==void 0&&(a=\"\"+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Q8.call(t,c)&&!J8.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:mx,type:e.type,key:a,ref:i,props:n,_owner:o}};sr.createContext=function(e){return e={$$typeof:$q,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Lq,_context:e},e.Consumer=e};sr.createElement=eF;sr.createFactory=function(e){var t=eF.bind(null,e);return t.type=e,t};sr.createRef=function(){return{current:null}};sr.forwardRef=function(e){return{$$typeof:Bq,render:e}};sr.isValidElement=Ck;sr.lazy=function(e){return{$$typeof:Uq,_payload:{_status:-1,_result:e},_init:Kq}};sr.memo=function(e,t){return{$$typeof:zq,type:e,compare:t===void 0?null:t}};sr.startTransition=function(e){var t=sy.transition;sy.transition={};try{e()}finally{sy.transition=t}};sr.unstable_act=tF;sr.useCallback=function(e,t){return rs.current.useCallback(e,t)};sr.useContext=function(e){return rs.current.useContext(e)};sr.useDebugValue=function(){};sr.useDeferredValue=function(e){return rs.current.useDeferredValue(e)};sr.useEffect=function(e,t){return rs.current.useEffect(e,t)};sr.useId=function(){return rs.current.useId()};sr.useImperativeHandle=function(e,t,r){return rs.current.useImperativeHandle(e,t,r)};sr.useInsertionEffect=function(e,t){return rs.current.useInsertionEffect(e,t)};sr.useLayoutEffect=function(e,t){return rs.current.useLayoutEffect(e,t)};sr.useMemo=function(e,t){return rs.current.useMemo(e,t)};sr.useReducer=function(e,t,r){return rs.current.useReducer(e,t,r)};sr.useRef=function(e){return rs.current.useRef(e)};sr.useState=function(e){return rs.current.useState(e)};sr.useSyncExternalStore=function(e,t,r){return rs.current.useSyncExternalStore(e,t,r)};sr.useTransition=function(){return rs.current.useTransition()};sr.version=\"18.3.1\";K8.exports=sr;var j=K8.exports;const Y=Sr(j),rF=Mq({__proto__:null,default:Y},[j]);/**\n * @license React\n * react-jsx-runtime.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var qq=j,Xq=Symbol.for(\"react.element\"),Zq=Symbol.for(\"react.fragment\"),Qq=Object.prototype.hasOwnProperty,Jq=qq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eX={key:!0,ref:!0,__self:!0,__source:!0};function nF(e,t,r){var n,a={},i=null,o=null;r!==void 0&&(i=\"\"+r),t.key!==void 0&&(i=\"\"+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)Qq.call(t,n)&&!eX.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Xq,type:e,key:i,ref:o,props:a,_owner:Jq.current}}zb.Fragment=Zq;zb.jsx=nF;zb.jsxs=nF;G8.exports=zb;var s=G8.exports,aF={exports:{}},Us={},sF={exports:{}},iF={};/**\n * @license React\n * scheduler.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */(function(e){function t(M,F){var G=M.length;M.push(F);e:for(;0<G;){var ae=G-1>>>1,P=M[ae];if(0<a(P,F))M[ae]=F,M[G]=P,G=ae;else break e}}function r(M){return M.length===0?null:M[0]}function n(M){if(M.length===0)return null;var F=M[0],G=M.pop();if(G!==F){M[0]=G;e:for(var ae=0,P=M.length,z=P>>>1;ae<z;){var B=2*(ae+1)-1,U=M[B],ne=B+1,X=M[ne];if(0>a(U,G))ne<P&&0>a(X,U)?(M[ae]=X,M[ne]=G,ae=ne):(M[ae]=U,M[B]=G,ae=B);else if(ne<P&&0>a(X,G))M[ae]=X,M[ne]=G,ae=ne;else break e}}return F}function a(M,F){var G=M.sortIndex-F.sortIndex;return G!==0?G:M.id-F.id}if(typeof performance==\"object\"&&typeof performance.now==\"function\"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,m=!1,g=!1,p=!1,x=typeof setTimeout==\"function\"?setTimeout:null,b=typeof clearTimeout==\"function\"?clearTimeout:null,y=typeof setImmediate<\"u\"?setImmediate:null;typeof navigator<\"u\"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=M)n(u),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(u)}}function S(M){if(p=!1,v(M),!g)if(r(c)!==null)g=!0,L(w);else{var F=r(u);F!==null&&I(S,F.startTime-M)}}function w(M,F){g=!1,p&&(p=!1,b(E),E=-1),m=!0;var G=h;try{for(v(F),f=r(c);f!==null&&(!(f.expirationTime>F)||M&&!C());){var ae=f.callback;if(typeof ae==\"function\"){f.callback=null,h=f.priorityLevel;var P=ae(f.expirationTime<=F);F=e.unstable_now(),typeof P==\"function\"?f.callback=P:f===r(c)&&n(c),v(F)}else n(c);f=r(c)}if(f!==null)var z=!0;else{var B=r(u);B!==null&&I(S,B.startTime-F),z=!1}return z}finally{f=null,h=G,m=!1}}var N=!1,_=null,E=-1,k=5,O=-1;function C(){return!(e.unstable_now()-O<k)}function A(){if(_!==null){var M=e.unstable_now();O=M;var F=!0;try{F=_(!0,M)}finally{F?D():(N=!1,_=null)}}else N=!1}var D;if(typeof y==\"function\")D=function(){y(A)};else if(typeof MessageChannel<\"u\"){var R=new MessageChannel,T=R.port2;R.port1.onmessage=A,D=function(){T.postMessage(null)}}else D=function(){x(A,0)};function L(M){_=M,N||(N=!0,D())}function I(M,F){E=x(function(){M(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,L(w))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error(\"forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported\"):k=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(M){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var G=h;h=F;try{return M()}finally{h=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,F){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var G=h;h=M;try{return F()}finally{h=G}},e.unstable_scheduleCallback=function(M,F,G){var ae=e.unstable_now();switch(typeof G==\"object\"&&G!==null?(G=G.delay,G=typeof G==\"number\"&&0<G?ae+G:ae):G=ae,M){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=G+P,M={id:d++,callback:F,priorityLevel:M,startTime:G,expirationTime:P,sortIndex:-1},G>ae?(M.sortIndex=G,t(u,M),r(c)===null&&M===r(u)&&(p?(b(E),E=-1):p=!0,I(S,G-ae))):(M.sortIndex=P,t(c,M),g||m||(g=!0,L(w))),M},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(M){var F=h;return function(){var G=h;h=F;try{return M.apply(this,arguments)}finally{h=G}}}})(iF);sF.exports=iF;var tX=sF.exports;/**\n * @license React\n * react-dom.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var rX=j,Bs=tX;function Be(e){for(var t=\"https://reactjs.org/docs/error-decoder.html?invariant=\"+e,r=1;r<arguments.length;r++)t+=\"&args[]=\"+encodeURIComponent(arguments[r]);return\"Minified React error #\"+e+\"; visit \"+t+\" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\"}var oF=new Set,Pp={};function Yd(e,t){Rh(e,t),Rh(e+\"Capture\",t)}function Rh(e,t){for(Pp[e]=t,e=0;e<t.length;e++)oF.add(t[e])}var Ol=!(typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"),YN=Object.prototype.hasOwnProperty,nX=/^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$/,KT={},YT={};function aX(e){return YN.call(YT,e)?!0:YN.call(KT,e)?!1:nX.test(e)?YT[e]=!0:(KT[e]=!0,!1)}function sX(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case\"function\":case\"symbol\":return!0;case\"boolean\":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!==\"data-\"&&e!==\"aria-\");default:return!1}}function iX(e,t,r,n){if(t===null||typeof t>\"u\"||sX(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ns(e,t,r,n,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var ha={};\"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style\".split(\" \").forEach(function(e){ha[e]=new ns(e,0,!1,e,null,!1,!1)});[[\"acceptCharset\",\"accept-charset\"],[\"className\",\"class\"],[\"htmlFor\",\"for\"],[\"httpEquiv\",\"http-equiv\"]].forEach(function(e){var t=e[0];ha[t]=new ns(t,1,!1,e[1],null,!1,!1)});[\"contentEditable\",\"draggable\",\"spellCheck\",\"value\"].forEach(function(e){ha[e]=new ns(e,2,!1,e.toLowerCase(),null,!1,!1)});[\"autoReverse\",\"externalResourcesRequired\",\"focusable\",\"preserveAlpha\"].forEach(function(e){ha[e]=new ns(e,2,!1,e,null,!1,!1)});\"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope\".split(\" \").forEach(function(e){ha[e]=new ns(e,3,!1,e.toLowerCase(),null,!1,!1)});[\"checked\",\"multiple\",\"muted\",\"selected\"].forEach(function(e){ha[e]=new ns(e,3,!0,e,null,!1,!1)});[\"capture\",\"download\"].forEach(function(e){ha[e]=new ns(e,4,!1,e,null,!1,!1)});[\"cols\",\"rows\",\"size\",\"span\"].forEach(function(e){ha[e]=new ns(e,6,!1,e,null,!1,!1)});[\"rowSpan\",\"start\"].forEach(function(e){ha[e]=new ns(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ak=/[\\-:]([a-z])/g;function Tk(e){return e[1].toUpperCase()}\"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height\".split(\" \").forEach(function(e){var t=e.replace(Ak,Tk);ha[t]=new ns(t,1,!1,e,null,!1,!1)});\"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type\".split(\" \").forEach(function(e){var t=e.replace(Ak,Tk);ha[t]=new ns(t,1,!1,e,\"http://www.w3.org/1999/xlink\",!1,!1)});[\"xml:base\",\"xml:lang\",\"xml:space\"].forEach(function(e){var t=e.replace(Ak,Tk);ha[t]=new ns(t,1,!1,e,\"http://www.w3.org/XML/1998/namespace\",!1,!1)});[\"tabIndex\",\"crossOrigin\"].forEach(function(e){ha[e]=new ns(e,1,!1,e.toLowerCase(),null,!1,!1)});ha.xlinkHref=new ns(\"xlinkHref\",1,!1,\"xlink:href\",\"http://www.w3.org/1999/xlink\",!0,!1);[\"src\",\"href\",\"action\",\"formAction\"].forEach(function(e){ha[e]=new ns(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ok(e,t,r,n){var a=ha.hasOwnProperty(t)?ha[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!==\"o\"&&t[0]!==\"O\"||t[1]!==\"n\"&&t[1]!==\"N\")&&(iX(t,r,a,n)&&(r=null),n||a===null?aX(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,\"\"+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:\"\":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?\"\":\"\"+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Hl=rX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,av=Symbol.for(\"react.element\"),If=Symbol.for(\"react.portal\"),Ff=Symbol.for(\"react.fragment\"),Pk=Symbol.for(\"react.strict_mode\"),qN=Symbol.for(\"react.profiler\"),lF=Symbol.for(\"react.provider\"),cF=Symbol.for(\"react.context\"),Mk=Symbol.for(\"react.forward_ref\"),XN=Symbol.for(\"react.suspense\"),ZN=Symbol.for(\"react.suspense_list\"),Dk=Symbol.for(\"react.memo\"),lc=Symbol.for(\"react.lazy\"),uF=Symbol.for(\"react.offscreen\"),qT=Symbol.iterator;function xm(e){return e===null||typeof e!=\"object\"?null:(e=qT&&e[qT]||e[\"@@iterator\"],typeof e==\"function\"?e:null)}var cn=Object.assign,X2;function Hm(e){if(X2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\\n( *(at )?)/);X2=t&&t[1]||\"\"}return`\n`+X2+e}var Z2=!1;function Q2(e,t){if(!e||Z2)return\"\";Z2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,\"props\",{set:function(){throw Error()}}),typeof Reflect==\"object\"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack==\"string\"){for(var a=u.stack.split(`\n`),i=n.stack.split(`\n`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`\n`+a[o].replace(\" at new \",\" at \");return e.displayName&&c.includes(\"<anonymous>\")&&(c=c.replace(\"<anonymous>\",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Z2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:\"\")?Hm(e):\"\"}function oX(e){switch(e.tag){case 5:return Hm(e.type);case 16:return Hm(\"Lazy\");case 13:return Hm(\"Suspense\");case 19:return Hm(\"SuspenseList\");case 0:case 2:case 15:return e=Q2(e.type,!1),e;case 11:return e=Q2(e.type.render,!1),e;case 1:return e=Q2(e.type,!0),e;default:return\"\"}}function QN(e){if(e==null)return null;if(typeof e==\"function\")return e.displayName||e.name||null;if(typeof e==\"string\")return e;switch(e){case Ff:return\"Fragment\";case If:return\"Portal\";case qN:return\"Profiler\";case Pk:return\"StrictMode\";case XN:return\"Suspense\";case ZN:return\"SuspenseList\"}if(typeof e==\"object\")switch(e.$$typeof){case cF:return(e.displayName||\"Context\")+\".Consumer\";case lF:return(e._context.displayName||\"Context\")+\".Provider\";case Mk:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||\"\",e=e!==\"\"?\"ForwardRef(\"+e+\")\":\"ForwardRef\"),e;case Dk:return t=e.displayName||null,t!==null?t:QN(e.type)||\"Memo\";case lc:t=e._payload,e=e._init;try{return QN(e(t))}catch{}}return null}function lX(e){var t=e.type;switch(e.tag){case 24:return\"Cache\";case 9:return(t.displayName||\"Context\")+\".Consumer\";case 10:return(t._context.displayName||\"Context\")+\".Provider\";case 18:return\"DehydratedFragment\";case 11:return e=t.render,e=e.displayName||e.name||\"\",t.displayName||(e!==\"\"?\"ForwardRef(\"+e+\")\":\"ForwardRef\");case 7:return\"Fragment\";case 5:return t;case 4:return\"Portal\";case 3:return\"Root\";case 6:return\"Text\";case 16:return QN(t);case 8:return t===Pk?\"StrictMode\":\"Mode\";case 22:return\"Offscreen\";case 12:return\"Profiler\";case 21:return\"Scope\";case 13:return\"Suspense\";case 19:return\"SuspenseList\";case 25:return\"TracingMarker\";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t==\"function\")return t.displayName||t.name||null;if(typeof t==\"string\")return t}return null}function zc(e){switch(typeof e){case\"boolean\":case\"number\":case\"string\":case\"undefined\":return e;case\"object\":return e;default:return\"\"}}function dF(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()===\"input\"&&(t===\"checkbox\"||t===\"radio\")}function cX(e){var t=dF(e)?\"checked\":\"value\",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=\"\"+e[t];if(!e.hasOwnProperty(t)&&typeof r<\"u\"&&typeof r.get==\"function\"&&typeof r.set==\"function\"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=\"\"+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=\"\"+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sv(e){e._valueTracker||(e._valueTracker=cX(e))}function fF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n=\"\";return e&&(n=dF(e)?e.checked?\"true\":\"false\":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function ky(e){if(e=e||(typeof document<\"u\"?document:void 0),typeof e>\"u\")return null;try{return e.activeElement||e.body}catch{return e.body}}function JN(e,t){var r=t.checked;return cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function XT(e,t){var r=t.defaultValue==null?\"\":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=zc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type===\"checkbox\"||t.type===\"radio\"?t.checked!=null:t.value!=null}}function hF(e,t){t=t.checked,t!=null&&Ok(e,\"checked\",t,!1)}function eS(e,t){hF(e,t);var r=zc(t.value),n=t.type;if(r!=null)n===\"number\"?(r===0&&e.value===\"\"||e.value!=r)&&(e.value=\"\"+r):e.value!==\"\"+r&&(e.value=\"\"+r);else if(n===\"submit\"||n===\"reset\"){e.removeAttribute(\"value\");return}t.hasOwnProperty(\"value\")?tS(e,t.type,r):t.hasOwnProperty(\"defaultValue\")&&tS(e,t.type,zc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ZT(e,t,r){if(t.hasOwnProperty(\"value\")||t.hasOwnProperty(\"defaultValue\")){var n=t.type;if(!(n!==\"submit\"&&n!==\"reset\"||t.value!==void 0&&t.value!==null))return;t=\"\"+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==\"\"&&(e.name=\"\"),e.defaultChecked=!!e._wrapperState.initialChecked,r!==\"\"&&(e.name=r)}function tS(e,t,r){(t!==\"number\"||ky(e.ownerDocument)!==e)&&(r==null?e.defaultValue=\"\"+e._wrapperState.initialValue:e.defaultValue!==\"\"+r&&(e.defaultValue=\"\"+r))}var Gm=Array.isArray;function rh(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t[\"$\"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty(\"$\"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=\"\"+zc(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function rS(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Be(91));return cn({},t,{value:void 0,defaultValue:void 0,children:\"\"+e._wrapperState.initialValue})}function QT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Be(92));if(Gm(r)){if(1<r.length)throw Error(Be(93));r=r[0]}t=r}t==null&&(t=\"\"),r=t}e._wrapperState={initialValue:zc(r)}}function mF(e,t){var r=zc(t.value),n=zc(t.defaultValue);r!=null&&(r=\"\"+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=\"\"+n)}function JT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==\"\"&&t!==null&&(e.value=t)}function pF(e){switch(e){case\"svg\":return\"http://www.w3.org/2000/svg\";case\"math\":return\"http://www.w3.org/1998/Math/MathML\";default:return\"http://www.w3.org/1999/xhtml\"}}function nS(e,t){return e==null||e===\"http://www.w3.org/1999/xhtml\"?pF(t):e===\"http://www.w3.org/2000/svg\"&&t===\"foreignObject\"?\"http://www.w3.org/1999/xhtml\":e}var iv,gF=function(e){return typeof MSApp<\"u\"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!==\"http://www.w3.org/2000/svg\"||\"innerHTML\"in e)e.innerHTML=t;else{for(iv=iv||document.createElement(\"div\"),iv.innerHTML=\"<svg>\"+t.valueOf().toString()+\"</svg>\",t=iv.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mp(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ip={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uX=[\"Webkit\",\"ms\",\"Moz\",\"O\"];Object.keys(ip).forEach(function(e){uX.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ip[t]=ip[e]})});function xF(e,t,r){return t==null||typeof t==\"boolean\"||t===\"\"?\"\":r||typeof t!=\"number\"||t===0||ip.hasOwnProperty(e)&&ip[e]?(\"\"+t).trim():t+\"px\"}function vF(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf(\"--\")===0,a=xF(r,t[r],n);r===\"float\"&&(r=\"cssFloat\"),n?e.setProperty(r,a):e[r]=a}}var dX=cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function aS(e,t){if(t){if(dX[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Be(60));if(typeof t.dangerouslySetInnerHTML!=\"object\"||!(\"__html\"in t.dangerouslySetInnerHTML))throw Error(Be(61))}if(t.style!=null&&typeof t.style!=\"object\")throw Error(Be(62))}}function sS(e,t){if(e.indexOf(\"-\")===-1)return typeof t.is==\"string\";switch(e){case\"annotation-xml\":case\"color-profile\":case\"font-face\":case\"font-face-src\":case\"font-face-uri\":case\"font-face-format\":case\"font-face-name\":case\"missing-glyph\":return!1;default:return!0}}var iS=null;function Ik(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oS=null,nh=null,ah=null;function eO(e){if(e=xx(e)){if(typeof oS!=\"function\")throw Error(Be(280));var t=e.stateNode;t&&(t=Kb(t),oS(e.stateNode,e.type,t))}}function yF(e){nh?ah?ah.push(e):ah=[e]:nh=e}function bF(){if(nh){var e=nh,t=ah;if(ah=nh=null,eO(e),t)for(e=0;e<t.length;e++)eO(t[e])}}function wF(e,t){return e(t)}function jF(){}var J2=!1;function NF(e,t,r){if(J2)return e(t,r);J2=!0;try{return wF(e,t,r)}finally{J2=!1,(nh!==null||ah!==null)&&(jF(),bF())}}function Dp(e,t){var r=e.stateNode;if(r===null)return null;var n=Kb(r);if(n===null)return null;r=n[t];e:switch(t){case\"onClick\":case\"onClickCapture\":case\"onDoubleClick\":case\"onDoubleClickCapture\":case\"onMouseDown\":case\"onMouseDownCapture\":case\"onMouseMove\":case\"onMouseMoveCapture\":case\"onMouseUp\":case\"onMouseUpCapture\":case\"onMouseEnter\":(n=!n.disabled)||(e=e.type,n=!(e===\"button\"||e===\"input\"||e===\"select\"||e===\"textarea\")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!=\"function\")throw Error(Be(231,t,typeof r));return r}var lS=!1;if(Ol)try{var vm={};Object.defineProperty(vm,\"passive\",{get:function(){lS=!0}}),window.addEventListener(\"test\",vm,vm),window.removeEventListener(\"test\",vm,vm)}catch{lS=!1}function fX(e,t,r,n,a,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var op=!1,Cy=null,Ay=!1,cS=null,hX={onError:function(e){op=!0,Cy=e}};function mX(e,t,r,n,a,i,o,l,c){op=!1,Cy=null,fX.apply(hX,arguments)}function pX(e,t,r,n,a,i,o,l,c){if(mX.apply(this,arguments),op){if(op){var u=Cy;op=!1,Cy=null}else throw Error(Be(198));Ay||(Ay=!0,cS=u)}}function qd(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function SF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function tO(e){if(qd(e)!==e)throw Error(Be(188))}function gX(e){var t=e.alternate;if(!t){if(t=qd(e),t===null)throw Error(Be(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return tO(a),e;if(i===n)return tO(a),t;i=i.sibling}throw Error(Be(188))}if(r.return!==n.return)r=a,n=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o)throw Error(Be(189))}}if(r.alternate!==n)throw Error(Be(190))}if(r.tag!==3)throw Error(Be(188));return r.stateNode.current===r?e:t}function _F(e){return e=gX(e),e!==null?EF(e):null}function EF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=EF(e);if(t!==null)return t;e=e.sibling}return null}var kF=Bs.unstable_scheduleCallback,rO=Bs.unstable_cancelCallback,xX=Bs.unstable_shouldYield,vX=Bs.unstable_requestPaint,bn=Bs.unstable_now,yX=Bs.unstable_getCurrentPriorityLevel,Fk=Bs.unstable_ImmediatePriority,CF=Bs.unstable_UserBlockingPriority,Ty=Bs.unstable_NormalPriority,bX=Bs.unstable_LowPriority,AF=Bs.unstable_IdlePriority,Ub=null,Io=null;function wX(e){if(Io&&typeof Io.onCommitFiberRoot==\"function\")try{Io.onCommitFiberRoot(Ub,e,void 0,(e.current.flags&128)===128)}catch{}}var Zi=Math.clz32?Math.clz32:SX,jX=Math.log,NX=Math.LN2;function SX(e){return e>>>=0,e===0?32:31-(jX(e)/NX|0)|0}var ov=64,lv=4194304;function Km(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Oy(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Km(l):(i&=o,i!==0&&(n=Km(i)))}else o=r&~a,o!==0?n=Km(o):i!==0&&(n=Km(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Zi(t),a=1<<r,n|=e[r],t&=~a;return n}function _X(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function EX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Zi(i),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=_X(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function uS(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function TF(){var e=ov;return ov<<=1,!(ov&4194240)&&(ov=64),e}function ej(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function px(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Zi(t),e[t]=r}function kX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Zi(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Rk(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Zi(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ar=0;function OF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var PF,Lk,MF,DF,IF,dS=!1,cv=[],Pc=null,Mc=null,Dc=null,Ip=new Map,Fp=new Map,dc=[],CX=\"mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit\".split(\" \");function nO(e,t){switch(e){case\"focusin\":case\"focusout\":Pc=null;break;case\"dragenter\":case\"dragleave\":Mc=null;break;case\"mouseover\":case\"mouseout\":Dc=null;break;case\"pointerover\":case\"pointerout\":Ip.delete(t.pointerId);break;case\"gotpointercapture\":case\"lostpointercapture\":Fp.delete(t.pointerId)}}function ym(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=xx(t),t!==null&&Lk(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function AX(e,t,r,n,a){switch(t){case\"focusin\":return Pc=ym(Pc,e,t,r,n,a),!0;case\"dragenter\":return Mc=ym(Mc,e,t,r,n,a),!0;case\"mouseover\":return Dc=ym(Dc,e,t,r,n,a),!0;case\"pointerover\":var i=a.pointerId;return Ip.set(i,ym(Ip.get(i)||null,e,t,r,n,a)),!0;case\"gotpointercapture\":return i=a.pointerId,Fp.set(i,ym(Fp.get(i)||null,e,t,r,n,a)),!0}return!1}function FF(e){var t=Lu(e.target);if(t!==null){var r=qd(t);if(r!==null){if(t=r.tag,t===13){if(t=SF(r),t!==null){e.blockedOn=t,IF(e.priority,function(){MF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function iy(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=fS(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);iS=n,r.target.dispatchEvent(n),iS=null}else return t=xx(r),t!==null&&Lk(t),e.blockedOn=r,!1;t.shift()}return!0}function aO(e,t,r){iy(e)&&r.delete(t)}function TX(){dS=!1,Pc!==null&&iy(Pc)&&(Pc=null),Mc!==null&&iy(Mc)&&(Mc=null),Dc!==null&&iy(Dc)&&(Dc=null),Ip.forEach(aO),Fp.forEach(aO)}function bm(e,t){e.blockedOn===t&&(e.blockedOn=null,dS||(dS=!0,Bs.unstable_scheduleCallback(Bs.unstable_NormalPriority,TX)))}function Rp(e){function t(a){return bm(a,e)}if(0<cv.length){bm(cv[0],e);for(var r=1;r<cv.length;r++){var n=cv[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Pc!==null&&bm(Pc,e),Mc!==null&&bm(Mc,e),Dc!==null&&bm(Dc,e),Ip.forEach(t),Fp.forEach(t),r=0;r<dc.length;r++)n=dc[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<dc.length&&(r=dc[0],r.blockedOn===null);)FF(r),r.blockedOn===null&&dc.shift()}var sh=Hl.ReactCurrentBatchConfig,Py=!0;function OX(e,t,r,n){var a=Ar,i=sh.transition;sh.transition=null;try{Ar=1,$k(e,t,r,n)}finally{Ar=a,sh.transition=i}}function PX(e,t,r,n){var a=Ar,i=sh.transition;sh.transition=null;try{Ar=4,$k(e,t,r,n)}finally{Ar=a,sh.transition=i}}function $k(e,t,r,n){if(Py){var a=fS(e,t,r,n);if(a===null)uj(e,t,n,My,r),nO(e,n);else if(AX(a,e,t,r,n))n.stopPropagation();else if(nO(e,n),t&4&&-1<CX.indexOf(e)){for(;a!==null;){var i=xx(a);if(i!==null&&PF(i),i=fS(e,t,r,n),i===null&&uj(e,t,n,My,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else uj(e,t,n,null,r)}}var My=null;function fS(e,t,r,n){if(My=null,e=Ik(n),e=Lu(e),e!==null)if(t=qd(e),t===null)e=null;else if(r=t.tag,r===13){if(e=SF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return My=e,null}function RF(e){switch(e){case\"cancel\":case\"click\":case\"close\":case\"contextmenu\":case\"copy\":case\"cut\":case\"auxclick\":case\"dblclick\":case\"dragend\":case\"dragstart\":case\"drop\":case\"focusin\":case\"focusout\":case\"input\":case\"invalid\":case\"keydown\":case\"keypress\":case\"keyup\":case\"mousedown\":case\"mouseup\":case\"paste\":case\"pause\":case\"play\":case\"pointercancel\":case\"pointerdown\":case\"pointerup\":case\"ratechange\":case\"reset\":case\"resize\":case\"seeked\":case\"submit\":case\"touchcancel\":case\"touchend\":case\"touchstart\":case\"volumechange\":case\"change\":case\"selectionchange\":case\"textInput\":case\"compositionstart\":case\"compositionend\":case\"compositionupdate\":case\"beforeblur\":case\"afterblur\":case\"beforeinput\":case\"blur\":case\"fullscreenchange\":case\"focus\":case\"hashchange\":case\"popstate\":case\"select\":case\"selectstart\":return 1;case\"drag\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"mousemove\":case\"mouseout\":case\"mouseover\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"scroll\":case\"toggle\":case\"touchmove\":case\"wheel\":case\"mouseenter\":case\"mouseleave\":case\"pointerenter\":case\"pointerleave\":return 4;case\"message\":switch(yX()){case Fk:return 1;case CF:return 4;case Ty:case bX:return 16;case AF:return 536870912;default:return 16}default:return 16}}var _c=null,Bk=null,oy=null;function LF(){if(oy)return oy;var e,t=Bk,r=t.length,n,a=\"value\"in _c?_c.value:_c.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[i-n];n++);return oy=a.slice(e,1<n?1-n:void 0)}function ly(e){var t=e.keyCode;return\"charCode\"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function uv(){return!0}function sO(){return!1}function Ws(e){function t(r,n,a,i,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?uv:sO,this.isPropagationStopped=sO,this}return cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!=\"unknown\"&&(r.returnValue=!1),this.isDefaultPrevented=uv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!=\"unknown\"&&(r.cancelBubble=!0),this.isPropagationStopped=uv)},persist:function(){},isPersistent:uv}),t}var D0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vk=Ws(D0),gx=cn({},D0,{view:0,detail:0}),MX=Ws(gx),tj,rj,wm,Wb=cn({},gx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zk,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return\"movementX\"in e?e.movementX:(e!==wm&&(wm&&e.type===\"mousemove\"?(tj=e.screenX-wm.screenX,rj=e.screenY-wm.screenY):rj=tj=0,wm=e),tj)},movementY:function(e){return\"movementY\"in e?e.movementY:rj}}),iO=Ws(Wb),DX=cn({},Wb,{dataTransfer:0}),IX=Ws(DX),FX=cn({},gx,{relatedTarget:0}),nj=Ws(FX),RX=cn({},D0,{animationName:0,elapsedTime:0,pseudoElement:0}),LX=Ws(RX),$X=cn({},D0,{clipboardData:function(e){return\"clipboardData\"in e?e.clipboardData:window.clipboardData}}),BX=Ws($X),VX=cn({},D0,{data:0}),oO=Ws(VX),zX={Esc:\"Escape\",Spacebar:\" \",Left:\"ArrowLeft\",Up:\"ArrowUp\",Right:\"ArrowRight\",Down:\"ArrowDown\",Del:\"Delete\",Win:\"OS\",Menu:\"ContextMenu\",Apps:\"ContextMenu\",Scroll:\"ScrollLock\",MozPrintableKey:\"Unidentified\"},UX={8:\"Backspace\",9:\"Tab\",12:\"Clear\",13:\"Enter\",16:\"Shift\",17:\"Control\",18:\"Alt\",19:\"Pause\",20:\"CapsLock\",27:\"Escape\",32:\" \",33:\"PageUp\",34:\"PageDown\",35:\"End\",36:\"Home\",37:\"ArrowLeft\",38:\"ArrowUp\",39:\"ArrowRight\",40:\"ArrowDown\",45:\"Insert\",46:\"Delete\",112:\"F1\",113:\"F2\",114:\"F3\",115:\"F4\",116:\"F5\",117:\"F6\",118:\"F7\",119:\"F8\",120:\"F9\",121:\"F10\",122:\"F11\",123:\"F12\",144:\"NumLock\",145:\"ScrollLock\",224:\"Meta\"},WX={Alt:\"altKey\",Control:\"ctrlKey\",Meta:\"metaKey\",Shift:\"shiftKey\"};function HX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=WX[e])?!!t[e]:!1}function zk(){return HX}var GX=cn({},gx,{key:function(e){if(e.key){var t=zX[e.key]||e.key;if(t!==\"Unidentified\")return t}return e.type===\"keypress\"?(e=ly(e),e===13?\"Enter\":String.fromCharCode(e)):e.type===\"keydown\"||e.type===\"keyup\"?UX[e.keyCode]||\"Unidentified\":\"\"},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zk,charCode:function(e){return e.type===\"keypress\"?ly(e):0},keyCode:function(e){return e.type===\"keydown\"||e.type===\"keyup\"?e.keyCode:0},which:function(e){return e.type===\"keypress\"?ly(e):e.type===\"keydown\"||e.type===\"keyup\"?e.keyCode:0}}),KX=Ws(GX),YX=cn({},Wb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lO=Ws(YX),qX=cn({},gx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zk}),XX=Ws(qX),ZX=cn({},D0,{propertyName:0,elapsedTime:0,pseudoElement:0}),QX=Ws(ZX),JX=cn({},Wb,{deltaX:function(e){return\"deltaX\"in e?e.deltaX:\"wheelDeltaX\"in e?-e.wheelDeltaX:0},deltaY:function(e){return\"deltaY\"in e?e.deltaY:\"wheelDeltaY\"in e?-e.wheelDeltaY:\"wheelDelta\"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),eZ=Ws(JX),tZ=[9,13,27,32],Uk=Ol&&\"CompositionEvent\"in window,lp=null;Ol&&\"documentMode\"in document&&(lp=document.documentMode);var rZ=Ol&&\"TextEvent\"in window&&!lp,$F=Ol&&(!Uk||lp&&8<lp&&11>=lp),cO=\" \",uO=!1;function BF(e,t){switch(e){case\"keyup\":return tZ.indexOf(t.keyCode)!==-1;case\"keydown\":return t.keyCode!==229;case\"keypress\":case\"mousedown\":case\"focusout\":return!0;default:return!1}}function VF(e){return e=e.detail,typeof e==\"object\"&&\"data\"in e?e.data:null}var Rf=!1;function nZ(e,t){switch(e){case\"compositionend\":return VF(t);case\"keypress\":return t.which!==32?null:(uO=!0,cO);case\"textInput\":return e=t.data,e===cO&&uO?null:e;default:return null}}function aZ(e,t){if(Rf)return e===\"compositionend\"||!Uk&&BF(e,t)?(e=LF(),oy=Bk=_c=null,Rf=!1,e):null;switch(e){case\"paste\":return null;case\"keypress\":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case\"compositionend\":return $F&&t.locale!==\"ko\"?null:t.data;default:return null}}var sZ={color:!0,date:!0,datetime:!0,\"datetime-local\":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dO(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t===\"input\"?!!sZ[e.type]:t===\"textarea\"}function zF(e,t,r,n){yF(n),t=Dy(t,\"onChange\"),0<t.length&&(r=new Vk(\"onChange\",\"change\",null,r,n),e.push({event:r,listeners:t}))}var cp=null,Lp=null;function iZ(e){JF(e,0)}function Hb(e){var t=Bf(e);if(fF(t))return e}function oZ(e,t){if(e===\"change\")return t}var UF=!1;if(Ol){var aj;if(Ol){var sj=\"oninput\"in document;if(!sj){var fO=document.createElement(\"div\");fO.setAttribute(\"oninput\",\"return;\"),sj=typeof fO.oninput==\"function\"}aj=sj}else aj=!1;UF=aj&&(!document.documentMode||9<document.documentMode)}function hO(){cp&&(cp.detachEvent(\"onpropertychange\",WF),Lp=cp=null)}function WF(e){if(e.propertyName===\"value\"&&Hb(Lp)){var t=[];zF(t,Lp,e,Ik(e)),NF(iZ,t)}}function lZ(e,t,r){e===\"focusin\"?(hO(),cp=t,Lp=r,cp.attachEvent(\"onpropertychange\",WF)):e===\"focusout\"&&hO()}function cZ(e){if(e===\"selectionchange\"||e===\"keyup\"||e===\"keydown\")return Hb(Lp)}function uZ(e,t){if(e===\"click\")return Hb(t)}function dZ(e,t){if(e===\"input\"||e===\"change\")return Hb(t)}function fZ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ao=typeof Object.is==\"function\"?Object.is:fZ;function $p(e,t){if(ao(e,t))return!0;if(typeof e!=\"object\"||e===null||typeof t!=\"object\"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!YN.call(t,a)||!ao(e[a],t[a]))return!1}return!0}function mO(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pO(e,t){var r=mO(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=mO(r)}}function HF(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?HF(e,t.parentNode):\"contains\"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function GF(){for(var e=window,t=ky();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href==\"string\"}catch{r=!1}if(r)e=t.contentWindow;else break;t=ky(e.document)}return t}function Wk(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t===\"input\"&&(e.type===\"text\"||e.type===\"search\"||e.type===\"tel\"||e.type===\"url\"||e.type===\"password\")||t===\"textarea\"||e.contentEditable===\"true\")}function hZ(e){var t=GF(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&HF(r.ownerDocument.documentElement,r)){if(n!==null&&Wk(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),\"selectionStart\"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=pO(r,i);var o=pO(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus==\"function\"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mZ=Ol&&\"documentMode\"in document&&11>=document.documentMode,Lf=null,hS=null,up=null,mS=!1;function gO(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;mS||Lf==null||Lf!==ky(n)||(n=Lf,\"selectionStart\"in n&&Wk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),up&&$p(up,n)||(up=n,n=Dy(hS,\"onSelect\"),0<n.length&&(t=new Vk(\"onSelect\",\"select\",null,t,r),e.push({event:t,listeners:n}),t.target=Lf)))}function dv(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r[\"Webkit\"+e]=\"webkit\"+t,r[\"Moz\"+e]=\"moz\"+t,r}var $f={animationend:dv(\"Animation\",\"AnimationEnd\"),animationiteration:dv(\"Animation\",\"AnimationIteration\"),animationstart:dv(\"Animation\",\"AnimationStart\"),transitionend:dv(\"Transition\",\"TransitionEnd\")},ij={},KF={};Ol&&(KF=document.createElement(\"div\").style,\"AnimationEvent\"in window||(delete $f.animationend.animation,delete $f.animationiteration.animation,delete $f.animationstart.animation),\"TransitionEvent\"in window||delete $f.transitionend.transition);function Gb(e){if(ij[e])return ij[e];if(!$f[e])return e;var t=$f[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in KF)return ij[e]=t[r];return e}var YF=Gb(\"animationend\"),qF=Gb(\"animationiteration\"),XF=Gb(\"animationstart\"),ZF=Gb(\"transitionend\"),QF=new Map,xO=\"abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel\".split(\" \");function iu(e,t){QF.set(e,t),Yd(t,[e])}for(var oj=0;oj<xO.length;oj++){var lj=xO[oj],pZ=lj.toLowerCase(),gZ=lj[0].toUpperCase()+lj.slice(1);iu(pZ,\"on\"+gZ)}iu(YF,\"onAnimationEnd\");iu(qF,\"onAnimationIteration\");iu(XF,\"onAnimationStart\");iu(\"dblclick\",\"onDoubleClick\");iu(\"focusin\",\"onFocus\");iu(\"focusout\",\"onBlur\");iu(ZF,\"onTransitionEnd\");Rh(\"onMouseEnter\",[\"mouseout\",\"mouseover\"]);Rh(\"onMouseLeave\",[\"mouseout\",\"mouseover\"]);Rh(\"onPointerEnter\",[\"pointerout\",\"pointerover\"]);Rh(\"onPointerLeave\",[\"pointerout\",\"pointerover\"]);Yd(\"onChange\",\"change click focusin focusout input keydown keyup selectionchange\".split(\" \"));Yd(\"onSelect\",\"focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange\".split(\" \"));Yd(\"onBeforeInput\",[\"compositionend\",\"keypress\",\"textInput\",\"paste\"]);Yd(\"onCompositionEnd\",\"compositionend focusout keydown keypress keyup mousedown\".split(\" \"));Yd(\"onCompositionStart\",\"compositionstart focusout keydown keypress keyup mousedown\".split(\" \"));Yd(\"onCompositionUpdate\",\"compositionupdate focusout keydown keypress keyup mousedown\".split(\" \"));var Ym=\"abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting\".split(\" \"),xZ=new Set(\"cancel close invalid load scroll toggle\".split(\" \").concat(Ym));function vO(e,t,r){var n=e.type||\"unknown-event\";e.currentTarget=r,pX(n,t,void 0,e),e.currentTarget=null}function JF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;vO(a,l,u),i=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;vO(a,l,u),i=c}}}if(Ay)throw e=cS,Ay=!1,cS=null,e}function Hr(e,t){var r=t[yS];r===void 0&&(r=t[yS]=new Set);var n=e+\"__bubble\";r.has(n)||(eR(t,e,2,!1),r.add(n))}function cj(e,t,r){var n=0;t&&(n|=4),eR(r,e,n,t)}var fv=\"_reactListening\"+Math.random().toString(36).slice(2);function Bp(e){if(!e[fv]){e[fv]=!0,oF.forEach(function(r){r!==\"selectionchange\"&&(xZ.has(r)||cj(r,!1,e),cj(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fv]||(t[fv]=!0,cj(\"selectionchange\",!1,t))}}function eR(e,t,r,n){switch(RF(t)){case 1:var a=OX;break;case 4:a=PX;break;default:a=$k}r=a.bind(null,t,r,e),a=void 0,!lS||t!==\"touchstart\"&&t!==\"touchmove\"&&t!==\"wheel\"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function uj(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Lu(l),o===null)return;if(c=o.tag,c===5||c===6){n=i=o;continue e}l=l.parentNode}}n=n.return}NF(function(){var u=i,d=Ik(r),f=[];e:{var h=QF.get(e);if(h!==void 0){var m=Vk,g=e;switch(e){case\"keypress\":if(ly(r)===0)break e;case\"keydown\":case\"keyup\":m=KX;break;case\"focusin\":g=\"focus\",m=nj;break;case\"focusout\":g=\"blur\",m=nj;break;case\"beforeblur\":case\"afterblur\":m=nj;break;case\"click\":if(r.button===2)break e;case\"auxclick\":case\"dblclick\":case\"mousedown\":case\"mousemove\":case\"mouseup\":case\"mouseout\":case\"mouseover\":case\"contextmenu\":m=iO;break;case\"drag\":case\"dragend\":case\"dragenter\":case\"dragexit\":case\"dragleave\":case\"dragover\":case\"dragstart\":case\"drop\":m=IX;break;case\"touchcancel\":case\"touchend\":case\"touchmove\":case\"touchstart\":m=XX;break;case YF:case qF:case XF:m=LX;break;case ZF:m=QX;break;case\"scroll\":m=MX;break;case\"wheel\":m=eZ;break;case\"copy\":case\"cut\":case\"paste\":m=BX;break;case\"gotpointercapture\":case\"lostpointercapture\":case\"pointercancel\":case\"pointerdown\":case\"pointermove\":case\"pointerout\":case\"pointerover\":case\"pointerup\":m=lO}var p=(t&4)!==0,x=!p&&e===\"scroll\",b=p?h!==null?h+\"Capture\":null:h;p=[];for(var y=u,v;y!==null;){v=y;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,b!==null&&(S=Dp(y,b),S!=null&&p.push(Vp(y,S,v)))),x)break;y=y.return}0<p.length&&(h=new m(h,g,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e===\"mouseover\"||e===\"pointerover\",m=e===\"mouseout\"||e===\"pointerout\",h&&r!==iS&&(g=r.relatedTarget||r.fromElement)&&(Lu(g)||g[Pl]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=u,g=g?Lu(g):null,g!==null&&(x=qd(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(p=iO,S=\"onMouseLeave\",b=\"onMouseEnter\",y=\"mouse\",(e===\"pointerout\"||e===\"pointerover\")&&(p=lO,S=\"onPointerLeave\",b=\"onPointerEnter\",y=\"pointer\"),x=m==null?h:Bf(m),v=g==null?h:Bf(g),h=new p(S,y+\"leave\",m,r,d),h.target=x,h.relatedTarget=v,S=null,Lu(d)===u&&(p=new p(b,y+\"enter\",g,r,d),p.target=v,p.relatedTarget=x,S=p),x=S,m&&g)t:{for(p=m,b=g,y=0,v=p;v;v=yf(v))y++;for(v=0,S=b;S;S=yf(S))v++;for(;0<y-v;)p=yf(p),y--;for(;0<v-y;)b=yf(b),v--;for(;y--;){if(p===b||b!==null&&p===b.alternate)break t;p=yf(p),b=yf(b)}p=null}else p=null;m!==null&&yO(f,h,m,p,!1),g!==null&&x!==null&&yO(f,x,g,p,!0)}}e:{if(h=u?Bf(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m===\"select\"||m===\"input\"&&h.type===\"file\")var w=oZ;else if(dO(h))if(UF)w=dZ;else{w=cZ;var N=lZ}else(m=h.nodeName)&&m.toLowerCase()===\"input\"&&(h.type===\"checkbox\"||h.type===\"radio\")&&(w=uZ);if(w&&(w=w(e,u))){zF(f,w,r,d);break e}N&&N(e,h,u),e===\"focusout\"&&(N=h._wrapperState)&&N.controlled&&h.type===\"number\"&&tS(h,\"number\",h.value)}switch(N=u?Bf(u):window,e){case\"focusin\":(dO(N)||N.contentEditable===\"true\")&&(Lf=N,hS=u,up=null);break;case\"focusout\":up=hS=Lf=null;break;case\"mousedown\":mS=!0;break;case\"contextmenu\":case\"mouseup\":case\"dragend\":mS=!1,gO(f,r,d);break;case\"selectionchange\":if(mZ)break;case\"keydown\":case\"keyup\":gO(f,r,d)}var _;if(Uk)e:{switch(e){case\"compositionstart\":var E=\"onCompositionStart\";break e;case\"compositionend\":E=\"onCompositionEnd\";break e;case\"compositionupdate\":E=\"onCompositionUpdate\";break e}E=void 0}else Rf?BF(e,r)&&(E=\"onCompositionEnd\"):e===\"keydown\"&&r.keyCode===229&&(E=\"onCompositionStart\");E&&($F&&r.locale!==\"ko\"&&(Rf||E!==\"onCompositionStart\"?E===\"onCompositionEnd\"&&Rf&&(_=LF()):(_c=d,Bk=\"value\"in _c?_c.value:_c.textContent,Rf=!0)),N=Dy(u,E),0<N.length&&(E=new oO(E,e,null,r,d),f.push({event:E,listeners:N}),_?E.data=_:(_=VF(r),_!==null&&(E.data=_)))),(_=rZ?nZ(e,r):aZ(e,r))&&(u=Dy(u,\"onBeforeInput\"),0<u.length&&(d=new oO(\"onBeforeInput\",\"beforeinput\",null,r,d),f.push({event:d,listeners:u}),d.data=_))}JF(f,t)})}function Vp(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dy(e,t){for(var r=t+\"Capture\",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Dp(e,r),i!=null&&n.unshift(Vp(e,i,a)),i=Dp(e,t),i!=null&&n.push(Vp(e,i,a))),e=e.return}return n}function yf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function yO(e,t,r,n,a){for(var i=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Dp(r,i),c!=null&&o.unshift(Vp(r,c,l))):a||(c=Dp(r,i),c!=null&&o.push(Vp(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var vZ=/\\r\\n?/g,yZ=/\\u0000|\\uFFFD/g;function bO(e){return(typeof e==\"string\"?e:\"\"+e).replace(vZ,`\n`).replace(yZ,\"\")}function hv(e,t,r){if(t=bO(t),bO(e)!==t&&r)throw Error(Be(425))}function Iy(){}var pS=null,gS=null;function xS(e,t){return e===\"textarea\"||e===\"noscript\"||typeof t.children==\"string\"||typeof t.children==\"number\"||typeof t.dangerouslySetInnerHTML==\"object\"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vS=typeof setTimeout==\"function\"?setTimeout:void 0,bZ=typeof clearTimeout==\"function\"?clearTimeout:void 0,wO=typeof Promise==\"function\"?Promise:void 0,wZ=typeof queueMicrotask==\"function\"?queueMicrotask:typeof wO<\"u\"?function(e){return wO.resolve(null).then(e).catch(jZ)}:vS;function jZ(e){setTimeout(function(){throw e})}function dj(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r===\"/$\"){if(n===0){e.removeChild(a),Rp(t);return}n--}else r!==\"$\"&&r!==\"$?\"&&r!==\"$!\"||n++;r=a}while(r);Rp(t)}function Ic(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t===\"$\"||t===\"$!\"||t===\"$?\")break;if(t===\"/$\")return null}}return e}function jO(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r===\"$\"||r===\"$!\"||r===\"$?\"){if(t===0)return e;t--}else r===\"/$\"&&t++}e=e.previousSibling}return null}var I0=Math.random().toString(36).slice(2),Eo=\"__reactFiber$\"+I0,zp=\"__reactProps$\"+I0,Pl=\"__reactContainer$\"+I0,yS=\"__reactEvents$\"+I0,NZ=\"__reactListeners$\"+I0,SZ=\"__reactHandles$\"+I0;function Lu(e){var t=e[Eo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Pl]||r[Eo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=jO(e);e!==null;){if(r=e[Eo])return r;e=jO(e)}return t}e=r,r=e.parentNode}return null}function xx(e){return e=e[Eo]||e[Pl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function Kb(e){return e[zp]||null}var bS=[],Vf=-1;function ou(e){return{current:e}}function qr(e){0>Vf||(e.current=bS[Vf],bS[Vf]=null,Vf--)}function Br(e,t){Vf++,bS[Vf]=e.current,e.current=t}var Uc={},Pa=ou(Uc),ps=ou(!1),dd=Uc;function Lh(e,t){var r=e.type.contextTypes;if(!r)return Uc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function gs(e){return e=e.childContextTypes,e!=null}function Fy(){qr(ps),qr(Pa)}function NO(e,t,r){if(Pa.current!==Uc)throw Error(Be(168));Br(Pa,t),Br(ps,r)}function tR(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!=\"function\")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Be(108,lX(e)||\"Unknown\",a));return cn({},r,n)}function Ry(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Uc,dd=Pa.current,Br(Pa,e),Br(ps,ps.current),!0}function SO(e,t,r){var n=e.stateNode;if(!n)throw Error(Be(169));r?(e=tR(e,t,dd),n.__reactInternalMemoizedMergedChildContext=e,qr(ps),qr(Pa),Br(Pa,e)):qr(ps),Br(ps,r)}var hl=null,Yb=!1,fj=!1;function rR(e){hl===null?hl=[e]:hl.push(e)}function _Z(e){Yb=!0,rR(e)}function lu(){if(!fj&&hl!==null){fj=!0;var e=0,t=Ar;try{var r=hl;for(Ar=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}hl=null,Yb=!1}catch(a){throw hl!==null&&(hl=hl.slice(e+1)),kF(Fk,lu),a}finally{Ar=t,fj=!1}}return null}var zf=[],Uf=0,Ly=null,$y=0,ai=[],si=0,fd=null,xl=1,vl=\"\";function Tu(e,t){zf[Uf++]=$y,zf[Uf++]=Ly,Ly=e,$y=t}function nR(e,t,r){ai[si++]=xl,ai[si++]=vl,ai[si++]=fd,fd=e;var n=xl;e=vl;var a=32-Zi(n)-1;n&=~(1<<a),r+=1;var i=32-Zi(t)+a;if(30<i){var o=a-a%5;i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,xl=1<<32-Zi(t)+a|r<<a|n,vl=i+e}else xl=1<<i|r<<a|n,vl=e}function Hk(e){e.return!==null&&(Tu(e,1),nR(e,1,0))}function Gk(e){for(;e===Ly;)Ly=zf[--Uf],zf[Uf]=null,$y=zf[--Uf],zf[Uf]=null;for(;e===fd;)fd=ai[--si],ai[si]=null,vl=ai[--si],ai[si]=null,xl=ai[--si],ai[si]=null}var Fs=null,Is=null,Qr=!1,zi=null;function aR(e,t){var r=oi(5,null,null,0);r.elementType=\"DELETED\",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function _O(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Fs=e,Is=Ic(t.firstChild),!0):!1;case 6:return t=e.pendingProps===\"\"||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Fs=e,Is=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=fd!==null?{id:xl,overflow:vl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=oi(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Fs=e,Is=null,!0):!1;default:return!1}}function wS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function jS(e){if(Qr){var t=Is;if(t){var r=t;if(!_O(e,t)){if(wS(e))throw Error(Be(418));t=Ic(r.nextSibling);var n=Fs;t&&_O(e,t)?aR(n,r):(e.flags=e.flags&-4097|2,Qr=!1,Fs=e)}}else{if(wS(e))throw Error(Be(418));e.flags=e.flags&-4097|2,Qr=!1,Fs=e}}}function EO(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Fs=e}function mv(e){if(e!==Fs)return!1;if(!Qr)return EO(e),Qr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!==\"head\"&&t!==\"body\"&&!xS(e.type,e.memoizedProps)),t&&(t=Is)){if(wS(e))throw sR(),Error(Be(418));for(;t;)aR(e,t),t=Ic(t.nextSibling)}if(EO(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r===\"/$\"){if(t===0){Is=Ic(e.nextSibling);break e}t--}else r!==\"$\"&&r!==\"$!\"&&r!==\"$?\"||t++}e=e.nextSibling}Is=null}}else Is=Fs?Ic(e.stateNode.nextSibling):null;return!0}function sR(){for(var e=Is;e;)e=Ic(e.nextSibling)}function $h(){Is=Fs=null,Qr=!1}function Kk(e){zi===null?zi=[e]:zi.push(e)}var EZ=Hl.ReactCurrentBatchConfig;function jm(e,t,r){if(e=r.ref,e!==null&&typeof e!=\"function\"&&typeof e!=\"object\"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Be(309));var n=r.stateNode}if(!n)throw Error(Be(147,e));var a=n,i=\"\"+e;return t!==null&&t.ref!==null&&typeof t.ref==\"function\"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!=\"string\")throw Error(Be(284));if(!r._owner)throw Error(Be(290,e))}return e}function pv(e,t){throw e=Object.prototype.toString.call(t),Error(Be(31,e===\"[object Object]\"?\"object with keys {\"+Object.keys(t).join(\", \")+\"}\":e))}function kO(e){var t=e._init;return t(e._payload)}function iR(e){function t(b,y){if(e){var v=b.deletions;v===null?(b.deletions=[y],b.flags|=16):v.push(y)}}function r(b,y){if(!e)return null;for(;y!==null;)t(b,y),y=y.sibling;return null}function n(b,y){for(b=new Map;y!==null;)y.key!==null?b.set(y.key,y):b.set(y.index,y),y=y.sibling;return b}function a(b,y){return b=$c(b,y),b.index=0,b.sibling=null,b}function i(b,y,v){return b.index=v,e?(v=b.alternate,v!==null?(v=v.index,v<y?(b.flags|=2,y):v):(b.flags|=2,y)):(b.flags|=1048576,y)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,y,v,S){return y===null||y.tag!==6?(y=yj(v,b.mode,S),y.return=b,y):(y=a(y,v),y.return=b,y)}function c(b,y,v,S){var w=v.type;return w===Ff?d(b,y,v.props.children,S,v.key):y!==null&&(y.elementType===w||typeof w==\"object\"&&w!==null&&w.$$typeof===lc&&kO(w)===y.type)?(S=a(y,v.props),S.ref=jm(b,y,v),S.return=b,S):(S=py(v.type,v.key,v.props,null,b.mode,S),S.ref=jm(b,y,v),S.return=b,S)}function u(b,y,v,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=bj(v,b.mode,S),y.return=b,y):(y=a(y,v.children||[]),y.return=b,y)}function d(b,y,v,S,w){return y===null||y.tag!==7?(y=rd(v,b.mode,S,w),y.return=b,y):(y=a(y,v),y.return=b,y)}function f(b,y,v){if(typeof y==\"string\"&&y!==\"\"||typeof y==\"number\")return y=yj(\"\"+y,b.mode,v),y.return=b,y;if(typeof y==\"object\"&&y!==null){switch(y.$$typeof){case av:return v=py(y.type,y.key,y.props,null,b.mode,v),v.ref=jm(b,null,y),v.return=b,v;case If:return y=bj(y,b.mode,v),y.return=b,y;case lc:var S=y._init;return f(b,S(y._payload),v)}if(Gm(y)||xm(y))return y=rd(y,b.mode,v,null),y.return=b,y;pv(b,y)}return null}function h(b,y,v,S){var w=y!==null?y.key:null;if(typeof v==\"string\"&&v!==\"\"||typeof v==\"number\")return w!==null?null:l(b,y,\"\"+v,S);if(typeof v==\"object\"&&v!==null){switch(v.$$typeof){case av:return v.key===w?c(b,y,v,S):null;case If:return v.key===w?u(b,y,v,S):null;case lc:return w=v._init,h(b,y,w(v._payload),S)}if(Gm(v)||xm(v))return w!==null?null:d(b,y,v,S,null);pv(b,v)}return null}function m(b,y,v,S,w){if(typeof S==\"string\"&&S!==\"\"||typeof S==\"number\")return b=b.get(v)||null,l(y,b,\"\"+S,w);if(typeof S==\"object\"&&S!==null){switch(S.$$typeof){case av:return b=b.get(S.key===null?v:S.key)||null,c(y,b,S,w);case If:return b=b.get(S.key===null?v:S.key)||null,u(y,b,S,w);case lc:var N=S._init;return m(b,y,v,N(S._payload),w)}if(Gm(S)||xm(S))return b=b.get(v)||null,d(y,b,S,w,null);pv(y,S)}return null}function g(b,y,v,S){for(var w=null,N=null,_=y,E=y=0,k=null;_!==null&&E<v.length;E++){_.index>E?(k=_,_=null):k=_.sibling;var O=h(b,_,v[E],S);if(O===null){_===null&&(_=k);break}e&&_&&O.alternate===null&&t(b,_),y=i(O,y,E),N===null?w=O:N.sibling=O,N=O,_=k}if(E===v.length)return r(b,_),Qr&&Tu(b,E),w;if(_===null){for(;E<v.length;E++)_=f(b,v[E],S),_!==null&&(y=i(_,y,E),N===null?w=_:N.sibling=_,N=_);return Qr&&Tu(b,E),w}for(_=n(b,_);E<v.length;E++)k=m(_,b,E,v[E],S),k!==null&&(e&&k.alternate!==null&&_.delete(k.key===null?E:k.key),y=i(k,y,E),N===null?w=k:N.sibling=k,N=k);return e&&_.forEach(function(C){return t(b,C)}),Qr&&Tu(b,E),w}function p(b,y,v,S){var w=xm(v);if(typeof w!=\"function\")throw Error(Be(150));if(v=w.call(v),v==null)throw Error(Be(151));for(var N=w=null,_=y,E=y=0,k=null,O=v.next();_!==null&&!O.done;E++,O=v.next()){_.index>E?(k=_,_=null):k=_.sibling;var C=h(b,_,O.value,S);if(C===null){_===null&&(_=k);break}e&&_&&C.alternate===null&&t(b,_),y=i(C,y,E),N===null?w=C:N.sibling=C,N=C,_=k}if(O.done)return r(b,_),Qr&&Tu(b,E),w;if(_===null){for(;!O.done;E++,O=v.next())O=f(b,O.value,S),O!==null&&(y=i(O,y,E),N===null?w=O:N.sibling=O,N=O);return Qr&&Tu(b,E),w}for(_=n(b,_);!O.done;E++,O=v.next())O=m(_,b,E,O.value,S),O!==null&&(e&&O.alternate!==null&&_.delete(O.key===null?E:O.key),y=i(O,y,E),N===null?w=O:N.sibling=O,N=O);return e&&_.forEach(function(A){return t(b,A)}),Qr&&Tu(b,E),w}function x(b,y,v,S){if(typeof v==\"object\"&&v!==null&&v.type===Ff&&v.key===null&&(v=v.props.children),typeof v==\"object\"&&v!==null){switch(v.$$typeof){case av:e:{for(var w=v.key,N=y;N!==null;){if(N.key===w){if(w=v.type,w===Ff){if(N.tag===7){r(b,N.sibling),y=a(N,v.props.children),y.return=b,b=y;break e}}else if(N.elementType===w||typeof w==\"object\"&&w!==null&&w.$$typeof===lc&&kO(w)===N.type){r(b,N.sibling),y=a(N,v.props),y.ref=jm(b,N,v),y.return=b,b=y;break e}r(b,N);break}else t(b,N);N=N.sibling}v.type===Ff?(y=rd(v.props.children,b.mode,S,v.key),y.return=b,b=y):(S=py(v.type,v.key,v.props,null,b.mode,S),S.ref=jm(b,y,v),S.return=b,b=S)}return o(b);case If:e:{for(N=v.key;y!==null;){if(y.key===N)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){r(b,y.sibling),y=a(y,v.children||[]),y.return=b,b=y;break e}else{r(b,y);break}else t(b,y);y=y.sibling}y=bj(v,b.mode,S),y.return=b,b=y}return o(b);case lc:return N=v._init,x(b,y,N(v._payload),S)}if(Gm(v))return g(b,y,v,S);if(xm(v))return p(b,y,v,S);pv(b,v)}return typeof v==\"string\"&&v!==\"\"||typeof v==\"number\"?(v=\"\"+v,y!==null&&y.tag===6?(r(b,y.sibling),y=a(y,v),y.return=b,b=y):(r(b,y),y=yj(v,b.mode,S),y.return=b,b=y),o(b)):r(b,y)}return x}var Bh=iR(!0),oR=iR(!1),By=ou(null),Vy=null,Wf=null,Yk=null;function qk(){Yk=Wf=Vy=null}function Xk(e){var t=By.current;qr(By),e._currentValue=t}function NS(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ih(e,t){Vy=e,Yk=Wf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(fs=!0),e.firstContext=null)}function mi(e){var t=e._currentValue;if(Yk!==e)if(e={context:e,memoizedValue:t,next:null},Wf===null){if(Vy===null)throw Error(Be(308));Wf=e,Vy.dependencies={lanes:0,firstContext:e}}else Wf=Wf.next=e;return t}var $u=null;function Zk(e){$u===null?$u=[e]:$u.push(e)}function lR(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Zk(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ml(e,n)}function Ml(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var cc=!1;function Qk(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function cR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Nl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,hr&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ml(e,r)}return a=n.interleaved,a===null?(t.next=t,Zk(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ml(e,r)}function cy(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Rk(e,r)}}function CO(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function zy(e,t,r,n){var a=e.updateQueue;cc=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var f=a.baseState;o=0,d=u=c=null,l=i;do{var h=l.lane,m=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,p=l;switch(h=t,m=r,p.tag){case 1:if(g=p.payload,typeof g==\"function\"){f=g.call(m,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=p.payload,h=typeof g==\"function\"?g.call(m,f,h):g,h==null)break e;f=cn({},f,h);break e;case 2:cc=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[l]:h.push(l))}else m={eventTime:m,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,o|=h;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;h=l,l=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);md|=o,e.lanes=o,e.memoizedState=f}}function AO(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!=\"function\")throw Error(Be(191,a));a.call(n)}}}var vx={},Fo=ou(vx),Up=ou(vx),Wp=ou(vx);function Bu(e){if(e===vx)throw Error(Be(174));return e}function Jk(e,t){switch(Br(Wp,t),Br(Up,e),Br(Fo,vx),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:nS(null,\"\");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=nS(t,e)}qr(Fo),Br(Fo,t)}function Vh(){qr(Fo),qr(Up),qr(Wp)}function uR(e){Bu(Wp.current);var t=Bu(Fo.current),r=nS(t,e.type);t!==r&&(Br(Up,e),Br(Fo,r))}function eC(e){Up.current===e&&(qr(Fo),qr(Up))}var nn=ou(0);function Uy(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data===\"$?\"||r.data===\"$!\"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var hj=[];function tC(){for(var e=0;e<hj.length;e++)hj[e]._workInProgressVersionPrimary=null;hj.length=0}var uy=Hl.ReactCurrentDispatcher,mj=Hl.ReactCurrentBatchConfig,hd=0,ln=null,In=null,qn=null,Wy=!1,dp=!1,Hp=0,kZ=0;function va(){throw Error(Be(321))}function rC(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ao(e[r],t[r]))return!1;return!0}function nC(e,t,r,n,a,i){if(hd=i,ln=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uy.current=e===null||e.memoizedState===null?OZ:PZ,e=r(n,a),dp){i=0;do{if(dp=!1,Hp=0,25<=i)throw Error(Be(301));i+=1,qn=In=null,t.updateQueue=null,uy.current=MZ,e=r(n,a)}while(dp)}if(uy.current=Hy,t=In!==null&&In.next!==null,hd=0,qn=In=ln=null,Wy=!1,t)throw Error(Be(300));return e}function aC(){var e=Hp!==0;return Hp=0,e}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?ln.memoizedState=qn=e:qn=qn.next=e,qn}function pi(){if(In===null){var e=ln.alternate;e=e!==null?e.memoizedState:null}else e=In.next;var t=qn===null?ln.memoizedState:qn.next;if(t!==null)qn=t,In=e;else{if(e===null)throw Error(Be(310));In=e,e={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},qn===null?ln.memoizedState=qn=e:qn=qn.next=e}return qn}function Gp(e,t){return typeof t==\"function\"?t(e):t}function pj(e){var t=pi(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=In,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((hd&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,ln.lanes|=d,md|=d}u=u.next}while(u!==null&&u!==i);c===null?o=n:c.next=l,ao(n,t.memoizedState)||(fs=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,ln.lanes|=i,md|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function gj(e){var t=pi(),r=t.queue;if(r===null)throw Error(Be(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);ao(i,t.memoizedState)||(fs=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function dR(){}function fR(e,t){var r=ln,n=pi(),a=t(),i=!ao(n.memoizedState,a);if(i&&(n.memoizedState=a,fs=!0),n=n.queue,sC(pR.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||qn!==null&&qn.memoizedState.tag&1){if(r.flags|=2048,Kp(9,mR.bind(null,r,n,a,t),void 0,null),ea===null)throw Error(Be(349));hd&30||hR(r,t,a)}return a}function hR(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function mR(e,t,r,n){t.value=r,t.getSnapshot=n,gR(t)&&xR(e)}function pR(e,t,r){return r(function(){gR(t)&&xR(e)})}function gR(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ao(e,r)}catch{return!0}}function xR(e){var t=Ml(e,1);t!==null&&Qi(t,e,1,-1)}function TO(e){var t=wo();return typeof e==\"function\"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gp,lastRenderedState:e},t.queue=e,e=e.dispatch=TZ.bind(null,ln,e),[t.memoizedState,e]}function Kp(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=ln.updateQueue,t===null?(t={lastEffect:null,stores:null},ln.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function vR(){return pi().memoizedState}function dy(e,t,r,n){var a=wo();ln.flags|=e,a.memoizedState=Kp(1|t,r,void 0,n===void 0?null:n)}function qb(e,t,r,n){var a=pi();n=n===void 0?null:n;var i=void 0;if(In!==null){var o=In.memoizedState;if(i=o.destroy,n!==null&&rC(n,o.deps)){a.memoizedState=Kp(t,r,i,n);return}}ln.flags|=e,a.memoizedState=Kp(1|t,r,i,n)}function OO(e,t){return dy(8390656,8,e,t)}function sC(e,t){return qb(2048,8,e,t)}function yR(e,t){return qb(4,2,e,t)}function bR(e,t){return qb(4,4,e,t)}function wR(e,t){if(typeof t==\"function\")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function jR(e,t,r){return r=r!=null?r.concat([e]):null,qb(4,4,wR.bind(null,t,e),r)}function iC(){}function NR(e,t){var r=pi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rC(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function SR(e,t){var r=pi();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&rC(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function _R(e,t,r){return hd&21?(ao(r,t)||(r=TF(),ln.lanes|=r,md|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,fs=!0),e.memoizedState=r)}function CZ(e,t){var r=Ar;Ar=r!==0&&4>r?r:4,e(!0);var n=mj.transition;mj.transition={};try{e(!1),t()}finally{Ar=r,mj.transition=n}}function ER(){return pi().memoizedState}function AZ(e,t,r){var n=Lc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},kR(e))CR(t,r);else if(r=lR(e,t,r,n),r!==null){var a=Qa();Qi(r,e,n,a),AR(r,t,n)}}function TZ(e,t,r){var n=Lc(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(kR(e))CR(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,ao(l,o)){var c=t.interleaved;c===null?(a.next=a,Zk(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=lR(e,t,a,n),r!==null&&(a=Qa(),Qi(r,e,n,a),AR(r,t,n))}}function kR(e){var t=e.alternate;return e===ln||t!==null&&t===ln}function CR(e,t){dp=Wy=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function AR(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Rk(e,r)}}var Hy={readContext:mi,useCallback:va,useContext:va,useEffect:va,useImperativeHandle:va,useInsertionEffect:va,useLayoutEffect:va,useMemo:va,useReducer:va,useRef:va,useState:va,useDebugValue:va,useDeferredValue:va,useTransition:va,useMutableSource:va,useSyncExternalStore:va,useId:va,unstable_isNewReconciler:!1},OZ={readContext:mi,useCallback:function(e,t){return wo().memoizedState=[e,t===void 0?null:t],e},useContext:mi,useEffect:OO,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,dy(4194308,4,wR.bind(null,t,e),r)},useLayoutEffect:function(e,t){return dy(4194308,4,e,t)},useInsertionEffect:function(e,t){return dy(4,2,e,t)},useMemo:function(e,t){var r=wo();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=wo();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=AZ.bind(null,ln,e),[n.memoizedState,e]},useRef:function(e){var t=wo();return e={current:e},t.memoizedState=e},useState:TO,useDebugValue:iC,useDeferredValue:function(e){return wo().memoizedState=e},useTransition:function(){var e=TO(!1),t=e[0];return e=CZ.bind(null,e[1]),wo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ln,a=wo();if(Qr){if(r===void 0)throw Error(Be(407));r=r()}else{if(r=t(),ea===null)throw Error(Be(349));hd&30||hR(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,OO(pR.bind(null,n,i,e),[e]),n.flags|=2048,Kp(9,mR.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=wo(),t=ea.identifierPrefix;if(Qr){var r=vl,n=xl;r=(n&~(1<<32-Zi(n)-1)).toString(32)+r,t=\":\"+t+\"R\"+r,r=Hp++,0<r&&(t+=\"H\"+r.toString(32)),t+=\":\"}else r=kZ++,t=\":\"+t+\"r\"+r.toString(32)+\":\";return e.memoizedState=t},unstable_isNewReconciler:!1},PZ={readContext:mi,useCallback:NR,useContext:mi,useEffect:sC,useImperativeHandle:jR,useInsertionEffect:yR,useLayoutEffect:bR,useMemo:SR,useReducer:pj,useRef:vR,useState:function(){return pj(Gp)},useDebugValue:iC,useDeferredValue:function(e){var t=pi();return _R(t,In.memoizedState,e)},useTransition:function(){var e=pj(Gp)[0],t=pi().memoizedState;return[e,t]},useMutableSource:dR,useSyncExternalStore:fR,useId:ER,unstable_isNewReconciler:!1},MZ={readContext:mi,useCallback:NR,useContext:mi,useEffect:sC,useImperativeHandle:jR,useInsertionEffect:yR,useLayoutEffect:bR,useMemo:SR,useReducer:gj,useRef:vR,useState:function(){return gj(Gp)},useDebugValue:iC,useDeferredValue:function(e){var t=pi();return In===null?t.memoizedState=e:_R(t,In.memoizedState,e)},useTransition:function(){var e=gj(Gp)[0],t=pi().memoizedState;return[e,t]},useMutableSource:dR,useSyncExternalStore:fR,useId:ER,unstable_isNewReconciler:!1};function Ri(e,t){if(e&&e.defaultProps){t=cn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function SS(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:cn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Xb={isMounted:function(e){return(e=e._reactInternals)?qd(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Qa(),a=Lc(e),i=Nl(n,a);i.payload=t,r!=null&&(i.callback=r),t=Fc(e,i,a),t!==null&&(Qi(t,e,a,n),cy(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Qa(),a=Lc(e),i=Nl(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Fc(e,i,a),t!==null&&(Qi(t,e,a,n),cy(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Qa(),n=Lc(e),a=Nl(r,n);a.tag=2,t!=null&&(a.callback=t),t=Fc(e,a,n),t!==null&&(Qi(t,e,n,r),cy(t,e,n))}};function PO(e,t,r,n,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate==\"function\"?e.shouldComponentUpdate(n,i,o):t.prototype&&t.prototype.isPureReactComponent?!$p(r,n)||!$p(a,i):!0}function TR(e,t,r){var n=!1,a=Uc,i=t.contextType;return typeof i==\"object\"&&i!==null?i=mi(i):(a=gs(t)?dd:Pa.current,n=t.contextTypes,i=(n=n!=null)?Lh(e,a):Uc),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Xb,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function MO(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps==\"function\"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps==\"function\"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Xb.enqueueReplaceState(t,t.state,null)}function _S(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Qk(e);var i=t.contextType;typeof i==\"object\"&&i!==null?a.context=mi(i):(i=gs(t)?dd:Pa.current,a.context=Lh(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i==\"function\"&&(SS(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps==\"function\"||typeof a.getSnapshotBeforeUpdate==\"function\"||typeof a.UNSAFE_componentWillMount!=\"function\"&&typeof a.componentWillMount!=\"function\"||(t=a.state,typeof a.componentWillMount==\"function\"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==\"function\"&&a.UNSAFE_componentWillMount(),t!==a.state&&Xb.enqueueReplaceState(a,a.state,null),zy(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount==\"function\"&&(e.flags|=4194308)}function zh(e,t){try{var r=\"\",n=t;do r+=oX(n),n=n.return;while(n);var a=r}catch(i){a=`\nError generating stack: `+i.message+`\n`+i.stack}return{value:e,source:t,stack:a,digest:null}}function xj(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ES(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var DZ=typeof WeakMap==\"function\"?WeakMap:Map;function OR(e,t,r){r=Nl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ky||(Ky=!0,FS=n),ES(e,t)},r}function PR(e,t,r){r=Nl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n==\"function\"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){ES(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch==\"function\"&&(r.callback=function(){ES(e,t),typeof n!=\"function\"&&(Rc===null?Rc=new Set([this]):Rc.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:\"\"})}),r}function DO(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new DZ;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=YZ.bind(null,e,t,r),t.then(e,e))}function IO(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function FO(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Nl(-1,1),t.tag=2,Fc(r,t,1))),r.lanes|=1),e)}var IZ=Hl.ReactCurrentOwner,fs=!1;function Va(e,t,r,n){t.child=e===null?oR(t,null,r,n):Bh(t,e.child,r,n)}function RO(e,t,r,n,a){r=r.render;var i=t.ref;return ih(t,a),n=nC(e,t,r,n,i,a),r=aC(),e!==null&&!fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Dl(e,t,a)):(Qr&&r&&Hk(t),t.flags|=1,Va(e,t,n,a),t.child)}function LO(e,t,r,n,a){if(e===null){var i=r.type;return typeof i==\"function\"&&!mC(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,MR(e,t,i,n,a)):(e=py(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:$p,r(o,n)&&e.ref===t.ref)return Dl(e,t,a)}return t.flags|=1,e=$c(i,n),e.ref=t.ref,e.return=t,t.child=e}function MR(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if($p(i,n)&&e.ref===t.ref)if(fs=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(fs=!0);else return t.lanes=e.lanes,Dl(e,t,a)}return kS(e,t,r,n,a)}function DR(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode===\"hidden\")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Br(Gf,Es),Es|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Br(Gf,Es),Es|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Br(Gf,Es),Es|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,Br(Gf,Es),Es|=n;return Va(e,t,a,r),t.child}function IR(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function kS(e,t,r,n,a){var i=gs(r)?dd:Pa.current;return i=Lh(t,i),ih(t,a),r=nC(e,t,r,n,i,a),n=aC(),e!==null&&!fs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Dl(e,t,a)):(Qr&&n&&Hk(t),t.flags|=1,Va(e,t,r,a),t.child)}function $O(e,t,r,n,a){if(gs(r)){var i=!0;Ry(t)}else i=!1;if(ih(t,a),t.stateNode===null)fy(e,t),TR(t,r,n),_S(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u==\"object\"&&u!==null?u=mi(u):(u=gs(r)?dd:Pa.current,u=Lh(t,u));var d=r.getDerivedStateFromProps,f=typeof d==\"function\"||typeof o.getSnapshotBeforeUpdate==\"function\";f||typeof o.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof o.componentWillReceiveProps!=\"function\"||(l!==n||c!==u)&&MO(t,o,n,u),cc=!1;var h=t.memoizedState;o.state=h,zy(t,n,o,a),c=t.memoizedState,l!==n||h!==c||ps.current||cc?(typeof d==\"function\"&&(SS(t,r,d,n),c=t.memoizedState),(l=cc||PO(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!=\"function\"&&typeof o.componentWillMount!=\"function\"||(typeof o.componentWillMount==\"function\"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount==\"function\"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount==\"function\"&&(t.flags|=4194308)):(typeof o.componentDidMount==\"function\"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount==\"function\"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,cR(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Ri(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c==\"object\"&&c!==null?c=mi(c):(c=gs(r)?dd:Pa.current,c=Lh(t,c));var m=r.getDerivedStateFromProps;(d=typeof m==\"function\"||typeof o.getSnapshotBeforeUpdate==\"function\")||typeof o.UNSAFE_componentWillReceiveProps!=\"function\"&&typeof o.componentWillReceiveProps!=\"function\"||(l!==f||h!==c)&&MO(t,o,n,c),cc=!1,h=t.memoizedState,o.state=h,zy(t,n,o,a);var g=t.memoizedState;l!==f||h!==g||ps.current||cc?(typeof m==\"function\"&&(SS(t,r,m,n),g=t.memoizedState),(u=cc||PO(t,r,u,n,h,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!=\"function\"&&typeof o.componentWillUpdate!=\"function\"||(typeof o.componentWillUpdate==\"function\"&&o.componentWillUpdate(n,g,c),typeof o.UNSAFE_componentWillUpdate==\"function\"&&o.UNSAFE_componentWillUpdate(n,g,c)),typeof o.componentDidUpdate==\"function\"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate==\"function\"&&(t.flags|=1024)):(typeof o.componentDidUpdate!=\"function\"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!=\"function\"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=c,n=u):(typeof o.componentDidUpdate!=\"function\"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!=\"function\"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return CS(e,t,r,n,i,a)}function CS(e,t,r,n,a,i){IR(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&SO(t,r,!1),Dl(e,t,i);n=t.stateNode,IZ.current=t;var l=o&&typeof r.getDerivedStateFromError!=\"function\"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Bh(t,e.child,null,i),t.child=Bh(t,null,l,i)):Va(e,t,l,i),t.memoizedState=n.state,a&&SO(t,r,!0),t.child}function FR(e){var t=e.stateNode;t.pendingContext?NO(e,t.pendingContext,t.pendingContext!==t.context):t.context&&NO(e,t.context,!1),Jk(e,t.containerInfo)}function BO(e,t,r,n,a){return $h(),Kk(a),t.flags|=256,Va(e,t,r,n),t.child}var AS={dehydrated:null,treeContext:null,retryLane:0};function TS(e){return{baseLanes:e,cachePool:null,transitions:null}}function RR(e,t,r){var n=t.pendingProps,a=nn.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Br(nn,a&1),e===null)return jS(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data===\"$!\"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:\"hidden\",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Jb(o,n,0,null),e=rd(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=TS(r),t.memoizedState=AS,e):oC(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return FZ(e,t,o,n,l,a,r);if(i){i=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:\"hidden\",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=$c(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=$c(l,i):(i=rd(i,o,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=e.child.memoizedState,o=o===null?TS(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=AS,n}return i=e.child,e=i.sibling,n=$c(i,{mode:\"visible\",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function oC(e,t){return t=Jb({mode:\"visible\",children:t},e.mode,0,null),t.return=e,e.child=t}function gv(e,t,r,n){return n!==null&&Kk(n),Bh(t,e.child,null,r),e=oC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function FZ(e,t,r,n,a,i,o){if(r)return t.flags&256?(t.flags&=-257,n=xj(Error(Be(422))),gv(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=Jb({mode:\"visible\",children:n.children},a,0,null),i=rd(i,a,o,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Bh(t,e.child,null,o),t.child.memoizedState=TS(o),t.memoizedState=AS,i);if(!(t.mode&1))return gv(e,t,o,null);if(a.data===\"$!\"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(Be(419)),n=xj(i,n,void 0),gv(e,t,o,n)}if(l=(o&e.childLanes)!==0,fs||l){if(n=ea,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ml(e,a),Qi(n,e,a,-1))}return hC(),n=xj(Error(Be(421))),gv(e,t,o,n)}return a.data===\"$?\"?(t.flags|=128,t.child=e.child,t=qZ.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Is=Ic(a.nextSibling),Fs=t,Qr=!0,zi=null,e!==null&&(ai[si++]=xl,ai[si++]=vl,ai[si++]=fd,xl=e.id,vl=e.overflow,fd=t),t=oC(t,n.children),t.flags|=4096,t)}function VO(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),NS(e.return,t,r)}function vj(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function LR(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Va(e,t,n.children,r),n=nn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&VO(e,r,t);else if(e.tag===19)VO(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Br(nn,n),!(t.mode&1))t.memoizedState=null;else switch(a){case\"forwards\":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Uy(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),vj(t,!1,a,r,i);break;case\"backwards\":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Uy(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}vj(t,!0,r,null,i);break;case\"together\":vj(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function fy(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Dl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),md|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Be(153));if(t.child!==null){for(e=t.child,r=$c(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=$c(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function RZ(e,t,r){switch(t.tag){case 3:FR(t),$h();break;case 5:uR(t);break;case 1:gs(t.type)&&Ry(t);break;case 4:Jk(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Br(By,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Br(nn,nn.current&1),t.flags|=128,null):r&t.child.childLanes?RR(e,t,r):(Br(nn,nn.current&1),e=Dl(e,t,r),e!==null?e.sibling:null);Br(nn,nn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return LR(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Br(nn,nn.current),n)break;return null;case 22:case 23:return t.lanes=0,DR(e,t,r)}return Dl(e,t,r)}var $R,OS,BR,VR;$R=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};OS=function(){};BR=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Bu(Fo.current);var i=null;switch(r){case\"input\":a=JN(e,a),n=JN(e,n),i=[];break;case\"select\":a=cn({},a,{value:void 0}),n=cn({},n,{value:void 0}),i=[];break;case\"textarea\":a=rS(e,a),n=rS(e,n),i=[];break;default:typeof a.onClick!=\"function\"&&typeof n.onClick==\"function\"&&(e.onclick=Iy)}aS(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u===\"style\"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]=\"\")}else u!==\"dangerouslySetInnerHTML\"&&u!==\"children\"&&u!==\"suppressContentEditableWarning\"&&u!==\"suppressHydrationWarning\"&&u!==\"autoFocus\"&&(Pp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u===\"style\")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]=\"\");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(i||(i=[]),i.push(u,r)),r=c;else u===\"dangerouslySetInnerHTML\"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u===\"children\"?typeof c!=\"string\"&&typeof c!=\"number\"||(i=i||[]).push(u,\"\"+c):u!==\"suppressContentEditableWarning\"&&u!==\"suppressHydrationWarning\"&&(Pp.hasOwnProperty(u)?(c!=null&&u===\"onScroll\"&&Hr(\"scroll\",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}r&&(i=i||[]).push(\"style\",r);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};VR=function(e,t,r,n){r!==n&&(t.flags|=4)};function Nm(e,t){if(!Qr)switch(e.tailMode){case\"hidden\":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case\"collapsed\":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ya(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function LZ(e,t,r){var n=t.pendingProps;switch(Gk(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ya(t),null;case 1:return gs(t.type)&&Fy(),ya(t),null;case 3:return n=t.stateNode,Vh(),qr(ps),qr(Pa),tC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mv(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zi!==null&&($S(zi),zi=null))),OS(e,t),ya(t),null;case 5:eC(t);var a=Bu(Wp.current);if(r=t.type,e!==null&&t.stateNode!=null)BR(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Be(166));return ya(t),null}if(e=Bu(Fo.current),mv(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[Eo]=t,n[zp]=i,e=(t.mode&1)!==0,r){case\"dialog\":Hr(\"cancel\",n),Hr(\"close\",n);break;case\"iframe\":case\"object\":case\"embed\":Hr(\"load\",n);break;case\"video\":case\"audio\":for(a=0;a<Ym.length;a++)Hr(Ym[a],n);break;case\"source\":Hr(\"error\",n);break;case\"img\":case\"image\":case\"link\":Hr(\"error\",n),Hr(\"load\",n);break;case\"details\":Hr(\"toggle\",n);break;case\"input\":XT(n,i),Hr(\"invalid\",n);break;case\"select\":n._wrapperState={wasMultiple:!!i.multiple},Hr(\"invalid\",n);break;case\"textarea\":QT(n,i),Hr(\"invalid\",n)}aS(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o===\"children\"?typeof l==\"string\"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&hv(n.textContent,l,e),a=[\"children\",l]):typeof l==\"number\"&&n.textContent!==\"\"+l&&(i.suppressHydrationWarning!==!0&&hv(n.textContent,l,e),a=[\"children\",\"\"+l]):Pp.hasOwnProperty(o)&&l!=null&&o===\"onScroll\"&&Hr(\"scroll\",n)}switch(r){case\"input\":sv(n),ZT(n,i,!0);break;case\"textarea\":sv(n),JT(n);break;case\"select\":case\"option\":break;default:typeof i.onClick==\"function\"&&(n.onclick=Iy)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e===\"http://www.w3.org/1999/xhtml\"&&(e=pF(r)),e===\"http://www.w3.org/1999/xhtml\"?r===\"script\"?(e=o.createElement(\"div\"),e.innerHTML=\"<script><\\/script>\",e=e.removeChild(e.firstChild)):typeof n.is==\"string\"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r===\"select\"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Eo]=t,e[zp]=n,$R(e,t,!1,!1),t.stateNode=e;e:{switch(o=sS(r,n),r){case\"dialog\":Hr(\"cancel\",e),Hr(\"close\",e),a=n;break;case\"iframe\":case\"object\":case\"embed\":Hr(\"load\",e),a=n;break;case\"video\":case\"audio\":for(a=0;a<Ym.length;a++)Hr(Ym[a],e);a=n;break;case\"source\":Hr(\"error\",e),a=n;break;case\"img\":case\"image\":case\"link\":Hr(\"error\",e),Hr(\"load\",e),a=n;break;case\"details\":Hr(\"toggle\",e),a=n;break;case\"input\":XT(e,n),a=JN(e,n),Hr(\"invalid\",e);break;case\"option\":a=n;break;case\"select\":e._wrapperState={wasMultiple:!!n.multiple},a=cn({},n,{value:void 0}),Hr(\"invalid\",e);break;case\"textarea\":QT(e,n),a=rS(e,n),Hr(\"invalid\",e);break;default:a=n}aS(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i===\"style\"?vF(e,c):i===\"dangerouslySetInnerHTML\"?(c=c?c.__html:void 0,c!=null&&gF(e,c)):i===\"children\"?typeof c==\"string\"?(r!==\"textarea\"||c!==\"\")&&Mp(e,c):typeof c==\"number\"&&Mp(e,\"\"+c):i!==\"suppressContentEditableWarning\"&&i!==\"suppressHydrationWarning\"&&i!==\"autoFocus\"&&(Pp.hasOwnProperty(i)?c!=null&&i===\"onScroll\"&&Hr(\"scroll\",e):c!=null&&Ok(e,i,c,o))}switch(r){case\"input\":sv(e),ZT(e,n,!1);break;case\"textarea\":sv(e),JT(e);break;case\"option\":n.value!=null&&e.setAttribute(\"value\",\"\"+zc(n.value));break;case\"select\":e.multiple=!!n.multiple,i=n.value,i!=null?rh(e,!!n.multiple,i,!1):n.defaultValue!=null&&rh(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick==\"function\"&&(e.onclick=Iy)}switch(r){case\"button\":case\"input\":case\"select\":case\"textarea\":n=!!n.autoFocus;break e;case\"img\":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ya(t),null;case 6:if(e&&t.stateNode!=null)VR(e,t,e.memoizedProps,n);else{if(typeof n!=\"string\"&&t.stateNode===null)throw Error(Be(166));if(r=Bu(Wp.current),Bu(Fo.current),mv(t)){if(n=t.stateNode,r=t.memoizedProps,n[Eo]=t,(i=n.nodeValue!==r)&&(e=Fs,e!==null))switch(e.tag){case 3:hv(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hv(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Eo]=t,t.stateNode=n}return ya(t),null;case 13:if(qr(nn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qr&&Is!==null&&t.mode&1&&!(t.flags&128))sR(),$h(),t.flags|=98560,i=!1;else if(i=mv(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(Be(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Be(317));i[Eo]=t}else $h(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ya(t),i=!1}else zi!==null&&($S(zi),zi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||nn.current&1?$n===0&&($n=3):hC())),t.updateQueue!==null&&(t.flags|=4),ya(t),null);case 4:return Vh(),OS(e,t),e===null&&Bp(t.stateNode.containerInfo),ya(t),null;case 10:return Xk(t.type._context),ya(t),null;case 17:return gs(t.type)&&Fy(),ya(t),null;case 19:if(qr(nn),i=t.memoizedState,i===null)return ya(t),null;if(n=(t.flags&128)!==0,o=i.rendering,o===null)if(n)Nm(i,!1);else{if($n!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Uy(e),o!==null){for(t.flags|=128,Nm(i,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Br(nn,nn.current&1|2),t.child}e=e.sibling}i.tail!==null&&bn()>Uh&&(t.flags|=128,n=!0,Nm(i,!1),t.lanes=4194304)}else{if(!n)if(e=Uy(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Nm(i,!0),i.tail===null&&i.tailMode===\"hidden\"&&!o.alternate&&!Qr)return ya(t),null}else 2*bn()-i.renderingStartTime>Uh&&r!==1073741824&&(t.flags|=128,n=!0,Nm(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=bn(),t.sibling=null,r=nn.current,Br(nn,n?r&1|2:r&1),t):(ya(t),null);case 22:case 23:return fC(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Es&1073741824&&(ya(t),t.subtreeFlags&6&&(t.flags|=8192)):ya(t),null;case 24:return null;case 25:return null}throw Error(Be(156,t.tag))}function $Z(e,t){switch(Gk(t),t.tag){case 1:return gs(t.type)&&Fy(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Vh(),qr(ps),qr(Pa),tC(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return eC(t),null;case 13:if(qr(nn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Be(340));$h()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return qr(nn),null;case 4:return Vh(),null;case 10:return Xk(t.type._context),null;case 22:case 23:return fC(),null;case 24:return null;default:return null}}var xv=!1,Ea=!1,BZ=typeof WeakSet==\"function\"?WeakSet:Set,dt=null;function Hf(e,t){var r=e.ref;if(r!==null)if(typeof r==\"function\")try{r(null)}catch(n){hn(e,t,n)}else r.current=null}function PS(e,t,r){try{r()}catch(n){hn(e,t,n)}}var zO=!1;function VZ(e,t){if(pS=Py,e=GF(),Wk(e)){if(\"selectionStart\"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==i||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===a&&(l=o),h===i&&++d===n&&(c=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(gS={focusedElem:e,selectionRange:r},Py=!1,dt=t;dt!==null;)if(t=dt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,dt=e;else for(;dt!==null;){t=dt;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var p=g.memoizedProps,x=g.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?p:Ri(t.type,p),x);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent=\"\":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(S){hn(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,dt=e;break}dt=t.return}return g=zO,zO=!1,g}function fp(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&PS(t,r,i)}a=a.next}while(a!==n)}}function Zb(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function MS(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t==\"function\"?t(e):t.current=e}}function zR(e){var t=e.alternate;t!==null&&(e.alternate=null,zR(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Eo],delete t[zp],delete t[yS],delete t[NZ],delete t[SZ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function UR(e){return e.tag===5||e.tag===3||e.tag===4}function UO(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||UR(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function DS(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Iy));else if(n!==4&&(e=e.child,e!==null))for(DS(e,t,r),e=e.sibling;e!==null;)DS(e,t,r),e=e.sibling}function IS(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(IS(e,t,r),e=e.sibling;e!==null;)IS(e,t,r),e=e.sibling}var ca=null,$i=!1;function ec(e,t,r){for(r=r.child;r!==null;)WR(e,t,r),r=r.sibling}function WR(e,t,r){if(Io&&typeof Io.onCommitFiberUnmount==\"function\")try{Io.onCommitFiberUnmount(Ub,r)}catch{}switch(r.tag){case 5:Ea||Hf(r,t);case 6:var n=ca,a=$i;ca=null,ec(e,t,r),ca=n,$i=a,ca!==null&&($i?(e=ca,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ca.removeChild(r.stateNode));break;case 18:ca!==null&&($i?(e=ca,r=r.stateNode,e.nodeType===8?dj(e.parentNode,r):e.nodeType===1&&dj(e,r),Rp(e)):dj(ca,r.stateNode));break;case 4:n=ca,a=$i,ca=r.stateNode.containerInfo,$i=!0,ec(e,t,r),ca=n,$i=a;break;case 0:case 11:case 14:case 15:if(!Ea&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&PS(r,t,o),a=a.next}while(a!==n)}ec(e,t,r);break;case 1:if(!Ea&&(Hf(r,t),n=r.stateNode,typeof n.componentWillUnmount==\"function\"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){hn(r,t,l)}ec(e,t,r);break;case 21:ec(e,t,r);break;case 22:r.mode&1?(Ea=(n=Ea)||r.memoizedState!==null,ec(e,t,r),Ea=n):ec(e,t,r);break;default:ec(e,t,r)}}function WO(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new BZ),t.forEach(function(n){var a=XZ.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Pi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ca=l.stateNode,$i=!1;break e;case 3:ca=l.stateNode.containerInfo,$i=!0;break e;case 4:ca=l.stateNode.containerInfo,$i=!0;break e}l=l.return}if(ca===null)throw Error(Be(160));WR(i,o,a),ca=null,$i=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){hn(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)HR(t,e),t=t.sibling}function HR(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pi(t,e),go(e),n&4){try{fp(3,e,e.return),Zb(3,e)}catch(p){hn(e,e.return,p)}try{fp(5,e,e.return)}catch(p){hn(e,e.return,p)}}break;case 1:Pi(t,e),go(e),n&512&&r!==null&&Hf(r,r.return);break;case 5:if(Pi(t,e),go(e),n&512&&r!==null&&Hf(r,r.return),e.flags&32){var a=e.stateNode;try{Mp(a,\"\")}catch(p){hn(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l===\"input\"&&i.type===\"radio\"&&i.name!=null&&hF(a,i),sS(l,o);var u=sS(l,i);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d===\"style\"?vF(a,f):d===\"dangerouslySetInnerHTML\"?gF(a,f):d===\"children\"?Mp(a,f):Ok(a,d,f,u)}switch(l){case\"input\":eS(a,i);break;case\"textarea\":mF(a,i);break;case\"select\":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?rh(a,!!i.multiple,m,!1):h!==!!i.multiple&&(i.defaultValue!=null?rh(a,!!i.multiple,i.defaultValue,!0):rh(a,!!i.multiple,i.multiple?[]:\"\",!1))}a[zp]=i}catch(p){hn(e,e.return,p)}}break;case 6:if(Pi(t,e),go(e),n&4){if(e.stateNode===null)throw Error(Be(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(p){hn(e,e.return,p)}}break;case 3:if(Pi(t,e),go(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Rp(t.containerInfo)}catch(p){hn(e,e.return,p)}break;case 4:Pi(t,e),go(e);break;case 13:Pi(t,e),go(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(uC=bn())),n&4&&WO(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ea=(u=Ea)||d,Pi(t,e),Ea=u):Pi(t,e),go(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(dt=e,d=e.child;d!==null;){for(f=dt=d;dt!==null;){switch(h=dt,m=h.child,h.tag){case 0:case 11:case 14:case 15:fp(4,h,h.return);break;case 1:Hf(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount==\"function\"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){hn(n,r,p)}}break;case 5:Hf(h,h.return);break;case 22:if(h.memoizedState!==null){GO(f);continue}}m!==null?(m.return=h,dt=m):GO(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty==\"function\"?i.setProperty(\"display\",\"none\",\"important\"):i.display=\"none\"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty(\"display\")?c.display:null,l.style.display=xF(\"display\",o))}catch(p){hn(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?\"\":f.memoizedProps}catch(p){hn(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Pi(t,e),go(e),n&4&&WO(e);break;case 21:break;default:Pi(t,e),go(e)}}function go(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(UR(r)){var n=r;break e}r=r.return}throw Error(Be(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Mp(a,\"\"),n.flags&=-33);var i=UO(e);IS(e,i,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=UO(e);DS(e,l,o);break;default:throw Error(Be(161))}}catch(c){hn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zZ(e,t,r){dt=e,GR(e)}function GR(e,t,r){for(var n=(e.mode&1)!==0;dt!==null;){var a=dt,i=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||xv;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Ea;l=xv;var u=Ea;if(xv=o,(Ea=c)&&!u)for(dt=a;dt!==null;)o=dt,c=o.child,o.tag===22&&o.memoizedState!==null?KO(a):c!==null?(c.return=o,dt=c):KO(a);for(;i!==null;)dt=i,GR(i),i=i.sibling;dt=a,xv=l,Ea=u}HO(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,dt=i):HO(e)}}function HO(e){for(;dt!==null;){var t=dt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ea||Zb(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ea)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ri(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&AO(t,i,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}AO(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case\"button\":case\"input\":case\"select\":case\"textarea\":c.autoFocus&&r.focus();break;case\"img\":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Rp(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Ea||t.flags&512&&MS(t)}catch(h){hn(t,t.return,h)}}if(t===e){dt=null;break}if(r=t.sibling,r!==null){r.return=t.return,dt=r;break}dt=t.return}}function GO(e){for(;dt!==null;){var t=dt;if(t===e){dt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,dt=r;break}dt=t.return}}function KO(e){for(;dt!==null;){var t=dt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Zb(4,t)}catch(c){hn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount==\"function\"){var a=t.return;try{n.componentDidMount()}catch(c){hn(t,a,c)}}var i=t.return;try{MS(t)}catch(c){hn(t,i,c)}break;case 5:var o=t.return;try{MS(t)}catch(c){hn(t,o,c)}}}catch(c){hn(t,t.return,c)}if(t===e){dt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,dt=l;break}dt=t.return}}var UZ=Math.ceil,Gy=Hl.ReactCurrentDispatcher,lC=Hl.ReactCurrentOwner,ui=Hl.ReactCurrentBatchConfig,hr=0,ea=null,Cn=null,fa=0,Es=0,Gf=ou(0),$n=0,Yp=null,md=0,Qb=0,cC=0,hp=null,us=null,uC=0,Uh=1/0,dl=null,Ky=!1,FS=null,Rc=null,vv=!1,Ec=null,Yy=0,mp=0,RS=null,hy=-1,my=0;function Qa(){return hr&6?bn():hy!==-1?hy:hy=bn()}function Lc(e){return e.mode&1?hr&2&&fa!==0?fa&-fa:EZ.transition!==null?(my===0&&(my=TF()),my):(e=Ar,e!==0||(e=window.event,e=e===void 0?16:RF(e.type)),e):1}function Qi(e,t,r,n){if(50<mp)throw mp=0,RS=null,Error(Be(185));px(e,r,n),(!(hr&2)||e!==ea)&&(e===ea&&(!(hr&2)&&(Qb|=r),$n===4&&fc(e,fa)),xs(e,n),r===1&&hr===0&&!(t.mode&1)&&(Uh=bn()+500,Yb&&lu()))}function xs(e,t){var r=e.callbackNode;EX(e,t);var n=Oy(e,e===ea?fa:0);if(n===0)r!==null&&rO(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&rO(r),t===1)e.tag===0?_Z(YO.bind(null,e)):rR(YO.bind(null,e)),wZ(function(){!(hr&6)&&lu()}),r=null;else{switch(OF(n)){case 1:r=Fk;break;case 4:r=CF;break;case 16:r=Ty;break;case 536870912:r=AF;break;default:r=Ty}r=eL(r,KR.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function KR(e,t){if(hy=-1,my=0,hr&6)throw Error(Be(327));var r=e.callbackNode;if(oh()&&e.callbackNode!==r)return null;var n=Oy(e,e===ea?fa:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=qy(e,n);else{t=n;var a=hr;hr|=2;var i=qR();(ea!==e||fa!==t)&&(dl=null,Uh=bn()+500,td(e,t));do try{GZ();break}catch(l){YR(e,l)}while(!0);qk(),Gy.current=i,hr=a,Cn!==null?t=0:(ea=null,fa=0,t=$n)}if(t!==0){if(t===2&&(a=uS(e),a!==0&&(n=a,t=LS(e,a))),t===1)throw r=Yp,td(e,0),fc(e,n),xs(e,bn()),r;if(t===6)fc(e,n);else{if(a=e.current.alternate,!(n&30)&&!WZ(a)&&(t=qy(e,n),t===2&&(i=uS(e),i!==0&&(n=i,t=LS(e,i))),t===1))throw r=Yp,td(e,0),fc(e,n),xs(e,bn()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Be(345));case 2:Ou(e,us,dl);break;case 3:if(fc(e,n),(n&130023424)===n&&(t=uC+500-bn(),10<t)){if(Oy(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Qa(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=vS(Ou.bind(null,e,us,dl),t);break}Ou(e,us,dl);break;case 4:if(fc(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Zi(n);i=1<<o,o=t[o],o>a&&(a=o),n&=~i}if(n=a,n=bn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*UZ(n/1960))-n,10<n){e.timeoutHandle=vS(Ou.bind(null,e,us,dl),n);break}Ou(e,us,dl);break;case 5:Ou(e,us,dl);break;default:throw Error(Be(329))}}}return xs(e,bn()),e.callbackNode===r?KR.bind(null,e):null}function LS(e,t){var r=hp;return e.current.memoizedState.isDehydrated&&(td(e,t).flags|=256),e=qy(e,t),e!==2&&(t=us,us=r,t!==null&&$S(t)),e}function $S(e){us===null?us=e:us.push.apply(us,e)}function WZ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!ao(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fc(e,t){for(t&=~cC,t&=~Qb,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Zi(t),n=1<<r;e[r]=-1,t&=~n}}function YO(e){if(hr&6)throw Error(Be(327));oh();var t=Oy(e,0);if(!(t&1))return xs(e,bn()),null;var r=qy(e,t);if(e.tag!==0&&r===2){var n=uS(e);n!==0&&(t=n,r=LS(e,n))}if(r===1)throw r=Yp,td(e,0),fc(e,t),xs(e,bn()),r;if(r===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ou(e,us,dl),xs(e,bn()),null}function dC(e,t){var r=hr;hr|=1;try{return e(t)}finally{hr=r,hr===0&&(Uh=bn()+500,Yb&&lu())}}function pd(e){Ec!==null&&Ec.tag===0&&!(hr&6)&&oh();var t=hr;hr|=1;var r=ui.transition,n=Ar;try{if(ui.transition=null,Ar=1,e)return e()}finally{Ar=n,ui.transition=r,hr=t,!(hr&6)&&lu()}}function fC(){Es=Gf.current,qr(Gf)}function td(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,bZ(r)),Cn!==null)for(r=Cn.return;r!==null;){var n=r;switch(Gk(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Fy();break;case 3:Vh(),qr(ps),qr(Pa),tC();break;case 5:eC(n);break;case 4:Vh();break;case 13:qr(nn);break;case 19:qr(nn);break;case 10:Xk(n.type._context);break;case 22:case 23:fC()}r=r.return}if(ea=e,Cn=e=$c(e.current,null),fa=Es=t,$n=0,Yp=null,cC=Qb=md=0,us=hp=null,$u!==null){for(t=0;t<$u.length;t++)if(r=$u[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,n.next=o}r.pending=n}$u=null}return e}function YR(e,t){do{var r=Cn;try{if(qk(),uy.current=Hy,Wy){for(var n=ln.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Wy=!1}if(hd=0,qn=In=ln=null,dp=!1,Hp=0,lC.current=null,r===null||r.return===null){$n=1,Yp=t,Cn=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=fa,l.flags|=32768,c!==null&&typeof c==\"object\"&&typeof c.then==\"function\"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=IO(o);if(m!==null){m.flags&=-257,FO(m,o,l,i,t),m.mode&1&&DO(i,u,t),t=m,c=u;var g=t.updateQueue;if(g===null){var p=new Set;p.add(c),t.updateQueue=p}else g.add(c);break e}else{if(!(t&1)){DO(i,u,t),hC();break e}c=Error(Be(426))}}else if(Qr&&l.mode&1){var x=IO(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),FO(x,o,l,i,t),Kk(zh(c,l));break e}}i=c=zh(c,l),$n!==4&&($n=2),hp===null?hp=[i]:hp.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var b=OR(i,c,t);CO(i,b);break e;case 1:l=c;var y=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError==\"function\"||v!==null&&typeof v.componentDidCatch==\"function\"&&(Rc===null||!Rc.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var S=PR(i,l,t);CO(i,S);break e}}i=i.return}while(i!==null)}ZR(r)}catch(w){t=w,Cn===r&&r!==null&&(Cn=r=r.return);continue}break}while(!0)}function qR(){var e=Gy.current;return Gy.current=Hy,e===null?Hy:e}function hC(){($n===0||$n===3||$n===2)&&($n=4),ea===null||!(md&268435455)&&!(Qb&268435455)||fc(ea,fa)}function qy(e,t){var r=hr;hr|=2;var n=qR();(ea!==e||fa!==t)&&(dl=null,td(e,t));do try{HZ();break}catch(a){YR(e,a)}while(!0);if(qk(),hr=r,Gy.current=n,Cn!==null)throw Error(Be(261));return ea=null,fa=0,$n}function HZ(){for(;Cn!==null;)XR(Cn)}function GZ(){for(;Cn!==null&&!xX();)XR(Cn)}function XR(e){var t=JR(e.alternate,e,Es);e.memoizedProps=e.pendingProps,t===null?ZR(e):Cn=t,lC.current=null}function ZR(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=$Z(r,t),r!==null){r.flags&=32767,Cn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{$n=6,Cn=null;return}}else if(r=LZ(r,t,Es),r!==null){Cn=r;return}if(t=t.sibling,t!==null){Cn=t;return}Cn=t=e}while(t!==null);$n===0&&($n=5)}function Ou(e,t,r){var n=Ar,a=ui.transition;try{ui.transition=null,Ar=1,KZ(e,t,r,n)}finally{ui.transition=a,Ar=n}return null}function KZ(e,t,r,n){do oh();while(Ec!==null);if(hr&6)throw Error(Be(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(kX(e,i),e===ea&&(Cn=ea=null,fa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vv||(vv=!0,eL(Ty,function(){return oh(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=ui.transition,ui.transition=null;var o=Ar;Ar=1;var l=hr;hr|=4,lC.current=null,VZ(e,r),HR(r,e),hZ(gS),Py=!!pS,gS=pS=null,e.current=r,zZ(r),vX(),hr=l,Ar=o,ui.transition=i}else e.current=r;if(vv&&(vv=!1,Ec=e,Yy=a),i=e.pendingLanes,i===0&&(Rc=null),wX(r.stateNode),xs(e,bn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Ky)throw Ky=!1,e=FS,FS=null,e;return Yy&1&&e.tag!==0&&oh(),i=e.pendingLanes,i&1?e===RS?mp++:(mp=0,RS=e):mp=0,lu(),null}function oh(){if(Ec!==null){var e=OF(Yy),t=ui.transition,r=Ar;try{if(ui.transition=null,Ar=16>e?16:e,Ec===null)var n=!1;else{if(e=Ec,Ec=null,Yy=0,hr&6)throw Error(Be(331));var a=hr;for(hr|=4,dt=e.current;dt!==null;){var i=dt,o=i.child;if(dt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(dt=u;dt!==null;){var d=dt;switch(d.tag){case 0:case 11:case 15:fp(8,d,i)}var f=d.child;if(f!==null)f.return=d,dt=f;else for(;dt!==null;){d=dt;var h=d.sibling,m=d.return;if(zR(d),d===u){dt=null;break}if(h!==null){h.return=m,dt=h;break}dt=m}}}var g=i.alternate;if(g!==null){var p=g.child;if(p!==null){g.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(p!==null)}}dt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,dt=o;else e:for(;dt!==null;){if(i=dt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:fp(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,dt=b;break e}dt=i.return}}var y=e.current;for(dt=y;dt!==null;){o=dt;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,dt=v;else e:for(o=y;dt!==null;){if(l=dt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Zb(9,l)}}catch(w){hn(l,l.return,w)}if(l===o){dt=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,dt=S;break e}dt=l.return}}if(hr=a,lu(),Io&&typeof Io.onPostCommitFiberRoot==\"function\")try{Io.onPostCommitFiberRoot(Ub,e)}catch{}n=!0}return n}finally{Ar=r,ui.transition=t}}return!1}function qO(e,t,r){t=zh(r,t),t=OR(e,t,1),e=Fc(e,t,1),t=Qa(),e!==null&&(px(e,1,t),xs(e,t))}function hn(e,t,r){if(e.tag===3)qO(e,e,r);else for(;t!==null;){if(t.tag===3){qO(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError==\"function\"||typeof n.componentDidCatch==\"function\"&&(Rc===null||!Rc.has(n))){e=zh(r,e),e=PR(t,e,1),t=Fc(t,e,1),e=Qa(),t!==null&&(px(t,1,e),xs(t,e));break}}t=t.return}}function YZ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Qa(),e.pingedLanes|=e.suspendedLanes&r,ea===e&&(fa&r)===r&&($n===4||$n===3&&(fa&130023424)===fa&&500>bn()-uC?td(e,0):cC|=r),xs(e,t)}function QR(e,t){t===0&&(e.mode&1?(t=lv,lv<<=1,!(lv&130023424)&&(lv=4194304)):t=1);var r=Qa();e=Ml(e,t),e!==null&&(px(e,t,r),xs(e,r))}function qZ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),QR(e,r)}function XZ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Be(314))}n!==null&&n.delete(t),QR(e,r)}var JR;JR=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ps.current)fs=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return fs=!1,RZ(e,t,r);fs=!!(e.flags&131072)}else fs=!1,Qr&&t.flags&1048576&&nR(t,$y,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;fy(e,t),e=t.pendingProps;var a=Lh(t,Pa.current);ih(t,r),a=nC(null,t,n,e,a,r);var i=aC();return t.flags|=1,typeof a==\"object\"&&a!==null&&typeof a.render==\"function\"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,gs(n)?(i=!0,Ry(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Qk(t),a.updater=Xb,t.stateNode=a,a._reactInternals=t,_S(t,n,e,r),t=CS(null,t,n,!0,i,r)):(t.tag=0,Qr&&i&&Hk(t),Va(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(fy(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=QZ(n),e=Ri(n,e),a){case 0:t=kS(null,t,n,e,r);break e;case 1:t=$O(null,t,n,e,r);break e;case 11:t=RO(null,t,n,e,r);break e;case 14:t=LO(null,t,n,Ri(n.type,e),r);break e}throw Error(Be(306,n,\"\"))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ri(n,a),kS(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ri(n,a),$O(e,t,n,a,r);case 3:e:{if(FR(t),e===null)throw Error(Be(387));n=t.pendingProps,i=t.memoizedState,a=i.element,cR(e,t),zy(t,n,null,r);var o=t.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=zh(Error(Be(423)),t),t=BO(e,t,n,r,a);break e}else if(n!==a){a=zh(Error(Be(424)),t),t=BO(e,t,n,r,a);break e}else for(Is=Ic(t.stateNode.containerInfo.firstChild),Fs=t,Qr=!0,zi=null,r=oR(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if($h(),n===a){t=Dl(e,t,r);break e}Va(e,t,n,r)}t=t.child}return t;case 5:return uR(t),e===null&&jS(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,xS(n,a)?o=null:i!==null&&xS(n,i)&&(t.flags|=32),IR(e,t),Va(e,t,o,r),t.child;case 6:return e===null&&jS(t),null;case 13:return RR(e,t,r);case 4:return Jk(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Bh(t,null,n,r):Va(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ri(n,a),RO(e,t,n,a,r);case 7:return Va(e,t,t.pendingProps,r),t.child;case 8:return Va(e,t,t.pendingProps.children,r),t.child;case 12:return Va(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,Br(By,n._currentValue),n._currentValue=o,i!==null)if(ao(i.value,o)){if(i.children===a.children&&!ps.current){t=Dl(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(i.tag===1){c=Nl(-1,r&-r),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=r,c=i.alternate,c!==null&&(c.lanes|=r),NS(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Be(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),NS(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Va(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,ih(t,r),a=mi(a),n=n(a),t.flags|=1,Va(e,t,n,r),t.child;case 14:return n=t.type,a=Ri(n,t.pendingProps),a=Ri(n.type,a),LO(e,t,n,a,r);case 15:return MR(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ri(n,a),fy(e,t),t.tag=1,gs(n)?(e=!0,Ry(t)):e=!1,ih(t,r),TR(t,n,a),_S(t,n,a,r),CS(null,t,n,!0,e,r);case 19:return LR(e,t,r);case 22:return DR(e,t,r)}throw Error(Be(156,t.tag))};function eL(e,t){return kF(e,t)}function ZZ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(e,t,r,n){return new ZZ(e,t,r,n)}function mC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QZ(e){if(typeof e==\"function\")return mC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Mk)return 11;if(e===Dk)return 14}return 2}function $c(e,t){var r=e.alternate;return r===null?(r=oi(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function py(e,t,r,n,a,i){var o=2;if(n=e,typeof e==\"function\")mC(e)&&(o=1);else if(typeof e==\"string\")o=5;else e:switch(e){case Ff:return rd(r.children,a,i,t);case Pk:o=8,a|=8;break;case qN:return e=oi(12,r,t,a|2),e.elementType=qN,e.lanes=i,e;case XN:return e=oi(13,r,t,a),e.elementType=XN,e.lanes=i,e;case ZN:return e=oi(19,r,t,a),e.elementType=ZN,e.lanes=i,e;case uF:return Jb(r,a,i,t);default:if(typeof e==\"object\"&&e!==null)switch(e.$$typeof){case lF:o=10;break e;case cF:o=9;break e;case Mk:o=11;break e;case Dk:o=14;break e;case lc:o=16,n=null;break e}throw Error(Be(130,e==null?e:typeof e,\"\"))}return t=oi(o,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function rd(e,t,r,n){return e=oi(7,e,n,t),e.lanes=r,e}function Jb(e,t,r,n){return e=oi(22,e,n,t),e.elementType=uF,e.lanes=r,e.stateNode={isHidden:!1},e}function yj(e,t,r){return e=oi(6,e,null,t),e.lanes=r,e}function bj(e,t,r){return t=oi(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function JZ(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ej(0),this.expirationTimes=ej(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ej(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function pC(e,t,r,n,a,i,o,l,c){return e=new JZ(e,t,r,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=oi(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qk(i),e}function eQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:If,key:n==null?null:\"\"+n,children:e,containerInfo:t,implementation:r}}function tL(e){if(!e)return Uc;e=e._reactInternals;e:{if(qd(e)!==e||e.tag!==1)throw Error(Be(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(gs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Be(171))}if(e.tag===1){var r=e.type;if(gs(r))return tR(e,r,t)}return t}function rL(e,t,r,n,a,i,o,l,c){return e=pC(r,n,!0,e,a,i,o,l,c),e.context=tL(null),r=e.current,n=Qa(),a=Lc(r),i=Nl(n,a),i.callback=t??null,Fc(r,i,a),e.current.lanes=a,px(e,a,n),xs(e,n),e}function ew(e,t,r,n){var a=t.current,i=Qa(),o=Lc(a);return r=tL(r),t.context===null?t.context=r:t.pendingContext=r,t=Nl(i,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fc(a,t,o),e!==null&&(Qi(e,a,o,i),cy(e,a,o)),o}function Xy(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function XO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function gC(e,t){XO(e,t),(e=e.alternate)&&XO(e,t)}function tQ(){return null}var nL=typeof reportError==\"function\"?reportError:function(e){console.error(e)};function xC(e){this._internalRoot=e}tw.prototype.render=xC.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Be(409));ew(e,t,null,null)};tw.prototype.unmount=xC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;pd(function(){ew(null,e,null,null)}),t[Pl]=null}};function tw(e){this._internalRoot=e}tw.prototype.unstable_scheduleHydration=function(e){if(e){var t=DF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<dc.length&&t!==0&&t<dc[r].priority;r++);dc.splice(r,0,e),r===0&&FF(e)}};function vC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==\" react-mount-point-unstable \"))}function ZO(){}function rQ(e,t,r,n,a){if(a){if(typeof n==\"function\"){var i=n;n=function(){var u=Xy(o);i.call(u)}}var o=rL(t,n,e,0,null,!1,!1,\"\",ZO);return e._reactRootContainer=o,e[Pl]=o.current,Bp(e.nodeType===8?e.parentNode:e),pd(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n==\"function\"){var l=n;n=function(){var u=Xy(c);l.call(u)}}var c=pC(e,0,!1,null,null,!1,!1,\"\",ZO);return e._reactRootContainer=c,e[Pl]=c.current,Bp(e.nodeType===8?e.parentNode:e),pd(function(){ew(t,c,r,n)}),c}function nw(e,t,r,n,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a==\"function\"){var l=a;a=function(){var c=Xy(o);l.call(c)}}ew(t,o,e,a)}else o=rQ(r,t,e,a,n);return Xy(o)}PF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Km(t.pendingLanes);r!==0&&(Rk(t,r|1),xs(t,bn()),!(hr&6)&&(Uh=bn()+500,lu()))}break;case 13:pd(function(){var n=Ml(e,1);if(n!==null){var a=Qa();Qi(n,e,1,a)}}),gC(e,1)}};Lk=function(e){if(e.tag===13){var t=Ml(e,134217728);if(t!==null){var r=Qa();Qi(t,e,134217728,r)}gC(e,134217728)}};MF=function(e){if(e.tag===13){var t=Lc(e),r=Ml(e,t);if(r!==null){var n=Qa();Qi(r,e,t,n)}gC(e,t)}};DF=function(){return Ar};IF=function(e,t){var r=Ar;try{return Ar=e,t()}finally{Ar=r}};oS=function(e,t,r){switch(t){case\"input\":if(eS(e,r),t=r.name,r.type===\"radio\"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll(\"input[name=\"+JSON.stringify(\"\"+t)+'][type=\"radio\"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Kb(n);if(!a)throw Error(Be(90));fF(n),eS(n,a)}}}break;case\"textarea\":mF(e,r);break;case\"select\":t=r.value,t!=null&&rh(e,!!r.multiple,t,!1)}};wF=dC;jF=pd;var nQ={usingClientEntryPoint:!1,Events:[xx,Bf,Kb,yF,bF,dC]},Sm={findFiberByHostInstance:Lu,bundleType:0,version:\"18.3.1\",rendererPackageName:\"react-dom\"},aQ={bundleType:Sm.bundleType,version:Sm.version,rendererPackageName:Sm.rendererPackageName,rendererConfig:Sm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Hl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=_F(e),e===null?null:e.stateNode},findFiberByHostInstance:Sm.findFiberByHostInstance||tQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:\"18.3.1-next-f1338f8080-20240426\"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<\"u\"){var yv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yv.isDisabled&&yv.supportsFiber)try{Ub=yv.inject(aQ),Io=yv}catch{}}Us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nQ;Us.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vC(t))throw Error(Be(200));return eQ(e,t,null,r)};Us.createRoot=function(e,t){if(!vC(e))throw Error(Be(299));var r=!1,n=\"\",a=nL;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=pC(e,1,!1,null,null,r,!1,n,a),e[Pl]=t.current,Bp(e.nodeType===8?e.parentNode:e),new xC(t)};Us.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render==\"function\"?Error(Be(188)):(e=Object.keys(e).join(\",\"),Error(Be(268,e)));return e=_F(t),e=e===null?null:e.stateNode,e};Us.flushSync=function(e){return pd(e)};Us.hydrate=function(e,t,r){if(!rw(t))throw Error(Be(200));return nw(null,e,t,!0,r)};Us.hydrateRoot=function(e,t,r){if(!vC(e))throw Error(Be(405));var n=r!=null&&r.hydratedSources||null,a=!1,i=\"\",o=nL;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=rL(t,null,e,1,r??null,a,!1,i,o),e[Pl]=t.current,Bp(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new tw(t)};Us.render=function(e,t,r){if(!rw(t))throw Error(Be(200));return nw(null,e,t,!1,r)};Us.unmountComponentAtNode=function(e){if(!rw(e))throw Error(Be(40));return e._reactRootContainer?(pd(function(){nw(null,null,e,!1,function(){e._reactRootContainer=null,e[Pl]=null})}),!0):!1};Us.unstable_batchedUpdates=dC;Us.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!rw(r))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return nw(e,t,r,!1,n)};Us.version=\"18.3.1-next-f1338f8080-20240426\";function aL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>\"u\"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=\"function\"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(aL)}catch(e){console.error(e)}}aL(),aF.exports=Us;var Xd=aF.exports;const sQ=Sr(Xd);var sL,QO=Xd;sL=QO.createRoot,QO.hydrateRoot;function iQ(e,t){if(e instanceof RegExp)return{keys:!1,pattern:e};var r,n,a,i,o=[],l=\"\",c=e.split(\"/\");for(c[0]||c.shift();a=c.shift();)r=a[0],r===\"*\"?(o.push(r),l+=a[1]===\"?\"?\"(?:/(.*))?\":\"/(.*)\"):r===\":\"?(n=a.indexOf(\"?\",1),i=a.indexOf(\".\",1),o.push(a.substring(1,~n?n:~i?i:a.length)),l+=~n&&!~i?\"(?:/([^/]+?))?\":\"/([^/]+?)\",~i&&(l+=(~n?\"?\":\"\")+\"\\\\\"+a.substring(i))):l+=\"/\"+a;return{keys:o,pattern:new RegExp(\"^\"+l+(t?\"(?=$|/)\":\"/?$\"),\"i\")}}var iL={exports:{}},oL={};/**\n * @license React\n * use-sync-external-store-shim.production.js\n *\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */var Wh=j;function oQ(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lQ=typeof Object.is==\"function\"?Object.is:oQ,cQ=Wh.useState,uQ=Wh.useEffect,dQ=Wh.useLayoutEffect,fQ=Wh.useDebugValue;function hQ(e,t){var r=t(),n=cQ({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return dQ(function(){a.value=r,a.getSnapshot=t,wj(a)&&i({inst:a})},[e,r,t]),uQ(function(){return wj(a)&&i({inst:a}),e(function(){wj(a)&&i({inst:a})})},[e]),fQ(r),r}function wj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!lQ(e,r)}catch{return!0}}function mQ(e,t){return t()}var pQ=typeof window>\"u\"||typeof window.document>\"u\"||typeof window.document.createElement>\"u\"?mQ:hQ;oL.useSyncExternalStore=Wh.useSyncExternalStore!==void 0?Wh.useSyncExternalStore:pQ;iL.exports=oL;var gQ=iL.exports;const xQ=rF.useInsertionEffect,vQ=typeof window<\"u\"&&typeof window.document<\"u\"&&typeof window.document.createElement<\"u\",yQ=vQ?j.useLayoutEffect:j.useEffect,bQ=xQ||yQ,lL=e=>{const t=j.useRef([e,(...r)=>t[0](...r)]).current;return bQ(()=>{t[0]=e}),t[1]},wQ=\"popstate\",yC=\"pushState\",bC=\"replaceState\",jQ=\"hashchange\",JO=[wQ,yC,bC,jQ],NQ=e=>{for(const t of JO)addEventListener(t,e);return()=>{for(const t of JO)removeEventListener(t,e)}},cL=(e,t)=>gQ.useSyncExternalStore(NQ,e,t),SQ=()=>location.search,_Q=({ssrSearch:e=\"\"}={})=>cL(SQ,()=>e),eP=()=>location.pathname,EQ=({ssrPath:e}={})=>cL(eP,e?()=>e:eP),kQ=(e,{replace:t=!1,state:r=null}={})=>history[t?bC:yC](r,\"\",e),CQ=(e={})=>[EQ(e),kQ],tP=Symbol.for(\"wouter_v3\");if(typeof history<\"u\"&&typeof window[tP]>\"u\"){for(const e of[yC,bC]){const t=history[e];history[e]=function(){const r=t.apply(this,arguments),n=new Event(e);return n.arguments=arguments,dispatchEvent(n),r}}Object.defineProperty(window,tP,{value:!0})}const AQ=(e,t)=>t.toLowerCase().indexOf(e.toLowerCase())?\"~\"+t:t.slice(e.length)||\"/\",uL=(e=\"\")=>e===\"/\"?\"\":e,TQ=(e,t)=>e[0]===\"~\"?e.slice(1):uL(t)+e,OQ=(e=\"\",t)=>AQ(rP(uL(e)),rP(t)),rP=e=>{try{return decodeURI(e)}catch{return e}},dL={hook:CQ,searchHook:_Q,parser:iQ,base:\"\",ssrPath:void 0,ssrSearch:void 0,hrefs:e=>e},fL=j.createContext(dL),F0=()=>j.useContext(fL),hL={},mL=j.createContext(hL),PQ=()=>j.useContext(mL),aw=e=>{const[t,r]=e.hook(e);return[OQ(e.base,t),lL((n,a)=>r(TQ(n,e.base),a))]},sw=()=>aw(F0()),wC=(e,t,r,n)=>{const{pattern:a,keys:i}=t instanceof RegExp?{keys:!1,pattern:t}:e(t||\"*\",n),o=a.exec(r)||[],[l,...c]=o;return l!==void 0?[!0,(()=>{const u=i!==!1?Object.fromEntries(i.map((f,h)=>[f,c[h]])):o.groups;let d={...c};return u&&Object.assign(d,u),d})(),...n?[l]:[]]:[!1,null]},jC=e=>wC(F0().parser,e,sw()[0]),MQ=({children:e,...t})=>{var d,f;const r=F0(),n=t.hook?dL:r;let a=n;const[i,o]=((d=t.ssrPath)==null?void 0:d.split(\"?\"))??[];o&&(t.ssrSearch=o,t.ssrPath=i),t.hrefs=t.hrefs??((f=t.hook)==null?void 0:f.hrefs);let l=j.useRef({}),c=l.current,u=c;for(let h in n){const m=h===\"base\"?n[h]+(t[h]||\"\"):t[h]||n[h];c===u&&m!==u[h]&&(l.current=u={...u}),u[h]=m,m!==n[h]&&(a=u)}return j.createElement(fL.Provider,{value:a,children:e})},nP=({children:e,component:t},r)=>t?j.createElement(t,{params:r}):typeof e==\"function\"?e(r):e,DQ=e=>{let t=j.useRef(hL),r=t.current;for(const n in e)e[n]!==r[n]&&(r=e);return Object.keys(e).length===0&&(r=e),t.current=r},sa=({path:e,nest:t,match:r,...n})=>{const a=F0(),[i]=aw(a),[o,l,c]=r??wC(a.parser,e,i,t),u=DQ({...PQ(),...l});if(!o)return null;const d=c?j.createElement(MQ,{base:c},nP(n,u)):nP(n,u);return j.createElement(mL.Provider,{value:u,children:d})},bv=j.forwardRef((e,t)=>{const r=F0(),[n,a]=aw(r),{to:i=\"\",href:o=i,onClick:l,asChild:c,children:u,className:d,replace:f,state:h,...m}=e,g=lL(x=>{x.ctrlKey||x.metaKey||x.altKey||x.shiftKey||x.button!==0||(l==null||l(x),x.defaultPrevented||(x.preventDefault(),a(o,e)))}),p=r.hrefs(o[0]===\"~\"?o.slice(1):r.base+o,r);return c&&j.isValidElement(u)?j.cloneElement(u,{onClick:g,href:p}):j.createElement(\"a\",{...m,onClick:g,href:p,className:d!=null&&d.call?d(n===o):d,children:u,ref:t})}),pL=e=>Array.isArray(e)?e.flatMap(t=>pL(t&&t.type===j.Fragment?t.props.children:t)):[e],IQ=({children:e,location:t})=>{const r=F0(),[n]=aw(r);for(const a of pL(e)){let i=0;if(j.isValidElement(a)&&(i=wC(r.parser,a.props.path,t||n,a.props.nest))[0])return j.cloneElement(a,{match:i})}return null};var R0=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},gd=typeof window>\"u\"||\"Deno\"in globalThis;function ri(){}function FQ(e,t){return typeof e==\"function\"?e(t):e}function BS(e){return typeof e==\"number\"&&e>=0&&e!==1/0}function gL(e,t){return Math.max(e+(t||0)-Date.now(),0)}function lh(e,t){return typeof e==\"function\"?e(t):e}function Ui(e,t){return typeof e==\"function\"?e(t):e}function aP(e,t){const{type:r=\"all\",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:l}=e;if(o){if(n){if(t.queryHash!==NC(o,t.options))return!1}else if(!qp(t.queryKey,o))return!1}if(r!==\"all\"){const c=t.isActive();if(r===\"active\"&&!c||r===\"inactive\"&&c)return!1}return!(typeof l==\"boolean\"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function sP(e,t){const{exact:r,status:n,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(xd(t.options.mutationKey)!==xd(i))return!1}else if(!qp(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function NC(e,t){return((t==null?void 0:t.queryKeyHashFn)||xd)(e)}function xd(e){return JSON.stringify(e,(t,r)=>VS(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function qp(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e==\"object\"&&typeof t==\"object\"?!Object.keys(t).some(r=>!qp(e[r],t[r])):!1}function xL(e,t){if(e===t)return e;const r=iP(e)&&iP(t);if(r||VS(e)&&VS(t)){const n=r?e:Object.keys(e),a=n.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{};let c=0;for(let u=0;u<o;u++){const d=r?u:i[u];(!r&&n.includes(d)||r)&&e[d]===void 0&&t[d]===void 0?(l[d]=void 0,c++):(l[d]=xL(e[d],t[d]),l[d]===e[d]&&e[d]!==void 0&&c++)}return a===o&&c===a?e:l}return t}function Zy(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}function iP(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function VS(e){if(!oP(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!oP(r)||!r.hasOwnProperty(\"isPrototypeOf\")||Object.getPrototypeOf(e)!==Object.prototype)}function oP(e){return Object.prototype.toString.call(e)===\"[object Object]\"}function RQ(e){return new Promise(t=>{setTimeout(t,e)})}function zS(e,t,r){return typeof r.structuralSharing==\"function\"?r.structuralSharing(e,t):r.structuralSharing!==!1?xL(e,t):t}function LQ(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function $Q(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var SC=Symbol();function vL(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===SC?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Yu,gc,Sh,F8,BQ=(F8=class extends R0{constructor(){super();wt(this,Yu);wt(this,gc);wt(this,Sh);lt(this,Sh,t=>{if(!gd&&window.addEventListener){const r=()=>t();return window.addEventListener(\"visibilitychange\",r,!1),()=>{window.removeEventListener(\"visibilitychange\",r)}}})}onSubscribe(){le(this,gc)||this.setEventListener(le(this,Sh))}onUnsubscribe(){var t;this.hasListeners()||((t=le(this,gc))==null||t.call(this),lt(this,gc,void 0))}setEventListener(t){var r;lt(this,Sh,t),(r=le(this,gc))==null||r.call(this),lt(this,gc,t(n=>{typeof n==\"boolean\"?this.setFocused(n):this.onFocus()}))}setFocused(t){le(this,Yu)!==t&&(lt(this,Yu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof le(this,Yu)==\"boolean\"?le(this,Yu):((t=globalThis.document)==null?void 0:t.visibilityState)!==\"hidden\"}},Yu=new WeakMap,gc=new WeakMap,Sh=new WeakMap,F8),_C=new BQ,_h,xc,Eh,R8,VQ=(R8=class extends R0{constructor(){super();wt(this,_h,!0);wt(this,xc);wt(this,Eh);lt(this,Eh,t=>{if(!gd&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener(\"online\",r,!1),window.addEventListener(\"offline\",n,!1),()=>{window.removeEventListener(\"online\",r),window.removeEventListener(\"offline\",n)}}})}onSubscribe(){le(this,xc)||this.setEventListener(le(this,Eh))}onUnsubscribe(){var t;this.hasListeners()||((t=le(this,xc))==null||t.call(this),lt(this,xc,void 0))}setEventListener(t){var r;lt(this,Eh,t),(r=le(this,xc))==null||r.call(this),lt(this,xc,t(this.setOnline.bind(this)))}setOnline(t){le(this,_h)!==t&&(lt(this,_h,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return le(this,_h)}},_h=new WeakMap,xc=new WeakMap,Eh=new WeakMap,R8),Qy=new VQ;function US(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status=\"pending\",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:\"fulfilled\",value:a}),e(a)},r.reject=a=>{n({status:\"rejected\",reason:a}),t(a)},r}function zQ(e){return Math.min(1e3*2**e,3e4)}function yL(e){return(e??\"online\")===\"online\"?Qy.isOnline():!0}var bL=class extends Error{constructor(e){super(\"CancelledError\"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function jj(e){return e instanceof bL}function wL(e){let t=!1,r=0,n=!1,a;const i=US(),o=p=>{var x;n||(h(new bL(p)),(x=e.abort)==null||x.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>_C.isFocused()&&(e.networkMode===\"always\"||Qy.isOnline())&&e.canRun(),d=()=>yL(e.networkMode)&&e.canRun(),f=p=>{var x;n||(n=!0,(x=e.onSuccess)==null||x.call(e,p),a==null||a(),i.resolve(p))},h=p=>{var x;n||(n=!0,(x=e.onError)==null||x.call(e,p),a==null||a(),i.reject(p))},m=()=>new Promise(p=>{var x;a=b=>{(n||u())&&p(b)},(x=e.onPause)==null||x.call(e)}).then(()=>{var p;a=void 0,n||(p=e.onContinue)==null||p.call(e)}),g=()=>{if(n)return;let p;const x=r===0?e.initialPromise:void 0;try{p=x??e.fn()}catch(b){p=Promise.reject(b)}Promise.resolve(p).then(f).catch(b=>{var N;if(n)return;const y=e.retry??(gd?0:3),v=e.retryDelay??zQ,S=typeof v==\"function\"?v(r,b):v,w=y===!0||typeof y==\"number\"&&r<y||typeof y==\"function\"&&y(r,b);if(t||!w){h(b);return}r++,(N=e.onFail)==null||N.call(e,r,b),RQ(S).then(()=>u()?void 0:m()).then(()=>{t?h(b):g()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?g():m().then(g),i)}}function UQ(){let e=[],t=0,r=l=>{l()},n=l=>{l()},a=l=>setTimeout(l,0);const i=l=>{t?e.push(l):a(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var Fn=UQ(),qu,L8,jL=(L8=class{constructor(){wt(this,qu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),BS(this.gcTime)&&lt(this,qu,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(gd?1/0:5*60*1e3))}clearGcTimeout(){le(this,qu)&&(clearTimeout(le(this,qu)),lt(this,qu,void 0))}},qu=new WeakMap,L8),kh,Ch,ti,wa,ux,Xu,Li,ll,$8,WQ=($8=class extends jL{constructor(t){super();wt(this,Li);wt(this,kh);wt(this,Ch);wt(this,ti);wt(this,wa);wt(this,ux);wt(this,Xu);lt(this,Xu,!1),lt(this,ux,t.defaultOptions),this.setOptions(t.options),this.observers=[],lt(this,ti,t.cache),this.queryKey=t.queryKey,this.queryHash=t.queryHash,lt(this,kh,HQ(this.options)),this.state=t.state??le(this,kh),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=le(this,wa))==null?void 0:t.promise}setOptions(t){this.options={...le(this,ux),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus===\"idle\"&&le(this,ti).remove(this)}setData(t,r){const n=zS(this.state.data,t,this.options);return Yt(this,Li,ll).call(this,{data:n,type:\"success\",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Yt(this,Li,ll).call(this,{type:\"setState\",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=le(this,wa))==null?void 0:n.promise;return(a=le(this,wa))==null||a.cancel(t),r?r.then(ri).catch(ri):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(le(this,kh))}isActive(){return this.observers.some(t=>Ui(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===SC||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!gL(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=le(this,wa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=le(this,wa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),le(this,ti).notify({type:\"observerAdded\",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(le(this,wa)&&(le(this,Xu)?le(this,wa).cancel({revert:!0}):le(this,wa).cancelRetry()),this.scheduleGc()),le(this,ti).notify({type:\"observerRemoved\",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Yt(this,Li,ll).call(this,{type:\"invalidate\"})}fetch(t,r){var c,u,d;if(this.state.fetchStatus!==\"idle\"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(le(this,wa))return le(this,wa).continueRetry(),le(this,wa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(h=>h.options.queryFn);f&&this.setOptions(f.options)}const n=new AbortController,a=f=>{Object.defineProperty(f,\"signal\",{enumerable:!0,get:()=>(lt(this,Xu,!0),n.signal)})},i=()=>{const f=vL(this.options,r),h={queryKey:this.queryKey,meta:this.meta};return a(h),lt(this,Xu,!1),this.options.persister?this.options.persister(f,h,this):f(h)},o={fetchOptions:r,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};a(o),(c=this.options.behavior)==null||c.onFetch(o,this),lt(this,Ch,this.state),(this.state.fetchStatus===\"idle\"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Yt(this,Li,ll).call(this,{type:\"fetch\",meta:(d=o.fetchOptions)==null?void 0:d.meta});const l=f=>{var h,m,g,p;jj(f)&&f.silent||Yt(this,Li,ll).call(this,{type:\"error\",error:f}),jj(f)||((m=(h=le(this,ti).config).onError)==null||m.call(h,f,this),(p=(g=le(this,ti).config).onSettled)==null||p.call(g,this.state.data,f,this)),this.scheduleGc()};return lt(this,wa,wL({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onSuccess:f=>{var h,m,g,p;if(f===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(x){l(x);return}(m=(h=le(this,ti).config).onSuccess)==null||m.call(h,f,this),(p=(g=le(this,ti).config).onSettled)==null||p.call(g,f,this.state.error,this),this.scheduleGc()},onError:l,onFail:(f,h)=>{Yt(this,Li,ll).call(this,{type:\"failed\",failureCount:f,error:h})},onPause:()=>{Yt(this,Li,ll).call(this,{type:\"pause\"})},onContinue:()=>{Yt(this,Li,ll).call(this,{type:\"continue\"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),le(this,wa).start()}},kh=new WeakMap,Ch=new WeakMap,ti=new WeakMap,wa=new WeakMap,ux=new WeakMap,Xu=new WeakMap,Li=new WeakSet,ll=function(t){const r=n=>{switch(t.type){case\"failed\":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case\"pause\":return{...n,fetchStatus:\"paused\"};case\"continue\":return{...n,fetchStatus:\"fetching\"};case\"fetch\":return{...n,...NL(n.data,this.options),fetchMeta:t.meta??null};case\"success\":return{...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:\"success\",...!t.manual&&{fetchStatus:\"idle\",fetchFailureCount:0,fetchFailureReason:null}};case\"error\":const a=t.error;return jj(a)&&a.revert&&le(this,Ch)?{...le(this,Ch),fetchStatus:\"idle\"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:\"idle\",status:\"error\"};case\"invalidate\":return{...n,isInvalidated:!0};case\"setState\":return{...n,...t.state}}};this.state=r(this.state),Fn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),le(this,ti).notify({query:this,type:\"updated\",action:t})})},$8);function NL(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yL(t.networkMode)?\"fetching\":\"paused\",...e===void 0&&{error:null,status:\"pending\"}}}function HQ(e){const t=typeof e.initialData==\"function\"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt==\"function\"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?\"success\":\"pending\",fetchStatus:\"idle\"}}var jo,B8,GQ=(B8=class extends R0{constructor(t={}){super();wt(this,jo);this.config=t,lt(this,jo,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??NC(a,r);let o=this.get(i);return o||(o=new WQ({cache:this,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){le(this,jo).has(t.queryHash)||(le(this,jo).set(t.queryHash,t),this.notify({type:\"added\",query:t}))}remove(t){const r=le(this,jo).get(t.queryHash);r&&(t.destroy(),r===t&&le(this,jo).delete(t.queryHash),this.notify({type:\"removed\",query:t}))}clear(){Fn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return le(this,jo).get(t)}getAll(){return[...le(this,jo).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>aP(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>aP(t,n)):r}notify(t){Fn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Fn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Fn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},jo=new WeakMap,B8),No,La,Zu,So,sc,V8,KQ=(V8=class extends jL{constructor(t){super();wt(this,So);wt(this,No);wt(this,La);wt(this,Zu);this.mutationId=t.mutationId,lt(this,La,t.mutationCache),lt(this,No,[]),this.state=t.state||SL(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){le(this,No).includes(t)||(le(this,No).push(t),this.clearGcTimeout(),le(this,La).notify({type:\"observerAdded\",mutation:this,observer:t}))}removeObserver(t){lt(this,No,le(this,No).filter(r=>r!==t)),this.scheduleGc(),le(this,La).notify({type:\"observerRemoved\",mutation:this,observer:t})}optionalRemove(){le(this,No).length||(this.state.status===\"pending\"?this.scheduleGc():le(this,La).remove(this))}continue(){var t;return((t=le(this,Zu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var a,i,o,l,c,u,d,f,h,m,g,p,x,b,y,v,S,w,N,_;lt(this,Zu,wL({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error(\"No mutationFn found\")),onFail:(E,k)=>{Yt(this,So,sc).call(this,{type:\"failed\",failureCount:E,error:k})},onPause:()=>{Yt(this,So,sc).call(this,{type:\"pause\"})},onContinue:()=>{Yt(this,So,sc).call(this,{type:\"continue\"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>le(this,La).canRun(this)}));const r=this.state.status===\"pending\",n=!le(this,Zu).canStart();try{if(!r){Yt(this,So,sc).call(this,{type:\"pending\",variables:t,isPaused:n}),await((i=(a=le(this,La).config).onMutate)==null?void 0:i.call(a,t,this));const k=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));k!==this.state.context&&Yt(this,So,sc).call(this,{type:\"pending\",context:k,variables:t,isPaused:n})}const E=await le(this,Zu).start();return await((u=(c=le(this,La).config).onSuccess)==null?void 0:u.call(c,E,t,this.state.context,this)),await((f=(d=this.options).onSuccess)==null?void 0:f.call(d,E,t,this.state.context)),await((m=(h=le(this,La).config).onSettled)==null?void 0:m.call(h,E,null,this.state.variables,this.state.context,this)),await((p=(g=this.options).onSettled)==null?void 0:p.call(g,E,null,t,this.state.context)),Yt(this,So,sc).call(this,{type:\"success\",data:E}),E}catch(E){try{throw await((b=(x=le(this,La).config).onError)==null?void 0:b.call(x,E,t,this.state.context,this)),await((v=(y=this.options).onError)==null?void 0:v.call(y,E,t,this.state.context)),await((w=(S=le(this,La).config).onSettled)==null?void 0:w.call(S,void 0,E,this.state.variables,this.state.context,this)),await((_=(N=this.options).onSettled)==null?void 0:_.call(N,void 0,E,t,this.state.context)),E}finally{Yt(this,So,sc).call(this,{type:\"error\",error:E})}}finally{le(this,La).runNext(this)}}},No=new WeakMap,La=new WeakMap,Zu=new WeakMap,So=new WeakSet,sc=function(t){const r=n=>{switch(t.type){case\"failed\":return{...n,failureCount:t.failureCount,failureReason:t.error};case\"pause\":return{...n,isPaused:!0};case\"continue\":return{...n,isPaused:!1};case\"pending\":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:\"pending\",variables:t.variables,submittedAt:Date.now()};case\"success\":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:\"success\",isPaused:!1};case\"error\":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:\"error\"}}};this.state=r(this.state),Fn.batch(()=>{le(this,No).forEach(n=>{n.onMutationUpdate(t)}),le(this,La).notify({mutation:this,type:\"updated\",action:t})})},V8);function SL(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:\"idle\",variables:void 0,submittedAt:0}}var _s,dx,z8,YQ=(z8=class extends R0{constructor(t={}){super();wt(this,_s);wt(this,dx);this.config=t,lt(this,_s,new Map),lt(this,dx,Date.now())}build(t,r,n){const a=new KQ({mutationCache:this,mutationId:++rv(this,dx)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){const r=wv(t),n=le(this,_s).get(r)??[];n.push(t),le(this,_s).set(r,n),this.notify({type:\"added\",mutation:t})}remove(t){var n;const r=wv(t);if(le(this,_s).has(r)){const a=(n=le(this,_s).get(r))==null?void 0:n.filter(i=>i!==t);a&&(a.length===0?le(this,_s).delete(r):le(this,_s).set(r,a))}this.notify({type:\"removed\",mutation:t})}canRun(t){var n;const r=(n=le(this,_s).get(wv(t)))==null?void 0:n.find(a=>a.state.status===\"pending\");return!r||r===t}runNext(t){var n;const r=(n=le(this,_s).get(wv(t)))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}clear(){Fn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}getAll(){return[...le(this,_s).values()].flat()}find(t){const r={exact:!0,...t};return this.getAll().find(n=>sP(r,n))}findAll(t={}){return this.getAll().filter(r=>sP(t,r))}notify(t){Fn.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Fn.batch(()=>Promise.all(t.map(r=>r.continue().catch(ri))))}},_s=new WeakMap,dx=new WeakMap,z8);function wv(e){var t;return((t=e.options.scope)==null?void 0:t.id)??String(e.mutationId)}function lP(e){return{onFetch:(t,r)=>{var d,f,h,m,g;const n=t.options,a=(h=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:h.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let p=!1;const x=v=>{Object.defineProperty(v,\"signal\",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener(\"abort\",()=>{p=!0}),t.signal)})},b=vL(t.options,t.fetchOptions),y=async(v,S,w)=>{if(p)return Promise.reject();if(S==null&&v.pages.length)return Promise.resolve(v);const N={queryKey:t.queryKey,pageParam:S,direction:w?\"backward\":\"forward\",meta:t.options.meta};x(N);const _=await b(N),{maxPages:E}=t.options,k=w?$Q:LQ;return{pages:k(v.pages,_,E),pageParams:k(v.pageParams,S,E)}};if(a&&i.length){const v=a===\"backward\",S=v?qQ:cP,w={pages:i,pageParams:o},N=S(n,w);l=await y(w,N,v)}else{const v=e??i.length;do{const S=c===0?o[0]??n.initialPageParam:cP(n,l);if(c>0&&S==null)break;l=await y(l,S),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var p,x;return(x=(p=t.options).persister)==null?void 0:x.call(p,u,{queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function cP(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function qQ(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var fn,vc,yc,Ah,Th,bc,Oh,Ph,U8,XQ=(U8=class{constructor(e={}){wt(this,fn);wt(this,vc);wt(this,yc);wt(this,Ah);wt(this,Th);wt(this,bc);wt(this,Oh);wt(this,Ph);lt(this,fn,e.queryCache||new GQ),lt(this,vc,e.mutationCache||new YQ),lt(this,yc,e.defaultOptions||{}),lt(this,Ah,new Map),lt(this,Th,new Map),lt(this,bc,0)}mount(){rv(this,bc)._++,le(this,bc)===1&&(lt(this,Oh,_C.subscribe(async e=>{e&&(await this.resumePausedMutations(),le(this,fn).onFocus())})),lt(this,Ph,Qy.subscribe(async e=>{e&&(await this.resumePausedMutations(),le(this,fn).onOnline())})))}unmount(){var e,t;rv(this,bc)._--,le(this,bc)===0&&((e=le(this,Oh))==null||e.call(this),lt(this,Oh,void 0),(t=le(this,Ph))==null||t.call(this),lt(this,Ph,void 0))}isFetching(e){return le(this,fn).findAll({...e,fetchStatus:\"fetching\"}).length}isMutating(e){return le(this,vc).findAll({...e,status:\"pending\"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=le(this,fn).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(t===void 0)return this.fetchQuery(e);{const r=this.defaultQueryOptions(e),n=le(this,fn).build(this,r);return e.revalidateIfStale&&n.isStaleByTime(lh(r.staleTime,n))&&this.prefetchQuery(r),Promise.resolve(t)}}getQueriesData(e){return le(this,fn).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=le(this,fn).get(n.queryHash),i=a==null?void 0:a.state.data,o=FQ(t,i);if(o!==void 0)return le(this,fn).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return Fn.batch(()=>le(this,fn).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=le(this,fn).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=le(this,fn);Fn.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=le(this,fn),n={type:\"active\",...e};return Fn.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries(n,t)))}cancelQueries(e={},t={}){const r={revert:!0,...t},n=Fn.batch(()=>le(this,fn).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(ri).catch(ri)}invalidateQueries(e={},t={}){return Fn.batch(()=>{if(le(this,fn).findAll(e).forEach(n=>{n.invalidate()}),e.refetchType===\"none\")return Promise.resolve();const r={...e,type:e.refetchType??e.type??\"active\"};return this.refetchQueries(r,t)})}refetchQueries(e={},t){const r={...t,cancelRefetch:(t==null?void 0:t.cancelRefetch)??!0},n=Fn.batch(()=>le(this,fn).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(ri)),a.state.fetchStatus===\"paused\"?Promise.resolve():i}));return Promise.all(n).then(ri)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=le(this,fn).build(this,t);return r.isStaleByTime(lh(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ri).catch(ri)}fetchInfiniteQuery(e){return e.behavior=lP(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ri).catch(ri)}ensureInfiniteQueryData(e){return e.behavior=lP(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Qy.isOnline()?le(this,vc).resumePausedMutations():Promise.resolve()}getQueryCache(){return le(this,fn)}getMutationCache(){return le(this,vc)}getDefaultOptions(){return le(this,yc)}setDefaultOptions(e){lt(this,yc,e)}setQueryDefaults(e,t){le(this,Ah).set(xd(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...le(this,Ah).values()];let r={};return t.forEach(n=>{qp(e,n.queryKey)&&(r={...r,...n.defaultOptions})}),r}setMutationDefaults(e,t){le(this,Th).set(xd(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...le(this,Th).values()];let r={};return t.forEach(n=>{qp(e,n.mutationKey)&&(r={...r,...n.defaultOptions})}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...le(this,yc).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=NC(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!==\"always\"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode=\"offlineFirst\"),t.enabled!==!0&&t.queryFn===SC&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...le(this,yc).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){le(this,fn).clear(),le(this,vc).clear()}},fn=new WeakMap,vc=new WeakMap,yc=new WeakMap,Ah=new WeakMap,Th=new WeakMap,bc=new WeakMap,Oh=new WeakMap,Ph=new WeakMap,U8),is,ir,fx,$a,Qu,Mh,wc,_o,hx,Dh,Ih,Ju,ed,jc,Fh,Nr,qm,WS,HS,GS,KS,YS,qS,XS,_L,W8,ZQ=(W8=class extends R0{constructor(t,r){super();wt(this,Nr);wt(this,is);wt(this,ir);wt(this,fx);wt(this,$a);wt(this,Qu);wt(this,Mh);wt(this,wc);wt(this,_o);wt(this,hx);wt(this,Dh);wt(this,Ih);wt(this,Ju);wt(this,ed);wt(this,jc);wt(this,Fh,new Set);this.options=r,lt(this,is,t),lt(this,_o,null),lt(this,wc,US()),this.options.experimental_prefetchInRender||le(this,wc).reject(new Error(\"experimental_prefetchInRender feature flag is not enabled\")),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(le(this,ir).addObserver(this),uP(le(this,ir),this.options)?Yt(this,Nr,qm).call(this):this.updateResult(),Yt(this,Nr,KS).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ZS(le(this,ir),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ZS(le(this,ir),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Yt(this,Nr,YS).call(this),Yt(this,Nr,qS).call(this),le(this,ir).removeObserver(this)}setOptions(t,r){const n=this.options,a=le(this,ir);if(this.options=le(this,is).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!=\"boolean\"&&typeof this.options.enabled!=\"function\"&&typeof Ui(this.options.enabled,le(this,ir))!=\"boolean\")throw new Error(\"Expected enabled to be a boolean or a callback that returns a boolean\");Yt(this,Nr,XS).call(this),le(this,ir).setOptions(this.options),n._defaulted&&!Zy(this.options,n)&&le(this,is).getQueryCache().notify({type:\"observerOptionsUpdated\",query:le(this,ir),observer:this});const i=this.hasListeners();i&&dP(le(this,ir),a,this.options,n)&&Yt(this,Nr,qm).call(this),this.updateResult(r),i&&(le(this,ir)!==a||Ui(this.options.enabled,le(this,ir))!==Ui(n.enabled,le(this,ir))||lh(this.options.staleTime,le(this,ir))!==lh(n.staleTime,le(this,ir)))&&Yt(this,Nr,WS).call(this);const o=Yt(this,Nr,HS).call(this);i&&(le(this,ir)!==a||Ui(this.options.enabled,le(this,ir))!==Ui(n.enabled,le(this,ir))||o!==le(this,jc))&&Yt(this,Nr,GS).call(this,o)}getOptimisticResult(t){const r=le(this,is).getQueryCache().build(le(this,is),t),n=this.createResult(r,t);return JQ(this,n)&&(lt(this,$a,n),lt(this,Mh,this.options),lt(this,Qu,le(this,ir).state)),n}getCurrentResult(){return le(this,$a)}trackResult(t,r){const n={};return Object.keys(t).forEach(a=>{Object.defineProperty(n,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),r==null||r(a),t[a])})}),n}trackProp(t){le(this,Fh).add(t)}getCurrentQuery(){return le(this,ir)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=le(this,is).defaultQueryOptions(t),n=le(this,is).getQueryCache().build(le(this,is),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Yt(this,Nr,qm).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),le(this,$a)))}createResult(t,r){var E;const n=le(this,ir),a=this.options,i=le(this,$a),o=le(this,Qu),l=le(this,Mh),u=t!==n?t.state:le(this,fx),{state:d}=t;let f={...d},h=!1,m;if(r._optimisticResults){const k=this.hasListeners(),O=!k&&uP(t,r),C=k&&dP(t,n,r,a);(O||C)&&(f={...f,...NL(d.data,t.options)}),r._optimisticResults===\"isRestoring\"&&(f.fetchStatus=\"idle\")}let{error:g,errorUpdatedAt:p,status:x}=f;if(r.select&&f.data!==void 0)if(i&&f.data===(o==null?void 0:o.data)&&r.select===le(this,hx))m=le(this,Dh);else try{lt(this,hx,r.select),m=r.select(f.data),m=zS(i==null?void 0:i.data,m,r),lt(this,Dh,m),lt(this,_o,null)}catch(k){lt(this,_o,k)}else m=f.data;if(r.placeholderData!==void 0&&m===void 0&&x===\"pending\"){let k;if(i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData))k=i.data;else if(k=typeof r.placeholderData==\"function\"?r.placeholderData((E=le(this,Ih))==null?void 0:E.state.data,le(this,Ih)):r.placeholderData,r.select&&k!==void 0)try{k=r.select(k),lt(this,_o,null)}catch(O){lt(this,_o,O)}k!==void 0&&(x=\"success\",m=zS(i==null?void 0:i.data,k,r),h=!0)}le(this,_o)&&(g=le(this,_o),m=le(this,Dh),p=Date.now(),x=\"error\");const b=f.fetchStatus===\"fetching\",y=x===\"pending\",v=x===\"error\",S=y&&b,w=m!==void 0,_={status:x,fetchStatus:f.fetchStatus,isPending:y,isSuccess:x===\"success\",isError:v,isInitialLoading:S,isLoading:S,data:m,dataUpdatedAt:f.dataUpdatedAt,error:g,errorUpdatedAt:p,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!y,isLoadingError:v&&!w,isPaused:f.fetchStatus===\"paused\",isPlaceholderData:h,isRefetchError:v&&w,isStale:EC(t,r),refetch:this.refetch,promise:le(this,wc)};if(this.options.experimental_prefetchInRender){const k=A=>{_.status===\"error\"?A.reject(_.error):_.data!==void 0&&A.resolve(_.data)},O=()=>{const A=lt(this,wc,_.promise=US());k(A)},C=le(this,wc);switch(C.status){case\"pending\":t.queryHash===n.queryHash&&k(C);break;case\"fulfilled\":(_.status===\"error\"||_.data!==C.value)&&O();break;case\"rejected\":(_.status!==\"error\"||_.error!==C.reason)&&O();break}}return _}updateResult(t){const r=le(this,$a),n=this.createResult(le(this,ir),this.options);if(lt(this,Qu,le(this,ir).state),lt(this,Mh,this.options),le(this,Qu).data!==void 0&&lt(this,Ih,le(this,ir)),Zy(n,r))return;lt(this,$a,n);const a={},i=()=>{if(!r)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o==\"function\"?o():o;if(l===\"all\"||!l&&!le(this,Fh).size)return!0;const c=new Set(l??le(this,Fh));return this.options.throwOnError&&c.add(\"error\"),Object.keys(le(this,$a)).some(u=>{const d=u;return le(this,$a)[d]!==r[d]&&c.has(d)})};(t==null?void 0:t.listeners)!==!1&&i()&&(a.listeners=!0),Yt(this,Nr,_L).call(this,{...a,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Yt(this,Nr,KS).call(this)}},is=new WeakMap,ir=new WeakMap,fx=new WeakMap,$a=new WeakMap,Qu=new WeakMap,Mh=new WeakMap,wc=new WeakMap,_o=new WeakMap,hx=new WeakMap,Dh=new WeakMap,Ih=new WeakMap,Ju=new WeakMap,ed=new WeakMap,jc=new WeakMap,Fh=new WeakMap,Nr=new WeakSet,qm=function(t){Yt(this,Nr,XS).call(this);let r=le(this,ir).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(ri)),r},WS=function(){Yt(this,Nr,YS).call(this);const t=lh(this.options.staleTime,le(this,ir));if(gd||le(this,$a).isStale||!BS(t))return;const n=gL(le(this,$a).dataUpdatedAt,t)+1;lt(this,Ju,setTimeout(()=>{le(this,$a).isStale||this.updateResult()},n))},HS=function(){return(typeof this.options.refetchInterval==\"function\"?this.options.refetchInterval(le(this,ir)):this.options.refetchInterval)??!1},GS=function(t){Yt(this,Nr,qS).call(this),lt(this,jc,t),!(gd||Ui(this.options.enabled,le(this,ir))===!1||!BS(le(this,jc))||le(this,jc)===0)&&lt(this,ed,setInterval(()=>{(this.options.refetchIntervalInBackground||_C.isFocused())&&Yt(this,Nr,qm).call(this)},le(this,jc)))},KS=function(){Yt(this,Nr,WS).call(this),Yt(this,Nr,GS).call(this,Yt(this,Nr,HS).call(this))},YS=function(){le(this,Ju)&&(clearTimeout(le(this,Ju)),lt(this,Ju,void 0))},qS=function(){le(this,ed)&&(clearInterval(le(this,ed)),lt(this,ed,void 0))},XS=function(){const t=le(this,is).getQueryCache().build(le(this,is),this.options);if(t===le(this,ir))return;const r=le(this,ir);lt(this,ir,t),lt(this,fx,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},_L=function(t){Fn.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(le(this,$a))}),le(this,is).getQueryCache().notify({query:le(this,ir),type:\"observerResultsUpdated\"})})},W8);function QQ(e,t){return Ui(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status===\"error\"&&t.retryOnMount===!1)}function uP(e,t){return QQ(e,t)||e.state.data!==void 0&&ZS(e,t,t.refetchOnMount)}function ZS(e,t,r){if(Ui(t.enabled,e)!==!1){const n=typeof r==\"function\"?r(e):r;return n===\"always\"||n!==!1&&EC(e,t)}return!1}function dP(e,t,r,n){return(e!==t||Ui(n.enabled,e)===!1)&&(!r.suspense||e.state.status!==\"error\")&&EC(e,r)}function EC(e,t){return Ui(t.enabled,e)!==!1&&e.isStaleByTime(lh(t.staleTime,e))}function JQ(e,t){return!Zy(e.getCurrentResult(),t)}var Nc,Sc,os,pl,Tl,gy,QS,H8,eJ=(H8=class extends R0{constructor(r,n){super();wt(this,Tl);wt(this,Nc);wt(this,Sc);wt(this,os);wt(this,pl);lt(this,Nc,r),this.setOptions(n),this.bindMethods(),Yt(this,Tl,gy).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=le(this,Nc).defaultMutationOptions(r),Zy(this.options,n)||le(this,Nc).getMutationCache().notify({type:\"observerOptionsUpdated\",mutation:le(this,os),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&xd(n.mutationKey)!==xd(this.options.mutationKey)?this.reset():((a=le(this,os))==null?void 0:a.state.status)===\"pending\"&&le(this,os).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=le(this,os))==null||r.removeObserver(this)}onMutationUpdate(r){Yt(this,Tl,gy).call(this),Yt(this,Tl,QS).call(this,r)}getCurrentResult(){return le(this,Sc)}reset(){var r;(r=le(this,os))==null||r.removeObserver(this),lt(this,os,void 0),Yt(this,Tl,gy).call(this),Yt(this,Tl,QS).call(this)}mutate(r,n){var a;return lt(this,pl,n),(a=le(this,os))==null||a.removeObserver(this),lt(this,os,le(this,Nc).getMutationCache().build(le(this,Nc),this.options)),le(this,os).addObserver(this),le(this,os).execute(r)}},Nc=new WeakMap,Sc=new WeakMap,os=new WeakMap,pl=new WeakMap,Tl=new WeakSet,gy=function(){var n;const r=((n=le(this,os))==null?void 0:n.state)??SL();lt(this,Sc,{...r,isPending:r.status===\"pending\",isSuccess:r.status===\"success\",isError:r.status===\"error\",isIdle:r.status===\"idle\",mutate:this.mutate,reset:this.reset})},QS=function(r){Fn.batch(()=>{var n,a,i,o,l,c,u,d;if(le(this,pl)&&this.hasListeners()){const f=le(this,Sc).variables,h=le(this,Sc).context;(r==null?void 0:r.type)===\"success\"?((a=(n=le(this,pl)).onSuccess)==null||a.call(n,r.data,f,h),(o=(i=le(this,pl)).onSettled)==null||o.call(i,r.data,null,f,h)):(r==null?void 0:r.type)===\"error\"&&((c=(l=le(this,pl)).onError)==null||c.call(l,r.error,f,h),(d=(u=le(this,pl)).onSettled)==null||d.call(u,void 0,r.error,f,h))}this.listeners.forEach(f=>{f(le(this,Sc))})})},H8),EL=j.createContext(void 0),na=e=>{const t=j.useContext(EL);if(!t)throw new Error(\"No QueryClient set, use QueryClientProvider to set one\");return t},tJ=({client:e,children:t})=>(j.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),s.jsx(EL.Provider,{value:e,children:t})),kL=j.createContext(!1),rJ=()=>j.useContext(kL);kL.Provider;function nJ(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var aJ=j.createContext(nJ()),sJ=()=>j.useContext(aJ);function CL(e,t){return typeof e==\"function\"?e(...t):!!e}function JS(){}var iJ=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},oJ=e=>{j.useEffect(()=>{e.clearReset()},[e])},lJ=({result:e,errorResetBoundary:t,throwOnError:r,query:n})=>e.isError&&!t.isReset()&&!e.isFetching&&n&&CL(r,[e.error,n]),cJ=e=>{e.suspense&&(e.staleTime===void 0&&(e.staleTime=1e3),typeof e.gcTime==\"number\"&&(e.gcTime=Math.max(e.gcTime,1e3)))},uJ=(e,t)=>e.isLoading&&e.isFetching&&!t,dJ=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,fP=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function fJ(e,t,r){var d,f,h,m,g;const n=na(),a=rJ(),i=sJ(),o=n.defaultQueryOptions(e);(f=(d=n.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||f.call(d,o),o._optimisticResults=a?\"isRestoring\":\"optimistic\",cJ(o),iJ(o,i),oJ(i);const l=!n.getQueryCache().get(o.queryHash),[c]=j.useState(()=>new t(n,o)),u=c.getOptimisticResult(o);if(j.useSyncExternalStore(j.useCallback(p=>{const x=a?JS:c.subscribe(Fn.batchCalls(p));return c.updateResult(),x},[c,a]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),j.useEffect(()=>{c.setOptions(o,{listeners:!1})},[o,c]),dJ(o,u))throw fP(o,c,i);if(lJ({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:n.getQueryCache().get(o.queryHash)}))throw u.error;if((m=(h=n.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||m.call(h,o,u),o.experimental_prefetchInRender&&!gd&&uJ(u,a)){const p=l?fP(o,c,i):(g=n.getQueryCache().get(o.queryHash))==null?void 0:g.promise;p==null||p.catch(JS).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?u:c.trackResult(u)}function fr(e,t){return fJ(e,ZQ)}function zt(e,t){const r=na(),[n]=j.useState(()=>new eJ(r,e));j.useEffect(()=>{n.setOptions(e)},[n,e]);const a=j.useSyncExternalStore(j.useCallback(o=>n.subscribe(Fn.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=j.useCallback((o,l)=>{n.mutate(o,l).catch(JS)},[n]);if(a.error&&CL(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}async function AL(e){if(!e.ok){const t=await e.text()||e.statusText;try{const r=JSON.parse(t);throw new Error(r.message||t)}catch{throw new Error(t)}}}async function At(e,t,r){const n=r?{\"Content-Type\":\"application/json\"}:{},a=typeof window<\"u\"?localStorage.getItem(\"authToken\"):null;a&&(n.Authorization=`Bearer ${a}`);const i=await fetch(t,{method:e,headers:n,body:r?JSON.stringify(r):void 0,credentials:\"include\"});return await AL(i),i}const hJ=({on401:e})=>async({queryKey:t})=>{const r={},n=typeof window<\"u\"?localStorage.getItem(\"authToken\"):null;n&&(r.Authorization=`Bearer ${n}`);const a=await fetch(t.join(\"/\"),{headers:r,credentials:\"include\"});return e===\"returnNull\"&&a.status===401?null:(await AL(a),await a.json())},mJ=new XQ({defaultOptions:{queries:{queryFn:hJ({on401:\"throw\"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1e3*10,gcTime:1e3*60*10,retry:2,retryDelay:e=>Math.min(1e3*2**e,3e3)},mutations:{retry:!1}}}),pJ=1,gJ=1e6;let Nj=0;function xJ(){return Nj=(Nj+1)%Number.MAX_SAFE_INTEGER,Nj.toString()}const Sj=new Map,hP=e=>{if(Sj.has(e))return;const t=setTimeout(()=>{Sj.delete(e),pp({type:\"REMOVE_TOAST\",toastId:e})},gJ);Sj.set(e,t)},vJ=(e,t)=>{switch(t.type){case\"ADD_TOAST\":return{...e,toasts:[t.toast,...e.toasts].slice(0,pJ)};case\"UPDATE_TOAST\":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case\"DISMISS_TOAST\":{const{toastId:r}=t;return r?hP(r):e.toasts.forEach(n=>{hP(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case\"REMOVE_TOAST\":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},xy=[];let vy={toasts:[]};function pp(e){vy=vJ(vy,e),xy.forEach(t=>{t(vy)})}function yJ({...e}){const t=xJ(),r=a=>pp({type:\"UPDATE_TOAST\",toast:{...a,id:t}}),n=()=>pp({type:\"DISMISS_TOAST\",toastId:t});return pp({type:\"ADD_TOAST\",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function Un(){const[e,t]=j.useState(vy);return j.useEffect(()=>(xy.push(t),()=>{const r=xy.indexOf(t);r>-1&&xy.splice(r,1)}),[e]),{...e,toast:yJ,dismiss:r=>pp({type:\"DISMISS_TOAST\",toastId:r})}}function We(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function mP(e,t){if(typeof e==\"function\")return e(t);e!=null&&(e.current=t)}function Il(...e){return t=>{let r=!1;const n=e.map(a=>{const i=mP(a,t);return!r&&typeof i==\"function\"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i==\"function\"?i():mP(e[a],null)}}}}function Xt(...e){return j.useCallback(Il(...e),e)}function bJ(e,t){const r=j.createContext(t),n=i=>{const{children:o,...l}=i,c=j.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:o})};n.displayName=e+\"Provider\";function a(i){const o=j.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\\`${i}\\` must be used within \\`${e}\\``)}return[n,a]}function Wn(e,t=[]){let r=[];function n(i,o){const l=j.createContext(o),c=r.length;r=[...r,o];const u=f=>{var b;const{scope:h,children:m,...g}=f,p=((b=h==null?void 0:h[e])==null?void 0:b[c])||l,x=j.useMemo(()=>g,Object.values(g));return s.jsx(p.Provider,{value:x,children:m})};u.displayName=i+\"Provider\";function d(f,h){var p;const m=((p=h==null?void 0:h[e])==null?void 0:p[c])||l,g=j.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\\`${f}\\` must be used within \\`${i}\\``)}return[u,d]}const a=()=>{const i=r.map(o=>j.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return j.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return a.scopeName=e,[n,wJ(a,...t)]}function wJ(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:u})=>{const f=c(i)[`__scope${u}`];return{...l,...f}},{});return j.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Wc(e){const t=jJ(e),r=j.forwardRef((n,a)=>{const{children:i,...o}=n,l=j.Children.toArray(i),c=l.find(NJ);if(c){const u=c.props.children,d=l.map(f=>f===c?j.Children.count(u)>1?j.Children.only(null):j.isValidElement(u)?u.props.children:null:f);return s.jsx(t,{...o,ref:a,children:j.isValidElement(u)?j.cloneElement(u,void 0,d):null})}return s.jsx(t,{...o,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var TL=Wc(\"Slot\");function jJ(e){const t=j.forwardRef((r,n)=>{const{children:a,...i}=r;if(j.isValidElement(a)){const o=_J(a),l=SJ(i,a.props);return a.type!==j.Fragment&&(l.ref=n?Il(n,o):o),j.cloneElement(a,l)}return j.Children.count(a)>1?j.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var OL=Symbol(\"radix.slottable\");function PL(e){const t=({children:r})=>s.jsx(s.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=OL,t}function NJ(e){return j.isValidElement(e)&&typeof e.type==\"function\"&&\"__radixId\"in e.type&&e.type.__radixId===OL}function SJ(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n===\"style\"?r[n]={...a,...i}:n===\"className\"&&(r[n]=[a,i].filter(Boolean).join(\" \"))}return{...e,...r}}function _J(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,\"ref\"))==null?void 0:n.get,r=t&&\"isReactWarning\"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,\"ref\"))==null?void 0:a.get,r=t&&\"isReactWarning\"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function iw(e){const t=e+\"CollectionProvider\",[r,n]=Wn(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:x,children:b}=p,y=Y.useRef(null),v=Y.useRef(new Map).current;return s.jsx(a,{scope:x,itemMap:v,collectionRef:y,children:b})};o.displayName=t;const l=e+\"CollectionSlot\",c=Wc(l),u=Y.forwardRef((p,x)=>{const{scope:b,children:y}=p,v=i(l,b),S=Xt(x,v.collectionRef);return s.jsx(c,{ref:S,children:y})});u.displayName=l;const d=e+\"CollectionItemSlot\",f=\"data-radix-collection-item\",h=Wc(d),m=Y.forwardRef((p,x)=>{const{scope:b,children:y,...v}=p,S=Y.useRef(null),w=Xt(x,S),N=i(d,b);return Y.useEffect(()=>(N.itemMap.set(S,{ref:S,...v}),()=>void N.itemMap.delete(S))),s.jsx(h,{[f]:\"\",ref:w,children:y})});m.displayName=d;function g(p){const x=i(e+\"CollectionConsumer\",p);return Y.useCallback(()=>{const y=x.collectionRef.current;if(!y)return[];const v=Array.from(y.querySelectorAll(`[${f}]`));return Array.from(x.itemMap.values()).sort((N,_)=>v.indexOf(N.ref.current)-v.indexOf(_.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,n]}var EJ=[\"a\",\"button\",\"div\",\"form\",\"h2\",\"h3\",\"img\",\"input\",\"label\",\"li\",\"nav\",\"ol\",\"p\",\"span\",\"svg\",\"ul\"],st=EJ.reduce((e,t)=>{const r=Wc(`Primitive.${t}`),n=j.forwardRef((a,i)=>{const{asChild:o,...l}=a,c=o?r:t;return typeof window<\"u\"&&(window[Symbol.for(\"radix-ui\")]=!0),s.jsx(c,{...l,ref:i})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function kC(e,t){e&&Xd.flushSync(()=>e.dispatchEvent(t))}function ma(e){const t=j.useRef(e);return j.useEffect(()=>{t.current=e}),j.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function kJ(e,t=globalThis==null?void 0:globalThis.document){const r=ma(e);j.useEffect(()=>{const n=a=>{a.key===\"Escape\"&&r(a)};return t.addEventListener(\"keydown\",n,{capture:!0}),()=>t.removeEventListener(\"keydown\",n,{capture:!0})},[r,t])}var CJ=\"DismissableLayer\",e_=\"dismissableLayer.update\",AJ=\"dismissableLayer.pointerDownOutside\",TJ=\"dismissableLayer.focusOutside\",pP,ML=j.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Zd=j.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,u=j.useContext(ML),[d,f]=j.useState(null),h=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=j.useState({}),g=Xt(t,_=>f(_)),p=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=p.indexOf(x),y=d?p.indexOf(d):-1,v=u.layersWithOutsidePointerEventsDisabled.size>0,S=y>=b,w=PJ(_=>{const E=_.target,k=[...u.branches].some(O=>O.contains(E));!S||k||(a==null||a(_),o==null||o(_),_.defaultPrevented||l==null||l())},h),N=MJ(_=>{const E=_.target;[...u.branches].some(O=>O.contains(E))||(i==null||i(_),o==null||o(_),_.defaultPrevented||l==null||l())},h);return kJ(_=>{y===u.layers.size-1&&(n==null||n(_),!_.defaultPrevented&&l&&(_.preventDefault(),l()))},h),j.useEffect(()=>{if(d)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(pP=h.body.style.pointerEvents,h.body.style.pointerEvents=\"none\"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),gP(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=pP)}},[d,h,r,u]),j.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),gP())},[d,u]),j.useEffect(()=>{const _=()=>m({});return document.addEventListener(e_,_),()=>document.removeEventListener(e_,_)},[]),s.jsx(st.div,{...c,ref:g,style:{pointerEvents:v?S?\"auto\":\"none\":void 0,...e.style},onFocusCapture:We(e.onFocusCapture,N.onFocusCapture),onBlurCapture:We(e.onBlurCapture,N.onBlurCapture),onPointerDownCapture:We(e.onPointerDownCapture,w.onPointerDownCapture)})});Zd.displayName=CJ;var OJ=\"DismissableLayerBranch\",DL=j.forwardRef((e,t)=>{const r=j.useContext(ML),n=j.useRef(null),a=Xt(t,n);return j.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),s.jsx(st.div,{...e,ref:a})});DL.displayName=OJ;function PJ(e,t=globalThis==null?void 0:globalThis.document){const r=ma(e),n=j.useRef(!1),a=j.useRef(()=>{});return j.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){IL(AJ,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType===\"touch\"?(t.removeEventListener(\"click\",a.current),a.current=c,t.addEventListener(\"click\",a.current,{once:!0})):c()}else t.removeEventListener(\"click\",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener(\"pointerdown\",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener(\"pointerdown\",i),t.removeEventListener(\"click\",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function MJ(e,t=globalThis==null?void 0:globalThis.document){const r=ma(e),n=j.useRef(!1);return j.useEffect(()=>{const a=i=>{i.target&&!n.current&&IL(TJ,r,{originalEvent:i},{discrete:!1})};return t.addEventListener(\"focusin\",a),()=>t.removeEventListener(\"focusin\",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function gP(){const e=new CustomEvent(e_);document.dispatchEvent(e)}function IL(e,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?kC(a,i):a.dispatchEvent(i)}var DJ=Zd,IJ=DL,On=globalThis!=null&&globalThis.document?j.useLayoutEffect:()=>{},FJ=\"Portal\",L0=j.forwardRef((e,t)=>{var l;const{container:r,...n}=e,[a,i]=j.useState(!1);On(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?sQ.createPortal(s.jsx(st.div,{...n,ref:t}),o):null});L0.displayName=FJ;function RJ(e,t){return j.useReducer((r,n)=>t[r][n]??r,e)}var Fa=e=>{const{present:t,children:r}=e,n=LJ(t),a=typeof r==\"function\"?r({present:n.isPresent}):j.Children.only(r),i=Xt(n.ref,$J(a));return typeof r==\"function\"||n.isPresent?j.cloneElement(a,{ref:i}):null};Fa.displayName=\"Presence\";function LJ(e){const[t,r]=j.useState(),n=j.useRef({}),a=j.useRef(e),i=j.useRef(\"none\"),o=e?\"mounted\":\"unmounted\",[l,c]=RJ(o,{mounted:{UNMOUNT:\"unmounted\",ANIMATION_OUT:\"unmountSuspended\"},unmountSuspended:{MOUNT:\"mounted\",ANIMATION_END:\"unmounted\"},unmounted:{MOUNT:\"mounted\"}});return j.useEffect(()=>{const u=jv(n.current);i.current=l===\"mounted\"?u:\"none\"},[l]),On(()=>{const u=n.current,d=a.current;if(d!==e){const h=i.current,m=jv(u);e?c(\"MOUNT\"):m===\"none\"||(u==null?void 0:u.display)===\"none\"?c(\"UNMOUNT\"):c(d&&h!==m?\"ANIMATION_OUT\":\"UNMOUNT\"),a.current=e}},[e,c]),On(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,f=m=>{const p=jv(n.current).includes(m.animationName);if(m.target===t&&p&&(c(\"ANIMATION_END\"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode=\"forwards\",u=d.setTimeout(()=>{t.style.animationFillMode===\"forwards\"&&(t.style.animationFillMode=x)})}},h=m=>{m.target===t&&(i.current=jv(n.current))};return t.addEventListener(\"animationstart\",h),t.addEventListener(\"animationcancel\",f),t.addEventListener(\"animationend\",f),()=>{d.clearTimeout(u),t.removeEventListener(\"animationstart\",h),t.removeEventListener(\"animationcancel\",f),t.removeEventListener(\"animationend\",f)}}else c(\"ANIMATION_END\")},[t,c]),{isPresent:[\"mounted\",\"unmountSuspended\"].includes(l),ref:j.useCallback(u=>{u&&(n.current=getComputedStyle(u)),r(u)},[])}}function jv(e){return(e==null?void 0:e.animationName)||\"none\"}function $J(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,\"ref\"))==null?void 0:n.get,r=t&&\"isReactWarning\"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,\"ref\"))==null?void 0:a.get,r=t&&\"isReactWarning\"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function gi({prop:e,defaultProp:t,onChange:r=()=>{}}){const[n,a]=BJ({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:n,l=ma(r),c=j.useCallback(u=>{if(i){const f=typeof u==\"function\"?u(e):u;f!==e&&l(f)}else a(u)},[i,e,a,l]);return[o,c]}function BJ({defaultProp:e,onChange:t}){const r=j.useState(e),[n]=r,a=j.useRef(n),i=ma(t);return j.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}var VJ=\"VisuallyHidden\",yx=j.forwardRef((e,t)=>s.jsx(st.span,{...e,ref:t,style:{position:\"absolute\",border:0,width:1,height:1,padding:0,margin:-1,overflow:\"hidden\",clip:\"rect(0, 0, 0, 0)\",whiteSpace:\"nowrap\",wordWrap:\"normal\",...e.style}}));yx.displayName=VJ;var zJ=yx,CC=\"ToastProvider\",[AC,UJ,WJ]=iw(\"Toast\"),[FL,BKe]=Wn(\"Toast\",[WJ]),[HJ,ow]=FL(CC),RL=e=>{const{__scopeToast:t,label:r=\"Notification\",duration:n=5e3,swipeDirection:a=\"right\",swipeThreshold:i=50,children:o}=e,[l,c]=j.useState(null),[u,d]=j.useState(0),f=j.useRef(!1),h=j.useRef(!1);return r.trim()||console.error(`Invalid prop \\`label\\` supplied to \\`${CC}\\`. Expected non-empty \\`string\\`.`),s.jsx(AC.Provider,{scope:t,children:s.jsx(HJ,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:j.useCallback(()=>d(m=>m+1),[]),onToastRemove:j.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:h,children:o})})};RL.displayName=CC;var LL=\"ToastViewport\",GJ=[\"F8\"],t_=\"toast.viewportPause\",r_=\"toast.viewportResume\",$L=j.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=GJ,label:a=\"Notifications ({hotkey})\",...i}=e,o=ow(LL,r),l=UJ(r),c=j.useRef(null),u=j.useRef(null),d=j.useRef(null),f=j.useRef(null),h=Xt(t,f,o.onViewportChange),m=n.join(\"+\").replace(/Key/g,\"\").replace(/Digit/g,\"\"),g=o.toastCount>0;j.useEffect(()=>{const x=b=>{var v;n.length!==0&&n.every(S=>b[S]||b.code===S)&&((v=f.current)==null||v.focus())};return document.addEventListener(\"keydown\",x),()=>document.removeEventListener(\"keydown\",x)},[n]),j.useEffect(()=>{const x=c.current,b=f.current;if(g&&x&&b){const y=()=>{if(!o.isClosePausedRef.current){const N=new CustomEvent(t_);b.dispatchEvent(N),o.isClosePausedRef.current=!0}},v=()=>{if(o.isClosePausedRef.current){const N=new CustomEvent(r_);b.dispatchEvent(N),o.isClosePausedRef.current=!1}},S=N=>{!x.contains(N.relatedTarget)&&v()},w=()=>{x.contains(document.activeElement)||v()};return x.addEventListener(\"focusin\",y),x.addEventListener(\"focusout\",S),x.addEventListener(\"pointermove\",y),x.addEventListener(\"pointerleave\",w),window.addEventListener(\"blur\",y),window.addEventListener(\"focus\",v),()=>{x.removeEventListener(\"focusin\",y),x.removeEventListener(\"focusout\",S),x.removeEventListener(\"pointermove\",y),x.removeEventListener(\"pointerleave\",w),window.removeEventListener(\"blur\",y),window.removeEventListener(\"focus\",v)}}},[g,o.isClosePausedRef]);const p=j.useCallback(({tabbingDirection:x})=>{const y=l().map(v=>{const S=v.ref.current,w=[S,...see(S)];return x===\"forwards\"?w:w.reverse()});return(x===\"forwards\"?y.reverse():y).flat()},[l]);return j.useEffect(()=>{const x=f.current;if(x){const b=y=>{var w,N,_;const v=y.altKey||y.ctrlKey||y.metaKey;if(y.key===\"Tab\"&&!v){const E=document.activeElement,k=y.shiftKey;if(y.target===x&&k){(w=u.current)==null||w.focus();return}const A=p({tabbingDirection:k?\"backwards\":\"forwards\"}),D=A.findIndex(R=>R===E);_j(A.slice(D+1))?y.preventDefault():k?(N=u.current)==null||N.focus():(_=d.current)==null||_.focus()}};return x.addEventListener(\"keydown\",b),()=>x.removeEventListener(\"keydown\",b)}},[l,p]),s.jsxs(IJ,{ref:c,role:\"region\",\"aria-label\":a.replace(\"{hotkey}\",m),tabIndex:-1,style:{pointerEvents:g?void 0:\"none\"},children:[g&&s.jsx(n_,{ref:u,onFocusFromOutsideViewport:()=>{const x=p({tabbingDirection:\"forwards\"});_j(x)}}),s.jsx(AC.Slot,{scope:r,children:s.jsx(st.ol,{tabIndex:-1,...i,ref:h})}),g&&s.jsx(n_,{ref:d,onFocusFromOutsideViewport:()=>{const x=p({tabbingDirection:\"backwards\"});_j(x)}})]})});$L.displayName=LL;var BL=\"ToastFocusProxy\",n_=j.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,i=ow(BL,r);return s.jsx(yx,{\"aria-hidden\":!0,tabIndex:0,...a,ref:t,style:{position:\"fixed\"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&n()}})});n_.displayName=BL;var lw=\"Toast\",KJ=\"toast.swipeStart\",YJ=\"toast.swipeMove\",qJ=\"toast.swipeCancel\",XJ=\"toast.swipeEnd\",VL=j.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:i,...o}=e,[l=!0,c]=gi({prop:n,defaultProp:a,onChange:i});return s.jsx(Fa,{present:r||l,children:s.jsx(JJ,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:ma(e.onPause),onResume:ma(e.onResume),onSwipeStart:We(e.onSwipeStart,u=>{u.currentTarget.setAttribute(\"data-swipe\",\"start\")}),onSwipeMove:We(e.onSwipeMove,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute(\"data-swipe\",\"move\"),u.currentTarget.style.setProperty(\"--radix-toast-swipe-move-x\",`${d}px`),u.currentTarget.style.setProperty(\"--radix-toast-swipe-move-y\",`${f}px`)}),onSwipeCancel:We(e.onSwipeCancel,u=>{u.currentTarget.setAttribute(\"data-swipe\",\"cancel\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-move-x\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-move-y\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-end-x\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-end-y\")}),onSwipeEnd:We(e.onSwipeEnd,u=>{const{x:d,y:f}=u.detail.delta;u.currentTarget.setAttribute(\"data-swipe\",\"end\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-move-x\"),u.currentTarget.style.removeProperty(\"--radix-toast-swipe-move-y\"),u.currentTarget.style.setProperty(\"--radix-toast-swipe-end-x\",`${d}px`),u.currentTarget.style.setProperty(\"--radix-toast-swipe-end-y\",`${f}px`),c(!1)})})})});VL.displayName=lw;var[ZJ,QJ]=FL(lw,{onClose(){}}),JJ=j.forwardRef((e,t)=>{const{__scopeToast:r,type:n=\"foreground\",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:f,onSwipeCancel:h,onSwipeEnd:m,...g}=e,p=ow(lw,r),[x,b]=j.useState(null),y=Xt(t,R=>b(R)),v=j.useRef(null),S=j.useRef(null),w=a||p.duration,N=j.useRef(0),_=j.useRef(w),E=j.useRef(0),{onToastAdd:k,onToastRemove:O}=p,C=ma(()=>{var T;(x==null?void 0:x.contains(document.activeElement))&&((T=p.viewport)==null||T.focus()),o()}),A=j.useCallback(R=>{!R||R===1/0||(window.clearTimeout(E.current),N.current=new Date().getTime(),E.current=window.setTimeout(C,R))},[C]);j.useEffect(()=>{const R=p.viewport;if(R){const T=()=>{A(_.current),u==null||u()},L=()=>{const I=new Date().getTime()-N.current;_.current=_.current-I,window.clearTimeout(E.current),c==null||c()};return R.addEventListener(t_,L),R.addEventListener(r_,T),()=>{R.removeEventListener(t_,L),R.removeEventListener(r_,T)}}},[p.viewport,w,c,u,A]),j.useEffect(()=>{i&&!p.isClosePausedRef.current&&A(w)},[i,w,p.isClosePausedRef,A]),j.useEffect(()=>(k(),()=>O()),[k,O]);const D=j.useMemo(()=>x?YL(x):null,[x]);return p.viewport?s.jsxs(s.Fragment,{children:[D&&s.jsx(eee,{__scopeToast:r,role:\"status\",\"aria-live\":n===\"foreground\"?\"assertive\":\"polite\",\"aria-atomic\":!0,children:D}),s.jsx(ZJ,{scope:r,onClose:C,children:Xd.createPortal(s.jsx(AC.ItemSlot,{scope:r,children:s.jsx(DJ,{asChild:!0,onEscapeKeyDown:We(l,()=>{p.isFocusedToastEscapeKeyDownRef.current||C(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(st.li,{role:\"status\",\"aria-live\":\"off\",\"aria-atomic\":!0,tabIndex:0,\"data-state\":i?\"open\":\"closed\",\"data-swipe-direction\":p.swipeDirection,...g,ref:y,style:{userSelect:\"none\",touchAction:\"none\",...e.style},onKeyDown:We(e.onKeyDown,R=>{R.key===\"Escape\"&&(l==null||l(R.nativeEvent),R.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:We(e.onPointerDown,R=>{R.button===0&&(v.current={x:R.clientX,y:R.clientY})}),onPointerMove:We(e.onPointerMove,R=>{if(!v.current)return;const T=R.clientX-v.current.x,L=R.clientY-v.current.y,I=!!S.current,M=[\"left\",\"right\"].includes(p.swipeDirection),F=[\"left\",\"up\"].includes(p.swipeDirection)?Math.min:Math.max,G=M?F(0,T):0,ae=M?0:F(0,L),P=R.pointerType===\"touch\"?10:2,z={x:G,y:ae},B={originalEvent:R,delta:z};I?(S.current=z,Nv(YJ,f,B,{discrete:!1})):xP(z,p.swipeDirection,P)?(S.current=z,Nv(KJ,d,B,{discrete:!1}),R.target.setPointerCapture(R.pointerId)):(Math.abs(T)>P||Math.abs(L)>P)&&(v.current=null)}),onPointerUp:We(e.onPointerUp,R=>{const T=S.current,L=R.target;if(L.hasPointerCapture(R.pointerId)&&L.releasePointerCapture(R.pointerId),S.current=null,v.current=null,T){const I=R.currentTarget,M={originalEvent:R,delta:T};xP(T,p.swipeDirection,p.swipeThreshold)?Nv(XJ,m,M,{discrete:!0}):Nv(qJ,h,M,{discrete:!0}),I.addEventListener(\"click\",F=>F.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),eee=e=>{const{__scopeToast:t,children:r,...n}=e,a=ow(lw,t),[i,o]=j.useState(!1),[l,c]=j.useState(!1);return nee(()=>o(!0)),j.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:s.jsx(L0,{asChild:!0,children:s.jsx(yx,{...n,children:i&&s.jsxs(s.Fragment,{children:[a.label,\" \",r]})})})},tee=\"ToastTitle\",zL=j.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return s.jsx(st.div,{...n,ref:t})});zL.displayName=tee;var ree=\"ToastDescription\",UL=j.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return s.jsx(st.div,{...n,ref:t})});UL.displayName=ree;var WL=\"ToastAction\",HL=j.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?s.jsx(KL,{altText:r,asChild:!0,children:s.jsx(TC,{...n,ref:t})}):(console.error(`Invalid prop \\`altText\\` supplied to \\`${WL}\\`. Expected non-empty \\`string\\`.`),null)});HL.displayName=WL;var GL=\"ToastClose\",TC=j.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=QJ(GL,r);return s.jsx(KL,{asChild:!0,children:s.jsx(st.button,{type:\"button\",...n,ref:t,onClick:We(e.onClick,a.onClose)})})});TC.displayName=GL;var KL=j.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return s.jsx(st.div,{\"data-radix-toast-announce-exclude\":\"\",\"data-radix-toast-announce-alt\":n||void 0,...a,ref:t})});function YL(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),aee(n)){const a=n.ariaHidden||n.hidden||n.style.display===\"none\",i=n.dataset.radixToastAnnounceExclude===\"\";if(!a)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...YL(n))}}),t}function Nv(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?kC(a,i):a.dispatchEvent(i)}var xP=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),i=n>a;return t===\"left\"||t===\"right\"?i&&n>r:!i&&a>r};function nee(e=()=>{}){const t=ma(e);On(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function aee(e){return e.nodeType===e.ELEMENT_NODE}function see(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName===\"INPUT\"&&n.type===\"hidden\";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function _j(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var iee=RL,qL=$L,XL=VL,ZL=zL,QL=UL,JL=HL,e9=TC;function t9(e){var t,r,n=\"\";if(typeof e==\"string\"||typeof e==\"number\")n+=e;else if(typeof e==\"object\")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=t9(e[t]))&&(n&&(n+=\" \"),n+=r)}else for(r in e)e[r]&&(n&&(n+=\" \"),n+=r);return n}function Bt(){for(var e,t,r=0,n=\"\",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=t9(e))&&(n&&(n+=\" \"),n+=t);return n}const vP=e=>typeof e==\"boolean\"?`${e}`:e===0?\"0\":e,yP=Bt,$0=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return yP(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(u=>{const d=r==null?void 0:r[u],f=i==null?void 0:i[u];if(d===null)return null;const h=vP(d)||vP(f);return a[u][h]}),l=r&&Object.entries(r).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...m}=d;return Object.entries(m).every(g=>{let[p,x]=g;return Array.isArray(x)?x.includes({...i,...l}[p]):{...i,...l}[p]===x})?[...u,f,h]:u},[]);return yP(e,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const oee=e=>e.replace(/([a-z0-9])([A-Z])/g,\"$1-$2\").toLowerCase(),r9=(...e)=>e.filter((t,r,n)=>!!t&&n.indexOf(t)===r).join(\" \");/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */var lee={xmlns:\"http://www.w3.org/2000/svg\",width:24,height:24,viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:2,strokeLinecap:\"round\",strokeLinejoin:\"round\"};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cee=j.forwardRef(({color:e=\"currentColor\",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a=\"\",children:i,iconNode:o,...l},c)=>j.createElement(\"svg\",{ref:c,...lee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:r9(\"lucide\",a),...l},[...o.map(([u,d])=>j.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const et=(e,t)=>{const r=j.forwardRef(({className:n,...a},i)=>j.createElement(cee,{ref:i,iconNode:t,className:r9(`lucide-${oee(e)}`,n),...a}));return r.displayName=`${e}`,r};/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uee=et(\"ArrowDownLeft\",[[\"path\",{d:\"M17 7 7 17\",key:\"15tmo1\"}],[\"path\",{d:\"M17 17H7V7\",key:\"1org7z\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const dee=et(\"ArrowUpDown\",[[\"path\",{d:\"m21 16-4 4-4-4\",key:\"f6ql7i\"}],[\"path\",{d:\"M17 20V4\",key:\"1ejh1v\"}],[\"path\",{d:\"m3 8 4-4 4 4\",key:\"11wl7u\"}],[\"path\",{d:\"M7 4v16\",key:\"1glfcx\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const fee=et(\"ArrowUpRight\",[[\"path\",{d:\"M7 7h10v10\",key:\"1tivn9\"}],[\"path\",{d:\"M7 17 17 7\",key:\"1vkiza\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const hee=et(\"BookOpen\",[[\"path\",{d:\"M12 7v14\",key:\"1akyts\"}],[\"path\",{d:\"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z\",key:\"ruj8y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Jy=et(\"Building2\",[[\"path\",{d:\"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z\",key:\"1b4qmf\"}],[\"path\",{d:\"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2\",key:\"i71pzd\"}],[\"path\",{d:\"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2\",key:\"10jefs\"}],[\"path\",{d:\"M10 6h4\",key:\"1itunk\"}],[\"path\",{d:\"M10 10h4\",key:\"tcdvrf\"}],[\"path\",{d:\"M10 14h4\",key:\"kelpxr\"}],[\"path\",{d:\"M10 18h4\",key:\"1ulq68\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const pa=et(\"Calendar\",[[\"path\",{d:\"M8 2v4\",key:\"1cmpym\"}],[\"path\",{d:\"M16 2v4\",key:\"4m81vk\"}],[\"rect\",{width:\"18\",height:\"18\",x:\"3\",y:\"4\",rx:\"2\",key:\"1hopcy\"}],[\"path\",{d:\"M3 10h18\",key:\"8toen8\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const yy=et(\"ChartColumn\",[[\"path\",{d:\"M3 3v16a2 2 0 0 0 2 2h16\",key:\"c24i48\"}],[\"path\",{d:\"M18 17V9\",key:\"2bz60n\"}],[\"path\",{d:\"M13 17V5\",key:\"1frdt8\"}],[\"path\",{d:\"M8 17v-3\",key:\"17ska0\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ej=et(\"ChartPie\",[[\"path\",{d:\"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z\",key:\"pzmjnu\"}],[\"path\",{d:\"M21.21 15.89A10 10 0 1 1 8 2.83\",key:\"k2fpak\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ga=et(\"Check\",[[\"path\",{d:\"M20 6 9 17l-5-5\",key:\"1gmf2c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Qd=et(\"ChevronDown\",[[\"path\",{d:\"m6 9 6 6 6-6\",key:\"qrunsl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const B0=et(\"ChevronLeft\",[[\"path\",{d:\"m15 18-6-6 6-6\",key:\"1wnfg3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cu=et(\"ChevronRight\",[[\"path\",{d:\"m9 18 6-6-6-6\",key:\"mthhwq\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Hh=et(\"ChevronUp\",[[\"path\",{d:\"m18 15-6-6-6 6\",key:\"153udz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const mee=et(\"ChevronsLeft\",[[\"path\",{d:\"m11 17-5-5 5-5\",key:\"13zhaf\"}],[\"path\",{d:\"m18 17-5-5 5-5\",key:\"h8a8et\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const pee=et(\"ChevronsRight\",[[\"path\",{d:\"m6 17 5-5-5-5\",key:\"xnjwq\"}],[\"path\",{d:\"m13 17 5-5-5-5\",key:\"17xmmf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const n9=et(\"CircleAlert\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"8\",y2:\"12\",key:\"1pkeuh\"}],[\"line\",{x1:\"12\",x2:\"12.01\",y1:\"16\",y2:\"16\",key:\"4dfq90\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Jd=et(\"CircleCheckBig\",[[\"path\",{d:\"M21.801 10A10 10 0 1 1 17 3.335\",key:\"yps3ct\"}],[\"path\",{d:\"m9 11 3 3L22 4\",key:\"1pflzl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const OC=et(\"CircleUser\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"circle\",{cx:\"12\",cy:\"10\",r:\"3\",key:\"ilqhr7\"}],[\"path\",{d:\"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662\",key:\"154egf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ch=et(\"CircleX\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"m15 9-6 6\",key:\"1uzhvr\"}],[\"path\",{d:\"m9 9 6 6\",key:\"z0biqf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const a9=et(\"Circle\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cw=et(\"Clock\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"polyline\",{points:\"12 6 12 12 16 14\",key:\"68esgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const gee=et(\"Command\",[[\"path\",{d:\"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3\",key:\"11bfej\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const xee=et(\"Copy\",[[\"rect\",{width:\"14\",height:\"14\",x:\"8\",y:\"8\",rx:\"2\",ry:\"2\",key:\"17jyea\"}],[\"path\",{d:\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\",key:\"zix9uf\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const es=et(\"CreditCard\",[[\"rect\",{width:\"20\",height:\"14\",x:\"2\",y:\"5\",rx:\"2\",key:\"ynyp8z\"}],[\"line\",{x1:\"2\",x2:\"22\",y1:\"10\",y2:\"10\",key:\"1b3vmo\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bx=et(\"Crown\",[[\"path\",{d:\"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z\",key:\"1vdc57\"}],[\"path\",{d:\"M5 21h14\",key:\"11awu3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const PC=et(\"Download\",[[\"path\",{d:\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",key:\"ih7n3h\"}],[\"polyline\",{points:\"7 10 12 15 17 10\",key:\"2ggqvy\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"15\",y2:\"3\",key:\"1vk2je\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const a_=et(\"EllipsisVertical\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"1\",key:\"41hilf\"}],[\"circle\",{cx:\"12\",cy:\"5\",r:\"1\",key:\"gxeob9\"}],[\"circle\",{cx:\"12\",cy:\"19\",r:\"1\",key:\"lyex9k\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const MC=et(\"Ellipsis\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"1\",key:\"41hilf\"}],[\"circle\",{cx:\"19\",cy:\"12\",r:\"1\",key:\"1wjl8i\"}],[\"circle\",{cx:\"5\",cy:\"12\",r:\"1\",key:\"1pcz8c\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const e1=et(\"Euro\",[[\"path\",{d:\"M4 10h12\",key:\"1y6xl8\"}],[\"path\",{d:\"M4 14h9\",key:\"1loblj\"}],[\"path\",{d:\"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2\",key:\"1j6lzo\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const DC=et(\"ExternalLink\",[[\"path\",{d:\"M15 3h6v6\",key:\"1q9fwt\"}],[\"path\",{d:\"M10 14 21 3\",key:\"gplh6r\"}],[\"path\",{d:\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\",key:\"a6xqqp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const IC=et(\"EyeOff\",[[\"path\",{d:\"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",key:\"ct8e1f\"}],[\"path\",{d:\"M14.084 14.158a3 3 0 0 1-4.242-4.242\",key:\"151rxh\"}],[\"path\",{d:\"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",key:\"13bj9a\"}],[\"path\",{d:\"m2 2 20 20\",key:\"1ooewy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Fl=et(\"Eye\",[[\"path\",{d:\"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0\",key:\"1nclc0\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"3\",key:\"1v7zrd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const vee=et(\"FileImage\",[[\"path\",{d:\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\",key:\"1rqfz7\"}],[\"path\",{d:\"M14 2v4a2 2 0 0 0 2 2h4\",key:\"tnqrlb\"}],[\"circle\",{cx:\"10\",cy:\"12\",r:\"2\",key:\"737tya\"}],[\"path\",{d:\"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22\",key:\"wt3hpn\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const FC=et(\"FileSpreadsheet\",[[\"path\",{d:\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\",key:\"1rqfz7\"}],[\"path\",{d:\"M14 2v4a2 2 0 0 0 2 2h4\",key:\"tnqrlb\"}],[\"path\",{d:\"M8 13h2\",key:\"yr2amv\"}],[\"path\",{d:\"M14 13h2\",key:\"un5t4a\"}],[\"path\",{d:\"M8 17h2\",key:\"2yhykz\"}],[\"path\",{d:\"M14 17h2\",key:\"10kma7\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ef=et(\"FileText\",[[\"path\",{d:\"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\",key:\"1rqfz7\"}],[\"path\",{d:\"M14 2v4a2 2 0 0 0 2 2h4\",key:\"tnqrlb\"}],[\"path\",{d:\"M10 9H8\",key:\"b1mrlr\"}],[\"path\",{d:\"M16 13H8\",key:\"t4e002\"}],[\"path\",{d:\"M16 17H8\",key:\"z1uh3a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const s9=et(\"GripVertical\",[[\"circle\",{cx:\"9\",cy:\"12\",r:\"1\",key:\"1vctgf\"}],[\"circle\",{cx:\"9\",cy:\"5\",r:\"1\",key:\"hp0tcf\"}],[\"circle\",{cx:\"9\",cy:\"19\",r:\"1\",key:\"fkjjf6\"}],[\"circle\",{cx:\"15\",cy:\"12\",r:\"1\",key:\"1tmaij\"}],[\"circle\",{cx:\"15\",cy:\"5\",r:\"1\",key:\"19l28e\"}],[\"circle\",{cx:\"15\",cy:\"19\",r:\"1\",key:\"f4zoj3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bP=et(\"House\",[[\"path\",{d:\"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8\",key:\"5wwlr5\"}],[\"path\",{d:\"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\",key:\"1d0kgt\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const i9=et(\"IdCard\",[[\"path\",{d:\"M16 10h2\",key:\"8sgtl7\"}],[\"path\",{d:\"M16 14h2\",key:\"epxaof\"}],[\"path\",{d:\"M6.17 15a3 3 0 0 1 5.66 0\",key:\"n6f512\"}],[\"circle\",{cx:\"9\",cy:\"11\",r:\"2\",key:\"yxgjnd\"}],[\"rect\",{x:\"2\",y:\"5\",width:\"20\",height:\"14\",rx:\"2\",key:\"qneu4z\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const wP=et(\"Info\",[[\"circle\",{cx:\"12\",cy:\"12\",r:\"10\",key:\"1mglay\"}],[\"path\",{d:\"M12 16v-4\",key:\"1dtifu\"}],[\"path\",{d:\"M12 8h.01\",key:\"e9boi3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const yee=et(\"KeyRound\",[[\"path\",{d:\"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z\",key:\"1s6t7t\"}],[\"circle\",{cx:\"16.5\",cy:\"7.5\",r:\".5\",fill:\"currentColor\",key:\"w0ekpg\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const o9=et(\"LayoutDashboard\",[[\"rect\",{width:\"7\",height:\"9\",x:\"3\",y:\"3\",rx:\"1\",key:\"10lvy0\"}],[\"rect\",{width:\"7\",height:\"5\",x:\"14\",y:\"3\",rx:\"1\",key:\"16une8\"}],[\"rect\",{width:\"7\",height:\"9\",x:\"14\",y:\"12\",rx:\"1\",key:\"1hutg5\"}],[\"rect\",{width:\"7\",height:\"5\",x:\"3\",y:\"16\",rx:\"1\",key:\"ldoo1y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const bee=et(\"Link\",[[\"path\",{d:\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\",key:\"1cjeqo\"}],[\"path\",{d:\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\",key:\"19qd67\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jP=et(\"Lock\",[[\"rect\",{width:\"18\",height:\"11\",x:\"3\",y:\"11\",rx:\"2\",ry:\"2\",key:\"1w4ew1\"}],[\"path\",{d:\"M7 11V7a5 5 0 0 1 10 0v4\",key:\"fwvmzm\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const cs=et(\"Mail\",[[\"rect\",{width:\"20\",height:\"16\",x:\"2\",y:\"4\",rx:\"2\",key:\"18n3k1\"}],[\"path\",{d:\"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7\",key:\"1ocrg3\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const wee=et(\"Maximize\",[[\"path\",{d:\"M8 3H5a2 2 0 0 0-2 2v3\",key:\"1dcmit\"}],[\"path\",{d:\"M21 8V5a2 2 0 0 0-2-2h-3\",key:\"1e4gt3\"}],[\"path\",{d:\"M3 16v3a2 2 0 0 0 2 2h3\",key:\"wsl5sc\"}],[\"path\",{d:\"M16 21h3a2 2 0 0 0 2-2v-3\",key:\"18trek\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const jee=et(\"Menu\",[[\"line\",{x1:\"4\",x2:\"20\",y1:\"12\",y2:\"12\",key:\"1e0a9i\"}],[\"line\",{x1:\"4\",x2:\"20\",y1:\"6\",y2:\"6\",key:\"1owob3\"}],[\"line\",{x1:\"4\",x2:\"20\",y1:\"18\",y2:\"18\",key:\"yk5zj1\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Nee=et(\"MessageSquare\",[[\"path\",{d:\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\",key:\"1lielz\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const See=et(\"Minimize\",[[\"path\",{d:\"M8 3v3a2 2 0 0 1-2 2H3\",key:\"hohbtr\"}],[\"path\",{d:\"M21 8h-3a2 2 0 0 1-2-2V3\",key:\"5jw1f3\"}],[\"path\",{d:\"M3 16h3a2 2 0 0 1 2 2v3\",key:\"198tvr\"}],[\"path\",{d:\"M16 21v-3a2 2 0 0 1 2-2h3\",key:\"ph8mxp\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const uw=et(\"Monitor\",[[\"rect\",{width:\"20\",height:\"14\",x:\"2\",y:\"3\",rx:\"2\",key:\"48i651\"}],[\"line\",{x1:\"8\",x2:\"16\",y1:\"21\",y2:\"21\",key:\"1svkeh\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"17\",y2:\"21\",key:\"vw1qmm\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _ee=et(\"Pause\",[[\"rect\",{x:\"14\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"zuxfzm\"}],[\"rect\",{x:\"6\",y:\"4\",width:\"4\",height:\"16\",rx:\"1\",key:\"1okwgv\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const l9=et(\"Pen\",[[\"path\",{d:\"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",key:\"1a8usu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const NP=et(\"Phone\",[[\"path\",{d:\"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z\",key:\"foiqr5\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const c9=et(\"Play\",[[\"polygon\",{points:\"6 3 20 12 6 21 6 3\",key:\"1oa8hb\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const An=et(\"Plus\",[[\"path\",{d:\"M5 12h14\",key:\"1ays0h\"}],[\"path\",{d:\"M12 5v14\",key:\"s699le\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Eee=et(\"Power\",[[\"path\",{d:\"M12 2v10\",key:\"mnfbl\"}],[\"path\",{d:\"M18.4 6.6a9 9 0 1 1-12.77.04\",key:\"obofu9\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const kee=et(\"QrCode\",[[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"3\",rx:\"1\",key:\"1tu5fj\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"16\",y:\"3\",rx:\"1\",key:\"1v8r4q\"}],[\"rect\",{width:\"5\",height:\"5\",x:\"3\",y:\"16\",rx:\"1\",key:\"1x03jg\"}],[\"path\",{d:\"M21 16h-3a2 2 0 0 0-2 2v3\",key:\"177gqh\"}],[\"path\",{d:\"M21 21v.01\",key:\"ents32\"}],[\"path\",{d:\"M12 7v3a2 2 0 0 1-2 2H7\",key:\"8crl2c\"}],[\"path\",{d:\"M3 12h.01\",key:\"nlz23k\"}],[\"path\",{d:\"M12 3h.01\",key:\"n36tog\"}],[\"path\",{d:\"M12 16v.01\",key:\"133mhm\"}],[\"path\",{d:\"M16 12h1\",key:\"1slzba\"}],[\"path\",{d:\"M21 12v.01\",key:\"1lwtk9\"}],[\"path\",{d:\"M12 21v-1\",key:\"1880an\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ro=et(\"RefreshCw\",[[\"path\",{d:\"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\",key:\"v9h5vc\"}],[\"path\",{d:\"M21 3v5h-5\",key:\"1q7to0\"}],[\"path\",{d:\"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\",key:\"3uifl3\"}],[\"path\",{d:\"M8 16H3v5\",key:\"1cv678\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const SP=et(\"RotateCcw\",[[\"path\",{d:\"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8\",key:\"1357e3\"}],[\"path\",{d:\"M3 3v5h5\",key:\"1xhq8a\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const t1=et(\"Save\",[[\"path\",{d:\"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z\",key:\"1c8476\"}],[\"path\",{d:\"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7\",key:\"1ydtos\"}],[\"path\",{d:\"M7 3v4a1 1 0 0 0 1 1h7\",key:\"t51u73\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Cee=et(\"Scale\",[[\"path\",{d:\"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"7g6ntu\"}],[\"path\",{d:\"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z\",key:\"ijws7r\"}],[\"path\",{d:\"M7 21h10\",key:\"1b0cd5\"}],[\"path\",{d:\"M12 3v18\",key:\"108xh3\"}],[\"path\",{d:\"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2\",key:\"3gwbw2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Aee=et(\"Scan\",[[\"path\",{d:\"M3 7V5a2 2 0 0 1 2-2h2\",key:\"aa7l1z\"}],[\"path\",{d:\"M17 3h2a2 2 0 0 1 2 2v2\",key:\"4qcy5o\"}],[\"path\",{d:\"M21 17v2a2 2 0 0 1-2 2h-2\",key:\"6vwrx8\"}],[\"path\",{d:\"M7 21H5a2 2 0 0 1-2-2v-2\",key:\"ioqczr\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const tf=et(\"Search\",[[\"circle\",{cx:\"11\",cy:\"11\",r:\"8\",key:\"4ej97u\"}],[\"path\",{d:\"m21 21-4.3-4.3\",key:\"1qie3q\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const _P=et(\"Send\",[[\"path\",{d:\"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",key:\"1ffxy3\"}],[\"path\",{d:\"m21.854 2.147-10.94 10.939\",key:\"12cjpa\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const RC=et(\"Settings\",[[\"path\",{d:\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\",key:\"1qme2f\"}],[\"circle\",{cx:\"12\",cy:\"12\",r:\"3\",key:\"1v7zrd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Tee=et(\"Shield\",[[\"path\",{d:\"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",key:\"oel41y\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Oee=et(\"Shuffle\",[[\"path\",{d:\"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22\",key:\"1wmou1\"}],[\"path\",{d:\"m18 2 4 4-4 4\",key:\"pucp1d\"}],[\"path\",{d:\"M2 6h1.9c1.5 0 2.9.9 3.6 2.2\",key:\"10bdb2\"}],[\"path\",{d:\"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8\",key:\"vgxac0\"}],[\"path\",{d:\"m18 14 4 4-4 4\",key:\"10pe0f\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Pee=et(\"Smartphone\",[[\"rect\",{width:\"14\",height:\"20\",x:\"5\",y:\"2\",rx:\"2\",ry:\"2\",key:\"1yt0o3\"}],[\"path\",{d:\"M12 18h.01\",key:\"mhygvu\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const EP=et(\"SquareCheckBig\",[[\"path\",{d:\"M21 10.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.5\",key:\"1uzm8b\"}],[\"path\",{d:\"m9 11 3 3L22 4\",key:\"1pflzl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const so=et(\"SquarePen\",[[\"path\",{d:\"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\",key:\"1m0v6g\"}],[\"path\",{d:\"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z\",key:\"ohrbg2\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Mee=et(\"Tag\",[[\"path\",{d:\"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z\",key:\"vktsd0\"}],[\"circle\",{cx:\"7.5\",cy:\"7.5\",r:\".5\",fill:\"currentColor\",key:\"kqv944\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const io=et(\"Trash2\",[[\"path\",{d:\"M3 6h18\",key:\"d0wm0j\"}],[\"path\",{d:\"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6\",key:\"4alrt4\"}],[\"path\",{d:\"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2\",key:\"v07s0e\"}],[\"line\",{x1:\"10\",x2:\"10\",y1:\"11\",y2:\"17\",key:\"1uufr5\"}],[\"line\",{x1:\"14\",x2:\"14\",y1:\"11\",y2:\"17\",key:\"xtxkd\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const ta=et(\"TriangleAlert\",[[\"path\",{d:\"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",key:\"wmoenq\"}],[\"path\",{d:\"M12 9v4\",key:\"juzpu7\"}],[\"path\",{d:\"M12 17h.01\",key:\"p32p05\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const u9=et(\"Upload\",[[\"path\",{d:\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",key:\"ih7n3h\"}],[\"polyline\",{points:\"17 8 12 3 7 8\",key:\"t8dd8p\"}],[\"line\",{x1:\"12\",x2:\"12\",y1:\"3\",y2:\"15\",key:\"widbto\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const d9=et(\"UserCheck\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"polyline\",{points:\"16 11 18 13 22 9\",key:\"1pwet4\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Dee=et(\"UserPlus\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"line\",{x1:\"19\",x2:\"19\",y1:\"8\",y2:\"14\",key:\"1bvyxn\"}],[\"line\",{x1:\"22\",x2:\"16\",y1:\"11\",y2:\"11\",key:\"1shjgl\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const s_=et(\"UserX\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"line\",{x1:\"17\",x2:\"22\",y1:\"8\",y2:\"13\",key:\"3nzzx3\"}],[\"line\",{x1:\"22\",x2:\"17\",y1:\"8\",y2:\"13\",key:\"1swrse\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ta=et(\"User\",[[\"path\",{d:\"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\",key:\"975kel\"}],[\"circle\",{cx:\"12\",cy:\"7\",r:\"4\",key:\"17ys0d\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Ji=et(\"Users\",[[\"path\",{d:\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\",key:\"1yyitq\"}],[\"circle\",{cx:\"9\",cy:\"7\",r:\"4\",key:\"nufk8\"}],[\"path\",{d:\"M22 21v-2a4 4 0 0 0-3-3.87\",key:\"kshegd\"}],[\"path\",{d:\"M16 3.13a4 4 0 0 1 0 7.75\",key:\"1da9ce\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const f9=et(\"Vote\",[[\"path\",{d:\"m9 12 2 2 4-4\",key:\"dzmm74\"}],[\"path\",{d:\"M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z\",key:\"1ezoue\"}],[\"path\",{d:\"M22 19H2\",key:\"nuriw5\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const h9=et(\"WifiOff\",[[\"path\",{d:\"M12 20h.01\",key:\"zekei9\"}],[\"path\",{d:\"M8.5 16.429a5 5 0 0 1 7 0\",key:\"1bycff\"}],[\"path\",{d:\"M5 12.859a10 10 0 0 1 5.17-2.69\",key:\"1dl1wf\"}],[\"path\",{d:\"M19 12.859a10 10 0 0 0-2.007-1.523\",key:\"4k23kn\"}],[\"path\",{d:\"M2 8.82a15 15 0 0 1 4.177-2.643\",key:\"1grhjp\"}],[\"path\",{d:\"M22 8.82a15 15 0 0 0-11.288-3.764\",key:\"z3jwby\"}],[\"path\",{d:\"m2 2 20 20\",key:\"1ooewy\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const m9=et(\"Wifi\",[[\"path\",{d:\"M12 20h.01\",key:\"zekei9\"}],[\"path\",{d:\"M2 8.82a15 15 0 0 1 20 0\",key:\"dnpr2z\"}],[\"path\",{d:\"M5 12.859a10 10 0 0 1 14 0\",key:\"1x1e6c\"}],[\"path\",{d:\"M8.5 16.429a5 5 0 0 1 7 0\",key:\"1bycff\"}]]);/**\n * @license lucide-react v0.453.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */const Wo=et(\"X\",[[\"path\",{d:\"M18 6 6 18\",key:\"1bl5f8\"}],[\"path\",{d:\"m6 6 12 12\",key:\"d8bk6v\"}]]),LC=\"-\",Iee=e=>{const t=Ree(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:o=>{const l=o.split(LC);return l[0]===\"\"&&l.length!==1&&l.shift(),p9(l,t)||Fee(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},p9=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?p9(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(LC);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},kP=/^\\[(.+)\\]$/,Fee=e=>{if(kP.test(e)){const t=kP.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(\":\"));if(r)return\"arbitrary..\"+r}},Ree=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return $ee(Object.entries(e.classGroups),r).forEach(([i,o])=>{i_(o,n,i,t)}),n},i_=(e,t,r,n)=>{e.forEach(a=>{if(typeof a==\"string\"){const i=a===\"\"?t:CP(t,a);i.classGroupId=r;return}if(typeof a==\"function\"){if(Lee(a)){i_(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{i_(o,CP(t,i),r,n)})})},CP=(e,t)=>{let r=e;return t.split(LC).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Lee=e=>e.isThemeGetter,$ee=(e,t)=>t?e.map(([r,n])=>{const a=n.map(i=>typeof i==\"string\"?t+i:typeof i==\"object\"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):e,Bee=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},g9=\"!\",Vee=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],i=t.length,o=l=>{const c=[];let u=0,d=0,f;for(let x=0;x<l.length;x++){let b=l[x];if(u===0){if(b===a&&(n||l.slice(x,x+i)===t)){c.push(l.slice(d,x)),d=x+i;continue}if(b===\"/\"){f=x;continue}}b===\"[\"?u++:b===\"]\"&&u--}const h=c.length===0?l:l.substring(d),m=h.startsWith(g9),g=m?h.substring(1):h,p=f&&f>d?f-d:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:p}};return r?l=>r({className:l,parseClassName:o}):o},zee=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]===\"[\"?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Uee=e=>({cache:Bee(e.cacheSize),parseClassName:Vee(e),...Iee(e)}),Wee=/\\s+/,Hee=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(Wee);let l=\"\";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:d,hasImportantModifier:f,baseClassName:h,maybePostfixModifierPosition:m}=r(u);let g=!!m,p=n(g?h.substring(0,m):h);if(!p){if(!g){l=u+(l.length>0?\" \"+l:l);continue}if(p=n(h),!p){l=u+(l.length>0?\" \"+l:l);continue}g=!1}const x=zee(d).join(\":\"),b=f?x+g9:x,y=b+p;if(i.includes(y))continue;i.push(y);const v=a(p,g);for(let S=0;S<v.length;++S){const w=v[S];i.push(b+w)}l=u+(l.length>0?\" \"+l:l)}return l};function Gee(){let e=0,t,r,n=\"\";for(;e<arguments.length;)(t=arguments[e++])&&(r=x9(t))&&(n&&(n+=\" \"),n+=r);return n}const x9=e=>{if(typeof e==\"string\")return e;let t,r=\"\";for(let n=0;n<e.length;n++)e[n]&&(t=x9(e[n]))&&(r&&(r+=\" \"),r+=t);return r};function Kee(e,...t){let r,n,a,i=o;function o(c){const u=t.reduce((d,f)=>f(d),e());return r=Uee(u),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const u=n(c);if(u)return u;const d=Hee(c,r);return a(c,d),d}return function(){return i(Gee.apply(null,arguments))}}const Wr=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},v9=/^\\[(?:([a-z-]+):)?(.+)\\]$/i,Yee=/^\\d+\\/\\d+$/,qee=new Set([\"px\",\"full\",\"screen\"]),Xee=/^(\\d+(\\.\\d+)?)?(xs|sm|md|lg|xl)$/,Zee=/\\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\\b(calc|min|max|clamp)\\(.+\\)|^0$/,Qee=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\\(.+\\)$/,Jee=/^(inset_)?-?((\\d+)?\\.?(\\d+)[a-z]+|0)_-?((\\d+)?\\.?(\\d+)[a-z]+|0)/,ete=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\\(.+\\)$/,nl=e=>uh(e)||qee.has(e)||Yee.test(e),tc=e=>V0(e,\"length\",lte),uh=e=>!!e&&!Number.isNaN(Number(e)),kj=e=>V0(e,\"number\",uh),_m=e=>!!e&&Number.isInteger(Number(e)),tte=e=>e.endsWith(\"%\")&&uh(e.slice(0,-1)),Gt=e=>v9.test(e),rc=e=>Xee.test(e),rte=new Set([\"length\",\"size\",\"percentage\"]),nte=e=>V0(e,rte,y9),ate=e=>V0(e,\"position\",y9),ste=new Set([\"image\",\"url\"]),ite=e=>V0(e,ste,ute),ote=e=>V0(e,\"\",cte),Em=()=>!0,V0=(e,t,r)=>{const n=v9.exec(e);return n?n[1]?typeof t==\"string\"?n[1]===t:t.has(n[1]):r(n[2]):!1},lte=e=>Zee.test(e)&&!Qee.test(e),y9=()=>!1,cte=e=>Jee.test(e),ute=e=>ete.test(e),dte=()=>{const e=Wr(\"colors\"),t=Wr(\"spacing\"),r=Wr(\"blur\"),n=Wr(\"brightness\"),a=Wr(\"borderColor\"),i=Wr(\"borderRadius\"),o=Wr(\"borderSpacing\"),l=Wr(\"borderWidth\"),c=Wr(\"contrast\"),u=Wr(\"grayscale\"),d=Wr(\"hueRotate\"),f=Wr(\"invert\"),h=Wr(\"gap\"),m=Wr(\"gradientColorStops\"),g=Wr(\"gradientColorStopPositions\"),p=Wr(\"inset\"),x=Wr(\"margin\"),b=Wr(\"opacity\"),y=Wr(\"padding\"),v=Wr(\"saturate\"),S=Wr(\"scale\"),w=Wr(\"sepia\"),N=Wr(\"skew\"),_=Wr(\"space\"),E=Wr(\"translate\"),k=()=>[\"auto\",\"contain\",\"none\"],O=()=>[\"auto\",\"hidden\",\"clip\",\"visible\",\"scroll\"],C=()=>[\"auto\",Gt,t],A=()=>[Gt,t],D=()=>[\"\",nl,tc],R=()=>[\"auto\",uh,Gt],T=()=>[\"bottom\",\"center\",\"left\",\"left-bottom\",\"left-top\",\"right\",\"right-bottom\",\"right-top\",\"top\"],L=()=>[\"solid\",\"dashed\",\"dotted\",\"double\",\"none\"],I=()=>[\"normal\",\"multiply\",\"screen\",\"overlay\",\"darken\",\"lighten\",\"color-dodge\",\"color-burn\",\"hard-light\",\"soft-light\",\"difference\",\"exclusion\",\"hue\",\"saturation\",\"color\",\"luminosity\"],M=()=>[\"start\",\"end\",\"center\",\"between\",\"around\",\"evenly\",\"stretch\"],F=()=>[\"\",\"0\",Gt],G=()=>[\"auto\",\"avoid\",\"all\",\"avoid-page\",\"page\",\"left\",\"right\",\"column\"],ae=()=>[uh,Gt];return{cacheSize:500,separator:\":\",theme:{colors:[Em],spacing:[nl,tc],blur:[\"none\",\"\",rc,Gt],brightness:ae(),borderColor:[e],borderRadius:[\"none\",\"\",\"full\",rc,Gt],borderSpacing:A(),borderWidth:D(),contrast:ae(),grayscale:F(),hueRotate:ae(),invert:F(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[tte,tc],inset:C(),margin:C(),opacity:ae(),padding:A(),saturate:ae(),scale:ae(),sepia:F(),skew:ae(),space:A(),translate:A()},classGroups:{aspect:[{aspect:[\"auto\",\"square\",\"video\",Gt]}],container:[\"container\"],columns:[{columns:[rc]}],\"break-after\":[{\"break-after\":G()}],\"break-before\":[{\"break-before\":G()}],\"break-inside\":[{\"break-inside\":[\"auto\",\"avoid\",\"avoid-page\",\"avoid-column\"]}],\"box-decoration\":[{\"box-decoration\":[\"slice\",\"clone\"]}],box:[{box:[\"border\",\"content\"]}],display:[\"block\",\"inline-block\",\"inline\",\"flex\",\"inline-flex\",\"table\",\"inline-table\",\"table-caption\",\"table-cell\",\"table-column\",\"table-column-group\",\"table-footer-group\",\"table-header-group\",\"table-row-group\",\"table-row\",\"flow-root\",\"grid\",\"inline-grid\",\"contents\",\"list-item\",\"hidden\"],float:[{float:[\"right\",\"left\",\"none\",\"start\",\"end\"]}],clear:[{clear:[\"left\",\"right\",\"both\",\"none\",\"start\",\"end\"]}],isolation:[\"isolate\",\"isolation-auto\"],\"object-fit\":[{object:[\"contain\",\"cover\",\"fill\",\"none\",\"scale-down\"]}],\"object-position\":[{object:[...T(),Gt]}],overflow:[{overflow:O()}],\"overflow-x\":[{\"overflow-x\":O()}],\"overflow-y\":[{\"overflow-y\":O()}],overscroll:[{overscroll:k()}],\"overscroll-x\":[{\"overscroll-x\":k()}],\"overscroll-y\":[{\"overscroll-y\":k()}],position:[\"static\",\"fixed\",\"absolute\",\"relative\",\"sticky\"],inset:[{inset:[p]}],\"inset-x\":[{\"inset-x\":[p]}],\"inset-y\":[{\"inset-y\":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:[\"visible\",\"invisible\",\"collapse\"],z:[{z:[\"auto\",_m,Gt]}],basis:[{basis:C()}],\"flex-direction\":[{flex:[\"row\",\"row-reverse\",\"col\",\"col-reverse\"]}],\"flex-wrap\":[{flex:[\"wrap\",\"wrap-reverse\",\"nowrap\"]}],flex:[{flex:[\"1\",\"auto\",\"initial\",\"none\",Gt]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:[\"first\",\"last\",\"none\",_m,Gt]}],\"grid-cols\":[{\"grid-cols\":[Em]}],\"col-start-end\":[{col:[\"auto\",{span:[\"full\",_m,Gt]},Gt]}],\"col-start\":[{\"col-start\":R()}],\"col-end\":[{\"col-end\":R()}],\"grid-rows\":[{\"grid-rows\":[Em]}],\"row-start-end\":[{row:[\"auto\",{span:[_m,Gt]},Gt]}],\"row-start\":[{\"row-start\":R()}],\"row-end\":[{\"row-end\":R()}],\"grid-flow\":[{\"grid-flow\":[\"row\",\"col\",\"dense\",\"row-dense\",\"col-dense\"]}],\"auto-cols\":[{\"auto-cols\":[\"auto\",\"min\",\"max\",\"fr\",Gt]}],\"auto-rows\":[{\"auto-rows\":[\"auto\",\"min\",\"max\",\"fr\",Gt]}],gap:[{gap:[h]}],\"gap-x\":[{\"gap-x\":[h]}],\"gap-y\":[{\"gap-y\":[h]}],\"justify-content\":[{justify:[\"normal\",...M()]}],\"justify-items\":[{\"justify-items\":[\"start\",\"end\",\"center\",\"stretch\"]}],\"justify-self\":[{\"justify-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],\"align-content\":[{content:[\"normal\",...M(),\"baseline\"]}],\"align-items\":[{items:[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"align-self\":[{self:[\"auto\",\"start\",\"end\",\"center\",\"stretch\",\"baseline\"]}],\"place-content\":[{\"place-content\":[...M(),\"baseline\"]}],\"place-items\":[{\"place-items\":[\"start\",\"end\",\"center\",\"baseline\",\"stretch\"]}],\"place-self\":[{\"place-self\":[\"auto\",\"start\",\"end\",\"center\",\"stretch\"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],\"space-x\":[{\"space-x\":[_]}],\"space-x-reverse\":[\"space-x-reverse\"],\"space-y\":[{\"space-y\":[_]}],\"space-y-reverse\":[\"space-y-reverse\"],w:[{w:[\"auto\",\"min\",\"max\",\"fit\",\"svw\",\"lvw\",\"dvw\",Gt,t]}],\"min-w\":[{\"min-w\":[Gt,t,\"min\",\"max\",\"fit\"]}],\"max-w\":[{\"max-w\":[Gt,t,\"none\",\"full\",\"min\",\"max\",\"fit\",\"prose\",{screen:[rc]},rc]}],h:[{h:[Gt,t,\"auto\",\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"min-h\":[{\"min-h\":[Gt,t,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],\"max-h\":[{\"max-h\":[Gt,t,\"min\",\"max\",\"fit\",\"svh\",\"lvh\",\"dvh\"]}],size:[{size:[Gt,t,\"auto\",\"min\",\"max\",\"fit\"]}],\"font-size\":[{text:[\"base\",rc,tc]}],\"font-smoothing\":[\"antialiased\",\"subpixel-antialiased\"],\"font-style\":[\"italic\",\"not-italic\"],\"font-weight\":[{font:[\"thin\",\"extralight\",\"light\",\"normal\",\"medium\",\"semibold\",\"bold\",\"extrabold\",\"black\",kj]}],\"font-family\":[{font:[Em]}],\"fvn-normal\":[\"normal-nums\"],\"fvn-ordinal\":[\"ordinal\"],\"fvn-slashed-zero\":[\"slashed-zero\"],\"fvn-figure\":[\"lining-nums\",\"oldstyle-nums\"],\"fvn-spacing\":[\"proportional-nums\",\"tabular-nums\"],\"fvn-fraction\":[\"diagonal-fractions\",\"stacked-fractions\"],tracking:[{tracking:[\"tighter\",\"tight\",\"normal\",\"wide\",\"wider\",\"widest\",Gt]}],\"line-clamp\":[{\"line-clamp\":[\"none\",uh,kj]}],leading:[{leading:[\"none\",\"tight\",\"snug\",\"normal\",\"relaxed\",\"loose\",nl,Gt]}],\"list-image\":[{\"list-image\":[\"none\",Gt]}],\"list-style-type\":[{list:[\"none\",\"disc\",\"decimal\",Gt]}],\"list-style-position\":[{list:[\"inside\",\"outside\"]}],\"placeholder-color\":[{placeholder:[e]}],\"placeholder-opacity\":[{\"placeholder-opacity\":[b]}],\"text-alignment\":[{text:[\"left\",\"center\",\"right\",\"justify\",\"start\",\"end\"]}],\"text-color\":[{text:[e]}],\"text-opacity\":[{\"text-opacity\":[b]}],\"text-decoration\":[\"underline\",\"overline\",\"line-through\",\"no-underline\"],\"text-decoration-style\":[{decoration:[...L(),\"wavy\"]}],\"text-decoration-thickness\":[{decoration:[\"auto\",\"from-font\",nl,tc]}],\"underline-offset\":[{\"underline-offset\":[\"auto\",nl,Gt]}],\"text-decoration-color\":[{decoration:[e]}],\"text-transform\":[\"uppercase\",\"lowercase\",\"capitalize\",\"normal-case\"],\"text-overflow\":[\"truncate\",\"text-ellipsis\",\"text-clip\"],\"text-wrap\":[{text:[\"wrap\",\"nowrap\",\"balance\",\"pretty\"]}],indent:[{indent:A()}],\"vertical-align\":[{align:[\"baseline\",\"top\",\"middle\",\"bottom\",\"text-top\",\"text-bottom\",\"sub\",\"super\",Gt]}],whitespace:[{whitespace:[\"normal\",\"nowrap\",\"pre\",\"pre-line\",\"pre-wrap\",\"break-spaces\"]}],break:[{break:[\"normal\",\"words\",\"all\",\"keep\"]}],hyphens:[{hyphens:[\"none\",\"manual\",\"auto\"]}],content:[{content:[\"none\",Gt]}],\"bg-attachment\":[{bg:[\"fixed\",\"local\",\"scroll\"]}],\"bg-clip\":[{\"bg-clip\":[\"border\",\"padding\",\"content\",\"text\"]}],\"bg-opacity\":[{\"bg-opacity\":[b]}],\"bg-origin\":[{\"bg-origin\":[\"border\",\"padding\",\"content\"]}],\"bg-position\":[{bg:[...T(),ate]}],\"bg-repeat\":[{bg:[\"no-repeat\",{repeat:[\"\",\"x\",\"y\",\"round\",\"space\"]}]}],\"bg-size\":[{bg:[\"auto\",\"cover\",\"contain\",nte]}],\"bg-image\":[{bg:[\"none\",{\"gradient-to\":[\"t\",\"tr\",\"r\",\"br\",\"b\",\"bl\",\"l\",\"tl\"]},ite]}],\"bg-color\":[{bg:[e]}],\"gradient-from-pos\":[{from:[g]}],\"gradient-via-pos\":[{via:[g]}],\"gradient-to-pos\":[{to:[g]}],\"gradient-from\":[{from:[m]}],\"gradient-via\":[{via:[m]}],\"gradient-to\":[{to:[m]}],rounded:[{rounded:[i]}],\"rounded-s\":[{\"rounded-s\":[i]}],\"rounded-e\":[{\"rounded-e\":[i]}],\"rounded-t\":[{\"rounded-t\":[i]}],\"rounded-r\":[{\"rounded-r\":[i]}],\"rounded-b\":[{\"rounded-b\":[i]}],\"rounded-l\":[{\"rounded-l\":[i]}],\"rounded-ss\":[{\"rounded-ss\":[i]}],\"rounded-se\":[{\"rounded-se\":[i]}],\"rounded-ee\":[{\"rounded-ee\":[i]}],\"rounded-es\":[{\"rounded-es\":[i]}],\"rounded-tl\":[{\"rounded-tl\":[i]}],\"rounded-tr\":[{\"rounded-tr\":[i]}],\"rounded-br\":[{\"rounded-br\":[i]}],\"rounded-bl\":[{\"rounded-bl\":[i]}],\"border-w\":[{border:[l]}],\"border-w-x\":[{\"border-x\":[l]}],\"border-w-y\":[{\"border-y\":[l]}],\"border-w-s\":[{\"border-s\":[l]}],\"border-w-e\":[{\"border-e\":[l]}],\"border-w-t\":[{\"border-t\":[l]}],\"border-w-r\":[{\"border-r\":[l]}],\"border-w-b\":[{\"border-b\":[l]}],\"border-w-l\":[{\"border-l\":[l]}],\"border-opacity\":[{\"border-opacity\":[b]}],\"border-style\":[{border:[...L(),\"hidden\"]}],\"divide-x\":[{\"divide-x\":[l]}],\"divide-x-reverse\":[\"divide-x-reverse\"],\"divide-y\":[{\"divide-y\":[l]}],\"divide-y-reverse\":[\"divide-y-reverse\"],\"divide-opacity\":[{\"divide-opacity\":[b]}],\"divide-style\":[{divide:L()}],\"border-color\":[{border:[a]}],\"border-color-x\":[{\"border-x\":[a]}],\"border-color-y\":[{\"border-y\":[a]}],\"border-color-s\":[{\"border-s\":[a]}],\"border-color-e\":[{\"border-e\":[a]}],\"border-color-t\":[{\"border-t\":[a]}],\"border-color-r\":[{\"border-r\":[a]}],\"border-color-b\":[{\"border-b\":[a]}],\"border-color-l\":[{\"border-l\":[a]}],\"divide-color\":[{divide:[a]}],\"outline-style\":[{outline:[\"\",...L()]}],\"outline-offset\":[{\"outline-offset\":[nl,Gt]}],\"outline-w\":[{outline:[nl,tc]}],\"outline-color\":[{outline:[e]}],\"ring-w\":[{ring:D()}],\"ring-w-inset\":[\"ring-inset\"],\"ring-color\":[{ring:[e]}],\"ring-opacity\":[{\"ring-opacity\":[b]}],\"ring-offset-w\":[{\"ring-offset\":[nl,tc]}],\"ring-offset-color\":[{\"ring-offset\":[e]}],shadow:[{shadow:[\"\",\"inner\",\"none\",rc,ote]}],\"shadow-color\":[{shadow:[Em]}],opacity:[{opacity:[b]}],\"mix-blend\":[{\"mix-blend\":[...I(),\"plus-lighter\",\"plus-darker\"]}],\"bg-blend\":[{\"bg-blend\":I()}],filter:[{filter:[\"\",\"none\"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],\"drop-shadow\":[{\"drop-shadow\":[\"\",\"none\",rc,Gt]}],grayscale:[{grayscale:[u]}],\"hue-rotate\":[{\"hue-rotate\":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[v]}],sepia:[{sepia:[w]}],\"backdrop-filter\":[{\"backdrop-filter\":[\"\",\"none\"]}],\"backdrop-blur\":[{\"backdrop-blur\":[r]}],\"backdrop-brightness\":[{\"backdrop-brightness\":[n]}],\"backdrop-contrast\":[{\"backdrop-contrast\":[c]}],\"backdrop-grayscale\":[{\"backdrop-grayscale\":[u]}],\"backdrop-hue-rotate\":[{\"backdrop-hue-rotate\":[d]}],\"backdrop-invert\":[{\"backdrop-invert\":[f]}],\"backdrop-opacity\":[{\"backdrop-opacity\":[b]}],\"backdrop-saturate\":[{\"backdrop-saturate\":[v]}],\"backdrop-sepia\":[{\"backdrop-sepia\":[w]}],\"border-collapse\":[{border:[\"collapse\",\"separate\"]}],\"border-spacing\":[{\"border-spacing\":[o]}],\"border-spacing-x\":[{\"border-spacing-x\":[o]}],\"border-spacing-y\":[{\"border-spacing-y\":[o]}],\"table-layout\":[{table:[\"auto\",\"fixed\"]}],caption:[{caption:[\"top\",\"bottom\"]}],transition:[{transition:[\"none\",\"all\",\"\",\"colors\",\"opacity\",\"shadow\",\"transform\",Gt]}],duration:[{duration:ae()}],ease:[{ease:[\"linear\",\"in\",\"out\",\"in-out\",Gt]}],delay:[{delay:ae()}],animate:[{animate:[\"none\",\"spin\",\"ping\",\"pulse\",\"bounce\",Gt]}],transform:[{transform:[\"\",\"gpu\",\"none\"]}],scale:[{scale:[S]}],\"scale-x\":[{\"scale-x\":[S]}],\"scale-y\":[{\"scale-y\":[S]}],rotate:[{rotate:[_m,Gt]}],\"translate-x\":[{\"translate-x\":[E]}],\"translate-y\":[{\"translate-y\":[E]}],\"skew-x\":[{\"skew-x\":[N]}],\"skew-y\":[{\"skew-y\":[N]}],\"transform-origin\":[{origin:[\"center\",\"top\",\"top-right\",\"right\",\"bottom-right\",\"bottom\",\"bottom-left\",\"left\",\"top-left\",Gt]}],accent:[{accent:[\"auto\",e]}],appearance:[{appearance:[\"none\",\"auto\"]}],cursor:[{cursor:[\"auto\",\"default\",\"pointer\",\"wait\",\"text\",\"move\",\"help\",\"not-allowed\",\"none\",\"context-menu\",\"progress\",\"cell\",\"crosshair\",\"vertical-text\",\"alias\",\"copy\",\"no-drop\",\"grab\",\"grabbing\",\"all-scroll\",\"col-resize\",\"row-resize\",\"n-resize\",\"e-resize\",\"s-resize\",\"w-resize\",\"ne-resize\",\"nw-resize\",\"se-resize\",\"sw-resize\",\"ew-resize\",\"ns-resize\",\"nesw-resize\",\"nwse-resize\",\"zoom-in\",\"zoom-out\",Gt]}],\"caret-color\":[{caret:[e]}],\"pointer-events\":[{\"pointer-events\":[\"none\",\"auto\"]}],resize:[{resize:[\"none\",\"y\",\"x\",\"\"]}],\"scroll-behavior\":[{scroll:[\"auto\",\"smooth\"]}],\"scroll-m\":[{\"scroll-m\":A()}],\"scroll-mx\":[{\"scroll-mx\":A()}],\"scroll-my\":[{\"scroll-my\":A()}],\"scroll-ms\":[{\"scroll-ms\":A()}],\"scroll-me\":[{\"scroll-me\":A()}],\"scroll-mt\":[{\"scroll-mt\":A()}],\"scroll-mr\":[{\"scroll-mr\":A()}],\"scroll-mb\":[{\"scroll-mb\":A()}],\"scroll-ml\":[{\"scroll-ml\":A()}],\"scroll-p\":[{\"scroll-p\":A()}],\"scroll-px\":[{\"scroll-px\":A()}],\"scroll-py\":[{\"scroll-py\":A()}],\"scroll-ps\":[{\"scroll-ps\":A()}],\"scroll-pe\":[{\"scroll-pe\":A()}],\"scroll-pt\":[{\"scroll-pt\":A()}],\"scroll-pr\":[{\"scroll-pr\":A()}],\"scroll-pb\":[{\"scroll-pb\":A()}],\"scroll-pl\":[{\"scroll-pl\":A()}],\"snap-align\":[{snap:[\"start\",\"end\",\"center\",\"align-none\"]}],\"snap-stop\":[{snap:[\"normal\",\"always\"]}],\"snap-type\":[{snap:[\"none\",\"x\",\"y\",\"both\"]}],\"snap-strictness\":[{snap:[\"mandatory\",\"proximity\"]}],touch:[{touch:[\"auto\",\"none\",\"manipulation\"]}],\"touch-x\":[{\"touch-pan\":[\"x\",\"left\",\"right\"]}],\"touch-y\":[{\"touch-pan\":[\"y\",\"up\",\"down\"]}],\"touch-pz\":[\"touch-pinch-zoom\"],select:[{select:[\"none\",\"text\",\"all\",\"auto\"]}],\"will-change\":[{\"will-change\":[\"auto\",\"scroll\",\"contents\",\"transform\",Gt]}],fill:[{fill:[e,\"none\"]}],\"stroke-w\":[{stroke:[nl,tc,kj]}],stroke:[{stroke:[e,\"none\"]}],sr:[\"sr-only\",\"not-sr-only\"],\"forced-color-adjust\":[{\"forced-color-adjust\":[\"auto\",\"none\"]}]},conflictingClassGroups:{overflow:[\"overflow-x\",\"overflow-y\"],overscroll:[\"overscroll-x\",\"overscroll-y\"],inset:[\"inset-x\",\"inset-y\",\"start\",\"end\",\"top\",\"right\",\"bottom\",\"left\"],\"inset-x\":[\"right\",\"left\"],\"inset-y\":[\"top\",\"bottom\"],flex:[\"basis\",\"grow\",\"shrink\"],gap:[\"gap-x\",\"gap-y\"],p:[\"px\",\"py\",\"ps\",\"pe\",\"pt\",\"pr\",\"pb\",\"pl\"],px:[\"pr\",\"pl\"],py:[\"pt\",\"pb\"],m:[\"mx\",\"my\",\"ms\",\"me\",\"mt\",\"mr\",\"mb\",\"ml\"],mx:[\"mr\",\"ml\"],my:[\"mt\",\"mb\"],size:[\"w\",\"h\"],\"font-size\":[\"leading\"],\"fvn-normal\":[\"fvn-ordinal\",\"fvn-slashed-zero\",\"fvn-figure\",\"fvn-spacing\",\"fvn-fraction\"],\"fvn-ordinal\":[\"fvn-normal\"],\"fvn-slashed-zero\":[\"fvn-normal\"],\"fvn-figure\":[\"fvn-normal\"],\"fvn-spacing\":[\"fvn-normal\"],\"fvn-fraction\":[\"fvn-normal\"],\"line-clamp\":[\"display\",\"overflow\"],rounded:[\"rounded-s\",\"rounded-e\",\"rounded-t\",\"rounded-r\",\"rounded-b\",\"rounded-l\",\"rounded-ss\",\"rounded-se\",\"rounded-ee\",\"rounded-es\",\"rounded-tl\",\"rounded-tr\",\"rounded-br\",\"rounded-bl\"],\"rounded-s\":[\"rounded-ss\",\"rounded-es\"],\"rounded-e\":[\"rounded-se\",\"rounded-ee\"],\"rounded-t\":[\"rounded-tl\",\"rounded-tr\"],\"rounded-r\":[\"rounded-tr\",\"rounded-br\"],\"rounded-b\":[\"rounded-br\",\"rounded-bl\"],\"rounded-l\":[\"rounded-tl\",\"rounded-bl\"],\"border-spacing\":[\"border-spacing-x\",\"border-spacing-y\"],\"border-w\":[\"border-w-s\",\"border-w-e\",\"border-w-t\",\"border-w-r\",\"border-w-b\",\"border-w-l\"],\"border-w-x\":[\"border-w-r\",\"border-w-l\"],\"border-w-y\":[\"border-w-t\",\"border-w-b\"],\"border-color\":[\"border-color-s\",\"border-color-e\",\"border-color-t\",\"border-color-r\",\"border-color-b\",\"border-color-l\"],\"border-color-x\":[\"border-color-r\",\"border-color-l\"],\"border-color-y\":[\"border-color-t\",\"border-color-b\"],\"scroll-m\":[\"scroll-mx\",\"scroll-my\",\"scroll-ms\",\"scroll-me\",\"scroll-mt\",\"scroll-mr\",\"scroll-mb\",\"scroll-ml\"],\"scroll-mx\":[\"scroll-mr\",\"scroll-ml\"],\"scroll-my\":[\"scroll-mt\",\"scroll-mb\"],\"scroll-p\":[\"scroll-px\",\"scroll-py\",\"scroll-ps\",\"scroll-pe\",\"scroll-pt\",\"scroll-pr\",\"scroll-pb\",\"scroll-pl\"],\"scroll-px\":[\"scroll-pr\",\"scroll-pl\"],\"scroll-py\":[\"scroll-pt\",\"scroll-pb\"],touch:[\"touch-x\",\"touch-y\",\"touch-pz\"],\"touch-x\":[\"touch\"],\"touch-y\":[\"touch\"],\"touch-pz\":[\"touch\"]},conflictingClassGroupModifiers:{\"font-size\":[\"leading\"]}}},fte=Kee(dte);function be(...e){return fte(Bt(e))}const hte=iee,b9=j.forwardRef(({className:e,...t},r)=>s.jsx(qL,{ref:r,className:be(\"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",e),...t}));b9.displayName=qL.displayName;const mte=$0(\"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",{variants:{variant:{default:\"border !bg-white text-foreground\",destructive:\"destructive group border-destructive bg-destructive text-destructive-foreground\"}},defaultVariants:{variant:\"default\"}}),w9=j.forwardRef(({className:e,variant:t,...r},n)=>s.jsx(XL,{ref:n,className:be(mte({variant:t}),e),...r}));w9.displayName=XL.displayName;const pte=j.forwardRef(({className:e,...t},r)=>s.jsx(JL,{ref:r,className:be(\"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",e),...t}));pte.displayName=JL.displayName;const j9=j.forwardRef(({className:e,...t},r)=>s.jsx(e9,{ref:r,className:be(\"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",e),\"toast-close\":\"\",...t,children:s.jsx(Wo,{className:\"h-4 w-4\"})}));j9.displayName=e9.displayName;const N9=j.forwardRef(({className:e,...t},r)=>s.jsx(ZL,{ref:r,className:be(\"text-sm font-semibold\",e),...t}));N9.displayName=ZL.displayName;const S9=j.forwardRef(({className:e,...t},r)=>s.jsx(QL,{ref:r,className:be(\"text-sm opacity-90\",e),...t}));S9.displayName=QL.displayName;function gte(){const{toasts:e}=Un();return s.jsxs(hte,{children:[e.map(function({id:t,title:r,description:n,action:a,...i}){return s.jsxs(w9,{...i,children:[s.jsxs(\"div\",{className:\"grid gap-1\",children:[r&&s.jsx(N9,{children:r}),n&&s.jsx(S9,{children:n})]}),a,s.jsx(j9,{})]},t)}),s.jsx(b9,{})]})}var xte=rF[\" useId \".trim().toString()]||(()=>{}),vte=0;function ra(e){const[t,r]=j.useState(xte());return On(()=>{r(n=>n??String(vte++))},[e]),t?`radix-${t}`:\"\"}const yte=[\"top\",\"right\",\"bottom\",\"left\"],Hc=Math.min,As=Math.max,r1=Math.round,Sv=Math.floor,Lo=e=>({x:e,y:e}),bte={left:\"right\",right:\"left\",bottom:\"top\",top:\"bottom\"},wte={start:\"end\",end:\"start\"};function o_(e,t,r){return As(e,Hc(t,r))}function Rl(e,t){return typeof e==\"function\"?e(t):e}function Ll(e){return e.split(\"-\")[0]}function z0(e){return e.split(\"-\")[1]}function $C(e){return e===\"x\"?\"y\":\"x\"}function BC(e){return e===\"y\"?\"height\":\"width\"}function Gc(e){return[\"top\",\"bottom\"].includes(Ll(e))?\"y\":\"x\"}function VC(e){return $C(Gc(e))}function jte(e,t,r){r===void 0&&(r=!1);const n=z0(e),a=VC(e),i=BC(a);let o=a===\"x\"?n===(r?\"end\":\"start\")?\"right\":\"left\":n===\"start\"?\"bottom\":\"top\";return t.reference[i]>t.floating[i]&&(o=n1(o)),[o,n1(o)]}function Nte(e){const t=n1(e);return[l_(e),t,l_(t)]}function l_(e){return e.replace(/start|end/g,t=>wte[t])}function Ste(e,t,r){const n=[\"left\",\"right\"],a=[\"right\",\"left\"],i=[\"top\",\"bottom\"],o=[\"bottom\",\"top\"];switch(e){case\"top\":case\"bottom\":return r?t?a:n:t?n:a;case\"left\":case\"right\":return t?i:o;default:return[]}}function _te(e,t,r,n){const a=z0(e);let i=Ste(Ll(e),r===\"start\",n);return a&&(i=i.map(o=>o+\"-\"+a),t&&(i=i.concat(i.map(l_)))),i}function n1(e){return e.replace(/left|right|bottom|top/g,t=>bte[t])}function Ete(e){return{top:0,right:0,bottom:0,left:0,...e}}function _9(e){return typeof e!=\"number\"?Ete(e):{top:e,right:e,bottom:e,left:e}}function a1(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function AP(e,t,r){let{reference:n,floating:a}=e;const i=Gc(t),o=VC(t),l=BC(o),c=Ll(t),u=i===\"y\",d=n.x+n.width/2-a.width/2,f=n.y+n.height/2-a.height/2,h=n[l]/2-a[l]/2;let m;switch(c){case\"top\":m={x:d,y:n.y-a.height};break;case\"bottom\":m={x:d,y:n.y+n.height};break;case\"right\":m={x:n.x+n.width,y:f};break;case\"left\":m={x:n.x-a.width,y:f};break;default:m={x:n.x,y:n.y}}switch(z0(t)){case\"start\":m[o]-=h*(r&&u?-1:1);break;case\"end\":m[o]+=h*(r&&u?-1:1);break}return m}const kte=async(e,t,r)=>{const{placement:n=\"bottom\",strategy:a=\"absolute\",middleware:i=[],platform:o}=r,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:f}=AP(u,n,c),h=n,m={},g=0;for(let p=0;p<l.length;p++){const{name:x,fn:b}=l[p],{x:y,y:v,data:S,reset:w}=await b({x:d,y:f,initialPlacement:n,placement:h,strategy:a,middlewareData:m,rects:u,platform:o,elements:{reference:e,floating:t}});d=y??d,f=v??f,m={...m,[x]:{...m[x],...S}},w&&g<=50&&(g++,typeof w==\"object\"&&(w.placement&&(h=w.placement),w.rects&&(u=w.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:a}):w.rects),{x:d,y:f}=AP(u,h,c)),p=-1)}return{x:d,y:f,placement:h,strategy:a,middlewareData:m}};async function Xp(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:u=\"clippingAncestors\",rootBoundary:d=\"viewport\",elementContext:f=\"floating\",altBoundary:h=!1,padding:m=0}=Rl(t,e),g=_9(m),x=l[h?f===\"floating\"?\"reference\":\"floating\":f],b=a1(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(x)))==null||r?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),y=f===\"floating\"?{x:n,y:a,width:o.floating.width,height:o.floating.height}:o.reference,v=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),S=await(i.isElement==null?void 0:i.isElement(v))?await(i.getScale==null?void 0:i.getScale(v))||{x:1,y:1}:{x:1,y:1},w=a1(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:v,strategy:c}):y);return{top:(b.top-w.top+g.top)/S.y,bottom:(w.bottom-b.bottom+g.bottom)/S.y,left:(b.left-w.left+g.left)/S.x,right:(w.right-b.right+g.right)/S.x}}const Cte=e=>({name:\"arrow\",options:e,async fn(t){const{x:r,y:n,placement:a,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=Rl(e,t)||{};if(u==null)return{};const f=_9(d),h={x:r,y:n},m=VC(a),g=BC(m),p=await o.getDimensions(u),x=m===\"y\",b=x?\"top\":\"left\",y=x?\"bottom\":\"right\",v=x?\"clientHeight\":\"clientWidth\",S=i.reference[g]+i.reference[m]-h[m]-i.floating[g],w=h[m]-i.reference[m],N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let _=N?N[v]:0;(!_||!await(o.isElement==null?void 0:o.isElement(N)))&&(_=l.floating[v]||i.floating[g]);const E=S/2-w/2,k=_/2-p[g]/2-1,O=Hc(f[b],k),C=Hc(f[y],k),A=O,D=_-p[g]-C,R=_/2-p[g]/2+E,T=o_(A,R,D),L=!c.arrow&&z0(a)!=null&&R!==T&&i.reference[g]/2-(R<A?O:C)-p[g]/2<0,I=L?R<A?R-A:R-D:0;return{[m]:h[m]+I,data:{[m]:T,centerOffset:R-T-I,...L&&{alignmentOffset:I}},reset:L}}}),Ate=function(e){return e===void 0&&(e={}),{name:\"flip\",options:e,async fn(t){var r,n;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:h,fallbackStrategy:m=\"bestFit\",fallbackAxisSideDirection:g=\"none\",flipAlignment:p=!0,...x}=Rl(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const b=Ll(a),y=Gc(l),v=Ll(l)===l,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),w=h||(v||!p?[n1(l)]:Nte(l)),N=g!==\"none\";!h&&N&&w.push(..._te(l,p,g,S));const _=[l,...w],E=await Xp(t,x),k=[];let O=((n=i.flip)==null?void 0:n.overflows)||[];if(d&&k.push(E[b]),f){const R=jte(a,o,S);k.push(E[R[0]],E[R[1]])}if(O=[...O,{placement:a,overflows:k}],!k.every(R=>R<=0)){var C,A;const R=(((C=i.flip)==null?void 0:C.index)||0)+1,T=_[R];if(T)return{data:{index:R,overflows:O},reset:{placement:T}};let L=(A=O.filter(I=>I.overflows[0]<=0).sort((I,M)=>I.overflows[1]-M.overflows[1])[0])==null?void 0:A.placement;if(!L)switch(m){case\"bestFit\":{var D;const I=(D=O.filter(M=>{if(N){const F=Gc(M.placement);return F===y||F===\"y\"}return!0}).map(M=>[M.placement,M.overflows.filter(F=>F>0).reduce((F,G)=>F+G,0)]).sort((M,F)=>M[1]-F[1])[0])==null?void 0:D[0];I&&(L=I);break}case\"initialPlacement\":L=l;break}if(a!==L)return{reset:{placement:L}}}return{}}}};function TP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function OP(e){return yte.some(t=>e[t]>=0)}const Tte=function(e){return e===void 0&&(e={}),{name:\"hide\",options:e,async fn(t){const{rects:r}=t,{strategy:n=\"referenceHidden\",...a}=Rl(e,t);switch(n){case\"referenceHidden\":{const i=await Xp(t,{...a,elementContext:\"reference\"}),o=TP(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:OP(o)}}}case\"escaped\":{const i=await Xp(t,{...a,altBoundary:!0}),o=TP(i,r.floating);return{data:{escapedOffsets:o,escaped:OP(o)}}}default:return{}}}}};async function Ote(e,t){const{placement:r,platform:n,elements:a}=e,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),o=Ll(r),l=z0(r),c=Gc(r)===\"y\",u=[\"left\",\"top\"].includes(o)?-1:1,d=i&&c?-1:1,f=Rl(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:g}=typeof f==\"number\"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof g==\"number\"&&(m=l===\"end\"?g*-1:g),c?{x:m*d,y:h*u}:{x:h*u,y:m*d}}const Pte=function(e){return e===void 0&&(e=0),{name:\"offset\",options:e,async fn(t){var r,n;const{x:a,y:i,placement:o,middlewareData:l}=t,c=await Ote(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:o}}}}},Mte=function(e){return e===void 0&&(e={}),{name:\"shift\",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:b,y}=x;return{x:b,y}}},...c}=Rl(e,t),u={x:r,y:n},d=await Xp(t,c),f=Gc(Ll(a)),h=$C(f);let m=u[h],g=u[f];if(i){const x=h===\"y\"?\"top\":\"left\",b=h===\"y\"?\"bottom\":\"right\",y=m+d[x],v=m-d[b];m=o_(y,m,v)}if(o){const x=f===\"y\"?\"top\":\"left\",b=f===\"y\"?\"bottom\":\"right\",y=g+d[x],v=g-d[b];g=o_(y,g,v)}const p=l.fn({...t,[h]:m,[f]:g});return{...p,data:{x:p.x-r,y:p.y-n,enabled:{[h]:i,[f]:o}}}}}},Dte=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=Rl(e,t),d={x:r,y:n},f=Gc(a),h=$C(f);let m=d[h],g=d[f];const p=Rl(l,t),x=typeof p==\"number\"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(c){const v=h===\"y\"?\"height\":\"width\",S=i.reference[h]-i.floating[v]+x.mainAxis,w=i.reference[h]+i.reference[v]-x.mainAxis;m<S?m=S:m>w&&(m=w)}if(u){var b,y;const v=h===\"y\"?\"width\":\"height\",S=[\"top\",\"left\"].includes(Ll(a)),w=i.reference[f]-i.floating[v]+(S&&((b=o.offset)==null?void 0:b[f])||0)+(S?0:x.crossAxis),N=i.reference[f]+i.reference[v]+(S?0:((y=o.offset)==null?void 0:y[f])||0)-(S?x.crossAxis:0);g<w?g=w:g>N&&(g=N)}return{[h]:m,[f]:g}}}},Ite=function(e){return e===void 0&&(e={}),{name:\"size\",options:e,async fn(t){var r,n;const{placement:a,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...u}=Rl(e,t),d=await Xp(t,u),f=Ll(a),h=z0(a),m=Gc(a)===\"y\",{width:g,height:p}=i.floating;let x,b;f===\"top\"||f===\"bottom\"?(x=f,b=h===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?\"start\":\"end\")?\"left\":\"right\"):(b=f,x=h===\"end\"?\"top\":\"bottom\");const y=p-d.top-d.bottom,v=g-d.left-d.right,S=Hc(p-d[x],y),w=Hc(g-d[b],v),N=!t.middlewareData.shift;let _=S,E=w;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(E=v),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(_=y),N&&!h){const O=As(d.left,0),C=As(d.right,0),A=As(d.top,0),D=As(d.bottom,0);m?E=g-2*(O!==0||C!==0?O+C:As(d.left,d.right)):_=p-2*(A!==0||D!==0?A+D:As(d.top,d.bottom))}await c({...t,availableWidth:E,availableHeight:_});const k=await o.getDimensions(l.floating);return g!==k.width||p!==k.height?{reset:{rects:!0}}:{}}}};function dw(){return typeof window<\"u\"}function U0(e){return E9(e)?(e.nodeName||\"\").toLowerCase():\"#document\"}function Rs(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Zo(e){var t;return(t=(E9(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function E9(e){return dw()?e instanceof Node||e instanceof Rs(e).Node:!1}function oo(e){return dw()?e instanceof Element||e instanceof Rs(e).Element:!1}function Ho(e){return dw()?e instanceof HTMLElement||e instanceof Rs(e).HTMLElement:!1}function PP(e){return!dw()||typeof ShadowRoot>\"u\"?!1:e instanceof ShadowRoot||e instanceof Rs(e).ShadowRoot}function wx(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=lo(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&![\"inline\",\"contents\"].includes(a)}function Fte(e){return[\"table\",\"td\",\"th\"].includes(U0(e))}function fw(e){return[\":popover-open\",\":modal\"].some(t=>{try{return e.matches(t)}catch{return!1}})}function zC(e){const t=UC(),r=oo(e)?lo(e):e;return[\"transform\",\"translate\",\"scale\",\"rotate\",\"perspective\"].some(n=>r[n]?r[n]!==\"none\":!1)||(r.containerType?r.containerType!==\"normal\":!1)||!t&&(r.backdropFilter?r.backdropFilter!==\"none\":!1)||!t&&(r.filter?r.filter!==\"none\":!1)||[\"transform\",\"translate\",\"scale\",\"rotate\",\"perspective\",\"filter\"].some(n=>(r.willChange||\"\").includes(n))||[\"paint\",\"layout\",\"strict\",\"content\"].some(n=>(r.contain||\"\").includes(n))}function Rte(e){let t=Kc(e);for(;Ho(t)&&!Gh(t);){if(zC(t))return t;if(fw(t))return null;t=Kc(t)}return null}function UC(){return typeof CSS>\"u\"||!CSS.supports?!1:CSS.supports(\"-webkit-backdrop-filter\",\"none\")}function Gh(e){return[\"html\",\"body\",\"#document\"].includes(U0(e))}function lo(e){return Rs(e).getComputedStyle(e)}function hw(e){return oo(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Kc(e){if(U0(e)===\"html\")return e;const t=e.assignedSlot||e.parentNode||PP(e)&&e.host||Zo(e);return PP(t)?t.host:t}function k9(e){const t=Kc(e);return Gh(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ho(t)&&wx(t)?t:k9(t)}function Zp(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=k9(e),i=a===((n=e.ownerDocument)==null?void 0:n.body),o=Rs(a);if(i){const l=c_(o);return t.concat(o,o.visualViewport||[],wx(a)?a:[],l&&r?Zp(l):[])}return t.concat(a,Zp(a,[],r))}function c_(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function C9(e){const t=lo(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Ho(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:n,l=r1(r)!==i||r1(n)!==o;return l&&(r=i,n=o),{width:r,height:n,$:l}}function WC(e){return oo(e)?e:e.contextElement}function dh(e){const t=WC(e);if(!Ho(t))return Lo(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:i}=C9(t);let o=(i?r1(r.width):r.width)/n,l=(i?r1(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const Lte=Lo(0);function A9(e){const t=Rs(e);return!UC()||!t.visualViewport?Lte:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function $te(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==Rs(e)?!1:t}function vd(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=WC(e);let o=Lo(1);t&&(n?oo(n)&&(o=dh(n)):o=dh(e));const l=$te(i,r,n)?A9(i):Lo(0);let c=(a.left+l.x)/o.x,u=(a.top+l.y)/o.y,d=a.width/o.x,f=a.height/o.y;if(i){const h=Rs(i),m=n&&oo(n)?Rs(n):n;let g=h,p=c_(g);for(;p&&n&&m!==g;){const x=dh(p),b=p.getBoundingClientRect(),y=lo(p),v=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*x.x,S=b.top+(p.clientTop+parseFloat(y.paddingTop))*x.y;c*=x.x,u*=x.y,d*=x.x,f*=x.y,c+=v,u+=S,g=Rs(p),p=c_(g)}}return a1({width:d,height:f,x:c,y:u})}function HC(e,t){const r=hw(e).scrollLeft;return t?t.left+r:vd(Zo(e)).left+r}function T9(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:HC(e,n)),i=n.top+t.scrollTop;return{x:a,y:i}}function Bte(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const i=a===\"fixed\",o=Zo(n),l=t?fw(t.floating):!1;if(n===o||l&&i)return r;let c={scrollLeft:0,scrollTop:0},u=Lo(1);const d=Lo(0),f=Ho(n);if((f||!f&&!i)&&((U0(n)!==\"body\"||wx(o))&&(c=hw(n)),Ho(n))){const m=vd(n);u=dh(n),d.x=m.x+n.clientLeft,d.y=m.y+n.clientTop}const h=o&&!f&&!i?T9(o,c,!0):Lo(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+d.x+h.x,y:r.y*u.y-c.scrollTop*u.y+d.y+h.y}}function Vte(e){return Array.from(e.getClientRects())}function zte(e){const t=Zo(e),r=hw(e),n=e.ownerDocument.body,a=As(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),i=As(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+HC(e);const l=-r.scrollTop;return lo(n).direction===\"rtl\"&&(o+=As(t.clientWidth,n.clientWidth)-a),{width:a,height:i,x:o,y:l}}function Ute(e,t){const r=Rs(e),n=Zo(e),a=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;const u=UC();(!u||u&&t===\"fixed\")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l,y:c}}function Wte(e,t){const r=vd(e,!0,t===\"fixed\"),n=r.top+e.clientTop,a=r.left+e.clientLeft,i=Ho(e)?dh(e):Lo(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=a*i.x,u=n*i.y;return{width:o,height:l,x:c,y:u}}function MP(e,t,r){let n;if(t===\"viewport\")n=Ute(e,r);else if(t===\"document\")n=zte(Zo(e));else if(oo(t))n=Wte(t,r);else{const a=A9(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return a1(n)}function O9(e,t){const r=Kc(e);return r===t||!oo(r)||Gh(r)?!1:lo(r).position===\"fixed\"||O9(r,t)}function Hte(e,t){const r=t.get(e);if(r)return r;let n=Zp(e,[],!1).filter(l=>oo(l)&&U0(l)!==\"body\"),a=null;const i=lo(e).position===\"fixed\";let o=i?Kc(e):e;for(;oo(o)&&!Gh(o);){const l=lo(o),c=zC(o);!c&&l.position===\"fixed\"&&(a=null),(i?!c&&!a:!c&&l.position===\"static\"&&!!a&&[\"absolute\",\"fixed\"].includes(a.position)||wx(o)&&!c&&O9(e,o))?n=n.filter(d=>d!==o):a=l,o=Kc(o)}return t.set(e,n),n}function Gte(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const o=[...r===\"clippingAncestors\"?fw(t)?[]:Hte(t,this._c):[].concat(r),n],l=o[0],c=o.reduce((u,d)=>{const f=MP(t,d,a);return u.top=As(f.top,u.top),u.right=Hc(f.right,u.right),u.bottom=Hc(f.bottom,u.bottom),u.left=As(f.left,u.left),u},MP(t,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Kte(e){const{width:t,height:r}=C9(e);return{width:t,height:r}}function Yte(e,t,r){const n=Ho(t),a=Zo(t),i=r===\"fixed\",o=vd(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Lo(0);if(n||!n&&!i)if((U0(t)!==\"body\"||wx(a))&&(l=hw(t)),n){const h=vd(t,!0,i,t);c.x=h.x+t.clientLeft,c.y=h.y+t.clientTop}else a&&(c.x=HC(a));const u=a&&!n&&!i?T9(a,l):Lo(0),d=o.left+l.scrollLeft-c.x-u.x,f=o.top+l.scrollTop-c.y-u.y;return{x:d,y:f,width:o.width,height:o.height}}function Cj(e){return lo(e).position===\"static\"}function DP(e,t){if(!Ho(e)||lo(e).position===\"fixed\")return null;if(t)return t(e);let r=e.offsetParent;return Zo(e)===r&&(r=r.ownerDocument.body),r}function P9(e,t){const r=Rs(e);if(fw(e))return r;if(!Ho(e)){let a=Kc(e);for(;a&&!Gh(a);){if(oo(a)&&!Cj(a))return a;a=Kc(a)}return r}let n=DP(e,t);for(;n&&Fte(n)&&Cj(n);)n=DP(n,t);return n&&Gh(n)&&Cj(n)&&!zC(n)?r:n||Rte(e)||r}const qte=async function(e){const t=this.getOffsetParent||P9,r=this.getDimensions,n=await r(e.floating);return{reference:Yte(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Xte(e){return lo(e).direction===\"rtl\"}const Zte={convertOffsetParentRelativeRectToViewportRelativeRect:Bte,getDocumentElement:Zo,getClippingRect:Gte,getOffsetParent:P9,getElementRects:qte,getClientRects:Vte,getDimensions:Kte,getScale:dh,isElement:oo,isRTL:Xte};function M9(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Qte(e,t){let r=null,n;const a=Zo(e);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:d,top:f,width:h,height:m}=u;if(l||t(),!h||!m)return;const g=Sv(f),p=Sv(a.clientWidth-(d+h)),x=Sv(a.clientHeight-(f+m)),b=Sv(d),v={rootMargin:-g+\"px \"+-p+\"px \"+-x+\"px \"+-b+\"px\",threshold:As(0,Hc(1,c))||1};let S=!0;function w(N){const _=N[0].intersectionRatio;if(_!==c){if(!S)return o();_?o(!1,_):n=setTimeout(()=>{o(!1,1e-7)},1e3)}_===1&&!M9(u,e.getBoundingClientRect())&&o(),S=!1}try{r=new IntersectionObserver(w,{...v,root:a.ownerDocument})}catch{r=new IntersectionObserver(w,v)}r.observe(e)}return o(!0),i}function Jte(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver==\"function\",layoutShift:l=typeof IntersectionObserver==\"function\",animationFrame:c=!1}=n,u=WC(e),d=a||i?[...u?Zp(u):[],...Zp(t)]:[];d.forEach(b=>{a&&b.addEventListener(\"scroll\",r,{passive:!0}),i&&b.addEventListener(\"resize\",r)});const f=u&&l?Qte(u,r):null;let h=-1,m=null;o&&(m=new ResizeObserver(b=>{let[y]=b;y&&y.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=m)==null||v.observe(t)})),r()}),u&&!c&&m.observe(u),m.observe(t));let g,p=c?vd(e):null;c&&x();function x(){const b=vd(e);p&&!M9(p,b)&&r(),p=b,g=requestAnimationFrame(x)}return r(),()=>{var b;d.forEach(y=>{a&&y.removeEventListener(\"scroll\",r),i&&y.removeEventListener(\"resize\",r)}),f==null||f(),(b=m)==null||b.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const ere=Pte,tre=Mte,rre=Ate,nre=Ite,are=Tte,IP=Cte,sre=Dte,ire=(e,t,r)=>{const n=new Map,a={platform:Zte,...r},i={...a.platform,_c:n};return kte(e,t,{...a,platform:i})};var by=typeof document<\"u\"?j.useLayoutEffect:j.useEffect;function s1(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e==\"function\"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e==\"object\"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!s1(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const i=a[n];if(!(i===\"_owner\"&&e.$$typeof)&&!s1(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function D9(e){return typeof window>\"u\"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function FP(e,t){const r=D9(e);return Math.round(t*r)/r}function Aj(e){const t=j.useRef(e);return by(()=>{t.current=e}),t}function ore(e){e===void 0&&(e={});const{placement:t=\"bottom\",strategy:r=\"absolute\",middleware:n=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,f]=j.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=j.useState(n);s1(h,n)||m(n);const[g,p]=j.useState(null),[x,b]=j.useState(null),y=j.useCallback(M=>{M!==N.current&&(N.current=M,p(M))},[]),v=j.useCallback(M=>{M!==_.current&&(_.current=M,b(M))},[]),S=i||g,w=o||x,N=j.useRef(null),_=j.useRef(null),E=j.useRef(d),k=c!=null,O=Aj(c),C=Aj(a),A=Aj(u),D=j.useCallback(()=>{if(!N.current||!_.current)return;const M={placement:t,strategy:r,middleware:h};C.current&&(M.platform=C.current),ire(N.current,_.current,M).then(F=>{const G={...F,isPositioned:A.current!==!1};R.current&&!s1(E.current,G)&&(E.current=G,Xd.flushSync(()=>{f(G)}))})},[h,t,r,C,A]);by(()=>{u===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,f(M=>({...M,isPositioned:!1})))},[u]);const R=j.useRef(!1);by(()=>(R.current=!0,()=>{R.current=!1}),[]),by(()=>{if(S&&(N.current=S),w&&(_.current=w),S&&w){if(O.current)return O.current(S,w,D);D()}},[S,w,D,O,k]);const T=j.useMemo(()=>({reference:N,floating:_,setReference:y,setFloating:v}),[y,v]),L=j.useMemo(()=>({reference:S,floating:w}),[S,w]),I=j.useMemo(()=>{const M={position:r,left:0,top:0};if(!L.floating)return M;const F=FP(L.floating,d.x),G=FP(L.floating,d.y);return l?{...M,transform:\"translate(\"+F+\"px, \"+G+\"px)\",...D9(L.floating)>=1.5&&{willChange:\"transform\"}}:{position:r,left:F,top:G}},[r,l,L.floating,d.x,d.y]);return j.useMemo(()=>({...d,update:D,refs:T,elements:L,floatingStyles:I}),[d,D,T,L,I])}const lre=e=>{function t(r){return{}.hasOwnProperty.call(r,\"current\")}return{name:\"arrow\",options:e,fn(r){const{element:n,padding:a}=typeof e==\"function\"?e(r):e;return n&&t(n)?n.current!=null?IP({element:n.current,padding:a}).fn(r):{}:n?IP({element:n,padding:a}).fn(r):{}}}},cre=(e,t)=>({...ere(e),options:[e,t]}),ure=(e,t)=>({...tre(e),options:[e,t]}),dre=(e,t)=>({...sre(e),options:[e,t]}),fre=(e,t)=>({...rre(e),options:[e,t]}),hre=(e,t)=>({...nre(e),options:[e,t]}),mre=(e,t)=>({...are(e),options:[e,t]}),pre=(e,t)=>({...lre(e),options:[e,t]});var gre=\"Arrow\",I9=j.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...i}=e;return s.jsx(st.svg,{...i,ref:t,width:n,height:a,viewBox:\"0 0 30 10\",preserveAspectRatio:\"none\",children:e.asChild?r:s.jsx(\"polygon\",{points:\"0,0 30,0 15,10\"})})});I9.displayName=gre;var xre=I9;function mw(e){const[t,r]=j.useState(void 0);return On(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if(\"borderBoxSize\"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return n.observe(e,{box:\"border-box\"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var GC=\"Popper\",[F9,uu]=Wn(GC),[vre,R9]=F9(GC),L9=e=>{const{__scopePopper:t,children:r}=e,[n,a]=j.useState(null);return s.jsx(vre,{scope:t,anchor:n,onAnchorChange:a,children:r})};L9.displayName=GC;var $9=\"PopperAnchor\",B9=j.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,i=R9($9,r),o=j.useRef(null),l=Xt(t,o);return j.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||o.current)}),n?null:s.jsx(st.div,{...a,ref:l})});B9.displayName=$9;var KC=\"PopperContent\",[yre,bre]=F9(KC),V9=j.forwardRef((e,t)=>{var X,re,H,se,ve,V;const{__scopePopper:r,side:n=\"bottom\",sideOffset:a=0,align:i=\"center\",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:f=\"partial\",hideWhenDetached:h=!1,updatePositionStrategy:m=\"optimized\",onPlaced:g,...p}=e,x=R9(KC,r),[b,y]=j.useState(null),v=Xt(t,Ke=>y(Ke)),[S,w]=j.useState(null),N=mw(S),_=(N==null?void 0:N.width)??0,E=(N==null?void 0:N.height)??0,k=n+(i!==\"center\"?\"-\"+i:\"\"),O=typeof d==\"number\"?d:{top:0,right:0,bottom:0,left:0,...d},C=Array.isArray(u)?u:[u],A=C.length>0,D={padding:O,boundary:C.filter(jre),altBoundary:A},{refs:R,floatingStyles:T,placement:L,isPositioned:I,middlewareData:M}=ore({strategy:\"fixed\",placement:k,whileElementsMounted:(...Ke)=>Jte(...Ke,{animationFrame:m===\"always\"}),elements:{reference:x.anchor},middleware:[cre({mainAxis:a+E,alignmentAxis:o}),c&&ure({mainAxis:!0,crossAxis:!1,limiter:f===\"partial\"?dre():void 0,...D}),c&&fre({...D}),hre({...D,apply:({elements:Ke,rects:Ce,availableWidth:it,availableHeight:De})=>{const{width:_e,height:_t}=Ce.reference,Z=Ke.floating.style;Z.setProperty(\"--radix-popper-available-width\",`${it}px`),Z.setProperty(\"--radix-popper-available-height\",`${De}px`),Z.setProperty(\"--radix-popper-anchor-width\",`${_e}px`),Z.setProperty(\"--radix-popper-anchor-height\",`${_t}px`)}}),S&&pre({element:S,padding:l}),Nre({arrowWidth:_,arrowHeight:E}),h&&mre({strategy:\"referenceHidden\",...D})]}),[F,G]=W9(L),ae=ma(g);On(()=>{I&&(ae==null||ae())},[I,ae]);const P=(X=M.arrow)==null?void 0:X.x,z=(re=M.arrow)==null?void 0:re.y,B=((H=M.arrow)==null?void 0:H.centerOffset)!==0,[U,ne]=j.useState();return On(()=>{b&&ne(window.getComputedStyle(b).zIndex)},[b]),s.jsx(\"div\",{ref:R.setFloating,\"data-radix-popper-content-wrapper\":\"\",style:{...T,transform:I?T.transform:\"translate(0, -200%)\",minWidth:\"max-content\",zIndex:U,\"--radix-popper-transform-origin\":[(se=M.transformOrigin)==null?void 0:se.x,(ve=M.transformOrigin)==null?void 0:ve.y].join(\" \"),...((V=M.hide)==null?void 0:V.referenceHidden)&&{visibility:\"hidden\",pointerEvents:\"none\"}},dir:e.dir,children:s.jsx(yre,{scope:r,placedSide:F,onArrowChange:w,arrowX:P,arrowY:z,shouldHideArrow:B,children:s.jsx(st.div,{\"data-side\":F,\"data-align\":G,...p,ref:v,style:{...p.style,animation:I?void 0:\"none\"}})})})});V9.displayName=KC;var z9=\"PopperArrow\",wre={top:\"bottom\",right:\"left\",bottom:\"top\",left:\"right\"},U9=j.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,i=bre(z9,n),o=wre[i.placedSide];return s.jsx(\"span\",{ref:i.onArrowChange,style:{position:\"absolute\",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:\"\",right:\"0 0\",bottom:\"center 0\",left:\"100% 0\"}[i.placedSide],transform:{top:\"translateY(100%)\",right:\"translateY(50%) rotate(90deg) translateX(-50%)\",bottom:\"rotate(180deg)\",left:\"translateY(50%) rotate(-90deg) translateX(50%)\"}[i.placedSide],visibility:i.shouldHideArrow?\"hidden\":void 0},children:s.jsx(xre,{...a,ref:r,style:{...a.style,display:\"block\"}})})});U9.displayName=z9;function jre(e){return e!==null}var Nre=e=>({name:\"transformOrigin\",options:e,fn(t){var x,b,y;const{placement:r,rects:n,middlewareData:a}=t,o=((x=a.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[u,d]=W9(r),f={start:\"0%\",center:\"50%\",end:\"100%\"}[d],h=(((b=a.arrow)==null?void 0:b.x)??0)+l/2,m=(((y=a.arrow)==null?void 0:y.y)??0)+c/2;let g=\"\",p=\"\";return u===\"bottom\"?(g=o?f:`${h}px`,p=`${-c}px`):u===\"top\"?(g=o?f:`${h}px`,p=`${n.floating.height+c}px`):u===\"right\"?(g=`${-c}px`,p=o?f:`${m}px`):u===\"left\"&&(g=`${n.floating.width+c}px`,p=o?f:`${m}px`),{data:{x:g,y:p}}}});function W9(e){const[t,r=\"center\"]=e.split(\"-\");return[t,r]}var YC=L9,jx=B9,pw=V9,gw=U9,[xw,VKe]=Wn(\"Tooltip\",[uu]),qC=uu(),H9=\"TooltipProvider\",Sre=700,RP=\"tooltip.open\",[_re,G9]=xw(H9),K9=e=>{const{__scopeTooltip:t,delayDuration:r=Sre,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=e,o=j.useRef(!0),l=j.useRef(!1),c=j.useRef(0);return j.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),s.jsx(_re,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:j.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:j.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:j.useCallback(u=>{l.current=u},[]),disableHoverableContent:a,children:i})};K9.displayName=H9;var Y9=\"Tooltip\",[zKe,vw]=xw(Y9),u_=\"TooltipTrigger\",Ere=j.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=vw(u_,r),i=G9(u_,r),o=qC(r),l=j.useRef(null),c=Xt(t,l,a.onTriggerChange),u=j.useRef(!1),d=j.useRef(!1),f=j.useCallback(()=>u.current=!1,[]);return j.useEffect(()=>()=>document.removeEventListener(\"pointerup\",f),[f]),s.jsx(jx,{asChild:!0,...o,children:s.jsx(st.button,{\"aria-describedby\":a.open?a.contentId:void 0,\"data-state\":a.stateAttribute,...n,ref:c,onPointerMove:We(e.onPointerMove,h=>{h.pointerType!==\"touch\"&&!d.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),d.current=!0)}),onPointerLeave:We(e.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:We(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener(\"pointerup\",f,{once:!0})}),onFocus:We(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:We(e.onBlur,a.onClose),onClick:We(e.onClick,a.onClose)})})});Ere.displayName=u_;var kre=\"TooltipPortal\",[UKe,Cre]=xw(kre,{forceMount:void 0}),Kh=\"TooltipContent\",q9=j.forwardRef((e,t)=>{const r=Cre(Kh,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a=\"top\",...i}=e,o=vw(Kh,e.__scopeTooltip);return s.jsx(Fa,{present:n||o.open,children:o.disableHoverableContent?s.jsx(X9,{side:a,...i,ref:t}):s.jsx(Are,{side:a,...i,ref:t})})}),Are=j.forwardRef((e,t)=>{const r=vw(Kh,e.__scopeTooltip),n=G9(Kh,e.__scopeTooltip),a=j.useRef(null),i=Xt(t,a),[o,l]=j.useState(null),{trigger:c,onClose:u}=r,d=a.current,{onPointerInTransitChange:f}=n,h=j.useCallback(()=>{l(null),f(!1)},[f]),m=j.useCallback((g,p)=>{const x=g.currentTarget,b={x:g.clientX,y:g.clientY},y=Dre(b,x.getBoundingClientRect()),v=Ire(b,y),S=Fre(p.getBoundingClientRect()),w=Lre([...v,...S]);l(w),f(!0)},[f]);return j.useEffect(()=>()=>h(),[h]),j.useEffect(()=>{if(c&&d){const g=x=>m(x,d),p=x=>m(x,c);return c.addEventListener(\"pointerleave\",g),d.addEventListener(\"pointerleave\",p),()=>{c.removeEventListener(\"pointerleave\",g),d.removeEventListener(\"pointerleave\",p)}}},[c,d,m,h]),j.useEffect(()=>{if(o){const g=p=>{const x=p.target,b={x:p.clientX,y:p.clientY},y=(c==null?void 0:c.contains(x))||(d==null?void 0:d.contains(x)),v=!Rre(b,o);y?h():v&&(h(),u())};return document.addEventListener(\"pointermove\",g),()=>document.removeEventListener(\"pointermove\",g)}},[c,d,o,u,h]),s.jsx(X9,{...e,ref:i})}),[Tre,Ore]=xw(Y9,{isInside:!1}),Pre=PL(\"TooltipContent\"),X9=j.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,\"aria-label\":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=vw(Kh,r),u=qC(r),{onClose:d}=c;return j.useEffect(()=>(document.addEventListener(RP,d),()=>document.removeEventListener(RP,d)),[d]),j.useEffect(()=>{if(c.trigger){const f=h=>{const m=h.target;m!=null&&m.contains(c.trigger)&&d()};return window.addEventListener(\"scroll\",f,{capture:!0}),()=>window.removeEventListener(\"scroll\",f,{capture:!0})}},[c.trigger,d]),s.jsx(Zd,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:d,children:s.jsxs(pw,{\"data-state\":c.stateAttribute,...u,...l,ref:t,style:{...l.style,\"--radix-tooltip-content-transform-origin\":\"var(--radix-popper-transform-origin)\",\"--radix-tooltip-content-available-width\":\"var(--radix-popper-available-width)\",\"--radix-tooltip-content-available-height\":\"var(--radix-popper-available-height)\",\"--radix-tooltip-trigger-width\":\"var(--radix-popper-anchor-width)\",\"--radix-tooltip-trigger-height\":\"var(--radix-popper-anchor-height)\"},children:[s.jsx(Pre,{children:n}),s.jsx(Tre,{scope:r,isInside:!0,children:s.jsx(zJ,{id:c.contentId,role:\"tooltip\",children:a||n})})]})})});q9.displayName=Kh;var Z9=\"TooltipArrow\",Mre=j.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=qC(r);return Ore(Z9,r).isInside?null:s.jsx(gw,{...a,...n,ref:t})});Mre.displayName=Z9;function Dre(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,n,a,i)){case i:return\"left\";case a:return\"right\";case r:return\"top\";case n:return\"bottom\";default:throw new Error(\"unreachable\")}}function Ire(e,t,r=5){const n=[];switch(t){case\"top\":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case\"bottom\":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case\"left\":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case\"right\":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function Fre(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function Rre(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,c=t[i].y,u=t[o].x,d=t[o].y;c>n!=d>n&&r<(u-l)*(n-c)/(d-c)+l&&(a=!a)}return a}function Lre(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),$re(t)}function $re(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var Bre=K9,Q9=q9;const Vre=Bre,zre=j.forwardRef(({className:e,sideOffset:t=4,...r},n)=>s.jsx(Q9,{ref:n,sideOffset:t,className:be(\"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",e),...r}));zre.displayName=Q9.displayName;function rf(){const[e,t]=j.useState(()=>typeof window<\"u\"?localStorage.getItem(\"authToken\"):null),[r,n]=j.useState(!1),a=na(),{data:i,isLoading:o,error:l}=fr({queryKey:[\"/api/auth/me\"],enabled:!!e&&!r,retry:!1,staleTime:5*60*1e3,gcTime:10*60*1e3});j.useEffect(()=>{l&&e&&!r&&(console.log(\"Authentication error detected, clearing token\"),n(!0),typeof window<\"u\"&&localStorage.removeItem(\"authToken\"),t(null),a.clear())},[l,e,r,a]),j.useEffect(()=>{e&&r&&n(!1)},[e,r]);const c=zt({mutationFn:async({email:h,password:m})=>(await At(\"POST\",\"/api/auth/login\",{email:h,password:m})).json(),onSuccess:h=>{typeof window<\"u\"&&localStorage.setItem(\"authToken\",h.token),t(h.token),n(!1),a.setQueryData([\"/api/auth/me\"],h.user)}}),u=zt({mutationFn:()=>At(\"POST\",\"/api/auth/logout\"),onSuccess:()=>{typeof window<\"u\"&&localStorage.removeItem(\"authToken\"),t(null),n(!1),a.clear()}}),d=async(h,m)=>{try{const g=await c.mutateAsync({email:h,password:m});return await a.invalidateQueries({queryKey:[\"/api/auth/me\"]}),await a.refetchQueries({queryKey:[\"/api/auth/me\"]}),{success:!0}}catch(g){return{success:!1,message:g.message||\"Inloggen mislukt. Controleer uw gegevens.\"}}},f=()=>{typeof window<\"u\"&&localStorage.removeItem(\"authToken\"),t(null),n(!1),a.clear(),u.mutate(),typeof window<\"u\"&&(window.location.href=\"/login\")};return{user:(i==null?void 0:i.user)||null,loading:o,login:d,logout:f}}var J9={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},LP=Y.createContext&&Y.createContext(J9),Ure=[\"attr\",\"size\",\"title\"];function Wre(e,t){if(e==null)return{};var r=Hre(e,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Hre(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function i1(){return i1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i1.apply(this,arguments)}function $P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$P(Object(r),!0).forEach(function(n){Gre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$P(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gre(e,t,r){return t=Kre(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kre(e){var t=Yre(e,\"string\");return typeof t==\"symbol\"?t:t+\"\"}function Yre(e,t){if(typeof e!=\"object\"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||\"default\");if(typeof n!=\"object\")return n;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(t===\"string\"?String:Number)(e)}function e$(e){return e&&e.map((t,r)=>Y.createElement(t.tag,o1({key:r},t.attr),e$(t.child)))}function gr(e){return t=>Y.createElement(qre,i1({attr:o1({},e.attr)},t),e$(e.child))}function qre(e){var t=r=>{var{attr:n,size:a,title:i}=e,o=Wre(e,Ure),l=a||r.size||\"1em\",c;return r.className&&(c=r.className),e.className&&(c=(c?c+\" \":\"\")+e.className),Y.createElement(\"svg\",i1({stroke:\"currentColor\",fill:\"currentColor\",strokeWidth:\"0\"},r.attr,n,o,{className:c,style:o1(o1({color:e.color||r.color},r.style),e.style),height:l,width:l,xmlns:\"http://www.w3.org/2000/svg\"}),i&&Y.createElement(\"title\",null,i),e.children)};return LP!==void 0?Y.createElement(LP.Consumer,null,r=>t(r)):t(J9)}function Xre(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M12.0049 22.0027C6.48204 22.0027 2.00488 17.5256 2.00488 12.0027C2.00488 6.4799 6.48204 2.00275 12.0049 2.00275C17.5277 2.00275 22.0049 6.4799 22.0049 12.0027C22.0049 17.5256 17.5277 22.0027 12.0049 22.0027ZM12.0049 20.0027C16.4232 20.0027 20.0049 16.421 20.0049 12.0027C20.0049 7.58447 16.4232 4.00275 12.0049 4.00275C7.5866 4.00275 4.00488 7.58447 4.00488 12.0027C4.00488 16.421 7.5866 20.0027 12.0049 20.0027ZM10.0549 11.0027H15.0049V13.0027H10.0549C10.2865 14.1439 11.2954 15.0027 12.5049 15.0027C13.1201 15.0027 13.6833 14.7806 14.1188 14.412L15.8198 15.546C14.9973 16.4415 13.8166 17.0027 12.5049 17.0027C10.1886 17.0027 8.28107 15.2527 8.03235 13.0027H7.00488V11.0027H8.03235C8.28107 8.75277 10.1886 7.00275 12.5049 7.00275C13.8166 7.00275 14.9973 7.56402 15.8198 8.45951L14.1189 9.59351C13.6834 9.22496 13.1201 9.00275 12.5049 9.00275C11.2954 9.00275 10.2865 9.86163 10.0549 11.0027Z\"},child:[]}]})(e)}function Zre(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M6.99979 7V3C6.99979 2.44772 7.4475 2 7.99979 2H20.9998C21.5521 2 21.9998 2.44772 21.9998 3V16C21.9998 16.5523 21.5521 17 20.9998 17H17V20.9925C17 21.5489 16.551 22 15.9925 22H3.00728C2.45086 22 2 21.5511 2 20.9925L2.00276 8.00748C2.00288 7.45107 2.4518 7 3.01025 7H6.99979ZM8.99979 7H15.9927C16.549 7 17 7.44892 17 8.00748V15H19.9998V4H8.99979V7ZM15 9H4.00255L4.00021 20H15V9ZM8.50242 18L4.96689 14.4645L6.3811 13.0503L8.50242 15.1716L12.7451 10.9289L14.1593 12.3431L8.50242 18Z\"},child:[]}]})(e)}function t$(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M22 12C22 17.5228 17.5229 22 12 22C6.4772 22 2 17.5228 2 12C2 6.47715 6.4772 2 12 2V4C7.5817 4 4 7.58172 4 12C4 16.4183 7.5817 20 12 20C16.4183 20 20 16.4183 20 12C20 9.53614 18.8862 7.33243 17.1346 5.86492L15 8V2L21 2L18.5535 4.44656C20.6649 6.28002 22 8.9841 22 12Z\"},child:[]}]})(e)}function Qre(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M2 11.9998C2 11.1353 2.1097 10.2964 2.31595 9.49631C3.40622 9.55283 4.48848 9.01015 5.0718 7.99982C5.65467 6.99025 5.58406 5.78271 4.99121 4.86701C6.18354 3.69529 7.66832 2.82022 9.32603 2.36133C9.8222 3.33385 10.8333 3.99982 12 3.99982C13.1667 3.99982 14.1778 3.33385 14.674 2.36133C16.3317 2.82022 17.8165 3.69529 19.0088 4.86701C18.4159 5.78271 18.3453 6.99025 18.9282 7.99982C19.5115 9.01015 20.5938 9.55283 21.6841 9.49631C21.8903 10.2964 22 11.1353 22 11.9998C22 12.8643 21.8903 13.7032 21.6841 14.5033C20.5938 14.4468 19.5115 14.9895 18.9282 15.9998C18.3453 17.0094 18.4159 18.2169 19.0088 19.1326C17.8165 20.3043 16.3317 21.1794 14.674 21.6383C14.1778 20.6658 13.1667 19.9998 12 19.9998C10.8333 19.9998 9.8222 20.6658 9.32603 21.6383C7.66832 21.1794 6.18354 20.3043 4.99121 19.1326C5.58406 18.2169 5.65467 17.0094 5.0718 15.9998C4.48848 14.9895 3.40622 14.4468 2.31595 14.5033C2.1097 13.7032 2 12.8643 2 11.9998ZM6.80385 14.9998C7.43395 16.0912 7.61458 17.3459 7.36818 18.5236C7.77597 18.8138 8.21005 19.0652 8.66489 19.2741C9.56176 18.4712 10.7392 17.9998 12 17.9998C13.2608 17.9998 14.4382 18.4712 15.3351 19.2741C15.7899 19.0652 16.224 18.8138 16.6318 18.5236C16.3854 17.3459 16.566 16.0912 17.1962 14.9998C17.8262 13.9085 18.8225 13.1248 19.9655 12.7493C19.9884 12.5015 20 12.2516 20 11.9998C20 11.7481 19.9884 11.4981 19.9655 11.2504C18.8225 10.8749 17.8262 10.0912 17.1962 8.99982C16.566 7.90845 16.3854 6.65378 16.6318 5.47605C16.224 5.18588 15.7899 4.93447 15.3351 4.72552C14.4382 5.52844 13.2608 5.99982 12 5.99982C10.7392 5.99982 9.56176 5.52844 8.66489 4.72552C8.21005 4.93447 7.77597 5.18588 7.36818 5.47605C7.61458 6.65378 7.43395 7.90845 6.80385 8.99982C6.17376 10.0912 5.17754 10.8749 4.03451 11.2504C4.01157 11.4981 4 11.7481 4 11.9998C4 12.2516 4.01157 12.5015 4.03451 12.7493C5.17754 13.1248 6.17376 13.9085 6.80385 14.9998ZM12 14.9998C10.3431 14.9998 9 13.6567 9 11.9998C9 10.343 10.3431 8.99982 12 8.99982C13.6569 8.99982 15 10.343 15 11.9998C15 13.6567 13.6569 14.9998 12 14.9998ZM12 12.9998C12.5523 12.9998 13 12.5521 13 11.9998C13 11.4475 12.5523 10.9998 12 10.9998C11.4477 10.9998 11 11.4475 11 11.9998C11 12.5521 11.4477 12.9998 12 12.9998Z\"},child:[]}]})(e)}function Jre(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M12 14V16C8.68629 16 6 18.6863 6 22H4C4 17.5817 7.58172 14 12 14ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11ZM21 17H22V22H14V17H15V16C15 14.3431 16.3431 13 18 13C19.6569 13 21 14.3431 21 16V17ZM19 17V16C19 15.4477 18.5523 15 18 15C17.4477 15 17 15.4477 17 16V17H19Z\"},child:[]}]})(e)}function ene(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 24 24\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M12 14V16C8.68629 16 6 18.6863 6 22H4C4 17.5817 7.58172 14 12 14ZM12 13C8.685 13 6 10.315 6 7C6 3.685 8.685 1 12 1C15.315 1 18 3.685 18 7C18 10.315 15.315 13 12 13ZM12 11C14.21 11 16 9.21 16 7C16 4.79 14.21 3 12 3C9.79 3 8 4.79 8 7C8 9.21 9.79 11 12 11ZM18 21.5L15.0611 23.0451L15.6224 19.7725L13.2447 17.4549L16.5305 16.9775L18 14L19.4695 16.9775L22.7553 17.4549L20.3776 19.7725L20.9389 23.0451L18 21.5Z\"},child:[]}]})(e)}function tne(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 256 256\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M128.09,57.38a36,36,0,0,1,55.17-27.82,4,4,0,0,1-.56,7A52.06,52.06,0,0,0,152,84c0,1.17,0,2.34.12,3.49a4,4,0,0,1-6,3.76A36,36,0,0,1,128.09,57.38ZM240,160.61a24.47,24.47,0,0,1-13.6,22l-.44.2-38.83,16.54a6.94,6.94,0,0,1-1.19.4l-64,16A7.93,7.93,0,0,1,120,216H16A16,16,0,0,1,0,200V160a16,16,0,0,1,16-16H44.69l22.62-22.63A31.82,31.82,0,0,1,89.94,112H140a28,28,0,0,1,27.25,34.45l41.84-9.62A24.61,24.61,0,0,1,240,160.61Zm-16,0a8.61,8.61,0,0,0-10.87-8.3l-.31.08-67,15.41a8.32,8.32,0,0,1-1.79.2H112a8,8,0,0,1,0-16h28a12,12,0,0,0,0-24H89.94a15.86,15.86,0,0,0-11.31,4.69L56,155.31V200h63l62.43-15.61,38-16.18A8.56,8.56,0,0,0,224,160.61ZM168,84a36,36,0,1,0,36-36A36,36,0,0,0,168,84Z\"},child:[]}]})(e)}function rne(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 256 256\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M221.68,106.08a6,6,0,0,0-4.92,6.91A91.66,91.66,0,0,1,218,128a89.65,89.65,0,0,1-24.49,61.64,77.53,77.53,0,0,0-40-31.38,46,46,0,1,0-51,0,77.53,77.53,0,0,0-40,31.38A89.95,89.95,0,0,1,128,38a91.57,91.57,0,0,1,15,1.24,6,6,0,1,0,2-11.83,101.9,101.9,0,1,0,83.6,83.6A6,6,0,0,0,221.68,106.08ZM94,120a34,34,0,1,1,34,34A34,34,0,0,1,94,120ZM71.44,198a66,66,0,0,1,113.12,0,89.8,89.8,0,0,1-113.12,0ZM236.24,44.24l-32,32a6,6,0,0,1-8.48,0l-16-16a6,6,0,0,1,8.48-8.48L200,63.51l27.76-27.75a6,6,0,0,1,8.48,8.48Z\"},child:[]}]})(e)}function nne(e){return gr({tag:\"svg\",attr:{viewBox:\"0 0 256 256\",fill:\"currentColor\"},child:[{tag:\"path\",attr:{d:\"M220.17,100,202.86,70a28,28,0,0,0-38.24-10.25,27.69,27.69,0,0,0-9,8.34L138.2,38a28,28,0,0,0-48.48,0A28,28,0,0,0,48.15,74l1.59,2.76A27.67,27.67,0,0,0,38,80.41a28,28,0,0,0-10.24,38.25l40,69.32a87.47,87.47,0,0,0,53.43,41,88.56,88.56,0,0,0,22.92,3,88,88,0,0,0,76.06-132Zm-6.66,62.64A72,72,0,0,1,81.62,180l-40-69.32a12,12,0,0,1,20.78-12L81.63,132a8,8,0,1,0,13.85-8L62,66A12,12,0,1,1,82.78,54L114,108a8,8,0,1,0,13.85-8L103.57,58h0a12,12,0,1,1,20.78-12l33.42,57.9a48,48,0,0,0-5.54,60.6,8,8,0,0,0,13.24-9A32,32,0,0,1,172.78,112a8,8,0,0,0,2.13-10.4L168.23,90A12,12,0,1,1,189,78l17.31,30A71.56,71.56,0,0,1,213.51,162.62ZM184.25,31.71A8,8,0,0,1,194,26a59.62,59.62,0,0,1,36.53,28l.33.57a8,8,0,1,1-13.85,8l-.33-.57a43.67,43.67,0,0,0-26.8-20.5A8,8,0,0,1,184.25,31.71ZM80.89,237a8,8,0,0,1-11.23,1.33A119.56,119.56,0,0,1,40.06,204a8,8,0,0,1,13.86-8,103.67,103.67,0,0,0,25.64,29.72A8,8,0,0,1,80.89,237Z\"},child:[]}]})(e)}const ane=\"/assets/DARAH_1756909309495-CMxPAN7W.png\",Qp=$0(\"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-medium ring-offset-background transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 btn-hover\",{variants:{variant:{default:\"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm\",destructive:\"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm\",outline:\"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",secondary:\"bg-secondary text-secondary-foreground hover:bg-secondary/80 shadow-sm\",ghost:\"hover:bg-accent hover:text-accent-foreground\",link:\"text-primary underline-offset-4 hover:underline hover:no-underline\"},size:{default:\"h-10 px-4 py-2\",sm:\"h-9 px-3\",lg:\"h-12 px-6\",icon:\"h-10 w-10\"}},defaultVariants:{variant:\"default\",size:\"default\"}}),ce=j.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},i)=>{const o=n?TL:\"button\";return s.jsx(o,{className:be(Qp({variant:t,size:r,className:e})),ref:i,...a})});ce.displayName=\"Button\";var sne=j.createContext(void 0);function Nx(e){const t=j.useContext(sne);return e||t||\"ltr\"}var Tj=0;function yw(){j.useEffect(()=>{const e=document.querySelectorAll(\"[data-radix-focus-guard]\");return document.body.insertAdjacentElement(\"afterbegin\",e[0]??BP()),document.body.insertAdjacentElement(\"beforeend\",e[1]??BP()),Tj++,()=>{Tj===1&&document.querySelectorAll(\"[data-radix-focus-guard]\").forEach(t=>t.remove()),Tj--}},[])}function BP(){const e=document.createElement(\"span\");return e.setAttribute(\"data-radix-focus-guard\",\"\"),e.tabIndex=0,e.style.outline=\"none\",e.style.opacity=\"0\",e.style.position=\"fixed\",e.style.pointerEvents=\"none\",e}var Oj=\"focusScope.autoFocusOnMount\",Pj=\"focusScope.autoFocusOnUnmount\",VP={bubbles:!1,cancelable:!0},ine=\"FocusScope\",Sx=j.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=e,[l,c]=j.useState(null),u=ma(a),d=ma(i),f=j.useRef(null),h=Xt(t,p=>c(p)),m=j.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;j.useEffect(()=>{if(n){let p=function(v){if(m.paused||!l)return;const S=v.target;l.contains(S)?f.current=S:ic(f.current,{select:!0})},x=function(v){if(m.paused||!l)return;const S=v.relatedTarget;S!==null&&(l.contains(S)||ic(f.current,{select:!0}))},b=function(v){if(document.activeElement===document.body)for(const w of v)w.removedNodes.length>0&&ic(l)};document.addEventListener(\"focusin\",p),document.addEventListener(\"focusout\",x);const y=new MutationObserver(b);return l&&y.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener(\"focusin\",p),document.removeEventListener(\"focusout\",x),y.disconnect()}}},[n,l,m.paused]),j.useEffect(()=>{if(l){UP.add(m);const p=document.activeElement;if(!l.contains(p)){const b=new CustomEvent(Oj,VP);l.addEventListener(Oj,u),l.dispatchEvent(b),b.defaultPrevented||(one(fne(r$(l)),{select:!0}),document.activeElement===p&&ic(l))}return()=>{l.removeEventListener(Oj,u),setTimeout(()=>{const b=new CustomEvent(Pj,VP);l.addEventListener(Pj,d),l.dispatchEvent(b),b.defaultPrevented||ic(p??document.body,{select:!0}),l.removeEventListener(Pj,d),UP.remove(m)},0)}}},[l,u,d,m]);const g=j.useCallback(p=>{if(!r&&!n||m.paused)return;const x=p.key===\"Tab\"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,b=document.activeElement;if(x&&b){const y=p.currentTarget,[v,S]=lne(y);v&&S?!p.shiftKey&&b===S?(p.preventDefault(),r&&ic(v,{select:!0})):p.shiftKey&&b===v&&(p.preventDefault(),r&&ic(S,{select:!0})):b===y&&p.preventDefault()}},[r,n,m.paused]);return s.jsx(st.div,{tabIndex:-1,...o,ref:h,onKeyDown:g})});Sx.displayName=ine;function one(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ic(n,{select:t}),document.activeElement!==r)return}function lne(e){const t=r$(e),r=zP(t,e),n=zP(t.reverse(),e);return[r,n]}function r$(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName===\"INPUT\"&&n.type===\"hidden\";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function zP(e,t){for(const r of e)if(!cne(r,{upTo:t}))return r}function cne(e,{upTo:t}){if(getComputedStyle(e).visibility===\"hidden\")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display===\"none\")return!0;e=e.parentElement}return!1}function une(e){return e instanceof HTMLInputElement&&\"select\"in e}function ic(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&une(e)&&t&&e.select()}}var UP=dne();function dne(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=WP(e,t),e.unshift(t)},remove(t){var r;e=WP(e,t),(r=e[0])==null||r.resume()}}}function WP(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function fne(e){return e.filter(t=>t.tagName!==\"A\")}var Mj=\"rovingFocusGroup.onEntryFocus\",hne={bubbles:!1,cancelable:!0},bw=\"RovingFocusGroup\",[d_,n$,mne]=iw(bw),[pne,W0]=Wn(bw,[mne]),[gne,xne]=pne(bw),a$=j.forwardRef((e,t)=>s.jsx(d_.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(d_.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(vne,{...e,ref:t})})}));a$.displayName=bw;var vne=j.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=e,h=j.useRef(null),m=Xt(t,h),g=Nx(i),[p=null,x]=gi({prop:o,defaultProp:l,onChange:c}),[b,y]=j.useState(!1),v=ma(u),S=n$(r),w=j.useRef(!1),[N,_]=j.useState(0);return j.useEffect(()=>{const E=h.current;if(E)return E.addEventListener(Mj,v),()=>E.removeEventListener(Mj,v)},[v]),s.jsx(gne,{scope:r,orientation:n,dir:g,loop:a,currentTabStopId:p,onItemFocus:j.useCallback(E=>x(E),[x]),onItemShiftTab:j.useCallback(()=>y(!0),[]),onFocusableItemAdd:j.useCallback(()=>_(E=>E+1),[]),onFocusableItemRemove:j.useCallback(()=>_(E=>E-1),[]),children:s.jsx(st.div,{tabIndex:b||N===0?-1:0,\"data-orientation\":n,...f,ref:m,style:{outline:\"none\",...e.style},onMouseDown:We(e.onMouseDown,()=>{w.current=!0}),onFocus:We(e.onFocus,E=>{const k=!w.current;if(E.target===E.currentTarget&&k&&!b){const O=new CustomEvent(Mj,hne);if(E.currentTarget.dispatchEvent(O),!O.defaultPrevented){const C=S().filter(L=>L.focusable),A=C.find(L=>L.active),D=C.find(L=>L.id===p),T=[A,D,...C].filter(Boolean).map(L=>L.ref.current);o$(T,d)}}w.current=!1}),onBlur:We(e.onBlur,()=>y(!1))})})}),s$=\"RovingFocusGroupItem\",i$=j.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:i,...o}=e,l=ra(),c=i||l,u=xne(s$,r),d=u.currentTabStopId===c,f=n$(r),{onFocusableItemAdd:h,onFocusableItemRemove:m}=u;return j.useEffect(()=>{if(n)return h(),()=>m()},[n,h,m]),s.jsx(d_.ItemSlot,{scope:r,id:c,focusable:n,active:a,children:s.jsx(st.span,{tabIndex:d?0:-1,\"data-orientation\":u.orientation,...o,ref:t,onMouseDown:We(e.onMouseDown,g=>{n?u.onItemFocus(c):g.preventDefault()}),onFocus:We(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:We(e.onKeyDown,g=>{if(g.key===\"Tab\"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const p=wne(g,u.orientation,u.dir);if(p!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let b=f().filter(y=>y.focusable).map(y=>y.ref.current);if(p===\"last\")b.reverse();else if(p===\"prev\"||p===\"next\"){p===\"prev\"&&b.reverse();const y=b.indexOf(g.currentTarget);b=u.loop?jne(b,y+1):b.slice(y+1)}setTimeout(()=>o$(b))}})})})});i$.displayName=s$;var yne={ArrowLeft:\"prev\",ArrowUp:\"prev\",ArrowRight:\"next\",ArrowDown:\"next\",PageUp:\"first\",Home:\"first\",PageDown:\"last\",End:\"last\"};function bne(e,t){return t!==\"rtl\"?e:e===\"ArrowLeft\"?\"ArrowRight\":e===\"ArrowRight\"?\"ArrowLeft\":e}function wne(e,t,r){const n=bne(e.key,r);if(!(t===\"vertical\"&&[\"ArrowLeft\",\"ArrowRight\"].includes(n))&&!(t===\"horizontal\"&&[\"ArrowUp\",\"ArrowDown\"].includes(n)))return yne[n]}function o$(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function jne(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var XC=a$,ZC=i$,Nne=function(e){if(typeof document>\"u\")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},bf=new WeakMap,_v=new WeakMap,Ev={},Dj=0,l$=function(e){return e&&(e.host||l$(e.parentNode))},Sne=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=l$(r);return n&&e.contains(n)?n:(console.error(\"aria-hidden\",r,\"in not contained inside\",e,\". Doing nothing\"),null)}).filter(function(r){return!!r})},_ne=function(e,t,r,n){var a=Sne(t,Array.isArray(e)?e:[e]);Ev[r]||(Ev[r]=new WeakMap);var i=Ev[r],o=[],l=new Set,c=new Set(a),u=function(f){!f||l.has(f)||(l.add(f),u(f.parentNode))};a.forEach(u);var d=function(f){!f||c.has(f)||Array.prototype.forEach.call(f.children,function(h){if(l.has(h))d(h);else try{var m=h.getAttribute(n),g=m!==null&&m!==\"false\",p=(bf.get(h)||0)+1,x=(i.get(h)||0)+1;bf.set(h,p),i.set(h,x),o.push(h),p===1&&g&&_v.set(h,!0),x===1&&h.setAttribute(r,\"true\"),g||h.setAttribute(n,\"true\")}catch(b){console.error(\"aria-hidden: cannot operate on \",h,b)}})};return d(t),l.clear(),Dj++,function(){o.forEach(function(f){var h=bf.get(f)-1,m=i.get(f)-1;bf.set(f,h),i.set(f,m),h||(_v.has(f)||f.removeAttribute(n),_v.delete(f)),m||f.removeAttribute(r)}),Dj--,Dj||(bf=new WeakMap,bf=new WeakMap,_v=new WeakMap,Ev={})}},ww=function(e,t,r){r===void 0&&(r=\"data-aria-hidden\");var n=Array.from(Array.isArray(e)?e:[e]),a=Nne(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll(\"[aria-live]\"))),_ne(n,a,r,\"aria-hidden\")):function(){return null}},ko=function(){return ko=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},ko.apply(this,arguments)};function c$(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols==\"function\")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function Ene(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,i;n<a;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))}var wy=\"right-scroll-bar-position\",jy=\"width-before-scroll-bar\",kne=\"with-scroll-bars-hidden\",Cne=\"--removed-body-scroll-bar-size\";function Ij(e,t){return typeof e==\"function\"?e(t):e&&(e.current=t),e}function Ane(e,t){var r=j.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var Tne=typeof window<\"u\"?j.useLayoutEffect:j.useEffect,HP=new WeakMap;function One(e,t){var r=Ane(null,function(n){return e.forEach(function(a){return Ij(a,n)})});return Tne(function(){var n=HP.get(r);if(n){var a=new Set(n),i=new Set(e),o=r.current;a.forEach(function(l){i.has(l)||Ij(l,null)}),i.forEach(function(l){a.has(l)||Ij(l,o)})}HP.set(r,e)},[e]),r}function Pne(e){return e}function Mne(e,t){t===void 0&&(t=Pne);var r=[],n=!1,a={read:function(){if(n)throw new Error(\"Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.\");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,n);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),r}}}};return a}function Dne(e){e===void 0&&(e={});var t=Mne(null);return t.options=ko({async:!0,ssr:!1},e),t}var u$=function(e){var t=e.sideCar,r=c$(e,[\"sideCar\"]);if(!t)throw new Error(\"Sidecar: please provide `sideCar` property to import the right car\");var n=t.read();if(!n)throw new Error(\"Sidecar medium not found\");return j.createElement(n,ko({},r))};u$.isSideCarExport=!0;function Ine(e,t){return e.useMedium(t),u$}var d$=Dne(),Fj=function(){},jw=j.forwardRef(function(e,t){var r=j.useRef(null),n=j.useState({onScrollCapture:Fj,onWheelCapture:Fj,onTouchMoveCapture:Fj}),a=n[0],i=n[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,f=e.shards,h=e.sideCar,m=e.noIsolation,g=e.inert,p=e.allowPinchZoom,x=e.as,b=x===void 0?\"div\":x,y=e.gapMode,v=c$(e,[\"forwardProps\",\"children\",\"className\",\"removeScrollBar\",\"enabled\",\"shards\",\"sideCar\",\"noIsolation\",\"inert\",\"allowPinchZoom\",\"as\",\"gapMode\"]),S=h,w=One([r,t]),N=ko(ko({},v),a);return j.createElement(j.Fragment,null,d&&j.createElement(S,{sideCar:d$,removeScrollBar:u,shards:f,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!p,lockRef:r,gapMode:y}),o?j.cloneElement(j.Children.only(l),ko(ko({},N),{ref:w})):j.createElement(b,ko({},N,{className:c,ref:w}),l))});jw.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};jw.classNames={fullWidth:jy,zeroRight:wy};var Fne=function(){if(typeof __webpack_nonce__<\"u\")return __webpack_nonce__};function Rne(){if(!document)return null;var e=document.createElement(\"style\");e.type=\"text/css\";var t=Fne();return t&&e.setAttribute(\"nonce\",t),e}function Lne(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function $ne(e){var t=document.head||document.getElementsByTagName(\"head\")[0];t.appendChild(e)}var Bne=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Rne())&&(Lne(t,r),$ne(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Vne=function(){var e=Bne();return function(t,r){j.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},f$=function(){var e=Vne(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},zne={left:0,top:0,right:0,gap:0},Rj=function(e){return parseInt(e||\"\",10)||0},Une=function(e){var t=window.getComputedStyle(document.body),r=t[e===\"padding\"?\"paddingLeft\":\"marginLeft\"],n=t[e===\"padding\"?\"paddingTop\":\"marginTop\"],a=t[e===\"padding\"?\"paddingRight\":\"marginRight\"];return[Rj(r),Rj(n),Rj(a)]},Wne=function(e){if(e===void 0&&(e=\"margin\"),typeof window>\"u\")return zne;var t=Une(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},Hne=f$(),fh=\"data-scroll-locked\",Gne=function(e,t,r,n){var a=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r=\"margin\"),`\n  .`.concat(kne,` {\n   overflow: hidden `).concat(n,`;\n   padding-right: `).concat(l,\"px \").concat(n,`;\n  }\n  body[`).concat(fh,`] {\n    overflow: hidden `).concat(n,`;\n    overscroll-behavior: contain;\n    `).concat([t&&\"position: relative \".concat(n,\";\"),r===\"margin\"&&`\n    padding-left: `.concat(a,`px;\n    padding-top: `).concat(i,`px;\n    padding-right: `).concat(o,`px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: `).concat(l,\"px \").concat(n,`;\n    `),r===\"padding\"&&\"padding-right: \".concat(l,\"px \").concat(n,\";\")].filter(Boolean).join(\"\"),`\n  }\n  \n  .`).concat(wy,` {\n    right: `).concat(l,\"px \").concat(n,`;\n  }\n  \n  .`).concat(jy,` {\n    margin-right: `).concat(l,\"px \").concat(n,`;\n  }\n  \n  .`).concat(wy,\" .\").concat(wy,` {\n    right: 0 `).concat(n,`;\n  }\n  \n  .`).concat(jy,\" .\").concat(jy,` {\n    margin-right: 0 `).concat(n,`;\n  }\n  \n  body[`).concat(fh,`] {\n    `).concat(Cne,\": \").concat(l,`px;\n  }\n`)},GP=function(){var e=parseInt(document.body.getAttribute(fh)||\"0\",10);return isFinite(e)?e:0},Kne=function(){j.useEffect(function(){return document.body.setAttribute(fh,(GP()+1).toString()),function(){var e=GP()-1;e<=0?document.body.removeAttribute(fh):document.body.setAttribute(fh,e.toString())}},[])},Yne=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?\"margin\":n;Kne();var i=j.useMemo(function(){return Wne(a)},[a]);return j.createElement(Hne,{styles:Gne(i,!t,a,r?\"\":\"!important\")})},f_=!1;if(typeof window<\"u\")try{var kv=Object.defineProperty({},\"passive\",{get:function(){return f_=!0,!0}});window.addEventListener(\"test\",kv,kv),window.removeEventListener(\"test\",kv,kv)}catch{f_=!1}var wf=f_?{passive:!1}:!1,qne=function(e){return e.tagName===\"TEXTAREA\"},h$=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!==\"hidden\"&&!(r.overflowY===r.overflowX&&!qne(e)&&r[t]===\"visible\")},Xne=function(e){return h$(e,\"overflowY\")},Zne=function(e){return h$(e,\"overflowX\")},KP=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<\"u\"&&n instanceof ShadowRoot&&(n=n.host);var a=m$(e,n);if(a){var i=p$(e,n),o=i[1],l=i[2];if(o>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Qne=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Jne=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},m$=function(e,t){return e===\"v\"?Xne(t):Zne(t)},p$=function(e,t){return e===\"v\"?Qne(t):Jne(t)},eae=function(e,t){return e===\"h\"&&t===\"rtl\"?-1:1},tae=function(e,t,r,n,a){var i=eae(e,window.getComputedStyle(t).direction),o=i*n,l=r.target,c=t.contains(l),u=!1,d=o>0,f=0,h=0;do{var m=p$(e,l),g=m[0],p=m[1],x=m[2],b=p-x-i*g;(g||b)&&m$(e,l)&&(f+=b,h+=g),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&(Math.abs(f)<1||!a)||!d&&(Math.abs(h)<1||!a))&&(u=!0),u},Cv=function(e){return\"changedTouches\"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},YP=function(e){return[e.deltaX,e.deltaY]},qP=function(e){return e&&\"current\"in e?e.current:e},rae=function(e,t){return e[0]===t[0]&&e[1]===t[1]},nae=function(e){return`\n  .block-interactivity-`.concat(e,` {pointer-events: none;}\n  .allow-interactivity-`).concat(e,` {pointer-events: all;}\n`)},aae=0,jf=[];function sae(e){var t=j.useRef([]),r=j.useRef([0,0]),n=j.useRef(),a=j.useState(aae++)[0],i=j.useState(f$)[0],o=j.useRef(e);j.useEffect(function(){o.current=e},[e]),j.useEffect(function(){if(e.inert){document.body.classList.add(\"block-interactivity-\".concat(a));var p=Ene([e.lockRef.current],(e.shards||[]).map(qP),!0).filter(Boolean);return p.forEach(function(x){return x.classList.add(\"allow-interactivity-\".concat(a))}),function(){document.body.classList.remove(\"block-interactivity-\".concat(a)),p.forEach(function(x){return x.classList.remove(\"allow-interactivity-\".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=j.useCallback(function(p,x){if(\"touches\"in p&&p.touches.length===2||p.type===\"wheel\"&&p.ctrlKey)return!o.current.allowPinchZoom;var b=Cv(p),y=r.current,v=\"deltaX\"in p?p.deltaX:y[0]-b[0],S=\"deltaY\"in p?p.deltaY:y[1]-b[1],w,N=p.target,_=Math.abs(v)>Math.abs(S)?\"h\":\"v\";if(\"touches\"in p&&_===\"h\"&&N.type===\"range\")return!1;var E=KP(_,N);if(!E)return!0;if(E?w=_:(w=_===\"v\"?\"h\":\"v\",E=KP(_,N)),!E)return!1;if(!n.current&&\"changedTouches\"in p&&(v||S)&&(n.current=w),!w)return!0;var k=n.current||w;return tae(k,x,p,k===\"h\"?v:S,!0)},[]),c=j.useCallback(function(p){var x=p;if(!(!jf.length||jf[jf.length-1]!==i)){var b=\"deltaY\"in x?YP(x):Cv(x),y=t.current.filter(function(w){return w.name===x.type&&(w.target===x.target||x.target===w.shadowParent)&&rae(w.delta,b)})[0];if(y&&y.should){x.cancelable&&x.preventDefault();return}if(!y){var v=(o.current.shards||[]).map(qP).filter(Boolean).filter(function(w){return w.contains(x.target)}),S=v.length>0?l(x,v[0]):!o.current.noIsolation;S&&x.cancelable&&x.preventDefault()}}},[]),u=j.useCallback(function(p,x,b,y){var v={name:p,delta:x,target:b,should:y,shadowParent:iae(b)};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(S){return S!==v})},1)},[]),d=j.useCallback(function(p){r.current=Cv(p),n.current=void 0},[]),f=j.useCallback(function(p){u(p.type,YP(p),p.target,l(p,e.lockRef.current))},[]),h=j.useCallback(function(p){u(p.type,Cv(p),p.target,l(p,e.lockRef.current))},[]);j.useEffect(function(){return jf.push(i),e.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener(\"wheel\",c,wf),document.addEventListener(\"touchmove\",c,wf),document.addEventListener(\"touchstart\",d,wf),function(){jf=jf.filter(function(p){return p!==i}),document.removeEventListener(\"wheel\",c,wf),document.removeEventListener(\"touchmove\",c,wf),document.removeEventListener(\"touchstart\",d,wf)}},[]);var m=e.removeScrollBar,g=e.inert;return j.createElement(j.Fragment,null,g?j.createElement(i,{styles:nae(a)}):null,m?j.createElement(Yne,{gapMode:e.gapMode}):null)}function iae(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const oae=Ine(d$,sae);var _x=j.forwardRef(function(e,t){return j.createElement(jw,ko({},e,{ref:t,sideCar:oae}))});_x.classNames=jw.classNames;var h_=[\"Enter\",\" \"],lae=[\"ArrowDown\",\"PageUp\",\"Home\"],g$=[\"ArrowUp\",\"PageDown\",\"End\"],cae=[...lae,...g$],uae={ltr:[...h_,\"ArrowRight\"],rtl:[...h_,\"ArrowLeft\"]},dae={ltr:[\"ArrowLeft\"],rtl:[\"ArrowRight\"]},Ex=\"Menu\",[Jp,fae,hae]=iw(Ex),[nf,x$]=Wn(Ex,[hae,uu,W0]),Nw=uu(),v$=W0(),[mae,af]=nf(Ex),[pae,kx]=nf(Ex),y$=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:a,onOpenChange:i,modal:o=!0}=e,l=Nw(t),[c,u]=j.useState(null),d=j.useRef(!1),f=ma(i),h=Nx(a);return j.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener(\"pointerdown\",g,{capture:!0,once:!0}),document.addEventListener(\"pointermove\",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener(\"keydown\",m,{capture:!0}),()=>{document.removeEventListener(\"keydown\",m,{capture:!0}),document.removeEventListener(\"pointerdown\",g,{capture:!0}),document.removeEventListener(\"pointermove\",g,{capture:!0})}},[]),s.jsx(YC,{...l,children:s.jsx(mae,{scope:t,open:r,onOpenChange:f,content:c,onContentChange:u,children:s.jsx(pae,{scope:t,onClose:j.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:h,modal:o,children:n})})})};y$.displayName=Ex;var gae=\"MenuAnchor\",QC=j.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=Nw(r);return s.jsx(jx,{...a,...n,ref:t})});QC.displayName=gae;var JC=\"MenuPortal\",[xae,b$]=nf(JC,{forceMount:void 0}),w$=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:a}=e,i=af(JC,t);return s.jsx(xae,{scope:t,forceMount:r,children:s.jsx(Fa,{present:r||i.open,children:s.jsx(L0,{asChild:!0,container:a,children:n})})})};w$.displayName=JC;var di=\"MenuContent\",[vae,e4]=nf(di),j$=j.forwardRef((e,t)=>{const r=b$(di,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=af(di,e.__scopeMenu),o=kx(di,e.__scopeMenu);return s.jsx(Jp.Provider,{scope:e.__scopeMenu,children:s.jsx(Fa,{present:n||i.open,children:s.jsx(Jp.Slot,{scope:e.__scopeMenu,children:o.modal?s.jsx(yae,{...a,ref:t}):s.jsx(bae,{...a,ref:t})})})})}),yae=j.forwardRef((e,t)=>{const r=af(di,e.__scopeMenu),n=j.useRef(null),a=Xt(t,n);return j.useEffect(()=>{const i=n.current;if(i)return ww(i)},[]),s.jsx(t4,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:We(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),bae=j.forwardRef((e,t)=>{const r=af(di,e.__scopeMenu);return s.jsx(t4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),wae=Wc(\"MenuContent.ScrollLock\"),t4=j.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:m,disableOutsideScroll:g,...p}=e,x=af(di,r),b=kx(di,r),y=Nw(r),v=v$(r),S=fae(r),[w,N]=j.useState(null),_=j.useRef(null),E=Xt(t,_,x.onContentChange),k=j.useRef(0),O=j.useRef(\"\"),C=j.useRef(0),A=j.useRef(null),D=j.useRef(\"right\"),R=j.useRef(0),T=g?_x:j.Fragment,L=g?{as:wae,allowPinchZoom:!0}:void 0,I=F=>{var X,re;const G=O.current+F,ae=S().filter(H=>!H.disabled),P=document.activeElement,z=(X=ae.find(H=>H.ref.current===P))==null?void 0:X.textValue,B=ae.map(H=>H.textValue),U=Mae(B,G,z),ne=(re=ae.find(H=>H.textValue===U))==null?void 0:re.ref.current;(function H(se){O.current=se,window.clearTimeout(k.current),se!==\"\"&&(k.current=window.setTimeout(()=>H(\"\"),1e3))})(G),ne&&setTimeout(()=>ne.focus())};j.useEffect(()=>()=>window.clearTimeout(k.current),[]),yw();const M=j.useCallback(F=>{var ae,P;return D.current===((ae=A.current)==null?void 0:ae.side)&&Iae(F,(P=A.current)==null?void 0:P.area)},[]);return s.jsx(vae,{scope:r,searchRef:O,onItemEnter:j.useCallback(F=>{M(F)&&F.preventDefault()},[M]),onItemLeave:j.useCallback(F=>{var G;M(F)||((G=_.current)==null||G.focus(),N(null))},[M]),onTriggerLeave:j.useCallback(F=>{M(F)&&F.preventDefault()},[M]),pointerGraceTimerRef:C,onPointerGraceIntentChange:j.useCallback(F=>{A.current=F},[]),children:s.jsx(T,{...L,children:s.jsx(Sx,{asChild:!0,trapped:a,onMountAutoFocus:We(i,F=>{var G;F.preventDefault(),(G=_.current)==null||G.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(Zd,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:m,children:s.jsx(XC,{asChild:!0,...v,dir:b.dir,orientation:\"vertical\",loop:n,currentTabStopId:w,onCurrentTabStopIdChange:N,onEntryFocus:We(c,F=>{b.isUsingKeyboardRef.current||F.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(pw,{role:\"menu\",\"aria-orientation\":\"vertical\",\"data-state\":L$(x.open),\"data-radix-menu-content\":\"\",dir:b.dir,...y,...p,ref:E,style:{outline:\"none\",...p.style},onKeyDown:We(p.onKeyDown,F=>{const ae=F.target.closest(\"[data-radix-menu-content]\")===F.currentTarget,P=F.ctrlKey||F.altKey||F.metaKey,z=F.key.length===1;ae&&(F.key===\"Tab\"&&F.preventDefault(),!P&&z&&I(F.key));const B=_.current;if(F.target!==B||!cae.includes(F.key))return;F.preventDefault();const ne=S().filter(X=>!X.disabled).map(X=>X.ref.current);g$.includes(F.key)&&ne.reverse(),Oae(ne)}),onBlur:We(e.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(k.current),O.current=\"\")}),onPointerMove:We(e.onPointerMove,eg(F=>{const G=F.target,ae=R.current!==F.clientX;if(F.currentTarget.contains(G)&&ae){const P=F.clientX>R.current?\"right\":\"left\";D.current=P,R.current=F.clientX}}))})})})})})})});j$.displayName=di;var jae=\"MenuGroup\",r4=j.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(st.div,{role:\"group\",...n,ref:t})});r4.displayName=jae;var Nae=\"MenuLabel\",N$=j.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(st.div,{...n,ref:t})});N$.displayName=Nae;var l1=\"MenuItem\",XP=\"menu.itemSelect\",Sw=j.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...a}=e,i=j.useRef(null),o=kx(l1,e.__scopeMenu),l=e4(l1,e.__scopeMenu),c=Xt(t,i),u=j.useRef(!1),d=()=>{const f=i.current;if(!r&&f){const h=new CustomEvent(XP,{bubbles:!0,cancelable:!0});f.addEventListener(XP,m=>n==null?void 0:n(m),{once:!0}),kC(f,h),h.defaultPrevented?u.current=!1:o.onClose()}};return s.jsx(S$,{...a,ref:c,disabled:r,onClick:We(e.onClick,d),onPointerDown:f=>{var h;(h=e.onPointerDown)==null||h.call(e,f),u.current=!0},onPointerUp:We(e.onPointerUp,f=>{var h;u.current||(h=f.currentTarget)==null||h.click()}),onKeyDown:We(e.onKeyDown,f=>{const h=l.searchRef.current!==\"\";r||h&&f.key===\" \"||h_.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Sw.displayName=l1;var S$=j.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:a,...i}=e,o=e4(l1,r),l=v$(r),c=j.useRef(null),u=Xt(t,c),[d,f]=j.useState(!1),[h,m]=j.useState(\"\");return j.useEffect(()=>{const g=c.current;g&&m((g.textContent??\"\").trim())},[i.children]),s.jsx(Jp.ItemSlot,{scope:r,disabled:n,textValue:a??h,children:s.jsx(ZC,{asChild:!0,...l,focusable:!n,children:s.jsx(st.div,{role:\"menuitem\",\"data-highlighted\":d?\"\":void 0,\"aria-disabled\":n||void 0,\"data-disabled\":n?\"\":void 0,...i,ref:u,onPointerMove:We(e.onPointerMove,eg(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:We(e.onPointerLeave,eg(g=>o.onItemLeave(g))),onFocus:We(e.onFocus,()=>f(!0)),onBlur:We(e.onBlur,()=>f(!1))})})})}),Sae=\"MenuCheckboxItem\",_$=j.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...a}=e;return s.jsx(T$,{scope:e.__scopeMenu,checked:r,children:s.jsx(Sw,{role:\"menuitemcheckbox\",\"aria-checked\":c1(r)?\"mixed\":r,...a,ref:t,\"data-state\":a4(r),onSelect:We(a.onSelect,()=>n==null?void 0:n(c1(r)?!0:!r),{checkForDefaultPrevented:!1})})})});_$.displayName=Sae;var E$=\"MenuRadioGroup\",[_ae,Eae]=nf(E$,{value:void 0,onValueChange:()=>{}}),k$=j.forwardRef((e,t)=>{const{value:r,onValueChange:n,...a}=e,i=ma(n);return s.jsx(_ae,{scope:e.__scopeMenu,value:r,onValueChange:i,children:s.jsx(r4,{...a,ref:t})})});k$.displayName=E$;var C$=\"MenuRadioItem\",A$=j.forwardRef((e,t)=>{const{value:r,...n}=e,a=Eae(C$,e.__scopeMenu),i=r===a.value;return s.jsx(T$,{scope:e.__scopeMenu,checked:i,children:s.jsx(Sw,{role:\"menuitemradio\",\"aria-checked\":i,...n,ref:t,\"data-state\":a4(i),onSelect:We(n.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,r)},{checkForDefaultPrevented:!1})})})});A$.displayName=C$;var n4=\"MenuItemIndicator\",[T$,kae]=nf(n4,{checked:!1}),O$=j.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...a}=e,i=kae(n4,r);return s.jsx(Fa,{present:n||c1(i.checked)||i.checked===!0,children:s.jsx(st.span,{...a,ref:t,\"data-state\":a4(i.checked)})})});O$.displayName=n4;var Cae=\"MenuSeparator\",P$=j.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return s.jsx(st.div,{role:\"separator\",\"aria-orientation\":\"horizontal\",...n,ref:t})});P$.displayName=Cae;var Aae=\"MenuArrow\",M$=j.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,a=Nw(r);return s.jsx(gw,{...a,...n,ref:t})});M$.displayName=Aae;var Tae=\"MenuSub\",[WKe,D$]=nf(Tae),Xm=\"MenuSubTrigger\",I$=j.forwardRef((e,t)=>{const r=af(Xm,e.__scopeMenu),n=kx(Xm,e.__scopeMenu),a=D$(Xm,e.__scopeMenu),i=e4(Xm,e.__scopeMenu),o=j.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:e.__scopeMenu},d=j.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return j.useEffect(()=>d,[d]),j.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),c(null)}},[l,c]),s.jsx(QC,{asChild:!0,...u,children:s.jsx(S$,{id:a.triggerId,\"aria-haspopup\":\"menu\",\"aria-expanded\":r.open,\"aria-controls\":a.contentId,\"data-state\":L$(r.open),...e,ref:Il(t,a.onTriggerChange),onClick:f=>{var h;(h=e.onClick)==null||h.call(e,f),!(e.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:We(e.onPointerMove,eg(f=>{i.onItemEnter(f),!f.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),d()},100))})),onPointerLeave:We(e.onPointerLeave,eg(f=>{var m,g;d();const h=(m=r.content)==null?void 0:m.getBoundingClientRect();if(h){const p=(g=r.content)==null?void 0:g.dataset.side,x=p===\"right\",b=x?-5:5,y=h[x?\"left\":\"right\"],v=h[x?\"right\":\"left\"];i.onPointerGraceIntentChange({area:[{x:f.clientX+b,y:f.clientY},{x:y,y:h.top},{x:v,y:h.top},{x:v,y:h.bottom},{x:y,y:h.bottom}],side:p}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:We(e.onKeyDown,f=>{var m;const h=i.searchRef.current!==\"\";e.disabled||h&&f.key===\" \"||uae[n.dir].includes(f.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),f.preventDefault())})})})});I$.displayName=Xm;var F$=\"MenuSubContent\",R$=j.forwardRef((e,t)=>{const r=b$(di,e.__scopeMenu),{forceMount:n=r.forceMount,...a}=e,i=af(di,e.__scopeMenu),o=kx(di,e.__scopeMenu),l=D$(F$,e.__scopeMenu),c=j.useRef(null),u=Xt(t,c);return s.jsx(Jp.Provider,{scope:e.__scopeMenu,children:s.jsx(Fa,{present:n||i.open,children:s.jsx(Jp.Slot,{scope:e.__scopeMenu,children:s.jsx(t4,{id:l.contentId,\"aria-labelledby\":l.triggerId,...a,ref:u,align:\"start\",side:o.dir===\"rtl\"?\"left\":\"right\",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var f;o.isUsingKeyboardRef.current&&((f=c.current)==null||f.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:We(e.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:We(e.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:We(e.onKeyDown,d=>{var m;const f=d.currentTarget.contains(d.target),h=dae[o.dir].includes(d.key);f&&h&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});R$.displayName=F$;function L$(e){return e?\"open\":\"closed\"}function c1(e){return e===\"indeterminate\"}function a4(e){return c1(e)?\"indeterminate\":e?\"checked\":\"unchecked\"}function Oae(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function Pae(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function Mae(e,t,r){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=Pae(e,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==r));const c=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function Dae(e,t){const{x:r,y:n}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i].x,c=t[i].y,u=t[o].x,d=t[o].y;c>n!=d>n&&r<(u-l)*(n-c)/(d-c)+l&&(a=!a)}return a}function Iae(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return Dae(r,t)}function eg(e){return t=>t.pointerType===\"mouse\"?e(t):void 0}var Fae=y$,Rae=QC,Lae=w$,$ae=j$,Bae=r4,Vae=N$,zae=Sw,Uae=_$,Wae=k$,Hae=A$,Gae=O$,Kae=P$,Yae=M$,qae=I$,Xae=R$,s4=\"DropdownMenu\",[Zae,HKe]=Wn(s4,[x$]),as=x$(),[Qae,$$]=Zae(s4),B$=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=as(t),u=j.useRef(null),[d=!1,f]=gi({prop:a,defaultProp:i,onChange:o});return s.jsx(Qae,{scope:t,triggerId:ra(),triggerRef:u,contentId:ra(),open:d,onOpenChange:f,onOpenToggle:j.useCallback(()=>f(h=>!h),[f]),modal:l,children:s.jsx(Fae,{...c,open:d,onOpenChange:f,dir:n,modal:l,children:r})})};B$.displayName=s4;var V$=\"DropdownMenuTrigger\",z$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...a}=e,i=$$(V$,r),o=as(r);return s.jsx(Rae,{asChild:!0,...o,children:s.jsx(st.button,{type:\"button\",id:i.triggerId,\"aria-haspopup\":\"menu\",\"aria-expanded\":i.open,\"aria-controls\":i.open?i.contentId:void 0,\"data-state\":i.open?\"open\":\"closed\",\"data-disabled\":n?\"\":void 0,disabled:n,...a,ref:Il(t,i.triggerRef),onPointerDown:We(e.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:We(e.onKeyDown,l=>{n||([\"Enter\",\" \"].includes(l.key)&&i.onOpenToggle(),l.key===\"ArrowDown\"&&i.onOpenChange(!0),[\"Enter\",\" \",\"ArrowDown\"].includes(l.key)&&l.preventDefault())})})})});z$.displayName=V$;var Jae=\"DropdownMenuPortal\",U$=e=>{const{__scopeDropdownMenu:t,...r}=e,n=as(t);return s.jsx(Lae,{...n,...r})};U$.displayName=Jae;var W$=\"DropdownMenuContent\",H$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=$$(W$,r),i=as(r),o=j.useRef(!1);return s.jsx($ae,{id:a.contentId,\"aria-labelledby\":a.triggerId,...i,...n,ref:t,onCloseAutoFocus:We(e.onCloseAutoFocus,l=>{var c;o.current||(c=a.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:We(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!a.modal||d)&&(o.current=!0)}),style:{...e.style,\"--radix-dropdown-menu-content-transform-origin\":\"var(--radix-popper-transform-origin)\",\"--radix-dropdown-menu-content-available-width\":\"var(--radix-popper-available-width)\",\"--radix-dropdown-menu-content-available-height\":\"var(--radix-popper-available-height)\",\"--radix-dropdown-menu-trigger-width\":\"var(--radix-popper-anchor-width)\",\"--radix-dropdown-menu-trigger-height\":\"var(--radix-popper-anchor-height)\"}})});H$.displayName=W$;var ese=\"DropdownMenuGroup\",tse=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Bae,{...a,...n,ref:t})});tse.displayName=ese;var rse=\"DropdownMenuLabel\",G$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Vae,{...a,...n,ref:t})});G$.displayName=rse;var nse=\"DropdownMenuItem\",K$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(zae,{...a,...n,ref:t})});K$.displayName=nse;var ase=\"DropdownMenuCheckboxItem\",Y$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Uae,{...a,...n,ref:t})});Y$.displayName=ase;var sse=\"DropdownMenuRadioGroup\",ise=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Wae,{...a,...n,ref:t})});ise.displayName=sse;var ose=\"DropdownMenuRadioItem\",q$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Hae,{...a,...n,ref:t})});q$.displayName=ose;var lse=\"DropdownMenuItemIndicator\",X$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Gae,{...a,...n,ref:t})});X$.displayName=lse;var cse=\"DropdownMenuSeparator\",Z$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Kae,{...a,...n,ref:t})});Z$.displayName=cse;var use=\"DropdownMenuArrow\",dse=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Yae,{...a,...n,ref:t})});dse.displayName=use;var fse=\"DropdownMenuSubTrigger\",Q$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(qae,{...a,...n,ref:t})});Q$.displayName=fse;var hse=\"DropdownMenuSubContent\",J$=j.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,a=as(r);return s.jsx(Xae,{...a,...n,ref:t,style:{...e.style,\"--radix-dropdown-menu-content-transform-origin\":\"var(--radix-popper-transform-origin)\",\"--radix-dropdown-menu-content-available-width\":\"var(--radix-popper-available-width)\",\"--radix-dropdown-menu-content-available-height\":\"var(--radix-popper-available-height)\",\"--radix-dropdown-menu-trigger-width\":\"var(--radix-popper-anchor-width)\",\"--radix-dropdown-menu-trigger-height\":\"var(--radix-popper-anchor-height)\"}})});J$.displayName=hse;var mse=B$,pse=z$,gse=U$,e7=H$,t7=G$,r7=K$,n7=Y$,a7=q$,s7=X$,i7=Z$,o7=Q$,l7=J$;const Yc=mse,qc=pse,xse=j.forwardRef(({className:e,inset:t,children:r,...n},a)=>s.jsxs(o7,{ref:a,className:be(\"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",t&&\"pl-8\",e),...n,children:[r,s.jsx(cu,{className:\"ml-auto\"})]}));xse.displayName=o7.displayName;const vse=j.forwardRef(({className:e,...t},r)=>s.jsx(l7,{ref:r,className:be(\"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",e),...t}));vse.displayName=l7.displayName;const $l=j.forwardRef(({className:e,sideOffset:t=4,...r},n)=>s.jsx(gse,{children:s.jsx(e7,{ref:n,sideOffset:t,className:be(\"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",e),...r})}));$l.displayName=e7.displayName;const an=j.forwardRef(({className:e,inset:t,...r},n)=>s.jsx(r7,{ref:n,className:be(\"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",t&&\"pl-8\",e),...r}));an.displayName=r7.displayName;const yse=j.forwardRef(({className:e,children:t,checked:r,...n},a)=>s.jsxs(n7,{ref:a,className:be(\"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",e),checked:r,...n,children:[s.jsx(\"span\",{className:\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\",children:s.jsx(s7,{children:s.jsx(ga,{className:\"h-4 w-4\"})})}),t]}));yse.displayName=n7.displayName;const bse=j.forwardRef(({className:e,children:t,...r},n)=>s.jsxs(a7,{ref:n,className:be(\"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",e),...r,children:[s.jsx(\"span\",{className:\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\",children:s.jsx(s7,{children:s.jsx(a9,{className:\"h-2 w-2 fill-current\"})})}),t]}));bse.displayName=a7.displayName;const wse=j.forwardRef(({className:e,inset:t,...r},n)=>s.jsx(t7,{ref:n,className:be(\"px-2 py-1.5 text-sm font-semibold\",t&&\"pl-8\",e),...r}));wse.displayName=t7.displayName;const m_=j.forwardRef(({className:e,...t},r)=>s.jsx(i7,{ref:r,className:be(\"-mx-1 my-1 h-px bg-muted\",e),...t}));m_.displayName=i7.displayName;function jse(e){return!e||typeof e!=\"string\"?\"US\":e.split(\" \").map(t=>t.charAt(0)).join(\"\").toUpperCase().slice(0,2)}const ZP=[{name:\"Dashboard\",href:\"/dashboard\",icon:o9},{name:\"Leden\",href:\"/leden\",icon:Ji},{name:\"Lidkaarten\",href:\"/lidkaarten\",icon:i9},{name:\"Lidgelden\",href:\"/lidgelden\",icon:tne},{name:\"Financiën\",href:\"/financien\",icon:Xre},{name:\"Mijn Bestuur\",href:\"/bestuur\",icon:ene},{name:\"Berichten\",href:\"/berichten\",icon:cs},{name:\"Publieke Schermen\",href:\"/publieke-schermen\",icon:uw},{name:\"Instellingen\",href:\"/instellingen\",icon:RC}];function Nse(){const[e]=sw(),{user:t,logout:r}=rf(),[n,a]=j.useState(!1);return s.jsx(\"header\",{className:\"sticky top-0 z-40 w-full border-b border-sidebar-border bg-sidebar backdrop-blur supports-[backdrop-filter]:bg-sidebar/95\",children:s.jsxs(\"div\",{className:\"w-full flex h-12 items-center pl-0 pr-4 sm:pr-6 lg:pr-8 relative\",children:[s.jsx(\"div\",{className:\"absolute left-4 flex items-center\",children:s.jsx(bv,{href:\"/dashboard\",className:\"flex items-center\",children:s.jsx(\"img\",{src:ane,alt:\"DARAH Logo\",className:\"w-56 h-14 xs:w-60 xs:h-15 sm:w-64 sm:h-16 md:w-72 md:h-18 lg:w-80 lg:h-20 object-contain object-left\"})})}),s.jsxs(\"div\",{className:\"w-full flex justify-center overflow-x-auto\",children:[s.jsx(\"nav\",{className:\"hidden lg:flex items-center space-x-2 xl:space-x-3\",children:ZP.map(i=>{const o=e===i.href||i.href!==\"/dashboard\"&&e.startsWith(i.href),l=i.icon;return s.jsxs(bv,{href:i.href,className:be(\"flex items-center gap-x-1.5 px-2.5 py-2 text-xs xl:text-sm font-medium rounded-xl transition-all duration-300 ease-out whitespace-nowrap\",o?\"bg-sidebar-primary text-sidebar-primary-foreground shadow-lg shadow-blue-500/20 scale-105\":\"text-sidebar-foreground hover:text-sidebar-foreground hover:bg-sidebar-accent hover:shadow-md hover:scale-102 hover:-translate-y-0.5\"),\"data-testid\":`nav-${i.name.toLowerCase().replace(/\\s+/g,\"-\")}`,children:[s.jsx(l,{className:\"h-3 w-3 xl:h-3.5 xl:w-3.5\"}),i.name]},i.name)})}),s.jsxs(Yc,{open:n,onOpenChange:a,children:[s.jsx(qc,{asChild:!0,children:s.jsxs(ce,{variant:\"ghost\",size:\"sm\",className:\"lg:hidden h-9 w-9 text-sidebar-foreground hover:bg-sidebar-accent focus-ring relative z-50 touch-manipulation\",\"data-testid\":\"mobile-menu-button\",\"aria-label\":\"Open navigation menu\",style:{touchAction:\"manipulation\"},children:[s.jsx(jee,{className:\"h-5 w-5\"}),s.jsx(\"span\",{className:\"sr-only\",children:\"Open navigation menu\"})]})}),s.jsx($l,{align:\"end\",className:\"w-56 z-[60] bg-popover border border-border shadow-lg\",sideOffset:8,children:ZP.map(i=>{const o=e===i.href||i.href!==\"/dashboard\"&&e.startsWith(i.href),l=i.icon;return s.jsx(an,{asChild:!0,children:s.jsxs(bv,{href:i.href,onClick:()=>a(!1),className:be(\"flex items-center gap-x-2 cursor-pointer\",o&&\"bg-accent text-accent-foreground\"),\"data-testid\":`mobile-nav-${i.name.toLowerCase().replace(/\\s+/g,\"-\")}`,children:[s.jsx(l,{className:\"h-4 w-4\"}),i.name]})},i.name)})})]})]}),s.jsx(\"div\",{className:\"absolute right-4 sm:right-6 lg:right-8 flex items-center\",children:t&&s.jsxs(Yc,{children:[s.jsx(qc,{asChild:!0,children:s.jsxs(ce,{variant:\"ghost\",size:\"sm\",className:\"flex items-center gap-x-3 h-11 px-4 text-sidebar-foreground hover:bg-sidebar-accent focus-ring rounded-xl transition-all ","size_bytes":360000},"assets/index-EF0U9zW8.css":{"content":"@import\"https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap\";@import\"https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap\";.bg-spotlight{background-image:url(data:image/jpeg;base64,AAAAHGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZgAAAOptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABwaWN0AAAAAAAAAAAAAAAAAAAAAA5waXRtAAAAAAABAAAAImlsb2MAAAAAREAAAQABAAAAAAEOAAEAAAAAAAAFUAAAACNpaW5mAAAAAAABAAAAFWluZmUCAAAAAAEAAGF2MDEAAAAAamlwcnAAAABLaXBjbwAAABNjb2xybmNseAABAA0ABoAAAAAMYXYxQ4EEDAAAAAAUaXNwZQAAAAAAAALkAAADLgAAABBwaXhpAAAAAAMICAgAAAAXaXBtYQAAAAAAAAABAAEEAYIDBAAABVhtZGF0EgAKChkmbjy3ggIaDQgyvwpEYABRRRRQ9LrYAur+GatcELsNDsne58oTnrjuY6R84w5glT7Hjy0ihG8jv8Lsl+Gi3QRp7NvZnygMzsZGOtjkNO6qDpXfalRNJ2IrkJzoCXHuvy/wtyEZqgmtOphZRt8m2DpMu9+2xzOuPzFmKef1UlOKw/S6z0mlBwsOU3gVLIyU4v17ime9OJQMpR1xq+N/sJ+3Zt+4aRDSn80hUgpGXIsVpXC1xNmJabOLgshhG+WkHthQNxIPvylDwef4LG5YqqItWQO1H9l7rbhr0HApmXWH9NFUwisAglvb/P3hdlClHvhtuecQaFL1E260ruEfBd2qgcvzgKNV/ZSm2slxJJDsgirVKfcdKSOcMjJm/bctdnbOW/dyXSqAMnZS5uqWjuZv60ZyyB70pl0Tz0/mcNoBqfb+CgwuBBhFKPwmYStVYjetmSz4FHQcVTvZlynWcgv6qlvfY45vnZPuhXI2T4vC0USFRvKoULiDM3YLq1dn59ALpKY+h7VZ2CRN88n8rnsi9V5Ccdwb+OXGW5tbTACAXSsFdgjLLSNyWwntKvogw5SvU7wY0s9eyZc5smJZFfkqZSIAUkO8lRZpKvVE0p+J3T2npkTFfWJnPVw1C2yn5tkulD9O10ve6FCgk9+ePFFVig0aPWRGsH3zXKEgNhI5uPzxPGfTYi6q4LxfmVwhjN+cnAEUbVnU5G24pYRvTVso4qDwLFG61r1yvwIpcKW7xbUOFr68XE8P2U/XDBirShNXjs2PR/ltMW/zEti3Mrtc12nT7qjDreP1QyjwaFKHsOvaNjI7IEa98kQOuR8rM2KBs0KKoxWP/QPeX2h8U4+LbtaOJ5T0pIH0cpfiv8wcIbz9KA1hHwUBLHJzgMEXnApYVWXOAZX4/Qn4GWCSK89WXPqBRAyb09pBX/+Ej/Koiw8u/9zYGjetppCUk25vslrLlL5uTeZY7YhcFrtuxD3/+MNnGD6RBEQDsGhE73yHchh7oTu9I13vS8+oMI/TNq/cQ/5uws0gs8axX/nZQzvngdO/xJl0RLp0ZMIYZdBh6kChsedaHkZ7symB3i2Ne2fzhTFkvOHZAmZB+07r0361k5mCN/8JHh5YYJMkJojZ2ngC/ZAYFX/QLuNQpEF0oixg5H9P/+wIDUpRIFOIHe5hxlJjRfurZ3mO/iVofifnKsHxadDcZxiDiMgnJ03URGqeTSxrVPTsuoCS2fytyGCeSnWszS7cKUd2AVicM+DUCOONhcwsqRKorBpIIFLt594j4Z02TkHvZGBwmF/a1T0GV7gVv5N15HEctOwmzHwIlNgLzPanf2fCCRKEcVPeezT0zQvWBgNsOWbibju+JLxQb4lndtkYVIUgHrjagLwC1IhfZigh8RCNnre+0nXEndLbxyP/2kxPg+2cc/fju5NM/wwy8eTW2dtS/PAA+xXD7jlUov+YDaMdP74IBaDnkuBL+M4YgyVSAFmk4Ar0SEQeNq3z9Jium3O/yx8F37gTIPvdg1asMiPZFOsX++HexZtYcXQag50wPwTY5/WiebKs0VNQB9pE5kAhVi054Y1HMRIp8M1Ka3A1D3oeQEM6cXRp6pco+kPlENsMWgrbfmH6l3+ZXYIOn/Mpafa/MjpD9B088FGzMv6qs/Yw/hHNmWuooFLOMHabVfYE9HbzPufwkSgMDb2ioVPS5jt/qIt+30fFInXr3lwkv4WgRuFrKXK8NSlfDbr2/Zy2aWoW2ltgQBHDeYrKOUNLgYCXlgb2v5VSgDEC50mnLF1AVjIxAa5iDitkPnhTprvVOA==);background-size:cover;background-position:center;background-repeat:no-repeat}.bg-vignette{position:relative}.bg-vignette:before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;background:radial-gradient(circle at 50% 50%,transparent 40%,rgba(0,0,0,.1) 100%);pointer-events:none;z-index:1}.bg-sheen{position:relative}.bg-sheen:after{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(135deg,rgba(255,255,255,.05) 0%,transparent 50%,rgba(255,255,255,.03) 100%);pointer-events:none;z-index:2}.bg-grain{position:relative}.bg-grain:before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;background-image:url(\"data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='1' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E\");opacity:.04;pointer-events:none;z-index:3;mix-blend-mode:overlay}.bg-rimlight{position:relative}.bg-rimlight:after{content:\"\";position:absolute;top:50%;left:50%;width:120%;height:80%;background:radial-gradient(ellipse,rgba(139,92,246,.12) 0%,transparent 70%);transform:translate(-50%,-50%);filter:blur(50px);pointer-events:none;z-index:0}@media (prefers-reduced-motion: reduce){.bg-sheen:after,.bg-rimlight:after{animation:none}}.status-led-glow-green{box-shadow:0 0 8px #22c55e66,0 0 16px #22c55e33;animation:pulse-green 2s ease-in-out infinite}.status-led-glow-orange{box-shadow:0 0 8px #f59e0b66,0 0 16px #f59e0b33;animation:pulse-orange 2s ease-in-out infinite}.status-led-glow-red{box-shadow:0 0 8px #ef444466,0 0 16px #ef444433;animation:pulse-red 2s ease-in-out infinite}@keyframes pulse-green{0%,to{box-shadow:0 0 8px #22c55e66,0 0 16px #22c55e33}50%{box-shadow:0 0 12px #22c55e99,0 0 24px #22c55e4d}}@keyframes pulse-orange{0%,to{box-shadow:0 0 8px #f59e0b66,0 0 16px #f59e0b33}50%{box-shadow:0 0 12px #f59e0b99,0 0 24px #f59e0b4d}}@keyframes pulse-red{0%,to{box-shadow:0 0 8px #ef444466,0 0 16px #ef444433}50%{box-shadow:0 0 12px #ef444499,0 0 24px #ef44444d}}.card-font{font-family:Space Grotesk,-apple-system,BlinkMacSystemFont,sans-serif;font-feature-settings:\"tnum\" 1}.embossed-text{color:#eaf2ff;text-shadow:0 1px 0 rgba(255,255,255,.1),0 -1px 0 rgba(0,0,0,.3),0 1px 2px rgba(0,0,0,.5)}@media (prefers-contrast: high){.bg-spotlight{background:#000}.bg-vignette:before,.bg-sheen:after,.bg-grain:before,.bg-rimlight:after{display:none}.status-led-glow-green,.status-led-glow-orange,.status-led-glow-red{box-shadow:none;animation:none}}@media (prefers-reduced-motion: reduce){.status-led-glow-green,.status-led-glow-orange,.status-led-glow-red{animation:none}}*,:before,:after{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x: 0;--tw-border-spacing-y: 0;--tw-translate-x: 0;--tw-translate-y: 0;--tw-rotate: 0;--tw-skew-x: 0;--tw-skew-y: 0;--tw-scale-x: 1;--tw-scale-y: 1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness: proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width: 0px;--tw-ring-offset-color: #fff;--tw-ring-color: rgb(59 130 246 / .5);--tw-ring-offset-shadow: 0 0 #0000;--tw-ring-shadow: 0 0 #0000;--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}:before,:after{--tw-content: \"\"}html,:host{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:var(--font-sans);font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--font-mono);font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}ol,ul,menu{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}button,[role=button]{cursor:pointer}:disabled{cursor:default}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}*{border-color:var(--border)}body{background-color:var(--background);font-family:var(--font-sans);color:var(--foreground);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-feature-settings:\"cv11\",\"cv02\",\"cv03\",\"cv04\"}:focus-visible{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-color: var(--primary);--tw-ring-offset-width: 2px;--tw-ring-offset-color: var(--background)}.btn-hover{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1);animation-duration:.3s;animation-timing-function:cubic-bezier(0,0,.2,1)}.btn-hover:hover{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.card-hover{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.3s;transition-timing-function:cubic-bezier(0,0,.2,1);animation-duration:.3s;animation-timing-function:cubic-bezier(0,0,.2,1)}.glass-card{border-width:1px;border-color:#fff3;background-color:#fffc;--tw-backdrop-blur: blur(24px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.glass-card:is(.dark *){border-color:#37415180;background-color:#111827cc}.glass-card{box-shadow:var(--glass-shadow)}.glass-card:hover{box-shadow:var(--glass-shadow-hover)}html{scroll-behavior:smooth}.container{width:100%}@media (min-width: 475px){.container{max-width:475px}}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-top:1.2em;margin-bottom:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);text-decoration:underline;font-weight:500}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=\"1\"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-top:1.25em;margin-bottom:1.25em;padding-inline-start:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{font-weight:400;color:var(--tw-prose-counters)}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-style:italic;color:var(--tw-prose-quotes);border-inline-start-width:.25rem;border-inline-start-color:var(--tw-prose-quote-borders);quotes:\"“\"\"”\"\"‘\"\"’\";margin-top:1.6em;margin-bottom:1.6em;padding-inline-start:1em}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:900;color:inherit}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:800;color:inherit}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.5em;margin-bottom:.5em;line-height:1.5}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:700;color:inherit}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-top:2em;margin-bottom:2em}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:500;font-family:inherit;color:var(--tw-prose-kbd);box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows) / 10%),0 3px rgb(var(--tw-prose-kbd-shadows) / 10%);font-size:.875em;border-radius:.3125rem;padding-top:.1875em;padding-inline-end:.375em;padding-bottom:.1875em;padding-inline-start:.375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-weight:600;font-size:.875em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:\"`\"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:\"`\"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);overflow-x:auto;font-weight:400;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding-top:.8571429em;padding-inline-end:1.1428571em;padding-bottom:.8571429em;padding-inline-start:1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){width:100%;table-layout:auto;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.7142857}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-th-borders)}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;vertical-align:bottom;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:1px;border-bottom-color:var(--tw-prose-td-borders)}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-width:1px;border-top-color:var(--tw-prose-th-borders)}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(th,td):not(:where([class~=not-prose],[class~=not-prose] *)){text-align:start}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body: #374151;--tw-prose-headings: #111827;--tw-prose-lead: #4b5563;--tw-prose-links: #111827;--tw-prose-bold: #111827;--tw-prose-counters: #6b7280;--tw-prose-bullets: #d1d5db;--tw-prose-hr: #e5e7eb;--tw-prose-quotes: #111827;--tw-prose-quote-borders: #e5e7eb;--tw-prose-captions: #6b7280;--tw-prose-kbd: #111827;--tw-prose-kbd-shadows: 17 24 39;--tw-prose-code: #111827;--tw-prose-pre-code: #e5e7eb;--tw-prose-pre-bg: #1f2937;--tw-prose-th-borders: #d1d5db;--tw-prose-td-borders: #e5e7eb;--tw-prose-invert-body: #d1d5db;--tw-prose-invert-headings: #fff;--tw-prose-invert-lead: #9ca3af;--tw-prose-invert-links: #fff;--tw-prose-invert-bold: #fff;--tw-prose-invert-counters: #9ca3af;--tw-prose-invert-bullets: #4b5563;--tw-prose-invert-hr: #374151;--tw-prose-invert-quotes: #f3f4f6;--tw-prose-invert-quote-borders: #374151;--tw-prose-invert-captions: #9ca3af;--tw-prose-invert-kbd: #fff;--tw-prose-invert-kbd-shadows: 255 255 255;--tw-prose-invert-code: #fff;--tw-prose-invert-pre-code: #d1d5db;--tw-prose-invert-pre-bg: rgb(0 0 0 / 50%);--tw-prose-invert-th-borders: #4b5563;--tw-prose-invert-td-borders: #374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.5714286em;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-sm{font-size:.875rem;line-height:1.7142857}.prose-sm :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.2857143em;line-height:1.5555556;margin-top:.8888889em;margin-bottom:.8888889em}.prose-sm :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.3333333em;margin-bottom:1.3333333em;padding-inline-start:1.1111111em}.prose-sm :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:2.1428571em;margin-top:0;margin-bottom:.8em;line-height:1.2}.prose-sm :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.4285714em;margin-top:1.6em;margin-bottom:.8em;line-height:1.4}.prose-sm :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.2857143em;margin-top:1.5555556em;margin-bottom:.4444444em;line-height:1.5555556}.prose-sm :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.4285714em;margin-bottom:.5714286em;line-height:1.4285714}.prose-sm :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose-sm :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8571429em;border-radius:.3125rem;padding-top:.1428571em;padding-inline-end:.3571429em;padding-bottom:.1428571em;padding-inline-start:.3571429em}.prose-sm :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8571429em}.prose-sm :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.9em}.prose-sm :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8888889em}.prose-sm :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8571429em;line-height:1.6666667;margin-top:1.6666667em;margin-bottom:1.6666667em;border-radius:.25rem;padding-top:.6666667em;padding-inline-end:1em;padding-bottom:.6666667em;padding-inline-start:1em}.prose-sm :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em;margin-bottom:1.1428571em;padding-inline-start:1.5714286em}.prose-sm :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em;margin-bottom:1.1428571em;padding-inline-start:1.5714286em}.prose-sm :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.2857143em;margin-bottom:.2857143em}.prose-sm :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.4285714em}.prose-sm :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.4285714em}.prose-sm :where(.prose-sm>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5714286em;margin-bottom:.5714286em}.prose-sm :where(.prose-sm>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em}.prose-sm :where(.prose-sm>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.1428571em}.prose-sm :where(.prose-sm>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em}.prose-sm :where(.prose-sm>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.1428571em}.prose-sm :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5714286em;margin-bottom:.5714286em}.prose-sm :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.1428571em}.prose-sm :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.2857143em;padding-inline-start:1.5714286em}.prose-sm :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2.8571429em;margin-bottom:2.8571429em}.prose-sm :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8571429em;line-height:1.5}.prose-sm :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:1em;padding-bottom:.6666667em;padding-inline-start:1em}.prose-sm :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose-sm :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose-sm :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-top:.6666667em;padding-inline-end:1em;padding-bottom:.6666667em;padding-inline-start:1em}.prose-sm :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose-sm :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose-sm :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose-sm :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8571429em;line-height:1.3333333;margin-top:.6666667em}.prose-sm :where(.prose-sm>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-sm :where(.prose-sm>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.focus-ring{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s;animation-duration:.2s}.focus-ring:focus-visible{outline:2px solid transparent;outline-offset:2px;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-color: var(--primary);--tw-ring-offset-width: 2px}.animate-fade-in{transition-duration:.5s;animation-name:enter;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial;--tw-enter-opacity: 0;animation-duration:.5s}@keyframes modern-pulse{0%{background-position:-200% 0}to{background-position:200% 0}}.sidebar{min-height:100vh;width:16rem;border-right-width:1px;border-color:var(--sidebar-border);background-color:var(--sidebar);color:var(--sidebar-foreground)}.content-area{height:calc(100vh - 3rem);width:100%;overflow:auto}.card-font{font-family:Space Grotesk,system-ui,-apple-system,Segoe UI,Roboto,sans-serif}.embossed-text{color:#f8fafc;text-shadow:0 1px 2px rgba(0,0,0,.4),0 0 8px rgba(255,255,255,.1);font-weight:500}@keyframes card-shine{0%{transform:translate(-100%) rotate(35deg)}to{transform:translate(400%) rotate(35deg)}}.card-shine{animation:card-shine .8s ease-out}@media (prefers-reduced-motion: reduce){.card-shine,.animate-flip-horizontal{animation:none}}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.inset-y-0{top:0;bottom:0}.-bottom-12{bottom:-3rem}.-left-12{left:-3rem}.-right-1{right:-.25rem}.-right-12{right:-3rem}.-top-1{top:-.25rem}.-top-12{top:-3rem}.bottom-0{bottom:0}.bottom-4{bottom:1rem}.bottom-6{bottom:1.5rem}.bottom-8{bottom:2rem}.left-0{left:0}.left-1{left:.25rem}.left-1\\/2{left:50%}.left-2{left:.5rem}.left-3{left:.75rem}.left-4{left:1rem}.left-6{left:1.5rem}.left-\\[50\\%\\]{left:50%}.right-0{right:0}.right-1{right:.25rem}.right-2{right:.5rem}.right-3{right:.75rem}.right-4{right:1rem}.right-6{right:1.5rem}.right-8{right:2rem}.top-0{top:0}.top-1{top:.25rem}.top-1\\.5{top:.375rem}.top-1\\/2{top:50%}.top-2{top:.5rem}.top-2\\.5{top:.625rem}.top-3\\.5{top:.875rem}.top-4{top:1rem}.top-6{top:1.5rem}.top-8{top:2rem}.top-\\[1px\\]{top:1px}.top-\\[50\\%\\]{top:50%}.top-\\[60\\%\\]{top:60%}.top-full{top:100%}.z-10{z-index:10}.z-20{z-index:20}.z-40{z-index:40}.z-50{z-index:50}.z-\\[100\\]{z-index:100}.z-\\[1\\]{z-index:1}.z-\\[60\\]{z-index:60}.col-span-1{grid-column:span 1 / span 1}.col-span-full{grid-column:1 / -1}.-mx-1{margin-left:-.25rem;margin-right:-.25rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-3\\.5{margin-left:.875rem;margin-right:.875rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-0\\.5{margin-top:.125rem;margin-bottom:.125rem}.my-1{margin-top:.25rem;margin-bottom:.25rem}.-ml-4{margin-left:-1rem}.-mt-4{margin-top:-1rem}.-mt-8{margin-top:-2rem}.mb-1{margin-bottom:.25rem}.mb-12{margin-bottom:3rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-4{margin-left:1rem}.ml-6{margin-left:1.5rem}.ml-8{margin-left:2rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-1\\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mr-8{margin-right:2rem}.mt-0{margin-top:0}.mt-0\\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-1\\.5{margin-top:.375rem}.mt-2{margin-top:.5rem}.mt-24{margin-top:6rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.hidden{display:none}.aspect-\\[1586\\/1000\\]{aspect-ratio:1586/1000}.aspect-\\[16\\/10\\]{aspect-ratio:16/10}.aspect-square{aspect-ratio:1 / 1}.aspect-video{aspect-ratio:16 / 9}.size-4{width:1rem;height:1rem}.h-0{height:0px}.h-0\\.5{height:.125rem}.h-1{height:.25rem}.h-1\\.5{height:.375rem}.h-1\\/3{height:33.333333%}.h-10{height:2.5rem}.h-11{height:2.75rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-16{height:4rem}.h-2{height:.5rem}.h-2\\.5{height:.625rem}.h-20{height:5rem}.h-24{height:6rem}.h-3{height:.75rem}.h-3\\.5{height:.875rem}.h-32{height:8rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-64{height:16rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-80{height:20rem}.h-9{height:2.25rem}.h-96{height:24rem}.h-\\[1px\\]{height:1px}.h-\\[80vh\\]{height:80vh}.h-\\[95vh\\]{height:95vh}.h-\\[var\\(--radix-navigation-menu-viewport-height\\)\\]{height:var(--radix-navigation-menu-viewport-height)}.h-\\[var\\(--radix-select-trigger-height\\)\\]{height:var(--radix-select-trigger-height)}.h-auto{height:auto}.h-fit{height:-moz-fit-content;height:fit-content}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.h-svh{height:100svh}.max-h-32{max-height:8rem}.max-h-40{max-height:10rem}.max-h-60{max-height:15rem}.max-h-64{max-height:16rem}.max-h-80{max-height:20rem}.max-h-96{max-height:24rem}.max-h-\\[--radix-context-menu-content-available-height\\]{max-height:var(--radix-context-menu-content-available-height)}.max-h-\\[--radix-select-content-available-height\\]{max-height:var(--radix-select-content-available-height)}.max-h-\\[300px\\]{max-height:300px}.max-h-\\[70vh\\]{max-height:70vh}.max-h-\\[85vh\\]{max-height:85vh}.max-h-\\[90vh\\]{max-height:90vh}.max-h-\\[95vh\\]{max-height:95vh}.max-h-\\[var\\(--radix-dropdown-menu-content-available-height\\)\\]{max-height:var(--radix-dropdown-menu-content-available-height)}.max-h-screen{max-height:100vh}.min-h-0{min-height:0px}.min-h-\\[100px\\]{min-height:100px}.min-h-\\[300px\\]{min-height:300px}.min-h-\\[400px\\]{min-height:400px}.min-h-\\[420px\\]{min-height:420px}.min-h-\\[600px\\]{min-height:600px}.min-h-\\[80px\\]{min-height:80px}.min-h-screen{min-height:100vh}.min-h-svh{min-height:100svh}.w-0{width:0px}.w-1{width:.25rem}.w-1\\.5{width:.375rem}.w-1\\/2{width:50%}.w-1\\/4{width:25%}.w-1\\/6{width:16.666667%}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-12{width:3rem}.w-14{width:3.5rem}.w-16{width:4rem}.w-2{width:.5rem}.w-2\\.5{width:.625rem}.w-2\\/3{width:66.666667%}.w-20{width:5rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\\.5{width:.875rem}.w-3\\/4{width:75%}.w-32{width:8rem}.w-4{width:1rem}.w-48{width:12rem}.w-5{width:1.25rem}.w-56{width:14rem}.w-6{width:1.5rem}.w-64{width:16rem}.w-7{width:1.75rem}.w-72{width:18rem}.w-8{width:2rem}.w-80{width:20rem}.w-9{width:2.25rem}.w-96{width:24rem}.w-\\[--sidebar-width\\]{width:var(--sidebar-width)}.w-\\[100px\\]{width:100px}.w-\\[120px\\]{width:120px}.w-\\[140px\\]{width:140px}.w-\\[160px\\]{width:160px}.w-\\[170px\\]{width:170px}.w-\\[180px\\]{width:180px}.w-\\[1px\\]{width:1px}.w-\\[400px\\]{width:400px}.w-\\[80px\\]{width:80px}.w-\\[min\\(95vw\\,75vh\\*1\\.586\\)\\]{width:min(95vw,75vh * 1.586)}.w-\\[min\\(95vw\\,calc\\(75vh\\*1\\.586\\)\\)\\]{width:min(95vw,118.95vh)}.w-auto{width:auto}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-max{width:-moz-max-content;width:max-content}.w-px{width:1px}.min-w-0{min-width:0px}.min-w-10{min-width:2.5rem}.min-w-11{min-width:2.75rem}.min-w-24{min-width:6rem}.min-w-48{min-width:12rem}.min-w-5{min-width:1.25rem}.min-w-9{min-width:2.25rem}.min-w-\\[120px\\]{min-width:120px}.min-w-\\[12rem\\]{min-width:12rem}.min-w-\\[140px\\]{min-width:140px}.min-w-\\[60px\\]{min-width:60px}.min-w-\\[8rem\\]{min-width:8rem}.min-w-\\[var\\(--radix-select-trigger-width\\)\\]{min-width:var(--radix-select-trigger-width)}.min-w-full{min-width:100%}.min-w-max{min-width:-moz-max-content;min-width:max-content}.max-w-2xl{max-width:42rem}.max-w-4xl{max-width:56rem}.max-w-5xl{max-width:64rem}.max-w-64{max-width:16rem}.max-w-6xl{max-width:72rem}.max-w-7xl{max-width:80rem}.max-w-\\[--skeleton-width\\]{max-width:var(--skeleton-width)}.max-w-\\[150px\\]{max-width:150px}.max-w-\\[200px\\]{max-width:200px}.max-w-full{max-width:100%}.max-w-lg{max-width:32rem}.max-w-max{max-width:-moz-max-content;max-width:max-content}.max-w-md{max-width:28rem}.max-w-none{max-width:none}.max-w-sm{max-width:24rem}.max-w-xs{max-width:20rem}.flex-1{flex:1 1 0%}.flex-shrink-0,.shrink-0{flex-shrink:0}.grow{flex-grow:1}.grow-0{flex-grow:0}.basis-full{flex-basis:100%}.caption-bottom{caption-side:bottom}.border-collapse{border-collapse:collapse}.origin-\\[--radix-context-menu-content-transform-origin\\]{transform-origin:var(--radix-context-menu-content-transform-origin)}.origin-\\[--radix-dropdown-menu-content-transform-origin\\]{transform-origin:var(--radix-dropdown-menu-content-transform-origin)}.origin-\\[--radix-hover-card-content-transform-origin\\]{transform-origin:var(--radix-hover-card-content-transform-origin)}.origin-\\[--radix-menubar-content-transform-origin\\]{transform-origin:var(--radix-menubar-content-transform-origin)}.origin-\\[--radix-popover-content-transform-origin\\]{transform-origin:var(--radix-popover-content-transform-origin)}.origin-\\[--radix-select-content-transform-origin\\]{transform-origin:var(--radix-select-content-transform-origin)}.origin-\\[--radix-tooltip-content-transform-origin\\]{transform-origin:var(--radix-tooltip-content-transform-origin)}.origin-left{transform-origin:left}.origin-top-left{transform-origin:top left}.-translate-x-1\\/2{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-px{--tw-translate-x: -1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\\/2{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-\\[-50\\%\\]{--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-full{--tw-translate-x: 100%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-px{--tw-translate-x: 1px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-\\[-50\\%\\]{--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-45{--tw-rotate: 45deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-90{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-100{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-105{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-125{--tw-scale-x: 1.25;--tw-scale-y: 1.25;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-75{--tw-scale-x: .75;--tw-scale-y: .75;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-\\[3\\]{--tw-scale-x: 3;--tw-scale-y: 3;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.transform-none{transform:none}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(360deg)}}.animate-spin{animation:spin 1s linear infinite}.cursor-default{cursor:default}.cursor-move{cursor:move}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.touch-manipulation{touch-action:manipulation}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.resize-none{resize:none}.list-inside{list-style-position:inside}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.items-stretch{align-items:stretch}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-1\\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.gap-x-1\\.5{-moz-column-gap:.375rem;column-gap:.375rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.gap-x-3{-moz-column-gap:.75rem;column-gap:.75rem}.gap-y-2{row-gap:.5rem}.gap-y-5{row-gap:1.25rem}.space-x-1>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.25rem * var(--tw-space-x-reverse));margin-left:calc(.25rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-6>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1.5rem * var(--tw-space-x-reverse));margin-left:calc(1.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.space-y-0\\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.125rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.125rem * var(--tw-space-y-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-1\\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.5rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse: 0;border-top-width:calc(1px * calc(1 - var(--tw-divide-y-reverse)));border-bottom-width:calc(1px * var(--tw-divide-y-reverse))}.divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity: 1;border-color:rgb(229 231 235 / var(--tw-divide-opacity, 1))}.overflow-auto{overflow:auto}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.whitespace-nowrap{white-space:nowrap}.whitespace-pre-line{white-space:pre-line}.whitespace-pre-wrap{white-space:pre-wrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-2xl{border-radius:1rem}.rounded-3xl{border-radius:1.5rem}.rounded-\\[2px\\]{border-radius:2px}.rounded-\\[inherit\\]{border-radius:inherit}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:var(--radius)}.rounded-md{border-radius:calc(var(--radius) - 2px)}.rounded-none{border-radius:0}.rounded-sm{border-radius:calc(var(--radius) - 4px)}.rounded-xl{border-radius:.75rem}.rounded-r-full{border-top-right-radius:9999px;border-bottom-right-radius:9999px}.rounded-t-\\[10px\\]{border-top-left-radius:10px;border-top-right-radius:10px}.rounded-tl-sm{border-top-left-radius:calc(var(--radius) - 4px)}.border{border-width:1px}.border-0{border-width:0px}.border-2{border-width:2px}.border-\\[1\\.5px\\]{border-width:1.5px}.border-y{border-top-width:1px;border-bottom-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l{border-left-width:1px}.border-l-4{border-left-width:4px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-dashed{border-style:dashed}.border-\\[--color-border\\]{border-color:var(--color-border)}.border-amber-200{--tw-border-opacity: 1;border-color:rgb(253 230 138 / var(--tw-border-opacity, 1))}.border-amber-300{--tw-border-opacity: 1;border-color:rgb(252 211 77 / var(--tw-border-opacity, 1))}.border-blue-200{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.border-blue-400{--tw-border-opacity: 1;border-color:rgb(96 165 250 / var(--tw-border-opacity, 1))}.border-blue-400\\/30{border-color:#60a5fa4d}.border-blue-600{--tw-border-opacity: 1;border-color:rgb(37 99 235 / var(--tw-border-opacity, 1))}.border-blue-600\\/30{border-color:#2563eb4d}.border-border{border-color:var(--border)}.border-destructive{border-color:var(--destructive)}.border-emerald-400{--tw-border-opacity: 1;border-color:rgb(52 211 153 / var(--tw-border-opacity, 1))}.border-gray-100{--tw-border-opacity: 1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity: 1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-200\\/50{border-color:#e5e7eb80}.border-gray-300{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-gray-800{--tw-border-opacity: 1;border-color:rgb(31 41 55 / var(--tw-border-opacity, 1))}.border-green-200{--tw-border-opacity: 1;border-color:rgb(187 247 208 / var(--tw-border-opacity, 1))}.border-green-300{--tw-border-opacity: 1;border-color:rgb(134 239 172 / var(--tw-border-opacity, 1))}.border-input{border-color:var(--input)}.border-orange-200{--tw-border-opacity: 1;border-color:rgb(254 215 170 / var(--tw-border-opacity, 1))}.border-primary{border-color:var(--primary)}.border-purple-200{--tw-border-opacity: 1;border-color:rgb(233 213 255 / var(--tw-border-opacity, 1))}.border-red-200{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.border-red-300{--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1))}.border-red-400{--tw-border-opacity: 1;border-color:rgb(248 113 113 / var(--tw-border-opacity, 1))}.border-red-500{--tw-border-opacity: 1;border-color:rgb(239 68 68 / var(--tw-border-opacity, 1))}.border-sidebar-border{border-color:var(--sidebar-border)}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity: 1;border-color:rgb(255 255 255 / var(--tw-border-opacity, 1))}.border-white\\/10{border-color:#ffffff1a}.border-white\\/30{border-color:#ffffff4d}.border-yellow-200{--tw-border-opacity: 1;border-color:rgb(254 240 138 / var(--tw-border-opacity, 1))}.border-l-transparent{border-left-color:transparent}.border-t-transparent{border-top-color:transparent}.\\!bg-white{--tw-bg-opacity: 1 !important;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))!important}.bg-\\[\\#22C55E\\]{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-\\[\\#EF4444\\]{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-\\[\\#F59E0B\\]{--tw-bg-opacity: 1;background-color:rgb(245 158 11 / var(--tw-bg-opacity, 1))}.bg-\\[\\#b6d1fc\\]{--tw-bg-opacity: 1;background-color:rgb(182 209 252 / var(--tw-bg-opacity, 1))}.bg-\\[\\#e6effd\\]{--tw-bg-opacity: 1;background-color:rgb(230 239 253 / var(--tw-bg-opacity, 1))}.bg-\\[--color-bg\\]{background-color:var(--color-bg)}.bg-accent{background-color:var(--accent)}.bg-amber-100{--tw-bg-opacity: 1;background-color:rgb(254 243 199 / var(--tw-bg-opacity, 1))}.bg-amber-50{--tw-bg-opacity: 1;background-color:rgb(255 251 235 / var(--tw-bg-opacity, 1))}.bg-amber-600{--tw-bg-opacity: 1;background-color:rgb(217 119 6 / var(--tw-bg-opacity, 1))}.bg-background{background-color:var(--background)}.bg-black{--tw-bg-opacity: 1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-black\\/20{background-color:#0003}.bg-black\\/30{background-color:#0000004d}.bg-black\\/50{background-color:#00000080}.bg-black\\/80{background-color:#000c}.bg-blue-100{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity: 1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-blue-900{--tw-bg-opacity: 1;background-color:rgb(30 58 138 / var(--tw-bg-opacity, 1))}.bg-border{background-color:var(--border)}.bg-card{background-color:var(--card)}.bg-current{background-color:currentColor}.bg-destructive{background-color:var(--destructive)}.bg-emerald-500{--tw-bg-opacity: 1;background-color:rgb(16 185 129 / var(--tw-bg-opacity, 1))}.bg-foreground{background-color:var(--foreground)}.bg-gray-100{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-200{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.bg-gray-300{--tw-bg-opacity: 1;background-color:rgb(209 213 219 / var(--tw-bg-opacity, 1))}.bg-gray-400{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity: 1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-gray-900{--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-200{--tw-bg-opacity: 1;background-color:rgb(187 247 208 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity: 1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity: 1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-muted{background-color:var(--muted)}.bg-orange-100{--tw-bg-opacity: 1;background-color:rgb(255 237 213 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity: 1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-orange-500{--tw-bg-opacity: 1;background-color:rgb(249 115 22 / var(--tw-bg-opacity, 1))}.bg-popover{background-color:var(--popover)}.bg-primary{background-color:var(--primary)}.bg-purple-100{--tw-bg-opacity: 1;background-color:rgb(243 232 255 / var(--tw-bg-opacity, 1))}.bg-red-100{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-red-50{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity: 1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-red-600{--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.bg-secondary{background-color:var(--secondary)}.bg-sidebar{background-color:var(--sidebar)}.bg-sidebar-border{background-color:var(--sidebar-border)}.bg-sidebar-primary{background-color:var(--sidebar-primary)}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\\/10{background-color:#ffffff1a}.bg-white\\/20{background-color:#fff3}.bg-white\\/40{background-color:#fff6}.bg-white\\/60{background-color:#fff9}.bg-white\\/80{background-color:#fffc}.bg-white\\/95{background-color:#fffffff2}.bg-yellow-100{--tw-bg-opacity: 1;background-color:rgb(254 249 195 / var(--tw-bg-opacity, 1))}.bg-yellow-50{--tw-bg-opacity: 1;background-color:rgb(254 252 232 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity: .5}.bg-opacity-75{--tw-bg-opacity: .75}.bg-opacity-80{--tw-bg-opacity: .8}.bg-opacity-90{--tw-bg-opacity: .9}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-blue-50{--tw-gradient-from: #eff6ff var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 246 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500{--tw-gradient-from: #3b82f6 var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-500\\/5{--tw-gradient-from: rgb(59 130 246 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(59 130 246 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-900{--tw-gradient-from: #1e3a8a var(--tw-gradient-from-position);--tw-gradient-to: rgb(30 58 138 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-blue-950{--tw-gradient-from: #172554 var(--tw-gradient-from-position);--tw-gradient-to: rgb(23 37 84 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-gray-900{--tw-gradient-from: #111827 var(--tw-gradient-from-position);--tw-gradient-to: rgb(17 24 39 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-green-500\\/5{--tw-gradient-from: rgb(34 197 94 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(34 197 94 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-orange-500\\/5{--tw-gradient-from: rgb(249 115 22 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(249 115 22 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-red-500\\/5{--tw-gradient-from: rgb(239 68 68 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(239 68 68 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\\/20{--tw-gradient-from: rgb(255 255 255 / .2) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.from-white\\/5{--tw-gradient-from: rgb(255 255 255 / .05) var(--tw-gradient-from-position);--tw-gradient-to: rgb(255 255 255 / 0) var(--tw-gradient-to-position);--tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to)}.to-blue-600{--tw-gradient-to: #2563eb var(--tw-gradient-to-position)}.to-cyan-800{--tw-gradient-to: #155e75 var(--tw-gradient-to-position)}.to-cyan-900{--tw-gradient-to: #164e63 var(--tw-gradient-to-position)}.to-gray-700{--tw-gradient-to: #374151 var(--tw-gradient-to-position)}.to-indigo-50{--tw-gradient-to: #eef2ff var(--tw-gradient-to-position)}.to-transparent{--tw-gradient-to: transparent var(--tw-gradient-to-position)}.bg-clip-text{-webkit-background-clip:text;background-clip:text}.fill-current{fill:currentColor}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.object-left{-o-object-position:left;object-position:left}.p-0{padding:0}.p-1{padding:.25rem}.p-12{padding:3rem}.p-2{padding:.5rem}.p-24{padding:6rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-\\[1px\\]{padding:1px}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-\\[max\\(env\\(safe-area-inset-left\\)\\,16px\\)\\]{padding-left:max(env(safe-area-inset-left),16px);padding-right:max(env(safe-area-inset-left),16px)}.py-0\\.5{padding-top:.125rem;padding-bottom:.125rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-1\\.5{padding-top:.375rem;padding-bottom:.375rem}.py-12{padding-top:3rem;padding-bottom:3rem}.py-16{padding-top:4rem;padding-bottom:4rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-\\[max\\(env\\(safe-area-inset-top\\)\\,16px\\)\\]{padding-top:max(env(safe-area-inset-top),16px);padding-bottom:max(env(safe-area-inset-top),16px)}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pb-4{padding-bottom:1rem}.pb-5{padding-bottom:1.25rem}.pb-6{padding-bottom:1.5rem}.pl-0{padding-left:0}.pl-10{padding-left:2.5rem}.pl-2\\.5{padding-left:.625rem}.pl-3{padding-left:.75rem}.pl-4{padding-left:1rem}.pl-6{padding-left:1.5rem}.pl-8{padding-left:2rem}.pr-10{padding-right:2.5rem}.pr-12{padding-right:3rem}.pr-16{padding-right:4rem}.pr-2{padding-right:.5rem}.pr-2\\.5{padding-right:.625rem}.pr-3{padding-right:.75rem}.pr-4{padding-right:1rem}.pr-8{padding-right:2rem}.pt-0{padding-top:0}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-3{padding-top:.75rem}.pt-4{padding-top:1rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.align-middle{vertical-align:middle}.font-\\[\\'Poppins\\'\\]{font-family:Poppins}.font-mono{font-family:var(--font-mono)}.font-sans{font-family:var(--font-sans)}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-6xl{font-size:3.75rem;line-height:1}.text-\\[0\\.8rem\\]{font-size:.8rem}.text-\\[11px\\]{font-size:11px}.text-\\[clamp\\(10px\\,1\\.3vmin\\,14px\\)\\]{font-size:clamp(10px,1.3vmin,14px)}.text-\\[clamp\\(14px\\,1\\.8vmin\\,16px\\)\\]{font-size:clamp(14px,1.8vmin,16px)}.text-\\[clamp\\(16px\\,2\\.0vmin\\,18px\\)\\]{font-size:clamp(16px,2vmin,18px)}.text-\\[clamp\\(20px\\,2\\.4vmin\\,22px\\)\\]{font-size:clamp(20px,2.4vmin,22px)}.text-\\[clamp\\(7px\\,1\\.0vmin\\,9px\\)\\]{font-size:clamp(7px,1vmin,9px)}.text-\\[clamp\\(8px\\,1\\.1vmin\\,10px\\)\\]{font-size:clamp(8px,1.1vmin,10px)}.text-\\[clamp\\(9px\\,1\\.2vmin\\,12px\\)\\]{font-size:clamp(9px,1.2vmin,12px)}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.tabular-nums{--tw-numeric-spacing: tabular-nums;font-variant-numeric:var(--tw-ordinal) var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-numeric-fraction)}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-\\[0\\.1em\\]{letter-spacing:.1em}.tracking-\\[0\\.2em\\]{letter-spacing:.2em}.tracking-tight{letter-spacing:-.025em}.tracking-wide{letter-spacing:.025em}.tracking-wider{letter-spacing:.05em}.tracking-widest{letter-spacing:.1em}.text-\\[\\#0053a6\\]{--tw-text-opacity: 1;color:rgb(0 83 166 / var(--tw-text-opacity, 1))}.text-\\[\\#2463eb\\]{--tw-text-opacity: 1;color:rgb(36 99 235 / var(--tw-text-opacity, 1))}.text-\\[\\#65758b\\]{--tw-text-opacity: 1;color:rgb(101 117 139 / var(--tw-text-opacity, 1))}.text-accent-foreground{color:var(--accent-foreground)}.text-amber-500{--tw-text-opacity: 1;color:rgb(245 158 11 / var(--tw-text-opacity, 1))}.text-amber-600{--tw-text-opacity: 1;color:rgb(217 119 6 / var(--tw-text-opacity, 1))}.text-amber-700{--tw-text-opacity: 1;color:rgb(180 83 9 / var(--tw-text-opacity, 1))}.text-amber-800{--tw-text-opacity: 1;color:rgb(146 64 14 / var(--tw-text-opacity, 1))}.text-black{--tw-text-opacity: 1;color:rgb(0 0 0 / var(--tw-text-opacity, 1))}.text-blue-500{--tw-text-opacity: 1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-blue-600{--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-700{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity: 1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-card-foreground{color:var(--card-foreground)}.text-current{color:currentColor}.text-destructive{color:var(--destructive)}.text-destructive-foreground{color:var(--destructive-foreground)}.text-foreground{color:var(--foreground)}.text-gray-300{--tw-text-opacity: 1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity: 1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-gray-900{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.text-green-500{--tw-text-opacity: 1;color:rgb(34 197 94 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-700{--tw-text-opacity: 1;color:rgb(21 128 61 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity: 1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-green-900{--tw-text-opacity: 1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.text-muted-foreground{color:var(--muted-foreground)}.text-orange-500{--tw-text-opacity: 1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity: 1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-700{--tw-text-opacity: 1;color:rgb(194 65 12 / var(--tw-text-opacity, 1))}.text-orange-800{--tw-text-opacity: 1;color:rgb(154 52 18 / var(--tw-text-opacity, 1))}.text-popover-foreground{color:var(--popover-foreground)}.text-primary{color:var(--primary)}.text-primary-foreground{color:var(--primary-foreground)}.text-purple-600{--tw-text-opacity: 1;color:rgb(147 51 234 / var(--tw-text-opacity, 1))}.text-purple-800{--tw-text-opacity: 1;color:rgb(107 33 168 / var(--tw-text-opacity, 1))}.text-red-500{--tw-text-opacity: 1;color:rgb(239 68 68 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-red-700{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.text-red-800{--tw-text-opacity: 1;color:rgb(153 27 27 / var(--tw-text-opacity, 1))}.text-secondary{color:var(--secondary)}.text-secondary-foreground{color:var(--secondary-foreground)}.text-sidebar-foreground{color:var(--sidebar-foreground)}.text-sidebar-primary-foreground{color:var(--sidebar-primary-foreground)}.text-slate-600{--tw-text-opacity: 1;color:rgb(71 85 105 / var(--tw-text-opacity, 1))}.text-success{color:var(--success)}.text-transparent{color:transparent}.text-warning{color:var(--warning)}.text-white{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-white\\/60{color:#fff9}.text-white\\/80{color:#fffc}.text-yellow-500{--tw-text-opacity: 1;color:rgb(234 179 8 / var(--tw-text-opacity, 1))}.text-yellow-600{--tw-text-opacity: 1;color:rgb(202 138 4 / var(--tw-text-opacity, 1))}.text-yellow-700{--tw-text-opacity: 1;color:rgb(161 98 7 / var(--tw-text-opacity, 1))}.text-yellow-800{--tw-text-opacity: 1;color:rgb(133 77 14 / var(--tw-text-opacity, 1))}.underline{text-decoration-line:underline}.underline-offset-4{text-underline-offset:4px}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-20{opacity:.2}.opacity-30{opacity:.3}.opacity-40{opacity:.4}.opacity-50{opacity:.5}.opacity-60{opacity:.6}.opacity-70{opacity:.7}.opacity-75{opacity:.75}.opacity-80{opacity:.8}.opacity-90{opacity:.9}.mix-blend-screen{mix-blend-mode:screen}.shadow-2xl{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-border\\)\\)\\]{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-border));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow: 0 0 #0000;--tw-shadow-colored: 0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow: 0 20px 25px -5px rgb(0 0 0 / .1), 0 8px 10px -6px rgb(0 0 0 / .1);--tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color), 0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.shadow-blue-500\\/20{--tw-shadow-color: rgb(59 130 246 / .2);--tw-shadow: var(--tw-shadow-colored)}.shadow-card{--tw-shadow-color: var(--card);--tw-shadow: var(--tw-shadow-colored)}.shadow-emerald-200{--tw-shadow-color: #a7f3d0;--tw-shadow: var(--tw-shadow-colored)}.shadow-gray-200{--tw-shadow-color: #e5e7eb;--tw-shadow: var(--tw-shadow-colored)}.shadow-red-200{--tw-shadow-color: #fecaca;--tw-shadow: var(--tw-shadow-colored)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.ring{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-0{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-2{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.ring-blue-400\\/20{--tw-ring-color: rgb(96 165 250 / .2)}.ring-blue-500{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.ring-ring{--tw-ring-color: var(--ring)}.ring-sidebar-ring{--tw-ring-color: var(--sidebar-ring)}.ring-white\\/10{--tw-ring-color: rgb(255 255 255 / .1)}.ring-offset-background{--tw-ring-offset-color: var(--background)}.blur{--tw-blur: blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow{--tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0 / .1)) drop-shadow(0 1px 1px rgb(0 0 0 / .06));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.drop-shadow-sm{--tw-drop-shadow: drop-shadow(0 1px 1px rgb(0 0 0 / .05));filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur{--tw-backdrop-blur: blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-lg{--tw-backdrop-blur: blur(16px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-md{--tw-backdrop-blur: blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-blur-sm{--tw-backdrop-blur: blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.backdrop-filter{-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[left\\,right\\,width\\]{transition-property:left,right,width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[margin\\,opacity\\]{transition-property:margin,opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\,height\\,padding\\]{transition-property:width,height,padding;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-\\[width\\]{transition-property:width;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-colors{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-none{transition-property:none}.transition-opacity{transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.15s}.duration-1000{transition-duration:1s}.duration-150{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{transition-timing-function:linear}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity, 1);transform:translate3d(var(--tw-enter-translate-x, 0),var(--tw-enter-translate-y, 0),0) scale3d(var(--tw-enter-scale, 1),var(--tw-enter-scale, 1),var(--tw-enter-scale, 1)) rotate(var(--tw-enter-rotate, 0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity, 1);transform:translate3d(var(--tw-exit-translate-x, 0),var(--tw-exit-translate-y, 0),0) scale3d(var(--tw-exit-scale, 1),var(--tw-exit-scale, 1),var(--tw-exit-scale, 1)) rotate(var(--tw-exit-rotate, 0))}}.animate-in{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.fade-in-0{--tw-enter-opacity: 0}.fade-in-80{--tw-enter-opacity: .8}.zoom-in-95{--tw-enter-scale: .95}.duration-1000{animation-duration:1s}.duration-150{animation-duration:.15s}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.duration-500{animation-duration:.5s}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-linear{animation-timing-function:linear}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.running{animation-play-state:running}:root{--animation-duration: .8s}@media (prefers-reduced-motion: reduce){:root{--animation-duration: 0ms}*{animation-duration:.01ms!important;animation-iteration-count:1!important;transition-duration:.01ms!important}}@keyframes drawArc{0%{stroke-dasharray:0 1000}to{stroke-dasharray:1000 0}}.animate-drawArc{animation:drawArc 1s ease-out forwards}@media (prefers-reduced-motion: reduce){.animate-drawArc{animation:none!important;stroke-dasharray:1000 0!important}}.card-font{font-family:Space Grotesk,system-ui,-apple-system,sans-serif}.embossed-text{text-shadow:0 1px 2px rgba(0,0,0,.4),0 0 8px rgba(255,255,255,.1)}@keyframes goldShimmer{0%{background-position:-200% -200%}50%{background-position:200% 200%}to{background-position:-200% -200%}}.debossed-qr-container{width:100px;height:100px;padding:10px;border-radius:12px;background:#0000001a;box-shadow:inset 0 2px 4px #0000004d,inset 0 0 1px #00000080,0 1px #ffffff1a;position:relative}.debossed-qr-frame{width:100%;height:100%;border-radius:6px;background:#0000000d;box-shadow:inset 0 1px 2px #0006,0 0 0 1px #ffffff0d;display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden}.debossed-qr-frame:before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;background:linear-gradient(45deg,transparent 30%,rgba(255,255,255,.6) 50%,transparent 70%),linear-gradient(135deg,rgba(255,255,255,.3) 0%,transparent 30%,rgba(255,255,255,.15) 100%),repeating-linear-gradient(45deg,transparent 0px,rgba(255,255,255,.1) 1px,transparent 3px);pointer-events:none;border-radius:6px}.debossed-qr{opacity:1;filter:contrast(1.2) brightness(1.4) saturate(.8) drop-shadow(0 0 1px rgba(255,255,255,.6)) drop-shadow(0 1px 2px rgba(0,0,0,.3)) drop-shadow(0 0 4px rgba(184,188,200,.5)) drop-shadow(0 -1px 0 rgba(255,255,255,.2))}.debossed-icon{filter:drop-shadow(0 1px 1px rgba(0,0,0,.4)) drop-shadow(0 0 2px rgba(0,0,0,.2));opacity:.7}@keyframes flip-horizontal{0%{transform:perspective(1000px) rotateY(0)}50%{transform:perspective(1000px) rotateY(180deg)}to{transform:perspective(1000px) rotateY(360deg)}}.animate-flip-horizontal{animation:flip-horizontal .4s cubic-bezier(.25,.46,.45,.94);transform-style:preserve-3d}@media (prefers-reduced-motion: reduce){.animate-flip-horizontal{animation:none!important}}:root{--background: linear-gradient(135deg, hsl(210, 20%, 98%) 0%, hsl(210, 16%, 96%) 50%, hsl(210, 12%, 94%) 100%);--foreground: hsl(221, 39%, 11%);--card: hsl(0, 0%, 100%);--card-foreground: hsl(221, 39%, 11%);--popover: hsl(0, 0%, 100%);--popover-foreground: hsl(221, 39%, 11%);--primary: hsl(217, 91%, 60%);--primary-foreground: hsl(0, 0%, 100%);--secondary: hsl(221, 83%, 53%);--secondary-foreground: hsl(0, 0%, 100%);--muted: hsl(220, 13%, 95%);--muted-foreground: hsl(215, 16%, 47%);--accent: hsl(217, 91%, 95%);--accent-foreground: hsl(217, 91%, 20%);--tab-active: hsl(217, 91%, 85%);--tab-active-foreground: hsl(217, 91%, 15%);--destructive: hsl(0, 72%, 51%);--destructive-foreground: hsl(0, 0%, 100%);--success: hsl(142, 71%, 45%);--success-foreground: hsl(0, 0%, 100%);--warning: hsl(38, 92%, 50%);--warning-foreground: hsl(0, 0%, 100%);--info: hsl(221, 83%, 53%);--info-foreground: hsl(0, 0%, 100%);--border: hsl(214, 32%, 91%);--input: hsl(214, 32%, 91%);--ring: hsl(217, 91%, 60%);--chart-1: hsl(217, 91%, 60%);--chart-2: hsl(221, 83%, 53%);--chart-3: hsl(212, 100%, 50%);--chart-4: hsl(207, 90%, 54%);--chart-5: hsl(38, 92%, 50%);--sidebar: hsl(215, 28%, 17%);--sidebar-foreground: hsl(213, 31%, 91%);--sidebar-primary: hsl(217, 91%, 60%);--sidebar-primary-foreground: hsl(0, 0%, 100%);--sidebar-accent: hsl(215, 25%, 25%);--sidebar-accent-foreground: hsl(213, 31%, 91%);--sidebar-border: hsl(215, 25%, 25%);--sidebar-ring: hsl(217, 91%, 60%);--font-sans: \"Poppins\", ui-sans-serif, system-ui;--font-serif: Georgia, serif;--font-mono: \"SF Mono\", Monaco, \"Cascadia Code\", \"Roboto Mono\", Consolas, \"Courier New\", monospace;--radius: 12px;--shadow-sm: 0 1px 2px 0 rgb(0 0 0 / .02), 0 1px 3px 0 rgb(0 0 0 / .04);--shadow: 0 1px 3px 0 rgb(0 0 0 / .04), 0 4px 8px 0 rgb(0 0 0 / .02);--shadow-md: 0 4px 12px -2px rgb(0 0 0 / .04), 0 4px 8px -2px rgb(0 0 0 / .03);--shadow-lg: 0 8px 25px -5px rgb(0 0 0 / .06), 0 8px 16px -8px rgb(0 0 0 / .03);--shadow-xl: 0 20px 40px -8px rgb(0 0 0 / .08), 0 8px 16px -8px rgb(0 0 0 / .04);--shadow-2xl: 0 32px 64px -12px rgb(0 0 0 / .1), 0 16px 32px -16px rgb(0 0 0 / .06);--glass-shadow: 0 8px 32px 0 rgb(31 38 135 / .08);--glass-shadow-hover: 0 16px 48px 0 rgb(31 38 135 / .12);--spacing-1: .25rem;--spacing-2: .5rem;--spacing-3: .75rem;--spacing-4: 1rem;--spacing-5: 1.25rem;--spacing-6: 1.5rem;--spacing-8: 2rem;--spacing-10: 2.5rem}.dark{--background: linear-gradient(135deg, hsl(222, 84%, 5%) 0%, hsl(222, 70%, 4%) 50%, hsl(222, 60%, 3%) 100%);--foreground: hsl(213, 31%, 91%);--card: hsl(222, 84%, 5%);--card-foreground: hsl(213, 31%, 91%);--popover: hsl(215, 28%, 17%);--popover-foreground: hsl(213, 31%, 91%);--primary: hsl(221, 83%, 53%);--primary-foreground: hsl(0, 0%, 100%);--secondary: hsl(212, 100%, 50%);--secondary-foreground: hsl(0, 0%, 100%);--muted: hsl(215, 25%, 15%);--muted-foreground: hsl(217, 10%, 64%);--accent: hsl(215, 25%, 15%);--accent-foreground: hsl(217, 10%, 64%);--destructive: hsl(0, 62%, 63%);--destructive-foreground: hsl(0, 0%, 100%);--success: hsl(142, 71%, 45%);--success-foreground: hsl(0, 0%, 100%);--warning: hsl(38, 92%, 50%);--warning-foreground: hsl(0, 0%, 100%);--info: hsl(221, 83%, 53%);--info-foreground: hsl(0, 0%, 100%);--border: hsl(215, 25%, 25%);--input: hsl(215, 25%, 25%);--ring: hsl(221, 83%, 53%);--chart-1: hsl(221, 83%, 53%);--chart-2: hsl(212, 100%, 50%);--chart-3: hsl(217, 91%, 60%);--chart-4: hsl(207, 90%, 54%);--chart-5: hsl(38, 92%, 50%);--sidebar: hsl(215, 28%, 17%);--sidebar-foreground: hsl(213, 31%, 91%);--sidebar-primary: hsl(221, 83%, 53%);--sidebar-primary-foreground: hsl(0, 0%, 100%);--sidebar-accent: hsl(215, 25%, 25%);--sidebar-accent-foreground: hsl(213, 31%, 91%);--sidebar-border: hsl(215, 25%, 25%);--sidebar-ring: hsl(221, 83%, 53%)}.file\\:border-0::file-selector-button{border-width:0px}.file\\:bg-transparent::file-selector-button{background-color:transparent}.file\\:text-sm::file-selector-button{font-size:.875rem;line-height:1.25rem}.file\\:font-medium::file-selector-button{font-weight:500}.file\\:text-foreground::file-selector-button{color:var(--foreground)}.placeholder\\:text-gray-500::-moz-placeholder{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.placeholder\\:text-gray-500::placeholder{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.placeholder\\:text-muted-foreground::-moz-placeholder{color:var(--muted-foreground)}.placeholder\\:text-muted-foreground::placeholder{color:var(--muted-foreground)}.after\\:absolute:after{content:var(--tw-content);position:absolute}.after\\:-inset-2:after{content:var(--tw-content);top:-.5rem;right:-.5rem;bottom:-.5rem;left:-.5rem}.after\\:inset-y-0:after{content:var(--tw-content);top:0;bottom:0}.after\\:left-1\\/2:after{content:var(--tw-content);left:50%}.after\\:w-1:after{content:var(--tw-content);width:.25rem}.after\\:w-\\[2px\\]:after{content:var(--tw-content);width:2px}.after\\:-translate-x-1\\/2:after{content:var(--tw-content);--tw-translate-x: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.first\\:rounded-l-md:first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.first\\:border-l:first-child{border-left-width:1px}.last\\:rounded-r-md:last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.last\\:border-0:last-child{border-width:0px}.last\\:border-b-0:last-child{border-bottom-width:0px}.focus-within\\:relative:focus-within{position:relative}.focus-within\\:z-20:focus-within{z-index:20}.hover\\:h-5:hover{height:1.25rem}.hover\\:-translate-y-0\\.5:hover{--tw-translate-y: -.125rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-100:hover{--tw-scale-x: 1;--tw-scale-y: 1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-105:hover{--tw-scale-x: 1.05;--tw-scale-y: 1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:scale-110:hover{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\\:border-blue-200:hover{--tw-border-opacity: 1;border-color:rgb(191 219 254 / var(--tw-border-opacity, 1))}.hover\\:border-gray-300:hover{--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.hover\\:border-gray-500:hover{--tw-border-opacity: 1;border-color:rgb(107 114 128 / var(--tw-border-opacity, 1))}.hover\\:border-red-200:hover{--tw-border-opacity: 1;border-color:rgb(254 202 202 / var(--tw-border-opacity, 1))}.hover\\:bg-\\[\\#f9fafb\\]:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\\:bg-accent:hover{background-color:var(--accent)}.hover\\:bg-amber-700:hover{--tw-bg-opacity: 1;background-color:rgb(180 83 9 / var(--tw-bg-opacity, 1))}.hover\\:bg-black\\/30:hover{background-color:#0000004d}.hover\\:bg-blue-100:hover{--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-50:hover{--tw-bg-opacity: 1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.hover\\:bg-blue-700:hover{--tw-bg-opacity: 1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-100:hover{--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-200:hover{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-50:hover{--tw-bg-opacity: 1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.hover\\:bg-gray-700:hover{--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-100:hover{--tw-bg-opacity: 1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-50:hover{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.hover\\:bg-green-700:hover{--tw-bg-opacity: 1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\\:bg-muted:hover{background-color:var(--muted)}.hover\\:bg-primary:hover{background-color:var(--primary)}.hover\\:bg-red-100:hover{--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-50:hover{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.hover\\:bg-red-700:hover{--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\\:bg-secondary:hover{background-color:var(--secondary)}.hover\\:bg-sidebar-accent:hover{background-color:var(--sidebar-accent)}.hover\\:bg-transparent:hover{background-color:transparent}.hover\\:bg-white\\/10:hover{background-color:#ffffff1a}.hover\\:bg-white\\/20:hover{background-color:#fff3}.hover\\:bg-opacity-100:hover{--tw-bg-opacity: 1}.hover\\:bg-opacity-75:hover{--tw-bg-opacity: .75}.hover\\:bg-opacity-90:hover{--tw-bg-opacity: .9}.hover\\:text-accent-foreground:hover{color:var(--accent-foreground)}.hover\\:text-blue-700:hover{--tw-text-opacity: 1;color:rgb(29 78 216 / var(--tw-text-opacity, 1))}.hover\\:text-blue-800:hover{--tw-text-opacity: 1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\\:text-foreground:hover{color:var(--foreground)}.hover\\:text-gray-500:hover{--tw-text-opacity: 1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.hover\\:text-gray-600:hover{--tw-text-opacity: 1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.hover\\:text-gray-700:hover{--tw-text-opacity: 1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.hover\\:text-gray-900:hover{--tw-text-opacity: 1;color:rgb(17 24 39 / var(--tw-text-opacity, 1))}.hover\\:text-muted-foreground:hover{color:var(--muted-foreground)}.hover\\:text-primary-foreground:hover{color:var(--primary-foreground)}.hover\\:text-red-600:hover{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.hover\\:text-red-700:hover{--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.hover\\:text-sidebar-accent-foreground:hover{color:var(--sidebar-accent-foreground)}.hover\\:text-sidebar-foreground:hover{color:var(--sidebar-foreground)}.hover\\:text-white:hover{--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\\:underline:hover{text-decoration-line:underline}.hover\\:no-underline:hover{text-decoration-line:none}.hover\\:opacity-100:hover{opacity:1}.hover\\:shadow-\\[0_0_0_1px_hsl\\(var\\(--sidebar-accent\\)\\)\\]:hover{--tw-shadow: 0 0 0 1px hsl(var(--sidebar-accent));--tw-shadow-colored: 0 0 0 1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-lg:hover{--tw-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:shadow-md:hover{--tw-shadow: 0 4px 6px -1px rgb(0 0 0 / .1), 0 2px 4px -2px rgb(0 0 0 / .1);--tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.hover\\:after\\:bg-sidebar-border:hover:after{content:var(--tw-content);background-color:var(--sidebar-border)}.focus\\:border-blue-300:focus{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1))}.focus\\:border-blue-500:focus{--tw-border-opacity: 1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\\:bg-accent:focus{background-color:var(--accent)}.focus\\:bg-green-50:focus{--tw-bg-opacity: 1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.focus\\:bg-primary:focus{background-color:var(--primary)}.focus\\:bg-red-50:focus{--tw-bg-opacity: 1;background-color:rgb(254 242 242 / var(--tw-bg-opacity, 1))}.focus\\:bg-transparent:focus{background-color:transparent}.focus\\:bg-white:focus{--tw-bg-opacity: 1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.focus\\:text-accent-foreground:focus{color:var(--accent-foreground)}.focus\\:text-green-600:focus{--tw-text-opacity: 1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.focus\\:text-primary-foreground:focus{color:var(--primary-foreground)}.focus\\:text-red-600:focus{--tw-text-opacity: 1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.focus\\:opacity-100:focus{opacity:1}.focus\\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\\:ring-2:focus{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus\\:ring-blue-400:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1))}.focus\\:ring-blue-400\\/50:focus{--tw-ring-color: rgb(96 165 250 / .5)}.focus\\:ring-blue-500:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.focus\\:ring-blue-500\\/20:focus{--tw-ring-color: rgb(59 130 246 / .2)}.focus\\:ring-ring:focus{--tw-ring-color: var(--ring)}.focus\\:ring-white\\/50:focus{--tw-ring-color: rgb(255 255 255 / .5)}.focus\\:ring-opacity-40:focus{--tw-ring-opacity: .4}.focus\\:ring-offset-2:focus{--tw-ring-offset-width: 2px}.focus-visible\\:outline-none:focus-visible{outline:2px solid transparent;outline-offset:2px}.focus-visible\\:ring-1:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-2:focus-visible{--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000)}.focus-visible\\:ring-blue-400:focus-visible{--tw-ring-opacity: 1;--tw-ring-color: rgb(96 165 250 / var(--tw-ring-opacity, 1))}.focus-visible\\:ring-primary:focus-visible{--tw-ring-color: var(--primary)}.focus-visible\\:ring-ring:focus-visible{--tw-ring-color: var(--ring)}.focus-visible\\:ring-sidebar-ring:focus-visible{--tw-ring-color: var(--sidebar-ring)}.focus-visible\\:ring-offset-1:focus-visible{--tw-ring-offset-width: 1px}.focus-visible\\:ring-offset-2:focus-visible{--tw-ring-offset-width: 2px}.focus-visible\\:ring-offset-background:focus-visible{--tw-ring-offset-color: var(--background)}.active\\:bg-sidebar-accent:active{background-color:var(--sidebar-accent)}.active\\:bg-transparent:active{background-color:transparent}.active\\:text-sidebar-accent-foreground:active{color:var(--sidebar-accent-foreground)}.disabled\\:pointer-events-none:disabled{pointer-events:none}.disabled\\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\\:bg-gray-400:disabled{--tw-bg-opacity: 1;background-color:rgb(156 163 175 / var(--tw-bg-opacity, 1))}.disabled\\:opacity-50:disabled{opacity:.5}.group\\/menu-item:focus-within .group-focus-within\\/menu-item\\:opacity-100{opacity:1}.group:hover .group-hover\\:scale-110{--tw-scale-x: 1.1;--tw-scale-y: 1.1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group:hover .group-hover\\:text-primary{color:var(--primary)}.group:hover .group-hover\\:text-opacity-80{--tw-text-opacity: .8}.group\\/menu-item:hover .group-hover\\/menu-item\\:opacity-100,.group:hover .group-hover\\:opacity-100{opacity:1}.group.destructive .group-\\[\\.destructive\\]\\:text-red-300{--tw-text-opacity: 1;color:rgb(252 165 165 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:bg-destructive:hover{background-color:var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-destructive-foreground:hover{color:var(--destructive-foreground)}.group.destructive .group-\\[\\.destructive\\]\\:hover\\:text-red-50:hover{--tw-text-opacity: 1;color:rgb(254 242 242 / var(--tw-text-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-destructive:focus{--tw-ring-color: var(--destructive)}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-red-400:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(248 113 113 / var(--tw-ring-opacity, 1))}.group.destructive .group-\\[\\.destructive\\]\\:focus\\:ring-offset-red-600:focus{--tw-ring-offset-color: #dc2626}.peer\\/menu-button:hover~.peer-hover\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.peer:disabled~.peer-disabled\\:cursor-not-allowed{cursor:not-allowed}.peer:disabled~.peer-disabled\\:opacity-70{opacity:.7}.has-\\[\\[data-variant\\=inset\\]\\]\\:bg-sidebar:has([data-variant=inset]){background-color:var(--sidebar)}.has-\\[\\:disabled\\]\\:opacity-50:has(:disabled){opacity:.5}.group\\/menu-item:has([data-sidebar=menu-action]) .group-has-\\[\\[data-sidebar\\=menu-action\\]\\]\\/menu-item\\:pr-8{padding-right:2rem}.aria-disabled\\:pointer-events-none[aria-disabled=true]{pointer-events:none}.aria-disabled\\:opacity-50[aria-disabled=true]{opacity:.5}.aria-selected\\:bg-accent[aria-selected=true]{background-color:var(--accent)}.aria-selected\\:text-accent-foreground[aria-selected=true]{color:var(--accent-foreground)}.aria-selected\\:text-muted-foreground[aria-selected=true]{color:var(--muted-foreground)}.aria-selected\\:opacity-100[aria-selected=true]{opacity:1}.aria-selected\\:opacity-30[aria-selected=true]{opacity:.3}.data-\\[disabled\\=true\\]\\:pointer-events-none[data-disabled=true],.data-\\[disabled\\]\\:pointer-events-none[data-disabled]{pointer-events:none}.data-\\[panel-group-direction\\=vertical\\]\\:h-px[data-panel-group-direction=vertical]{height:1px}.data-\\[panel-group-direction\\=vertical\\]\\:w-full[data-panel-group-direction=vertical]{width:100%}.data-\\[side\\=bottom\\]\\:translate-y-1[data-side=bottom]{--tw-translate-y: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=left\\]\\:-translate-x-1[data-side=left]{--tw-translate-x: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=right\\]\\:translate-x-1[data-side=right]{--tw-translate-x: .25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[side\\=top\\]\\:-translate-y-1[data-side=top]{--tw-translate-y: -.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=checked\\]\\:translate-x-5[data-state=checked]{--tw-translate-x: 1.25rem;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=unchecked\\]\\:translate-x-0[data-state=unchecked],.data-\\[swipe\\=cancel\\]\\:translate-x-0[data-swipe=cancel]{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=end\\]\\:translate-x-\\[var\\(--radix-toast-swipe-end-x\\)\\][data-swipe=end]{--tw-translate-x: var(--radix-toast-swipe-end-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[swipe\\=move\\]\\:translate-x-\\[var\\(--radix-toast-swipe-move-x\\)\\][data-swipe=move]{--tw-translate-x: var(--radix-toast-swipe-move-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes accordion-up{0%{height:var(--radix-accordion-content-height)}to{height:0}}.data-\\[state\\=closed\\]\\:animate-accordion-up[data-state=closed]{animation:accordion-up .2s ease-out}@keyframes accordion-down{0%{height:0}to{height:var(--radix-accordion-content-height)}}.data-\\[state\\=open\\]\\:animate-accordion-down[data-state=open]{animation:accordion-down .2s ease-out}.data-\\[panel-group-direction\\=vertical\\]\\:flex-col[data-panel-group-direction=vertical]{flex-direction:column}.data-\\[active\\=true\\]\\:bg-sidebar-accent[data-active=true]{background-color:var(--sidebar-accent)}.data-\\[selected\\=\\'true\\'\\]\\:bg-accent[data-selected=true]{background-color:var(--accent)}.data-\\[state\\=active\\]\\:bg-\\[hsl\\(217\\,91\\%\\,85\\%\\)\\][data-state=active]{--tw-bg-opacity: 1;background-color:hsl(217 91% 85% / var(--tw-bg-opacity, 1))}.data-\\[state\\=checked\\]\\:bg-primary[data-state=checked]{background-color:var(--primary)}.data-\\[state\\=on\\]\\:bg-accent[data-state=on],.data-\\[state\\=open\\]\\:bg-accent[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:bg-secondary[data-state=open]{background-color:var(--secondary)}.data-\\[state\\=selected\\]\\:bg-muted[data-state=selected]{background-color:var(--muted)}.data-\\[state\\=unchecked\\]\\:bg-input[data-state=unchecked]{background-color:var(--input)}.data-\\[active\\=true\\]\\:font-medium[data-active=true]{font-weight:500}.data-\\[active\\=true\\]\\:text-sidebar-accent-foreground[data-active=true]{color:var(--sidebar-accent-foreground)}.data-\\[placeholder\\]\\:text-muted-foreground[data-placeholder]{color:var(--muted-foreground)}.data-\\[selected\\=true\\]\\:text-accent-foreground[data-selected=true]{color:var(--accent-foreground)}.data-\\[state\\=active\\]\\:text-\\[hsl\\(217\\,91\\%\\,15\\%\\)\\][data-state=active]{--tw-text-opacity: 1;color:hsl(217 91% 15% / var(--tw-text-opacity, 1))}.data-\\[state\\=checked\\]\\:text-primary-foreground[data-state=checked]{color:var(--primary-foreground)}.data-\\[state\\=on\\]\\:text-accent-foreground[data-state=on],.data-\\[state\\=open\\]\\:text-accent-foreground[data-state=open]{color:var(--accent-foreground)}.data-\\[state\\=open\\]\\:text-muted-foreground[data-state=open]{color:var(--muted-foreground)}.data-\\[disabled\\=true\\]\\:opacity-50[data-disabled=true],.data-\\[disabled\\]\\:opacity-50[data-disabled]{opacity:.5}.data-\\[state\\=open\\]\\:opacity-100[data-state=open]{opacity:1}.data-\\[state\\=active\\]\\:shadow-sm[data-state=active]{--tw-shadow: 0 1px 2px 0 rgb(0 0 0 / .05);--tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.data-\\[swipe\\=move\\]\\:transition-none[data-swipe=move]{transition-property:none}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{transition-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{transition-duration:.5s}.data-\\[motion\\^\\=from-\\]\\:animate-in[data-motion^=from-],.data-\\[state\\=open\\]\\:animate-in[data-state=open],.data-\\[state\\=visible\\]\\:animate-in[data-state=visible]{animation-name:enter;animation-duration:.15s;--tw-enter-opacity: initial;--tw-enter-scale: initial;--tw-enter-rotate: initial;--tw-enter-translate-x: initial;--tw-enter-translate-y: initial}.data-\\[motion\\^\\=to-\\]\\:animate-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:animate-out[data-state=closed],.data-\\[state\\=hidden\\]\\:animate-out[data-state=hidden],.data-\\[swipe\\=end\\]\\:animate-out[data-swipe=end]{animation-name:exit;animation-duration:.15s;--tw-exit-opacity: initial;--tw-exit-scale: initial;--tw-exit-rotate: initial;--tw-exit-translate-x: initial;--tw-exit-translate-y: initial}.data-\\[motion\\^\\=from-\\]\\:fade-in[data-motion^=from-]{--tw-enter-opacity: 0}.data-\\[motion\\^\\=to-\\]\\:fade-out[data-motion^=to-],.data-\\[state\\=closed\\]\\:fade-out-0[data-state=closed]{--tw-exit-opacity: 0}.data-\\[state\\=closed\\]\\:fade-out-80[data-state=closed]{--tw-exit-opacity: .8}.data-\\[state\\=hidden\\]\\:fade-out[data-state=hidden]{--tw-exit-opacity: 0}.data-\\[state\\=open\\]\\:fade-in-0[data-state=open],.data-\\[state\\=visible\\]\\:fade-in[data-state=visible]{--tw-enter-opacity: 0}.data-\\[state\\=closed\\]\\:zoom-out-95[data-state=closed]{--tw-exit-scale: .95}.data-\\[state\\=open\\]\\:zoom-in-90[data-state=open]{--tw-enter-scale: .9}.data-\\[state\\=open\\]\\:zoom-in-95[data-state=open]{--tw-enter-scale: .95}.data-\\[motion\\=from-end\\]\\:slide-in-from-right-52[data-motion=from-end]{--tw-enter-translate-x: 13rem}.data-\\[motion\\=from-start\\]\\:slide-in-from-left-52[data-motion=from-start]{--tw-enter-translate-x: -13rem}.data-\\[motion\\=to-end\\]\\:slide-out-to-right-52[data-motion=to-end]{--tw-exit-translate-x: 13rem}.data-\\[motion\\=to-start\\]\\:slide-out-to-left-52[data-motion=to-start]{--tw-exit-translate-x: -13rem}.data-\\[side\\=bottom\\]\\:slide-in-from-top-2[data-side=bottom]{--tw-enter-translate-y: -.5rem}.data-\\[side\\=left\\]\\:slide-in-from-right-2[data-side=left]{--tw-enter-translate-x: .5rem}.data-\\[side\\=right\\]\\:slide-in-from-left-2[data-side=right]{--tw-enter-translate-x: -.5rem}.data-\\[side\\=top\\]\\:slide-in-from-bottom-2[data-side=top]{--tw-enter-translate-y: .5rem}.data-\\[state\\=closed\\]\\:slide-out-to-bottom[data-state=closed]{--tw-exit-translate-y: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-left[data-state=closed]{--tw-exit-translate-x: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-left-1\\/2[data-state=closed]{--tw-exit-translate-x: -50%}.data-\\[state\\=closed\\]\\:slide-out-to-right[data-state=closed],.data-\\[state\\=closed\\]\\:slide-out-to-right-full[data-state=closed]{--tw-exit-translate-x: 100%}.data-\\[state\\=closed\\]\\:slide-out-to-top[data-state=closed]{--tw-exit-translate-y: -100%}.data-\\[state\\=closed\\]\\:slide-out-to-top-\\[48\\%\\][data-state=closed]{--tw-exit-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-bottom[data-state=open]{--tw-enter-translate-y: 100%}.data-\\[state\\=open\\]\\:slide-in-from-left[data-state=open]{--tw-enter-translate-x: -100%}.data-\\[state\\=open\\]\\:slide-in-from-left-1\\/2[data-state=open]{--tw-enter-translate-x: -50%}.data-\\[state\\=open\\]\\:slide-in-from-right[data-state=open]{--tw-enter-translate-x: 100%}.data-\\[state\\=open\\]\\:slide-in-from-top[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=open\\]\\:slide-in-from-top-\\[48\\%\\][data-state=open]{--tw-enter-translate-y: -48%}.data-\\[state\\=open\\]\\:slide-in-from-top-full[data-state=open]{--tw-enter-translate-y: -100%}.data-\\[state\\=closed\\]\\:duration-300[data-state=closed]{animation-duration:.3s}.data-\\[state\\=open\\]\\:duration-500[data-state=open]{animation-duration:.5s}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:left-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);left:0}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:h-1[data-panel-group-direction=vertical]:after{content:var(--tw-content);height:.25rem}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:w-full[data-panel-group-direction=vertical]:after{content:var(--tw-content);width:100%}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:-translate-y-1\\/2[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-y: -50%;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[panel-group-direction\\=vertical\\]\\:after\\:translate-x-0[data-panel-group-direction=vertical]:after{content:var(--tw-content);--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\\[state\\=open\\]\\:hover\\:bg-accent:hover[data-state=open]{background-color:var(--accent)}.data-\\[state\\=open\\]\\:hover\\:bg-sidebar-accent:hover[data-state=open]{background-color:var(--sidebar-accent)}.data-\\[state\\=open\\]\\:hover\\:text-sidebar-accent-foreground:hover[data-state=open]{color:var(--sidebar-accent-foreground)}.data-\\[state\\=open\\]\\:focus\\:bg-accent:focus[data-state=open]{background-color:var(--accent)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:left-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{left:calc(var(--sidebar-width) * -1)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:right-\\[calc\\(var\\(--sidebar-width\\)\\*-1\\)\\]{right:calc(var(--sidebar-width) * -1)}.group[data-side=left] .group-data-\\[side\\=left\\]\\:-right-4{right:-1rem}.group[data-side=right] .group-data-\\[side\\=right\\]\\:left-0{left:0}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:-mt-8{margin-top:-2rem}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:hidden{display:none}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!size-8{width:2rem!important;height:2rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[--sidebar-width-icon\\]{width:var(--sidebar-width-icon)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:w-\\[calc\\(var\\(--sidebar-width-icon\\)_\\+_theme\\(spacing\\.4\\)_\\+2px\\)\\]{width:calc(var(--sidebar-width-icon) + 1rem + 2px)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:w-0{width:0px}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:translate-x-0{--tw-translate-x: 0px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-side=right] .group-data-\\[side\\=right\\]\\:rotate-180,.group[data-state=open] .group-data-\\[state\\=open\\]\\:rotate-180{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:overflow-hidden{overflow:hidden}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:rounded-lg{border-radius:var(--radius)}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border{border-width:1px}.group[data-side=left] .group-data-\\[side\\=left\\]\\:border-r{border-right-width:1px}.group[data-side=right] .group-data-\\[side\\=right\\]\\:border-l{border-left-width:1px}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:border-sidebar-border{border-color:var(--sidebar-border)}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-0{padding:0!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:\\!p-2{padding:.5rem!important}.group[data-collapsible=icon] .group-data-\\[collapsible\\=icon\\]\\:opacity-0{opacity:0}.group[data-variant=floating] .group-data-\\[variant\\=floating\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:after\\:left-full:after{content:var(--tw-content);left:100%}.group[data-collapsible=offcanvas] .group-data-\\[collapsible\\=offcanvas\\]\\:hover\\:bg-sidebar:hover{background-color:var(--sidebar)}.peer\\/menu-button[data-size=default]~.peer-data-\\[size\\=default\\]\\/menu-button\\:top-1\\.5{top:.375rem}.peer\\/menu-button[data-size=lg]~.peer-data-\\[size\\=lg\\]\\/menu-button\\:top-2\\.5{top:.625rem}.peer\\/menu-button[data-size=sm]~.peer-data-\\[size\\=sm\\]\\/menu-button\\:top-1{top:.25rem}.peer\\/menu-button[data-active=true]~.peer-data-\\[active\\=true\\]\\/menu-button\\:text-sidebar-accent-foreground{color:var(--sidebar-accent-foreground)}.dark\\:border-destructive:is(.dark *){border-color:var(--destructive)}.dark\\:border-gray-700:is(.dark *){--tw-border-opacity: 1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.dark\\:border-red-800:is(.dark *){--tw-border-opacity: 1;border-color:rgb(153 27 27 / var(--tw-border-opacity, 1))}.dark\\:bg-blue-900\\/20:is(.dark *){background-color:#1e3a8a33}.dark\\:bg-gray-700:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-800:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-900:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.dark\\:bg-gray-900\\/20:is(.dark *){background-color:#11182733}.dark\\:bg-green-900\\/20:is(.dark *){background-color:#14532d33}.dark\\:bg-orange-900\\/20:is(.dark *){background-color:#7c2d1233}.dark\\:bg-purple-900\\/20:is(.dark *){background-color:#581c8733}.dark\\:bg-red-600:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(220 38 38 / var(--tw-bg-opacity, 1))}.dark\\:bg-red-900\\/20:is(.dark *){background-color:#7f1d1d33}.dark\\:text-blue-400:is(.dark *){--tw-text-opacity: 1;color:rgb(96 165 250 / var(--tw-text-opacity, 1))}.dark\\:text-gray-100:is(.dark *){--tw-text-opacity: 1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.dark\\:text-gray-400:is(.dark *){--tw-text-opacity: 1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.dark\\:text-green-400:is(.dark *){--tw-text-opacity: 1;color:rgb(74 222 128 / var(--tw-text-opacity, 1))}.dark\\:text-orange-400:is(.dark *){--tw-text-opacity: 1;color:rgb(251 146 60 / var(--tw-text-opacity, 1))}.dark\\:text-purple-400:is(.dark *){--tw-text-opacity: 1;color:rgb(192 132 252 / var(--tw-text-opacity, 1))}.dark\\:text-red-400:is(.dark *){--tw-text-opacity: 1;color:rgb(248 113 113 / var(--tw-text-opacity, 1))}.dark\\:hover\\:bg-gray-900:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(17 24 39 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-red-700:hover:is(.dark *){--tw-bg-opacity: 1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.dark\\:hover\\:bg-red-900\\/10:hover:is(.dark *){background-color:#7f1d1d1a}@media (min-width: 475px){.xs\\:w-60{width:15rem}}@media (min-width: 640px){.sm\\:bottom-0{bottom:0}.sm\\:right-0{right:0}.sm\\:right-6{right:1.5rem}.sm\\:top-auto{top:auto}.sm\\:mt-0{margin-top:0}.sm\\:inline{display:inline}.sm\\:flex{display:flex}.sm\\:h-16{height:4rem}.sm\\:h-32{height:8rem}.sm\\:h-9{height:2.25rem}.sm\\:w-36{width:9rem}.sm\\:w-40{width:10rem}.sm\\:w-48{width:12rem}.sm\\:w-64{width:16rem}.sm\\:w-\\[540px\\]{width:540px}.sm\\:w-\\[min\\(96vw\\,96vh\\*1\\.586\\)\\]{width:min(96vw,96vh * 1.586)}.sm\\:w-\\[min\\(96vw\\,calc\\(96vh\\*1\\.586\\)\\)\\]{width:min(96vw,152.256vh)}.sm\\:max-w-2xl{max-width:42rem}.sm\\:max-w-7xl{max-width:80rem}.sm\\:max-w-\\[500px\\]{max-width:500px}.sm\\:max-w-\\[650px\\]{max-width:650px}.sm\\:max-w-\\[800px\\]{max-width:800px}.sm\\:max-w-md{max-width:28rem}.sm\\:max-w-sm{max-width:24rem}.sm\\:scale-\\[5\\]{--tw-scale-x: 5;--tw-scale-y: 5;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.sm\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.sm\\:flex-row{flex-direction:row}.sm\\:flex-col{flex-direction:column}.sm\\:items-center{align-items:center}.sm\\:justify-end{justify-content:flex-end}.sm\\:gap-2{gap:.5rem}.sm\\:gap-2\\.5{gap:.625rem}.sm\\:space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(1rem * var(--tw-space-x-reverse));margin-left:calc(1rem * calc(1 - var(--tw-space-x-reverse)))}.sm\\:space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse: 0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.sm\\:rounded-lg{border-radius:var(--radius)}.sm\\:p-6{padding:1.5rem}.sm\\:p-8{padding:2rem}.sm\\:px-6{padding-left:1.5rem;padding-right:1.5rem}.sm\\:px-8{padding-left:2rem;padding-right:2rem}.sm\\:pr-6{padding-right:1.5rem}.sm\\:text-left{text-align:left}.sm\\:text-3xl{font-size:1.875rem;line-height:2.25rem}.data-\\[state\\=open\\]\\:sm\\:slide-in-from-bottom-full[data-state=open]{--tw-enter-translate-y: 100%}}@media (min-width: 768px){.md\\:absolute{position:absolute}.md\\:col-span-2{grid-column:span 2 / span 2}.md\\:block{display:block}.md\\:flex{display:flex}.md\\:table-cell{display:table-cell}.md\\:w-72{width:18rem}.md\\:w-\\[var\\(--radix-navigation-menu-viewport-width\\)\\]{width:var(--radix-navigation-menu-viewport-width)}.md\\:w-auto{width:auto}.md\\:max-w-\\[420px\\]{max-width:420px}.md\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.md\\:text-sm{font-size:.875rem;line-height:1.25rem}.md\\:opacity-0{opacity:0}.after\\:md\\:hidden:after{content:var(--tw-content);display:none}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:m-2{margin:.5rem}.peer[data-state=collapsed][data-variant=inset]~.md\\:peer-data-\\[state\\=collapsed\\]\\:peer-data-\\[variant\\=inset\\]\\:ml-2{margin-left:.5rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:ml-0{margin-left:0}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:rounded-xl{border-radius:.75rem}.peer[data-variant=inset]~.md\\:peer-data-\\[variant\\=inset\\]\\:shadow{--tw-shadow: 0 1px 3px 0 rgb(0 0 0 / .1), 0 1px 2px -1px rgb(0 0 0 / .1);--tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}}@media (min-width: 1024px){.lg\\:fixed{position:fixed}.lg\\:inset-y-0{top:0;bottom:0}.lg\\:right-8{right:2rem}.lg\\:z-50{z-index:50}.lg\\:flex{display:flex}.lg\\:table-cell{display:table-cell}.lg\\:hidden{display:none}.lg\\:h-10{height:2.5rem}.lg\\:h-20{height:5rem}.lg\\:h-40{height:10rem}.lg\\:w-40{width:10rem}.lg\\:w-64{width:16rem}.lg\\:w-80{width:20rem}.lg\\:w-\\[clamp\\(600px\\,75vmin\\,920px\\)\\]{width:clamp(600px,75vmin,920px)}.lg\\:w-auto{width:auto}.lg\\:flex-none{flex:none}.lg\\:flex-shrink-0{flex-shrink:0}.lg\\:scale-\\[7\\]{--tw-scale-x: 7;--tw-scale-y: 7;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.lg\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.lg\\:grid-cols-\\[1fr\\,420px\\]{grid-template-columns:1fr 420px}.lg\\:flex-row{flex-direction:row}.lg\\:flex-col{flex-direction:column}.lg\\:items-start{align-items:flex-start}.lg\\:items-center{align-items:center}.lg\\:px-8{padding-left:2rem;padding-right:2rem}.lg\\:py-0{padding-top:0;padding-bottom:0}.lg\\:pl-64{padding-left:16rem}.lg\\:pl-8{padding-left:2rem}.lg\\:pr-16{padding-right:4rem}.lg\\:pr-8{padding-right:2rem}.lg\\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width: 1280px){.xl\\:col-span-2{grid-column:span 2 / span 2}.xl\\:table-cell{display:table-cell}.xl\\:h-3\\.5{height:.875rem}.xl\\:w-3\\.5{width:.875rem}.xl\\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.xl\\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.xl\\:grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.xl\\:space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.xl\\:text-sm{font-size:.875rem;line-height:1.25rem}}.\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:bg-accent:has([aria-selected]){background-color:var(--accent)}.first\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-l-md:has([aria-selected]):first-child{border-top-left-radius:calc(var(--radius) - 2px);border-bottom-left-radius:calc(var(--radius) - 2px)}.last\\:\\[\\&\\:has\\(\\[aria-selected\\]\\)\\]\\:rounded-r-md:has([aria-selected]):last-child{border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[aria-selected\\]\\.day-range-end\\)\\]\\:rounded-r-md:has([aria-selected].day-range-end){border-top-right-radius:calc(var(--radius) - 2px);border-bottom-right-radius:calc(var(--radius) - 2px)}.\\[\\&\\:has\\(\\[role\\=checkbox\\]\\)\\]\\:pr-0:has([role=checkbox]){padding-right:0}.\\[\\&\\>button\\]\\:hidden>button{display:none}.\\[\\&\\>span\\:last-child\\]\\:truncate>span:last-child{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.\\[\\&\\>span\\]\\:line-clamp-1>span{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.\\[\\&\\>svg\\+div\\]\\:translate-y-\\[-3px\\]>svg+div{--tw-translate-y: -3px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\>svg\\]\\:absolute>svg{position:absolute}.\\[\\&\\>svg\\]\\:left-4>svg{left:1rem}.\\[\\&\\>svg\\]\\:top-4>svg{top:1rem}.\\[\\&\\>svg\\]\\:size-4>svg{width:1rem;height:1rem}.\\[\\&\\>svg\\]\\:h-2\\.5>svg{height:.625rem}.\\[\\&\\>svg\\]\\:h-3>svg{height:.75rem}.\\[\\&\\>svg\\]\\:h-3\\.5>svg{height:.875rem}.\\[\\&\\>svg\\]\\:w-2\\.5>svg{width:.625rem}.\\[\\&\\>svg\\]\\:w-3>svg{width:.75rem}.\\[\\&\\>svg\\]\\:w-3\\.5>svg{width:.875rem}.\\[\\&\\>svg\\]\\:shrink-0>svg{flex-shrink:0}.\\[\\&\\>svg\\]\\:text-destructive>svg{color:var(--destructive)}.\\[\\&\\>svg\\]\\:text-foreground>svg{color:var(--foreground)}.\\[\\&\\>svg\\]\\:text-muted-foreground>svg{color:var(--muted-foreground)}.\\[\\&\\>svg\\]\\:text-sidebar-accent-foreground>svg{color:var(--sidebar-accent-foreground)}.\\[\\&\\>svg\\~\\*\\]\\:pl-7>svg~*{padding-left:1.75rem}.\\[\\&\\>tr\\]\\:last\\:border-b-0:last-child>tr{border-bottom-width:0px}.\\[\\&\\[data-panel-group-direction\\=vertical\\]\\>div\\]\\:rotate-90[data-panel-group-direction=vertical]>div{--tw-rotate: 90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&\\[data-state\\=open\\]\\>svg\\]\\:rotate-180[data-state=open]>svg{--tw-rotate: 180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\\[\\&_\\.recharts-cartesian-axis-tick_text\\]\\:fill-muted-foreground .recharts-cartesian-axis-tick text{fill:var(--muted-foreground)}.\\[\\&_\\.recharts-curve\\.recharts-tooltip-cursor\\]\\:stroke-border .recharts-curve.recharts-tooltip-cursor{stroke:var(--border)}.\\[\\&_\\.recharts-dot\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-dot[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-layer\\]\\:outline-none .recharts-layer{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\.recharts-polar-grid_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-polar-grid [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-radial-bar-background-sector\\]\\:fill-muted .recharts-radial-bar-background-sector,.\\[\\&_\\.recharts-rectangle\\.recharts-tooltip-cursor\\]\\:fill-muted .recharts-rectangle.recharts-tooltip-cursor{fill:var(--muted)}.\\[\\&_\\.recharts-reference-line_\\[stroke\\=\\'\\#ccc\\'\\]\\]\\:stroke-border .recharts-reference-line [stroke=\"#ccc\"]{stroke:var(--border)}.\\[\\&_\\.recharts-sector\\[stroke\\=\\'\\#fff\\'\\]\\]\\:stroke-transparent .recharts-sector[stroke=\"#fff\"]{stroke:transparent}.\\[\\&_\\.recharts-sector\\]\\:outline-none .recharts-sector,.\\[\\&_\\.recharts-surface\\]\\:outline-none .recharts-surface{outline:2px solid transparent;outline-offset:2px}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:px-2 [cmdk-group-heading]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:py-1\\.5 [cmdk-group-heading]{padding-top:.375rem;padding-bottom:.375rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-xs [cmdk-group-heading]{font-size:.75rem;line-height:1rem}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:font-medium [cmdk-group-heading]{font-weight:500}.\\[\\&_\\[cmdk-group-heading\\]\\]\\:text-muted-foreground [cmdk-group-heading]{color:var(--muted-foreground)}.\\[\\&_\\[cmdk-group\\]\\:not\\(\\[hidden\\]\\)_\\~\\[cmdk-group\\]\\]\\:pt-0 [cmdk-group]:not([hidden])~[cmdk-group]{padding-top:0}.\\[\\&_\\[cmdk-group\\]\\]\\:px-2 [cmdk-group]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:h-5 [cmdk-input-wrapper] svg{height:1.25rem}.\\[\\&_\\[cmdk-input-wrapper\\]_svg\\]\\:w-5 [cmdk-input-wrapper] svg{width:1.25rem}.\\[\\&_\\[cmdk-input\\]\\]\\:h-12 [cmdk-input]{height:3rem}.\\[\\&_\\[cmdk-item\\]\\]\\:px-2 [cmdk-item]{padding-left:.5rem;padding-right:.5rem}.\\[\\&_\\[cmdk-item\\]\\]\\:py-3 [cmdk-item]{padding-top:.75rem;padding-bottom:.75rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:h-5 [cmdk-item] svg{height:1.25rem}.\\[\\&_\\[cmdk-item\\]_svg\\]\\:w-5 [cmdk-item] svg{width:1.25rem}.\\[\\&_p\\]\\:leading-relaxed p{line-height:1.625}.\\[\\&_svg\\]\\:pointer-events-none svg{pointer-events:none}.\\[\\&_svg\\]\\:size-4 svg{width:1rem;height:1rem}.\\[\\&_svg\\]\\:shrink-0 svg{flex-shrink:0}.\\[\\&_tr\\:last-child\\]\\:border-0 tr:last-child{border-width:0px}.\\[\\&_tr\\]\\:border-b tr{border-bottom-width:1px}[data-side=left][data-collapsible=offcanvas] .\\[\\[data-side\\=left\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-right-2{right:-.5rem}[data-side=left][data-state=collapsed] .\\[\\[data-side\\=left\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}[data-side=left] .\\[\\[data-side\\=left\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right][data-collapsible=offcanvas] .\\[\\[data-side\\=right\\]\\[data-collapsible\\=offcanvas\\]_\\&\\]\\:-left-2{left:-.5rem}[data-side=right][data-state=collapsed] .\\[\\[data-side\\=right\\]\\[data-state\\=collapsed\\]_\\&\\]\\:cursor-w-resize{cursor:w-resize}[data-side=right] .\\[\\[data-side\\=right\\]_\\&\\]\\:cursor-e-resize{cursor:e-resize}\n","size_bytes":129803},"assets/qr-scanner-worker.min-D85Z9gVD.js":{"content":"const e=()=>new Worker(URL.createObjectURL(new Blob([`class x{constructor(a,b){this.width=b;this.height=a.length/b;this.data=a}static createEmpty(a,b){return new x(new Uint8ClampedArray(a*b),a)}get(a,b){return 0>a||a>=this.width||0>b||b>=this.height?!1:!!this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c?1:0}setRegion(a,b,c,d,e){for(let f=b;f<b+d;f++)for(let g=a;g<a+c;g++)this.set(g,f,!!e)}}\nclass A{constructor(a,b,c){this.width=a;a*=b;if(c&&c.length!==a)throw Error(\"Wrong buffer size\");this.data=c||new Uint8ClampedArray(a)}get(a,b){return this.data[b*this.width+a]}set(a,b,c){this.data[b*this.width+a]=c}}\nclass ba{constructor(a){this.bitOffset=this.byteOffset=0;this.bytes=a}readBits(a){if(1>a||32<a||a>this.available())throw Error(\"Cannot read \"+a.toString()+\" bits\");var b=0;if(0<this.bitOffset){b=8-this.bitOffset;var c=a<b?a:b;b-=c;b=(this.bytes[this.byteOffset]&255>>8-c<<b)>>b;a-=c;this.bitOffset+=c;8===this.bitOffset&&(this.bitOffset=0,this.byteOffset++)}if(0<a){for(;8<=a;)b=b<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,a-=8;0<a&&(c=8-a,b=b<<a|(this.bytes[this.byteOffset]&255>>c<<c)>>c,\nthis.bitOffset+=a)}return b}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var B,C=B||(B={});C.Numeric=\"numeric\";C.Alphanumeric=\"alphanumeric\";C.Byte=\"byte\";C.Kanji=\"kanji\";C.ECI=\"eci\";C.StructuredAppend=\"structuredappend\";var D,E=D||(D={});E[E.Terminator=0]=\"Terminator\";E[E.Numeric=1]=\"Numeric\";E[E.Alphanumeric=2]=\"Alphanumeric\";E[E.Byte=4]=\"Byte\";E[E.Kanji=8]=\"Kanji\";E[E.ECI=7]=\"ECI\";E[E.StructuredAppend=3]=\"StructuredAppend\";let F=\"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:\".split(\"\");\nfunction ca(a,b){let c=[],d=\"\";b=a.readBits([8,16,16][b]);for(let e=0;e<b;e++){let f=a.readBits(8);c.push(f)}try{d+=decodeURIComponent(c.map(e=>\\`%\\${(\"0\"+e.toString(16)).substr(-2)}\\`).join(\"\"))}catch(e){}return{bytes:c,text:d}}\nfunction da(a,b){a=new ba(a);let c=9>=b?0:26>=b?1:2;for(b={text:\"\",bytes:[],chunks:[],version:b};4<=a.available();){var d=a.readBits(4);if(d===D.Terminator)return b;if(d===D.ECI)0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(7)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(14)}):0===a.readBits(1)?b.chunks.push({type:B.ECI,assignmentNumber:a.readBits(21)}):b.chunks.push({type:B.ECI,assignmentNumber:-1});else if(d===D.Numeric){var e=a,f=[];d=\"\";for(var g=\ne.readBits([10,12,14][c]);3<=g;){var h=e.readBits(10);if(1E3<=h)throw Error(\"Invalid numeric value above 999\");var k=Math.floor(h/100),m=Math.floor(h/10)%10;h%=10;f.push(48+k,48+m,48+h);d+=k.toString()+m.toString()+h.toString();g-=3}if(2===g){g=e.readBits(7);if(100<=g)throw Error(\"Invalid numeric value above 99\");e=Math.floor(g/10);g%=10;f.push(48+e,48+g);d+=e.toString()+g.toString()}else if(1===g){e=e.readBits(4);if(10<=e)throw Error(\"Invalid numeric value above 9\");f.push(48+e);d+=e.toString()}b.text+=\nd;b.bytes.push(...f);b.chunks.push({type:B.Numeric,text:d})}else if(d===D.Alphanumeric){e=a;f=[];d=\"\";for(g=e.readBits([9,11,13][c]);2<=g;)m=e.readBits(11),k=Math.floor(m/45),m%=45,f.push(F[k].charCodeAt(0),F[m].charCodeAt(0)),d+=F[k]+F[m],g-=2;1===g&&(e=e.readBits(6),f.push(F[e].charCodeAt(0)),d+=F[e]);b.text+=d;b.bytes.push(...f);b.chunks.push({type:B.Alphanumeric,text:d})}else if(d===D.Byte)d=ca(a,c),b.text+=d.text,b.bytes.push(...d.bytes),b.chunks.push({type:B.Byte,bytes:d.bytes,text:d.text});\nelse if(d===D.Kanji){f=a;d=[];e=f.readBits([8,10,12][c]);for(g=0;g<e;g++)k=f.readBits(13),k=Math.floor(k/192)<<8|k%192,k=7936>k?k+33088:k+49472,d.push(k>>8,k&255);f=(new TextDecoder(\"shift-jis\")).decode(Uint8Array.from(d));b.text+=f;b.bytes.push(...d);b.chunks.push({type:B.Kanji,bytes:d,text:f})}else d===D.StructuredAppend&&b.chunks.push({type:B.StructuredAppend,currentSequence:a.readBits(4),totalSequence:a.readBits(4),parity:a.readBits(8)})}if(0===a.available()||0===a.readBits(a.available()))return b}\nclass G{constructor(a,b){if(0===b.length)throw Error(\"No coefficients.\");this.field=a;let c=b.length;if(1<c&&0===b[0]){let d=1;for(;d<c&&0===b[d];)d++;if(d===c)this.coefficients=a.zero.coefficients;else for(this.coefficients=new Uint8ClampedArray(c-d),a=0;a<this.coefficients.length;a++)this.coefficients[a]=b[d+a]}else this.coefficients=b}degree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}addOrSubtract(a){if(this.isZero())return a;\nif(a.isZero())return this;let b=this.coefficients;a=a.coefficients;b.length>a.length&&([b,a]=[a,b]);let c=new Uint8ClampedArray(a.length),d=a.length-b.length;for(var e=0;e<d;e++)c[e]=a[e];for(e=d;e<a.length;e++)c[e]=b[e-d]^a[e];return new G(this.field,c)}multiply(a){if(0===a)return this.field.zero;if(1===a)return this;let b=this.coefficients.length,c=new Uint8ClampedArray(b);for(let d=0;d<b;d++)c[d]=this.field.multiply(this.coefficients[d],a);return new G(this.field,c)}multiplyPoly(a){if(this.isZero()||\na.isZero())return this.field.zero;let b=this.coefficients,c=b.length;a=a.coefficients;let d=a.length,e=new Uint8ClampedArray(c+d-1);for(let f=0;f<c;f++){let g=b[f];for(let h=0;h<d;h++)e[f+h]=H(e[f+h],this.field.multiply(g,a[h]))}return new G(this.field,e)}multiplyByMonomial(a,b){if(0>a)throw Error(\"Invalid degree less than 0\");if(0===b)return this.field.zero;let c=this.coefficients.length;a=new Uint8ClampedArray(c+a);for(let d=0;d<c;d++)a[d]=this.field.multiply(this.coefficients[d],b);return new G(this.field,\na)}evaluateAt(a){let b=0;if(0===a)return this.getCoefficient(0);let c=this.coefficients.length;if(1===a)return this.coefficients.forEach(d=>{b^=d}),b;b=this.coefficients[0];for(let d=1;d<c;d++)b=H(this.field.multiply(a,b),this.coefficients[d]);return b}}function H(a,b){return a^b}\nclass ea{constructor(a,b,c){this.primitive=a;this.size=b;this.generatorBase=c;this.expTable=Array(this.size);this.logTable=Array(this.size);a=1;for(b=0;b<this.size;b++)this.expTable[b]=a,a*=2,a>=this.size&&(a=(a^this.primitive)&this.size-1);for(a=0;a<this.size-1;a++)this.logTable[this.expTable[a]]=a;this.zero=new G(this,Uint8ClampedArray.from([0]));this.one=new G(this,Uint8ClampedArray.from([1]))}multiply(a,b){return 0===a||0===b?0:this.expTable[(this.logTable[a]+this.logTable[b])%(this.size-1)]}inverse(a){if(0===\na)throw Error(\"Can't invert 0\");return this.expTable[this.size-this.logTable[a]-1]}buildMonomial(a,b){if(0>a)throw Error(\"Invalid monomial degree less than 0\");if(0===b)return this.zero;a=new Uint8ClampedArray(a+1);a[0]=b;return new G(this,a)}log(a){if(0===a)throw Error(\"Can't take log(0)\");return this.logTable[a]}exp(a){return this.expTable[a]}}\nfunction fa(a,b,c,d){b.degree()<c.degree()&&([b,c]=[c,b]);let e=a.zero;for(var f=a.one;c.degree()>=d/2;){var g=b;let h=e;b=c;e=f;if(b.isZero())return null;c=g;f=a.zero;g=b.getCoefficient(b.degree());for(g=a.inverse(g);c.degree()>=b.degree()&&!c.isZero();){let k=c.degree()-b.degree(),m=a.multiply(c.getCoefficient(c.degree()),g);f=f.addOrSubtract(a.buildMonomial(k,m));c=c.addOrSubtract(b.multiplyByMonomial(k,m))}f=f.multiplyPoly(e).addOrSubtract(h);if(c.degree()>=b.degree())return null}d=f.getCoefficient(0);\nif(0===d)return null;a=a.inverse(d);return[f.multiply(a),c.multiply(a)]}\nfunction ha(a,b){let c=new Uint8ClampedArray(a.length);c.set(a);a=new ea(285,256,0);var d=new G(a,c),e=new Uint8ClampedArray(b),f=!1;for(var g=0;g<b;g++){var h=d.evaluateAt(a.exp(g+a.generatorBase));e[e.length-1-g]=h;0!==h&&(f=!0)}if(!f)return c;d=new G(a,e);d=fa(a,a.buildMonomial(b,1),d,b);if(null===d)return null;b=d[0];g=b.degree();if(1===g)b=[b.getCoefficient(1)];else{e=Array(g);f=0;for(h=1;h<a.size&&f<g;h++)0===b.evaluateAt(h)&&(e[f]=a.inverse(h),f++);b=f!==g?null:e}if(null==b)return null;e=d[1];\nf=b.length;d=Array(f);for(g=0;g<f;g++){h=a.inverse(b[g]);let k=1;for(let m=0;m<f;m++)g!==m&&(k=a.multiply(k,H(1,a.multiply(b[m],h))));d[g]=a.multiply(e.evaluateAt(h),a.inverse(k));0!==a.generatorBase&&(d[g]=a.multiply(d[g],h))}for(e=0;e<b.length;e++){f=c.length-1-a.log(b[e]);if(0>f)return null;c[f]^=d[e]}return c}\nlet I=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},\n{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,\n34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,\necBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},\n{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},\n{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,\ndataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},\n{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},\n{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,\necBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,\n74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,\nversionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,\ndataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,\ndataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},\n{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},\n{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},\n{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},\n{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},\n{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,\ndataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},\n{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,\necBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,\n26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},\n{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},\n{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,\ndataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,\ndataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},\n{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,\ndataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},\n{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,\ndataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],\nerrorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,\nversionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},\n{numBlocks:61,dataCodewordsPerBlock:16}]}]}];function J(a,b){a^=b;for(b=0;a;)b++,a&=a-1;return b}function K(a,b){return b<<1|a}\nlet ia=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,\ndataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,\nformatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,\ndataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],ja=[a=>0===(a.y+a.x)%2,a=>0===a.y%2,a=>0===a.x%3,a=>0===(a.y+a.x)%3,a=>0===(Math.floor(a.y/2)+Math.floor(a.x/3))%2,a=>0===a.x*a.y%\n2+a.x*a.y%3,a=>0===(a.y*a.x%2+a.y*a.x%3)%2,a=>0===((a.y+a.x)%2+a.y*a.x%3)%2];\nfunction ka(a,b,c){c=ja[c.dataMask];let d=a.height;var e=17+4*b.versionNumber;let f=x.createEmpty(e,e);f.setRegion(0,0,9,9,!0);f.setRegion(e-8,0,8,9,!0);f.setRegion(0,e-8,9,8,!0);for(var g of b.alignmentPatternCenters)for(var h of b.alignmentPatternCenters)6===g&&6===h||6===g&&h===e-7||g===e-7&&6===h||f.setRegion(g-2,h-2,5,5,!0);f.setRegion(6,9,1,e-17,!0);f.setRegion(9,6,e-17,1,!0);6<b.versionNumber&&(f.setRegion(e-11,0,3,6,!0),f.setRegion(0,e-11,6,3,!0));b=[];h=g=0;e=!0;for(let k=d-1;0<k;k-=2){6===\nk&&k--;for(let m=0;m<d;m++){let l=e?d-1-m:m;for(let n=0;2>n;n++){let q=k-n;if(!f.get(q,l)){h++;let r=a.get(q,l);c({y:l,x:q})&&(r=!r);g=g<<1|r;8===h&&(b.push(g),g=h=0)}}}e=!e}return b}\nfunction la(a){var b=a.height,c=Math.floor((b-17)/4);if(6>=c)return I[c-1];c=0;for(var d=5;0<=d;d--)for(var e=b-9;e>=b-11;e--)c=K(a.get(e,d),c);d=0;for(e=5;0<=e;e--)for(let g=b-9;g>=b-11;g--)d=K(a.get(e,g),d);a=Infinity;let f;for(let g of I){if(g.infoBits===c||g.infoBits===d)return g;b=J(c,g.infoBits);b<a&&(f=g,a=b);b=J(d,g.infoBits);b<a&&(f=g,a=b)}if(3>=a)return f}\nfunction ma(a){let b=0;for(var c=0;8>=c;c++)6!==c&&(b=K(a.get(c,8),b));for(c=7;0<=c;c--)6!==c&&(b=K(a.get(8,c),b));var d=a.height;c=0;for(var e=d-1;e>=d-7;e--)c=K(a.get(8,e),c);for(e=d-8;e<d;e++)c=K(a.get(e,8),c);a=Infinity;d=null;for(let {bits:f,formatInfo:g}of ia){if(f===b||f===c)return g;e=J(b,f);e<a&&(d=g,a=e);b!==c&&(e=J(c,f),e<a&&(d=g,a=e))}return 3>=a?d:null}\nfunction na(a,b,c){let d=b.errorCorrectionLevels[c],e=[],f=0;d.ecBlocks.forEach(h=>{for(let k=0;k<h.numBlocks;k++)e.push({numDataCodewords:h.dataCodewordsPerBlock,codewords:[]}),f+=h.dataCodewordsPerBlock+d.ecCodewordsPerBlock});if(a.length<f)return null;a=a.slice(0,f);b=d.ecBlocks[0].dataCodewordsPerBlock;for(c=0;c<b;c++)for(var g of e)g.codewords.push(a.shift());if(1<d.ecBlocks.length)for(g=d.ecBlocks[0].numBlocks,b=d.ecBlocks[1].numBlocks,c=0;c<b;c++)e[g+c].codewords.push(a.shift());for(;0<a.length;)for(let h of e)h.codewords.push(a.shift());\nreturn e}function L(a){let b=la(a);if(!b)return null;var c=ma(a);if(!c)return null;a=ka(a,b,c);var d=na(a,b,c.errorCorrectionLevel);if(!d)return null;c=d.reduce((e,f)=>e+f.numDataCodewords,0);c=new Uint8ClampedArray(c);a=0;for(let e of d){d=ha(e.codewords,e.codewords.length-e.numDataCodewords);if(!d)return null;for(let f=0;f<e.numDataCodewords;f++)c[a++]=d[f]}try{return da(c,b.versionNumber)}catch(e){return null}}\nfunction M(a,b,c,d){var e=a.x-b.x+c.x-d.x;let f=a.y-b.y+c.y-d.y;if(0===e&&0===f)return{a11:b.x-a.x,a12:b.y-a.y,a13:0,a21:c.x-b.x,a22:c.y-b.y,a23:0,a31:a.x,a32:a.y,a33:1};let g=b.x-c.x;var h=d.x-c.x;let k=b.y-c.y,m=d.y-c.y;c=g*m-h*k;h=(e*m-h*f)/c;e=(g*f-e*k)/c;return{a11:b.x-a.x+h*b.x,a12:b.y-a.y+h*b.y,a13:h,a21:d.x-a.x+e*d.x,a22:d.y-a.y+e*d.y,a23:e,a31:a.x,a32:a.y,a33:1}}\nfunction oa(a,b,c,d){a=M(a,b,c,d);return{a11:a.a22*a.a33-a.a23*a.a32,a12:a.a13*a.a32-a.a12*a.a33,a13:a.a12*a.a23-a.a13*a.a22,a21:a.a23*a.a31-a.a21*a.a33,a22:a.a11*a.a33-a.a13*a.a31,a23:a.a13*a.a21-a.a11*a.a23,a31:a.a21*a.a32-a.a22*a.a31,a32:a.a12*a.a31-a.a11*a.a32,a33:a.a11*a.a22-a.a12*a.a21}}\nfunction pa(a,b){var c=oa({x:3.5,y:3.5},{x:b.dimension-3.5,y:3.5},{x:b.dimension-6.5,y:b.dimension-6.5},{x:3.5,y:b.dimension-3.5}),d=M(b.topLeft,b.topRight,b.alignmentPattern,b.bottomLeft),e=d.a11*c.a11+d.a21*c.a12+d.a31*c.a13,f=d.a12*c.a11+d.a22*c.a12+d.a32*c.a13,g=d.a13*c.a11+d.a23*c.a12+d.a33*c.a13,h=d.a11*c.a21+d.a21*c.a22+d.a31*c.a23,k=d.a12*c.a21+d.a22*c.a22+d.a32*c.a23,m=d.a13*c.a21+d.a23*c.a22+d.a33*c.a23,l=d.a11*c.a31+d.a21*c.a32+d.a31*c.a33,n=d.a12*c.a31+d.a22*c.a32+d.a32*c.a33,q=d.a13*\nc.a31+d.a23*c.a32+d.a33*c.a33;c=x.createEmpty(b.dimension,b.dimension);d=(r,u)=>{const p=g*r+m*u+q;return{x:(e*r+h*u+l)/p,y:(f*r+k*u+n)/p}};for(let r=0;r<b.dimension;r++)for(let u=0;u<b.dimension;u++){let p=d(u+.5,r+.5);c.set(u,r,a.get(Math.floor(p.x),Math.floor(p.y)))}return{matrix:c,mappingFunction:d}}let N=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));function O(a){return a.reduce((b,c)=>b+c)}\nfunction qa(a,b,c){let d=N(a,b),e=N(b,c),f=N(a,c),g,h,k;e>=d&&e>=f?[g,h,k]=[b,a,c]:f>=e&&f>=d?[g,h,k]=[a,b,c]:[g,h,k]=[a,c,b];0>(k.x-h.x)*(g.y-h.y)-(k.y-h.y)*(g.x-h.x)&&([g,k]=[k,g]);return{bottomLeft:g,topLeft:h,topRight:k}}\nfunction ra(a,b,c,d){d=(O(P(a,c,d,5))/7+O(P(a,b,d,5))/7+O(P(c,a,d,5))/7+O(P(b,a,d,5))/7)/4;if(1>d)throw Error(\"Invalid module size\");b=Math.round(N(a,b)/d);a=Math.round(N(a,c)/d);a=Math.floor((b+a)/2)+7;switch(a%4){case 0:a++;break;case 2:a--}return{dimension:a,moduleSize:d}}\nfunction Q(a,b,c,d){let e=[{x:Math.floor(a.x),y:Math.floor(a.y)}];var f=Math.abs(b.y-a.y)>Math.abs(b.x-a.x);if(f){var g=Math.floor(a.y);var h=Math.floor(a.x);a=Math.floor(b.y);b=Math.floor(b.x)}else g=Math.floor(a.x),h=Math.floor(a.y),a=Math.floor(b.x),b=Math.floor(b.y);let k=Math.abs(a-g),m=Math.abs(b-h),l=Math.floor(-k/2),n=g<a?1:-1,q=h<b?1:-1,r=!0;for(let u=g,p=h;u!==a+n;u+=n){g=f?p:u;h=f?u:p;if(c.get(g,h)!==r&&(r=!r,e.push({x:g,y:h}),e.length===d+1))break;l+=m;if(0<l){if(p===b)break;p+=q;l-=k}}c=\n[];for(f=0;f<d;f++)e[f]&&e[f+1]?c.push(N(e[f],e[f+1])):c.push(0);return c}function P(a,b,c,d){let e=b.y-a.y,f=b.x-a.x;b=Q(a,b,c,Math.ceil(d/2));a=Q(a,{x:a.x-f,y:a.y-e},c,Math.ceil(d/2));c=b.shift()+a.shift()-1;return a.concat(c).concat(...b)}function R(a,b){let c=O(a)/O(b),d=0;b.forEach((e,f)=>{d+=Math.pow(a[f]-e*c,2)});return{averageSize:c,error:d}}\nfunction S(a,b,c){try{let d=P(a,{x:-1,y:a.y},c,b.length),e=P(a,{x:a.x,y:-1},c,b.length),f=P(a,{x:Math.max(0,a.x-a.y)-1,y:Math.max(0,a.y-a.x)-1},c,b.length),g=P(a,{x:Math.min(c.width,a.x+a.y)+1,y:Math.min(c.height,a.y+a.x)+1},c,b.length),h=R(d,b),k=R(e,b),m=R(f,b),l=R(g,b),n=(h.averageSize+k.averageSize+m.averageSize+l.averageSize)/4;return Math.sqrt(h.error*h.error+k.error*k.error+m.error*m.error+l.error*l.error)+(Math.pow(h.averageSize-n,2)+Math.pow(k.averageSize-n,2)+Math.pow(m.averageSize-n,2)+\nMath.pow(l.averageSize-n,2))/n}catch(d){return Infinity}}function T(a,b){for(var c=Math.round(b.x);a.get(c,Math.round(b.y));)c--;for(var d=Math.round(b.x);a.get(d,Math.round(b.y));)d++;c=(c+d)/2;for(d=Math.round(b.y);a.get(Math.round(c),d);)d--;for(b=Math.round(b.y);a.get(Math.round(c),b);)b++;return{x:c,y:(d+b)/2}}\nfunction sa(a){var b=[],c=[];let d=[];var e=[];for(let p=0;p<=a.height;p++){var f=0,g=!1;let t=[0,0,0,0,0];for(let v=-1;v<=a.width;v++){var h=a.get(v,p);if(h===g)f++;else{t=[t[1],t[2],t[3],t[4],f];f=1;g=h;var k=O(t)/7;k=Math.abs(t[0]-k)<k&&Math.abs(t[1]-k)<k&&Math.abs(t[2]-3*k)<3*k&&Math.abs(t[3]-k)<k&&Math.abs(t[4]-k)<k&&!h;var m=O(t.slice(-3))/3;h=Math.abs(t[2]-m)<m&&Math.abs(t[3]-m)<m&&Math.abs(t[4]-m)<m&&h;if(k){let z=v-t[3]-t[4],y=z-t[2];k={startX:y,endX:z,y:p};m=c.filter(w=>y>=w.bottom.startX&&\ny<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<m.length?m[0].bottom=k:c.push({top:k,bottom:k})}if(h){let z=v-t[4],y=z-t[3];h={startX:y,y:p,endX:z};k=e.filter(w=>y>=w.bottom.startX&&y<=w.bottom.endX||z>=w.bottom.startX&&y<=w.bottom.endX||y<=w.bottom.startX&&z>=w.bottom.endX&&1.5>t[2]/(w.bottom.endX-w.bottom.startX)&&.5<t[2]/(w.bottom.endX-w.bottom.startX));0<k.length?\nk[0].bottom=h:e.push({top:h,bottom:h})}}}b.push(...c.filter(v=>v.bottom.y!==p&&2<=v.bottom.y-v.top.y));c=c.filter(v=>v.bottom.y===p);d.push(...e.filter(v=>v.bottom.y!==p));e=e.filter(v=>v.bottom.y===p)}b.push(...c.filter(p=>2<=p.bottom.y-p.top.y));d.push(...e);c=[];for(var l of b)2>l.bottom.y-l.top.y||(b=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4,e=(l.top.y+l.bottom.y+1)/2,a.get(Math.round(b),Math.round(e))&&(f=[l.top.endX-l.top.startX,l.bottom.endX-l.bottom.startX,l.bottom.y-l.top.y+\n1],f=O(f)/f.length,g=S({x:Math.round(b),y:Math.round(e)},[1,1,3,1,1],a),c.push({score:g,x:b,y:e,size:f})));if(3>c.length)return null;c.sort((p,t)=>p.score-t.score);l=[];for(b=0;b<Math.min(c.length,5);++b){e=c[b];f=[];for(var n of c)n!==e&&f.push(Object.assign(Object.assign({},n),{score:n.score+Math.pow(n.size-e.size,2)/e.size}));f.sort((p,t)=>p.score-t.score);l.push({points:[e,f[0],f[1]],score:e.score+f[0].score+f[1].score})}l.sort((p,t)=>p.score-t.score);let {topRight:q,topLeft:r,bottomLeft:u}=qa(...l[0].points);\nl=U(a,d,q,r,u);n=[];l&&n.push({alignmentPattern:{x:l.alignmentPattern.x,y:l.alignmentPattern.y},bottomLeft:{x:u.x,y:u.y},dimension:l.dimension,topLeft:{x:r.x,y:r.y},topRight:{x:q.x,y:q.y}});l=T(a,q);b=T(a,r);c=T(a,u);(a=U(a,d,l,b,c))&&n.push({alignmentPattern:{x:a.alignmentPattern.x,y:a.alignmentPattern.y},bottomLeft:{x:c.x,y:c.y},topLeft:{x:b.x,y:b.y},topRight:{x:l.x,y:l.y},dimension:a.dimension});return 0===n.length?null:n}\nfunction U(a,b,c,d,e){let f,g;try{({dimension:f,moduleSize:g}=ra(d,c,e,a))}catch(l){return null}var h=c.x-d.x+e.x,k=c.y-d.y+e.y;c=(N(d,e)+N(d,c))/2/g;e=1-3/c;let m={x:d.x+e*(h-d.x),y:d.y+e*(k-d.y)};b=b.map(l=>{const n=(l.top.startX+l.top.endX+l.bottom.startX+l.bottom.endX)/4;l=(l.top.y+l.bottom.y+1)/2;if(a.get(Math.floor(n),Math.floor(l))){var q=S({x:Math.floor(n),y:Math.floor(l)},[1,1,1],a)+N({x:n,y:l},m);return{x:n,y:l,score:q}}}).filter(l=>!!l).sort((l,n)=>l.score-n.score);return{alignmentPattern:15<=\nc&&b.length?b[0]:m,dimension:f}}\nfunction V(a){var b=sa(a);if(!b)return null;for(let e of b){b=pa(a,e);var c=b.matrix;if(null==c)c=null;else{var d=L(c);if(d)c=d;else{for(d=0;d<c.width;d++)for(let f=d+1;f<c.height;f++)c.get(d,f)!==c.get(f,d)&&(c.set(d,f,!c.get(d,f)),c.set(f,d,!c.get(f,d)));c=L(c)}}if(c)return{binaryData:c.bytes,data:c.text,chunks:c.chunks,version:c.version,location:{topRightCorner:b.mappingFunction(e.dimension,0),topLeftCorner:b.mappingFunction(0,0),bottomRightCorner:b.mappingFunction(e.dimension,e.dimension),bottomLeftCorner:b.mappingFunction(0,\ne.dimension),topRightFinderPattern:e.topRight,topLeftFinderPattern:e.topLeft,bottomLeftFinderPattern:e.bottomLeft,bottomRightAlignmentPattern:e.alignmentPattern},matrix:b.matrix}}return null}let ta={inversionAttempts:\"attemptBoth\",greyScaleWeights:{red:.2126,green:.7152,blue:.0722,useIntegerApproximation:!1},canOverwriteImage:!0};function W(a,b){Object.keys(b).forEach(c=>{a[c]=b[c]})}\nfunction X(a,b,c,d={}){let e=Object.create(null);W(e,ta);W(e,d);d=\"onlyInvert\"===e.inversionAttempts||\"invertFirst\"===e.inversionAttempts;var f=\"attemptBoth\"===e.inversionAttempts||d;var g=e.greyScaleWeights,h=e.canOverwriteImage,k=b*c;if(a.length!==4*k)throw Error(\"Malformed data passed to binarizer.\");var m=0;if(h){var l=new Uint8ClampedArray(a.buffer,m,k);m+=k}l=new A(b,c,l);if(g.useIntegerApproximation)for(var n=0;n<c;n++)for(var q=0;q<b;q++){var r=4*(n*b+q);l.set(q,n,g.red*a[r]+g.green*a[r+1]+\ng.blue*a[r+2]+128>>8)}else for(n=0;n<c;n++)for(q=0;q<b;q++)r=4*(n*b+q),l.set(q,n,g.red*a[r]+g.green*a[r+1]+g.blue*a[r+2]);g=Math.ceil(b/8);n=Math.ceil(c/8);q=g*n;if(h){var u=new Uint8ClampedArray(a.buffer,m,q);m+=q}u=new A(g,n,u);for(q=0;q<n;q++)for(r=0;r<g;r++){var p=Infinity,t=0;for(var v=0;8>v;v++)for(let w=0;8>w;w++){let aa=l.get(8*r+w,8*q+v);p=Math.min(p,aa);t=Math.max(t,aa)}v=(p+t)/2;v=Math.min(255,1.11*v);24>=t-p&&(v=p/2,0<q&&0<r&&(t=(u.get(r,q-1)+2*u.get(r-1,q)+u.get(r-1,q-1))/4,p<t&&(v=t)));\nu.set(r,q,v)}h?(q=new Uint8ClampedArray(a.buffer,m,k),m+=k,q=new x(q,b)):q=x.createEmpty(b,c);r=null;f&&(h?(a=new Uint8ClampedArray(a.buffer,m,k),r=new x(a,b)):r=x.createEmpty(b,c));for(b=0;b<n;b++)for(a=0;a<g;a++){c=g-3;c=2>a?2:a>c?c:a;h=n-3;h=2>b?2:b>h?h:b;k=0;for(m=-2;2>=m;m++)for(p=-2;2>=p;p++)k+=u.get(c+m,h+p);c=k/25;for(h=0;8>h;h++)for(k=0;8>k;k++)m=8*a+h,p=8*b+k,t=l.get(m,p),q.set(m,p,t<=c),f&&r.set(m,p,!(t<=c))}f=f?{binarized:q,inverted:r}:{binarized:q};let {binarized:z,inverted:y}=f;(f=V(d?\ny:z))||\"attemptBoth\"!==e.inversionAttempts&&\"invertFirst\"!==e.inversionAttempts||(f=V(d?z:y));return f}X.default=X;let Y=\"dontInvert\",Z={red:77,green:150,blue:29,useIntegerApproximation:!0};\nself.onmessage=a=>{let b=a.data.id,c=a.data.data;switch(a.data.type){case \"decode\":(a=X(c.data,c.width,c.height,{inversionAttempts:Y,greyScaleWeights:Z}))?self.postMessage({id:b,type:\"qrResult\",data:a.data,cornerPoints:[a.location.topLeftCorner,a.location.topRightCorner,a.location.bottomRightCorner,a.location.bottomLeftCorner]}):self.postMessage({id:b,type:\"qrResult\",data:null});break;case \"grayscaleWeights\":Z.red=c.red;Z.green=c.green;Z.blue=c.blue;Z.useIntegerApproximation=c.useIntegerApproximation;\nbreak;case \"inversionMode\":switch(c){case \"original\":Y=\"dontInvert\";break;case \"invert\":Y=\"onlyInvert\";break;case \"both\":Y=\"attemptBoth\";break;default:throw Error(\"Invalid inversion mode\");}break;case \"close\":self.close()}}\n`]),{type:\"application/javascript\"}));export{e as createWorker};\n","size_bytes":43954}},"version":1}